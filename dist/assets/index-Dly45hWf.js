import{aI as O}from"./index-B1f6toGc.js";import{e as q,h as _t,a as Tt}from"./hashTypedData-B73oyvc1.js";const Ee=()=>"9.1.0",It=e=>e.toString(16).padStart(2,"0"),At=e=>{const s=new Uint8Array(e/2);return window.crypto.getRandomValues(s),Array.from(s,It).join("")},vt=()=>typeof window<"u"?At(10):new Date().getTime().toString(36);class P{}P.makeRequest=(e,s)=>({id:vt(),method:e,params:s,env:{sdkVersion:Ee()}});P.makeResponse=(e,s,t)=>({id:e,success:!0,version:t,data:s});P.makeErrorResponse=(e,s,t)=>({id:e,success:!1,error:s,version:t});var h;(function(e){e.sendTransactions="sendTransactions",e.rpcCall="rpcCall",e.getChainInfo="getChainInfo",e.getSafeInfo="getSafeInfo",e.getTxBySafeTxHash="getTxBySafeTxHash",e.getSafeBalances="getSafeBalances",e.signMessage="signMessage",e.signTypedMessage="signTypedMessage",e.getEnvironmentInfo="getEnvironmentInfo",e.getOffChainSignature="getOffChainSignature",e.requestAddressBook="requestAddressBook",e.wallet_getPermissions="wallet_getPermissions",e.wallet_requestPermissions="wallet_requestPermissions"})(h||(h={}));var w;(function(e){e.requestAddressBook="requestAddressBook"})(w||(w={}));class pt{constructor(s=null,t=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:n,data:c,source:i})=>{const u=!c,f=!this.isServer&&i===window.parent,E=typeof c.version<"u"&&parseInt(c.version.split(".")[0]),p=typeof E=="number"&&E>=1;let _=!0;return Array.isArray(this.allowedOrigins)&&(_=this.allowedOrigins.find(S=>S.test(n))!==void 0),!u&&f&&p&&_},this.logIncomingMessage=n=>{console.info(`Safe Apps SDK v1: A message was received from origin ${n.origin}. `,n.data)},this.onParentMessage=n=>{this.isValidMessage(n)&&(this.debugMode&&this.logIncomingMessage(n),this.handleIncomingMessage(n.data))},this.handleIncomingMessage=n=>{const{id:c}=n,i=this.callbacks.get(c);i&&(i(n),this.callbacks.delete(c))},this.send=(n,c)=>{const i=P.makeRequest(n,c);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(i,"*"),new Promise((u,f)=>{this.callbacks.set(i.id,E=>{if(!E.success){f(new Error(E.error));return}u(E)})})},this.allowedOrigins=s,this.debugMode=t,this.isServer||window.addEventListener("message",this.onParentMessage)}}const V=e=>typeof e=="object"&&e!=null&&"domain"in e&&"types"in e&&"message"in e;var b={},C={},D={},W=O&&O.__awaiter||function(e,s,t,n){function c(i){return i instanceof t?i:new t(function(u){u(i)})}return new(t||(t=Promise))(function(i,u){function f(_){try{p(n.next(_))}catch(S){u(S)}}function E(_){try{p(n.throw(_))}catch(S){u(S)}}function p(_){_.done?i(_.value):c(_.value).then(f,E)}p((n=n.apply(e,s||[])).next())})};Object.defineProperty(D,"__esModule",{value:!0});D.insertParams=Ot;D.stringifyQuery=yt;D.fetchData=mt;D.getData=Ct;const St=e=>typeof e=="object"&&e!==null&&("code"in e||"statusCode"in e)&&"message"in e;function Nt(e,s,t){return e.replace(new RegExp(`\\{${s}\\}`,"g"),t)}function Ot(e,s){return s?Object.keys(s).reduce((t,n)=>Nt(t,n,String(s[n])),e):e}function yt(e){if(!e)return"";const s=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!=null&&s.append(n,String(e[n]))});const t=s.toString();return t?`?${t}`:""}function _e(e){return W(this,void 0,void 0,function*(){var s;let t;try{t=yield e.json()}catch{t={}}if(!e.ok){const n=St(t)?`CGW error - ${(s=t.code)!==null&&s!==void 0?s:t.statusCode}: ${t.message}`:`CGW error - status ${e.statusText}`;throw new Error(n)}return t})}function mt(e,s,t,n,c){return W(this,void 0,void 0,function*(){const i=Object.assign({"Content-Type":"application/json"},n),u={method:s??"POST",headers:i};c&&(u.credentials=c),t!=null&&(u.body=typeof t=="string"?t:JSON.stringify(t));const f=yield fetch(e,u);return _e(f)})}function Ct(e,s,t){return W(this,void 0,void 0,function*(){const n={method:"GET"};s&&(n.headers=Object.assign(Object.assign({},s),{"Content-Type":"application/json"})),t&&(n.credentials=t);const c=yield fetch(e,n);return _e(c)})}Object.defineProperty(C,"__esModule",{value:!0});C.postEndpoint=Dt;C.putEndpoint=bt;C.deleteEndpoint=Rt;C.getEndpoint=Pt;const N=D;function L(e,s,t,n){const c=(0,N.insertParams)(s,t),i=(0,N.stringifyQuery)(n);return`${e}${c}${i}`}function Dt(e,s,t){const n=L(e,s,t==null?void 0:t.path,t==null?void 0:t.query);return(0,N.fetchData)(n,"POST",t==null?void 0:t.body,t==null?void 0:t.headers,t==null?void 0:t.credentials)}function bt(e,s,t){const n=L(e,s,t==null?void 0:t.path,t==null?void 0:t.query);return(0,N.fetchData)(n,"PUT",t==null?void 0:t.body,t==null?void 0:t.headers,t==null?void 0:t.credentials)}function Rt(e,s,t){const n=L(e,s,t==null?void 0:t.path,t==null?void 0:t.query);return(0,N.fetchData)(n,"DELETE",t==null?void 0:t.body,t==null?void 0:t.headers,t==null?void 0:t.credentials)}function Pt(e,s,t,n){if(n)return(0,N.getData)(n,void 0,t==null?void 0:t.credentials);const c=L(e,s,t==null?void 0:t.path,t==null?void 0:t.query);return(0,N.getData)(c,t==null?void 0:t.headers,t==null?void 0:t.credentials)}var M={};Object.defineProperty(M,"__esModule",{value:!0});M.DEFAULT_BASE_URL=void 0;M.DEFAULT_BASE_URL="https://safe-client.safe.global";var B={};Object.defineProperty(B,"__esModule",{value:!0});B.ImplementationVersionState=void 0;var K;(function(e){e.UP_TO_DATE="UP_TO_DATE",e.OUTDATED="OUTDATED",e.UNKNOWN="UNKNOWN"})(K||(B.ImplementationVersionState=K={}));var A={};Object.defineProperty(A,"__esModule",{value:!0});A.SafeAppSocialPlatforms=A.SafeAppFeatures=A.SafeAppAccessPolicyTypes=void 0;var k;(function(e){e.NoRestrictions="NO_RESTRICTIONS",e.DomainAllowlist="DOMAIN_ALLOWLIST"})(k||(A.SafeAppAccessPolicyTypes=k={}));var F;(function(e){e.BATCHED_TRANSACTIONS="BATCHED_TRANSACTIONS"})(F||(A.SafeAppFeatures=F={}));var X;(function(e){e.TWITTER="TWITTER",e.GITHUB="GITHUB",e.DISCORD="DISCORD",e.TELEGRAM="TELEGRAM"})(X||(A.SafeAppSocialPlatforms=X={}));var l={};Object.defineProperty(l,"__esModule",{value:!0});l.LabelValue=l.StartTimeValue=l.DurationType=l.DetailedExecutionInfoType=l.TransactionListItemType=l.ConflictType=l.TransactionInfoType=l.SettingsInfoType=l.TransactionTokenType=l.TransferDirection=l.TransactionStatus=l.Operation=void 0;var Q;(function(e){e[e.CALL=0]="CALL",e[e.DELEGATE=1]="DELEGATE"})(Q||(l.Operation=Q={}));var $;(function(e){e.AWAITING_CONFIRMATIONS="AWAITING_CONFIRMATIONS",e.AWAITING_EXECUTION="AWAITING_EXECUTION",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.SUCCESS="SUCCESS"})($||(l.TransactionStatus=$={}));var Y;(function(e){e.INCOMING="INCOMING",e.OUTGOING="OUTGOING",e.UNKNOWN="UNKNOWN"})(Y||(l.TransferDirection=Y={}));var J;(function(e){e.ERC20="ERC20",e.ERC721="ERC721",e.NATIVE_COIN="NATIVE_COIN"})(J||(l.TransactionTokenType=J={}));var z;(function(e){e.SET_FALLBACK_HANDLER="SET_FALLBACK_HANDLER",e.ADD_OWNER="ADD_OWNER",e.REMOVE_OWNER="REMOVE_OWNER",e.SWAP_OWNER="SWAP_OWNER",e.CHANGE_THRESHOLD="CHANGE_THRESHOLD",e.CHANGE_IMPLEMENTATION="CHANGE_IMPLEMENTATION",e.ENABLE_MODULE="ENABLE_MODULE",e.DISABLE_MODULE="DISABLE_MODULE",e.SET_GUARD="SET_GUARD",e.DELETE_GUARD="DELETE_GUARD"})(z||(l.SettingsInfoType=z={}));var Z;(function(e){e.TRANSFER="Transfer",e.SETTINGS_CHANGE="SettingsChange",e.CUSTOM="Custom",e.CREATION="Creation",e.SWAP_ORDER="SwapOrder",e.TWAP_ORDER="TwapOrder",e.SWAP_TRANSFER="SwapTransfer",e.NATIVE_STAKING_DEPOSIT="NativeStakingDeposit",e.NATIVE_STAKING_VALIDATORS_EXIT="NativeStakingValidatorsExit",e.NATIVE_STAKING_WITHDRAW="NativeStakingWithdraw"})(Z||(l.TransactionInfoType=Z={}));var x;(function(e){e.NONE="None",e.HAS_NEXT="HasNext",e.END="End"})(x||(l.ConflictType=x={}));var ee;(function(e){e.TRANSACTION="TRANSACTION",e.LABEL="LABEL",e.CONFLICT_HEADER="CONFLICT_HEADER",e.DATE_LABEL="DATE_LABEL"})(ee||(l.TransactionListItemType=ee={}));var te;(function(e){e.MULTISIG="MULTISIG",e.MODULE="MODULE"})(te||(l.DetailedExecutionInfoType=te={}));var ne;(function(e){e.AUTO="AUTO",e.LIMIT_DURATION="LIMIT_DURATION"})(ne||(l.DurationType=ne={}));var se;(function(e){e.AT_MINING_TIME="AT_MINING_TIME",e.AT_EPOCH="AT_EPOCH"})(se||(l.StartTimeValue=se={}));var ae;(function(e){e.Queued="Queued",e.Next="Next"})(ae||(l.LabelValue=ae={}));var v={};Object.defineProperty(v,"__esModule",{value:!0});v.FEATURES=v.GAS_PRICE_TYPE=v.RPC_AUTHENTICATION=void 0;var ie;(function(e){e.API_KEY_PATH="API_KEY_PATH",e.NO_AUTHENTICATION="NO_AUTHENTICATION",e.UNKNOWN="UNKNOWN"})(ie||(v.RPC_AUTHENTICATION=ie={}));var re;(function(e){e.ORACLE="ORACLE",e.FIXED="FIXED",e.FIXED_1559="FIXED1559",e.UNKNOWN="UNKNOWN"})(re||(v.GAS_PRICE_TYPE=re={}));var oe;(function(e){e.ERC721="ERC721",e.SAFE_APPS="SAFE_APPS",e.CONTRACT_INTERACTION="CONTRACT_INTERACTION",e.DOMAIN_LOOKUP="DOMAIN_LOOKUP",e.SPENDING_LIMIT="SPENDING_LIMIT",e.EIP1559="EIP1559",e.SAFE_TX_GAS_OPTIONAL="SAFE_TX_GAS_OPTIONAL",e.TX_SIMULATION="TX_SIMULATION",e.EIP1271="EIP1271"})(oe||(v.FEATURES=oe={}));var G={};Object.defineProperty(G,"__esModule",{value:!0});G.TokenType=void 0;var ce;(function(e){e.ERC20="ERC20",e.ERC721="ERC721",e.NATIVE_TOKEN="NATIVE_TOKEN",e.UNKNOWN="UNKNOWN"})(ce||(G.TokenType=ce={}));var Te={};Object.defineProperty(Te,"__esModule",{value:!0});var y={};Object.defineProperty(y,"__esModule",{value:!0});y.NativeStakingStatus=y.ConfirmationViewTypes=void 0;var de;(function(e){e.GENERIC="GENERIC",e.COW_SWAP_ORDER="COW_SWAP_ORDER",e.COW_SWAP_TWAP_ORDER="COW_SWAP_TWAP_ORDER",e.KILN_NATIVE_STAKING_DEPOSIT="KILN_NATIVE_STAKING_DEPOSIT",e.KILN_NATIVE_STAKING_VALIDATORS_EXIT="KILN_NATIVE_STAKING_VALIDATORS_EXIT",e.KILN_NATIVE_STAKING_WITHDRAW="KILN_NATIVE_STAKING_WITHDRAW"})(de||(y.ConfirmationViewTypes=de={}));var ue;(function(e){e.NOT_STAKED="NOT_STAKED",e.ACTIVATING="ACTIVATING",e.DEPOSIT_IN_PROGRESS="DEPOSIT_IN_PROGRESS",e.ACTIVE="ACTIVE",e.EXIT_REQUESTED="EXIT_REQUESTED",e.EXITING="EXITING",e.EXITED="EXITED",e.SLASHED="SLASHED"})(ue||(y.NativeStakingStatus=ue={}));var m={};Object.defineProperty(m,"__esModule",{value:!0});m.SafeMessageStatus=m.SafeMessageListItemType=void 0;var le;(function(e){e.DATE_LABEL="DATE_LABEL",e.MESSAGE="MESSAGE"})(le||(m.SafeMessageListItemType=le={}));var fe;(function(e){e.NEEDS_CONFIRMATION="NEEDS_CONFIRMATION",e.CONFIRMED="CONFIRMED"})(fe||(m.SafeMessageStatus=fe={}));var H={};Object.defineProperty(H,"__esModule",{value:!0});H.DeviceType=void 0;var he;(function(e){e.ANDROID="ANDROID",e.IOS="IOS",e.WEB="WEB"})(he||(H.DeviceType=he={}));var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});(function(e){var s=O&&O.__createBinding||(Object.create?function(a,r,o,d){d===void 0&&(d=o);var T=Object.getOwnPropertyDescriptor(r,o);(!T||("get"in T?!r.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(a,d,T)}:function(a,r,o,d){d===void 0&&(d=o),a[d]=r[o]}),t=O&&O.__exportStar||function(a,r){for(var o in a)o!=="default"&&!Object.prototype.hasOwnProperty.call(r,o)&&s(r,a,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.setBaseUrl=void 0,e.relayTransaction=f,e.getRelayCount=E,e.getSafeInfo=p,e.getIncomingTransfers=_,e.getModuleTransactions=S,e.getMultisigTransactions=pe,e.getBalances=Se,e.getFiatCurrencies=Ne,e.getOwnedSafes=Oe,e.getAllOwnedSafes=ye,e.getCollectibles=me,e.getCollectiblesPage=Ce,e.getTransactionHistory=De,e.getTransactionQueue=be,e.getTransactionDetails=Re,e.deleteTransaction=Pe,e.postSafeGasEstimation=we,e.getNonces=Le,e.proposeTransaction=Me,e.getConfirmationView=Be,e.getTxPreview=Ge,e.getChainsConfig=He,e.getChainConfig=Ue,e.getSafeApps=je,e.getMasterCopies=Ve,e.getDecodedData=We,e.getSafeMessages=qe,e.getSafeMessage=Ke,e.proposeSafeMessage=ke,e.confirmSafeMessage=Fe,e.getDelegates=Xe,e.registerDevice=Qe,e.unregisterSafe=$e,e.unregisterDevice=Ye,e.registerEmail=Je,e.changeEmail=ze,e.resendEmailVerificationCode=Ze,e.verifyEmail=xe,e.getRegisteredEmail=et,e.deleteRegisteredEmail=tt,e.registerRecoveryModule=nt,e.unsubscribeSingle=st,e.unsubscribeAll=at,e.getSafeOverviews=it,e.getContract=rt,e.getAuthNonce=ot,e.verifyAuth=ct,e.createAccount=dt,e.getAccount=ut,e.deleteAccount=lt,e.getAccountDataTypes=ft,e.getAccountDataSettings=ht,e.putAccountDataSettings=gt,e.getIndexingStatus=Et;const n=C,c=M;t(B,e),t(A,e),t(l,e),t(v,e),t(G,e),t(Te,e),t(y,e),t(m,e),t(H,e),t(Ie,e);let i=c.DEFAULT_BASE_URL;const u=a=>{i=a};e.setBaseUrl=u;function f(a,r){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/relay",{path:{chainId:a},body:r})}function E(a,r){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/relay/{address}",{path:{chainId:a,address:r}})}function p(a,r){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}",{path:{chainId:a,address:r}})}function _(a,r,o,d){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/incoming-transfers/",{path:{chainId:a,address:r},query:o},d)}function S(a,r,o,d){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/module-transactions/",{path:{chainId:a,address:r},query:o},d)}function pe(a,r,o,d){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/multisig-transactions/",{path:{chainId:a,address:r},query:o},d)}function Se(a,r,o="usd",d={}){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/balances/{currency}",{path:{chainId:a,address:r,currency:o},query:d})}function Ne(){return(0,n.getEndpoint)(i,"/v1/balances/supported-fiat-codes")}function Oe(a,r){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/owners/{address}/safes",{path:{chainId:a,address:r}})}function ye(a){return(0,n.getEndpoint)(i,"/v1/owners/{address}/safes",{path:{address:a}})}function me(a,r,o={}){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:r},query:o})}function Ce(a,r,o={},d){return(0,n.getEndpoint)(i,"/v2/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:r},query:o},d)}function De(a,r,o={},d){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/transactions/history",{path:{chainId:a,safe_address:r},query:o},d)}function be(a,r,o={},d){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/transactions/queued",{path:{chainId:a,safe_address:r},query:o},d)}function Re(a,r){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/transactions/{transactionId}",{path:{chainId:a,transactionId:r}})}function Pe(a,r,o){return(0,n.deleteEndpoint)(i,"/v1/chains/{chainId}/transactions/{safeTxHash}",{path:{chainId:a,safeTxHash:r},body:{signature:o}})}function we(a,r,o){return(0,n.postEndpoint)(i,"/v2/chains/{chainId}/safes/{safe_address}/multisig-transactions/estimations",{path:{chainId:a,safe_address:r},body:o})}function Le(a,r){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/nonces",{path:{chainId:a,safe_address:r}})}function Me(a,r,o){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/transactions/{safe_address}/propose",{path:{chainId:a,safe_address:r},body:o})}function Be(a,r,o,d,T,U){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/views/transaction-confirmation",{path:{chainId:a,safe_address:r},body:{operation:o,data:d,to:T,value:U}})}function Ge(a,r,o,d,T,U){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/transactions/{safe_address}/preview",{path:{chainId:a,safe_address:r},body:{operation:o,data:d,to:T,value:U}})}function He(a){return(0,n.getEndpoint)(i,"/v1/chains",{query:a})}function Ue(a){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}",{path:{chainId:a}})}function je(a,r={}){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safe-apps",{path:{chainId:a},query:r})}function Ve(a){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/about/master-copies",{path:{chainId:a}})}function We(a,r,o,d){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/data-decoder",{path:{chainId:a},body:{operation:r,data:o,to:d}})}function qe(a,r,o){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:r},query:{}},o)}function Ke(a,r){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/messages/{message_hash}",{path:{chainId:a,message_hash:r}})}function ke(a,r,o){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:r},body:o})}function Fe(a,r,o){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/messages/{message_hash}/signatures",{path:{chainId:a,message_hash:r},body:o})}function Xe(a,r={}){return(0,n.getEndpoint)(i,"/v2/chains/{chainId}/delegates",{path:{chainId:a},query:r})}function Qe(a){return(0,n.postEndpoint)(i,"/v1/register/notifications",{body:a})}function $e(a,r,o){return(0,n.deleteEndpoint)(i,"/v1/chains/{chainId}/notifications/devices/{uuid}/safes/{safe_address}",{path:{chainId:a,safe_address:r,uuid:o}})}function Ye(a,r){return(0,n.deleteEndpoint)(i,"/v1/chains/{chainId}/notifications/devices/{uuid}",{path:{chainId:a,uuid:r}})}function Je(a,r,o,d){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails",{path:{chainId:a,safe_address:r},body:o,headers:d})}function ze(a,r,o,d,T){return(0,n.putEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:r,signer:o},body:d,headers:T})}function Ze(a,r,o){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify-resend",{path:{chainId:a,safe_address:r,signer:o},body:""})}function xe(a,r,o,d){return(0,n.putEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify",{path:{chainId:a,safe_address:r,signer:o},body:d})}function et(a,r,o,d){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:r,signer:o},headers:d})}function tt(a,r,o,d){return(0,n.deleteEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:r,signer:o},headers:d})}function nt(a,r,o){return(0,n.postEndpoint)(i,"/v1/chains/{chainId}/safes/{safe_address}/recovery",{path:{chainId:a,safe_address:r},body:o})}function st(a){return(0,n.deleteEndpoint)(i,"/v1/subscriptions",{query:a})}function at(a){return(0,n.deleteEndpoint)(i,"/v1/subscriptions/all",{query:a})}function it(a,r){return(0,n.getEndpoint)(i,"/v1/safes",{query:Object.assign(Object.assign({},r),{safes:a.join(",")})})}function rt(a,r){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/contracts/{contractAddress}",{path:{chainId:a,contractAddress:r}})}function ot(){return(0,n.getEndpoint)(i,"/v1/auth/nonce",{credentials:"include"})}function ct(a){return(0,n.postEndpoint)(i,"/v1/auth/verify",{body:a,credentials:"include"})}function dt(a){return(0,n.postEndpoint)(i,"/v1/accounts",{body:a,credentials:"include"})}function ut(a){return(0,n.getEndpoint)(i,"/v1/accounts/{address}",{path:{address:a},credentials:"include"})}function lt(a){return(0,n.deleteEndpoint)(i,"/v1/accounts/{address}",{path:{address:a},credentials:"include"})}function ft(){return(0,n.getEndpoint)(i,"/v1/accounts/data-types")}function ht(a){return(0,n.getEndpoint)(i,"/v1/accounts/{address}/data-settings",{path:{address:a},credentials:"include"})}function gt(a,r){return(0,n.putEndpoint)(i,"/v1/accounts/{address}/data-settings",{path:{address:a},body:r,credentials:"include"})}function Et(a){return(0,n.getEndpoint)(i,"/v1/chains/{chainId}/about/indexing",{path:{chainId:a}})}})(b);class wt{constructor(s){this.communicator=s}async getBySafeTxHash(s){if(!s)throw new Error("Invalid safeTxHash");return(await this.communicator.send(h.getTxBySafeTxHash,{safeTxHash:s})).data}async signMessage(s){const t={message:s};return(await this.communicator.send(h.signMessage,t)).data}async signTypedMessage(s){if(!V(s))throw new Error("Invalid typed data");return(await this.communicator.send(h.signTypedMessage,{typedData:s})).data}async send({txs:s,params:t}){if(!s||!s.length)throw new Error("No transactions were passed");const n={txs:s,params:t};return(await this.communicator.send(h.sendTransactions,n)).data}}const g={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"},I={defaultBlockParam:(e="latest")=>e,returnFullTxObjectParam:(e=!1)=>e,blockNumberToHex:e=>Number.isInteger(e)?`0x${e.toString(16)}`:e};class Lt{constructor(s){this.communicator=s,this.call=this.buildRequest({call:g.eth_call,formatters:[null,I.defaultBlockParam]}),this.getBalance=this.buildRequest({call:g.eth_getBalance,formatters:[null,I.defaultBlockParam]}),this.getCode=this.buildRequest({call:g.eth_getCode,formatters:[null,I.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:g.eth_getStorageAt,formatters:[null,I.blockNumberToHex,I.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:g.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:g.eth_getBlockByHash,formatters:[null,I.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:g.eth_getBlockByNumber,formatters:[I.blockNumberToHex,I.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:g.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:g.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:g.eth_getTransactionCount,formatters:[null,I.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:g.eth_gasPrice}),this.getEstimateGas=t=>this.buildRequest({call:g.eth_estimateGas})([t]),this.setSafeSettings=this.buildRequest({call:g.safe_setSettings})}buildRequest(s){const{call:t,formatters:n}=s;return async c=>{n&&Array.isArray(c)&&n.forEach((f,E)=>{f&&(c[E]=f(c[E]))});const i={call:t,params:c||[]};return(await this.communicator.send(h.rpcCall,i)).data}}}const Mt="0x1626ba7e",Bt="0x20c13b0b",j=4001;class R extends Error{constructor(s,t,n){super(s),this.code=t,this.data=n,Object.setPrototypeOf(this,R.prototype)}}class Ae{constructor(s){this.communicator=s}async getPermissions(){return(await this.communicator.send(h.wallet_getPermissions,void 0)).data}async requestPermissions(s){if(!this.isPermissionRequestValid(s))throw new R("Permissions request is invalid",j);try{return(await this.communicator.send(h.wallet_requestPermissions,s)).data}catch{throw new R("Permissions rejected",j)}}isPermissionRequestValid(s){return s.every(t=>typeof t=="object"?Object.keys(t).every(n=>!!Object.values(w).includes(n)):!1)}}const ge=(e,s)=>s.some(t=>t.parentCapability===e),Gt=()=>(e,s,t)=>{const n=t.value;return t.value=async function(){const c=new Ae(this.communicator);let i=await c.getPermissions();if(ge(s,i)||(i=await c.requestPermissions([{[s]:{}}])),!ge(s,i))throw new R("Permissions rejected",j);return n.apply(this)},t};var Ht=function(e,s,t,n){var c=arguments.length,i=c<3?s:n===null?n=Object.getOwnPropertyDescriptor(s,t):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,s,t,n);else for(var f=e.length-1;f>=0;f--)(u=e[f])&&(i=(c<3?u(i):c>3?u(s,t,i):u(s,t))||i);return c>3&&i&&Object.defineProperty(s,t,i),i};class ve{constructor(s){this.communicator=s}async getChainInfo(){return(await this.communicator.send(h.getChainInfo,void 0)).data}async getInfo(){return(await this.communicator.send(h.getSafeInfo,void 0)).data}async experimental_getBalances({currency:s="usd"}={}){return(await this.communicator.send(h.getSafeBalances,{currency:s})).data}async check1271Signature(s,t="0x"){const n=await this.getInfo(),c=q({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[s,t]}),i={call:g.eth_call,params:[{to:n.safeAddress,data:c},"latest"]};try{return(await this.communicator.send(h.rpcCall,i)).data.slice(0,10).toLowerCase()===Mt}catch{return!1}}async check1271SignatureBytes(s,t="0x"){const n=await this.getInfo(),c=q({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[s,t]}),i={call:g.eth_call,params:[{to:n.safeAddress,data:c},"latest"]};try{return(await this.communicator.send(h.rpcCall,i)).data.slice(0,10).toLowerCase()===Bt}catch{return!1}}calculateMessageHash(s){return _t(s)}calculateTypedMessageHash(s){const t=typeof s.domain.chainId=="object"?s.domain.chainId.toNumber():Number(s.domain.chainId);let n=s.primaryType;if(!n){const c=Object.values(s.types),i=Object.keys(s.types).filter(u=>c.every(f=>f.every(({type:E})=>E.replace("[","").replace("]","")!==u)));if(i.length===0||i.length>1)throw new Error("Please specify primaryType");n=i[0]}return Tt({message:s.message,domain:{...s.domain,chainId:t,verifyingContract:s.domain.verifyingContract,salt:s.domain.salt},types:s.types,primaryType:n})}async getOffChainSignature(s){return(await this.communicator.send(h.getOffChainSignature,s)).data}async isMessageSigned(s,t="0x"){let n;if(typeof s=="string"&&(n=async()=>{const c=this.calculateMessageHash(s);return await this.isMessageHashSigned(c,t)}),V(s)&&(n=async()=>{const c=this.calculateTypedMessageHash(s);return await this.isMessageHashSigned(c,t)}),n)return await n();throw new Error("Invalid message type")}async isMessageHashSigned(s,t="0x"){const n=[this.check1271Signature.bind(this),this.check1271SignatureBytes.bind(this)];for(const c of n)if(await c(s,t))return!0;return!1}async getEnvironmentInfo(){return(await this.communicator.send(h.getEnvironmentInfo,void 0)).data}async requestAddressBook(){return(await this.communicator.send(h.requestAddressBook,void 0)).data}}Ht([Gt()],ve.prototype,"requestAddressBook",null);class Ut{constructor(s={}){const{allowedDomains:t=null,debug:n=!1}=s;this.communicator=new pt(t,n),this.eth=new Lt(this.communicator),this.txs=new wt(this.communicator),this.safe=new ve(this.communicator),this.wallet=new Ae(this.communicator)}}const Wt=Object.freeze(Object.defineProperty({__proto__:null,MessageFormatter:P,get Methods(){return h},Operation:b.Operation,RPC_CALLS:g,get RestrictedMethods(){return w},TokenType:b.TokenType,TransactionStatus:b.TransactionStatus,TransferDirection:b.TransferDirection,default:Ut,getSDKVersion:Ee,isObjectEIP712TypedData:V},Symbol.toStringTag,{value:"Module"}));export{Wt as e};
