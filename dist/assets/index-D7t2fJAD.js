const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BFspv573.js","assets/hashTypedData-B8gpMFRD.js","assets/isAddress-CIAEL9PV.js","assets/isAddressEqual-B_UAe8sB.js","assets/embedded-wallet-Qzcsg2k1.js","assets/index-Dsw9Q5vm.js","assets/index-CU4o6UH_.js","assets/if-defined-BwVBllEi.js","assets/ref-Cl-C3jLh.js","assets/index-B9kbqu5x.js","assets/HelpersUtil-dLKEqds-.js","assets/index-H5DrwjJG.js","assets/index-BSaj4oBj.js","assets/index-FZjozNdn.js","assets/index-DNPgb8sP.js","assets/index-COp9HEHf.js","assets/NavigationUtil-DmfK5sOV.js","assets/email-Bk1kq5Lr.js","assets/index-DCGRijB-.js","assets/index-BrYedRE6.js","assets/socials-CrtpaJlE.js","assets/index-DXHOJUCo.js","assets/index-De_oyv34.js","assets/index-lVhptGkB.js","assets/index-tBhd7db2.js","assets/index-D_6qlalH.js","assets/swaps-BYKJq-q0.js","assets/index-C4cUd-Yz.js","assets/index-rk38CYle.js","assets/SwapController-CahFOErc.js","assets/index-BqVqeKYs.js","assets/send-ONcJxy9f.js","assets/index-DxK4bE-V.js","assets/index-BZe_N4qX.js","assets/index-Cu5-lKU1.js","assets/index-BR8CO6Dn.js","assets/receive-BSupas26.js","assets/onramp-D4274kAk.js","assets/index-DGKYysLL.js","assets/index-BY1_RrzZ.js","assets/index-D_yBUARQ.js","assets/ExchangeController-QCsYSHT_.js","assets/pay-with-exchange-B2V9U0n7.js","assets/transactions-BGUWgCGU.js","assets/index-CMqBCBFf.js","assets/index-DYLTG65y.js","assets/index-BJhKpcfq.js","assets/index-Cs_VkXLa.js","assets/index-B8gA1aOg.js","assets/data-capture-DFZ8MMYu.js","assets/features-DRZu5TbV.js","assets/index-CZbXSo3S.js","assets/index-BFZfdv4H.js","assets/w3m-modal-DfMUZQH4.js","assets/SafeProvider-C8TvZVYd.js","assets/index-Cbi1aINv.js","assets/index-_YhPbmNM.js"])))=>i.map(i=>d[i]);
var PV=Object.defineProperty;var AR=t=>{throw TypeError(t)};var OV=(t,e,n)=>e in t?PV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var G=(t,e,n)=>OV(t,typeof e!="symbol"?e+"":e,n),IN=(t,e,n)=>e.has(t)||AR("Cannot "+n);var R=(t,e,n)=>(IN(t,e,"read from private field"),n?n.call(t):e.get(t)),se=(t,e,n)=>e.has(t)?AR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),V=(t,e,n,r)=>(IN(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ce=(t,e,n)=>(IN(t,e,"access private method"),n);var d0=(t,e,n,r)=>({set _(s){V(t,e,s,n)},get _(){return R(t,e,r)}});function LU(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var tc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function BU(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var $U={exports:{}},aC={},FU={exports:{}},Mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mx=Symbol.for("react.element"),DV=Symbol.for("react.portal"),UV=Symbol.for("react.fragment"),MV=Symbol.for("react.strict_mode"),LV=Symbol.for("react.profiler"),BV=Symbol.for("react.provider"),$V=Symbol.for("react.context"),FV=Symbol.for("react.forward_ref"),zV=Symbol.for("react.suspense"),HV=Symbol.for("react.memo"),VV=Symbol.for("react.lazy"),SR=Symbol.iterator;function WV(t){return t===null||typeof t!="object"?null:(t=SR&&t[SR]||t["@@iterator"],typeof t=="function"?t:null)}var zU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HU=Object.assign,VU={};function Lg(t,e,n){this.props=t,this.context=e,this.refs=VU,this.updater=n||zU}Lg.prototype.isReactComponent={};Lg.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Lg.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function WU(){}WU.prototype=Lg.prototype;function xk(t,e,n){this.props=t,this.context=e,this.refs=VU,this.updater=n||zU}var bk=xk.prototype=new WU;bk.constructor=xk;HU(bk,Lg.prototype);bk.isPureReactComponent=!0;var TR=Array.isArray,qU=Object.prototype.hasOwnProperty,vk={current:null},KU={key:!0,ref:!0,__self:!0,__source:!0};function GU(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)qU.call(e,r)&&!KU.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var l=Array(c),d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Mx,type:t,key:i,ref:o,props:s,_owner:vk.current}}function qV(t,e){return{$$typeof:Mx,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ek(t){return typeof t=="object"&&t!==null&&t.$$typeof===Mx}function KV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var _R=/\/+/g;function jN(t,e){return typeof t=="object"&&t!==null&&t.key!=null?KV(""+t.key):e.toString(36)}function jv(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Mx:case DV:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+jN(o,0):r,TR(s)?(n="",t!=null&&(n=t.replace(_R,"$&/")+"/"),jv(s,e,n,"",function(d){return d})):s!=null&&(Ek(s)&&(s=qV(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(_R,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",TR(t))for(var c=0;c<t.length;c++){i=t[c];var l=r+jN(i,c);o+=jv(i,e,n,l,s)}else if(l=WV(t),typeof l=="function")for(t=l.call(t),c=0;!(i=t.next()).done;)i=i.value,l=r+jN(i,c++),o+=jv(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function xb(t,e,n){if(t==null)return t;var r=[],s=0;return jv(t,r,"","",function(i){return e.call(n,i,s++)}),r}function GV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Js={current:null},Rv={transition:null},YV={ReactCurrentDispatcher:Js,ReactCurrentBatchConfig:Rv,ReactCurrentOwner:vk};function YU(){throw Error("act(...) is not supported in production builds of React.")}Mt.Children={map:xb,forEach:function(t,e,n){xb(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xb(t,function(){e++}),e},toArray:function(t){return xb(t,function(e){return e})||[]},only:function(t){if(!Ek(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Mt.Component=Lg;Mt.Fragment=UV;Mt.Profiler=LV;Mt.PureComponent=xk;Mt.StrictMode=MV;Mt.Suspense=zV;Mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YV;Mt.act=YU;Mt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=HU({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=vk.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)qU.call(e,l)&&!KU.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&c!==void 0?c[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){c=Array(l);for(var d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:Mx,type:t.type,key:s,ref:i,props:r,_owner:o}};Mt.createContext=function(t){return t={$$typeof:$V,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:BV,_context:t},t.Consumer=t};Mt.createElement=GU;Mt.createFactory=function(t){var e=GU.bind(null,t);return e.type=t,e};Mt.createRef=function(){return{current:null}};Mt.forwardRef=function(t){return{$$typeof:FV,render:t}};Mt.isValidElement=Ek;Mt.lazy=function(t){return{$$typeof:VV,_payload:{_status:-1,_result:t},_init:GV}};Mt.memo=function(t,e){return{$$typeof:HV,type:t,compare:e===void 0?null:e}};Mt.startTransition=function(t){var e=Rv.transition;Rv.transition={};try{t()}finally{Rv.transition=e}};Mt.unstable_act=YU;Mt.useCallback=function(t,e){return Js.current.useCallback(t,e)};Mt.useContext=function(t){return Js.current.useContext(t)};Mt.useDebugValue=function(){};Mt.useDeferredValue=function(t){return Js.current.useDeferredValue(t)};Mt.useEffect=function(t,e){return Js.current.useEffect(t,e)};Mt.useId=function(){return Js.current.useId()};Mt.useImperativeHandle=function(t,e,n){return Js.current.useImperativeHandle(t,e,n)};Mt.useInsertionEffect=function(t,e){return Js.current.useInsertionEffect(t,e)};Mt.useLayoutEffect=function(t,e){return Js.current.useLayoutEffect(t,e)};Mt.useMemo=function(t,e){return Js.current.useMemo(t,e)};Mt.useReducer=function(t,e,n){return Js.current.useReducer(t,e,n)};Mt.useRef=function(t){return Js.current.useRef(t)};Mt.useState=function(t){return Js.current.useState(t)};Mt.useSyncExternalStore=function(t,e,n){return Js.current.useSyncExternalStore(t,e,n)};Mt.useTransition=function(){return Js.current.useTransition()};Mt.version="18.3.1";FU.exports=Mt;var A=FU.exports;const Lx=Mg(A),QV=LU({__proto__:null,default:Lx},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JV=A,ZV=Symbol.for("react.element"),XV=Symbol.for("react.fragment"),eW=Object.prototype.hasOwnProperty,tW=JV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nW={key:!0,ref:!0,__self:!0,__source:!0};function QU(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)eW.call(e,r)&&!nW.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ZV,type:t,key:i,ref:o,props:s,_owner:tW.current}}aC.Fragment=XV;aC.jsx=QU;aC.jsxs=QU;$U.exports=aC;var a=$U.exports,JU={exports:{}},to={},ZU={exports:{}},XU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,M){var B=O.length;O.push(M);e:for(;0<B;){var W=B-1>>>1,Z=O[W];if(0<s(Z,M))O[W]=M,O[B]=Z,B=W;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var M=O[0],B=O.pop();if(B!==M){O[0]=B;e:for(var W=0,Z=O.length,ie=Z>>>1;W<ie;){var ae=2*(W+1)-1,oe=O[ae],Ne=ae+1,de=O[Ne];if(0>s(oe,B))Ne<Z&&0>s(de,oe)?(O[W]=de,O[Ne]=B,W=Ne):(O[W]=oe,O[ae]=B,W=ae);else if(Ne<Z&&0>s(de,B))O[W]=de,O[Ne]=B,W=Ne;else break e}}return M}function s(O,M){var B=O.sortIndex-M.sortIndex;return B!==0?B:O.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var l=[],d=[],u=1,h=null,f=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var M=n(d);M!==null;){if(M.callback===null)r(d);else if(M.startTime<=O)r(d),M.sortIndex=M.expirationTime,e(l,M);else break;M=n(d)}}function v(O){if(g=!1,b(O),!m)if(n(l)!==null)m=!0,_(E);else{var M=n(d);M!==null&&L(v,M.startTime-O)}}function E(O,M){m=!1,g&&(g=!1,x(S),S=-1),p=!0;var B=f;try{for(b(M),h=n(l);h!==null&&(!(h.expirationTime>M)||O&&!F());){var W=h.callback;if(typeof W=="function"){h.callback=null,f=h.priorityLevel;var Z=W(h.expirationTime<=M);M=t.unstable_now(),typeof Z=="function"?h.callback=Z:h===n(l)&&r(l),b(M)}else r(l);h=n(l)}if(h!==null)var ie=!0;else{var ae=n(d);ae!==null&&L(v,ae.startTime-M),ie=!1}return ie}finally{h=null,f=B,p=!1}}var k=!1,C=null,S=-1,N=5,I=-1;function F(){return!(t.unstable_now()-I<N)}function P(){if(C!==null){var O=t.unstable_now();I=O;var M=!0;try{M=C(!0,O)}finally{M?H():(k=!1,C=null)}}else k=!1}var H;if(typeof w=="function")H=function(){w(P)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,T=z.port2;z.port1.onmessage=P,H=function(){T.postMessage(null)}}else H=function(){y(P,0)};function _(O){C=O,k||(k=!0,H())}function L(O,M){S=y(function(){O(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,_(E))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var B=f;f=M;try{return O()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,M){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var B=f;f=O;try{return M()}finally{f=B}},t.unstable_scheduleCallback=function(O,M,B){var W=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?W+B:W):B=W,O){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=B+Z,O={id:u++,callback:M,priorityLevel:O,startTime:B,expirationTime:Z,sortIndex:-1},B>W?(O.sortIndex=B,e(d,O),n(l)===null&&O===n(d)&&(g?(x(S),S=-1):g=!0,L(v,B-W))):(O.sortIndex=Z,e(l,O),m||p||(m=!0,_(E))),O},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(O){var M=f;return function(){var B=f;f=M;try{return O.apply(this,arguments)}finally{f=B}}}})(XU);ZU.exports=XU;var rW=ZU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sW=A,Xi=rW;function Te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eM=new Set,Vy={};function _f(t,e){ng(t,e),ng(t+"Capture",e)}function ng(t,e){for(Vy[t]=e,t=0;t<e.length;t++)eM.add(e[t])}var Cl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),YS=Object.prototype.hasOwnProperty,iW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kR={},IR={};function oW(t){return YS.call(IR,t)?!0:YS.call(kR,t)?!1:iW.test(t)?IR[t]=!0:(kR[t]=!0,!1)}function aW(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function cW(t,e,n,r){if(e===null||typeof e>"u"||aW(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zs(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var as={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){as[t]=new Zs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];as[e]=new Zs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){as[t]=new Zs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){as[t]=new Zs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){as[t]=new Zs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){as[t]=new Zs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){as[t]=new Zs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){as[t]=new Zs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){as[t]=new Zs(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ck=/[\-:]([a-z])/g;function Nk(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ck,Nk);as[e]=new Zs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ck,Nk);as[e]=new Zs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ck,Nk);as[e]=new Zs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){as[t]=new Zs(t,1,!1,t.toLowerCase(),null,!1,!1)});as.xlinkHref=new Zs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){as[t]=new Zs(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ak(t,e,n,r){var s=as.hasOwnProperty(e)?as[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cW(e,n,s,r)&&(n=null),r||s===null?oW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ul=sW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bb=Symbol.for("react.element"),Sp=Symbol.for("react.portal"),Tp=Symbol.for("react.fragment"),Sk=Symbol.for("react.strict_mode"),QS=Symbol.for("react.profiler"),tM=Symbol.for("react.provider"),nM=Symbol.for("react.context"),Tk=Symbol.for("react.forward_ref"),JS=Symbol.for("react.suspense"),ZS=Symbol.for("react.suspense_list"),_k=Symbol.for("react.memo"),cd=Symbol.for("react.lazy"),rM=Symbol.for("react.offscreen"),jR=Symbol.iterator;function u0(t){return t===null||typeof t!="object"?null:(t=jR&&t[jR]||t["@@iterator"],typeof t=="function"?t:null)}var Jn=Object.assign,RN;function G0(t){if(RN===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);RN=e&&e[1]||""}return`
`+RN+t}var PN=!1;function ON(t,e){if(!t||PN)return"";PN=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=c);break}}}finally{PN=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?G0(t):""}function lW(t){switch(t.tag){case 5:return G0(t.type);case 16:return G0("Lazy");case 13:return G0("Suspense");case 19:return G0("SuspenseList");case 0:case 2:case 15:return t=ON(t.type,!1),t;case 11:return t=ON(t.type.render,!1),t;case 1:return t=ON(t.type,!0),t;default:return""}}function XS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Tp:return"Fragment";case Sp:return"Portal";case QS:return"Profiler";case Sk:return"StrictMode";case JS:return"Suspense";case ZS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case nM:return(t.displayName||"Context")+".Consumer";case tM:return(t._context.displayName||"Context")+".Provider";case Tk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _k:return e=t.displayName||null,e!==null?e:XS(t.type)||"Memo";case cd:e=t._payload,t=t._init;try{return XS(t(e))}catch{}}return null}function dW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return XS(e);case 8:return e===Sk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function su(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function sM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uW(t){var e=sM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vb(t){t._valueTracker||(t._valueTracker=uW(t))}function iM(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=sM(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function A1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function e2(t,e){var n=e.checked;return Jn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function RR(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=su(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function oM(t,e){e=e.checked,e!=null&&Ak(t,"checked",e,!1)}function t2(t,e){oM(t,e);var n=su(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?n2(t,e.type,n):e.hasOwnProperty("defaultValue")&&n2(t,e.type,su(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function PR(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function n2(t,e,n){(e!=="number"||A1(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Y0=Array.isArray;function Zp(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+su(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function r2(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Te(91));return Jn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function OR(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Te(92));if(Y0(n)){if(1<n.length)throw Error(Te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:su(n)}}function aM(t,e){var n=su(e.value),r=su(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function DR(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cM(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function s2(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cM(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Eb,lM=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Eb=Eb||document.createElement("div"),Eb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Eb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Wy(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hW=["Webkit","ms","Moz","O"];Object.keys(hy).forEach(function(t){hW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hy[e]=hy[t]})});function dM(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hy.hasOwnProperty(t)&&hy[t]?(""+e).trim():e+"px"}function uM(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=dM(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var fW=Jn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function i2(t,e){if(e){if(fW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Te(62))}}function o2(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var a2=null;function kk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var c2=null,Xp=null,em=null;function UR(t){if(t=Fx(t)){if(typeof c2!="function")throw Error(Te(280));var e=t.stateNode;e&&(e=hC(e),c2(t.stateNode,t.type,e))}}function hM(t){Xp?em?em.push(t):em=[t]:Xp=t}function fM(){if(Xp){var t=Xp,e=em;if(em=Xp=null,UR(t),e)for(t=0;t<e.length;t++)UR(e[t])}}function pM(t,e){return t(e)}function mM(){}var DN=!1;function gM(t,e,n){if(DN)return t(e,n);DN=!0;try{return pM(t,e,n)}finally{DN=!1,(Xp!==null||em!==null)&&(mM(),fM())}}function qy(t,e){var n=t.stateNode;if(n===null)return null;var r=hC(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Te(231,e,typeof n));return n}var l2=!1;if(Cl)try{var h0={};Object.defineProperty(h0,"passive",{get:function(){l2=!0}}),window.addEventListener("test",h0,h0),window.removeEventListener("test",h0,h0)}catch{l2=!1}function pW(t,e,n,r,s,i,o,c,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(u){this.onError(u)}}var fy=!1,S1=null,T1=!1,d2=null,mW={onError:function(t){fy=!0,S1=t}};function gW(t,e,n,r,s,i,o,c,l){fy=!1,S1=null,pW.apply(mW,arguments)}function yW(t,e,n,r,s,i,o,c,l){if(gW.apply(this,arguments),fy){if(fy){var d=S1;fy=!1,S1=null}else throw Error(Te(198));T1||(T1=!0,d2=d)}}function kf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function yM(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function MR(t){if(kf(t)!==t)throw Error(Te(188))}function wW(t){var e=t.alternate;if(!e){if(e=kf(t),e===null)throw Error(Te(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return MR(s),t;if(i===r)return MR(s),e;i=i.sibling}throw Error(Te(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(Te(189))}}if(n.alternate!==r)throw Error(Te(190))}if(n.tag!==3)throw Error(Te(188));return n.stateNode.current===n?t:e}function wM(t){return t=wW(t),t!==null?xM(t):null}function xM(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=xM(t);if(e!==null)return e;t=t.sibling}return null}var bM=Xi.unstable_scheduleCallback,LR=Xi.unstable_cancelCallback,xW=Xi.unstable_shouldYield,bW=Xi.unstable_requestPaint,dr=Xi.unstable_now,vW=Xi.unstable_getCurrentPriorityLevel,Ik=Xi.unstable_ImmediatePriority,vM=Xi.unstable_UserBlockingPriority,_1=Xi.unstable_NormalPriority,EW=Xi.unstable_LowPriority,EM=Xi.unstable_IdlePriority,cC=null,fc=null;function CW(t){if(fc&&typeof fc.onCommitFiberRoot=="function")try{fc.onCommitFiberRoot(cC,t,void 0,(t.current.flags&128)===128)}catch{}}var ya=Math.clz32?Math.clz32:SW,NW=Math.log,AW=Math.LN2;function SW(t){return t>>>=0,t===0?32:31-(NW(t)/AW|0)|0}var Cb=64,Nb=4194304;function Q0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function k1(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=Q0(c):(i&=o,i!==0&&(r=Q0(i)))}else o=n&~s,o!==0?r=Q0(o):i!==0&&(r=Q0(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ya(e),s=1<<n,r|=t[n],e&=~s;return r}function TW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _W(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ya(i),c=1<<o,l=s[o];l===-1?(!(c&n)||c&r)&&(s[o]=TW(c,e)):l<=e&&(t.expiredLanes|=c),i&=~c}}function u2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function CM(){var t=Cb;return Cb<<=1,!(Cb&4194240)&&(Cb=64),t}function UN(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bx(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ya(e),t[e]=n}function kW(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ya(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function jk(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ya(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var xn=0;function NM(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var AM,Rk,SM,TM,_M,h2=!1,Ab=[],Vd=null,Wd=null,qd=null,Ky=new Map,Gy=new Map,md=[],IW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function BR(t,e){switch(t){case"focusin":case"focusout":Vd=null;break;case"dragenter":case"dragleave":Wd=null;break;case"mouseover":case"mouseout":qd=null;break;case"pointerover":case"pointerout":Ky.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gy.delete(e.pointerId)}}function f0(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Fx(e),e!==null&&Rk(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function jW(t,e,n,r,s){switch(e){case"focusin":return Vd=f0(Vd,t,e,n,r,s),!0;case"dragenter":return Wd=f0(Wd,t,e,n,r,s),!0;case"mouseover":return qd=f0(qd,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ky.set(i,f0(Ky.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Gy.set(i,f0(Gy.get(i)||null,t,e,n,r,s)),!0}return!1}function kM(t){var e=oh(t.target);if(e!==null){var n=kf(e);if(n!==null){if(e=n.tag,e===13){if(e=yM(n),e!==null){t.blockedOn=e,_M(t.priority,function(){SM(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Pv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=f2(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);a2=r,n.target.dispatchEvent(r),a2=null}else return e=Fx(n),e!==null&&Rk(e),t.blockedOn=n,!1;e.shift()}return!0}function $R(t,e,n){Pv(t)&&n.delete(e)}function RW(){h2=!1,Vd!==null&&Pv(Vd)&&(Vd=null),Wd!==null&&Pv(Wd)&&(Wd=null),qd!==null&&Pv(qd)&&(qd=null),Ky.forEach($R),Gy.forEach($R)}function p0(t,e){t.blockedOn===e&&(t.blockedOn=null,h2||(h2=!0,Xi.unstable_scheduleCallback(Xi.unstable_NormalPriority,RW)))}function Yy(t){function e(s){return p0(s,t)}if(0<Ab.length){p0(Ab[0],t);for(var n=1;n<Ab.length;n++){var r=Ab[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Vd!==null&&p0(Vd,t),Wd!==null&&p0(Wd,t),qd!==null&&p0(qd,t),Ky.forEach(e),Gy.forEach(e),n=0;n<md.length;n++)r=md[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<md.length&&(n=md[0],n.blockedOn===null);)kM(n),n.blockedOn===null&&md.shift()}var tm=Ul.ReactCurrentBatchConfig,I1=!0;function PW(t,e,n,r){var s=xn,i=tm.transition;tm.transition=null;try{xn=1,Pk(t,e,n,r)}finally{xn=s,tm.transition=i}}function OW(t,e,n,r){var s=xn,i=tm.transition;tm.transition=null;try{xn=4,Pk(t,e,n,r)}finally{xn=s,tm.transition=i}}function Pk(t,e,n,r){if(I1){var s=f2(t,e,n,r);if(s===null)qN(t,e,r,j1,n),BR(t,r);else if(jW(s,t,e,n,r))r.stopPropagation();else if(BR(t,r),e&4&&-1<IW.indexOf(t)){for(;s!==null;){var i=Fx(s);if(i!==null&&AM(i),i=f2(t,e,n,r),i===null&&qN(t,e,r,j1,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else qN(t,e,r,null,n)}}var j1=null;function f2(t,e,n,r){if(j1=null,t=kk(r),t=oh(t),t!==null)if(e=kf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=yM(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return j1=t,null}function IM(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vW()){case Ik:return 1;case vM:return 4;case _1:case EW:return 16;case EM:return 536870912;default:return 16}default:return 16}}var Bd=null,Ok=null,Ov=null;function jM(){if(Ov)return Ov;var t,e=Ok,n=e.length,r,s="value"in Bd?Bd.value:Bd.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ov=s.slice(t,1<r?1-r:void 0)}function Dv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sb(){return!0}function FR(){return!1}function no(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sb:FR,this.isPropagationStopped=FR,this}return Jn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sb)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sb)},persist:function(){},isPersistent:Sb}),e}var Bg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dk=no(Bg),$x=Jn({},Bg,{view:0,detail:0}),DW=no($x),MN,LN,m0,lC=Jn({},$x,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uk,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==m0&&(m0&&t.type==="mousemove"?(MN=t.screenX-m0.screenX,LN=t.screenY-m0.screenY):LN=MN=0,m0=t),MN)},movementY:function(t){return"movementY"in t?t.movementY:LN}}),zR=no(lC),UW=Jn({},lC,{dataTransfer:0}),MW=no(UW),LW=Jn({},$x,{relatedTarget:0}),BN=no(LW),BW=Jn({},Bg,{animationName:0,elapsedTime:0,pseudoElement:0}),$W=no(BW),FW=Jn({},Bg,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),zW=no(FW),HW=Jn({},Bg,{data:0}),HR=no(HW),VW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qW[t])?!!e[t]:!1}function Uk(){return KW}var GW=Jn({},$x,{key:function(t){if(t.key){var e=VW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?WW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uk,charCode:function(t){return t.type==="keypress"?Dv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),YW=no(GW),QW=Jn({},lC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VR=no(QW),JW=Jn({},$x,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uk}),ZW=no(JW),XW=Jn({},Bg,{propertyName:0,elapsedTime:0,pseudoElement:0}),eq=no(XW),tq=Jn({},lC,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),nq=no(tq),rq=[9,13,27,32],Mk=Cl&&"CompositionEvent"in window,py=null;Cl&&"documentMode"in document&&(py=document.documentMode);var sq=Cl&&"TextEvent"in window&&!py,RM=Cl&&(!Mk||py&&8<py&&11>=py),WR=" ",qR=!1;function PM(t,e){switch(t){case"keyup":return rq.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function OM(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var _p=!1;function iq(t,e){switch(t){case"compositionend":return OM(e);case"keypress":return e.which!==32?null:(qR=!0,WR);case"textInput":return t=e.data,t===WR&&qR?null:t;default:return null}}function oq(t,e){if(_p)return t==="compositionend"||!Mk&&PM(t,e)?(t=jM(),Ov=Ok=Bd=null,_p=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return RM&&e.locale!=="ko"?null:e.data;default:return null}}var aq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!aq[t.type]:e==="textarea"}function DM(t,e,n,r){hM(r),e=R1(e,"onChange"),0<e.length&&(n=new Dk("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var my=null,Qy=null;function cq(t){qM(t,0)}function dC(t){var e=jp(t);if(iM(e))return t}function lq(t,e){if(t==="change")return e}var UM=!1;if(Cl){var $N;if(Cl){var FN="oninput"in document;if(!FN){var GR=document.createElement("div");GR.setAttribute("oninput","return;"),FN=typeof GR.oninput=="function"}$N=FN}else $N=!1;UM=$N&&(!document.documentMode||9<document.documentMode)}function YR(){my&&(my.detachEvent("onpropertychange",MM),Qy=my=null)}function MM(t){if(t.propertyName==="value"&&dC(Qy)){var e=[];DM(e,Qy,t,kk(t)),gM(cq,e)}}function dq(t,e,n){t==="focusin"?(YR(),my=e,Qy=n,my.attachEvent("onpropertychange",MM)):t==="focusout"&&YR()}function uq(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return dC(Qy)}function hq(t,e){if(t==="click")return dC(e)}function fq(t,e){if(t==="input"||t==="change")return dC(e)}function pq(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ca=typeof Object.is=="function"?Object.is:pq;function Jy(t,e){if(Ca(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!YS.call(e,s)||!Ca(t[s],e[s]))return!1}return!0}function QR(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function JR(t,e){var n=QR(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=QR(n)}}function LM(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?LM(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function BM(){for(var t=window,e=A1();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=A1(t.document)}return e}function Lk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mq(t){var e=BM(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&LM(n.ownerDocument.documentElement,n)){if(r!==null&&Lk(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=JR(n,i);var o=JR(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gq=Cl&&"documentMode"in document&&11>=document.documentMode,kp=null,p2=null,gy=null,m2=!1;function ZR(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;m2||kp==null||kp!==A1(r)||(r=kp,"selectionStart"in r&&Lk(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),gy&&Jy(gy,r)||(gy=r,r=R1(p2,"onSelect"),0<r.length&&(e=new Dk("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=kp)))}function Tb(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ip={animationend:Tb("Animation","AnimationEnd"),animationiteration:Tb("Animation","AnimationIteration"),animationstart:Tb("Animation","AnimationStart"),transitionend:Tb("Transition","TransitionEnd")},zN={},$M={};Cl&&($M=document.createElement("div").style,"AnimationEvent"in window||(delete Ip.animationend.animation,delete Ip.animationiteration.animation,delete Ip.animationstart.animation),"TransitionEvent"in window||delete Ip.transitionend.transition);function uC(t){if(zN[t])return zN[t];if(!Ip[t])return t;var e=Ip[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in $M)return zN[t]=e[n];return t}var FM=uC("animationend"),zM=uC("animationiteration"),HM=uC("animationstart"),VM=uC("transitionend"),WM=new Map,XR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gu(t,e){WM.set(t,e),_f(e,[t])}for(var HN=0;HN<XR.length;HN++){var VN=XR[HN],yq=VN.toLowerCase(),wq=VN[0].toUpperCase()+VN.slice(1);gu(yq,"on"+wq)}gu(FM,"onAnimationEnd");gu(zM,"onAnimationIteration");gu(HM,"onAnimationStart");gu("dblclick","onDoubleClick");gu("focusin","onFocus");gu("focusout","onBlur");gu(VM,"onTransitionEnd");ng("onMouseEnter",["mouseout","mouseover"]);ng("onMouseLeave",["mouseout","mouseover"]);ng("onPointerEnter",["pointerout","pointerover"]);ng("onPointerLeave",["pointerout","pointerover"]);_f("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_f("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_f("onBeforeInput",["compositionend","keypress","textInput","paste"]);_f("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_f("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_f("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var J0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xq=new Set("cancel close invalid load scroll toggle".split(" ").concat(J0));function eP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,yW(r,e,void 0,t),t.currentTarget=null}function qM(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],l=c.instance,d=c.currentTarget;if(c=c.listener,l!==i&&s.isPropagationStopped())break e;eP(s,c,d),i=l}else for(o=0;o<r.length;o++){if(c=r[o],l=c.instance,d=c.currentTarget,c=c.listener,l!==i&&s.isPropagationStopped())break e;eP(s,c,d),i=l}}}if(T1)throw t=d2,T1=!1,d2=null,t}function Rn(t,e){var n=e[b2];n===void 0&&(n=e[b2]=new Set);var r=t+"__bubble";n.has(r)||(KM(e,t,2,!1),n.add(r))}function WN(t,e,n){var r=0;e&&(r|=4),KM(n,t,r,e)}var _b="_reactListening"+Math.random().toString(36).slice(2);function Zy(t){if(!t[_b]){t[_b]=!0,eM.forEach(function(n){n!=="selectionchange"&&(xq.has(n)||WN(n,!1,t),WN(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_b]||(e[_b]=!0,WN("selectionchange",!1,e))}}function KM(t,e,n,r){switch(IM(e)){case 1:var s=PW;break;case 4:s=OW;break;default:s=Pk}n=s.bind(null,e,n,t),s=void 0,!l2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function qN(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;c!==null;){if(o=oh(c),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}c=c.parentNode}}r=r.return}gM(function(){var d=i,u=kk(n),h=[];e:{var f=WM.get(t);if(f!==void 0){var p=Dk,m=t;switch(t){case"keypress":if(Dv(n)===0)break e;case"keydown":case"keyup":p=YW;break;case"focusin":m="focus",p=BN;break;case"focusout":m="blur",p=BN;break;case"beforeblur":case"afterblur":p=BN;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=zR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=MW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ZW;break;case FM:case zM:case HM:p=$W;break;case VM:p=eq;break;case"scroll":p=DW;break;case"wheel":p=nq;break;case"copy":case"cut":case"paste":p=zW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=VR}var g=(e&4)!==0,y=!g&&t==="scroll",x=g?f!==null?f+"Capture":null:f;g=[];for(var w=d,b;w!==null;){b=w;var v=b.stateNode;if(b.tag===5&&v!==null&&(b=v,x!==null&&(v=qy(w,x),v!=null&&g.push(Xy(w,v,b)))),y)break;w=w.return}0<g.length&&(f=new p(f,m,null,n,u),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==a2&&(m=n.relatedTarget||n.fromElement)&&(oh(m)||m[Nl]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=d,m=m?oh(m):null,m!==null&&(y=kf(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=d),p!==m)){if(g=zR,v="onMouseLeave",x="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(g=VR,v="onPointerLeave",x="onPointerEnter",w="pointer"),y=p==null?f:jp(p),b=m==null?f:jp(m),f=new g(v,w+"leave",p,n,u),f.target=y,f.relatedTarget=b,v=null,oh(u)===d&&(g=new g(x,w+"enter",m,n,u),g.target=b,g.relatedTarget=y,v=g),y=v,p&&m)t:{for(g=p,x=m,w=0,b=g;b;b=Vf(b))w++;for(b=0,v=x;v;v=Vf(v))b++;for(;0<w-b;)g=Vf(g),w--;for(;0<b-w;)x=Vf(x),b--;for(;w--;){if(g===x||x!==null&&g===x.alternate)break t;g=Vf(g),x=Vf(x)}g=null}else g=null;p!==null&&tP(h,f,p,g,!1),m!==null&&y!==null&&tP(h,y,m,g,!0)}}e:{if(f=d?jp(d):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var E=lq;else if(KR(f))if(UM)E=fq;else{E=uq;var k=dq}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=hq);if(E&&(E=E(t,d))){DM(h,E,n,u);break e}k&&k(t,f,d),t==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&n2(f,"number",f.value)}switch(k=d?jp(d):window,t){case"focusin":(KR(k)||k.contentEditable==="true")&&(kp=k,p2=d,gy=null);break;case"focusout":gy=p2=kp=null;break;case"mousedown":m2=!0;break;case"contextmenu":case"mouseup":case"dragend":m2=!1,ZR(h,n,u);break;case"selectionchange":if(gq)break;case"keydown":case"keyup":ZR(h,n,u)}var C;if(Mk)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else _p?PM(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(RM&&n.locale!=="ko"&&(_p||S!=="onCompositionStart"?S==="onCompositionEnd"&&_p&&(C=jM()):(Bd=u,Ok="value"in Bd?Bd.value:Bd.textContent,_p=!0)),k=R1(d,S),0<k.length&&(S=new HR(S,t,null,n,u),h.push({event:S,listeners:k}),C?S.data=C:(C=OM(n),C!==null&&(S.data=C)))),(C=sq?iq(t,n):oq(t,n))&&(d=R1(d,"onBeforeInput"),0<d.length&&(u=new HR("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:d}),u.data=C))}qM(h,e)})}function Xy(t,e,n){return{instance:t,listener:e,currentTarget:n}}function R1(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=qy(t,n),i!=null&&r.unshift(Xy(t,i,s)),i=qy(t,e),i!=null&&r.push(Xy(t,i,s))),t=t.return}return r}function Vf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function tP(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,l=c.alternate,d=c.stateNode;if(l!==null&&l===r)break;c.tag===5&&d!==null&&(c=d,s?(l=qy(n,i),l!=null&&o.unshift(Xy(n,l,c))):s||(l=qy(n,i),l!=null&&o.push(Xy(n,l,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bq=/\r\n?/g,vq=/\u0000|\uFFFD/g;function nP(t){return(typeof t=="string"?t:""+t).replace(bq,`
`).replace(vq,"")}function kb(t,e,n){if(e=nP(e),nP(t)!==e&&n)throw Error(Te(425))}function P1(){}var g2=null,y2=null;function w2(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var x2=typeof setTimeout=="function"?setTimeout:void 0,Eq=typeof clearTimeout=="function"?clearTimeout:void 0,rP=typeof Promise=="function"?Promise:void 0,Cq=typeof queueMicrotask=="function"?queueMicrotask:typeof rP<"u"?function(t){return rP.resolve(null).then(t).catch(Nq)}:x2;function Nq(t){setTimeout(function(){throw t})}function KN(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Yy(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Yy(e)}function Kd(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var $g=Math.random().toString(36).slice(2),rc="__reactFiber$"+$g,ew="__reactProps$"+$g,Nl="__reactContainer$"+$g,b2="__reactEvents$"+$g,Aq="__reactListeners$"+$g,Sq="__reactHandles$"+$g;function oh(t){var e=t[rc];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Nl]||n[rc]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=sP(t);t!==null;){if(n=t[rc])return n;t=sP(t)}return e}t=n,n=t.parentNode}return null}function Fx(t){return t=t[rc]||t[Nl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jp(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Te(33))}function hC(t){return t[ew]||null}var v2=[],Rp=-1;function yu(t){return{current:t}}function Dn(t){0>Rp||(t.current=v2[Rp],v2[Rp]=null,Rp--)}function In(t,e){Rp++,v2[Rp]=t.current,t.current=e}var iu={},Ps=yu(iu),Ni=yu(!1),rf=iu;function rg(t,e){var n=t.type.contextTypes;if(!n)return iu;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ai(t){return t=t.childContextTypes,t!=null}function O1(){Dn(Ni),Dn(Ps)}function iP(t,e,n){if(Ps.current!==iu)throw Error(Te(168));In(Ps,e),In(Ni,n)}function GM(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Te(108,dW(t)||"Unknown",s));return Jn({},n,r)}function D1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||iu,rf=Ps.current,In(Ps,t),In(Ni,Ni.current),!0}function oP(t,e,n){var r=t.stateNode;if(!r)throw Error(Te(169));n?(t=GM(t,e,rf),r.__reactInternalMemoizedMergedChildContext=t,Dn(Ni),Dn(Ps),In(Ps,t)):Dn(Ni),In(Ni,n)}var Yc=null,fC=!1,GN=!1;function YM(t){Yc===null?Yc=[t]:Yc.push(t)}function Tq(t){fC=!0,YM(t)}function wu(){if(!GN&&Yc!==null){GN=!0;var t=0,e=xn;try{var n=Yc;for(xn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Yc=null,fC=!1}catch(s){throw Yc!==null&&(Yc=Yc.slice(t+1)),bM(Ik,wu),s}finally{xn=e,GN=!1}}return null}var Pp=[],Op=0,U1=null,M1=0,So=[],To=0,sf=null,ul=1,hl="";function Bu(t,e){Pp[Op++]=M1,Pp[Op++]=U1,U1=t,M1=e}function QM(t,e,n){So[To++]=ul,So[To++]=hl,So[To++]=sf,sf=t;var r=ul;t=hl;var s=32-ya(r)-1;r&=~(1<<s),n+=1;var i=32-ya(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ul=1<<32-ya(e)+s|n<<s|r,hl=i+t}else ul=1<<i|n<<s|r,hl=t}function Bk(t){t.return!==null&&(Bu(t,1),QM(t,1,0))}function $k(t){for(;t===U1;)U1=Pp[--Op],Pp[Op]=null,M1=Pp[--Op],Pp[Op]=null;for(;t===sf;)sf=So[--To],So[To]=null,hl=So[--To],So[To]=null,ul=So[--To],So[To]=null}var Qi=null,Gi=null,Vn=!1,ua=null;function JM(t,e){var n=Io(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function aP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qi=t,Gi=Kd(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qi=t,Gi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=sf!==null?{id:ul,overflow:hl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Io(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qi=t,Gi=null,!0):!1;default:return!1}}function E2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function C2(t){if(Vn){var e=Gi;if(e){var n=e;if(!aP(t,e)){if(E2(t))throw Error(Te(418));e=Kd(n.nextSibling);var r=Qi;e&&aP(t,e)?JM(r,n):(t.flags=t.flags&-4097|2,Vn=!1,Qi=t)}}else{if(E2(t))throw Error(Te(418));t.flags=t.flags&-4097|2,Vn=!1,Qi=t}}}function cP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qi=t}function Ib(t){if(t!==Qi)return!1;if(!Vn)return cP(t),Vn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!w2(t.type,t.memoizedProps)),e&&(e=Gi)){if(E2(t))throw ZM(),Error(Te(418));for(;e;)JM(t,e),e=Kd(e.nextSibling)}if(cP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Gi=Kd(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Gi=null}}else Gi=Qi?Kd(t.stateNode.nextSibling):null;return!0}function ZM(){for(var t=Gi;t;)t=Kd(t.nextSibling)}function sg(){Gi=Qi=null,Vn=!1}function Fk(t){ua===null?ua=[t]:ua.push(t)}var _q=Ul.ReactCurrentBatchConfig;function g0(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Te(309));var r=n.stateNode}if(!r)throw Error(Te(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Te(284));if(!n._owner)throw Error(Te(290,t))}return t}function jb(t,e){throw t=Object.prototype.toString.call(e),Error(Te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lP(t){var e=t._init;return e(t._payload)}function XM(t){function e(x,w){if(t){var b=x.deletions;b===null?(x.deletions=[w],x.flags|=16):b.push(w)}}function n(x,w){if(!t)return null;for(;w!==null;)e(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function s(x,w){return x=Jd(x,w),x.index=0,x.sibling=null,x}function i(x,w,b){return x.index=b,t?(b=x.alternate,b!==null?(b=b.index,b<w?(x.flags|=2,w):b):(x.flags|=2,w)):(x.flags|=1048576,w)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function c(x,w,b,v){return w===null||w.tag!==6?(w=tA(b,x.mode,v),w.return=x,w):(w=s(w,b),w.return=x,w)}function l(x,w,b,v){var E=b.type;return E===Tp?u(x,w,b.props.children,v,b.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===cd&&lP(E)===w.type)?(v=s(w,b.props),v.ref=g0(x,w,b),v.return=x,v):(v=zv(b.type,b.key,b.props,null,x.mode,v),v.ref=g0(x,w,b),v.return=x,v)}function d(x,w,b,v){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=nA(b,x.mode,v),w.return=x,w):(w=s(w,b.children||[]),w.return=x,w)}function u(x,w,b,v,E){return w===null||w.tag!==7?(w=qh(b,x.mode,v,E),w.return=x,w):(w=s(w,b),w.return=x,w)}function h(x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=tA(""+w,x.mode,b),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case bb:return b=zv(w.type,w.key,w.props,null,x.mode,b),b.ref=g0(x,null,w),b.return=x,b;case Sp:return w=nA(w,x.mode,b),w.return=x,w;case cd:var v=w._init;return h(x,v(w._payload),b)}if(Y0(w)||u0(w))return w=qh(w,x.mode,b,null),w.return=x,w;jb(x,w)}return null}function f(x,w,b,v){var E=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return E!==null?null:c(x,w,""+b,v);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case bb:return b.key===E?l(x,w,b,v):null;case Sp:return b.key===E?d(x,w,b,v):null;case cd:return E=b._init,f(x,w,E(b._payload),v)}if(Y0(b)||u0(b))return E!==null?null:u(x,w,b,v,null);jb(x,b)}return null}function p(x,w,b,v,E){if(typeof v=="string"&&v!==""||typeof v=="number")return x=x.get(b)||null,c(w,x,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case bb:return x=x.get(v.key===null?b:v.key)||null,l(w,x,v,E);case Sp:return x=x.get(v.key===null?b:v.key)||null,d(w,x,v,E);case cd:var k=v._init;return p(x,w,b,k(v._payload),E)}if(Y0(v)||u0(v))return x=x.get(b)||null,u(w,x,v,E,null);jb(w,v)}return null}function m(x,w,b,v){for(var E=null,k=null,C=w,S=w=0,N=null;C!==null&&S<b.length;S++){C.index>S?(N=C,C=null):N=C.sibling;var I=f(x,C,b[S],v);if(I===null){C===null&&(C=N);break}t&&C&&I.alternate===null&&e(x,C),w=i(I,w,S),k===null?E=I:k.sibling=I,k=I,C=N}if(S===b.length)return n(x,C),Vn&&Bu(x,S),E;if(C===null){for(;S<b.length;S++)C=h(x,b[S],v),C!==null&&(w=i(C,w,S),k===null?E=C:k.sibling=C,k=C);return Vn&&Bu(x,S),E}for(C=r(x,C);S<b.length;S++)N=p(C,x,S,b[S],v),N!==null&&(t&&N.alternate!==null&&C.delete(N.key===null?S:N.key),w=i(N,w,S),k===null?E=N:k.sibling=N,k=N);return t&&C.forEach(function(F){return e(x,F)}),Vn&&Bu(x,S),E}function g(x,w,b,v){var E=u0(b);if(typeof E!="function")throw Error(Te(150));if(b=E.call(b),b==null)throw Error(Te(151));for(var k=E=null,C=w,S=w=0,N=null,I=b.next();C!==null&&!I.done;S++,I=b.next()){C.index>S?(N=C,C=null):N=C.sibling;var F=f(x,C,I.value,v);if(F===null){C===null&&(C=N);break}t&&C&&F.alternate===null&&e(x,C),w=i(F,w,S),k===null?E=F:k.sibling=F,k=F,C=N}if(I.done)return n(x,C),Vn&&Bu(x,S),E;if(C===null){for(;!I.done;S++,I=b.next())I=h(x,I.value,v),I!==null&&(w=i(I,w,S),k===null?E=I:k.sibling=I,k=I);return Vn&&Bu(x,S),E}for(C=r(x,C);!I.done;S++,I=b.next())I=p(C,x,S,I.value,v),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?S:I.key),w=i(I,w,S),k===null?E=I:k.sibling=I,k=I);return t&&C.forEach(function(P){return e(x,P)}),Vn&&Bu(x,S),E}function y(x,w,b,v){if(typeof b=="object"&&b!==null&&b.type===Tp&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case bb:e:{for(var E=b.key,k=w;k!==null;){if(k.key===E){if(E=b.type,E===Tp){if(k.tag===7){n(x,k.sibling),w=s(k,b.props.children),w.return=x,x=w;break e}}else if(k.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===cd&&lP(E)===k.type){n(x,k.sibling),w=s(k,b.props),w.ref=g0(x,k,b),w.return=x,x=w;break e}n(x,k);break}else e(x,k);k=k.sibling}b.type===Tp?(w=qh(b.props.children,x.mode,v,b.key),w.return=x,x=w):(v=zv(b.type,b.key,b.props,null,x.mode,v),v.ref=g0(x,w,b),v.return=x,x=v)}return o(x);case Sp:e:{for(k=b.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(x,w.sibling),w=s(w,b.children||[]),w.return=x,x=w;break e}else{n(x,w);break}else e(x,w);w=w.sibling}w=nA(b,x.mode,v),w.return=x,x=w}return o(x);case cd:return k=b._init,y(x,w,k(b._payload),v)}if(Y0(b))return m(x,w,b,v);if(u0(b))return g(x,w,b,v);jb(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(x,w.sibling),w=s(w,b),w.return=x,x=w):(n(x,w),w=tA(b,x.mode,v),w.return=x,x=w),o(x)):n(x,w)}return y}var ig=XM(!0),eL=XM(!1),L1=yu(null),B1=null,Dp=null,zk=null;function Hk(){zk=Dp=B1=null}function Vk(t){var e=L1.current;Dn(L1),t._currentValue=e}function N2(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function nm(t,e){B1=t,zk=Dp=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(bi=!0),t.firstContext=null)}function Uo(t){var e=t._currentValue;if(zk!==t)if(t={context:t,memoizedValue:e,next:null},Dp===null){if(B1===null)throw Error(Te(308));Dp=t,B1.dependencies={lanes:0,firstContext:t}}else Dp=Dp.next=t;return e}var ah=null;function Wk(t){ah===null?ah=[t]:ah.push(t)}function tL(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Wk(e)):(n.next=s.next,s.next=n),e.interleaved=n,Al(t,r)}function Al(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ld=!1;function qk(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gd(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,tn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Al(t,n)}return s=r.interleaved,s===null?(e.next=e,Wk(r)):(e.next=s.next,s.next=e),r.interleaved=e,Al(t,n)}function Uv(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,jk(t,n)}}function dP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function $1(t,e,n,r){var s=t.updateQueue;ld=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var l=c,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,c=u.lastBaseUpdate,c!==o&&(c===null?u.firstBaseUpdate=d:c.next=d,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=d=l=null,c=i;do{var f=c.lane,p=c.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var m=t,g=c;switch(f=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,f=typeof m=="function"?m.call(p,h,f):m,f==null)break e;h=Jn({},h,f);break e;case 2:ld=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[c]:f.push(c))}else p={eventTime:p,lane:f,tag:c.tag,payload:c.payload,callback:c.callback,next:null},u===null?(d=u=p,l=h):u=u.next=p,o|=f;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;f=c,c=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);af|=o,t.lanes=o,t.memoizedState=h}}function uP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Te(191,s));s.call(r)}}}var zx={},pc=yu(zx),tw=yu(zx),nw=yu(zx);function ch(t){if(t===zx)throw Error(Te(174));return t}function Kk(t,e){switch(In(nw,e),In(tw,t),In(pc,zx),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:s2(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=s2(e,t)}Dn(pc),In(pc,e)}function og(){Dn(pc),Dn(tw),Dn(nw)}function rL(t){ch(nw.current);var e=ch(pc.current),n=s2(e,t.type);e!==n&&(In(tw,t),In(pc,n))}function Gk(t){tw.current===t&&(Dn(pc),Dn(tw))}var Kn=yu(0);function F1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var YN=[];function Yk(){for(var t=0;t<YN.length;t++)YN[t]._workInProgressVersionPrimary=null;YN.length=0}var Mv=Ul.ReactCurrentDispatcher,QN=Ul.ReactCurrentBatchConfig,of=0,Qn=null,Tr=null,$r=null,z1=!1,yy=!1,rw=0,kq=0;function ms(){throw Error(Te(321))}function Qk(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ca(t[n],e[n]))return!1;return!0}function Jk(t,e,n,r,s,i){if(of=i,Qn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Mv.current=t===null||t.memoizedState===null?Pq:Oq,t=n(r,s),yy){i=0;do{if(yy=!1,rw=0,25<=i)throw Error(Te(301));i+=1,$r=Tr=null,e.updateQueue=null,Mv.current=Dq,t=n(r,s)}while(yy)}if(Mv.current=H1,e=Tr!==null&&Tr.next!==null,of=0,$r=Tr=Qn=null,z1=!1,e)throw Error(Te(300));return t}function Zk(){var t=rw!==0;return rw=0,t}function Fa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $r===null?Qn.memoizedState=$r=t:$r=$r.next=t,$r}function Mo(){if(Tr===null){var t=Qn.alternate;t=t!==null?t.memoizedState:null}else t=Tr.next;var e=$r===null?Qn.memoizedState:$r.next;if(e!==null)$r=e,Tr=t;else{if(t===null)throw Error(Te(310));Tr=t,t={memoizedState:Tr.memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},$r===null?Qn.memoizedState=$r=t:$r=$r.next=t}return $r}function sw(t,e){return typeof e=="function"?e(t):e}function JN(t){var e=Mo(),n=e.queue;if(n===null)throw Error(Te(311));n.lastRenderedReducer=t;var r=Tr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,l=null,d=i;do{var u=d.lane;if((of&u)===u)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(c=l=h,o=r):l=l.next=h,Qn.lanes|=u,af|=u}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=c,Ca(r,e.memoizedState)||(bi=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Qn.lanes|=i,af|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ZN(t){var e=Mo(),n=e.queue;if(n===null)throw Error(Te(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ca(i,e.memoizedState)||(bi=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function sL(){}function iL(t,e){var n=Qn,r=Mo(),s=e(),i=!Ca(r.memoizedState,s);if(i&&(r.memoizedState=s,bi=!0),r=r.queue,Xk(cL.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||$r!==null&&$r.memoizedState.tag&1){if(n.flags|=2048,iw(9,aL.bind(null,n,r,s,e),void 0,null),Wr===null)throw Error(Te(349));of&30||oL(n,e,s)}return s}function oL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Qn.updateQueue,e===null?(e={lastEffect:null,stores:null},Qn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function aL(t,e,n,r){e.value=n,e.getSnapshot=r,lL(e)&&dL(t)}function cL(t,e,n){return n(function(){lL(e)&&dL(t)})}function lL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ca(t,n)}catch{return!0}}function dL(t){var e=Al(t,1);e!==null&&wa(e,t,1,-1)}function hP(t){var e=Fa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sw,lastRenderedState:t},e.queue=t,t=t.dispatch=Rq.bind(null,Qn,t),[e.memoizedState,t]}function iw(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Qn.updateQueue,e===null?(e={lastEffect:null,stores:null},Qn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function uL(){return Mo().memoizedState}function Lv(t,e,n,r){var s=Fa();Qn.flags|=t,s.memoizedState=iw(1|e,n,void 0,r===void 0?null:r)}function pC(t,e,n,r){var s=Mo();r=r===void 0?null:r;var i=void 0;if(Tr!==null){var o=Tr.memoizedState;if(i=o.destroy,r!==null&&Qk(r,o.deps)){s.memoizedState=iw(e,n,i,r);return}}Qn.flags|=t,s.memoizedState=iw(1|e,n,i,r)}function fP(t,e){return Lv(8390656,8,t,e)}function Xk(t,e){return pC(2048,8,t,e)}function hL(t,e){return pC(4,2,t,e)}function fL(t,e){return pC(4,4,t,e)}function pL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mL(t,e,n){return n=n!=null?n.concat([t]):null,pC(4,4,pL.bind(null,e,t),n)}function eI(){}function gL(t,e){var n=Mo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qk(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function yL(t,e){var n=Mo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Qk(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function wL(t,e,n){return of&21?(Ca(n,e)||(n=CM(),Qn.lanes|=n,af|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,bi=!0),t.memoizedState=n)}function Iq(t,e){var n=xn;xn=n!==0&&4>n?n:4,t(!0);var r=QN.transition;QN.transition={};try{t(!1),e()}finally{xn=n,QN.transition=r}}function xL(){return Mo().memoizedState}function jq(t,e,n){var r=Qd(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bL(t))vL(e,n);else if(n=tL(t,e,n,r),n!==null){var s=Ks();wa(n,t,r,s),EL(n,e,r)}}function Rq(t,e,n){var r=Qd(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bL(t))vL(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,Ca(c,o)){var l=e.interleaved;l===null?(s.next=s,Wk(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=tL(t,e,s,r),n!==null&&(s=Ks(),wa(n,t,r,s),EL(n,e,r))}}function bL(t){var e=t.alternate;return t===Qn||e!==null&&e===Qn}function vL(t,e){yy=z1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function EL(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,jk(t,n)}}var H1={readContext:Uo,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},Pq={readContext:Uo,useCallback:function(t,e){return Fa().memoizedState=[t,e===void 0?null:e],t},useContext:Uo,useEffect:fP,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Lv(4194308,4,pL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Lv(4194308,4,t,e)},useInsertionEffect:function(t,e){return Lv(4,2,t,e)},useMemo:function(t,e){var n=Fa();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Fa();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=jq.bind(null,Qn,t),[r.memoizedState,t]},useRef:function(t){var e=Fa();return t={current:t},e.memoizedState=t},useState:hP,useDebugValue:eI,useDeferredValue:function(t){return Fa().memoizedState=t},useTransition:function(){var t=hP(!1),e=t[0];return t=Iq.bind(null,t[1]),Fa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Qn,s=Fa();if(Vn){if(n===void 0)throw Error(Te(407));n=n()}else{if(n=e(),Wr===null)throw Error(Te(349));of&30||oL(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,fP(cL.bind(null,r,i,t),[t]),r.flags|=2048,iw(9,aL.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Fa(),e=Wr.identifierPrefix;if(Vn){var n=hl,r=ul;n=(r&~(1<<32-ya(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=rw++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=kq++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Oq={readContext:Uo,useCallback:gL,useContext:Uo,useEffect:Xk,useImperativeHandle:mL,useInsertionEffect:hL,useLayoutEffect:fL,useMemo:yL,useReducer:JN,useRef:uL,useState:function(){return JN(sw)},useDebugValue:eI,useDeferredValue:function(t){var e=Mo();return wL(e,Tr.memoizedState,t)},useTransition:function(){var t=JN(sw)[0],e=Mo().memoizedState;return[t,e]},useMutableSource:sL,useSyncExternalStore:iL,useId:xL,unstable_isNewReconciler:!1},Dq={readContext:Uo,useCallback:gL,useContext:Uo,useEffect:Xk,useImperativeHandle:mL,useInsertionEffect:hL,useLayoutEffect:fL,useMemo:yL,useReducer:ZN,useRef:uL,useState:function(){return ZN(sw)},useDebugValue:eI,useDeferredValue:function(t){var e=Mo();return Tr===null?e.memoizedState=t:wL(e,Tr.memoizedState,t)},useTransition:function(){var t=ZN(sw)[0],e=Mo().memoizedState;return[t,e]},useMutableSource:sL,useSyncExternalStore:iL,useId:xL,unstable_isNewReconciler:!1};function Xo(t,e){if(t&&t.defaultProps){e=Jn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function A2(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Jn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var mC={isMounted:function(t){return(t=t._reactInternals)?kf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ks(),s=Qd(t),i=gl(r,s);i.payload=e,n!=null&&(i.callback=n),e=Gd(t,i,s),e!==null&&(wa(e,t,s,r),Uv(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ks(),s=Qd(t),i=gl(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Gd(t,i,s),e!==null&&(wa(e,t,s,r),Uv(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ks(),r=Qd(t),s=gl(n,r);s.tag=2,e!=null&&(s.callback=e),e=Gd(t,s,r),e!==null&&(wa(e,t,r,n),Uv(e,t,r))}};function pP(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Jy(n,r)||!Jy(s,i):!0}function CL(t,e,n){var r=!1,s=iu,i=e.contextType;return typeof i=="object"&&i!==null?i=Uo(i):(s=Ai(e)?rf:Ps.current,r=e.contextTypes,i=(r=r!=null)?rg(t,s):iu),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=mC,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function mP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&mC.enqueueReplaceState(e,e.state,null)}function S2(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},qk(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Uo(i):(i=Ai(e)?rf:Ps.current,s.context=rg(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(A2(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&mC.enqueueReplaceState(s,s.state,null),$1(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ag(t,e){try{var n="",r=e;do n+=lW(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function XN(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function T2(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Uq=typeof WeakMap=="function"?WeakMap:Map;function NL(t,e,n){n=gl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){W1||(W1=!0,M2=r),T2(t,e)},n}function AL(t,e,n){n=gl(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){T2(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){T2(t,e),typeof r!="function"&&(Yd===null?Yd=new Set([this]):Yd.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function gP(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Uq;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Qq.bind(null,t,e,n),e.then(t,t))}function yP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wP(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=gl(-1,1),e.tag=2,Gd(n,e,1))),n.lanes|=1),t)}var Mq=Ul.ReactCurrentOwner,bi=!1;function Bs(t,e,n,r){e.child=t===null?eL(e,null,n,r):ig(e,t.child,n,r)}function xP(t,e,n,r,s){n=n.render;var i=e.ref;return nm(e,s),r=Jk(t,e,n,r,i,s),n=Zk(),t!==null&&!bi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Sl(t,e,s)):(Vn&&n&&Bk(e),e.flags|=1,Bs(t,e,r,s),e.child)}function bP(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!cI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,SL(t,e,i,r,s)):(t=zv(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Jy,n(o,r)&&t.ref===e.ref)return Sl(t,e,s)}return e.flags|=1,t=Jd(i,r),t.ref=e.ref,t.return=e,e.child=t}function SL(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Jy(i,r)&&t.ref===e.ref)if(bi=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(bi=!0);else return e.lanes=t.lanes,Sl(t,e,s)}return _2(t,e,n,r,s)}function TL(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},In(Mp,zi),zi|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,In(Mp,zi),zi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,In(Mp,zi),zi|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,In(Mp,zi),zi|=r;return Bs(t,e,s,n),e.child}function _L(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function _2(t,e,n,r,s){var i=Ai(n)?rf:Ps.current;return i=rg(e,i),nm(e,s),n=Jk(t,e,n,r,i,s),r=Zk(),t!==null&&!bi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Sl(t,e,s)):(Vn&&r&&Bk(e),e.flags|=1,Bs(t,e,n,s),e.child)}function vP(t,e,n,r,s){if(Ai(n)){var i=!0;D1(e)}else i=!1;if(nm(e,s),e.stateNode===null)Bv(t,e),CL(e,n,r),S2(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Uo(d):(d=Ai(n)?rf:Ps.current,d=rg(e,d));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||l!==d)&&mP(e,o,r,d),ld=!1;var f=e.memoizedState;o.state=f,$1(e,r,o,s),l=e.memoizedState,c!==r||f!==l||Ni.current||ld?(typeof u=="function"&&(A2(e,n,u,r),l=e.memoizedState),(c=ld||pP(e,n,c,r,f,l,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,nL(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:Xo(e.type,c),o.props=d,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Uo(l):(l=Ai(n)?rf:Ps.current,l=rg(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==h||f!==l)&&mP(e,o,r,l),ld=!1,f=e.memoizedState,o.state=f,$1(e,r,o,s);var m=e.memoizedState;c!==h||f!==m||Ni.current||ld?(typeof p=="function"&&(A2(e,n,p,r),m=e.memoizedState),(d=ld||pP(e,n,d,r,f,m,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return k2(t,e,n,r,i,s)}function k2(t,e,n,r,s,i){_L(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&oP(e,n,!1),Sl(t,e,i);r=e.stateNode,Mq.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ig(e,t.child,null,i),e.child=ig(e,null,c,i)):Bs(t,e,c,i),e.memoizedState=r.state,s&&oP(e,n,!0),e.child}function kL(t){var e=t.stateNode;e.pendingContext?iP(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iP(t,e.context,!1),Kk(t,e.containerInfo)}function EP(t,e,n,r,s){return sg(),Fk(s),e.flags|=256,Bs(t,e,n,r),e.child}var I2={dehydrated:null,treeContext:null,retryLane:0};function j2(t){return{baseLanes:t,cachePool:null,transitions:null}}function IL(t,e,n){var r=e.pendingProps,s=Kn.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),In(Kn,s&1),t===null)return C2(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=wC(o,r,0,null),t=qh(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=j2(n),e.memoizedState=I2,t):tI(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Lq(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Jd(s,l),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Jd(c,i):(i=qh(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?j2(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=I2,r}return i=t.child,t=i.sibling,r=Jd(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function tI(t,e){return e=wC({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rb(t,e,n,r){return r!==null&&Fk(r),ig(e,t.child,null,n),t=tI(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Lq(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=XN(Error(Te(422))),Rb(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=wC({mode:"visible",children:r.children},s,0,null),i=qh(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ig(e,t.child,null,o),e.child.memoizedState=j2(o),e.memoizedState=I2,i);if(!(e.mode&1))return Rb(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(Te(419)),r=XN(i,r,void 0),Rb(t,e,o,r)}if(c=(o&t.childLanes)!==0,bi||c){if(r=Wr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Al(t,s),wa(r,t,s,-1))}return aI(),r=XN(Error(Te(421))),Rb(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Jq.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Gi=Kd(s.nextSibling),Qi=e,Vn=!0,ua=null,t!==null&&(So[To++]=ul,So[To++]=hl,So[To++]=sf,ul=t.id,hl=t.overflow,sf=e),e=tI(e,r.children),e.flags|=4096,e)}function CP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),N2(t.return,e,n)}function eA(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function jL(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Bs(t,e,r.children,n),r=Kn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&CP(t,n,e);else if(t.tag===19)CP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(In(Kn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&F1(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),eA(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&F1(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}eA(e,!0,n,null,i);break;case"together":eA(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Sl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),af|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Te(153));if(e.child!==null){for(t=e.child,n=Jd(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Jd(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Bq(t,e,n){switch(e.tag){case 3:kL(e),sg();break;case 5:rL(e);break;case 1:Ai(e.type)&&D1(e);break;case 4:Kk(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;In(L1,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(In(Kn,Kn.current&1),e.flags|=128,null):n&e.child.childLanes?IL(t,e,n):(In(Kn,Kn.current&1),t=Sl(t,e,n),t!==null?t.sibling:null);In(Kn,Kn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return jL(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),In(Kn,Kn.current),r)break;return null;case 22:case 23:return e.lanes=0,TL(t,e,n)}return Sl(t,e,n)}var RL,R2,PL,OL;RL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};R2=function(){};PL=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ch(pc.current);var i=null;switch(n){case"input":s=e2(t,s),r=e2(t,r),i=[];break;case"select":s=Jn({},s,{value:void 0}),r=Jn({},r,{value:void 0}),i=[];break;case"textarea":s=r2(t,s),r=r2(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=P1)}i2(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Vy.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==c&&(l!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,c=c?c.__html:void 0,l!=null&&c!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Vy.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&Rn("scroll",t),i||c===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};OL=function(t,e,n,r){n!==r&&(e.flags|=4)};function y0(t,e){if(!Vn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function gs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function $q(t,e,n){var r=e.pendingProps;switch($k(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gs(e),null;case 1:return Ai(e.type)&&O1(),gs(e),null;case 3:return r=e.stateNode,og(),Dn(Ni),Dn(Ps),Yk(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ib(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ua!==null&&($2(ua),ua=null))),R2(t,e),gs(e),null;case 5:Gk(e);var s=ch(nw.current);if(n=e.type,t!==null&&e.stateNode!=null)PL(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Te(166));return gs(e),null}if(t=ch(pc.current),Ib(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[rc]=e,r[ew]=i,t=(e.mode&1)!==0,n){case"dialog":Rn("cancel",r),Rn("close",r);break;case"iframe":case"object":case"embed":Rn("load",r);break;case"video":case"audio":for(s=0;s<J0.length;s++)Rn(J0[s],r);break;case"source":Rn("error",r);break;case"img":case"image":case"link":Rn("error",r),Rn("load",r);break;case"details":Rn("toggle",r);break;case"input":RR(r,i),Rn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Rn("invalid",r);break;case"textarea":OR(r,i),Rn("invalid",r)}i2(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&kb(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&kb(r.textContent,c,t),s=["children",""+c]):Vy.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Rn("scroll",r)}switch(n){case"input":vb(r),PR(r,i,!0);break;case"textarea":vb(r),DR(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=P1)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cM(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[rc]=e,t[ew]=r,RL(t,e,!1,!1),e.stateNode=t;e:{switch(o=o2(n,r),n){case"dialog":Rn("cancel",t),Rn("close",t),s=r;break;case"iframe":case"object":case"embed":Rn("load",t),s=r;break;case"video":case"audio":for(s=0;s<J0.length;s++)Rn(J0[s],t);s=r;break;case"source":Rn("error",t),s=r;break;case"img":case"image":case"link":Rn("error",t),Rn("load",t),s=r;break;case"details":Rn("toggle",t),s=r;break;case"input":RR(t,r),s=e2(t,r),Rn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Jn({},r,{value:void 0}),Rn("invalid",t);break;case"textarea":OR(t,r),s=r2(t,r),Rn("invalid",t);break;default:s=r}i2(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var l=c[i];i==="style"?uM(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&lM(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Wy(t,l):typeof l=="number"&&Wy(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Vy.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Rn("scroll",t):l!=null&&Ak(t,i,l,o))}switch(n){case"input":vb(t),PR(t,r,!1);break;case"textarea":vb(t),DR(t);break;case"option":r.value!=null&&t.setAttribute("value",""+su(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Zp(t,!!r.multiple,i,!1):r.defaultValue!=null&&Zp(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=P1)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gs(e),null;case 6:if(t&&e.stateNode!=null)OL(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Te(166));if(n=ch(nw.current),ch(pc.current),Ib(e)){if(r=e.stateNode,n=e.memoizedProps,r[rc]=e,(i=r.nodeValue!==n)&&(t=Qi,t!==null))switch(t.tag){case 3:kb(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&kb(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[rc]=e,e.stateNode=r}return gs(e),null;case 13:if(Dn(Kn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Vn&&Gi!==null&&e.mode&1&&!(e.flags&128))ZM(),sg(),e.flags|=98560,i=!1;else if(i=Ib(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Te(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Te(317));i[rc]=e}else sg(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gs(e),i=!1}else ua!==null&&($2(ua),ua=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Kn.current&1?Rr===0&&(Rr=3):aI())),e.updateQueue!==null&&(e.flags|=4),gs(e),null);case 4:return og(),R2(t,e),t===null&&Zy(e.stateNode.containerInfo),gs(e),null;case 10:return Vk(e.type._context),gs(e),null;case 17:return Ai(e.type)&&O1(),gs(e),null;case 19:if(Dn(Kn),i=e.memoizedState,i===null)return gs(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)y0(i,!1);else{if(Rr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=F1(t),o!==null){for(e.flags|=128,y0(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return In(Kn,Kn.current&1|2),e.child}t=t.sibling}i.tail!==null&&dr()>cg&&(e.flags|=128,r=!0,y0(i,!1),e.lanes=4194304)}else{if(!r)if(t=F1(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),y0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Vn)return gs(e),null}else 2*dr()-i.renderingStartTime>cg&&n!==1073741824&&(e.flags|=128,r=!0,y0(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=dr(),e.sibling=null,n=Kn.current,In(Kn,r?n&1|2:n&1),e):(gs(e),null);case 22:case 23:return oI(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?zi&1073741824&&(gs(e),e.subtreeFlags&6&&(e.flags|=8192)):gs(e),null;case 24:return null;case 25:return null}throw Error(Te(156,e.tag))}function Fq(t,e){switch($k(e),e.tag){case 1:return Ai(e.type)&&O1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return og(),Dn(Ni),Dn(Ps),Yk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Gk(e),null;case 13:if(Dn(Kn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Te(340));sg()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Dn(Kn),null;case 4:return og(),null;case 10:return Vk(e.type._context),null;case 22:case 23:return oI(),null;case 24:return null;default:return null}}var Pb=!1,Is=!1,zq=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function Up(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tr(t,e,r)}else n.current=null}function P2(t,e,n){try{n()}catch(r){tr(t,e,r)}}var NP=!1;function Hq(t,e){if(g2=I1,t=BM(),Lk(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,l=-1,d=0,u=0,h=t,f=null;t:for(;;){for(var p;h!==n||s!==0&&h.nodeType!==3||(c=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++d===s&&(c=o),f===i&&++u===r&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=c===-1||l===-1?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(y2={focusedElem:t,selectionRange:n},I1=!1,Qe=e;Qe!==null;)if(e=Qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Qe=t;else for(;Qe!==null;){e=Qe;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,x=e.stateNode,w=x.getSnapshotBeforeUpdate(e.elementType===e.type?g:Xo(e.type,g),y);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(v){tr(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,Qe=t;break}Qe=e.return}return m=NP,NP=!1,m}function wy(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&P2(e,n,i)}s=s.next}while(s!==r)}}function gC(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function O2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function DL(t){var e=t.alternate;e!==null&&(t.alternate=null,DL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[rc],delete e[ew],delete e[b2],delete e[Aq],delete e[Sq])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function UL(t){return t.tag===5||t.tag===3||t.tag===4}function AP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||UL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function D2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=P1));else if(r!==4&&(t=t.child,t!==null))for(D2(t,e,n),t=t.sibling;t!==null;)D2(t,e,n),t=t.sibling}function U2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(U2(t,e,n),t=t.sibling;t!==null;)U2(t,e,n),t=t.sibling}var es=null,ca=!1;function Bl(t,e,n){for(n=n.child;n!==null;)ML(t,e,n),n=n.sibling}function ML(t,e,n){if(fc&&typeof fc.onCommitFiberUnmount=="function")try{fc.onCommitFiberUnmount(cC,n)}catch{}switch(n.tag){case 5:Is||Up(n,e);case 6:var r=es,s=ca;es=null,Bl(t,e,n),es=r,ca=s,es!==null&&(ca?(t=es,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):es.removeChild(n.stateNode));break;case 18:es!==null&&(ca?(t=es,n=n.stateNode,t.nodeType===8?KN(t.parentNode,n):t.nodeType===1&&KN(t,n),Yy(t)):KN(es,n.stateNode));break;case 4:r=es,s=ca,es=n.stateNode.containerInfo,ca=!0,Bl(t,e,n),es=r,ca=s;break;case 0:case 11:case 14:case 15:if(!Is&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&P2(n,e,o),s=s.next}while(s!==r)}Bl(t,e,n);break;case 1:if(!Is&&(Up(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){tr(n,e,c)}Bl(t,e,n);break;case 21:Bl(t,e,n);break;case 22:n.mode&1?(Is=(r=Is)||n.memoizedState!==null,Bl(t,e,n),Is=r):Bl(t,e,n);break;default:Bl(t,e,n)}}function SP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new zq),e.forEach(function(r){var s=Zq.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Vo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:es=c.stateNode,ca=!1;break e;case 3:es=c.stateNode.containerInfo,ca=!0;break e;case 4:es=c.stateNode.containerInfo,ca=!0;break e}c=c.return}if(es===null)throw Error(Te(160));ML(i,o,s),es=null,ca=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){tr(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)LL(e,t),e=e.sibling}function LL(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vo(e,t),Pa(t),r&4){try{wy(3,t,t.return),gC(3,t)}catch(g){tr(t,t.return,g)}try{wy(5,t,t.return)}catch(g){tr(t,t.return,g)}}break;case 1:Vo(e,t),Pa(t),r&512&&n!==null&&Up(n,n.return);break;case 5:if(Vo(e,t),Pa(t),r&512&&n!==null&&Up(n,n.return),t.flags&32){var s=t.stateNode;try{Wy(s,"")}catch(g){tr(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&oM(s,i),o2(c,o);var d=o2(c,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?uM(s,h):u==="dangerouslySetInnerHTML"?lM(s,h):u==="children"?Wy(s,h):Ak(s,u,h,d)}switch(c){case"input":t2(s,i);break;case"textarea":aM(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Zp(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Zp(s,!!i.multiple,i.defaultValue,!0):Zp(s,!!i.multiple,i.multiple?[]:"",!1))}s[ew]=i}catch(g){tr(t,t.return,g)}}break;case 6:if(Vo(e,t),Pa(t),r&4){if(t.stateNode===null)throw Error(Te(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){tr(t,t.return,g)}}break;case 3:if(Vo(e,t),Pa(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Yy(e.containerInfo)}catch(g){tr(t,t.return,g)}break;case 4:Vo(e,t),Pa(t);break;case 13:Vo(e,t),Pa(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(sI=dr())),r&4&&SP(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Is=(d=Is)||u,Vo(e,t),Is=d):Vo(e,t),Pa(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(Qe=t,u=t.child;u!==null;){for(h=Qe=u;Qe!==null;){switch(f=Qe,p=f.child,f.tag){case 0:case 11:case 14:case 15:wy(4,f,f.return);break;case 1:Up(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){tr(r,n,g)}}break;case 5:Up(f,f.return);break;case 22:if(f.memoizedState!==null){_P(h);continue}}p!==null?(p.return=f,Qe=p):_P(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,c.style.display=dM("display",o))}catch(g){tr(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){tr(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Vo(e,t),Pa(t),r&4&&SP(t);break;case 21:break;default:Vo(e,t),Pa(t)}}function Pa(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(UL(n)){var r=n;break e}n=n.return}throw Error(Te(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Wy(s,""),r.flags&=-33);var i=AP(t);U2(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=AP(t);D2(t,c,o);break;default:throw Error(Te(161))}}catch(l){tr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Vq(t,e,n){Qe=t,BL(t)}function BL(t,e,n){for(var r=(t.mode&1)!==0;Qe!==null;){var s=Qe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Pb;if(!o){var c=s.alternate,l=c!==null&&c.memoizedState!==null||Is;c=Pb;var d=Is;if(Pb=o,(Is=l)&&!d)for(Qe=s;Qe!==null;)o=Qe,l=o.child,o.tag===22&&o.memoizedState!==null?kP(s):l!==null?(l.return=o,Qe=l):kP(s);for(;i!==null;)Qe=i,BL(i),i=i.sibling;Qe=s,Pb=c,Is=d}TP(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Qe=i):TP(t)}}function TP(t){for(;Qe!==null;){var e=Qe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Is||gC(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Is)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Xo(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&uP(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}uP(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Yy(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}Is||e.flags&512&&O2(e)}catch(f){tr(e,e.return,f)}}if(e===t){Qe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Qe=n;break}Qe=e.return}}function _P(t){for(;Qe!==null;){var e=Qe;if(e===t){Qe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Qe=n;break}Qe=e.return}}function kP(t){for(;Qe!==null;){var e=Qe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{gC(4,e)}catch(l){tr(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){tr(e,s,l)}}var i=e.return;try{O2(e)}catch(l){tr(e,i,l)}break;case 5:var o=e.return;try{O2(e)}catch(l){tr(e,o,l)}}}catch(l){tr(e,e.return,l)}if(e===t){Qe=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Qe=c;break}Qe=e.return}}var Wq=Math.ceil,V1=Ul.ReactCurrentDispatcher,nI=Ul.ReactCurrentOwner,Ro=Ul.ReactCurrentBatchConfig,tn=0,Wr=null,br=null,is=0,zi=0,Mp=yu(0),Rr=0,ow=null,af=0,yC=0,rI=0,xy=null,wi=null,sI=0,cg=1/0,Wc=null,W1=!1,M2=null,Yd=null,Ob=!1,$d=null,q1=0,by=0,L2=null,$v=-1,Fv=0;function Ks(){return tn&6?dr():$v!==-1?$v:$v=dr()}function Qd(t){return t.mode&1?tn&2&&is!==0?is&-is:_q.transition!==null?(Fv===0&&(Fv=CM()),Fv):(t=xn,t!==0||(t=window.event,t=t===void 0?16:IM(t.type)),t):1}function wa(t,e,n,r){if(50<by)throw by=0,L2=null,Error(Te(185));Bx(t,n,r),(!(tn&2)||t!==Wr)&&(t===Wr&&(!(tn&2)&&(yC|=n),Rr===4&&gd(t,is)),Si(t,r),n===1&&tn===0&&!(e.mode&1)&&(cg=dr()+500,fC&&wu()))}function Si(t,e){var n=t.callbackNode;_W(t,e);var r=k1(t,t===Wr?is:0);if(r===0)n!==null&&LR(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&LR(n),e===1)t.tag===0?Tq(IP.bind(null,t)):YM(IP.bind(null,t)),Cq(function(){!(tn&6)&&wu()}),n=null;else{switch(NM(r)){case 1:n=Ik;break;case 4:n=vM;break;case 16:n=_1;break;case 536870912:n=EM;break;default:n=_1}n=KL(n,$L.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function $L(t,e){if($v=-1,Fv=0,tn&6)throw Error(Te(327));var n=t.callbackNode;if(rm()&&t.callbackNode!==n)return null;var r=k1(t,t===Wr?is:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=K1(t,r);else{e=r;var s=tn;tn|=2;var i=zL();(Wr!==t||is!==e)&&(Wc=null,cg=dr()+500,Wh(t,e));do try{Gq();break}catch(c){FL(t,c)}while(!0);Hk(),V1.current=i,tn=s,br!==null?e=0:(Wr=null,is=0,e=Rr)}if(e!==0){if(e===2&&(s=u2(t),s!==0&&(r=s,e=B2(t,s))),e===1)throw n=ow,Wh(t,0),gd(t,r),Si(t,dr()),n;if(e===6)gd(t,r);else{if(s=t.current.alternate,!(r&30)&&!qq(s)&&(e=K1(t,r),e===2&&(i=u2(t),i!==0&&(r=i,e=B2(t,i))),e===1))throw n=ow,Wh(t,0),gd(t,r),Si(t,dr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Te(345));case 2:$u(t,wi,Wc);break;case 3:if(gd(t,r),(r&130023424)===r&&(e=sI+500-dr(),10<e)){if(k1(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ks(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=x2($u.bind(null,t,wi,Wc),e);break}$u(t,wi,Wc);break;case 4:if(gd(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-ya(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=dr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Wq(r/1960))-r,10<r){t.timeoutHandle=x2($u.bind(null,t,wi,Wc),r);break}$u(t,wi,Wc);break;case 5:$u(t,wi,Wc);break;default:throw Error(Te(329))}}}return Si(t,dr()),t.callbackNode===n?$L.bind(null,t):null}function B2(t,e){var n=xy;return t.current.memoizedState.isDehydrated&&(Wh(t,e).flags|=256),t=K1(t,e),t!==2&&(e=wi,wi=n,e!==null&&$2(e)),t}function $2(t){wi===null?wi=t:wi.push.apply(wi,t)}function qq(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ca(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gd(t,e){for(e&=~rI,e&=~yC,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ya(e),r=1<<n;t[n]=-1,e&=~r}}function IP(t){if(tn&6)throw Error(Te(327));rm();var e=k1(t,0);if(!(e&1))return Si(t,dr()),null;var n=K1(t,e);if(t.tag!==0&&n===2){var r=u2(t);r!==0&&(e=r,n=B2(t,r))}if(n===1)throw n=ow,Wh(t,0),gd(t,e),Si(t,dr()),n;if(n===6)throw Error(Te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$u(t,wi,Wc),Si(t,dr()),null}function iI(t,e){var n=tn;tn|=1;try{return t(e)}finally{tn=n,tn===0&&(cg=dr()+500,fC&&wu())}}function cf(t){$d!==null&&$d.tag===0&&!(tn&6)&&rm();var e=tn;tn|=1;var n=Ro.transition,r=xn;try{if(Ro.transition=null,xn=1,t)return t()}finally{xn=r,Ro.transition=n,tn=e,!(tn&6)&&wu()}}function oI(){zi=Mp.current,Dn(Mp)}function Wh(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Eq(n)),br!==null)for(n=br.return;n!==null;){var r=n;switch($k(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&O1();break;case 3:og(),Dn(Ni),Dn(Ps),Yk();break;case 5:Gk(r);break;case 4:og();break;case 13:Dn(Kn);break;case 19:Dn(Kn);break;case 10:Vk(r.type._context);break;case 22:case 23:oI()}n=n.return}if(Wr=t,br=t=Jd(t.current,null),is=zi=e,Rr=0,ow=null,rI=yC=af=0,wi=xy=null,ah!==null){for(e=0;e<ah.length;e++)if(n=ah[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ah=null}return t}function FL(t,e){do{var n=br;try{if(Hk(),Mv.current=H1,z1){for(var r=Qn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}z1=!1}if(of=0,$r=Tr=Qn=null,yy=!1,rw=0,nI.current=null,n===null||n.return===null){Rr=1,ow=e,br=null;break}e:{var i=t,o=n.return,c=n,l=e;if(e=is,c.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,u=c,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=yP(o);if(p!==null){p.flags&=-257,wP(p,o,c,i,e),p.mode&1&&gP(i,d,e),e=p,l=d;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){gP(i,d,e),aI();break e}l=Error(Te(426))}}else if(Vn&&c.mode&1){var y=yP(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),wP(y,o,c,i,e),Fk(ag(l,c));break e}}i=l=ag(l,c),Rr!==4&&(Rr=2),xy===null?xy=[i]:xy.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=NL(i,l,e);dP(i,x);break e;case 1:c=l;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Yd===null||!Yd.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var v=AL(i,c,e);dP(i,v);break e}}i=i.return}while(i!==null)}VL(n)}catch(E){e=E,br===n&&n!==null&&(br=n=n.return);continue}break}while(!0)}function zL(){var t=V1.current;return V1.current=H1,t===null?H1:t}function aI(){(Rr===0||Rr===3||Rr===2)&&(Rr=4),Wr===null||!(af&268435455)&&!(yC&268435455)||gd(Wr,is)}function K1(t,e){var n=tn;tn|=2;var r=zL();(Wr!==t||is!==e)&&(Wc=null,Wh(t,e));do try{Kq();break}catch(s){FL(t,s)}while(!0);if(Hk(),tn=n,V1.current=r,br!==null)throw Error(Te(261));return Wr=null,is=0,Rr}function Kq(){for(;br!==null;)HL(br)}function Gq(){for(;br!==null&&!xW();)HL(br)}function HL(t){var e=qL(t.alternate,t,zi);t.memoizedProps=t.pendingProps,e===null?VL(t):br=e,nI.current=null}function VL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Fq(n,e),n!==null){n.flags&=32767,br=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Rr=6,br=null;return}}else if(n=$q(n,e,zi),n!==null){br=n;return}if(e=e.sibling,e!==null){br=e;return}br=e=t}while(e!==null);Rr===0&&(Rr=5)}function $u(t,e,n){var r=xn,s=Ro.transition;try{Ro.transition=null,xn=1,Yq(t,e,n,r)}finally{Ro.transition=s,xn=r}return null}function Yq(t,e,n,r){do rm();while($d!==null);if(tn&6)throw Error(Te(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Te(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(kW(t,i),t===Wr&&(br=Wr=null,is=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ob||(Ob=!0,KL(_1,function(){return rm(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ro.transition,Ro.transition=null;var o=xn;xn=1;var c=tn;tn|=4,nI.current=null,Hq(t,n),LL(n,t),mq(y2),I1=!!g2,y2=g2=null,t.current=n,Vq(n),bW(),tn=c,xn=o,Ro.transition=i}else t.current=n;if(Ob&&(Ob=!1,$d=t,q1=s),i=t.pendingLanes,i===0&&(Yd=null),CW(n.stateNode),Si(t,dr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(W1)throw W1=!1,t=M2,M2=null,t;return q1&1&&t.tag!==0&&rm(),i=t.pendingLanes,i&1?t===L2?by++:(by=0,L2=t):by=0,wu(),null}function rm(){if($d!==null){var t=NM(q1),e=Ro.transition,n=xn;try{if(Ro.transition=null,xn=16>t?16:t,$d===null)var r=!1;else{if(t=$d,$d=null,q1=0,tn&6)throw Error(Te(331));var s=tn;for(tn|=4,Qe=t.current;Qe!==null;){var i=Qe,o=i.child;if(Qe.flags&16){var c=i.deletions;if(c!==null){for(var l=0;l<c.length;l++){var d=c[l];for(Qe=d;Qe!==null;){var u=Qe;switch(u.tag){case 0:case 11:case 15:wy(8,u,i)}var h=u.child;if(h!==null)h.return=u,Qe=h;else for(;Qe!==null;){u=Qe;var f=u.sibling,p=u.return;if(DL(u),u===d){Qe=null;break}if(f!==null){f.return=p,Qe=f;break}Qe=p}}}var m=i.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Qe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Qe=o;else e:for(;Qe!==null;){if(i=Qe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wy(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Qe=x;break e}Qe=i.return}}var w=t.current;for(Qe=w;Qe!==null;){o=Qe;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Qe=b;else e:for(o=w;Qe!==null;){if(c=Qe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:gC(9,c)}}catch(E){tr(c,c.return,E)}if(c===o){Qe=null;break e}var v=c.sibling;if(v!==null){v.return=c.return,Qe=v;break e}Qe=c.return}}if(tn=s,wu(),fc&&typeof fc.onPostCommitFiberRoot=="function")try{fc.onPostCommitFiberRoot(cC,t)}catch{}r=!0}return r}finally{xn=n,Ro.transition=e}}return!1}function jP(t,e,n){e=ag(n,e),e=NL(t,e,1),t=Gd(t,e,1),e=Ks(),t!==null&&(Bx(t,1,e),Si(t,e))}function tr(t,e,n){if(t.tag===3)jP(t,t,n);else for(;e!==null;){if(e.tag===3){jP(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Yd===null||!Yd.has(r))){t=ag(n,t),t=AL(e,t,1),e=Gd(e,t,1),t=Ks(),e!==null&&(Bx(e,1,t),Si(e,t));break}}e=e.return}}function Qq(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ks(),t.pingedLanes|=t.suspendedLanes&n,Wr===t&&(is&n)===n&&(Rr===4||Rr===3&&(is&130023424)===is&&500>dr()-sI?Wh(t,0):rI|=n),Si(t,e)}function WL(t,e){e===0&&(t.mode&1?(e=Nb,Nb<<=1,!(Nb&130023424)&&(Nb=4194304)):e=1);var n=Ks();t=Al(t,e),t!==null&&(Bx(t,e,n),Si(t,n))}function Jq(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),WL(t,n)}function Zq(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Te(314))}r!==null&&r.delete(e),WL(t,n)}var qL;qL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ni.current)bi=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return bi=!1,Bq(t,e,n);bi=!!(t.flags&131072)}else bi=!1,Vn&&e.flags&1048576&&QM(e,M1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bv(t,e),t=e.pendingProps;var s=rg(e,Ps.current);nm(e,n),s=Jk(null,e,r,t,s,n);var i=Zk();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ai(r)?(i=!0,D1(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,qk(e),s.updater=mC,e.stateNode=s,s._reactInternals=e,S2(e,r,t,n),e=k2(null,e,r,!0,i,n)):(e.tag=0,Vn&&i&&Bk(e),Bs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bv(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=eK(r),t=Xo(r,t),s){case 0:e=_2(null,e,r,t,n);break e;case 1:e=vP(null,e,r,t,n);break e;case 11:e=xP(null,e,r,t,n);break e;case 14:e=bP(null,e,r,Xo(r.type,t),n);break e}throw Error(Te(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xo(r,s),_2(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xo(r,s),vP(t,e,r,s,n);case 3:e:{if(kL(e),t===null)throw Error(Te(387));r=e.pendingProps,i=e.memoizedState,s=i.element,nL(t,e),$1(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ag(Error(Te(423)),e),e=EP(t,e,r,n,s);break e}else if(r!==s){s=ag(Error(Te(424)),e),e=EP(t,e,r,n,s);break e}else for(Gi=Kd(e.stateNode.containerInfo.firstChild),Qi=e,Vn=!0,ua=null,n=eL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sg(),r===s){e=Sl(t,e,n);break e}Bs(t,e,r,n)}e=e.child}return e;case 5:return rL(e),t===null&&C2(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,w2(r,s)?o=null:i!==null&&w2(r,i)&&(e.flags|=32),_L(t,e),Bs(t,e,o,n),e.child;case 6:return t===null&&C2(e),null;case 13:return IL(t,e,n);case 4:return Kk(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ig(e,null,r,n):Bs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xo(r,s),xP(t,e,r,s,n);case 7:return Bs(t,e,e.pendingProps,n),e.child;case 8:return Bs(t,e,e.pendingProps.children,n),e.child;case 12:return Bs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,In(L1,r._currentValue),r._currentValue=o,i!==null)if(Ca(i.value,o)){if(i.children===s.children&&!Ni.current){e=Sl(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var l=c.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=gl(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?l.next=l:(l.next=u.next,u.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),N2(i.return,n,e),c.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Te(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),N2(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Bs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,nm(e,n),s=Uo(s),r=r(s),e.flags|=1,Bs(t,e,r,n),e.child;case 14:return r=e.type,s=Xo(r,e.pendingProps),s=Xo(r.type,s),bP(t,e,r,s,n);case 15:return SL(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Xo(r,s),Bv(t,e),e.tag=1,Ai(r)?(t=!0,D1(e)):t=!1,nm(e,n),CL(e,r,s),S2(e,r,s,n),k2(null,e,r,!0,t,n);case 19:return jL(t,e,n);case 22:return TL(t,e,n)}throw Error(Te(156,e.tag))};function KL(t,e){return bM(t,e)}function Xq(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Io(t,e,n,r){return new Xq(t,e,n,r)}function cI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function eK(t){if(typeof t=="function")return cI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tk)return 11;if(t===_k)return 14}return 2}function Jd(t,e){var n=t.alternate;return n===null?(n=Io(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function zv(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")cI(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Tp:return qh(n.children,s,i,e);case Sk:o=8,s|=8;break;case QS:return t=Io(12,n,e,s|2),t.elementType=QS,t.lanes=i,t;case JS:return t=Io(13,n,e,s),t.elementType=JS,t.lanes=i,t;case ZS:return t=Io(19,n,e,s),t.elementType=ZS,t.lanes=i,t;case rM:return wC(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case tM:o=10;break e;case nM:o=9;break e;case Tk:o=11;break e;case _k:o=14;break e;case cd:o=16,r=null;break e}throw Error(Te(130,t==null?t:typeof t,""))}return e=Io(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function qh(t,e,n,r){return t=Io(7,t,r,e),t.lanes=n,t}function wC(t,e,n,r){return t=Io(22,t,r,e),t.elementType=rM,t.lanes=n,t.stateNode={isHidden:!1},t}function tA(t,e,n){return t=Io(6,t,null,e),t.lanes=n,t}function nA(t,e,n){return e=Io(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function tK(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=UN(0),this.expirationTimes=UN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=UN(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function lI(t,e,n,r,s,i,o,c,l){return t=new tK(t,e,n,c,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Io(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qk(i),t}function nK(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Sp,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function GL(t){if(!t)return iu;t=t._reactInternals;e:{if(kf(t)!==t||t.tag!==1)throw Error(Te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ai(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Te(171))}if(t.tag===1){var n=t.type;if(Ai(n))return GM(t,n,e)}return e}function YL(t,e,n,r,s,i,o,c,l){return t=lI(n,r,!0,t,s,i,o,c,l),t.context=GL(null),n=t.current,r=Ks(),s=Qd(n),i=gl(r,s),i.callback=e??null,Gd(n,i,s),t.current.lanes=s,Bx(t,s,r),Si(t,r),t}function xC(t,e,n,r){var s=e.current,i=Ks(),o=Qd(s);return n=GL(n),e.context===null?e.context=n:e.pendingContext=n,e=gl(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Gd(s,e,o),t!==null&&(wa(t,s,o,i),Uv(t,s,o)),o}function G1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function RP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function dI(t,e){RP(t,e),(t=t.alternate)&&RP(t,e)}function rK(){return null}var QL=typeof reportError=="function"?reportError:function(t){console.error(t)};function uI(t){this._internalRoot=t}bC.prototype.render=uI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Te(409));xC(t,e,null,null)};bC.prototype.unmount=uI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;cf(function(){xC(null,t,null,null)}),e[Nl]=null}};function bC(t){this._internalRoot=t}bC.prototype.unstable_scheduleHydration=function(t){if(t){var e=TM();t={blockedOn:null,target:t,priority:e};for(var n=0;n<md.length&&e!==0&&e<md[n].priority;n++);md.splice(n,0,t),n===0&&kM(t)}};function hI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function vC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function PP(){}function sK(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=G1(o);i.call(d)}}var o=YL(e,r,t,0,null,!1,!1,"",PP);return t._reactRootContainer=o,t[Nl]=o.current,Zy(t.nodeType===8?t.parentNode:t),cf(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=G1(l);c.call(d)}}var l=lI(t,0,!1,null,null,!1,!1,"",PP);return t._reactRootContainer=l,t[Nl]=l.current,Zy(t.nodeType===8?t.parentNode:t),cf(function(){xC(e,l,n,r)}),l}function EC(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var l=G1(o);c.call(l)}}xC(e,o,t,s)}else o=sK(n,e,t,s,r);return G1(o)}AM=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Q0(e.pendingLanes);n!==0&&(jk(e,n|1),Si(e,dr()),!(tn&6)&&(cg=dr()+500,wu()))}break;case 13:cf(function(){var r=Al(t,1);if(r!==null){var s=Ks();wa(r,t,1,s)}}),dI(t,1)}};Rk=function(t){if(t.tag===13){var e=Al(t,134217728);if(e!==null){var n=Ks();wa(e,t,134217728,n)}dI(t,134217728)}};SM=function(t){if(t.tag===13){var e=Qd(t),n=Al(t,e);if(n!==null){var r=Ks();wa(n,t,e,r)}dI(t,e)}};TM=function(){return xn};_M=function(t,e){var n=xn;try{return xn=t,e()}finally{xn=n}};c2=function(t,e,n){switch(e){case"input":if(t2(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=hC(r);if(!s)throw Error(Te(90));iM(r),t2(r,s)}}}break;case"textarea":aM(t,n);break;case"select":e=n.value,e!=null&&Zp(t,!!n.multiple,e,!1)}};pM=iI;mM=cf;var iK={usingClientEntryPoint:!1,Events:[Fx,jp,hC,hM,fM,iI]},w0={findFiberByHostInstance:oh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oK={bundleType:w0.bundleType,version:w0.version,rendererPackageName:w0.rendererPackageName,rendererConfig:w0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ul.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wM(t),t===null?null:t.stateNode},findFiberByHostInstance:w0.findFiberByHostInstance||rK,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Db=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Db.isDisabled&&Db.supportsFiber)try{cC=Db.inject(oK),fc=Db}catch{}}to.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iK;to.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hI(e))throw Error(Te(200));return nK(t,e,null,n)};to.createRoot=function(t,e){if(!hI(t))throw Error(Te(299));var n=!1,r="",s=QL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=lI(t,1,!1,null,null,n,!1,r,s),t[Nl]=e.current,Zy(t.nodeType===8?t.parentNode:t),new uI(e)};to.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Te(188)):(t=Object.keys(t).join(","),Error(Te(268,t)));return t=wM(e),t=t===null?null:t.stateNode,t};to.flushSync=function(t){return cf(t)};to.hydrate=function(t,e,n){if(!vC(e))throw Error(Te(200));return EC(null,t,e,!0,n)};to.hydrateRoot=function(t,e,n){if(!hI(t))throw Error(Te(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=QL;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=YL(e,null,t,1,n??null,s,!1,i,o),t[Nl]=e.current,Zy(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new bC(e)};to.render=function(t,e,n){if(!vC(e))throw Error(Te(200));return EC(null,t,e,!1,n)};to.unmountComponentAtNode=function(t){if(!vC(t))throw Error(Te(40));return t._reactRootContainer?(cf(function(){EC(null,null,t,!1,function(){t._reactRootContainer=null,t[Nl]=null})}),!0):!1};to.unstable_batchedUpdates=iI;to.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!vC(n))throw Error(Te(200));if(t==null||t._reactInternals===void 0)throw Error(Te(38));return EC(t,e,n,!1,r)};to.version="18.3.1-next-f1338f8080-20240426";function JL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(JL)}catch(t){console.error(t)}}JL(),JU.exports=to;var fI=JU.exports;const aK=Mg(fI),cK=LU({__proto__:null,default:aK},[fI]);var ZL,OP=fI;ZL=OP.createRoot,OP.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hn(){return Hn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hn.apply(this,arguments)}var gr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gr||(gr={}));const DP="popstate";function lK(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:c}=r.location;return aw("",{pathname:i,search:o,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:lf(s)}return uK(e,n,null,t)}function Ut(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function lg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function dK(){return Math.random().toString(36).substr(2,8)}function UP(t,e){return{usr:t.state,key:t.key,idx:e}}function aw(t,e,n,r){return n===void 0&&(n=null),Hn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?xu(e):e,{state:n,key:e&&e.key||r||dK()})}function lf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function xu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function uK(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,c=gr.Pop,l=null,d=u();d==null&&(d=0,o.replaceState(Hn({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function h(){c=gr.Pop;let y=u(),x=y==null?null:y-d;d=y,l&&l({action:c,location:g.location,delta:x})}function f(y,x){c=gr.Push;let w=aw(g.location,y,x);d=u()+1;let b=UP(w,d),v=g.createHref(w);try{o.pushState(b,"",v)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(v)}i&&l&&l({action:c,location:g.location,delta:1})}function p(y,x){c=gr.Replace;let w=aw(g.location,y,x);d=u();let b=UP(w,d),v=g.createHref(w);o.replaceState(b,"",v),i&&l&&l({action:c,location:g.location,delta:0})}function m(y){let x=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof y=="string"?y:lf(y);return w=w.replace(/ $/,"%20"),Ut(x,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,x)}let g={get action(){return c},get location(){return t(s,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(DP,h),l=y,()=>{s.removeEventListener(DP,h),l=null}},createHref(y){return e(s,y)},createURL:m,encodeLocation(y){let x=m(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:p,go(y){return o.go(y)}};return g}var wn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(wn||(wn={}));const hK=new Set(["lazy","caseSensitive","path","id","index","children"]);function fK(t){return t.index===!0}function Y1(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],c=typeof s.id=="string"?s.id:o.join("-");if(Ut(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ut(!r[c],'Found a route id collision on id "'+c+`".  Route id's must be globally unique within Data Router usages`),fK(s)){let l=Hn({},s,e(s),{id:c});return r[c]=l,l}else{let l=Hn({},s,e(s),{id:c,children:void 0});return r[c]=l,s.children&&(l.children=Y1(s.children,e,o,r)),l}})}function qu(t,e,n){return n===void 0&&(n="/"),Hv(t,e,n,!1)}function Hv(t,e,n,r){let s=typeof e=="string"?xu(e):e,i=Fg(s.pathname||"/",n);if(i==null)return null;let o=XL(t);mK(o);let c=null;for(let l=0;c==null&&l<o.length;++l){let d=SK(i);c=NK(o[l],d,r)}return c}function pK(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function XL(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,c)=>{let l={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Ut(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let d=yl([r,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(Ut(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),XL(i.children,e,u,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:EK(d,i.index),routesMeta:u})};return t.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))s(i,o);else for(let l of eB(i.path))s(i,o,l)}),e}function eB(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=eB(r.join("/")),c=[];return c.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&c.push(...o),c.map(l=>t.startsWith("/")&&l===""?"/":l)}function mK(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:CK(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const gK=/^:[\w-]+$/,yK=3,wK=2,xK=1,bK=10,vK=-2,MP=t=>t==="*";function EK(t,e){let n=t.split("/"),r=n.length;return n.some(MP)&&(r+=vK),e&&(r+=wK),n.filter(s=>!MP(s)).reduce((s,i)=>s+(gK.test(i)?yK:i===""?xK:bK),r)}function CK(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function NK(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let c=0;c<r.length;++c){let l=r[c],d=c===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=LP({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},u),f=l.route;if(!h&&d&&n&&!r[r.length-1].route.index&&(h=LP({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:yl([i,h.pathname]),pathnameBase:kK(yl([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=yl([i,h.pathnameBase]))}return o}function LP(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=AK(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,u,h)=>{let{paramName:f,isOptional:p}=u;if(f==="*"){let g=c[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const m=c[h];return p&&!m?d[f]=void 0:d[f]=(m||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function AK(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),lg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,l)=>(r.push({paramName:c,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function SK(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return lg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Fg(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function TK(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?xu(t):t;return{pathname:n?n.startsWith("/")?n:_K(n,e):e,search:IK(r),hash:jK(s)}}function _K(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function rA(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tB(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function CC(t,e){let n=tB(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function NC(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=xu(t):(s=Hn({},t),Ut(!s.pathname||!s.pathname.includes("?"),rA("?","pathname","search",s)),Ut(!s.pathname||!s.pathname.includes("#"),rA("#","pathname","hash",s)),Ut(!s.search||!s.search.includes("#"),rA("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,c;if(o==null)c=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}c=h>=0?e[h]:"/"}let l=TK(s,c),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||u)&&(l.pathname+="/"),l}const yl=t=>t.join("/").replace(/\/\/+/g,"/"),kK=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),IK=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,jK=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Q1{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function cw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const nB=["post","put","patch","delete"],RK=new Set(nB),PK=["get",...nB],OK=new Set(PK),DK=new Set([301,302,303,307,308]),UK=new Set([307,308]),sA={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},MK={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},x0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},pI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LK=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),rB="remix-router-transitions";function BK(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Ut(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let K=t.detectErrorBoundary;s=te=>({hasErrorBoundary:K(te)})}else s=LK;let i={},o=Y1(t.routes,s,void 0,i),c,l=t.basename||"/",d=t.dataStrategy||HK,u=t.patchRoutesOnNavigation,h=Hn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,p=new Set,m=null,g=null,y=null,x=t.hydrationData!=null,w=qu(o,t.history.location,l),b=!1,v=null;if(w==null&&!u){let K=hi(404,{pathname:t.history.location.pathname}),{matches:te,route:re}=YP(o);w=te,v={[re.id]:K}}w&&!t.hydrationData&&Ia(w,o,t.history.location.pathname).active&&(w=null);let E;if(w)if(w.some(K=>K.route.lazy))E=!1;else if(!w.some(K=>K.route.loader))E=!0;else if(h.v7_partialHydration){let K=t.hydrationData?t.hydrationData.loaderData:null,te=t.hydrationData?t.hydrationData.errors:null;if(te){let re=w.findIndex(be=>te[be.route.id]!==void 0);E=w.slice(0,re+1).every(be=>!z2(be.route,K,te))}else E=w.every(re=>!z2(re.route,K,te))}else E=t.hydrationData!=null;else if(E=!1,w=[],h.v7_partialHydration){let K=Ia(null,o,t.history.location.pathname);K.active&&K.matches&&(b=!0,w=K.matches)}let k,C={historyAction:t.history.action,location:t.history.location,matches:w,initialized:E,navigation:sA,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||v,fetchers:new Map,blockers:new Map},S=gr.Pop,N=!1,I,F=!1,P=new Map,H=null,z=!1,T=!1,_=[],L=new Set,O=new Map,M=0,B=-1,W=new Map,Z=new Set,ie=new Map,ae=new Map,oe=new Set,Ne=new Map,de=new Map,_e;function Ue(){if(f=t.history.listen(K=>{let{action:te,location:re,delta:be}=K;if(_e){_e(),_e=void 0;return}lg(de.size===0||be!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Me=gb({currentLocation:C.location,nextLocation:re,historyAction:te});if(Me&&be!=null){let at=new Promise(mt=>{_e=mt});t.history.go(be*-1),zf(Me,{state:"blocked",location:re,proceed(){zf(Me,{state:"proceeding",proceed:void 0,reset:void 0,location:re}),at.then(()=>t.history.go(be))},reset(){let mt=new Map(C.blockers);mt.set(Me,x0),ue({blockers:mt})}});return}return je(te,re)}),n){rG(e,P);let K=()=>sG(e,P);e.addEventListener("pagehide",K),H=()=>e.removeEventListener("pagehide",K)}return C.initialized||je(gr.Pop,C.location,{initialHydration:!0}),k}function ee(){f&&f(),H&&H(),p.clear(),I&&I.abort(),C.fetchers.forEach((K,te)=>Rc(te)),C.blockers.forEach((K,te)=>Ff(te))}function q(K){return p.add(K),()=>p.delete(K)}function ue(K,te){te===void 0&&(te={}),C=Hn({},C,K);let re=[],be=[];h.v7_fetcherPersist&&C.fetchers.forEach((Me,at)=>{Me.state==="idle"&&(oe.has(at)?be.push(at):re.push(at))}),oe.forEach(Me=>{!C.fetchers.has(Me)&&!O.has(Me)&&be.push(Me)}),[...p].forEach(Me=>Me(C,{deletedFetchers:be,viewTransitionOpts:te.viewTransitionOpts,flushSync:te.flushSync===!0})),h.v7_fetcherPersist?(re.forEach(Me=>C.fetchers.delete(Me)),be.forEach(Me=>Rc(Me))):be.forEach(Me=>oe.delete(Me))}function Ae(K,te,re){var be,Me;let{flushSync:at}=re===void 0?{}:re,mt=C.actionData!=null&&C.navigation.formMethod!=null&&la(C.navigation.formMethod)&&C.navigation.state==="loading"&&((be=K.state)==null?void 0:be._isRedirect)!==!0,Xe;te.actionData?Object.keys(te.actionData).length>0?Xe=te.actionData:Xe=null:mt?Xe=C.actionData:Xe=null;let et=te.loaderData?KP(C.loaderData,te.loaderData,te.matches||[],te.errors):C.loaderData,He=C.blockers;He.size>0&&(He=new Map(He),He.forEach((Rt,pr)=>He.set(pr,x0)));let it=N===!0||C.navigation.formMethod!=null&&la(C.navigation.formMethod)&&((Me=K.state)==null?void 0:Me._isRedirect)!==!0;c&&(o=c,c=void 0),z||S===gr.Pop||(S===gr.Push?t.history.push(K,K.state):S===gr.Replace&&t.history.replace(K,K.state));let Et;if(S===gr.Pop){let Rt=P.get(C.location.pathname);Rt&&Rt.has(K.pathname)?Et={currentLocation:C.location,nextLocation:K}:P.has(K.pathname)&&(Et={currentLocation:K,nextLocation:C.location})}else if(F){let Rt=P.get(C.location.pathname);Rt?Rt.add(K.pathname):(Rt=new Set([K.pathname]),P.set(C.location.pathname,Rt)),Et={currentLocation:C.location,nextLocation:K}}ue(Hn({},te,{actionData:Xe,loaderData:et,historyAction:S,location:K,initialized:!0,navigation:sA,revalidation:"idle",restoreScrollPosition:Tu(K,te.matches||C.matches),preventScrollReset:it,blockers:He}),{viewTransitionOpts:Et,flushSync:at===!0}),S=gr.Pop,N=!1,F=!1,z=!1,T=!1,_=[]}async function tt(K,te){if(typeof K=="number"){t.history.go(K);return}let re=F2(C.location,C.matches,l,h.v7_prependBasename,K,h.v7_relativeSplatPath,te==null?void 0:te.fromRouteId,te==null?void 0:te.relative),{path:be,submission:Me,error:at}=BP(h.v7_normalizeFormMethod,!1,re,te),mt=C.location,Xe=aw(C.location,be,te&&te.state);Xe=Hn({},Xe,t.history.encodeLocation(Xe));let et=te&&te.replace!=null?te.replace:void 0,He=gr.Push;et===!0?He=gr.Replace:et===!1||Me!=null&&la(Me.formMethod)&&Me.formAction===C.location.pathname+C.location.search&&(He=gr.Replace);let it=te&&"preventScrollReset"in te?te.preventScrollReset===!0:void 0,Et=(te&&te.flushSync)===!0,Rt=gb({currentLocation:mt,nextLocation:Xe,historyAction:He});if(Rt){zf(Rt,{state:"blocked",location:Xe,proceed(){zf(Rt,{state:"proceeding",proceed:void 0,reset:void 0,location:Xe}),tt(K,te)},reset(){let pr=new Map(C.blockers);pr.set(Rt,x0),ue({blockers:pr})}});return}return await je(He,Xe,{submission:Me,pendingError:at,preventScrollReset:it,replace:te&&te.replace,enableViewTransition:te&&te.viewTransition,flushSync:Et})}function me(){if(so(),ue({revalidation:"loading"}),C.navigation.state!=="submitting"){if(C.navigation.state==="idle"){je(C.historyAction,C.location,{startUninterruptedRevalidation:!0});return}je(S||C.historyAction,C.navigation.location,{overrideNavigation:C.navigation,enableViewTransition:F===!0})}}async function je(K,te,re){I&&I.abort(),I=null,S=K,z=(re&&re.startUninterruptedRevalidation)===!0,TN(C.location,C.matches),N=(re&&re.preventScrollReset)===!0,F=(re&&re.enableViewTransition)===!0;let be=c||o,Me=re&&re.overrideNavigation,at=re!=null&&re.initialHydration&&C.matches&&C.matches.length>0&&!b?C.matches:qu(be,te,l),mt=(re&&re.flushSync)===!0;if(at&&C.initialized&&!T&&YK(C.location,te)&&!(re&&re.submission&&la(re.submission.formMethod))){Ae(te,{matches:at},{flushSync:mt});return}let Xe=Ia(at,be,te.pathname);if(Xe.active&&Xe.matches&&(at=Xe.matches),!at){let{error:gn,notFoundMatches:Bt,route:j}=a0(te.pathname);Ae(te,{matches:Bt,loaderData:{},errors:{[j.id]:gn}},{flushSync:mt});return}I=new AbortController;let et=Wf(t.history,te,I.signal,re&&re.submission),He;if(re&&re.pendingError)He=[Ku(at).route.id,{type:wn.error,error:re.pendingError}];else if(re&&re.submission&&la(re.submission.formMethod)){let gn=await pe(et,te,re.submission,at,Xe.active,{replace:re.replace,flushSync:mt});if(gn.shortCircuited)return;if(gn.pendingActionResult){let[Bt,j]=gn.pendingActionResult;if(Vi(j)&&cw(j.error)&&j.error.status===404){I=null,Ae(te,{matches:gn.matches,loaderData:{},errors:{[Bt]:j.error}});return}}at=gn.matches||at,He=gn.pendingActionResult,Me=iA(te,re.submission),mt=!1,Xe.active=!1,et=Wf(t.history,et.url,et.signal)}let{shortCircuited:it,matches:Et,loaderData:Rt,errors:pr}=await ot(et,te,at,Xe.active,Me,re&&re.submission,re&&re.fetcherSubmission,re&&re.replace,re&&re.initialHydration===!0,mt,He);it||(I=null,Ae(te,Hn({matches:Et||at},GP(He),{loaderData:Rt,errors:pr})))}async function pe(K,te,re,be,Me,at){at===void 0&&(at={}),so();let mt=tG(te,re);if(ue({navigation:mt},{flushSync:at.flushSync===!0}),Me){let He=await Hf(be,te.pathname,K.signal);if(He.type==="aborted")return{shortCircuited:!0};if(He.type==="error"){let it=Ku(He.partialMatches).route.id;return{matches:He.partialMatches,pendingActionResult:[it,{type:wn.error,error:He.error}]}}else if(He.matches)be=He.matches;else{let{notFoundMatches:it,error:Et,route:Rt}=a0(te.pathname);return{matches:it,pendingActionResult:[Rt.id,{type:wn.error,error:Et}]}}}let Xe,et=Z0(be,te);if(!et.route.action&&!et.route.lazy)Xe={type:wn.error,error:hi(405,{method:K.method,pathname:te.pathname,routeId:et.route.id})};else if(Xe=(await pt("action",C,K,[et],be,null))[et.route.id],K.signal.aborted)return{shortCircuited:!0};if(lh(Xe)){let He;return at&&at.replace!=null?He=at.replace:He=VP(Xe.response.headers.get("Location"),new URL(K.url),l)===C.location.pathname+C.location.search,await ht(K,Xe,!0,{submission:re,replace:He}),{shortCircuited:!0}}if(Fd(Xe))throw hi(400,{type:"defer-action"});if(Vi(Xe)){let He=Ku(be,et.route.id);return(at&&at.replace)!==!0&&(S=gr.Push),{matches:be,pendingActionResult:[He.route.id,Xe]}}return{matches:be,pendingActionResult:[et.route.id,Xe]}}async function ot(K,te,re,be,Me,at,mt,Xe,et,He,it){let Et=Me||iA(te,at),Rt=at||mt||JP(Et),pr=!z&&(!h.v7_partialHydration||!et);if(be){if(pr){let gt=Tn(it);ue(Hn({navigation:Et},gt!==void 0?{actionData:gt}:{}),{flushSync:He})}let Se=await Hf(re,te.pathname,K.signal);if(Se.type==="aborted")return{shortCircuited:!0};if(Se.type==="error"){let gt=Ku(Se.partialMatches).route.id;return{matches:Se.partialMatches,loaderData:{},errors:{[gt]:Se.error}}}else if(Se.matches)re=Se.matches;else{let{error:gt,notFoundMatches:ps,route:ja}=a0(te.pathname);return{matches:ps,loaderData:{},errors:{[ja.id]:gt}}}}let gn=c||o,[Bt,j]=FP(t.history,C,re,Rt,te,h.v7_partialHydration&&et===!0,h.v7_skipActionErrorRevalidation,T,_,L,oe,ie,Z,gn,l,it);if(c0(Se=>!(re&&re.some(gt=>gt.route.id===Se))||Bt&&Bt.some(gt=>gt.route.id===Se)),B=++M,Bt.length===0&&j.length===0){let Se=Su();return Ae(te,Hn({matches:re,loaderData:{},errors:it&&Vi(it[1])?{[it[0]]:it[1].error}:null},GP(it),Se?{fetchers:new Map(C.fetchers)}:{}),{flushSync:He}),{shortCircuited:!0}}if(pr){let Se={};if(!be){Se.navigation=Et;let gt=Tn(it);gt!==void 0&&(Se.actionData=gt)}j.length>0&&(Se.fetchers=nt(j)),ue(Se,{flushSync:He})}j.forEach(Se=>{Xs(Se.key),Se.controller&&O.set(Se.key,Se.controller)});let Y=()=>j.forEach(Se=>Xs(Se.key));I&&I.signal.addEventListener("abort",Y);let{loaderResults:Q,fetcherResults:le}=await jn(C,re,Bt,j,K);if(K.signal.aborted)return{shortCircuited:!0};I&&I.signal.removeEventListener("abort",Y),j.forEach(Se=>O.delete(Se.key));let ce=Ub(Q);if(ce)return await ht(K,ce.result,!0,{replace:Xe}),{shortCircuited:!0};if(ce=Ub(le),ce)return Z.add(ce.key),await ht(K,ce.result,!0,{replace:Xe}),{shortCircuited:!0};let{loaderData:he,errors:ve}=qP(C,re,Q,it,j,le,Ne);Ne.forEach((Se,gt)=>{Se.subscribe(ps=>{(ps||Se.done)&&Ne.delete(gt)})}),h.v7_partialHydration&&et&&C.errors&&(ve=Hn({},C.errors,ve));let Oe=Su(),xe=ka(B),we=Oe||xe||j.length>0;return Hn({matches:re,loaderData:he,errors:ve},we?{fetchers:new Map(C.fetchers)}:{})}function Tn(K){if(K&&!Vi(K[1]))return{[K[0]]:K[1].data};if(C.actionData)return Object.keys(C.actionData).length===0?null:C.actionData}function nt(K){return K.forEach(te=>{let re=C.fetchers.get(te.key),be=b0(void 0,re?re.data:void 0);C.fetchers.set(te.key,be)}),new Map(C.fetchers)}function mn(K,te,re,be){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Xs(K);let Me=(be&&be.flushSync)===!0,at=c||o,mt=F2(C.location,C.matches,l,h.v7_prependBasename,re,h.v7_relativeSplatPath,te,be==null?void 0:be.relative),Xe=qu(at,mt,l),et=Ia(Xe,at,mt);if(et.active&&et.matches&&(Xe=et.matches),!Xe){or(K,te,hi(404,{pathname:mt}),{flushSync:Me});return}let{path:He,submission:it,error:Et}=BP(h.v7_normalizeFormMethod,!0,mt,be);if(Et){or(K,te,Et,{flushSync:Me});return}let Rt=Z0(Xe,He),pr=(be&&be.preventScrollReset)===!0;if(it&&la(it.formMethod)){Ve(K,te,He,Rt,Xe,et.active,Me,pr,it);return}ie.set(K,{routeId:te,path:He}),rt(K,te,He,Rt,Xe,et.active,Me,pr,it)}async function Ve(K,te,re,be,Me,at,mt,Xe,et){so(),ie.delete(K);function He(vn){if(!vn.route.action&&!vn.route.lazy){let Ur=hi(405,{method:et.formMethod,pathname:re,routeId:te});return or(K,te,Ur,{flushSync:mt}),!0}return!1}if(!at&&He(be))return;let it=C.fetchers.get(K);Gt(K,nG(et,it),{flushSync:mt});let Et=new AbortController,Rt=Wf(t.history,re,Et.signal,et);if(at){let vn=await Hf(Me,new URL(Rt.url).pathname,Rt.signal,K);if(vn.type==="aborted")return;if(vn.type==="error"){or(K,te,vn.error,{flushSync:mt});return}else if(vn.matches){if(Me=vn.matches,be=Z0(Me,re),He(be))return}else{or(K,te,hi(404,{pathname:re}),{flushSync:mt});return}}O.set(K,Et);let pr=M,Bt=(await pt("action",C,Rt,[be],Me,K))[be.route.id];if(Rt.signal.aborted){O.get(K)===Et&&O.delete(K);return}if(h.v7_fetcherPersist&&oe.has(K)){if(lh(Bt)||Vi(Bt)){Gt(K,sd(void 0));return}}else{if(lh(Bt))if(O.delete(K),B>pr){Gt(K,sd(void 0));return}else return Z.add(K),Gt(K,b0(et)),ht(Rt,Bt,!1,{fetcherSubmission:et,preventScrollReset:Xe});if(Vi(Bt)){or(K,te,Bt.error);return}}if(Fd(Bt))throw hi(400,{type:"defer-action"});let j=C.navigation.location||C.location,Y=Wf(t.history,j,Et.signal),Q=c||o,le=C.navigation.state!=="idle"?qu(Q,C.navigation.location,l):C.matches;Ut(le,"Didn't find any matches after fetcher action");let ce=++M;W.set(K,ce);let he=b0(et,Bt.data);C.fetchers.set(K,he);let[ve,Oe]=FP(t.history,C,le,et,j,!1,h.v7_skipActionErrorRevalidation,T,_,L,oe,ie,Z,Q,l,[be.route.id,Bt]);Oe.filter(vn=>vn.key!==K).forEach(vn=>{let Ur=vn.key,_u=C.fetchers.get(Ur),ku=b0(void 0,_u?_u.data:void 0);C.fetchers.set(Ur,ku),Xs(Ur),vn.controller&&O.set(Ur,vn.controller)}),ue({fetchers:new Map(C.fetchers)});let xe=()=>Oe.forEach(vn=>Xs(vn.key));Et.signal.addEventListener("abort",xe);let{loaderResults:we,fetcherResults:Se}=await jn(C,le,ve,Oe,Y);if(Et.signal.aborted)return;Et.signal.removeEventListener("abort",xe),W.delete(K),O.delete(K),Oe.forEach(vn=>O.delete(vn.key));let gt=Ub(we);if(gt)return ht(Y,gt.result,!1,{preventScrollReset:Xe});if(gt=Ub(Se),gt)return Z.add(gt.key),ht(Y,gt.result,!1,{preventScrollReset:Xe});let{loaderData:ps,errors:ja}=qP(C,le,we,void 0,Oe,Se,Ne);if(C.fetchers.has(K)){let vn=sd(Bt.data);C.fetchers.set(K,vn)}ka(ce),C.navigation.state==="loading"&&ce>B?(Ut(S,"Expected pending action"),I&&I.abort(),Ae(C.navigation.location,{matches:le,loaderData:ps,errors:ja,fetchers:new Map(C.fetchers)})):(ue({errors:ja,loaderData:KP(C.loaderData,ps,le,ja),fetchers:new Map(C.fetchers)}),T=!1)}async function rt(K,te,re,be,Me,at,mt,Xe,et){let He=C.fetchers.get(K);Gt(K,b0(et,He?He.data:void 0),{flushSync:mt});let it=new AbortController,Et=Wf(t.history,re,it.signal);if(at){let Bt=await Hf(Me,new URL(Et.url).pathname,Et.signal,K);if(Bt.type==="aborted")return;if(Bt.type==="error"){or(K,te,Bt.error,{flushSync:mt});return}else if(Bt.matches)Me=Bt.matches,be=Z0(Me,re);else{or(K,te,hi(404,{pathname:re}),{flushSync:mt});return}}O.set(K,it);let Rt=M,gn=(await pt("loader",C,Et,[be],Me,K))[be.route.id];if(Fd(gn)&&(gn=await mI(gn,Et.signal,!0)||gn),O.get(K)===it&&O.delete(K),!Et.signal.aborted){if(oe.has(K)){Gt(K,sd(void 0));return}if(lh(gn))if(B>Rt){Gt(K,sd(void 0));return}else{Z.add(K),await ht(Et,gn,!1,{preventScrollReset:Xe});return}if(Vi(gn)){or(K,te,gn.error);return}Ut(!Fd(gn),"Unhandled fetcher deferred data"),Gt(K,sd(gn.data))}}async function ht(K,te,re,be){let{submission:Me,fetcherSubmission:at,preventScrollReset:mt,replace:Xe}=be===void 0?{}:be;te.response.headers.has("X-Remix-Revalidate")&&(T=!0);let et=te.response.headers.get("Location");Ut(et,"Expected a Location header on the redirect Response"),et=VP(et,new URL(K.url),l);let He=aw(C.location,et,{_isRedirect:!0});if(n){let Bt=!1;if(te.response.headers.has("X-Remix-Reload-Document"))Bt=!0;else if(pI.test(et)){const j=t.history.createURL(et);Bt=j.origin!==e.location.origin||Fg(j.pathname,l)==null}if(Bt){Xe?e.location.replace(et):e.location.assign(et);return}}I=null;let it=Xe===!0||te.response.headers.has("X-Remix-Replace")?gr.Replace:gr.Push,{formMethod:Et,formAction:Rt,formEncType:pr}=C.navigation;!Me&&!at&&Et&&Rt&&pr&&(Me=JP(C.navigation));let gn=Me||at;if(UK.has(te.response.status)&&gn&&la(gn.formMethod))await je(it,He,{submission:Hn({},gn,{formAction:et}),preventScrollReset:mt||N,enableViewTransition:re?F:void 0});else{let Bt=iA(He,Me);await je(it,He,{overrideNavigation:Bt,fetcherSubmission:at,preventScrollReset:mt||N,enableViewTransition:re?F:void 0})}}async function pt(K,te,re,be,Me,at){let mt,Xe={};try{mt=await VK(d,K,te,re,be,Me,at,i,s)}catch(et){return be.forEach(He=>{Xe[He.route.id]={type:wn.error,error:et}}),Xe}for(let[et,He]of Object.entries(mt))if(QK(He)){let it=He.result;Xe[et]={type:wn.redirect,response:KK(it,re,et,Me,l,h.v7_relativeSplatPath)}}else Xe[et]=await qK(He);return Xe}async function jn(K,te,re,be,Me){let at=K.matches,mt=pt("loader",K,Me,re,te,null),Xe=Promise.all(be.map(async it=>{if(it.matches&&it.match&&it.controller){let Rt=(await pt("loader",K,Wf(t.history,it.path,it.controller.signal),[it.match],it.matches,it.key))[it.match.route.id];return{[it.key]:Rt}}else return Promise.resolve({[it.key]:{type:wn.error,error:hi(404,{pathname:it.path})}})})),et=await mt,He=(await Xe).reduce((it,Et)=>Object.assign(it,Et),{});return await Promise.all([XK(te,et,Me.signal,at,K.loaderData),eG(te,He,be)]),{loaderResults:et,fetcherResults:He}}function so(){T=!0,_.push(...c0()),ie.forEach((K,te)=>{O.has(te)&&L.add(te),Xs(te)})}function Gt(K,te,re){re===void 0&&(re={}),C.fetchers.set(K,te),ue({fetchers:new Map(C.fetchers)},{flushSync:(re&&re.flushSync)===!0})}function or(K,te,re,be){be===void 0&&(be={});let Me=Ku(C.matches,te);Rc(K),ue({errors:{[Me.route.id]:re},fetchers:new Map(C.fetchers)},{flushSync:(be&&be.flushSync)===!0})}function jc(K){return ae.set(K,(ae.get(K)||0)+1),oe.has(K)&&oe.delete(K),C.fetchers.get(K)||MK}function Rc(K){let te=C.fetchers.get(K);O.has(K)&&!(te&&te.state==="loading"&&W.has(K))&&Xs(K),ie.delete(K),W.delete(K),Z.delete(K),h.v7_fetcherPersist&&oe.delete(K),L.delete(K),C.fetchers.delete(K)}function Ll(K){let te=(ae.get(K)||0)-1;te<=0?(ae.delete(K),oe.add(K),h.v7_fetcherPersist||Rc(K)):ae.set(K,te),ue({fetchers:new Map(C.fetchers)})}function Xs(K){let te=O.get(K);te&&(te.abort(),O.delete(K))}function ei(K){for(let te of K){let re=jc(te),be=sd(re.data);C.fetchers.set(te,be)}}function Su(){let K=[],te=!1;for(let re of Z){let be=C.fetchers.get(re);Ut(be,"Expected fetcher: "+re),be.state==="loading"&&(Z.delete(re),K.push(re),te=!0)}return ei(K),te}function ka(K){let te=[];for(let[re,be]of W)if(be<K){let Me=C.fetchers.get(re);Ut(Me,"Expected fetcher: "+re),Me.state==="loading"&&(Xs(re),W.delete(re),te.push(re))}return ei(te),te.length>0}function qr(K,te){let re=C.blockers.get(K)||x0;return de.get(K)!==te&&de.set(K,te),re}function Ff(K){C.blockers.delete(K),de.delete(K)}function zf(K,te){let re=C.blockers.get(K)||x0;Ut(re.state==="unblocked"&&te.state==="blocked"||re.state==="blocked"&&te.state==="blocked"||re.state==="blocked"&&te.state==="proceeding"||re.state==="blocked"&&te.state==="unblocked"||re.state==="proceeding"&&te.state==="unblocked","Invalid blocker state transition: "+re.state+" -> "+te.state);let be=new Map(C.blockers);be.set(K,te),ue({blockers:be})}function gb(K){let{currentLocation:te,nextLocation:re,historyAction:be}=K;if(de.size===0)return;de.size>1&&lg(!1,"A router only supports one blocker at a time");let Me=Array.from(de.entries()),[at,mt]=Me[Me.length-1],Xe=C.blockers.get(at);if(!(Xe&&Xe.state==="proceeding")&&mt({currentLocation:te,nextLocation:re,historyAction:be}))return at}function a0(K){let te=hi(404,{pathname:K}),re=c||o,{matches:be,route:Me}=YP(re);return c0(),{notFoundMatches:be,route:Me,error:te}}function c0(K){let te=[];return Ne.forEach((re,be)=>{(!K||K(be))&&(re.cancel(),te.push(be),Ne.delete(be))}),te}function SN(K,te,re){if(m=K,y=te,g=re||null,!x&&C.navigation===sA){x=!0;let be=Tu(C.location,C.matches);be!=null&&ue({restoreScrollPosition:be})}return()=>{m=null,y=null,g=null}}function yb(K,te){return g&&g(K,te.map(be=>pK(be,C.loaderData)))||K.key}function TN(K,te){if(m&&y){let re=yb(K,te);m[re]=y()}}function Tu(K,te){if(m){let re=yb(K,te),be=m[re];if(typeof be=="number")return be}return null}function Ia(K,te,re){if(u)if(K){if(Object.keys(K[0].params).length>0)return{active:!0,matches:Hv(te,re,l,!0)}}else return{active:!0,matches:Hv(te,re,l,!0)||[]};return{active:!1,matches:null}}async function Hf(K,te,re,be){if(!u)return{type:"success",matches:K};let Me=K;for(;;){let at=c==null,mt=c||o,Xe=i;try{await u({signal:re,path:te,matches:Me,fetcherKey:be,patch:(it,Et)=>{re.aborted||HP(it,Et,mt,Xe,s)}})}catch(it){return{type:"error",error:it,partialMatches:Me}}finally{at&&!re.aborted&&(o=[...o])}if(re.aborted)return{type:"aborted"};let et=qu(mt,te,l);if(et)return{type:"success",matches:et};let He=Hv(mt,te,l,!0);if(!He||Me.length===He.length&&Me.every((it,Et)=>it.route.id===He[Et].route.id))return{type:"success",matches:null};Me=He}}function _N(K){i={},c=Y1(K,s,void 0,i)}function kN(K,te){let re=c==null;HP(K,te,c||o,i,s),re&&(o=[...o],ue({}))}return k={get basename(){return l},get future(){return h},get state(){return C},get routes(){return o},get window(){return e},initialize:Ue,subscribe:q,enableScrollRestoration:SN,navigate:tt,fetch:mn,revalidate:me,createHref:K=>t.history.createHref(K),encodeLocation:K=>t.history.encodeLocation(K),getFetcher:jc,deleteFetcher:Ll,dispose:ee,getBlocker:qr,deleteBlocker:Ff,patchRoutes:kN,_internalFetchControllers:O,_internalActiveDeferreds:Ne,_internalSetRoutes:_N},k}function $K(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function F2(t,e,n,r,s,i,o,c){let l,d;if(o){l=[];for(let h of e)if(l.push(h),h.route.id===o){d=h;break}}else l=e,d=e[e.length-1];let u=NC(s||".",CC(l,i),Fg(t.pathname,n)||t.pathname,c==="path");if(s==null&&(u.search=t.search,u.hash=t.hash),(s==null||s===""||s===".")&&d){let h=gI(u.search);if(d.route.index&&!h)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!d.route.index&&h){let f=new URLSearchParams(u.search),p=f.getAll("index");f.delete("index"),p.filter(g=>g).forEach(g=>f.append("index",g));let m=f.toString();u.search=m?"?"+m:""}}return r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:yl([n,u.pathname])),lf(u)}function BP(t,e,n,r){if(!r||!$K(r))return{path:n};if(r.formMethod&&!ZK(r.formMethod))return{path:n,error:hi(405,{method:r.formMethod})};let s=()=>({path:n,error:hi(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),c=oB(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!la(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((p,m)=>{let[g,y]=m;return""+p+g+"="+y+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:c,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!la(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:c,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}Ut(typeof FormData=="function","FormData is not available in this environment");let l,d;if(r.formData)l=H2(r.formData),d=r.formData;else if(r.body instanceof FormData)l=H2(r.body),d=r.body;else if(r.body instanceof URLSearchParams)l=r.body,d=WP(l);else if(r.body==null)l=new URLSearchParams,d=new FormData;else try{l=new URLSearchParams(r.body),d=WP(l)}catch{return s()}let u={formMethod:o,formAction:c,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:d,json:void 0,text:void 0};if(la(u.formMethod))return{path:n,submission:u};let h=xu(n);return e&&h.search&&gI(h.search)&&l.append("index",""),h.search="?"+l,{path:lf(h),submission:u}}function $P(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function FP(t,e,n,r,s,i,o,c,l,d,u,h,f,p,m,g){let y=g?Vi(g[1])?g[1].error:g[1].data:void 0,x=t.createURL(e.location),w=t.createURL(s),b=n;i&&e.errors?b=$P(n,Object.keys(e.errors)[0],!0):g&&Vi(g[1])&&(b=$P(n,g[0]));let v=g?g[1].statusCode:void 0,E=o&&v&&v>=400,k=b.filter((S,N)=>{let{route:I}=S;if(I.lazy)return!0;if(I.loader==null)return!1;if(i)return z2(I,e.loaderData,e.errors);if(FK(e.loaderData,e.matches[N],S)||l.some(H=>H===S.route.id))return!0;let F=e.matches[N],P=S;return zP(S,Hn({currentUrl:x,currentParams:F.params,nextUrl:w,nextParams:P.params},r,{actionResult:y,actionStatus:v,defaultShouldRevalidate:E?!1:c||x.pathname+x.search===w.pathname+w.search||x.search!==w.search||sB(F,P)}))}),C=[];return h.forEach((S,N)=>{if(i||!n.some(z=>z.route.id===S.routeId)||u.has(N))return;let I=qu(p,S.path,m);if(!I){C.push({key:N,routeId:S.routeId,path:S.path,matches:null,match:null,controller:null});return}let F=e.fetchers.get(N),P=Z0(I,S.path),H=!1;f.has(N)?H=!1:d.has(N)?(d.delete(N),H=!0):F&&F.state!=="idle"&&F.data===void 0?H=c:H=zP(P,Hn({currentUrl:x,currentParams:e.matches[e.matches.length-1].params,nextUrl:w,nextParams:n[n.length-1].params},r,{actionResult:y,actionStatus:v,defaultShouldRevalidate:E?!1:c})),H&&C.push({key:N,routeId:S.routeId,path:S.path,matches:I,match:P,controller:new AbortController})}),[k,C]}function z2(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function FK(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function sB(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function zP(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function HP(t,e,n,r,s){var i;let o;if(t){let d=r[t];Ut(d,"No route found to patch children into: routeId = "+t),d.children||(d.children=[]),o=d.children}else o=n;let c=e.filter(d=>!o.some(u=>iB(d,u))),l=Y1(c,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...l)}function iB(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>iB(n,i))}):!1}async function zK(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];Ut(s,"No route found in manifest");let i={};for(let o in r){let l=s[o]!==void 0&&o!=="hasErrorBoundary";lg(!l,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!l&&!hK.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,Hn({},e(s),{lazy:void 0}))}async function HK(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function VK(t,e,n,r,s,i,o,c,l,d){let u=i.map(p=>p.route.lazy?zK(p.route,l,c):void 0),h=i.map((p,m)=>{let g=u[m],y=s.some(w=>w.route.id===p.route.id);return Hn({},p,{shouldLoad:y,resolve:async w=>(w&&r.method==="GET"&&(p.route.lazy||p.route.loader)&&(y=!0),y?WK(e,r,p,g,w,d):Promise.resolve({type:wn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:d});try{await Promise.all(u)}catch{}return f}async function WK(t,e,n,r,s,i){let o,c,l=d=>{let u,h=new Promise((m,g)=>u=g);c=()=>u(),e.signal.addEventListener("abort",c);let f=m=>typeof d!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):d({request:e,params:n.params,context:i},...m!==void 0?[m]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(g=>f(g)):f())}}catch(m){return{type:"error",result:m}}})();return Promise.race([p,h])};try{let d=n.route[t];if(r)if(d){let u,[h]=await Promise.all([l(d).catch(f=>{u=f}),r]);if(u!==void 0)throw u;o=h}else if(await r,d=n.route[t],d)o=await l(d);else if(t==="action"){let u=new URL(e.url),h=u.pathname+u.search;throw hi(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:wn.data,result:void 0};else if(d)o=await l(d);else{let u=new URL(e.url),h=u.pathname+u.search;throw hi(404,{pathname:h})}Ut(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(d){return{type:wn.error,result:d}}finally{c&&e.signal.removeEventListener("abort",c)}return o}async function qK(t){let{result:e,type:n}=t;if(aB(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:wn.error,error:f}}return n===wn.error?{type:wn.error,error:new Q1(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:wn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===wn.error){if(QP(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:wn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:wn.error,error:new Q1(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:cw(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:wn.error,error:e,statusCode:cw(e)?e.status:void 0}}if(JK(e)){var c,l;return{type:wn.deferred,deferredData:e,statusCode:(c=e.init)==null?void 0:c.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(QP(e)){var d,u;return{type:wn.data,data:e.data,statusCode:(d=e.init)==null?void 0:d.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:wn.data,data:e}}function KK(t,e,n,r,s,i){let o=t.headers.get("Location");if(Ut(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!pI.test(o)){let c=r.slice(0,r.findIndex(l=>l.route.id===n)+1);o=F2(new URL(e.url),c,s,!0,o,i),t.headers.set("Location",o)}return t}function VP(t,e,n){if(pI.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=Fg(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Wf(t,e,n,r){let s=t.createURL(oB(e)).toString(),i={signal:n};if(r&&la(r.formMethod)){let{formMethod:o,formEncType:c}=r;i.method=o.toUpperCase(),c==="application/json"?(i.headers=new Headers({"Content-Type":c}),i.body=JSON.stringify(r.json)):c==="text/plain"?i.body=r.text:c==="application/x-www-form-urlencoded"&&r.formData?i.body=H2(r.formData):i.body=r.formData}return new Request(s,i)}function H2(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function WP(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function GK(t,e,n,r,s){let i={},o=null,c,l=!1,d={},u=n&&Vi(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,p=e[f];if(Ut(!lh(p),"Cannot handle redirect results in processLoaderData"),Vi(p)){let m=p.error;u!==void 0&&(m=u,u=void 0),o=o||{};{let g=Ku(t,f);o[g.route.id]==null&&(o[g.route.id]=m)}i[f]=void 0,l||(l=!0,c=cw(p.error)?p.error.status:500),p.headers&&(d[f]=p.headers)}else Fd(p)?(r.set(f,p.deferredData),i[f]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(c=p.statusCode),p.headers&&(d[f]=p.headers)):(i[f]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(c=p.statusCode),p.headers&&(d[f]=p.headers))}),u!==void 0&&n&&(o={[n[0]]:u},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:c||200,loaderHeaders:d}}function qP(t,e,n,r,s,i,o){let{loaderData:c,errors:l}=GK(e,n,r,o);return s.forEach(d=>{let{key:u,match:h,controller:f}=d,p=i[u];if(Ut(p,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(Vi(p)){let m=Ku(t.matches,h==null?void 0:h.route.id);l&&l[m.route.id]||(l=Hn({},l,{[m.route.id]:p.error})),t.fetchers.delete(u)}else if(lh(p))Ut(!1,"Unhandled fetcher revalidation redirect");else if(Fd(p))Ut(!1,"Unhandled fetcher deferred data");else{let m=sd(p.data);t.fetchers.set(u,m)}}),{loaderData:c,errors:l}}function KP(t,e,n,r){let s=Hn({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function GP(t){return t?Vi(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Ku(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function YP(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function hi(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,c="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(c="Bad Request",s&&n&&r?l="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?l="defer() is not supported in actions":i==="invalid-body"&&(l="Unable to encode submission body")):t===403?(c="Forbidden",l='Route "'+r+'" does not match URL "'+n+'"'):t===404?(c="Not Found",l='No route matches URL "'+n+'"'):t===405&&(c="Method Not Allowed",s&&n&&r?l="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Q1(t||500,c,new Error(l),!0)}function Ub(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(lh(s))return{key:r,result:s}}}function oB(t){let e=typeof t=="string"?xu(t):t;return lf(Hn({},e,{hash:""}))}function YK(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function QK(t){return aB(t.result)&&DK.has(t.result.status)}function Fd(t){return t.type===wn.deferred}function Vi(t){return t.type===wn.error}function lh(t){return(t&&t.type)===wn.redirect}function QP(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function JK(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function aB(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function ZK(t){return OK.has(t.toLowerCase())}function la(t){return RK.has(t.toLowerCase())}async function XK(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[c,l]=i[o],d=t.find(f=>(f==null?void 0:f.route.id)===c);if(!d)continue;let u=r.find(f=>f.route.id===d.route.id),h=u!=null&&!sB(u,d)&&(s&&s[d.route.id])!==void 0;Fd(l)&&h&&await mI(l,n,!1).then(f=>{f&&(e[c]=f)})}}async function eG(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],c=e[s];t.find(d=>(d==null?void 0:d.route.id)===i)&&Fd(c)&&(Ut(o,"Expected an AbortController for revalidating fetcher deferred result"),await mI(c,o.signal,!0).then(d=>{d&&(e[s]=d)}))}}async function mI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:wn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:wn.error,error:s}}return{type:wn.data,data:t.deferredData.data}}}function gI(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Z0(t,e){let n=typeof e=="string"?xu(e).search:e.search;if(t[t.length-1].route.index&&gI(n||""))return t[t.length-1];let r=tB(t);return r[r.length-1]}function JP(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function iA(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function tG(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function b0(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function nG(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function sd(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function rG(t,e){try{let n=t.sessionStorage.getItem(rB);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function sG(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(rB,JSON.stringify(n))}catch(r){lg(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function J1(){return J1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},J1.apply(this,arguments)}const AC=A.createContext(null),cB=A.createContext(null),bu=A.createContext(null),yI=A.createContext(null),Ic=A.createContext({outlet:null,matches:[],isDataRoute:!1}),lB=A.createContext(null);function iG(t,e){let{relative:n}=e===void 0?{}:e;zg()||Ut(!1);let{basename:r,navigator:s}=A.useContext(bu),{hash:i,pathname:o,search:c}=uB(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:yl([r,o])),s.createHref({pathname:l,search:c,hash:i})}function zg(){return A.useContext(yI)!=null}function vu(){return zg()||Ut(!1),A.useContext(yI).location}function dB(t){A.useContext(bu).static||A.useLayoutEffect(t)}function ds(){let{isDataRoute:t}=A.useContext(Ic);return t?xG():oG()}function oG(){zg()||Ut(!1);let t=A.useContext(AC),{basename:e,future:n,navigator:r}=A.useContext(bu),{matches:s}=A.useContext(Ic),{pathname:i}=vu(),o=JSON.stringify(CC(s,n.v7_relativeSplatPath)),c=A.useRef(!1);return dB(()=>{c.current=!0}),A.useCallback(function(d,u){if(u===void 0&&(u={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let h=NC(d,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:yl([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,t])}const aG=A.createContext(null);function cG(t){let e=A.useContext(Ic).outlet;return e&&A.createElement(aG.Provider,{value:t},e)}function SC(){let{matches:t}=A.useContext(Ic),e=t[t.length-1];return e?e.params:{}}function uB(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=A.useContext(bu),{matches:s}=A.useContext(Ic),{pathname:i}=vu(),o=JSON.stringify(CC(s,r.v7_relativeSplatPath));return A.useMemo(()=>NC(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function lG(t,e,n,r){zg()||Ut(!1);let{navigator:s}=A.useContext(bu),{matches:i}=A.useContext(Ic),o=i[i.length-1],c=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let d=vu(),u;u=d;let h=u.pathname||"/",f=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=qu(t,{pathname:f});return pG(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},c,g.params),pathname:yl([l,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:yl([l,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,r)}function dG(){let t=wG(),e=cw(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:s},n):null,null)}const uG=A.createElement(dG,null);class hG extends A.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?A.createElement(Ic.Provider,{value:this.props.routeContext},A.createElement(lB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fG(t){let{routeContext:e,match:n,children:r}=t,s=A.useContext(AC);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),A.createElement(Ic.Provider,{value:e},r)}function pG(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(s=n)==null?void 0:s.errors;if(c!=null){let u=o.findIndex(h=>h.route.id&&(c==null?void 0:c[h.route.id])!==void 0);u>=0||Ut(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:p}=n,m=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||m){l=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let p,m=!1,g=null,y=null;n&&(p=c&&h.route.id?c[h.route.id]:void 0,g=h.route.errorElement||uG,l&&(d<0&&f===0?(bG("route-fallback"),m=!0,y=null):d===f&&(m=!0,y=h.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,f+1)),w=()=>{let b;return p?b=g:m?b=y:h.route.Component?b=A.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,A.createElement(fG,{match:h,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?A.createElement(hG,{location:n.location,revalidation:n.revalidation,component:g,error:p,children:w(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):w()},null)}var hB=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(hB||{}),fB=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(fB||{});function mG(t){let e=A.useContext(AC);return e||Ut(!1),e}function gG(t){let e=A.useContext(cB);return e||Ut(!1),e}function yG(t){let e=A.useContext(Ic);return e||Ut(!1),e}function pB(t){let e=yG(),n=e.matches[e.matches.length-1];return n.route.id||Ut(!1),n.route.id}function wG(){var t;let e=A.useContext(lB),n=gG(fB.UseRouteError),r=pB();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function xG(){let{router:t}=mG(hB.UseNavigateStable),e=pB(),n=A.useRef(!1);return dB(()=>{n.current=!0}),A.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,J1({fromRouteId:e},i)))},[t,e])}const ZP={};function bG(t,e,n){ZP[t]||(ZP[t]=!0)}function vG(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function EG(t){let{to:e,replace:n,state:r,relative:s}=t;zg()||Ut(!1);let{future:i,static:o}=A.useContext(bu),{matches:c}=A.useContext(Ic),{pathname:l}=vu(),d=ds(),u=NC(e,CC(c,i.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return A.useEffect(()=>d(JSON.parse(h),{replace:n,state:r,relative:s}),[d,h,s,n,r]),null}function wI(t){return cG(t.context)}function CG(t){let{basename:e="/",children:n=null,location:r,navigationType:s=gr.Pop,navigator:i,static:o=!1,future:c}=t;zg()&&Ut(!1);let l=e.replace(/^\/*/,"/"),d=A.useMemo(()=>({basename:l,navigator:i,static:o,future:J1({v7_relativeSplatPath:!1},c)}),[l,c,i,o]);typeof r=="string"&&(r=xu(r));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:m="default"}=r,g=A.useMemo(()=>{let y=Fg(u,l);return y==null?null:{location:{pathname:y,search:h,hash:f,state:p,key:m},navigationType:s}},[l,u,h,f,p,m,s]);return g==null?null:A.createElement(bu.Provider,{value:d},A.createElement(yI.Provider,{children:n,value:g}))}new Promise(()=>{});function NG(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:A.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:A.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:A.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lw(){return lw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lw.apply(this,arguments)}function AG(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function SG(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function TG(t,e){return t.button===0&&(!e||e==="_self")&&!SG(t)}const _G=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kG="6";try{window.__reactRouterVersion=kG}catch{}function IG(t,e){return BK({basename:void 0,future:lw({},void 0,{v7_prependBasename:!0}),history:lK({window:void 0}),hydrationData:jG(),routes:t,mapRouteProperties:NG,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function jG(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=lw({},e,{errors:RG(e.errors)})),e}function RG(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new Q1(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const PG=A.createContext({isTransitioning:!1}),OG=A.createContext(new Map),DG="startTransition",XP=QV[DG],UG="flushSync",e3=cK[UG];function MG(t){XP?XP(t):t()}function v0(t){e3?e3(t):t()}class LG{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function BG(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=A.useState(n.state),[o,c]=A.useState(),[l,d]=A.useState({isTransitioning:!1}),[u,h]=A.useState(),[f,p]=A.useState(),[m,g]=A.useState(),y=A.useRef(new Map),{v7_startTransition:x}=r||{},w=A.useCallback(S=>{x?MG(S):S()},[x]),b=A.useCallback((S,N)=>{let{deletedFetchers:I,flushSync:F,viewTransitionOpts:P}=N;S.fetchers.forEach((z,T)=>{z.data!==void 0&&y.current.set(T,z.data)}),I.forEach(z=>y.current.delete(z));let H=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!P||H){F?v0(()=>i(S)):w(()=>i(S));return}if(F){v0(()=>{f&&(u&&u.resolve(),f.skipTransition()),d({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let z=n.window.document.startViewTransition(()=>{v0(()=>i(S))});z.finished.finally(()=>{v0(()=>{h(void 0),p(void 0),c(void 0),d({isTransitioning:!1})})}),v0(()=>p(z));return}f?(u&&u.resolve(),f.skipTransition(),g({state:S,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(c(S),d({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[n.window,f,u,y,w]);A.useLayoutEffect(()=>n.subscribe(b),[n,b]),A.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new LG)},[l]),A.useEffect(()=>{if(u&&o&&n.window){let S=o,N=u.promise,I=n.window.document.startViewTransition(async()=>{w(()=>i(S)),await N});I.finished.finally(()=>{h(void 0),p(void 0),c(void 0),d({isTransitioning:!1})}),p(I)}},[w,o,u,n.window]),A.useEffect(()=>{u&&o&&s.location.key===o.location.key&&u.resolve()},[u,f,s.location,o]),A.useEffect(()=>{!l.isTransitioning&&m&&(c(m.state),d({isTransitioning:!0,flushSync:!1,currentLocation:m.currentLocation,nextLocation:m.nextLocation}),g(void 0))},[l.isTransitioning,m]),A.useEffect(()=>{},[]);let v=A.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:S=>n.navigate(S),push:(S,N,I)=>n.navigate(S,{state:N,preventScrollReset:I==null?void 0:I.preventScrollReset}),replace:(S,N,I)=>n.navigate(S,{replace:!0,state:N,preventScrollReset:I==null?void 0:I.preventScrollReset})}),[n]),E=n.basename||"/",k=A.useMemo(()=>({router:n,navigator:v,static:!1,basename:E}),[n,v,E]),C=A.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return A.useEffect(()=>vG(r,n.future),[r,n.future]),A.createElement(A.Fragment,null,A.createElement(AC.Provider,{value:k},A.createElement(cB.Provider,{value:s},A.createElement(OG.Provider,{value:y.current},A.createElement(PG.Provider,{value:l},A.createElement(CG,{basename:E,location:s.location,navigationType:s.historyAction,navigator:v,future:C},s.initialized||n.future.v7_partialHydration?A.createElement($G,{routes:n.routes,future:n.future,state:s}):e))))),null)}const $G=A.memo(FG);function FG(t){let{routes:e,future:n,state:r}=t;return lG(e,void 0,r,n)}const zG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",HG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zd=A.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:c,target:l,to:d,preventScrollReset:u,viewTransition:h}=e,f=AG(e,_G),{basename:p}=A.useContext(bu),m,g=!1;if(typeof d=="string"&&HG.test(d)&&(m=d,zG))try{let b=new URL(window.location.href),v=d.startsWith("//")?new URL(b.protocol+d):new URL(d),E=Fg(v.pathname,p);v.origin===b.origin&&E!=null?d=E+v.search+v.hash:g=!0}catch{}let y=iG(d,{relative:s}),x=VG(d,{replace:o,state:c,target:l,preventScrollReset:u,relative:s,viewTransition:h});function w(b){r&&r(b),b.defaultPrevented||x(b)}return A.createElement("a",lw({},f,{href:m||y,onClick:g||i?r:w,ref:n,target:l}))});var t3;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(t3||(t3={}));var n3;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(n3||(n3={}));function VG(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:c}=e===void 0?{}:e,l=ds(),d=vu(),u=uB(t,{relative:o});return A.useCallback(h=>{if(TG(h,n)){h.preventDefault();let f=r!==void 0?r:lf(d)===lf(u);l(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:c})}},[d,l,u,r,s,n,t,i,o,c])}let WG={data:""},qG=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||WG,KG=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,GG=/\/\*[^]*?\*\/|  +/g,r3=/\n+/g,yd=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?yd(o,i):i+"{"+yd(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=yd(o,e?e.replace(/([^,])+/g,c=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,c):c?c+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=yd.p?yd.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},Pc={},mB=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+mB(t[n]);return e}return t},YG=(t,e,n,r,s)=>{let i=mB(t),o=Pc[i]||(Pc[i]=(l=>{let d=0,u=11;for(;d<l.length;)u=101*u+l.charCodeAt(d++)>>>0;return"go"+u})(i));if(!Pc[o]){let l=i!==t?t:(d=>{let u,h,f=[{}];for(;u=KG.exec(d.replace(GG,""));)u[4]?f.shift():u[3]?(h=u[3].replace(r3," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][u[1]]=u[2].replace(r3," ").trim();return f[0]})(t);Pc[o]=yd(s?{["@keyframes "+o]:l}:l,n?"":"."+o)}let c=n&&Pc.g?Pc.g:null;return n&&(Pc.g=Pc[o]),((l,d,u,h)=>{h?d.data=d.data.replace(h,l):d.data.indexOf(l)===-1&&(d.data=u?l+d.data:d.data+l)})(Pc[o],e,r,c),o},QG=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let c=o(n),l=c&&c.props&&c.props.className||/^go/.test(c)&&c;o=l?"."+l:c&&typeof c=="object"?c.props?"":yd(c,""):c===!1?"":c}return r+s+(o??"")},"");function TC(t){let e=this||{},n=t.call?t(e.p):t;return YG(n.unshift?n.raw?QG(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,qG(e.target),e.g,e.o,e.k)}let gB,V2,W2;TC.bind({g:1});let Tl=TC.bind({k:1});function JG(t,e,n,r){yd.p=e,gB=t,V2=n,W2=r}function Eu(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let c=Object.assign({},i),l=c.className||s.className;n.p=Object.assign({theme:V2&&V2()},c),n.o=/ *go\d+/.test(l),c.className=TC.apply(n,r)+(l?" "+l:"");let d=t;return t[0]&&(d=c.as||t,delete c.as),W2&&d[0]&&W2(c),gB(d,c)}return s}}var ZG=t=>typeof t=="function",Z1=(t,e)=>ZG(t)?t(e):t,XG=(()=>{let t=0;return()=>(++t).toString()})(),yB=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),eY=20,xI="default",wB=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return wB(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Vv=[],xB={toasts:[],pausedAt:void 0,settings:{toastLimit:eY}},ac={},bB=(t,e=xI)=>{ac[e]=wB(ac[e]||xB,t),Vv.forEach(([n,r])=>{n===e&&r(ac[e])})},vB=t=>Object.keys(ac).forEach(e=>bB(t,e)),tY=t=>Object.keys(ac).find(e=>ac[e].toasts.some(n=>n.id===t)),_C=(t=xI)=>e=>{bB(e,t)},nY={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},rY=(t={},e=xI)=>{let[n,r]=A.useState(ac[e]||xB),s=A.useRef(ac[e]);A.useEffect(()=>(s.current!==ac[e]&&r(ac[e]),Vv.push([e,r]),()=>{let o=Vv.findIndex(([c])=>c===e);o>-1&&Vv.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var c,l,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((c=t[o.type])==null?void 0:c.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((l=t[o.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||nY[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},sY=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||XG()}),Hx=t=>(e,n)=>{let r=sY(e,t,n);return _C(r.toasterId||tY(r.id))({type:2,toast:r}),r.id},Ir=(t,e)=>Hx("blank")(t,e);Ir.error=Hx("error");Ir.success=Hx("success");Ir.loading=Hx("loading");Ir.custom=Hx("custom");Ir.dismiss=(t,e)=>{let n={type:3,toastId:t};e?_C(e)(n):vB(n)};Ir.dismissAll=t=>Ir.dismiss(void 0,t);Ir.remove=(t,e)=>{let n={type:4,toastId:t};e?_C(e)(n):vB(n)};Ir.removeAll=t=>Ir.remove(void 0,t);Ir.promise=(t,e,n)=>{let r=Ir.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Z1(e.success,s):void 0;return i?Ir.success(i,{id:r,...n,...n==null?void 0:n.success}):Ir.dismiss(r),s}).catch(s=>{let i=e.error?Z1(e.error,s):void 0;i?Ir.error(i,{id:r,...n,...n==null?void 0:n.error}):Ir.dismiss(r)}),t};var iY=1e3,oY=(t,e="default")=>{let{toasts:n,pausedAt:r}=rY(t,e),s=A.useRef(new Map).current,i=A.useCallback((h,f=iY)=>{if(s.has(h))return;let p=setTimeout(()=>{s.delete(h),o({type:4,toastId:h})},f);s.set(h,p)},[]);A.useEffect(()=>{if(r)return;let h=Date.now(),f=n.map(p=>{if(p.duration===1/0)return;let m=(p.duration||0)+p.pauseDuration-(h-p.createdAt);if(m<0){p.visible&&Ir.dismiss(p.id);return}return setTimeout(()=>Ir.dismiss(p.id,e),m)});return()=>{f.forEach(p=>p&&clearTimeout(p))}},[n,r,e]);let o=A.useCallback(_C(e),[e]),c=A.useCallback(()=>{o({type:5,time:Date.now()})},[o]),l=A.useCallback((h,f)=>{o({type:1,toast:{id:h,height:f}})},[o]),d=A.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=A.useCallback((h,f)=>{let{reverseOrder:p=!1,gutter:m=8,defaultPosition:g}=f||{},y=n.filter(b=>(b.position||g)===(h.position||g)&&b.height),x=y.findIndex(b=>b.id===h.id),w=y.filter((b,v)=>v<x&&b.visible).length;return y.filter(b=>b.visible).slice(...p?[w+1]:[0,w]).reduce((b,v)=>b+(v.height||0)+m,0)},[n]);return A.useEffect(()=>{n.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let f=s.get(h.id);f&&(clearTimeout(f),s.delete(h.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:l,startPause:c,endPause:d,calculateOffset:u}}},aY=Tl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,cY=Tl`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lY=Tl`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,dY=Eu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${aY} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${cY} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${lY} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,uY=Tl`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,hY=Eu("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${uY} 1s linear infinite;
`,fY=Tl`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,pY=Tl`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,mY=Eu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${fY} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${pY} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,gY=Eu("div")`
  position: absolute;
`,yY=Eu("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,wY=Tl`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,xY=Eu("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${wY} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,bY=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?A.createElement(xY,null,e):e:n==="blank"?null:A.createElement(yY,null,A.createElement(hY,{...r}),n!=="loading"&&A.createElement(gY,null,n==="error"?A.createElement(dY,{...r}):A.createElement(mY,{...r})))},vY=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,EY=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,CY="0%{opacity:0;} 100%{opacity:1;}",NY="0%{opacity:1;} 100%{opacity:0;}",AY=Eu("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,SY=Eu("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,TY=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=yB()?[CY,NY]:[vY(n),EY(n)];return{animation:e?`${Tl(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Tl(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},_Y=A.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?TY(t.position||e||"top-center",t.visible):{opacity:0},i=A.createElement(bY,{toast:t}),o=A.createElement(SY,{...t.ariaProps},Z1(t.message,t));return A.createElement(AY,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):A.createElement(A.Fragment,null,i,o))});JG(A.createElement);var kY=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=A.useCallback(o=>{if(o){let c=()=>{let l=o.getBoundingClientRect().height;r(t,l)};c(),new MutationObserver(c).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return A.createElement("div",{ref:i,className:e,style:n},s)},IY=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:yB()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},jY=TC`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Mb=16,RY=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:c})=>{let{toasts:l,handlers:d}=oY(n,i);return A.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Mb,left:Mb,right:Mb,bottom:Mb,pointerEvents:"none",...o},className:c,onMouseEnter:d.startPause,onMouseLeave:d.endPause},l.map(u=>{let h=u.position||e,f=d.calculateOffset(u,{reverseOrder:t,gutter:r,defaultPosition:e}),p=IY(h,f);return A.createElement(kY,{id:u.id,key:u.id,onHeightUpdate:d.updateHeight,className:u.visible?jY:"",style:p},u.type==="custom"?Z1(u.message,u):s?s(u):A.createElement(_Y,{toast:u,position:h}))}))},U=Ir;/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PY=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OY=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),s3=t=>{const e=OY(t);return e.charAt(0).toUpperCase()+e.slice(1)},EB=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),DY=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var UY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MY=A.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...c},l)=>A.createElement("svg",{ref:l,...UY,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:EB("lucide",s),...!i&&!DY(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,u])=>A.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=(t,e)=>{const n=A.forwardRef(({className:r,...s},i)=>A.createElement(MY,{ref:i,iconNode:e,className:EB(`lucide-${PY(s3(t))}`,`lucide-${t}`,r),...s}));return n.displayName=s3(t),n};/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LY=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],BY=ze("arrow-down-left",LY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Y=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],FY=ze("arrow-left-right",$Y);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zY=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],HY=ze("arrow-left",zY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VY=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Lb=ze("arrow-up-right",VY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WY=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],qY=ze("award",WY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KY=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],i3=ze("ban",KY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GY=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],YY=ze("building",GY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QY=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],JY=ze("calendar",QY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZY=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],XY=ze("camera",ZY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eQ=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],X1=ze("check",eQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],qt=ze("circle-alert",tQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nQ=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],kt=ze("circle-check-big",nQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],sQ=ze("circle-user",rQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],xr=ze("circle-x",iQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oQ=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pr=ze("clock",oQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aQ=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],CB=ze("copy",aQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cQ=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],dw=ze("credit-card",cQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lQ=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ko=ze("dollar-sign",lQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dQ=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],uQ=ze("external-link",dQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hQ=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],NB=ze("eye-off",hQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fQ=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],dg=ze("eye",fQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pQ=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ll=ze("file-text",pQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mQ=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],bI=ze("funnel",mQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gQ=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]],eE=ze("gavel",gQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],AB=ze("globe",yQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wQ=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],xQ=ze("house",wQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bQ=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],vQ=ze("layout-dashboard",bQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EQ=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],sr=ze("loader-circle",EQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CQ=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],o3=ze("lock-open",CQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NQ=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Wa=ze("lock",NQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AQ=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],SQ=ze("log-out",AQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TQ=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],_Q=ze("mail",TQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kQ=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],df=ze("map-pin",kQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IQ=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],jQ=ze("menu",IQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RQ=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.72a10 10 0 0 1 2.69 2.7",key:"jiglxs"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.28 17.61a10 10 0 0 1-2.7 2.69",key:"elg7ff"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"m6.163 21.117-2.906.85a1 1 0 0 1-1.236-1.169l.965-2.98",key:"1qsu07"}]],PQ=ze("message-circle-dashed",RQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OQ=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Zd=ze("message-square",OQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DQ=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],uw=ze("mic-off",DQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UQ=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],ug=ze("mic",UQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MQ=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],LQ=ze("monitor",MQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BQ=[["path",{d:"M13 2a9 9 0 0 1 9 9",key:"1itnx2"}],["path",{d:"M13 6a5 5 0 0 1 5 5",key:"11nki7"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],kC=ze("phone-call",BQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Q=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],Vx=ze("phone-off",$Q);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FQ=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],dn=ze("phone",FQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zQ=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],a3=ze("play",zQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HQ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wx=ze("plus",HQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VQ=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],oA=ze("qr-code",VQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WQ=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ji=ze("refresh-cw",WQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qQ=[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]],KQ=ze("scale",qQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GQ=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],c3=ze("save",GQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YQ=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ac=ze("search",YQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QQ=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],SB=ze("send",QQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JQ=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],q2=ze("settings",JQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZQ=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],K2=ze("shield-check",ZQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XQ=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]],l3=ze("shield-off",XQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eJ=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],uf=ze("shield",eJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tJ=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],G2=ze("shopping-cart",tJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nJ=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],TB=ze("smartphone",nJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rJ=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],IC=ze("square-pen",rJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sJ=[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]],iJ=ze("square-play",sJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oJ=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],aJ=ze("square",oJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cJ=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],xa=ze("star",cJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lJ=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],jC=ze("trash-2",lJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dJ=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],uJ=ze("trending-down",dJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hJ=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],_B=ze("trending-up",hJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fJ=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Xd=ze("triangle-alert",fJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pJ=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],d3=ze("upload",pJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mJ=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],hg=ze("user",mJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gJ=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],wl=ze("users",gJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yJ=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],fl=ze("video",yJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wJ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],kB=ze("volume-2",wJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xJ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],IB=ze("volume-x",xJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bJ=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],RC=ze("wallet",bJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vJ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],en=ze("x",vJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EJ=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],CJ=ze("zap",EJ),Sc=Object.create(null);Sc.open="0";Sc.close="1";Sc.ping="2";Sc.pong="3";Sc.message="4";Sc.upgrade="5";Sc.noop="6";const Wv=Object.create(null);Object.keys(Sc).forEach(t=>{Wv[Sc[t]]=t});const Y2={type:"error",data:"parser error"},jB=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",RB=typeof ArrayBuffer=="function",PB=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,vI=({type:t,data:e},n,r)=>jB&&e instanceof Blob?n?r(e):u3(e,r):RB&&(e instanceof ArrayBuffer||PB(e))?n?r(e):u3(new Blob([e]),r):r(Sc[t]+(e||"")),u3=(t,e)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];e("b"+(r||""))},n.readAsDataURL(t)};function h3(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let aA;function NJ(t,e){if(jB&&t.data instanceof Blob)return t.data.arrayBuffer().then(h3).then(e);if(RB&&(t.data instanceof ArrayBuffer||PB(t.data)))return e(h3(t.data));vI(t,!1,n=>{aA||(aA=new TextEncoder),e(aA.encode(n))})}const f3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X0=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<f3.length;t++)X0[f3.charCodeAt(t)]=t;const AJ=t=>{let e=t.length*.75,n=t.length,r,s=0,i,o,c,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const d=new ArrayBuffer(e),u=new Uint8Array(d);for(r=0;r<n;r+=4)i=X0[t.charCodeAt(r)],o=X0[t.charCodeAt(r+1)],c=X0[t.charCodeAt(r+2)],l=X0[t.charCodeAt(r+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|c>>2,u[s++]=(c&3)<<6|l&63;return d},SJ=typeof ArrayBuffer=="function",EI=(t,e)=>{if(typeof t!="string")return{type:"message",data:OB(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:TJ(t.substring(1),e)}:Wv[n]?t.length>1?{type:Wv[n],data:t.substring(1)}:{type:Wv[n]}:Y2},TJ=(t,e)=>{if(SJ){const n=AJ(t);return OB(n,e)}else return{base64:!0,data:t}},OB=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},DB="",_J=(t,e)=>{const n=t.length,r=new Array(n);let s=0;t.forEach((i,o)=>{vI(i,!1,c=>{r[o]=c,++s===n&&e(r.join(DB))})})},kJ=(t,e)=>{const n=t.split(DB),r=[];for(let s=0;s<n.length;s++){const i=EI(n[s],e);if(r.push(i),i.type==="error")break}return r};function IJ(){return new TransformStream({transform(t,e){NJ(t,n=>{const r=n.length;let s;if(r<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,r);else if(r<65536){s=new Uint8Array(3);const i=new DataView(s.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{s=new Uint8Array(9);const i=new DataView(s.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(s[0]|=128),e.enqueue(s),e.enqueue(n)})}})}let cA;function Bb(t){return t.reduce((e,n)=>e+n.length,0)}function $b(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let r=0;for(let s=0;s<e;s++)n[s]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function jJ(t,e){cA||(cA=new TextDecoder);const n=[];let r=0,s=-1,i=!1;return new TransformStream({transform(o,c){for(n.push(o);;){if(r===0){if(Bb(n)<1)break;const l=$b(n,1);i=(l[0]&128)===128,s=l[0]&127,s<126?r=3:s===126?r=1:r=2}else if(r===1){if(Bb(n)<2)break;const l=$b(n,2);s=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),r=3}else if(r===2){if(Bb(n)<8)break;const l=$b(n,8),d=new DataView(l.buffer,l.byteOffset,l.length),u=d.getUint32(0);if(u>Math.pow(2,21)-1){c.enqueue(Y2);break}s=u*Math.pow(2,32)+d.getUint32(4),r=3}else{if(Bb(n)<s)break;const l=$b(n,s);c.enqueue(EI(i?l:cA.decode(l),e)),r=0}if(s===0||s>t){c.enqueue(Y2);break}}}})}const UB=4;function Er(t){if(t)return RJ(t)}function RJ(t){for(var e in Er.prototype)t[e]=Er.prototype[e];return t}Er.prototype.on=Er.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Er.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};Er.prototype.off=Er.prototype.removeListener=Er.prototype.removeAllListeners=Er.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,s=0;s<n.length;s++)if(r=n[s],r===e||r.fn===e){n.splice(s,1);break}return n.length===0&&delete this._callbacks["$"+t],this};Er.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,s=n.length;r<s;++r)n[r].apply(this,e)}return this};Er.prototype.emitReserved=Er.prototype.emit;Er.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Er.prototype.hasListeners=function(t){return!!this.listeners(t).length};const PC=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),_o=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),PJ="arraybuffer";function MB(t,...e){return e.reduce((n,r)=>(t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}const OJ=_o.setTimeout,DJ=_o.clearTimeout;function OC(t,e){e.useNativeTimers?(t.setTimeoutFn=OJ.bind(_o),t.clearTimeoutFn=DJ.bind(_o)):(t.setTimeoutFn=_o.setTimeout.bind(_o),t.clearTimeoutFn=_o.clearTimeout.bind(_o))}const UJ=1.33;function MJ(t){return typeof t=="string"?LJ(t):Math.ceil((t.byteLength||t.size)*UJ)}function LJ(t){let e=0,n=0;for(let r=0,s=t.length;r<s;r++)e=t.charCodeAt(r),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}function LB(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function BJ(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function $J(t){let e={},n=t.split("&");for(let r=0,s=n.length;r<s;r++){let i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class FJ extends Error{constructor(e,n,r){super(e),this.description=n,this.context=r,this.type="TransportError"}}class CI extends Er{constructor(e){super(),this.writable=!1,OC(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,r){return super.emitReserved("error",new FJ(e,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=EI(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=BJ(e);return n.length?"?"+n:""}}class zJ extends CI{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};kJ(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,_J(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=LB()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let BB=!1;try{BB=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const HJ=BB;function VJ(){}class WJ extends zJ{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,n){const r=this.request({method:"POST",data:e});r.on("success",n),r.on("error",(s,i)=>{this.onError("xhr post error",s,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=e}}let sm=class qv extends Er{constructor(e,n,r){super(),this.createRequest=e,OC(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const n=MB(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&r.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var s;r.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=qv.requestsCount++,qv.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=VJ,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete qv.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};sm.requestsCount=0;sm.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",p3);else if(typeof addEventListener=="function"){const t="onpagehide"in _o?"pagehide":"unload";addEventListener(t,p3,!1)}}function p3(){for(let t in sm.requests)sm.requests.hasOwnProperty(t)&&sm.requests[t].abort()}const qJ=function(){const t=$B({xdomain:!1});return t&&t.responseType!==null}();class KJ extends WJ{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=qJ&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new sm($B,this.uri(),e)}}function $B(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||HJ))return new XMLHttpRequest}catch{}if(!e)try{return new _o[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const FB=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class GJ extends CI{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,r=FB?{}:MB(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,r)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],s=n===e.length-1;vI(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}s&&PC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=LB()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const lA=_o.WebSocket||_o.MozWebSocket;class YJ extends GJ{createSocket(e,n,r){return FB?new lA(e,n,r):n?new lA(e,n):new lA(e)}doWrite(e,n){this.ws.send(n)}}class QJ extends CI{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=jJ(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(n).getReader(),s=IJ();s.readable.pipeTo(e.writable),this._writer=s.writable.getWriter();const i=()=>{r.read().then(({done:c,value:l})=>{c||(this.onPacket(l),i())}).catch(c=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],s=n===e.length-1;this._writer.write(r).then(()=>{s&&PC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const JJ={websocket:YJ,webtransport:QJ,polling:KJ},ZJ=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,XJ=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Q2(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),r=t.indexOf("]");n!=-1&&r!=-1&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));let s=ZJ.exec(t||""),i={},o=14;for(;o--;)i[XJ[o]]=s[o]||"";return n!=-1&&r!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=eZ(i,i.path),i.queryKey=tZ(i,i.query),i}function eZ(t,e){const n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function tZ(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,s,i){s&&(n[s]=i)}),n}const J2=typeof addEventListener=="function"&&typeof removeEventListener=="function",Kv=[];J2&&addEventListener("offline",()=>{Kv.forEach(t=>t())},!1);class eu extends Er{constructor(e,n){if(super(),this.binaryType=PJ,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const r=Q2(e);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=Q2(n.host).host);OC(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const s=r.prototype.name;this.transports.push(s),this._transportsByName[s]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=$J(this.opts.query)),J2&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Kv.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=UB,n.transport=e,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&eu.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",eu.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const s=this.writeBuffer[r].data;if(s&&(n+=MJ(s)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,PC(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,r){return this._sendPacket("message",e,n,r),this}send(e,n,r){return this._sendPacket("message",e,n,r),this}_sendPacket(e,n,r,s){if(typeof n=="function"&&(s=n,n=void 0),typeof r=="function"&&(s=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:e,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(eu.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),J2&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Kv.indexOf(this._offlineEventListener);r!==-1&&Kv.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}eu.protocol=UB;class nZ extends eu{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),r=!1;eu.priorWebsocketSuccess=!1;const s=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;eu.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=n.name,this.emitReserved("upgradeError",f)}}))};function i(){r||(r=!0,u(),n.close(),n=null)}const o=h=>{const f=new Error("probe error: "+h);f.transport=n.name,i(),this.emitReserved("upgradeError",f)};function c(){o("transport closed")}function l(){o("socket closed")}function d(h){n&&h.name!==n.name&&i()}const u=()=>{n.removeListener("open",s),n.removeListener("error",o),n.removeListener("close",c),this.off("close",l),this.off("upgrading",d)};n.once("open",s),n.once("error",o),n.once("close",c),this.once("close",l),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&n.push(e[r]);return n}}let rZ=class extends nZ{constructor(e,n={}){const r=typeof e=="object"?e:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(s=>JJ[s]).filter(s=>!!s)),super(e,r)}};function sZ(t,e="",n){let r=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),r=Q2(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+e,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const iZ=typeof ArrayBuffer=="function",oZ=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,zB=Object.prototype.toString,aZ=typeof Blob=="function"||typeof Blob<"u"&&zB.call(Blob)==="[object BlobConstructor]",cZ=typeof File=="function"||typeof File<"u"&&zB.call(File)==="[object FileConstructor]";function NI(t){return iZ&&(t instanceof ArrayBuffer||oZ(t))||aZ&&t instanceof Blob||cZ&&t instanceof File}function Gv(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(Gv(t[n]))return!0;return!1}if(NI(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Gv(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Gv(t[n]))return!0;return!1}function lZ(t){const e=[],n=t.data,r=t;return r.data=Z2(n,e),r.attachments=e.length,{packet:r,buffers:e}}function Z2(t,e){if(!t)return t;if(NI(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=Z2(t[r],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=Z2(t[r],e));return n}return t}function dZ(t,e){return t.data=X2(t.data,e),delete t.attachments,t}function X2(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=X2(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=X2(t[n],e));return t}const uZ=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],hZ=5;var zt;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(zt||(zt={}));let fZ=class{constructor(e){this.replacer=e}encode(e){return(e.type===zt.EVENT||e.type===zt.ACK)&&Gv(e)?this.encodeAsBinary({type:e.type===zt.EVENT?zt.BINARY_EVENT:zt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===zt.BINARY_EVENT||e.type===zt.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=lZ(e),r=this.encodeAsString(n.packet),s=n.buffers;return s.unshift(r),s}};function m3(t){return Object.prototype.toString.call(t)==="[object Object]"}let pZ=class HB extends Er{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const r=n.type===zt.BINARY_EVENT;r||n.type===zt.BINARY_ACK?(n.type=r?zt.EVENT:zt.ACK,this.reconstructor=new mZ(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(NI(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const r={type:Number(e.charAt(0))};if(zt[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===zt.BINARY_EVENT||r.type===zt.BINARY_ACK){const i=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const o=e.substring(i,n);if(o!=Number(o)||e.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););r.nsp=e.substring(i,n)}else r.nsp="/";const s=e.charAt(n+1);if(s!==""&&Number(s)==s){const i=n+1;for(;++n;){const o=e.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===e.length)break}r.id=Number(e.substring(i,n+1))}if(e.charAt(++n)){const i=this.tryParse(e.substr(n));if(HB.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case zt.CONNECT:return m3(n);case zt.DISCONNECT:return n===void 0;case zt.CONNECT_ERROR:return typeof n=="string"||m3(n);case zt.EVENT:case zt.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&uZ.indexOf(n[0])===-1);case zt.ACK:case zt.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};class mZ{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=dZ(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const gZ=Object.freeze(Object.defineProperty({__proto__:null,Decoder:pZ,Encoder:fZ,get PacketType(){return zt},protocol:hZ},Symbol.toStringTag,{value:"Module"}));function da(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const yZ=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class VB extends Er{constructor(e,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[da(e,"open",this.onopen.bind(this)),da(e,"packet",this.onpacket.bind(this)),da(e,"error",this.onerror.bind(this)),da(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var r,s,i;if(yZ.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:zt.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const u=this.ids++,h=n.pop();this._registerAckCallback(u,h),o.id=u}const c=(s=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||s===void 0?void 0:s.writable,l=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!c||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,n){var r;const s=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(s===void 0){this.acks[e]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===e&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},s),o=(...c)=>{this.io.clearTimeoutFn(i),n.apply(this,c)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...n){return new Promise((r,s)=>{const i=(o,c)=>o?s(o):r(c);i.withError=!0,n.push(i),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((s,...i)=>r!==this._queue[0]?void 0:(s!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(s)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:zt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case zt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case zt.EVENT:case zt.BINARY_EVENT:this.onevent(e);break;case zt.ACK:case zt.BINARY_ACK:this.onack(e);break;case zt.DISCONNECT:this.ondisconnect();break;case zt.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let r=!1;return function(...s){r||(r=!0,n.packet({type:zt.ACK,id:e,data:s}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:zt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,e.data)}}}function Hg(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Hg.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+n:t-n}return Math.min(t,this.max)|0};Hg.prototype.reset=function(){this.attempts=0};Hg.prototype.setMin=function(t){this.ms=t};Hg.prototype.setMax=function(t){this.max=t};Hg.prototype.setJitter=function(t){this.jitter=t};class eT extends Er{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,OC(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Hg({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const s=n.parser||gZ;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new rZ(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const s=da(n,"open",function(){r.onopen(),e&&e()}),i=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),e?e(c):this.maybeReconnectOnOpen()},o=da(n,"error",i);if(this._timeout!==!1){const c=this._timeout,l=this.setTimeoutFn(()=>{s(),i(new Error("timeout")),n.close()},c);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(s),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(da(e,"ping",this.onping.bind(this)),da(e,"data",this.ondata.bind(this)),da(e,"error",this.onerror.bind(this)),da(e,"close",this.onclose.bind(this)),da(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){PC(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new VB(this,e,n),this.nsps[e]=r),r}_destroy(e){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let r=0;r<n.length;r++)this.engine.write(n[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(s=>{s?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",s)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const E0={};function Po(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=sZ(t,e.path||"/socket.io"),r=n.source,s=n.id,i=n.path,o=E0[s]&&i in E0[s].nsps,c=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return c?l=new eT(r,e):(E0[s]||(E0[s]=new eT(r,e)),l=E0[s]),n.query&&!e.query&&(e.query=n.queryKey),l.socket(n.path,e)}Object.assign(Po,{Manager:eT,Socket:VB,io:Po,connect:Po});const dA={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"/api",VITE_NODE_ENV:"development",VITE_USER_NODE_ENV:"production",VITE_WS_URL:""},WB=(t,e)=>{const n=dA==null?void 0:dA[t];if(n&&n.length>0)return n;if(e!==void 0)return e;throw new Error(`Missing required env var: ${t}`)};WB("VITE_API_BASE_URL","/api");const wZ=()=>{const t=WB("VITE_WS_URL","");if(t)return t;if(typeof window<"u"){const e=window.location.hostname,n=window.location.protocol==="https:"?"wss:":"ws:",r=e.includes("ngrok")||e.includes("ngrok-free.dev")||e.includes("ngrok.io");if(e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.")||e==="localhost"||e==="127.0.0.1"||/^\d+\.\d+\.\d+\.\d+$/.test(e))return`${window.location.protocol==="https:"?"wss:":"ws:"}//${e}:5000`;if(r)return`wss://${window.location.host}`;const s=window.location.host;return`${n}//${s}`}return window.location.protocol==="https:"?"wss://localhost:5000":"ws://localhost:5000"},Na=wZ(),xZ="modulepreload",bZ=function(t){return"/"+t},g3={},$n=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=bZ(l),l in g3)return;g3[l]=!0;const d=l.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":xZ,d||(h.as="script"),h.crossOrigin="",h.href=l,c&&h.setAttribute("nonce",c),document.head.appendChild(h),d)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},vZ={},y3=t=>{let e;const n=new Set,r=(u,h)=>{const f=typeof u=="function"?u(e):u;if(!Object.is(f,e)){const p=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(m=>m(e,p))}},s=()=>e,l={setState:r,getState:s,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(vZ?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=e=t(r,s,l);return l},EZ=t=>t?y3(t):y3;var qB={exports:{}},KB={},GB={exports:{}},YB={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fg=A;function CZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var NZ=typeof Object.is=="function"?Object.is:CZ,AZ=fg.useState,SZ=fg.useEffect,TZ=fg.useLayoutEffect,_Z=fg.useDebugValue;function kZ(t,e){var n=e(),r=AZ({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return TZ(function(){s.value=n,s.getSnapshot=e,uA(s)&&i({inst:s})},[t,n,e]),SZ(function(){return uA(s)&&i({inst:s}),t(function(){uA(s)&&i({inst:s})})},[t]),_Z(n),n}function uA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!NZ(t,n)}catch{return!0}}function IZ(t,e){return e()}var jZ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?IZ:kZ;YB.useSyncExternalStore=fg.useSyncExternalStore!==void 0?fg.useSyncExternalStore:jZ;GB.exports=YB;var RZ=GB.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DC=A,PZ=RZ;function OZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var DZ=typeof Object.is=="function"?Object.is:OZ,UZ=PZ.useSyncExternalStore,MZ=DC.useRef,LZ=DC.useEffect,BZ=DC.useMemo,$Z=DC.useDebugValue;KB.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=MZ(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=BZ(function(){function l(p){if(!d){if(d=!0,u=p,p=r(p),s!==void 0&&o.hasValue){var m=o.value;if(s(m,p))return h=m}return h=p}if(m=h,DZ(u,p))return m;var g=r(p);return s!==void 0&&s(m,g)?(u=p,m):(u=p,h=g)}var d=!1,u,h,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,s]);var c=UZ(t,i[0],i[1]);return LZ(function(){o.hasValue=!0,o.value=c},[c]),$Z(c),c};qB.exports=KB;var FZ=qB.exports;const zZ=Mg(FZ),QB={},{useDebugValue:HZ}=Lx,{useSyncExternalStoreWithSelector:VZ}=zZ;let w3=!1;const WZ=t=>t;function qZ(t,e=WZ,n){(QB?"production":void 0)!=="production"&&n&&!w3&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),w3=!0);const r=VZ(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return HZ(r),r}const x3=t=>{(QB?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?EZ(t):t,n=(r,s)=>qZ(e,r,s);return Object.assign(n,e),n},AI=t=>t?x3(t):x3,KZ="6.15.0";function GZ(t,e,n){const r=e.split("|").map(i=>i.trim());for(let i=0;i<r.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${n}`,s.value=t,s}async function $s(t){const e=Object.keys(t);return(await Promise.all(e.map(r=>Promise.resolve(t[r])))).reduce((r,s,i)=>(r[e[i]]=s,r),{})}function wt(t,e,n){for(let r in e){let s=e[r];const i=n?n[r]:null;i&&GZ(s,i,r),Object.defineProperty(t,r,{enumerable:!0,value:s,writable:!1})}}function Lp(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(n=>Lp(n,e)).join(", ")+" ]";if(t instanceof Uint8Array){const n="0123456789abcdef";let r="0x";for(let s=0;s<t.length;s++)r+=n[t[s]>>4],r+=n[t[s]&15];return r}if(typeof t=="object"&&typeof t.toJSON=="function")return Lp(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const n=Object.keys(t);return n.sort(),"{ "+n.map(r=>`${Lp(r,e)}: ${Lp(t[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function rs(t,e){return t&&t.code===e}function SI(t){return rs(t,"CALL_EXCEPTION")}function Bn(t,e,n){let r=t;{const i=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${Lp(n)}`);for(const o in n){if(o==="shortMessage")continue;const c=n[o];i.push(o+"="+Lp(c))}}i.push(`code=${e}`),i.push(`version=${KZ}`),i.length&&(t+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(t);break;default:s=new Error(t)}return wt(s,{code:e}),n&&Object.assign(s,n),s.shortMessage==null&&wt(s,{shortMessage:r}),s}function ge(t,e,n,r){if(!t)throw Bn(e,n,r)}function J(t,e,n,r){ge(t,e,"INVALID_ARGUMENT",{argument:n,value:r})}function JB(t,e,n){n==null&&(n=""),n&&(n=": "+n),ge(t>=e,"missing argument"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),ge(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");t.push(e)}catch{}return t},[]);function qx(t,e,n){if(n==null&&(n=""),t!==e){let r=n,s="new";n&&(r+=".",s+=" "+n),ge(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function ZB(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if(typeof t=="string"&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((t.length-2)/2);let s=2;for(let i=0;i<r.length;i++)r[i]=parseInt(t.substring(s,s+2),16),s+=2;return r}J(!1,"invalid BytesLike value",e||"value",t)}function jt(t,e){return ZB(t,e,!1)}function Fs(t,e){return ZB(t,e,!0)}function Sn(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function TI(t){return Sn(t,!0)||t instanceof Uint8Array}const b3="0123456789abcdef";function $e(t){const e=jt(t);let n="0x";for(let r=0;r<e.length;r++){const s=e[r];n+=b3[(s&240)>>4]+b3[s&15]}return n}function ir(t){return"0x"+t.map(e=>$e(e).substring(2)).join("")}function im(t){return Sn(t,!0)?(t.length-2)/2:jt(t).length}function Xn(t,e,n){const r=jt(t);return n!=null&&n>r.length&&ge(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),$e(r.slice(e??0,n??r.length))}function XB(t,e,n){const r=jt(t);ge(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),n?s.set(r,e-r.length):s.set(r,0),$e(s)}function _l(t,e){return XB(t,e,!0)}function YZ(t,e){return XB(t,e,!1)}const UC=BigInt(0),pa=BigInt(1),Bp=9007199254740991;function tE(t,e){const n=MC(t,"value"),r=BigInt(St(e,"width"));if(ge(n>>r===UC,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>r-pa){const s=(pa<<r)-pa;return-((~n&s)+pa)}return n}function e$(t,e){let n=Je(t,"value");const r=BigInt(St(e,"width")),s=pa<<r-pa;if(n<UC){n=-n,ge(n<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});const i=(pa<<r)-pa;return(~n&i)+pa}else ge(n<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return n}function dh(t,e){const n=MC(t,"value"),r=BigInt(St(e,"bits"));return n&(pa<<r)-pa}function Je(t,e){switch(typeof t){case"bigint":return t;case"number":return J(Number.isInteger(t),"underflow",e||"value",t),J(t>=-Bp&&t<=Bp,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(n){J(!1,`invalid BigNumberish string: ${n.message}`,e||"value",t)}}J(!1,"invalid BigNumberish value",e||"value",t)}function MC(t,e){const n=Je(t,e);return ge(n>=UC,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const v3="0123456789abcdef";function LC(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=v3[n>>4],e+=v3[n&15];return BigInt(e)}return Je(t)}function St(t,e){switch(typeof t){case"bigint":return J(t>=-Bp&&t<=Bp,"overflow",e||"value",t),Number(t);case"number":return J(Number.isInteger(t),"underflow",e||"value",t),J(t>=-Bp&&t<=Bp,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return St(BigInt(t),e)}catch(n){J(!1,`invalid numeric string: ${n.message}`,e||"value",t)}}J(!1,"invalid numeric value",e||"value",t)}function QZ(t){return St(LC(t))}function ou(t,e){let r=MC(t,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const s=St(e,"width");for(ge(s*2>=r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});r.length<s*2;)r="0"+r}return"0x"+r}function Or(t){const e=MC(t,"value");if(e===UC)return new Uint8Array([]);let n=e.toString(16);n.length%2&&(n="0"+n);const r=new Uint8Array(n.length/2);for(let s=0;s<r.length;s++){const i=s*2;r[s]=parseInt(n.substring(i,i+2),16)}return r}function ha(t){let e=$e(TI(t)?t:Or(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const E3="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const C3=BigInt(58);function JZ(t){const e=jt(t);let n=LC(e),r="";for(;n;)r=E3[Number(n%C3)]+r,n/=C3;for(let s=0;s<e.length&&!e[s];s++)r=E3[0]+r;return r}function ZZ(t){t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return jt(e)}function XZ(t){const e=jt(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}var mm;class t${constructor(e,n,r){G(this,"filter");G(this,"emitter");se(this,mm);V(this,mm,n),wt(this,{emitter:e,filter:r})}async removeListener(){R(this,mm)!=null&&await this.emitter.off(this.filter,R(this,mm))}}mm=new WeakMap;function eX(t,e,n,r,s){J(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)}function n$(t,e,n,r,s){if(t==="BAD_PREFIX"||t==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<n.length&&n[o]>>6===2;o++)i++;return i}return t==="OVERRUN"?n.length-e-1:0}function tX(t,e,n,r,s){return t==="OVERLONG"?(J(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),r.push(s),0):(r.push(65533),n$(t,e,n))}const nX=Object.freeze({error:eX,ignore:n$,replace:tX});function rX(t,e){e==null&&(e=nX.error);const n=jt(t,"bytes"),r=[];let s=0;for(;s<n.length;){const i=n[s++];if(!(i>>7)){r.push(i);continue}let o=null,c=null;if((i&224)===192)o=1,c=127;else if((i&240)===224)o=2,c=2047;else if((i&248)===240)o=3,c=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,n,r):s+=e("BAD_PREFIX",s-1,n,r);continue}if(s-1+o>=n.length){s+=e("OVERRUN",s-1,n,r);continue}let l=i&(1<<8-o-1)-1;for(let d=0;d<o;d++){let u=n[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,n,r),l=null;break}l=l<<6|u&63,s++}if(l!==null){if(l>1114111){s+=e("OUT_OF_RANGE",s-1-o,n,r,l);continue}if(l>=55296&&l<=57343){s+=e("UTF16_SURROGATE",s-1-o,n,r,l);continue}if(l<=c){s+=e("OVERLONG",s-1-o,n,r,l);continue}r.push(l)}}return r}function mc(t,e){J(typeof t=="string","invalid string value","str",t);let n=[];for(let r=0;r<t.length;r++){const s=t.charCodeAt(r);if(s<128)n.push(s);else if(s<2048)n.push(s>>6|192),n.push(s&63|128);else if((s&64512)==55296){r++;const i=t.charCodeAt(r);J(r<t.length&&(i&64512)===56320,"invalid surrogate pair","str",t);const o=65536+((s&1023)<<10)+(i&1023);n.push(o>>18|240),n.push(o>>12&63|128),n.push(o>>6&63|128),n.push(o&63|128)}else n.push(s>>12|224),n.push(s>>6&63|128),n.push(s&63|128)}return new Uint8Array(n)}function sX(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function nE(t,e){return sX(rX(t,e))}function r$(t){async function e(n,r){ge(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const s=n.url.split(":")[0].toLowerCase();ge(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),ge(s==="https"||!n.credentials||n.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,c=setTimeout(()=>{i=Bn("request timeout","TIMEOUT"),o.abort()},n.timeout);r&&r.addListener(()=>{i=Bn("request cancelled","CANCELLED"),o.abort()});const l=Object.assign({},t,{method:n.method,headers:new Headers(Array.from(n)),body:n.body||void 0,signal:o.signal});let d;try{d=await fetch(n.url,l)}catch(p){throw clearTimeout(c),i||p}clearTimeout(c);const u={};d.headers.forEach((p,m)=>{u[m.toLowerCase()]=p});const h=await d.arrayBuffer(),f=h==null?null:new Uint8Array(h);return{statusCode:d.status,statusMessage:d.statusText,headers:u,body:f}}return e}const iX=12,oX=250;let N3=r$();const aX=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),cX=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let hA=!1;async function s$(t,e){try{const n=t.match(aX);if(!n)throw new Error("invalid data");return new tu(200,"OK",{"content-type":n[1]||"text/plain"},n[2]?ZZ(n[3]):dX(n[3]))}catch{return new tu(599,"BAD REQUEST (invalid data: URI)",{},null,new kl(t))}}function i$(t){async function e(n,r){try{const s=n.match(cX);if(!s)throw new Error("invalid link");return new kl(`${t}${s[2]}`)}catch{return new tu(599,"BAD REQUEST (invalid IPFS URI)",{},null,new kl(n))}}return e}const Fb={data:s$,ipfs:i$("https://gateway.ipfs.io/ipfs/")},o$=new WeakMap;var Ah,Ed;class lX{constructor(e){se(this,Ah);se(this,Ed);V(this,Ah,[]),V(this,Ed,!1),o$.set(e,()=>{if(!R(this,Ed)){V(this,Ed,!0);for(const n of R(this,Ah))setTimeout(()=>{n()},0);V(this,Ah,[])}})}addListener(e){ge(!R(this,Ed),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),R(this,Ah).push(e)}get cancelled(){return R(this,Ed)}checkSignal(){ge(!this.cancelled,"cancelled","CANCELLED",{})}}Ah=new WeakMap,Ed=new WeakMap;function zb(t){if(t==null)throw new Error("missing signal; should not happen");return t.checkSignal(),t}var gm,ym,na,Zc,wm,xm,Br,Li,Xc,Sh,Th,_h,qa,ra,Cd,kh,ey;const eC=class eC{constructor(e){se(this,kh);se(this,gm);se(this,ym);se(this,na);se(this,Zc);se(this,wm);se(this,xm);se(this,Br);se(this,Li);se(this,Xc);se(this,Sh);se(this,Th);se(this,_h);se(this,qa);se(this,ra);se(this,Cd);V(this,xm,String(e)),V(this,gm,!1),V(this,ym,!0),V(this,na,{}),V(this,Zc,""),V(this,wm,3e5),V(this,ra,{slotInterval:oX,maxAttempts:iX}),V(this,Cd,null)}get url(){return R(this,xm)}set url(e){V(this,xm,String(e))}get body(){return R(this,Br)==null?null:new Uint8Array(R(this,Br))}set body(e){if(e==null)V(this,Br,void 0),V(this,Li,void 0);else if(typeof e=="string")V(this,Br,mc(e)),V(this,Li,"text/plain");else if(e instanceof Uint8Array)V(this,Br,e),V(this,Li,"application/octet-stream");else if(typeof e=="object")V(this,Br,mc(JSON.stringify(e))),V(this,Li,"application/json");else throw new Error("invalid body")}hasBody(){return R(this,Br)!=null}get method(){return R(this,Zc)?R(this,Zc):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),V(this,Zc,String(e).toUpperCase())}get headers(){const e=Object.assign({},R(this,na));return R(this,Xc)&&(e.authorization=`Basic ${XZ(mc(R(this,Xc)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&R(this,Li)&&(e["content-type"]=R(this,Li)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,n){R(this,na)[String(e).toLowerCase()]=String(n)}clearHeaders(){V(this,na,{})}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return R(this,Xc)||null}setCredentials(e,n){J(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),V(this,Xc,`${e}:${n}`)}get allowGzip(){return R(this,ym)}set allowGzip(e){V(this,ym,!!e)}get allowInsecureAuthentication(){return!!R(this,gm)}set allowInsecureAuthentication(e){V(this,gm,!!e)}get timeout(){return R(this,wm)}set timeout(e){J(e>=0,"timeout must be non-zero","timeout",e),V(this,wm,e)}get preflightFunc(){return R(this,Sh)||null}set preflightFunc(e){V(this,Sh,e)}get processFunc(){return R(this,Th)||null}set processFunc(e){V(this,Th,e)}get retryFunc(){return R(this,_h)||null}set retryFunc(e){V(this,_h,e)}get getUrlFunc(){return R(this,Cd)||N3}set getUrlFunc(e){V(this,Cd,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${R(this,Br)?$e(R(this,Br)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(R(this,ra).slotInterval=e.slotInterval),e.maxAttempts!=null&&(R(this,ra).maxAttempts=e.maxAttempts)}send(){return ge(R(this,qa)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),V(this,qa,new lX(this)),Ce(this,kh,ey).call(this,0,A3()+this.timeout,0,this,new tu(0,"",{},null,this))}cancel(){ge(R(this,qa)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=o$.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const n=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();ge(this.method==="GET"&&(n!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new eC(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,V(s,na,Object.assign({},R(this,na))),R(this,Br)&&V(s,Br,new Uint8Array(R(this,Br))),V(s,Li,R(this,Li)),s}clone(){const e=new eC(this.url);return V(e,Zc,R(this,Zc)),R(this,Br)&&V(e,Br,R(this,Br)),V(e,Li,R(this,Li)),V(e,na,Object.assign({},R(this,na))),V(e,Xc,R(this,Xc)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),V(e,Sh,R(this,Sh)),V(e,Th,R(this,Th)),V(e,_h,R(this,_h)),V(e,ra,Object.assign({},R(this,ra))),V(e,Cd,R(this,Cd)),e}static lockConfig(){hA=!0}static getGateway(e){return Fb[e.toLowerCase()]||null}static registerGateway(e,n){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(hA)throw new Error("gateways locked");Fb[e]=n}static registerGetUrl(e){if(hA)throw new Error("gateways locked");N3=e}static createGetUrlFunc(e){return r$(e)}static createDataGateway(){return s$}static createIpfsGatewayFunc(e){return i$(e)}};gm=new WeakMap,ym=new WeakMap,na=new WeakMap,Zc=new WeakMap,wm=new WeakMap,xm=new WeakMap,Br=new WeakMap,Li=new WeakMap,Xc=new WeakMap,Sh=new WeakMap,Th=new WeakMap,_h=new WeakMap,qa=new WeakMap,ra=new WeakMap,Cd=new WeakMap,kh=new WeakSet,ey=async function(e,n,r,s,i){var u,h,f;if(e>=R(this,ra).maxAttempts)return i.makeServerError("exceeded maximum retry limit");ge(A3()<=n,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),r>0&&await uX(r);let o=this.clone();const c=(o.url.split(":")[0]||"").toLowerCase();if(c in Fb){const p=await Fb[c](o.url,zb(R(s,qa)));if(p instanceof tu){let m=p;if(this.processFunc){zb(R(s,qa));try{m=await this.processFunc(o,m)}catch(g){(g.throttle==null||typeof g.stall!="number")&&m.makeServerError("error in post-processing function",g).assertOk()}}return m}o=p}this.preflightFunc&&(o=await this.preflightFunc(o));const l=await this.getUrlFunc(o,zb(R(s,qa)));let d=new tu(l.statusCode,l.statusMessage,l.headers,l.body,s);if(d.statusCode===301||d.statusCode===302){try{const p=d.headers.location||"";return Ce(u=o.redirect(p),kh,ey).call(u,e+1,n,0,s,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,d,e))){const p=d.headers["retry-after"];let m=R(this,ra).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof p=="string"&&p.match(/^[1-9][0-9]*$/)&&(m=parseInt(p)),Ce(h=o.clone(),kh,ey).call(h,e+1,n,m,s,d)}if(this.processFunc){zb(R(s,qa));try{d=await this.processFunc(o,d)}catch(p){(p.throttle==null||typeof p.stall!="number")&&d.makeServerError("error in post-processing function",p).assertOk();let m=R(this,ra).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return p.stall>=0&&(m=p.stall),Ce(f=o.clone(),kh,ey).call(f,e+1,n,m,s,d)}}return d};let kl=eC;var Ax,Sx,Tx,Bi,bm,Ih;const vR=class vR{constructor(e,n,r,s,i){se(this,Ax);se(this,Sx);se(this,Tx);se(this,Bi);se(this,bm);se(this,Ih);V(this,Ax,e),V(this,Sx,n),V(this,Tx,Object.keys(r).reduce((o,c)=>(o[c.toLowerCase()]=String(r[c]),o),{})),V(this,Bi,s==null?null:new Uint8Array(s)),V(this,bm,i||null),V(this,Ih,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${R(this,Bi)?$e(R(this,Bi)):"null"}>`}get statusCode(){return R(this,Ax)}get statusMessage(){return R(this,Sx)}get headers(){return Object.assign({},R(this,Tx))}get body(){return R(this,Bi)==null?null:new Uint8Array(R(this,Bi))}get bodyText(){try{return R(this,Bi)==null?"":nE(R(this,Bi))}catch{ge(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{ge(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,n){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new vR(599,r,this.headers,this.body,R(this,bm)||void 0);return V(s,Ih,{message:e,error:n}),s}throwThrottleError(e,n){n==null?n=-1:J(Number.isInteger(n)&&n>=0,"invalid stall timeout","stall",n);const r=new Error(e||"throttling requests");throw wt(r,{stall:n,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return R(this,Bi)!=null}get request(){return R(this,bm)}ok(){return R(this,Ih).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:n}=R(this,Ih);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let s=null;try{R(this,Bi)&&(s=nE(R(this,Bi)))}catch{}ge(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:n,info:{requestUrl:r,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Ax=new WeakMap,Sx=new WeakMap,Tx=new WeakMap,Bi=new WeakMap,bm=new WeakMap,Ih=new WeakMap;let tu=vR;function A3(){return new Date().getTime()}function dX(t){return mc(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,n)=>String.fromCharCode(parseInt(n,16))))}function uX(t){return new Promise(e=>setTimeout(e,t))}const hX=BigInt(-1),Yo=BigInt(0),$p=BigInt(1),fX=BigInt(5),qf={};let om="0000";for(;om.length<80;)om+=om;function Iu(t){let e=om;for(;e.length<t;)e+=e;return BigInt("1"+e.substring(0,t))}function C0(t,e,n){const r=BigInt(e.width);if(e.signed){const s=$p<<r-$p;ge(n==null||t>=-s&&t<s,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t>Yo?t=tE(dh(t,r),r):t=-tE(dh(-t,r),r)}else{const s=$p<<r;ge(n==null||t>=0&&t<s,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t=(t%s+s)%s&s-$p}return t}function fA(t){typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,n=128,r=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const i=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);J(i,"invalid fixed format","format",t),e=i[1]!=="u",n=parseInt(i[2]),r=parseInt(i[3])}}else if(t){const i=t,o=(c,l,d)=>i[c]==null?d:(J(typeof i[c]===l,"invalid fixed format ("+c+" not "+l+")","format."+c,i[c]),i[c]);e=o("signed","boolean",e),n=o("width","number",n),r=o("decimals","number",r)}J(n%8===0,"invalid FixedNumber width (not byte aligned)","format.width",n),J(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const s=(e?"":"u")+"fixed"+String(n)+"x"+String(r);return{signed:e,width:n,decimals:r,name:s}}function pX(t,e){let n="";t<Yo&&(n="-",t*=hX);let r=t.toString();if(e===0)return n+r;for(;r.length<=e;)r=om+r;const s=r.length-e;for(r=r.substring(0,s)+"."+r.substring(s);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return n+r}var sa,En,Ms,pn,Fu,Fc,tT,nT,rT,sT;const pd=class pd{constructor(e,n,r){se(this,pn);G(this,"format");se(this,sa);se(this,En);se(this,Ms);G(this,"_value");qx(e,qf,"FixedNumber"),V(this,En,n),V(this,sa,r);const s=pX(n,r.decimals);wt(this,{format:r.name,_value:s}),V(this,Ms,Iu(r.decimals))}get signed(){return R(this,sa).signed}get width(){return R(this,sa).width}get decimals(){return R(this,sa).decimals}get value(){return R(this,En)}addUnsafe(e){return Ce(this,pn,tT).call(this,e)}add(e){return Ce(this,pn,tT).call(this,e,"add")}subUnsafe(e){return Ce(this,pn,nT).call(this,e)}sub(e){return Ce(this,pn,nT).call(this,e,"sub")}mulUnsafe(e){return Ce(this,pn,rT).call(this,e)}mul(e){return Ce(this,pn,rT).call(this,e,"mul")}mulSignal(e){Ce(this,pn,Fu).call(this,e);const n=R(this,En)*R(e,En);return ge(n%R(this,Ms)===Yo,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),Ce(this,pn,Fc).call(this,n/R(this,Ms),"mulSignal")}divUnsafe(e){return Ce(this,pn,sT).call(this,e)}div(e){return Ce(this,pn,sT).call(this,e,"div")}divSignal(e){ge(R(e,En)!==Yo,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),Ce(this,pn,Fu).call(this,e);const n=R(this,En)*R(this,Ms);return ge(n%R(e,En)===Yo,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),Ce(this,pn,Fc).call(this,n/R(e,En),"divSignal")}cmp(e){let n=this.value,r=e.value;const s=this.decimals-e.decimals;return s>0?r*=Iu(s):s<0&&(n*=Iu(-s)),n<r?-1:n>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=R(this,En);return R(this,En)<Yo&&(e-=R(this,Ms)-$p),e=R(this,En)/R(this,Ms)*R(this,Ms),Ce(this,pn,Fc).call(this,e,"floor")}ceiling(){let e=R(this,En);return R(this,En)>Yo&&(e+=R(this,Ms)-$p),e=R(this,En)/R(this,Ms)*R(this,Ms),Ce(this,pn,Fc).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const n=this.decimals-e,r=fX*Iu(n-1);let s=this.value+r;const i=Iu(n);return s=s/i*i,C0(s,R(this,sa),"round"),new pd(qf,s,R(this,sa))}isZero(){return R(this,En)===Yo}isNegative(){return R(this,En)<Yo}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return pd.fromString(this.toString(),e)}static fromValue(e,n,r){const s=n==null?0:St(n),i=fA(r);let o=Je(e,"value");const c=s-i.decimals;if(c>0){const l=Iu(c);ge(o%l===Yo,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=l}else c<0&&(o*=Iu(-c));return C0(o,i,"fromValue"),new pd(qf,o,i)}static fromString(e,n){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);J(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const s=fA(n);let i=r[2]||"0",o=r[3]||"";for(;o.length<s.decimals;)o+=om;ge(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const c=BigInt(r[1]+i+o);return C0(c,s,"fromString"),new pd(qf,c,s)}static fromBytes(e,n){let r=LC(jt(e,"value"));const s=fA(n);return s.signed&&(r=tE(r,s.width)),C0(r,s,"fromBytes"),new pd(qf,r,s)}};sa=new WeakMap,En=new WeakMap,Ms=new WeakMap,pn=new WeakSet,Fu=function(e){J(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},Fc=function(e,n){return e=C0(e,R(this,sa),n),new pd(qf,e,R(this,sa))},tT=function(e,n){return Ce(this,pn,Fu).call(this,e),Ce(this,pn,Fc).call(this,R(this,En)+R(e,En),n)},nT=function(e,n){return Ce(this,pn,Fu).call(this,e),Ce(this,pn,Fc).call(this,R(this,En)-R(e,En),n)},rT=function(e,n){return Ce(this,pn,Fu).call(this,e),Ce(this,pn,Fc).call(this,R(this,En)*R(e,En)/R(this,Ms),n)},sT=function(e,n){return ge(R(e,En)!==Yo,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),Ce(this,pn,Fu).call(this,e),Ce(this,pn,Fc).call(this,R(this,En)*R(this,Ms)/R(e,En),n)};let rE=pd;function mX(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function S3(t,e,n){let r=0;for(let s=0;s<n;s++)r=r*256+t[e+s];return r}function T3(t,e,n,r){const s=[];for(;n<e+1+r;){const i=a$(t,n);s.push(i.result),n+=i.consumed,ge(n<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:t,length:r,offset:e})}return{consumed:1+r,result:s}}function a$(t,e){ge(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const n=r=>{ge(r<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:r})};if(t[e]>=248){const r=t[e]-247;n(e+1+r);const s=S3(t,e+1,r);return n(e+1+r+s),T3(t,e,e+1+r,r+s)}else if(t[e]>=192){const r=t[e]-192;return n(e+1+r),T3(t,e,e+1,r)}else if(t[e]>=184){const r=t[e]-183;n(e+1+r);const s=S3(t,e+1,r);n(e+1+r+s);const i=$e(t.slice(e+1+r,e+1+r+s));return{consumed:1+r+s,result:i}}else if(t[e]>=128){const r=t[e]-128;n(e+1+r);const s=$e(t.slice(e+1,e+1+r));return{consumed:1+r,result:s}}return{consumed:1,result:mX(t[e])}}function Kx(t){const e=jt(t,"data"),n=a$(e,0);return J(n.consumed===e.length,"unexpected junk after rlp payload","data",t),n.result}function _3(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function c$(t){if(Array.isArray(t)){let r=[];if(t.forEach(function(i){r=r.concat(c$(i))}),r.length<=55)return r.unshift(192+r.length),r;const s=_3(r.length);return s.unshift(247+s.length),s.concat(r)}const e=Array.prototype.slice.call(jt(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=_3(e.length);return n.unshift(183+n.length),n.concat(e)}const k3="0123456789abcdef";function au(t){let e="0x";for(const n of c$(t))e+=k3[n>>4],e+=k3[n&15];return e}const l$=["wei","kwei","mwei","gwei","szabo","finney","ether"];function fa(t,e){let n=18;if(typeof e=="string"){const r=l$.indexOf(e);J(r>=0,"invalid unit","unit",e),n=3*r}else e!=null&&(n=St(e,"unit"));return rE.fromValue(t,n,{decimals:n,width:512}).toString()}function am(t,e){J(typeof t=="string","value must be a string","value",t);let n=18;if(typeof e=="string"){const r=l$.indexOf(e);J(r>=0,"invalid unit","unit",e),n=3*r}else e!=null&&(n=St(e,"unit"));return rE.fromString(t,{decimals:n,width:512}).value}function gc(t){return fa(t,18)}const zs=32,iT=new Uint8Array(zs),gX=["then"],Hb={},d$=new WeakMap;function Gu(t){return d$.get(t)}function I3(t,e){d$.set(t,e)}function N0(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function oT(t,e,n){return t.indexOf(null)>=0?e.map((r,s)=>r instanceof pg?oT(Gu(r),r,n):r):t.reduce((r,s,i)=>{let o=e.getValue(s);return s in r||(n&&o instanceof pg&&(o=oT(Gu(o),o,n)),r[s]=o),r},{})}var vm;const Yp=class Yp extends Array{constructor(...n){const r=n[0];let s=n[1],i=(n[2]||[]).slice(),o=!0;r!==Hb&&(s=n,i=[],o=!1);super(s.length);se(this,vm);s.forEach((d,u)=>{this[u]=d});const c=i.reduce((d,u)=>(typeof u=="string"&&d.set(u,(d.get(u)||0)+1),d),new Map);if(I3(this,Object.freeze(s.map((d,u)=>{const h=i[u];return h!=null&&c.get(h)===1?h:null}))),V(this,vm,[]),R(this,vm)==null&&R(this,vm),!o)return;Object.freeze(this);const l=new Proxy(this,{get:(d,u,h)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const p=St(u,"%index");if(p<0||p>=this.length)throw new RangeError("out of result range");const m=d[p];return m instanceof Error&&N0(`index ${p}`,m),m}if(gX.indexOf(u)>=0)return Reflect.get(d,u,h);const f=d[u];if(f instanceof Function)return function(...p){return f.apply(this===h?d:this,p)};if(!(u in d))return d.getValue.apply(this===h?d:this,[u])}return Reflect.get(d,u,h)}});return I3(l,Gu(this)),l}toArray(n){const r=[];return this.forEach((s,i)=>{s instanceof Error&&N0(`index ${i}`,s),n&&s instanceof Yp&&(s=s.toArray(n)),r.push(s)}),r}toObject(n){const r=Gu(this);return r.reduce((s,i,o)=>(ge(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),oT(r,this,n)),{})}slice(n,r){n==null&&(n=0),n<0&&(n+=this.length,n<0&&(n=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const s=Gu(this),i=[],o=[];for(let c=n;c<r;c++)i.push(this[c]),o.push(s[c]);return new Yp(Hb,i,o)}filter(n,r){const s=Gu(this),i=[],o=[];for(let c=0;c<this.length;c++){const l=this[c];l instanceof Error&&N0(`index ${c}`,l),n.call(r,l,c,this)&&(i.push(l),o.push(s[c]))}return new Yp(Hb,i,o)}map(n,r){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&N0(`index ${i}`,o),s.push(n.call(r,o,i,this))}return s}getValue(n){const r=Gu(this).indexOf(n);if(r===-1)return;const s=this[r];return s instanceof Error&&N0(`property ${JSON.stringify(n)}`,s.error),s}static fromItems(n,r){return new Yp(Hb,n,r)}};vm=new WeakMap;let pg=Yp;function j3(t){let e=Or(t);return ge(e.length<=zs,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:zs,offset:e.length}),e.length!==zs&&(e=Fs(ir([iT.slice(e.length%zs),e]))),e}class Ml{constructor(e,n,r,s){G(this,"name");G(this,"type");G(this,"localName");G(this,"dynamic");wt(this,{name:e,type:n,localName:r,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,n){J(!1,e,this.localName,n)}}var el,jh,Em,Yv;class aT{constructor(){se(this,Em);se(this,el);se(this,jh);V(this,el,[]),V(this,jh,0)}get data(){return ir(R(this,el))}get length(){return R(this,jh)}appendWriter(e){return Ce(this,Em,Yv).call(this,Fs(e.data))}writeBytes(e){let n=Fs(e);const r=n.length%zs;return r&&(n=Fs(ir([n,iT.slice(r)]))),Ce(this,Em,Yv).call(this,n)}writeValue(e){return Ce(this,Em,Yv).call(this,j3(e))}writeUpdatableValue(){const e=R(this,el).length;return R(this,el).push(iT),V(this,jh,R(this,jh)+zs),n=>{R(this,el)[e]=j3(n)}}}el=new WeakMap,jh=new WeakMap,Em=new WeakSet,Yv=function(e){return R(this,el).push(e),V(this,jh,R(this,jh)+e.length),e.length};var di,$i,Rh,Ph,Nd,Tf,lT,u$;const ER=class ER{constructor(e,n,r){se(this,Tf);G(this,"allowLoose");se(this,di);se(this,$i);se(this,Rh);se(this,Ph);se(this,Nd);wt(this,{allowLoose:!!n}),V(this,di,Fs(e)),V(this,Rh,0),V(this,Ph,null),V(this,Nd,r??1024),V(this,$i,0)}get data(){return $e(R(this,di))}get dataLength(){return R(this,di).length}get consumed(){return R(this,$i)}get bytes(){return new Uint8Array(R(this,di))}subReader(e){const n=new ER(R(this,di).slice(R(this,$i)+e),this.allowLoose,R(this,Nd));return V(n,Ph,this),n}readBytes(e,n){let r=Ce(this,Tf,u$).call(this,0,e,!!n);return Ce(this,Tf,lT).call(this,e),V(this,$i,R(this,$i)+r.length),r.slice(0,e)}readValue(){return LC(this.readBytes(zs))}readIndex(){return QZ(this.readBytes(zs))}};di=new WeakMap,$i=new WeakMap,Rh=new WeakMap,Ph=new WeakMap,Nd=new WeakMap,Tf=new WeakSet,lT=function(e){var n;if(R(this,Ph))return Ce(n=R(this,Ph),Tf,lT).call(n,e);V(this,Rh,R(this,Rh)+e),ge(R(this,Nd)<1||R(this,Rh)<=R(this,Nd)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${R(this,Nd)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Fs(R(this,di)),offset:R(this,$i),length:e,info:{bytesRead:R(this,Rh),dataLength:this.dataLength}})},u$=function(e,n,r){let s=Math.ceil(n/zs)*zs;return R(this,$i)+s>R(this,di).length&&(this.allowLoose&&r&&R(this,$i)+n<=R(this,di).length?s=n:ge(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Fs(R(this,di)),length:R(this,di).length,offset:R(this,$i)+s})),R(this,di).slice(R(this,$i),R(this,$i)+s)};let cT=ER;function sE(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function _I(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function yX(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");sE(t.outputLen),sE(t.blockLen)}function mg(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function h$(t,e){_I(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const pA=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const f$=t=>t instanceof Uint8Array,wX=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),mA=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Oa=(t,e)=>t<<32-e|t>>>e,xX=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!xX)throw new Error("Non little-endian hardware is not supported");function bX(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function BC(t){if(typeof t=="string"&&(t=bX(t)),!f$(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function vX(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!f$(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}let kI=class{clone(){return this._cloneInto()}};function II(t){const e=r=>t().update(BC(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function EX(t=32){if(pA&&typeof pA.getRandomValues=="function")return pA.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class p$ extends kI{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,yX(e);const r=BC(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return mg(this),this.iHash.update(e),this}digestInto(e){mg(this),_I(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:c}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const m$=(t,e,n)=>new p$(t,e).update(n).digest();m$.create=(t,e)=>new p$(t,e);function CX(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),c=Number(n&i),l=r?4:0,d=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+d,c,r)}class g$ extends kI{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=mA(this.buffer)}update(e){mg(this);const{view:n,buffer:r,blockLen:s}=this;e=BC(e);const i=e.length;for(let o=0;o<i;){const c=Math.min(s-this.pos,i-o);if(c===s){const l=mA(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){mg(this),h$(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;CX(r,s-8,BigInt(this.length*8),i),this.process(r,0);const c=mA(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)c.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:c}=this;return e.length=s,e.pos=c,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}}const NX=(t,e,n)=>t&e^~t&n,AX=(t,e,n)=>t&e^t&n^e&n,SX=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$l=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Fl=new Uint32Array(64);class TX extends g${constructor(){super(64,32,8,!1),this.A=$l[0]|0,this.B=$l[1]|0,this.C=$l[2]|0,this.D=$l[3]|0,this.E=$l[4]|0,this.F=$l[5]|0,this.G=$l[6]|0,this.H=$l[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:c,H:l}=this;return[e,n,r,s,i,o,c,l]}set(e,n,r,s,i,o,c,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=c|0,this.H=l|0}process(e,n){for(let h=0;h<16;h++,n+=4)Fl[h]=e.getUint32(n,!1);for(let h=16;h<64;h++){const f=Fl[h-15],p=Fl[h-2],m=Oa(f,7)^Oa(f,18)^f>>>3,g=Oa(p,17)^Oa(p,19)^p>>>10;Fl[h]=g+Fl[h-7]+m+Fl[h-16]|0}let{A:r,B:s,C:i,D:o,E:c,F:l,G:d,H:u}=this;for(let h=0;h<64;h++){const f=Oa(c,6)^Oa(c,11)^Oa(c,25),p=u+f+NX(c,l,d)+SX[h]+Fl[h]|0,g=(Oa(r,2)^Oa(r,13)^Oa(r,22))+AX(r,s,i)|0;u=d,d=l,l=c,c=o+p|0,o=i,i=s,s=r,r=p+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,c=c+this.E|0,l=l+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(r,s,i,o,c,l,d,u)}roundClean(){Fl.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const y$=II(()=>new TX),Vb=BigInt(2**32-1),dT=BigInt(32);function w$(t,e=!1){return e?{h:Number(t&Vb),l:Number(t>>dT&Vb)}:{h:Number(t>>dT&Vb)|0,l:Number(t&Vb)|0}}function x$(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=w$(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const _X=(t,e)=>BigInt(t>>>0)<<dT|BigInt(e>>>0),kX=(t,e,n)=>t>>>n,IX=(t,e,n)=>t<<32-n|e>>>n,jX=(t,e,n)=>t>>>n|e<<32-n,RX=(t,e,n)=>t<<32-n|e>>>n,PX=(t,e,n)=>t<<64-n|e>>>n-32,OX=(t,e,n)=>t>>>n-32|e<<64-n,DX=(t,e)=>e,UX=(t,e)=>t,b$=(t,e,n)=>t<<n|e>>>32-n,v$=(t,e,n)=>e<<n|t>>>32-n,E$=(t,e,n)=>e<<n-32|t>>>64-n,C$=(t,e,n)=>t<<n-32|e>>>64-n;function MX(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const LX=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),BX=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,$X=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),FX=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,zX=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),HX=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Tt={fromBig:w$,split:x$,toBig:_X,shrSH:kX,shrSL:IX,rotrSH:jX,rotrSL:RX,rotrBH:PX,rotrBL:OX,rotr32H:DX,rotr32L:UX,rotlSH:b$,rotlSL:v$,rotlBH:E$,rotlBL:C$,add:MX,add3L:LX,add3H:BX,add4L:$X,add4H:FX,add5H:HX,add5L:zX},[VX,WX]=Tt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),zl=new Uint32Array(80),Hl=new Uint32Array(80);class qX extends g${constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:c,Dl:l,Eh:d,El:u,Fh:h,Fl:f,Gh:p,Gl:m,Hh:g,Hl:y}=this;return[e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y]}set(e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=c|0,this.Dl=l|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=p|0,this.Gl=m|0,this.Hh=g|0,this.Hl=y|0}process(e,n){for(let b=0;b<16;b++,n+=4)zl[b]=e.getUint32(n),Hl[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const v=zl[b-15]|0,E=Hl[b-15]|0,k=Tt.rotrSH(v,E,1)^Tt.rotrSH(v,E,8)^Tt.shrSH(v,E,7),C=Tt.rotrSL(v,E,1)^Tt.rotrSL(v,E,8)^Tt.shrSL(v,E,7),S=zl[b-2]|0,N=Hl[b-2]|0,I=Tt.rotrSH(S,N,19)^Tt.rotrBH(S,N,61)^Tt.shrSH(S,N,6),F=Tt.rotrSL(S,N,19)^Tt.rotrBL(S,N,61)^Tt.shrSL(S,N,6),P=Tt.add4L(C,F,Hl[b-7],Hl[b-16]),H=Tt.add4H(P,k,I,zl[b-7],zl[b-16]);zl[b]=H|0,Hl[b]=P|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:c,Cl:l,Dh:d,Dl:u,Eh:h,El:f,Fh:p,Fl:m,Gh:g,Gl:y,Hh:x,Hl:w}=this;for(let b=0;b<80;b++){const v=Tt.rotrSH(h,f,14)^Tt.rotrSH(h,f,18)^Tt.rotrBH(h,f,41),E=Tt.rotrSL(h,f,14)^Tt.rotrSL(h,f,18)^Tt.rotrBL(h,f,41),k=h&p^~h&g,C=f&m^~f&y,S=Tt.add5L(w,E,C,WX[b],Hl[b]),N=Tt.add5H(S,x,v,k,VX[b],zl[b]),I=S|0,F=Tt.rotrSH(r,s,28)^Tt.rotrBH(r,s,34)^Tt.rotrBH(r,s,39),P=Tt.rotrSL(r,s,28)^Tt.rotrBL(r,s,34)^Tt.rotrBL(r,s,39),H=r&i^r&c^i&c,z=s&o^s&l^o&l;x=g|0,w=y|0,g=p|0,y=m|0,p=h|0,m=f|0,{h,l:f}=Tt.add(d|0,u|0,N|0,I|0),d=c|0,u=l|0,c=i|0,l=o|0,i=r|0,o=s|0;const T=Tt.add3L(I,P,z);r=Tt.add3H(T,N,F,H),s=T|0}({h:r,l:s}=Tt.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Tt.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:c,l}=Tt.add(this.Ch|0,this.Cl|0,c|0,l|0),{h:d,l:u}=Tt.add(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:f}=Tt.add(this.Eh|0,this.El|0,h|0,f|0),{h:p,l:m}=Tt.add(this.Fh|0,this.Fl|0,p|0,m|0),{h:g,l:y}=Tt.add(this.Gh|0,this.Gl|0,g|0,y|0),{h:x,l:w}=Tt.add(this.Hh|0,this.Hl|0,x|0,w|0),this.set(r,s,i,o,c,l,d,u,h,f,p,m,g,y,x,w)}roundClean(){zl.fill(0),Hl.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const KX=II(()=>new qX);function GX(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const R3=GX();R3.crypto||R3.msCrypto;function YX(t){switch(t){case"sha256":return y$.create();case"sha512":return KX.create()}J(!1,"invalid hashing algorithm name","algorithm",t)}const[N$,A$,S$]=[[],[],[]],QX=BigInt(0),A0=BigInt(1),JX=BigInt(2),ZX=BigInt(7),XX=BigInt(256),eee=BigInt(113);for(let t=0,e=A0,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],N$.push(2*(5*r+n)),A$.push((t+1)*(t+2)/2%64);let s=QX;for(let i=0;i<7;i++)e=(e<<A0^(e>>ZX)*eee)%XX,e&JX&&(s^=A0<<(A0<<BigInt(i))-A0);S$.push(s)}const[tee,nee]=x$(S$,!0),P3=(t,e,n)=>n>32?E$(t,e,n):b$(t,e,n),O3=(t,e,n)=>n>32?C$(t,e,n):v$(t,e,n);function ree(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,l=(o+2)%10,d=n[l],u=n[l+1],h=P3(d,u,1)^n[c],f=O3(d,u,1)^n[c+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const c=A$[o],l=P3(s,i,c),d=O3(s,i,c),u=N$[o];s=t[u],i=t[u+1],t[u]=l,t[u+1]=d}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)n[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~n[(c+2)%10]&n[(c+4)%10]}t[0]^=tee[r],t[1]^=nee[r]}n.fill(0)}let see=class T$ extends kI{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,sE(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=wX(this.state)}keccak(){ree(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){mg(this);const{blockLen:n,state:r}=this;e=BC(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let c=0;c<o;c++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){mg(this,!1),_I(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return sE(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(h$(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new T$(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const iee=(t,e,n)=>II(()=>new see(e,t,n)),oee=iee(1,136,256/8);let _$=!1;const k$=function(t){return oee(t)};let I$=k$;function vr(t){const e=jt(t,"data");return $e(I$(e))}vr._=k$;vr.lock=function(){_$=!0};vr.register=function(t){if(_$)throw new TypeError("keccak256 is locked");I$=t};Object.freeze(vr);const j$=function(t){return YX("sha256").update(t).digest()};let R$=j$,P$=!1;function Vg(t){const e=jt(t,"data");return $e(R$(e))}Vg._=j$;Vg.lock=function(){P$=!0};Vg.register=function(t){if(P$)throw new Error("sha256 is locked");R$=t};Object.freeze(Vg);Object.freeze(Vg);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const O$=BigInt(0),$C=BigInt(1),aee=BigInt(2),FC=t=>t instanceof Uint8Array,cee=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function gg(t){if(!FC(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=cee[t[n]];return e}function D$(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function jI(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function yg(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const s=r*2,i=t.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function Kh(t){return jI(gg(t))}function RI(t){if(!FC(t))throw new Error("Uint8Array expected");return jI(gg(Uint8Array.from(t).reverse()))}function wg(t,e){return yg(t.toString(16).padStart(e*2,"0"))}function PI(t,e){return wg(t,e).reverse()}function lee(t){return yg(D$(t))}function ea(t,e,n){let r;if(typeof e=="string")try{r=yg(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(FC(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${t} expected ${n} bytes, got ${s}`);return r}function hw(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!FC(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function dee(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function uee(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function hee(t){let e;for(e=0;t>O$;t>>=$C,e+=1);return e}function fee(t,e){return t>>BigInt(e)&$C}const pee=(t,e,n)=>t|(n?$C:O$)<<BigInt(e),OI=t=>(aee<<BigInt(t-1))-$C,gA=t=>new Uint8Array(t),D3=t=>Uint8Array.from(t);function U$(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=gA(t),s=gA(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},c=(...h)=>n(s,r,...h),l=(h=gA())=>{s=c(D3([0]),h),r=c(),h.length!==0&&(s=c(D3([1]),h),r=c())},d=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){r=c();const p=r.slice();f.push(p),h+=r.length}return hw(...f)};return(h,f)=>{o(),l(h);let p;for(;!(p=f(d()));)l();return o(),p}}const mee={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Gx(t,e,n={}){const r=(s,i,o)=>{const c=mee[i];if(typeof c!="function")throw new Error(`Invalid validator "${i}", expected function`);const l=t[s];if(!(o&&l===void 0)&&!c(l,t))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${i}`)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}const gee=Object.freeze(Object.defineProperty({__proto__:null,bitGet:fee,bitLen:hee,bitMask:OI,bitSet:pee,bytesToHex:gg,bytesToNumberBE:Kh,bytesToNumberLE:RI,concatBytes:hw,createHmacDrbg:U$,ensureBytes:ea,equalBytes:dee,hexToBytes:yg,hexToNumber:jI,numberToBytesBE:wg,numberToBytesLE:PI,numberToHexUnpadded:D$,numberToVarBytesBE:lee,utf8ToBytes:uee,validateObject:Gx},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Hr=BigInt(0),ur=BigInt(1),Yu=BigInt(2),yee=BigInt(3),uT=BigInt(4),U3=BigInt(5),M3=BigInt(8);BigInt(9);BigInt(16);function mi(t,e){const n=t%e;return n>=Hr?n:e+n}function wee(t,e,n){if(n<=Hr||e<Hr)throw new Error("Expected power/modulo > 0");if(n===ur)return Hr;let r=ur;for(;e>Hr;)e&ur&&(r=r*t%n),t=t*t%n,e>>=ur;return r}function io(t,e,n){let r=t;for(;e-- >Hr;)r*=r,r%=n;return r}function hT(t,e){if(t===Hr||e<=Hr)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=mi(t,e),r=e,s=Hr,i=ur;for(;n!==Hr;){const c=r/n,l=r%n,d=s-i*c;r=n,n=l,s=i,i=d}if(r!==ur)throw new Error("invert: does not exist");return mi(s,e)}function xee(t){const e=(t-ur)/Yu;let n,r,s;for(n=t-ur,r=0;n%Yu===Hr;n/=Yu,r++);for(s=Yu;s<t&&wee(s,e,t)!==t-ur;s++);if(r===1){const o=(t+ur)/uT;return function(l,d){const u=l.pow(d,o);if(!l.eql(l.sqr(u),d))throw new Error("Cannot find square root");return u}}const i=(n+ur)/Yu;return function(c,l){if(c.pow(l,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let d=r,u=c.pow(c.mul(c.ONE,s),n),h=c.pow(l,i),f=c.pow(l,n);for(;!c.eql(f,c.ONE);){if(c.eql(f,c.ZERO))return c.ZERO;let p=1;for(let g=c.sqr(f);p<d&&!c.eql(g,c.ONE);p++)g=c.sqr(g);const m=c.pow(u,ur<<BigInt(d-p-1));u=c.sqr(m),h=c.mul(h,m),f=c.mul(f,u),d=p}return h}}function bee(t){if(t%uT===yee){const e=(t+ur)/uT;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%M3===U3){const e=(t-U3)/M3;return function(r,s){const i=r.mul(s,Yu),o=r.pow(i,e),c=r.mul(s,o),l=r.mul(r.mul(c,Yu),o),d=r.mul(c,r.sub(l,r.ONE));if(!r.eql(r.sqr(d),s))throw new Error("Cannot find square root");return d}}return xee(t)}const vee=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Eee(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=vee.reduce((r,s)=>(r[s]="function",r),e);return Gx(t,n)}function Cee(t,e,n){if(n<Hr)throw new Error("Expected power > 0");if(n===Hr)return t.ONE;if(n===ur)return e;let r=t.ONE,s=e;for(;n>Hr;)n&ur&&(r=t.mul(r,s)),s=t.sqr(s),n>>=ur;return r}function Nee(t,e){const n=new Array(e.length),r=e.reduce((i,o,c)=>t.is0(o)?i:(n[c]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,c)=>t.is0(o)?i:(n[c]=t.mul(i,n[c]),t.mul(i,o)),s),n}function M$(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Aee(t,e,n=!1,r={}){if(t<=Hr)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=M$(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=bee(t),c=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:OI(s),ZERO:Hr,ONE:ur,create:l=>mi(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return Hr<=l&&l<t},is0:l=>l===Hr,isOdd:l=>(l&ur)===ur,neg:l=>mi(-l,t),eql:(l,d)=>l===d,sqr:l=>mi(l*l,t),add:(l,d)=>mi(l+d,t),sub:(l,d)=>mi(l-d,t),mul:(l,d)=>mi(l*d,t),pow:(l,d)=>Cee(c,l,d),div:(l,d)=>mi(l*hT(d,t),t),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>hT(l,t),sqrt:r.sqrt||(l=>o(c,l)),invertBatch:l=>Nee(c,l),cmov:(l,d,u)=>u?d:l,toBytes:l=>n?PI(l,i):wg(l,i),fromBytes:l=>{if(l.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${l.length}`);return n?RI(l):Kh(l)}});return Object.freeze(c)}function L$(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function B$(t){const e=L$(t);return e+Math.ceil(e/2)}function See(t,e,n=!1){const r=t.length,s=L$(e),i=B$(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const o=n?Kh(t):RI(t),c=mi(o,e-ur)+ur;return n?PI(c,s):wg(c,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Tee=BigInt(0),yA=BigInt(1);function _ee(t,e){const n=(s,i)=>{const o=i.negate();return s?o:i},r=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:n,unsafeLadder(s,i){let o=t.ZERO,c=s;for(;i>Tee;)i&yA&&(o=o.add(c)),c=c.double(),i>>=yA;return o},precomputeWindow(s,i){const{windows:o,windowSize:c}=r(i),l=[];let d=s,u=d;for(let h=0;h<o;h++){u=d,l.push(u);for(let f=1;f<c;f++)u=u.add(d),l.push(u);d=u.double()}return l},wNAF(s,i,o){const{windows:c,windowSize:l}=r(s);let d=t.ZERO,u=t.BASE;const h=BigInt(2**s-1),f=2**s,p=BigInt(s);for(let m=0;m<c;m++){const g=m*l;let y=Number(o&h);o>>=p,y>l&&(y-=f,o+=yA);const x=g,w=g+Math.abs(y)-1,b=m%2!==0,v=y<0;y===0?u=u.add(n(b,i[x])):d=d.add(n(v,i[w]))}return{p:d,f:u}},wNAFCached(s,i,o,c){const l=s._WINDOW_SIZE||1;let d=i.get(s);return d||(d=this.precomputeWindow(s,l),l!==1&&i.set(s,c(d))),this.wNAF(l,d,o)}}}function $$(t){return Eee(t.Fp),Gx(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...M$(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function kee(t){const e=$$(t);Gx(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Iee,hexToBytes:jee}=gee,uh={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=uh;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Iee(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=uh,n=typeof t=="string"?jee(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=uh._parseInt(n.subarray(2)),{d:o,l:c}=uh._parseInt(i);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,n=d=>{const u=d.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),s=e(n(t.r)),i=r.length/2,o=s.length/2,c=n(i),l=n(o);return`30${n(o+i+4)}02${l}${s}02${c}${r}`}},dl=BigInt(0),vo=BigInt(1);BigInt(2);const L3=BigInt(3);BigInt(4);function Ree(t){const e=kee(t),{Fp:n}=e,r=e.toBytes||((m,g,y)=>{const x=g.toAffine();return hw(Uint8Array.from([4]),n.toBytes(x.x),n.toBytes(x.y))}),s=e.fromBytes||(m=>{const g=m.subarray(1),y=n.fromBytes(g.subarray(0,n.BYTES)),x=n.fromBytes(g.subarray(n.BYTES,2*n.BYTES));return{x:y,y:x}});function i(m){const{a:g,b:y}=e,x=n.sqr(m),w=n.mul(x,m);return n.add(n.add(w,n.mul(m,g)),y)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(m){return typeof m=="bigint"&&dl<m&&m<e.n}function c(m){if(!o(m))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(m){const{allowedPrivateKeyLengths:g,nByteLength:y,wrapPrivateKey:x,n:w}=e;if(g&&typeof m!="bigint"){if(m instanceof Uint8Array&&(m=gg(m)),typeof m!="string"||!g.includes(m.length))throw new Error("Invalid key");m=m.padStart(y*2,"0")}let b;try{b=typeof m=="bigint"?m:Kh(ea("private key",m,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof m}`)}return x&&(b=mi(b,w)),c(b),b}const d=new Map;function u(m){if(!(m instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(g,y,x){if(this.px=g,this.py=y,this.pz=x,g==null||!n.isValid(g))throw new Error("x required");if(y==null||!n.isValid(y))throw new Error("y required");if(x==null||!n.isValid(x))throw new Error("z required")}static fromAffine(g){const{x:y,y:x}=g||{};if(!g||!n.isValid(y)||!n.isValid(x))throw new Error("invalid affine point");if(g instanceof h)throw new Error("projective point not allowed");const w=b=>n.eql(b,n.ZERO);return w(y)&&w(x)?h.ZERO:new h(y,x,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const y=n.invertBatch(g.map(x=>x.pz));return g.map((x,w)=>x.toAffine(y[w])).map(h.fromAffine)}static fromHex(g){const y=h.fromAffine(s(ea("pointHex",g)));return y.assertValidity(),y}static fromPrivateKey(g){return h.BASE.multiply(l(g))}_setWindowSize(g){this._WINDOW_SIZE=g,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y}=this.toAffine();if(!n.isValid(g)||!n.isValid(y))throw new Error("bad point: x or y not FE");const x=n.sqr(y),w=i(g);if(!n.eql(x,w))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(n.isOdd)return!n.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){u(g);const{px:y,py:x,pz:w}=this,{px:b,py:v,pz:E}=g,k=n.eql(n.mul(y,E),n.mul(b,w)),C=n.eql(n.mul(x,E),n.mul(v,w));return k&&C}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:g,b:y}=e,x=n.mul(y,L3),{px:w,py:b,pz:v}=this;let E=n.ZERO,k=n.ZERO,C=n.ZERO,S=n.mul(w,w),N=n.mul(b,b),I=n.mul(v,v),F=n.mul(w,b);return F=n.add(F,F),C=n.mul(w,v),C=n.add(C,C),E=n.mul(g,C),k=n.mul(x,I),k=n.add(E,k),E=n.sub(N,k),k=n.add(N,k),k=n.mul(E,k),E=n.mul(F,E),C=n.mul(x,C),I=n.mul(g,I),F=n.sub(S,I),F=n.mul(g,F),F=n.add(F,C),C=n.add(S,S),S=n.add(C,S),S=n.add(S,I),S=n.mul(S,F),k=n.add(k,S),I=n.mul(b,v),I=n.add(I,I),S=n.mul(I,F),E=n.sub(E,S),C=n.mul(I,N),C=n.add(C,C),C=n.add(C,C),new h(E,k,C)}add(g){u(g);const{px:y,py:x,pz:w}=this,{px:b,py:v,pz:E}=g;let k=n.ZERO,C=n.ZERO,S=n.ZERO;const N=e.a,I=n.mul(e.b,L3);let F=n.mul(y,b),P=n.mul(x,v),H=n.mul(w,E),z=n.add(y,x),T=n.add(b,v);z=n.mul(z,T),T=n.add(F,P),z=n.sub(z,T),T=n.add(y,w);let _=n.add(b,E);return T=n.mul(T,_),_=n.add(F,H),T=n.sub(T,_),_=n.add(x,w),k=n.add(v,E),_=n.mul(_,k),k=n.add(P,H),_=n.sub(_,k),S=n.mul(N,T),k=n.mul(I,H),S=n.add(k,S),k=n.sub(P,S),S=n.add(P,S),C=n.mul(k,S),P=n.add(F,F),P=n.add(P,F),H=n.mul(N,H),T=n.mul(I,T),P=n.add(P,H),H=n.sub(F,H),H=n.mul(N,H),T=n.add(T,H),F=n.mul(P,T),C=n.add(C,F),F=n.mul(_,T),k=n.mul(z,k),k=n.sub(k,F),F=n.mul(z,P),S=n.mul(_,S),S=n.add(S,F),new h(k,C,S)}subtract(g){return this.add(g.negate())}is0(){return this.equals(h.ZERO)}wNAF(g){return p.wNAFCached(this,d,g,y=>{const x=n.invertBatch(y.map(w=>w.pz));return y.map((w,b)=>w.toAffine(x[b])).map(h.fromAffine)})}multiplyUnsafe(g){const y=h.ZERO;if(g===dl)return y;if(c(g),g===vo)return this;const{endo:x}=e;if(!x)return p.unsafeLadder(this,g);let{k1neg:w,k1:b,k2neg:v,k2:E}=x.splitScalar(g),k=y,C=y,S=this;for(;b>dl||E>dl;)b&vo&&(k=k.add(S)),E&vo&&(C=C.add(S)),S=S.double(),b>>=vo,E>>=vo;return w&&(k=k.negate()),v&&(C=C.negate()),C=new h(n.mul(C.px,x.beta),C.py,C.pz),k.add(C)}multiply(g){c(g);let y=g,x,w;const{endo:b}=e;if(b){const{k1neg:v,k1:E,k2neg:k,k2:C}=b.splitScalar(y);let{p:S,f:N}=this.wNAF(E),{p:I,f:F}=this.wNAF(C);S=p.constTimeNegate(v,S),I=p.constTimeNegate(k,I),I=new h(n.mul(I.px,b.beta),I.py,I.pz),x=S.add(I),w=N.add(F)}else{const{p:v,f:E}=this.wNAF(y);x=v,w=E}return h.normalizeZ([x,w])[0]}multiplyAndAddUnsafe(g,y,x){const w=h.BASE,b=(E,k)=>k===dl||k===vo||!E.equals(w)?E.multiplyUnsafe(k):E.multiply(k),v=b(this,y).add(b(g,x));return v.is0()?void 0:v}toAffine(g){const{px:y,py:x,pz:w}=this,b=this.is0();g==null&&(g=b?n.ONE:n.inv(w));const v=n.mul(y,g),E=n.mul(x,g),k=n.mul(w,g);if(b)return{x:n.ZERO,y:n.ZERO};if(!n.eql(k,n.ONE))throw new Error("invZ was invalid");return{x:v,y:E}}isTorsionFree(){const{h:g,isTorsionFree:y}=e;if(g===vo)return!0;if(y)return y(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:y}=e;return g===vo?this:y?y(h,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),r(h,this,g)}toHex(g=!0){return gg(this.toRawBytes(g))}}h.BASE=new h(e.Gx,e.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=e.nBitLength,p=_ee(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:i,isWithinCurveOrder:o}}function Pee(t){const e=$$(t);return Gx(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Oee(t){const e=Pee(t),{Fp:n,n:r}=e,s=n.BYTES+1,i=2*n.BYTES+1;function o(T){return dl<T&&T<n.ORDER}function c(T){return mi(T,r)}function l(T){return hT(T,r)}const{ProjectivePoint:d,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:f}=Ree({...e,toBytes(T,_,L){const O=_.toAffine(),M=n.toBytes(O.x),B=hw;return L?B(Uint8Array.from([_.hasEvenY()?2:3]),M):B(Uint8Array.from([4]),M,n.toBytes(O.y))},fromBytes(T){const _=T.length,L=T[0],O=T.subarray(1);if(_===s&&(L===2||L===3)){const M=Kh(O);if(!o(M))throw new Error("Point is not on curve");const B=h(M);let W=n.sqrt(B);const Z=(W&vo)===vo;return(L&1)===1!==Z&&(W=n.neg(W)),{x:M,y:W}}else if(_===i&&L===4){const M=n.fromBytes(O.subarray(0,n.BYTES)),B=n.fromBytes(O.subarray(n.BYTES,2*n.BYTES));return{x:M,y:B}}else throw new Error(`Point of length ${_} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),p=T=>gg(wg(T,e.nByteLength));function m(T){const _=r>>vo;return T>_}function g(T){return m(T)?c(-T):T}const y=(T,_,L)=>Kh(T.slice(_,L));class x{constructor(_,L,O){this.r=_,this.s=L,this.recovery=O,this.assertValidity()}static fromCompact(_){const L=e.nByteLength;return _=ea("compactSignature",_,L*2),new x(y(_,0,L),y(_,L,2*L))}static fromDER(_){const{r:L,s:O}=uh.toSig(ea("DER",_));return new x(L,O)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(_){return new x(this.r,this.s,_)}recoverPublicKey(_){const{r:L,s:O,recovery:M}=this,B=C(ea("msgHash",_));if(M==null||![0,1,2,3].includes(M))throw new Error("recovery id invalid");const W=M===2||M===3?L+e.n:L;if(W>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const Z=M&1?"03":"02",ie=d.fromHex(Z+p(W)),ae=l(W),oe=c(-B*ae),Ne=c(O*ae),de=d.BASE.multiplyAndAddUnsafe(ie,oe,Ne);if(!de)throw new Error("point at infinify");return de.assertValidity(),de}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return yg(this.toDERHex())}toDERHex(){return uh.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return yg(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}const w={isValidPrivateKey(T){try{return u(T),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const T=B$(e.n);return See(e.randomBytes(T),e.n)},precompute(T=8,_=d.BASE){return _._setWindowSize(T),_.multiply(BigInt(3)),_}};function b(T,_=!0){return d.fromPrivateKey(T).toRawBytes(_)}function v(T){const _=T instanceof Uint8Array,L=typeof T=="string",O=(_||L)&&T.length;return _?O===s||O===i:L?O===2*s||O===2*i:T instanceof d}function E(T,_,L=!0){if(v(T))throw new Error("first arg must be private key");if(!v(_))throw new Error("second arg must be public key");return d.fromHex(_).multiply(u(T)).toRawBytes(L)}const k=e.bits2int||function(T){const _=Kh(T),L=T.length*8-e.nBitLength;return L>0?_>>BigInt(L):_},C=e.bits2int_modN||function(T){return c(k(T))},S=OI(e.nBitLength);function N(T){if(typeof T!="bigint")throw new Error("bigint expected");if(!(dl<=T&&T<S))throw new Error(`bigint expected < 2^${e.nBitLength}`);return wg(T,e.nByteLength)}function I(T,_,L=F){if(["recovered","canonical"].some(Ue=>Ue in L))throw new Error("sign() legacy options not supported");const{hash:O,randomBytes:M}=e;let{lowS:B,prehash:W,extraEntropy:Z}=L;B==null&&(B=!0),T=ea("msgHash",T),W&&(T=ea("prehashed msgHash",O(T)));const ie=C(T),ae=u(_),oe=[N(ae),N(ie)];if(Z!=null){const Ue=Z===!0?M(n.BYTES):Z;oe.push(ea("extraEntropy",Ue))}const Ne=hw(...oe),de=ie;function _e(Ue){const ee=k(Ue);if(!f(ee))return;const q=l(ee),ue=d.BASE.multiply(ee).toAffine(),Ae=c(ue.x);if(Ae===dl)return;const tt=c(q*c(de+Ae*ae));if(tt===dl)return;let me=(ue.x===Ae?0:2)|Number(ue.y&vo),je=tt;return B&&m(tt)&&(je=g(tt),me^=1),new x(Ae,je,me)}return{seed:Ne,k2sig:_e}}const F={lowS:e.lowS,prehash:!1},P={lowS:e.lowS,prehash:!1};function H(T,_,L=F){const{seed:O,k2sig:M}=I(T,_,L),B=e;return U$(B.hash.outputLen,B.nByteLength,B.hmac)(O,M)}d.BASE._setWindowSize(8);function z(T,_,L,O=P){var ue;const M=T;if(_=ea("msgHash",_),L=ea("publicKey",L),"strict"in O)throw new Error("options.strict was renamed to lowS");const{lowS:B,prehash:W}=O;let Z,ie;try{if(typeof M=="string"||M instanceof Uint8Array)try{Z=x.fromDER(M)}catch(Ae){if(!(Ae instanceof uh.Err))throw Ae;Z=x.fromCompact(M)}else if(typeof M=="object"&&typeof M.r=="bigint"&&typeof M.s=="bigint"){const{r:Ae,s:tt}=M;Z=new x(Ae,tt)}else throw new Error("PARSE");ie=d.fromHex(L)}catch(Ae){if(Ae.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(B&&Z.hasHighS())return!1;W&&(_=e.hash(_));const{r:ae,s:oe}=Z,Ne=C(_),de=l(oe),_e=c(Ne*de),Ue=c(ae*de),ee=(ue=d.BASE.multiplyAndAddUnsafe(ie,_e,Ue))==null?void 0:ue.toAffine();return ee?c(ee.x)===ae:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:E,sign:H,verify:z,ProjectivePoint:d,Signature:x,utils:w}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Dee(t){return{hash:t,hmac:(e,...n)=>m$(t,e,vX(...n)),randomBytes:EX}}function Uee(t,e){const n=r=>Oee({...t,...Dee(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const F$=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),B3=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Mee=BigInt(1),fT=BigInt(2),$3=(t,e)=>(t+e/fT)/e;function Lee(t){const e=F$,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),c=BigInt(44),l=BigInt(88),d=t*t*t%e,u=d*d*t%e,h=io(u,n,e)*u%e,f=io(h,n,e)*u%e,p=io(f,fT,e)*d%e,m=io(p,s,e)*p%e,g=io(m,i,e)*m%e,y=io(g,c,e)*g%e,x=io(y,l,e)*y%e,w=io(x,c,e)*g%e,b=io(w,n,e)*u%e,v=io(b,o,e)*m%e,E=io(v,r,e)*d%e,k=io(E,fT,e);if(!pT.eql(pT.sqr(k),t))throw new Error("Cannot find square root");return k}const pT=Aee(F$,void 0,void 0,{sqrt:Lee}),id=Uee({a:BigInt(0),b:BigInt(7),Fp:pT,n:B3,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=B3,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Mee*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),c=$3(i*t,e),l=$3(-r*t,e);let d=mi(t-c*n-l*s,e),u=mi(-c*r-l*i,e);const h=d>o,f=u>o;if(h&&(d=e-d),f&&(u=e-u),d>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:d,k2neg:f,k2:u}}}},y$);BigInt(0);id.ProjectivePoint;const fw="0x0000000000000000000000000000000000000000",F3="0x0000000000000000000000000000000000000000000000000000000000000000",z3=BigInt(0),H3=BigInt(1),V3=BigInt(2),W3=BigInt(27),q3=BigInt(28),Wb=BigInt(35),Kf={};function K3(t){return _l(Or(t),32)}var Cm,Ka,Nm,Oh;const Zo=class Zo{constructor(e,n,r,s){se(this,Cm);se(this,Ka);se(this,Nm);se(this,Oh);qx(e,Kf,"Signature"),V(this,Cm,n),V(this,Ka,r),V(this,Nm,s),V(this,Oh,null)}get r(){return R(this,Cm)}set r(e){J(im(e)===32,"invalid r","value",e),V(this,Cm,$e(e))}get s(){return J(parseInt(R(this,Ka).substring(0,3))<8,"non-canonical s; use ._s","s",R(this,Ka)),R(this,Ka)}set s(e){J(im(e)===32,"invalid s","value",e),V(this,Ka,$e(e))}get _s(){return R(this,Ka)}isValid(){return parseInt(R(this,Ka).substring(0,3))<8}get v(){return R(this,Nm)}set v(e){const n=St(e,"value");J(n===27||n===28,"invalid v","v",e),V(this,Nm,n)}get networkV(){return R(this,Oh)}get legacyChainId(){const e=this.networkV;return e==null?null:Zo.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=jt(this.s);return this.yParity&&(e[0]|=128),$e(e)}get compactSerialized(){return ir([this.r,this.yParityAndS])}get serialized(){return ir([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Zo(Kf,this.r,this._s,this.v);return this.networkV&&V(e,Oh,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const n=Je(e,"v");return n==W3||n==q3?z3:(J(n>=Wb,"invalid EIP-155 v","v",e),(n-Wb)/V3)}static getChainIdV(e,n){return Je(e)*V3+BigInt(35+n-27)}static getNormalizedV(e){const n=Je(e);return n===z3||n===W3?27:n===H3||n===q3?28:(J(n>=Wb,"invalid v","v",e),n&H3?27:28)}static from(e){function n(d,u){J(d,u,"signature",e)}if(e==null)return new Zo(Kf,F3,F3,27);if(typeof e=="string"){const d=jt(e,"signature");if(d.length===64){const u=$e(d.slice(0,32)),h=d.slice(32,64),f=h[0]&128?28:27;return h[0]&=127,new Zo(Kf,u,$e(h),f)}if(d.length===65){const u=$e(d.slice(0,32)),h=$e(d.slice(32,64)),f=Zo.getNormalizedV(d[64]);return new Zo(Kf,u,h,f)}n(!1,"invalid raw signature length")}if(e instanceof Zo)return e.clone();const r=e.r;n(r!=null,"missing r");const s=K3(r),i=function(d,u){if(d!=null)return K3(d);if(u!=null){n(Sn(u,32),"invalid yParityAndS");const h=jt(u);return h[0]&=127,$e(h)}n(!1,"missing s")}(e.s,e.yParityAndS),{networkV:o,v:c}=function(d,u,h){if(d!=null){const f=Je(d);return{networkV:f>=Wb?f:void 0,v:Zo.getNormalizedV(f)}}if(u!=null)return n(Sn(u,32),"invalid yParityAndS"),{v:jt(u)[0]&128?28:27};if(h!=null){switch(St(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}n(!1,"invalid yParity")}n(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),l=new Zo(Kf,s,i,c);return o&&V(l,Oh,o),n(e.yParity==null||St(e.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),n(e.yParityAndS==null||e.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};Cm=new WeakMap,Ka=new WeakMap,Nm=new WeakMap,Oh=new WeakMap;let Ti=Zo;var tl;const eh=class eh{constructor(e){se(this,tl);J(im(e)===32,"invalid private key","privateKey","[REDACTED]"),V(this,tl,$e(e))}get privateKey(){return R(this,tl)}get publicKey(){return eh.computePublicKey(R(this,tl))}get compressedPublicKey(){return eh.computePublicKey(R(this,tl),!0)}sign(e){J(im(e)===32,"invalid digest length","digest",e);const n=id.sign(Fs(e),Fs(R(this,tl)),{lowS:!0});return Ti.from({r:ou(n.r,32),s:ou(n.s,32),v:n.recovery?28:27})}computeSharedSecret(e){const n=eh.computePublicKey(e);return $e(id.getSharedSecret(Fs(R(this,tl)),jt(n),!1))}static computePublicKey(e,n){let r=jt(e,"key");if(r.length===32){const i=id.getPublicKey(r,!!n);return $e(i)}if(r.length===64){const i=new Uint8Array(65);i[0]=4,i.set(r,1),r=i}const s=id.ProjectivePoint.fromHex(r);return $e(s.toRawBytes(n))}static recoverPublicKey(e,n){J(im(e)===32,"invalid digest length","digest",e);const r=Ti.from(n);let s=id.Signature.fromCompact(Fs(ir([r.r,r.s])));s=s.addRecoveryBit(r.yParity);const i=s.recoverPublicKey(Fs(e));return J(i!=null,"invalid signature for digest","signature",n),"0x"+i.toHex(!1)}static addPoints(e,n,r){const s=id.ProjectivePoint.fromHex(eh.computePublicKey(e).substring(2)),i=id.ProjectivePoint.fromHex(eh.computePublicKey(n).substring(2));return"0x"+s.add(i).toHex(!!r)}};tl=new WeakMap;let pw=eh;const Bee=BigInt(0),$ee=BigInt(36);function G3(t){t=t.toLowerCase();const e=t.substring(2).split(""),n=new Uint8Array(40);for(let s=0;s<40;s++)n[s]=e[s].charCodeAt(0);const r=jt(vr(n));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const DI={};for(let t=0;t<10;t++)DI[String(t)]=String(t);for(let t=0;t<26;t++)DI[String.fromCharCode(65+t)]=String(10+t);const Y3=15;function Fee(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(r=>DI[r]).join("");for(;e.length>=Y3;){let r=e.substring(0,Y3);e=parseInt(r,10)%97+e.substring(r.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}const zee=function(){const t={};for(let e=0;e<36;e++){const n="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[n]=BigInt(e)}return t}();function Hee(t){t=t.toLowerCase();let e=Bee;for(let n=0;n<t.length;n++)e=e*$ee+zee[t[n]];return e}function un(t){if(J(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=G3(t);return J(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){J(t.substring(2,4)===Fee(t),"bad icap checksum","address",t);let e=Hee(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return G3("0x"+e)}J(!1,"invalid address","address",t)}function Vee(t){const e=un(t.from);let r=Je(t.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,un(Xn(vr(au([e,r])),12))}function z$(t){return t&&typeof t.getAddress=="function"}async function wA(t,e){const n=await e;return(n==null||n==="0x0000000000000000000000000000000000000000")&&(ge(typeof t!="string","unconfigured name","UNCONFIGURED_NAME",{value:t}),J(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),un(n)}function Hs(t,e){if(typeof t=="string")return t.match(/^0x[0-9a-f]{40}$/i)?un(t):(ge(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),wA(t,e.resolveName(t)));if(z$(t))return wA(t,t.getAddress());if(t&&typeof t.then=="function")return wA(t,t);J(!1,"unsupported addressable value","target",t)}const qc={};function Ye(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new Rs(qc,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function nn(t,e){return new Rs(qc,`bytes${e||""}`,t,{size:e})}const Q3=Symbol.for("_ethers_typed");var Dh;const Gc=class Gc{constructor(e,n,r,s){G(this,"type");G(this,"value");se(this,Dh);G(this,"_typedSymbol");s==null&&(s=null),qx(qc,e,"Typed"),wt(this,{_typedSymbol:Q3,type:n,value:r}),V(this,Dh,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return R(this,Dh)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return R(this,Dh)===!0?-1:R(this,Dh)===!1?this.value.length:null}static from(e,n){return new Gc(qc,e,n)}static uint8(e){return Ye(e,8)}static uint16(e){return Ye(e,16)}static uint24(e){return Ye(e,24)}static uint32(e){return Ye(e,32)}static uint40(e){return Ye(e,40)}static uint48(e){return Ye(e,48)}static uint56(e){return Ye(e,56)}static uint64(e){return Ye(e,64)}static uint72(e){return Ye(e,72)}static uint80(e){return Ye(e,80)}static uint88(e){return Ye(e,88)}static uint96(e){return Ye(e,96)}static uint104(e){return Ye(e,104)}static uint112(e){return Ye(e,112)}static uint120(e){return Ye(e,120)}static uint128(e){return Ye(e,128)}static uint136(e){return Ye(e,136)}static uint144(e){return Ye(e,144)}static uint152(e){return Ye(e,152)}static uint160(e){return Ye(e,160)}static uint168(e){return Ye(e,168)}static uint176(e){return Ye(e,176)}static uint184(e){return Ye(e,184)}static uint192(e){return Ye(e,192)}static uint200(e){return Ye(e,200)}static uint208(e){return Ye(e,208)}static uint216(e){return Ye(e,216)}static uint224(e){return Ye(e,224)}static uint232(e){return Ye(e,232)}static uint240(e){return Ye(e,240)}static uint248(e){return Ye(e,248)}static uint256(e){return Ye(e,256)}static uint(e){return Ye(e,256)}static int8(e){return Ye(e,-8)}static int16(e){return Ye(e,-16)}static int24(e){return Ye(e,-24)}static int32(e){return Ye(e,-32)}static int40(e){return Ye(e,-40)}static int48(e){return Ye(e,-48)}static int56(e){return Ye(e,-56)}static int64(e){return Ye(e,-64)}static int72(e){return Ye(e,-72)}static int80(e){return Ye(e,-80)}static int88(e){return Ye(e,-88)}static int96(e){return Ye(e,-96)}static int104(e){return Ye(e,-104)}static int112(e){return Ye(e,-112)}static int120(e){return Ye(e,-120)}static int128(e){return Ye(e,-128)}static int136(e){return Ye(e,-136)}static int144(e){return Ye(e,-144)}static int152(e){return Ye(e,-152)}static int160(e){return Ye(e,-160)}static int168(e){return Ye(e,-168)}static int176(e){return Ye(e,-176)}static int184(e){return Ye(e,-184)}static int192(e){return Ye(e,-192)}static int200(e){return Ye(e,-200)}static int208(e){return Ye(e,-208)}static int216(e){return Ye(e,-216)}static int224(e){return Ye(e,-224)}static int232(e){return Ye(e,-232)}static int240(e){return Ye(e,-240)}static int248(e){return Ye(e,-248)}static int256(e){return Ye(e,-256)}static int(e){return Ye(e,-256)}static bytes1(e){return nn(e,1)}static bytes2(e){return nn(e,2)}static bytes3(e){return nn(e,3)}static bytes4(e){return nn(e,4)}static bytes5(e){return nn(e,5)}static bytes6(e){return nn(e,6)}static bytes7(e){return nn(e,7)}static bytes8(e){return nn(e,8)}static bytes9(e){return nn(e,9)}static bytes10(e){return nn(e,10)}static bytes11(e){return nn(e,11)}static bytes12(e){return nn(e,12)}static bytes13(e){return nn(e,13)}static bytes14(e){return nn(e,14)}static bytes15(e){return nn(e,15)}static bytes16(e){return nn(e,16)}static bytes17(e){return nn(e,17)}static bytes18(e){return nn(e,18)}static bytes19(e){return nn(e,19)}static bytes20(e){return nn(e,20)}static bytes21(e){return nn(e,21)}static bytes22(e){return nn(e,22)}static bytes23(e){return nn(e,23)}static bytes24(e){return nn(e,24)}static bytes25(e){return nn(e,25)}static bytes26(e){return nn(e,26)}static bytes27(e){return nn(e,27)}static bytes28(e){return nn(e,28)}static bytes29(e){return nn(e,29)}static bytes30(e){return nn(e,30)}static bytes31(e){return nn(e,31)}static bytes32(e){return nn(e,32)}static address(e){return new Gc(qc,"address",e)}static bool(e){return new Gc(qc,"bool",!!e)}static bytes(e){return new Gc(qc,"bytes",e)}static string(e){return new Gc(qc,"string",e)}static array(e,n){throw new Error("not implemented yet")}static tuple(e,n){throw new Error("not implemented yet")}static overrides(e){return new Gc(qc,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Q3}static dereference(e,n){if(Gc.isTyped(e)){if(e.type!==n)throw new Error(`invalid type: expecetd ${n}, got ${e.type}`);return e.value}return e}};Dh=new WeakMap;let Rs=Gc;class Wee extends Ml{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,n){let r=Rs.dereference(n,"string");try{r=un(r)}catch(s){return this._throwError(s.message,n)}return e.writeValue(r)}decode(e){return un(ou(e.readValue(),20))}}class qee extends Ml{constructor(n){super(n.name,n.type,"_",n.dynamic);G(this,"coder");this.coder=n}defaultValue(){return this.coder.defaultValue()}encode(n,r){return this.coder.encode(n,r)}decode(n){return this.coder.decode(n)}}function H$(t,e,n){let r=[];if(Array.isArray(n))r=n;else if(n&&typeof n=="object"){let l={};r=e.map(d=>{const u=d.localName;return ge(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:n}),ge(!l[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:n}),l[u]=!0,n[u]})}else J(!1,"invalid tuple value","tuple",n);J(e.length===r.length,"types/value length mismatch","tuple",n);let s=new aT,i=new aT,o=[];e.forEach((l,d)=>{let u=r[d];if(l.dynamic){let h=i.length;l.encode(i,u);let f=s.writeUpdatableValue();o.push(p=>{f(p+h)})}else l.encode(s,u)}),o.forEach(l=>{l(s.length)});let c=t.appendWriter(s);return c+=t.appendWriter(i),c}function V$(t,e){let n=[],r=[],s=t.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let c=t.readIndex(),l=s.subReader(c);try{o=i.decode(l)}catch(d){if(rs(d,"BUFFER_OVERRUN"))throw d;o=d,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(t)}catch(c){if(rs(c,"BUFFER_OVERRUN"))throw c;o=c,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");n.push(o),r.push(i.localName||null)}),pg.fromItems(n,r)}class Kee extends Ml{constructor(n,r,s){const i=n.type+"["+(r>=0?r:"")+"]",o=r===-1||n.dynamic;super("array",i,s,o);G(this,"coder");G(this,"length");wt(this,{coder:n,length:r})}defaultValue(){const n=this.coder.defaultValue(),r=[];for(let s=0;s<this.length;s++)r.push(n);return r}encode(n,r){const s=Rs.dereference(r,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,n.writeValue(s.length)),JB(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let c=0;c<s.length;c++)o.push(this.coder);return H$(n,o,s)}decode(n){let r=this.length;r===-1&&(r=n.readIndex(),ge(r*zs<=n.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:n.bytes,offset:r*zs,length:n.dataLength}));let s=[];for(let i=0;i<r;i++)s.push(new qee(this.coder));return V$(n,s)}}class Gee extends Ml{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,n){const r=Rs.dereference(n,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class W$ extends Ml{constructor(e,n){super(e,e,n,!0)}defaultValue(){return"0x"}encode(e,n){n=Fs(n);let r=e.writeValue(n.length);return r+=e.writeBytes(n),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class Yee extends W${constructor(e){super("bytes",e)}decode(e){return $e(super.decode(e))}}class Qee extends Ml{constructor(n,r){let s="bytes"+String(n);super(s,s,r,!1);G(this,"size");wt(this,{size:n},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(n,r){let s=Fs(Rs.dereference(r,this.type));return s.length!==this.size&&this._throwError("incorrect data length",r),n.writeBytes(s)}decode(n){return $e(n.readBytes(this.size))}}const Jee=new Uint8Array([]);class Zee extends Ml{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,n){return n!=null&&this._throwError("not null",n),e.writeBytes(Jee)}decode(e){return e.readBytes(0),null}}const Xee=BigInt(0),ete=BigInt(1),tte=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class nte extends Ml{constructor(n,r,s){const i=(r?"int":"uint")+n*8;super(i,i,s,!1);G(this,"size");G(this,"signed");wt(this,{size:n,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(n,r){let s=Je(Rs.dereference(r,this.type)),i=dh(tte,zs*8);if(this.signed){let o=dh(i,this.size*8-1);(s>o||s<-(o+ete))&&this._throwError("value out-of-bounds",r),s=e$(s,8*zs)}else(s<Xee||s>dh(i,this.size*8))&&this._throwError("value out-of-bounds",r);return n.writeValue(s)}decode(n){let r=dh(n.readValue(),this.size*8);return this.signed&&(r=tE(r,this.size*8)),r}}class rte extends W${constructor(e){super("string",e)}defaultValue(){return""}encode(e,n){return super.encode(e,mc(Rs.dereference(n,"string")))}decode(e){return nE(super.decode(e))}}class qb extends Ml{constructor(n,r){let s=!1;const i=[];n.forEach(c=>{c.dynamic&&(s=!0),i.push(c.type)});const o="tuple("+i.join(",")+")";super("tuple",o,r,s);G(this,"coders");wt(this,{coders:Object.freeze(n.slice())})}defaultValue(){const n=[];this.coders.forEach(s=>{n.push(s.defaultValue())});const r=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||r[o]!==1||(o==="length"&&(o="_length"),n[o]==null&&(n[o]=n[i]))}),Object.freeze(n)}encode(n,r){const s=Rs.dereference(r,"tuple");return H$(n,this.coders,s)}decode(n){return V$(n,this.coders)}}function xA(t,e){return{address:un(t),storageKeys:e.map((n,r)=>(J(Sn(n,32),"invalid slot",`storageKeys[${r}]`,n),n.toLowerCase()))}}function If(t){if(Array.isArray(t))return t.map((n,r)=>Array.isArray(n)?(J(n.length===2,"invalid slot set",`value[${r}]`,n),xA(n[0],n[1])):(J(n!=null&&typeof n=="object","invalid address-slot set","value",t),xA(n.address,n.storageKeys)));J(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(n=>{const r=t[n].reduce((s,i)=>(s[i]=!0,s),{});return xA(n,Object.keys(r).sort())});return e.sort((n,r)=>n.address.localeCompare(r.address)),e}function q$(t){return{address:un(t.address),nonce:Je(t.nonce!=null?t.nonce:0),chainId:Je(t.chainId!=null?t.chainId:0),signature:Ti.from(t.signature)}}function ste(t){let e;return typeof t=="string"?e=pw.computePublicKey(t,!1):e=t.publicKey,un(vr("0x"+e.substring(4)).substring(26))}function ite(t,e){return ste(pw.recoverPublicKey(t,e))}const Fr=BigInt(0),ote=BigInt(2),ate=BigInt(27),cte=BigInt(28),lte=BigInt(35),dte=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),bA=4096*32;function ute(t){return{blobToKzgCommitment:r=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return jt(t.blobToKzgCommitment($e(r)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return jt(t.blobToKzgCommitment(r));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return jt(t.blobToKZGCommitment($e(r)));J(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(r,s)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return jt(t.computeBlobProof($e(r),$e(s)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(r,s);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return jt(t.computeBlobKZGProof($e(r),$e(s)));J(!1,"unsupported KZG library","kzg",t)}}}function J3(t,e){let n=t.toString(16);for(;n.length<2;)n="0"+n;return n+=Vg(e).substring(4),"0x"+n}function Wg(t){return t==="0x"?null:un(t)}function zC(t,e){try{return If(t)}catch(n){J(!1,n.message,e,t)}}function hte(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const n=[];for(let r=0;r<t.length;r++){const s=t[r];if(!Array.isArray(s))throw new Error(`authorization[${r}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!s[1])throw new Error(`authorization[${r}]: null address`);n.push({address:Wg(s[1]),nonce:Cn(s[2],"nonce"),chainId:Cn(s[0],"chainId"),signature:Ti.from({yParity:jf(s[3],"yParity"),r:_l(s[4],32),s:_l(s[5],32)})})}return n}catch(n){J(!1,n.message,e,t)}}function jf(t,e){return t==="0x"?0:St(t,e)}function Cn(t,e){if(t==="0x")return Fr;const n=Je(t,e);return J(n<=dte,"value exceeds uint size",e,n),n}function Kt(t,e){const n=Je(t,"value"),r=Or(n);return J(r.length<=32,"value too large",`tx.${e}`,n),r}function HC(t){return If(t).map(e=>[e.address,e.storageKeys])}function fte(t){return t.map(e=>[Kt(e.chainId,"chainId"),e.address,Kt(e.nonce,"nonce"),Kt(e.signature.yParity,"yParity"),Or(e.signature.r),Or(e.signature.s)])}function pte(t,e){J(Array.isArray(t),`invalid ${e}`,"value",t);for(let n=0;n<t.length;n++)J(Sn(t[n],32),"invalid ${ param } hash",`value[${n}]`,t[n]);return t}function mte(t){const e=Kx(t);J(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const n={type:0,nonce:jf(e[0],"nonce"),gasPrice:Cn(e[1],"gasPrice"),gasLimit:Cn(e[2],"gasLimit"),to:Wg(e[3]),value:Cn(e[4],"value"),data:$e(e[5]),chainId:Fr};if(e.length===6)return n;const r=Cn(e[6],"v"),s=Cn(e[7],"r"),i=Cn(e[8],"s");if(s===Fr&&i===Fr)n.chainId=r;else{let o=(r-lte)/ote;o<Fr&&(o=Fr),n.chainId=o,J(o!==Fr||r===ate||r===cte,"non-canonical legacy v","v",e[6]),n.signature=Ti.from({r:_l(e[7],32),s:_l(e[8],32),v:r})}return n}function gte(t,e){const n=[Kt(t.nonce,"nonce"),Kt(t.gasPrice||0,"gasPrice"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data];let r=Fr;if(t.chainId!=Fr)r=Je(t.chainId,"tx.chainId"),J(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const i=t.signature.legacyChainId;i!=null&&(r=i)}if(!e)return r!==Fr&&(n.push(Or(r)),n.push("0x"),n.push("0x")),au(n);let s=BigInt(27+e.yParity);return r!==Fr?s=Ti.getChainIdV(r,e.v):BigInt(e.v)!==s&&J(!1,"tx.chainId/sig.v mismatch","sig",e),n.push(Or(s)),n.push(Or(e.r)),n.push(Or(e.s)),au(n)}function VC(t,e){let n;try{if(n=jf(e[0],"yParity"),n!==0&&n!==1)throw new Error("bad yParity")}catch{J(!1,"invalid yParity","yParity",e[0])}const r=_l(e[1],32),s=_l(e[2],32),i=Ti.from({r,s,yParity:n});t.signature=i}function yte(t){const e=Kx(jt(t).slice(1));J(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",$e(t));const n={type:2,chainId:Cn(e[0],"chainId"),nonce:jf(e[1],"nonce"),maxPriorityFeePerGas:Cn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Cn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Cn(e[4],"gasLimit"),to:Wg(e[5]),value:Cn(e[6],"value"),data:$e(e[7]),accessList:zC(e[8],"accessList")};return e.length===9||VC(n,e.slice(9)),n}function wte(t,e){const n=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Kt(t.maxFeePerGas||0,"maxFeePerGas"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data,HC(t.accessList||[])];return e&&(n.push(Kt(e.yParity,"yParity")),n.push(Or(e.r)),n.push(Or(e.s))),ir(["0x02",au(n)])}function xte(t){const e=Kx(jt(t).slice(1));J(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",$e(t));const n={type:1,chainId:Cn(e[0],"chainId"),nonce:jf(e[1],"nonce"),gasPrice:Cn(e[2],"gasPrice"),gasLimit:Cn(e[3],"gasLimit"),to:Wg(e[4]),value:Cn(e[5],"value"),data:$e(e[6]),accessList:zC(e[7],"accessList")};return e.length===8||VC(n,e.slice(8)),n}function bte(t,e){const n=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.gasPrice||0,"gasPrice"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data,HC(t.accessList||[])];return e&&(n.push(Kt(e.yParity,"recoveryParam")),n.push(Or(e.r)),n.push(Or(e.s))),ir(["0x01",au(n)])}function vte(t){let e=Kx(jt(t).slice(1)),n="3",r=null;if(e.length===4&&Array.isArray(e[0])){n="3 (network format)";const i=e[1],o=e[2],c=e[3];J(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),J(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),J(Array.isArray(c),"invalid network format: proofs not an array","fields[3]",c),J(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),J(i.length===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let l=0;l<e[1].length;l++)r.push({data:i[l],commitment:o[l],proof:c[l]});e=e[0]}J(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${n}`,"data",$e(t));const s={type:3,chainId:Cn(e[0],"chainId"),nonce:jf(e[1],"nonce"),maxPriorityFeePerGas:Cn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Cn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Cn(e[4],"gasLimit"),to:Wg(e[5]),value:Cn(e[6],"value"),data:$e(e[7]),accessList:zC(e[8],"accessList"),maxFeePerBlobGas:Cn(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(s.blobs=r),J(s.to!=null,`invalid address for transaction type: ${n}`,"data",t),J(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let i=0;i<s.blobVersionedHashes.length;i++)J(Sn(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",t);return e.length===11||VC(s,e.slice(11)),s}function Ete(t,e,n){const r=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Kt(t.maxFeePerGas||0,"maxFeePerGas"),Kt(t.gasLimit,"gasLimit"),t.to||fw,Kt(t.value,"value"),t.data,HC(t.accessList||[]),Kt(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),pte(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Kt(e.yParity,"yParity")),r.push(Or(e.r)),r.push(Or(e.s)),n)?ir(["0x03",au([r,n.map(s=>s.data),n.map(s=>s.commitment),n.map(s=>s.proof)])]):ir(["0x03",au(r)])}function Cte(t){const e=Kx(jt(t).slice(1));J(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",$e(t));const n={type:4,chainId:Cn(e[0],"chainId"),nonce:jf(e[1],"nonce"),maxPriorityFeePerGas:Cn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Cn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Cn(e[4],"gasLimit"),to:Wg(e[5]),value:Cn(e[6],"value"),data:$e(e[7]),accessList:zC(e[8],"accessList"),authorizationList:hte(e[9],"authorizationList")};return e.length===10||VC(n,e.slice(10)),n}function Nte(t,e){const n=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Kt(t.maxFeePerGas||0,"maxFeePerGas"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data,HC(t.accessList||[]),fte(t.authorizationList||[])];return e&&(n.push(Kt(e.yParity,"yParity")),n.push(Or(e.r)),n.push(Or(e.s))),ir(["0x04",au(n)])}var ia,Am,Sm,Tm,_m,km,Im,jm,Rm,Pm,Om,Dm,Uh,Ad,Ga,Sd,Um,Mm,Qv;const Va=class Va{constructor(){se(this,Mm);se(this,ia);se(this,Am);se(this,Sm);se(this,Tm);se(this,_m);se(this,km);se(this,Im);se(this,jm);se(this,Rm);se(this,Pm);se(this,Om);se(this,Dm);se(this,Uh);se(this,Ad);se(this,Ga);se(this,Sd);se(this,Um);V(this,ia,null),V(this,Am,null),V(this,Tm,0),V(this,_m,Fr),V(this,km,null),V(this,Im,null),V(this,jm,null),V(this,Sm,"0x"),V(this,Rm,Fr),V(this,Pm,Fr),V(this,Om,null),V(this,Dm,null),V(this,Uh,null),V(this,Ad,null),V(this,Ga,null),V(this,Sd,null),V(this,Um,null)}get type(){return R(this,ia)}set type(e){switch(e){case null:V(this,ia,null);break;case 0:case"legacy":V(this,ia,0);break;case 1:case"berlin":case"eip-2930":V(this,ia,1);break;case 2:case"london":case"eip-1559":V(this,ia,2);break;case 3:case"cancun":case"eip-4844":V(this,ia,3);break;case 4:case"pectra":case"eip-7702":V(this,ia,4);break;default:J(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=R(this,Am);return e==null&&this.type===3?fw:e}set to(e){V(this,Am,e==null?null:un(e))}get nonce(){return R(this,Tm)}set nonce(e){V(this,Tm,St(e,"value"))}get gasLimit(){return R(this,_m)}set gasLimit(e){V(this,_m,Je(e))}get gasPrice(){const e=R(this,km);return e==null&&(this.type===0||this.type===1)?Fr:e}set gasPrice(e){V(this,km,e==null?null:Je(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=R(this,Im);return e??(this.type===2||this.type===3?Fr:null)}set maxPriorityFeePerGas(e){V(this,Im,e==null?null:Je(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=R(this,jm);return e??(this.type===2||this.type===3?Fr:null)}set maxFeePerGas(e){V(this,jm,e==null?null:Je(e,"maxFeePerGas"))}get data(){return R(this,Sm)}set data(e){V(this,Sm,$e(e))}get value(){return R(this,Rm)}set value(e){V(this,Rm,Je(e,"value"))}get chainId(){return R(this,Pm)}set chainId(e){V(this,Pm,Je(e))}get signature(){return R(this,Om)||null}set signature(e){V(this,Om,e==null?null:Ti.from(e))}get accessList(){const e=R(this,Dm)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){V(this,Dm,e==null?null:If(e))}get authorizationList(){const e=R(this,Um)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){V(this,Um,e==null?null:e.map(n=>q$(n)))}get maxFeePerBlobGas(){const e=R(this,Uh);return e==null&&this.type===3?Fr:e}set maxFeePerBlobGas(e){V(this,Uh,e==null?null:Je(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=R(this,Ad);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){J(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let n=0;n<e.length;n++)J(Sn(e[n],32),"invalid blobVersionedHash",`value[${n}]`,e[n])}V(this,Ad,e)}get blobs(){return R(this,Sd)==null?null:R(this,Sd).map(e=>Object.assign({},e))}set blobs(e){if(e==null){V(this,Sd,null);return}const n=[],r=[];for(let s=0;s<e.length;s++){const i=e[s];if(TI(i)){ge(R(this,Ga),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=jt(i);if(J(o.length<=bA,"blob is too large",`blobs[${s}]`,i),o.length!==bA){const d=new Uint8Array(bA);d.set(o),o=d}const c=R(this,Ga).blobToKzgCommitment(o),l=$e(R(this,Ga).computeBlobKzgProof(o,c));n.push({data:$e(o),commitment:$e(c),proof:l}),r.push(J3(1,c))}else{const o=$e(i.commitment);n.push({data:$e(i.data),commitment:o,proof:$e(i.proof)}),r.push(J3(1,o))}}V(this,Sd,n),V(this,Ad,r)}get kzg(){return R(this,Ga)}set kzg(e){e==null?V(this,Ga,null):V(this,Ga,ute(e))}get hash(){return this.signature==null?null:vr(Ce(this,Mm,Qv).call(this,!0,!1))}get unsignedHash(){return vr(this.unsignedSerialized)}get from(){return this.signature==null?null:ite(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:pw.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return Ce(this,Mm,Qv).call(this,!0,!0)}get unsignedSerialized(){return Ce(this,Mm,Qv).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,n=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,s=R(this,Uh)!=null||R(this,Ad);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&ge(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),ge(!n||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),ge(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):n?i.push(2):e?(i.push(1),r||i.push(0)):r?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Va.from(this)}toJSON(){const e=n=>n==null?null:n.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new Va;if(typeof e=="string"){const r=jt(e);if(r[0]>=127)return Va.from(mte(r));switch(r[0]){case 1:return Va.from(xte(r));case 2:return Va.from(yte(r));case 3:return Va.from(vte(r));case 4:return Va.from(Cte(r))}ge(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const n=new Va;return e.type!=null&&(n.type=e.type),e.to!=null&&(n.to=e.to),e.nonce!=null&&(n.nonce=e.nonce),e.gasLimit!=null&&(n.gasLimit=e.gasLimit),e.gasPrice!=null&&(n.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(n.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(n.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(n.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(n.data=e.data),e.value!=null&&(n.value=e.value),e.chainId!=null&&(n.chainId=e.chainId),e.signature!=null&&(n.signature=Ti.from(e.signature)),e.accessList!=null&&(n.accessList=e.accessList),e.authorizationList!=null&&(n.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(n.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(n.kzg=e.kzg),e.blobs!=null&&(n.blobs=e.blobs),e.hash!=null&&(J(n.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),J(n.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(J(n.isSigned(),"unsigned transaction cannot define '.from'","tx",e),J(n.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),n}};ia=new WeakMap,Am=new WeakMap,Sm=new WeakMap,Tm=new WeakMap,_m=new WeakMap,km=new WeakMap,Im=new WeakMap,jm=new WeakMap,Rm=new WeakMap,Pm=new WeakMap,Om=new WeakMap,Dm=new WeakMap,Uh=new WeakMap,Ad=new WeakMap,Ga=new WeakMap,Sd=new WeakMap,Um=new WeakMap,Mm=new WeakSet,Qv=function(e,n){ge(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return gte(this,r);case 1:return bte(this,r);case 2:return wte(this,r);case 3:return Ete(this,r,n?this.blobs:null);case 4:return Nte(this,r)}ge(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let iE=Va;function hf(t){return vr(mc(t))}var Ate="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const Z3=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),X3=4;function Ste(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),s=1,i=[0,1];for(let E=1;E<r;E++)i.push(s+=n());let o=n(),c=e;e+=o;let l=0,d=0;function u(){return l==0&&(d=d<<8|t[e++],l=8),d>>--l&1}const h=31,f=2**h,p=f>>>1,m=p>>1,g=f-1;let y=0;for(let E=0;E<h;E++)y=y<<1|u();let x=[],w=0,b=f;for(;;){let E=Math.floor(((y-w+1)*s-1)/b),k=0,C=r;for(;C-k>1;){let I=k+C>>>1;E<i[I]?C=I:k=I}if(k==0)break;x.push(k);let S=w+Math.floor(b*i[k]/s),N=w+Math.floor(b*i[k+1]/s)-1;for(;!((S^N)&p);)y=y<<1&g|u(),S=S<<1&g,N=N<<1&g|1;for(;S&~N&m;)y=y&p|y<<1&g>>>1|u(),S=S<<1^p,N=(N^p)<<1|p|1;w=S,b=1+N-S}let v=r-4;return x.map(E=>{switch(E-v){case 3:return v+65792+(t[c++]<<16|t[c++]<<8|t[c++]);case 2:return v+256+(t[c++]<<8|t[c++]);case 1:return v+t[c++];default:return E-1}})}function Tte(t){let e=0;return()=>t[e++]}function K$(t){return Tte(Ste(_te(t)))}function _te(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let n=t.length,r=new Uint8Array(6*n>>3);for(let s=0,i=0,o=0,c=0;s<n;s++)c=c<<6|e[t.charCodeAt(s)],o+=6,o>=8&&(r[i++]=c>>(o-=8));return r}function kte(t){return t&1?~t>>1:t>>1}function Ite(t,e){let n=Array(t);for(let r=0,s=0;r<t;r++)n[r]=s+=kte(e());return n}function mw(t,e=0){let n=[];for(;;){let r=t(),s=t();if(!s)break;e+=r;for(let i=0;i<s;i++)n.push(e+i);e+=s+1}return n}function G$(t){return gw(()=>{let e=mw(t);if(e.length)return e})}function Y$(t){let e=[];for(;;){let n=t();if(n==0)break;e.push(jte(n,t))}for(;;){let n=t()-1;if(n<0)break;e.push(Rte(n,t))}return e.flat()}function gw(t){let e=[];for(;;){let n=t(e.length);if(!n)break;e.push(n)}return e}function Q$(t,e,n){let r=Array(t).fill().map(()=>[]);for(let s=0;s<e;s++)Ite(t,n).forEach((i,o)=>r[o].push(i));return r}function jte(t,e){let n=1+e(),r=e(),s=gw(e);return Q$(s.length,1+t,e).flatMap((o,c)=>{let[l,...d]=o;return Array(s[c]).fill().map((u,h)=>{let f=h*r;return[l+h*n,d.map(p=>p+f)]})})}function Rte(t,e){let n=1+e();return Q$(n,1+t,e).map(s=>[s[0],s.slice(1)])}function Pte(t){let e=[],n=mw(t);return s(r([]),[]),e;function r(i){let o=t(),c=gw(()=>{let l=mw(t).map(d=>n[d]);if(l.length)return r(l)});return{S:o,B:c,Q:i}}function s({S:i,B:o},c,l){if(!(i&4&&l===c[c.length-1])){i&2&&(l=c[c.length-1]),i&1&&e.push(c);for(let d of o)for(let u of d.Q)s(d,[...c,u],l)}}}function Ote(t){return t.toString(16).toUpperCase().padStart(2,"0")}function J$(t){return`{${Ote(t)}}`}function Dte(t){let e=[];for(let n=0,r=t.length;n<r;){let s=t.codePointAt(n);n+=s<65536?1:2,e.push(s)}return e}function xg(t){let n=t.length;if(n<4096)return String.fromCodePoint(...t);let r=[];for(let s=0;s<n;)r.push(String.fromCodePoint(...t.slice(s,s+=4096)));return r.join("")}function Ute(t,e){let n=t.length,r=n-e.length;for(let s=0;r==0&&s<n;s++)r=t[s]-e[s];return r}var Mte="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const yw=44032,oE=4352,aE=4449,cE=4519,Z$=19,X$=21,bg=28,lE=X$*bg,Lte=Z$*lE,Bte=yw+Lte,$te=oE+Z$,Fte=aE+X$,zte=cE+bg;function ty(t){return t>>24&255}function e8(t){return t&16777215}let mT,eO,gT,Jv;function Hte(){let t=K$(Mte);mT=new Map(G$(t).flatMap((e,n)=>e.map(r=>[r,n+1<<24]))),eO=new Set(mw(t)),gT=new Map,Jv=new Map;for(let[e,n]of Y$(t)){if(!eO.has(e)&&n.length==2){let[r,s]=n,i=Jv.get(r);i||(i=new Map,Jv.set(r,i)),i.set(s,e)}gT.set(e,n.reverse())}}function t8(t){return t>=yw&&t<Bte}function Vte(t,e){if(t>=oE&&t<$te&&e>=aE&&e<Fte)return yw+(t-oE)*lE+(e-aE)*bg;if(t8(t)&&e>cE&&e<zte&&(t-yw)%bg==0)return t+(e-cE);{let n=Jv.get(t);return n&&(n=n.get(e),n)?n:-1}}function n8(t){mT||Hte();let e=[],n=[],r=!1;function s(i){let o=mT.get(i);o&&(r=!0,i|=o),e.push(i)}for(let i of t)for(;;){if(i<128)e.push(i);else if(t8(i)){let o=i-yw,c=o/lE|0,l=o%lE/bg|0,d=o%bg;s(oE+c),s(aE+l),d>0&&s(cE+d)}else{let o=gT.get(i);o?n.push(...o):s(i)}if(!n.length)break;i=n.pop()}if(r&&e.length>1){let i=ty(e[0]);for(let o=1;o<e.length;o++){let c=ty(e[o]);if(c==0||i<=c){i=c;continue}let l=o-1;for(;;){let d=e[l+1];if(e[l+1]=e[l],e[l]=d,!l||(i=ty(e[--l]),i<=c))break}i=ty(e[o])}}return e}function Wte(t){let e=[],n=[],r=-1,s=0;for(let i of t){let o=ty(i),c=e8(i);if(r==-1)o==0?r=c:e.push(c);else if(s>0&&s>=o)o==0?(e.push(r,...n),n.length=0,r=c):n.push(c),s=o;else{let l=Vte(r,c);l>=0?r=l:s==0&&o==0?(e.push(r),r=c):(n.push(c),s=o)}}return r>=0&&e.push(r,...n),e}function r8(t){return n8(t).map(e8)}function qte(t){return Wte(n8(t))}const tO=45,s8=".",i8=65039,o8=1,dE=t=>Array.from(t);function ww(t,e){return t.P.has(e)||t.Q.has(e)}class Kte extends Array{get is_emoji(){return!0}}let yT,a8,hh,wT,c8,cm,vA,xp,zu,nO,xT;function UI(){if(yT)return;let t=K$(Ate);const e=()=>mw(t),n=()=>new Set(e()),r=(u,h)=>h.forEach(f=>u.add(f));yT=new Map(Y$(t)),a8=n(),hh=e(),wT=new Set(e().map(u=>hh[u])),hh=new Set(hh),c8=n(),n();let s=G$(t),i=t();const o=()=>{let u=new Set;return e().forEach(h=>r(u,s[h])),r(u,e()),u};cm=gw(u=>{let h=gw(t).map(f=>f+96);if(h.length){let f=u>=i;h[0]-=32,h=xg(h),f&&(h=`Restricted[${h}]`);let p=o(),m=o(),g=!t();return{N:h,P:p,Q:m,M:g,R:f}}}),vA=n(),xp=new Map;let c=e().concat(dE(vA)).sort((u,h)=>u-h);c.forEach((u,h)=>{let f=t(),p=c[h]=f?c[h-f]:{V:[],M:new Map};p.V.push(u),vA.has(u)||xp.set(u,p)});for(let{V:u,M:h}of new Set(xp.values())){let f=[];for(let m of u){let g=cm.filter(x=>ww(x,m)),y=f.find(({G:x})=>g.some(w=>x.has(w)));y||(y={G:new Set,V:[]},f.push(y)),y.V.push(m),r(y.G,g)}let p=f.flatMap(m=>dE(m.G));for(let{G:m,V:g}of f){let y=new Set(p.filter(x=>!m.has(x)));for(let x of g)h.set(x,y)}}zu=new Set;let l=new Set;const d=u=>zu.has(u)?l.add(u):zu.add(u);for(let u of cm){for(let h of u.P)d(h);for(let h of u.Q)d(h)}for(let u of zu)!xp.has(u)&&!l.has(u)&&xp.set(u,o8);r(zu,r8(zu)),nO=Pte(t).map(u=>Kte.from(u)).sort(Ute),xT=new Map;for(let u of nO){let h=[xT];for(let f of u){let p=h.map(m=>{let g=m.get(f);return g||(g=new Map,m.set(f,g)),g});f===i8?h.push(...p):h=p}for(let f of h)f.V=u}}function MI(t){return(l8(t)?"":`${LI(WC([t]))} `)+J$(t)}function LI(t){return`"${t}"`}function Gte(t){if(t.length>=4&&t[2]==tO&&t[3]==tO)throw new Error(`invalid label extension: "${xg(t.slice(0,4))}"`)}function Yte(t){for(let n=t.lastIndexOf(95);n>0;)if(t[--n]!==95)throw new Error("underscore allowed only at start")}function Qte(t){let e=t[0],n=Z3.get(e);if(n)throw vy(`leading ${n}`);let r=t.length,s=-1;for(let i=1;i<r;i++){e=t[i];let o=Z3.get(e);if(o){if(s==i)throw vy(`${n} + ${o}`);s=i+1,n=o}}if(s==r)throw vy(`trailing ${n}`)}function WC(t,e=1/0,n=J$){let r=[];Jte(t[0])&&r.push(""),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let s=0,i=t.length;for(let o=0;o<i;o++){let c=t[o];l8(c)&&(r.push(xg(t.slice(s,o))),r.push(n(c)),s=o+1)}return r.push(xg(t.slice(s,i))),r.join("")}function Jte(t){return UI(),hh.has(t)}function l8(t){return UI(),c8.has(t)}function Zte(t){return nne(Xte(t,qte,ine))}function Xte(t,e,n){if(!t)return[];UI();let r=0;return t.split(s8).map(s=>{let i=Dte(s),o={input:i,offset:r};r+=i.length+1;try{let c=o.tokens=sne(i,e,n),l=c.length,d;if(!l)throw new Error("empty label");let u=o.output=c.flat();if(Yte(u),!(o.emoji=l>1||c[0].is_emoji)&&u.every(f=>f<128))Gte(u),d="ASCII";else{let f=c.flatMap(p=>p.is_emoji?[]:p);if(!f.length)d="Emoji";else{if(hh.has(u[0]))throw vy("leading combining mark");for(let g=1;g<l;g++){let y=c[g];if(!y.is_emoji&&hh.has(y[0]))throw vy(`emoji + combining mark: "${xg(c[g-1])} + ${WC([y[0]])}"`)}Qte(u);let p=dE(new Set(f)),[m]=tne(p);rne(m,f),ene(m,p),d=m.N}}o.type=d}catch(c){o.error=c}return o})}function ene(t,e){let n,r=[];for(let s of e){let i=xp.get(s);if(i===o8)return;if(i){let o=i.M.get(s);if(n=n?n.filter(c=>o.has(c)):dE(o),!n.length)return}else r.push(s)}if(n){for(let s of n)if(r.every(i=>ww(s,i)))throw new Error(`whole-script confusable: ${t.N}/${s.N}`)}}function tne(t){let e=cm;for(let n of t){let r=e.filter(s=>ww(s,n));if(!r.length)throw cm.some(s=>ww(s,n))?u8(e[0],n):d8(n);if(e=r,r.length==1)break}return e}function nne(t){return t.map(({input:e,error:n,output:r})=>{if(n){let s=n.message;throw new Error(t.length==1?s:`Invalid label ${LI(WC(e,63))}: ${s}`)}return xg(r)}).join(s8)}function d8(t){return new Error(`disallowed character: ${MI(t)}`)}function u8(t,e){let n=MI(e),r=cm.find(s=>s.P.has(e));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${t.N} + ${n}`)}function vy(t){return new Error(`illegal placement: ${t}`)}function rne(t,e){for(let n of e)if(!ww(t,n))throw u8(t,n);if(t.M){let n=r8(e);for(let r=1,s=n.length;r<s;r++)if(wT.has(n[r])){let i=r+1;for(let o;i<s&&wT.has(o=n[i]);i++)for(let c=r;c<i;c++)if(n[c]==o)throw new Error(`duplicate non-spacing marks: ${MI(o)}`);if(i-r>X3)throw new Error(`excessive non-spacing marks: ${LI(WC(n.slice(r-1,i)))} (${i-r}/${X3})`);r=i}}}function sne(t,e,n){let r=[],s=[];for(t=t.slice().reverse();t.length;){let i=one(t);if(i)s.length&&(r.push(e(s)),s=[]),r.push(n(i));else{let o=t.pop();if(zu.has(o))s.push(o);else{let c=yT.get(o);if(c)s.push(...c);else if(!a8.has(o))throw d8(o)}}}return s.length&&r.push(e(s)),r}function ine(t){return t.filter(e=>e!=i8)}function one(t,e){let n=xT,r,s=t.length;for(;s&&(n=n.get(t[--s]),!!n);){let{V:i}=n;i&&(r=i,t.length=s)}return r}const h8=new Uint8Array(32);h8.fill(0);function rO(t){return J(t.length!==0,"invalid ENS name; empty component","comp",t),t}function f8(t){const e=mc(ane(t)),n=[];if(t.length===0)return n;let r=0;for(let s=0;s<e.length;s++)e[s]===46&&(n.push(rO(e.slice(r,s))),r=s+1);return J(r<e.length,"invalid ENS name; empty component","name",t),n.push(rO(e.slice(r))),n}function ane(t){try{if(t.length===0)throw new Error("empty label");return Zte(t)}catch(e){J(!1,`invalid ENS name (${e.message})`,"name",t)}}function bT(t){J(typeof t=="string","invalid ENS name; not a string","name",t),J(t.length,"invalid ENS name (empty label)","name",t);let e=h8;const n=f8(t);for(;n.length;)e=vr(ir([e,vr(n.pop())]));return $e(e)}function cne(t,e){const n=e;return J(n<=255,"DNS encoded label cannot exceed 255","length",n),$e(ir(f8(t).map(r=>{J(r.length<=n,`label ${JSON.stringify(t)} exceeds ${n} bytes`,"name",t);const s=new Uint8Array(r.length+1);return s.set(r,1),s[0]=s.length-1,s})))+"00"}const p8=new Uint8Array(32);p8.fill(0);const lne=BigInt(-1),m8=BigInt(0),g8=BigInt(1),dne=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function une(t){const e=jt(t),n=e.length%32;return n?ir([e,p8.slice(n)]):$e(e)}const hne=ou(g8,32),fne=ou(m8,32),sO={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},EA=["name","version","chainId","verifyingContract","salt"];function iO(t){return function(e){return J(typeof e=="string",`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const pne={name:iO("name"),version:iO("version"),chainId:function(t){const e=Je(t,"domain.chainId");return J(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):ha(e)},verifyingContract:function(t){try{return un(t).toLowerCase()}catch{}J(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=jt(t,"domain.salt");return J(e.length===32,'invalid domain value "salt"',"domain.salt",t),$e(e)}};function CA(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const n=e[1]==="",r=parseInt(e[2]);J(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",t);const s=dh(dne,n?r-1:r),i=n?(s+g8)*lne:m8;return function(o){const c=Je(o,"value");return J(c>=i&&c<=s,`value out-of-bounds for ${t}`,"value",c),ou(n?e$(c,256):c,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return J(n!==0&&n<=32&&e[1]===String(n),"invalid bytes width","type",t),function(r){const s=jt(r);return J(s.length===n,`invalid length for ${t}`,"value",r),une(r)}}}switch(t){case"address":return function(e){return _l(un(e),32)};case"bool":return function(e){return e?hne:fne};case"bytes":return function(e){return vr(e)};case"string":return function(e){return hf(e)}}return null}function oO(t,e){return`${t}(${e.map(({name:n,type:r})=>r+" "+n).join(",")})`}function Kb(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}var _x,nl,Lm,tC,y8;const mo=class mo{constructor(e){se(this,tC);G(this,"primaryType");se(this,_x);se(this,nl);se(this,Lm);V(this,nl,new Map),V(this,Lm,new Map);const n=new Map,r=new Map,s=new Map,i={};Object.keys(e).forEach(l=>{i[l]=e[l].map(({name:d,type:u})=>{let{base:h,index:f}=Kb(u);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:d,type:h+(f||"")}}),n.set(l,new Set),r.set(l,[]),s.set(l,new Set)}),V(this,_x,JSON.stringify(i));for(const l in i){const d=new Set;for(const u of i[l]){J(!d.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(l)}`,"types",e),d.add(u.name);const h=Kb(u.type).base;J(h!==l,`circular type reference to ${JSON.stringify(h)}`,"types",e),!CA(h)&&(J(r.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),r.get(h).push(l),n.get(l).add(h))}}const o=Array.from(r.keys()).filter(l=>r.get(l).length===0);J(o.length!==0,"missing primary type","types",e),J(o.length===1,`ambiguous primary types or unused types: ${o.map(l=>JSON.stringify(l)).join(", ")}`,"types",e),wt(this,{primaryType:o[0]});function c(l,d){J(!d.has(l),`circular type reference to ${JSON.stringify(l)}`,"types",e),d.add(l);for(const u of n.get(l))if(r.has(u)){c(u,d);for(const h of d)s.get(h).add(u)}d.delete(l)}c(this.primaryType,new Set);for(const[l,d]of s){const u=Array.from(d);u.sort(),R(this,nl).set(l,oO(l,i[l])+u.map(h=>oO(h,i[h])).join(""))}}get types(){return JSON.parse(R(this,_x))}getEncoder(e){let n=R(this,Lm).get(e);return n||(n=Ce(this,tC,y8).call(this,e),R(this,Lm).set(e,n)),n}encodeType(e){const n=R(this,nl).get(e);return J(n,`unknown type: ${JSON.stringify(e)}`,"name",e),n}encodeData(e,n){return this.getEncoder(e)(n)}hashStruct(e,n){return vr(this.encodeData(e,n))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,n,r){if(CA(e))return r(e,n);const s=Kb(e).array;if(s)return J(s.count===-1||s.count===n.length,`array length mismatch; expected length ${s.count}`,"value",n),n.map(o=>this._visit(s.prefix,o,r));const i=this.types[e];if(i)return i.reduce((o,{name:c,type:l})=>(o[c]=this._visit(l,n[c],r),o),{});J(!1,`unknown type: ${e}`,"type",e)}visit(e,n){return this._visit(this.primaryType,e,n)}static from(e){return new mo(e)}static getPrimaryType(e){return mo.from(e).primaryType}static hashStruct(e,n,r){return mo.from(n).hashStruct(e,r)}static hashDomain(e){const n=[];for(const r in e){if(e[r]==null)continue;const s=sO[r];J(s,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),n.push({name:r,type:s})}return n.sort((r,s)=>EA.indexOf(r.name)-EA.indexOf(s.name)),mo.hashStruct("EIP712Domain",{EIP712Domain:n},e)}static encode(e,n,r){return ir(["0x1901",mo.hashDomain(e),mo.from(n).hash(r)])}static hash(e,n,r){return vr(mo.encode(e,n,r))}static async resolveNames(e,n,r,s){e=Object.assign({},e);for(const c in e)e[c]==null&&delete e[c];const i={};e.verifyingContract&&!Sn(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=mo.from(n);o.visit(r,(c,l)=>(c==="address"&&!Sn(l,20)&&(i[l]="0x"),l));for(const c in i)i[c]=await s(c);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),r=o.visit(r,(c,l)=>c==="address"&&i[l]?i[l]:l),{domain:e,value:r}}static getPayload(e,n,r){mo.hashDomain(e);const s={},i=[];EA.forEach(l=>{const d=e[l];d!=null&&(s[l]=pne[l](d),i.push({name:l,type:sO[l]}))});const o=mo.from(n);n=o.types;const c=Object.assign({},n);return J(c.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",n),c.EIP712Domain=i,o.encode(r),{types:c,domain:s,primaryType:o.primaryType,message:o.visit(r,(l,d)=>{if(l.match(/^bytes(\d*)/))return $e(jt(d));if(l.match(/^u?int/))return Je(d).toString();switch(l){case"address":return d.toLowerCase();case"bool":return!!d;case"string":return J(typeof d=="string","invalid string","value",d),d}J(!1,"unsupported type","type",l)})}}};_x=new WeakMap,nl=new WeakMap,Lm=new WeakMap,tC=new WeakSet,y8=function(e){{const s=CA(e);if(s)return s}const n=Kb(e).array;if(n){const s=n.prefix,i=this.getEncoder(s);return o=>{J(n.count===-1||n.count===o.length,`array length mismatch; expected length ${n.count}`,"value",o);let c=o.map(i);return R(this,nl).has(s)&&(c=c.map(vr)),vr(ir(c))}}const r=this.types[e];if(r){const s=hf(R(this,nl).get(e));return i=>{const o=r.map(({name:c,type:l})=>{const d=this.getEncoder(l)(i[c]);return R(this,nl).has(l)?vr(d):d});return o.unshift(s),ir(o)}}J(!1,`unknown type: ${e}`,"type",e)};let uE=mo;function Vs(t){const e=new Set;return t.forEach(n=>e.add(n)),Object.freeze(e)}const mne="external public payable override",gne=Vs(mne.split(" ")),w8="constant external internal payable private public pure view override",yne=Vs(w8.split(" ")),x8="constructor error event fallback function receive struct",b8=Vs(x8.split(" ")),v8="calldata memory storage payable indexed",wne=Vs(v8.split(" ")),xne="tuple returns",bne=[x8,v8,xne,w8].join(" "),vne=Vs(bne.split(" ")),Ene={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Cne=new RegExp("^(\\s*)"),Nne=new RegExp("^([0-9]+)"),Ane=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),E8=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),C8=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var Xr,oa,kx,vT;const nC=class nC{constructor(e){se(this,kx);se(this,Xr);se(this,oa);V(this,Xr,0),V(this,oa,e.slice())}get offset(){return R(this,Xr)}get length(){return R(this,oa).length-R(this,Xr)}clone(){return new nC(R(this,oa))}reset(){V(this,Xr,0)}popKeyword(e){const n=this.peek();if(n.type!=="KEYWORD"||!e.has(n.text))throw new Error(`expected keyword ${n.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const n=this.peek();throw new Error(`expected ${e}; got ${n.type} ${JSON.stringify(n.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=Ce(this,kx,vT).call(this,R(this,Xr)+1,e.match+1);return V(this,Xr,e.match+1),n}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=[];for(;R(this,Xr)<e.match-1;){const r=this.peek().linkNext;n.push(Ce(this,kx,vT).call(this,R(this,Xr)+1,r)),V(this,Xr,r)}return V(this,Xr,e.match+1),n}peek(){if(R(this,Xr)>=R(this,oa).length)throw new Error("out-of-bounds");return R(this,oa)[R(this,Xr)]}peekKeyword(e){const n=this.peekType("KEYWORD");return n!=null&&e.has(n)?n:null}peekType(e){if(this.length===0)return null;const n=this.peek();return n.type===e?n.text:null}pop(){const e=this.peek();return d0(this,Xr)._++,e}toString(){const e=[];for(let n=R(this,Xr);n<R(this,oa).length;n++){const r=R(this,oa)[n];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};Xr=new WeakMap,oa=new WeakMap,kx=new WeakSet,vT=function(e=0,n=0){return new nC(R(this,oa).slice(e,n).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let Aa=nC;function Cu(t){const e=[],n=o=>{const c=i<t.length?JSON.stringify(t[i]):"$EOI";throw new Error(`invalid token ${c} at ${i}: ${o}`)};let r=[],s=[],i=0;for(;i<t.length;){let o=t.substring(i),c=o.match(Cne);c&&(i+=c[1].length,o=t.substring(i));const l={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(l);let d=Ene[o[0]]||"";if(d){if(l.type=d,l.text=o[0],i++,d==="OPEN_PAREN")r.push(e.length-1),s.push(e.length-1);else if(d=="CLOSE_PAREN")r.length===0&&n("no matching open bracket"),l.match=r.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1;else if(d==="COMMA")l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(d==="OPEN_BRACKET")l.type="BRACKET";else if(d==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;u=h+u,e[e.length-1].value=St(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(c=o.match(Ane),c){if(l.text=c[1],i+=l.text.length,vne.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(C8)){l.type="TYPE";continue}l.type="ID";continue}if(c=o.match(Nne),c){l.text=c[1],l.type="NUMBER",i+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Aa(e.map(o=>Object.freeze(o)))}function aO(t,e){let n=[];for(const r in e.keys())t.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function qC(t,e){if(e.peekKeyword(b8)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function Il(t,e){const n=new Set;for(;;){const r=t.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(t.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function N8(t){let e=Il(t,yne);return aO(e,Vs("constant payable nonpayable".split(" "))),aO(e,Vs("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function xl(t,e){return t.popParams().map(n=>os.from(n,e))}function A8(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return Je(t.pop().text);throw new Error("invalid gas")}return null}function ff(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const Sne=new RegExp(/^(.*)\[([0-9]*)\]$/);function cO(t){const e=t.match(C8);if(J(e,"invalid type","type",t),t==="uint")return"uint256";if(t==="int")return"int256";if(e[2]){const n=parseInt(e[2]);J(n!==0&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);J(n!==0&&n<=256&&n%8===0,"invalid numeric width","type",t)}return t}const Gn={},ki=Symbol.for("_ethers_internal"),lO="_ParamTypeInternal",dO="_ErrorInternal",uO="_EventInternal",hO="_ConstructorInternal",fO="_FallbackInternal",pO="_FunctionInternal",mO="_StructInternal";var Bm,Zv;const go=class go{constructor(e,n,r,s,i,o,c,l){se(this,Bm);G(this,"name");G(this,"type");G(this,"baseType");G(this,"indexed");G(this,"components");G(this,"arrayLength");G(this,"arrayChildren");if(qx(e,Gn,"ParamType"),Object.defineProperty(this,ki,{value:lO}),o&&(o=Object.freeze(o.slice())),s==="array"){if(c==null||l==null)throw new Error("")}else if(c!=null||l!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");wt(this,{name:n,type:r,baseType:s,indexed:i,components:o,arrayLength:c,arrayChildren:l})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=r,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let n="";return this.isArray()?(n+=this.arrayChildren.format(e),n+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?n+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":n+=this.type,e!=="sighash"&&(this.indexed===!0&&(n+=" indexed"),e==="full"&&this.name&&(n+=" "+this.name)),n}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,n){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(s=>r.arrayChildren.walk(s,n))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((s,i)=>r.components[i].walk(s,n))}return n(this.type,e)}async walkAsync(e,n){const r=[],s=[e];return Ce(this,Bm,Zv).call(this,r,e,n,i=>{s[0]=i}),r.length&&await Promise.all(r),s[0]}static from(e,n){if(go.isParamType(e))return e;if(typeof e=="string")try{return go.from(Cu(e),n)}catch{J(!1,"invalid param type","obj",e)}else if(e instanceof Aa){let c="",l="",d=null;Il(e,Vs(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(l="tuple",d=e.popParams().map(g=>go.from(g)),c=`tuple(${d.map(g=>g.format()).join(",")})`):(c=cO(e.popType("TYPE")),l=c);let u=null,h=null;for(;e.length&&e.peekType("BRACKET");){const g=e.pop();u=new go(Gn,"",c,l,null,d,h,u),h=g.value,c+=g.text,l="array",d=null}let f=null;if(Il(e,wne).has("indexed")){if(!n)throw new Error("");f=!0}const m=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new go(Gn,m,c,l,f,d,h,u)}const r=e.name;J(!r||typeof r=="string"&&r.match(E8),"invalid name","obj.name",r);let s=e.indexed;s!=null&&(J(n,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(Sne);if(o){const c=parseInt(o[2]||"-1"),l=go.from({type:o[1],components:e.components});return new go(Gn,r||"",i,"array",s,null,c,l)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const c=e.components!=null?e.components.map(d=>go.from(d)):null;return new go(Gn,r||"",i,"tuple",s,c,null,null)}return i=cO(e.type),new go(Gn,r||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[ki]===lO}};Bm=new WeakSet,Zv=function(e,n,r,s){if(this.isArray()){if(!Array.isArray(n))throw new Error("invalid array value");if(this.arrayLength!==-1&&n.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,c=n.slice();c.forEach((l,d)=>{var u;Ce(u=o,Bm,Zv).call(u,e,l,r,h=>{c[d]=h})}),s(c);return}if(this.isTuple()){const o=this.components;let c;if(Array.isArray(n))c=n.slice();else{if(n==null||typeof n!="object")throw new Error("invalid tuple value");c=o.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in n))throw new Error(`missing value for component ${l.name}`);return n[l.name]})}if(c.length!==this.components.length)throw new Error("array is wrong length");c.forEach((l,d)=>{var u;Ce(u=o[d],Bm,Zv).call(u,e,l,r,h=>{c[d]=h})}),s(c);return}const i=r(this.type,n);i.then?e.push(async function(){s(await i)}()):s(i)};let os=go;class pf{constructor(e,n,r){G(this,"type");G(this,"inputs");qx(e,Gn,"Fragment"),r=Object.freeze(r.slice()),wt(this,{type:n,inputs:r})}static from(e){if(typeof e=="string"){try{pf.from(JSON.parse(e))}catch{}return pf.from(Cu(e))}if(e instanceof Aa)switch(e.peekKeyword(b8)){case"constructor":return pl.from(e);case"error":return xi.from(e);case"event":return sc.from(e);case"fallback":case"receive":return Qc.from(e);case"function":return ic.from(e);case"struct":return Gh.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return pl.from(e);case"error":return xi.from(e);case"event":return sc.from(e);case"fallback":case"receive":return Qc.from(e);case"function":return ic.from(e);case"struct":return Gh.from(e)}ge(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}J(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return pl.isFragment(e)}static isError(e){return xi.isFragment(e)}static isEvent(e){return sc.isFragment(e)}static isFunction(e){return ic.isFragment(e)}static isStruct(e){return Gh.isFragment(e)}}class KC extends pf{constructor(n,r,s,i){super(n,r,i);G(this,"name");J(typeof s=="string"&&s.match(E8),"invalid identifier","name",s),i=Object.freeze(i.slice()),wt(this,{name:s})}}function xw(t,e){return"("+e.map(n=>n.format(t)).join(t==="full"?", ":",")+")"}class xi extends KC{constructor(e,n,r){super(e,"error",n,r),Object.defineProperty(this,ki,{value:dO})}get selector(){return hf(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("error"),n.push(this.name+xw(e,this.inputs)),n.join(" ")}static from(e){if(xi.isFragment(e))return e;if(typeof e=="string")return xi.from(Cu(e));if(e instanceof Aa){const n=qC("error",e),r=xl(e);return ff(e),new xi(Gn,n,r)}return new xi(Gn,e.name,e.inputs?e.inputs.map(os.from):[])}static isFragment(e){return e&&e[ki]===dO}}class sc extends KC{constructor(n,r,s,i){super(n,"event",r,s);G(this,"anonymous");Object.defineProperty(this,ki,{value:uO}),wt(this,{anonymous:i})}get topicHash(){return hf(this.format("sighash"))}format(n){if(n==null&&(n="sighash"),n==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(n)))});const r=[];return n!=="sighash"&&r.push("event"),r.push(this.name+xw(n,this.inputs)),n!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(n,r){return r=(r||[]).map(i=>os.from(i)),new sc(Gn,n,r,!1).topicHash}static from(n){if(sc.isFragment(n))return n;if(typeof n=="string")try{return sc.from(Cu(n))}catch{J(!1,"invalid event fragment","obj",n)}else if(n instanceof Aa){const r=qC("event",n),s=xl(n,!0),i=!!Il(n,Vs(["anonymous"])).has("anonymous");return ff(n),new sc(Gn,r,s,i)}return new sc(Gn,n.name,n.inputs?n.inputs.map(r=>os.from(r,!0)):[],!!n.anonymous)}static isFragment(n){return n&&n[ki]===uO}}class pl extends pf{constructor(n,r,s,i,o){super(n,r,s);G(this,"payable");G(this,"gas");Object.defineProperty(this,ki,{value:hO}),wt(this,{payable:i,gas:o})}format(n){if(ge(n!=null&&n!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),n==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(n)))});const r=[`constructor${xw(n,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(n){if(pl.isFragment(n))return n;if(typeof n=="string")try{return pl.from(Cu(n))}catch{J(!1,"invalid constuctor fragment","obj",n)}else if(n instanceof Aa){Il(n,Vs(["constructor"]));const r=xl(n),s=!!Il(n,gne).has("payable"),i=A8(n);return ff(n),new pl(Gn,"constructor",r,s,i)}return new pl(Gn,"constructor",n.inputs?n.inputs.map(os.from):[],!!n.payable,n.gas!=null?n.gas:null)}static isFragment(n){return n&&n[ki]===hO}}class Qc extends pf{constructor(n,r,s){super(n,"fallback",r);G(this,"payable");Object.defineProperty(this,ki,{value:fO}),wt(this,{payable:s})}format(n){const r=this.inputs.length===0?"receive":"fallback";if(n==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:s})}return`${r}()${this.payable?" payable":""}`}static from(n){if(Qc.isFragment(n))return n;if(typeof n=="string")try{return Qc.from(Cu(n))}catch{J(!1,"invalid fallback fragment","obj",n)}else if(n instanceof Aa){const r=n.toString(),s=n.peekKeyword(Vs(["fallback","receive"]));if(J(s,"type must be fallback or receive","obj",r),n.popKeyword(Vs(["fallback","receive"]))==="receive"){const l=xl(n);return J(l.length===0,"receive cannot have arguments","obj.inputs",l),Il(n,Vs(["payable"])),ff(n),new Qc(Gn,[],!0)}let o=xl(n);o.length?J(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(l=>l.format("minimal")).join(", ")):o=[os.from("bytes")];const c=N8(n);if(J(c==="nonpayable"||c==="payable","fallback cannot be constants","obj.stateMutability",c),Il(n,Vs(["returns"])).has("returns")){const l=xl(n);J(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(d=>d.format("minimal")).join(", "))}return ff(n),new Qc(Gn,o,c==="payable")}if(n.type==="receive")return new Qc(Gn,[],!0);if(n.type==="fallback"){const r=[os.from("bytes")],s=n.stateMutability==="payable";return new Qc(Gn,r,s)}J(!1,"invalid fallback description","obj",n)}static isFragment(n){return n&&n[ki]===fO}}class ic extends KC{constructor(n,r,s,i,o,c){super(n,"function",r,i);G(this,"constant");G(this,"outputs");G(this,"stateMutability");G(this,"payable");G(this,"gas");Object.defineProperty(this,ki,{value:pO}),o=Object.freeze(o.slice()),wt(this,{constant:s==="view"||s==="pure",gas:c,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return hf(this.format("sighash")).substring(0,10)}format(n){if(n==null&&(n="sighash"),n==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(n))),outputs:this.outputs.map(s=>JSON.parse(s.format(n)))});const r=[];return n!=="sighash"&&r.push("function"),r.push(this.name+xw(n,this.inputs)),n!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(xw(n,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(n,r){return r=(r||[]).map(i=>os.from(i)),new ic(Gn,n,"view",r,[],null).selector}static from(n){if(ic.isFragment(n))return n;if(typeof n=="string")try{return ic.from(Cu(n))}catch{J(!1,"invalid function fragment","obj",n)}else if(n instanceof Aa){const s=qC("function",n),i=xl(n),o=N8(n);let c=[];Il(n,Vs(["returns"])).has("returns")&&(c=xl(n));const l=A8(n);return ff(n),new ic(Gn,s,o,i,c,l)}let r=n.stateMutability;return r==null&&(r="payable",typeof n.constant=="boolean"?(r="view",n.constant||(r="payable",typeof n.payable=="boolean"&&!n.payable&&(r="nonpayable"))):typeof n.payable=="boolean"&&!n.payable&&(r="nonpayable")),new ic(Gn,n.name,r,n.inputs?n.inputs.map(os.from):[],n.outputs?n.outputs.map(os.from):[],n.gas!=null?n.gas:null)}static isFragment(n){return n&&n[ki]===pO}}class Gh extends KC{constructor(e,n,r){super(e,"struct",n,r),Object.defineProperty(this,ki,{value:mO})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Gh.from(Cu(e))}catch{J(!1,"invalid struct fragment","obj",e)}else if(e instanceof Aa){const n=qC("struct",e),r=xl(e);return ff(e),new Gh(Gn,n,r)}return new Gh(Gn,e.name,e.inputs?e.inputs.map(os.from):[])}static isFragment(e){return e&&e[ki]===mO}}const Ta=new Map;Ta.set(0,"GENERIC_PANIC");Ta.set(1,"ASSERT_FALSE");Ta.set(17,"OVERFLOW");Ta.set(18,"DIVIDE_BY_ZERO");Ta.set(33,"ENUM_RANGE_ERROR");Ta.set(34,"BAD_STORAGE_DATA");Ta.set(49,"STACK_UNDERFLOW");Ta.set(50,"ARRAY_RANGE_ERROR");Ta.set(65,"OUT_OF_MEMORY");Ta.set(81,"UNINITIALIZED_FUNCTION_CALL");const Tne=new RegExp(/^bytes([0-9]*)$/),_ne=new RegExp(/^(u?int)([0-9]*)$/);let NA=null,gO=1024;function kne(t,e,n,r){let s="missing revert data",i=null;const o=null;let c=null;if(n){s="execution reverted";const d=jt(n);if(n=$e(n),d.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(d.length%32!==4)s+=" (could not decode reason; invalid data length)";else if($e(d.slice(0,4))==="0x08c379a0")try{i=r.decode(["string"],d.slice(4))[0],c={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if($e(d.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],d.slice(4))[0]);c={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${Ta.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const l={to:e.to?un(e.to):null,data:e.data||"0x"};return e.from&&(l.from=un(e.from)),Bn(s,"CALL_EXCEPTION",{action:t,data:n,reason:i,transaction:l,invocation:o,revert:c})}var Td,bp;const rC=class rC{constructor(){se(this,Td)}getDefaultValue(e){const n=e.map(s=>Ce(this,Td,bp).call(this,os.from(s)));return new qb(n,"_").defaultValue()}encode(e,n){JB(n.length,e.length,"types/values length mismatch");const r=e.map(o=>Ce(this,Td,bp).call(this,os.from(o))),s=new qb(r,"_"),i=new aT;return s.encode(i,n),i.data}decode(e,n,r){const s=e.map(o=>Ce(this,Td,bp).call(this,os.from(o)));return new qb(s,"_").decode(new cT(n,r,gO))}static _setDefaultMaxInflation(e){J(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),gO=e}static defaultAbiCoder(){return NA==null&&(NA=new rC),NA}static getBuiltinCallException(e,n,r){return kne(e,n,r,rC.defaultAbiCoder())}};Td=new WeakSet,bp=function(e){if(e.isArray())return new Kee(Ce(this,Td,bp).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new qb(e.components.map(r=>Ce(this,Td,bp).call(this,r)),e.name);switch(e.baseType){case"address":return new Wee(e.name);case"bool":return new Gee(e.name);case"string":return new rte(e.name);case"bytes":return new Yee(e.name);case"":return new Zee(e.name)}let n=e.type.match(_ne);if(n){let r=parseInt(n[2]||"256");return J(r!==0&&r<=256&&r%8===0,"invalid "+n[1]+" bit length","param",e),new nte(r/8,n[1]==="int",e.name)}if(n=e.type.match(Tne),n){let r=parseInt(n[1]);return J(r!==0&&r<=32,"invalid bytes length","param",e),new Qee(r,e.name)}J(!1,"invalid type","type",e.type)};let bw=rC;class Ine{constructor(e,n,r){G(this,"fragment");G(this,"name");G(this,"signature");G(this,"topic");G(this,"args");const s=e.name,i=e.format();wt(this,{fragment:e,name:s,signature:i,topic:n,args:r})}}class jne{constructor(e,n,r,s){G(this,"fragment");G(this,"name");G(this,"args");G(this,"signature");G(this,"selector");G(this,"value");const i=e.name,o=e.format();wt(this,{fragment:e,name:i,args:r,signature:o,selector:n,value:s})}}class Rne{constructor(e,n,r){G(this,"fragment");G(this,"name");G(this,"args");G(this,"signature");G(this,"selector");const s=e.name,i=e.format();wt(this,{fragment:e,name:s,args:r,signature:i,selector:n})}}class yO{constructor(e){G(this,"hash");G(this,"_isIndexed");wt(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const wO={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},xO={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&wO[t.toString()]&&(e=wO[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};var Ya,Qa,Ja,As,Nc,Xv,e1;const th=class th{constructor(e){se(this,Nc);G(this,"fragments");G(this,"deploy");G(this,"fallback");G(this,"receive");se(this,Ya);se(this,Qa);se(this,Ja);se(this,As);let n=[];typeof e=="string"?n=JSON.parse(e):n=e,V(this,Ja,new Map),V(this,Ya,new Map),V(this,Qa,new Map);const r=[];for(const o of n)try{r.push(pf.from(o))}catch(c){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,c.message)}wt(this,{fragments:Object.freeze(r)});let s=null,i=!1;V(this,As,this.getAbiCoder()),this.fragments.forEach((o,c)=>{let l;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}wt(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(J(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${c}]`,o),s=o,i=s.payable);return;case"function":l=R(this,Ja);break;case"event":l=R(this,Qa);break;case"error":l=R(this,Ya);break;default:return}const d=o.format();l.has(d)||l.set(d,o)}),this.deploy||wt(this,{deploy:pl.from("constructor()")}),wt(this,{fallback:s,receive:i})}format(e){const n=e?"minimal":"full";return this.fragments.map(s=>s.format(n))}formatJson(){const e=this.fragments.map(n=>n.format("json"));return JSON.stringify(e.map(n=>JSON.parse(n)))}getAbiCoder(){return bw.defaultAbiCoder()}getFunctionName(e){const n=Ce(this,Nc,Xv).call(this,e,null,!1);return J(n,"no matching function","key",e),n.name}hasFunction(e){return!!Ce(this,Nc,Xv).call(this,e,null,!1)}getFunction(e,n){return Ce(this,Nc,Xv).call(this,e,n||null,!0)}forEachFunction(e){const n=Array.from(R(this,Ja).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(R(this,Ja).get(s),r)}}getEventName(e){const n=Ce(this,Nc,e1).call(this,e,null,!1);return J(n,"no matching event","key",e),n.name}hasEvent(e){return!!Ce(this,Nc,e1).call(this,e,null,!1)}getEvent(e,n){return Ce(this,Nc,e1).call(this,e,n||null,!0)}forEachEvent(e){const n=Array.from(R(this,Qa).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(R(this,Qa).get(s),r)}}getError(e,n){if(Sn(e)){const s=e.toLowerCase();if(xO[s])return xi.from(xO[s].signature);for(const i of R(this,Ya).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of R(this,Ya))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?xi.from("error Error(string)"):e==="Panic"?xi.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");J(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=xi.from(e).format(),e==="Error(string)")return xi.from("error Error(string)");if(e==="Panic(uint256)")return xi.from("error Panic(uint256)");const r=R(this,Ya).get(e);return r||null}forEachError(e){const n=Array.from(R(this,Ya).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(R(this,Ya).get(s),r)}}_decodeParams(e,n){return R(this,As).decode(e,n)}_encodeParams(e,n){return R(this,As).encode(e,n)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);J(r,"unknown error","fragment",e),e=r}return J(Xn(n,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",n),this._decodeParams(e.inputs,Xn(n,4))}encodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);J(r,"unknown error","fragment",e),e=r}return ir([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);J(r,"unknown function","fragment",e),e=r}return J(Xn(n,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",n),this._decodeParams(e.inputs,Xn(n,4))}encodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);J(r,"unknown function","fragment",e),e=r}return ir([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionResult(e,n){if(typeof e=="string"){const i=this.getFunction(e);J(i,"unknown function","fragment",e),e=i}let r="invalid length for result data";const s=Fs(n);if(s.length%32===0)try{return R(this,As).decode(e.outputs,s)}catch{r="could not decode result data"}ge(!1,r,"BAD_DATA",{value:$e(s),info:{method:e.name,signature:e.format()}})}makeError(e,n){const r=jt(e,"data"),s=bw.getBuiltinCallException("call",n,r);if(s.message.startsWith("execution reverted (unknown custom error)")){const c=$e(r.slice(0,4)),l=this.getError(c);if(l)try{const d=R(this,As).decode(l.inputs,r.slice(4));s.revert={name:l.name,signature:l.format(),args:d},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(n);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,n){if(typeof e=="string"){const r=this.getFunction(e);J(r,"unknown function","fragment",e),e=r}return $e(R(this,As).encode(e.outputs,n||[]))}encodeFilterTopics(e,n){if(typeof e=="string"){const i=this.getEvent(e);J(i,"unknown event","eventFragment",e),e=i}ge(n.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:n.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const s=(i,o)=>i.type==="string"?hf(o):i.type==="bytes"?vr($e(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=ou(o):i.type.match(/^bytes/)?o=YZ(o,32):i.type==="address"&&R(this,As).encode(["address"],[o]),_l($e(o),32));for(n.forEach((i,o)=>{const c=e.inputs[o];if(!c.indexed){J(i==null,"cannot filter non-indexed parameters; must be null","contract."+c.name,i);return}i==null?r.push(null):c.baseType==="array"||c.baseType==="tuple"?J(!1,"filtering with tuples or arrays not supported","contract."+c.name,i):Array.isArray(i)?r.push(i.map(l=>s(c,l))):r.push(s(c,i))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,n){if(typeof e=="string"){const o=this.getEvent(e);J(o,"unknown event","eventFragment",e),e=o}const r=[],s=[],i=[];return e.anonymous||r.push(e.topicHash),J(n.length===e.inputs.length,"event arguments/values mismatch","values",n),e.inputs.forEach((o,c)=>{const l=n[c];if(o.indexed)if(o.type==="string")r.push(hf(l));else if(o.type==="bytes")r.push(vr(l));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(R(this,As).encode([o.type],[l]))}else s.push(o),i.push(l)}),{data:R(this,As).encode(s,i),topics:r}}decodeEventLog(e,n,r){if(typeof e=="string"){const p=this.getEvent(e);J(p,"unknown event","eventFragment",e),e=p}if(r!=null&&!e.anonymous){const p=e.topicHash;J(Sn(r[0],32)&&r[0].toLowerCase()===p,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((p,m)=>{p.indexed?p.type==="string"||p.type==="bytes"||p.baseType==="tuple"||p.baseType==="array"?(s.push(os.from({type:"bytes32",name:p.name})),o.push(!0)):(s.push(p),o.push(!1)):(i.push(p),o.push(!1))});const c=r!=null?R(this,As).decode(s,ir(r)):null,l=R(this,As).decode(i,n,!0),d=[],u=[];let h=0,f=0;return e.inputs.forEach((p,m)=>{let g=null;if(p.indexed)if(c==null)g=new yO(null);else if(o[m])g=new yO(c[f++]);else try{g=c[f++]}catch(y){g=y}else try{g=l[h++]}catch(y){g=y}d.push(g),u.push(p.name||null)}),pg.fromItems(d,u)}parseTransaction(e){const n=jt(e.data,"tx.data"),r=Je(e.value!=null?e.value:0,"tx.value"),s=this.getFunction($e(n.slice(0,4)));if(!s)return null;const i=R(this,As).decode(s.inputs,n.slice(4));return new jne(s,s.selector,i,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const n=this.getEvent(e.topics[0]);return!n||n.anonymous?null:new Ine(n,n.topicHash,this.decodeEventLog(n,e.data,e.topics))}parseError(e){const n=$e(e),r=this.getError(Xn(n,0,4));if(!r)return null;const s=R(this,As).decode(r.inputs,Xn(n,4));return new Rne(r,r.selector,s)}static from(e){return e instanceof th?e:typeof e=="string"?new th(JSON.parse(e)):typeof e.formatJson=="function"?new th(e.formatJson()):typeof e.format=="function"?new th(e.format("json")):new th(e)}};Ya=new WeakMap,Qa=new WeakMap,Ja=new WeakMap,As=new WeakMap,Nc=new WeakSet,Xv=function(e,n,r){if(Sn(e)){const i=e.toLowerCase();for(const o of R(this,Ja).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,c]of R(this,Ja))o.split("(")[0]===e&&i.push(c);if(n){const o=n.length>0?n[n.length-1]:null;let c=n.length,l=!0;Rs.isTyped(o)&&o.type==="overrides"&&(l=!1,c--);for(let d=i.length-1;d>=0;d--){const u=i[d].inputs.length;u!==c&&(!l||u!==c-1)&&i.splice(d,1)}for(let d=i.length-1;d>=0;d--){const u=i[d].inputs;for(let h=0;h<n.length;h++)if(Rs.isTyped(n[h])){if(h>=u.length){if(n[h].type==="overrides")continue;i.splice(d,1);break}if(n[h].type!==u[h].baseType){i.splice(d,1);break}}}}if(i.length===1&&n&&n.length!==i[0].inputs.length){const o=n[n.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(c=>JSON.stringify(c.format())).join(", ");J(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=R(this,Ja).get(ic.from(e).format());return s||null},e1=function(e,n,r){if(Sn(e)){const i=e.toLowerCase();for(const o of R(this,Qa).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,c]of R(this,Qa))o.split("(")[0]===e&&i.push(c);if(n){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<n.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const c=i[o].inputs;for(let l=0;l<n.length;l++)if(Rs.isTyped(n[l])&&n[l].type!==c[l].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(c=>JSON.stringify(c.format())).join(", ");J(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=R(this,Qa).get(sc.from(e).format());return s||null};let hE=th;const S8=BigInt(0);function lm(t){return t??null}function lr(t){return t==null?null:t.toString()}class bO{constructor(e,n,r){G(this,"gasPrice");G(this,"maxFeePerGas");G(this,"maxPriorityFeePerGas");wt(this,{gasPrice:lm(e),maxFeePerGas:lm(n),maxPriorityFeePerGas:lm(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:n,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:lr(e),maxFeePerGas:lr(n),maxPriorityFeePerGas:lr(r)}}}function fE(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=$e(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of n)!(s in t)||t[s]==null||(e[s]=Je(t[s],`request.${s}`));const r="type,nonce".split(/,/);for(const s of r)!(s in t)||t[s]==null||(e[s]=St(t[s],`request.${s}`));return t.accessList&&(e.accessList=If(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(s=>TI(s)?$e(s):Object.assign({},s))),e}var rl;class Pne{constructor(e,n){G(this,"provider");G(this,"number");G(this,"hash");G(this,"timestamp");G(this,"parentHash");G(this,"parentBeaconBlockRoot");G(this,"nonce");G(this,"difficulty");G(this,"gasLimit");G(this,"gasUsed");G(this,"stateRoot");G(this,"receiptsRoot");G(this,"blobGasUsed");G(this,"excessBlobGas");G(this,"miner");G(this,"prevRandao");G(this,"extraData");G(this,"baseFeePerGas");se(this,rl);V(this,rl,e.transactions.map(r=>typeof r!="string"?new vw(r,n):r)),wt(this,{provider:n,hash:lm(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:lm(e.prevRandao),extraData:e.extraData,baseFeePerGas:lm(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return R(this,rl).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=R(this,rl).slice();return e.length===0?[]:(ge(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:n,extraData:r,gasLimit:s,gasUsed:i,hash:o,miner:c,prevRandao:l,nonce:d,number:u,parentHash:h,parentBeaconBlockRoot:f,stateRoot:p,receiptsRoot:m,timestamp:g,transactions:y}=this;return{_type:"Block",baseFeePerGas:lr(e),difficulty:lr(n),extraData:r,gasLimit:lr(s),gasUsed:lr(i),blobGasUsed:lr(this.blobGasUsed),excessBlobGas:lr(this.excessBlobGas),hash:o,miner:c,prevRandao:l,nonce:d,number:u,parentHash:h,timestamp:g,parentBeaconBlockRoot:f,stateRoot:p,receiptsRoot:m,transactions:y}}[Symbol.iterator](){let e=0;const n=this.transactions;return{next:()=>e<this.length?{value:n[e++],done:!1}:{value:void 0,done:!0}}}get length(){return R(this,rl).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let n;if(typeof e=="number")n=R(this,rl)[e];else{const r=e.toLowerCase();for(const s of R(this,rl))if(typeof s=="string"){if(s!==r)continue;n=s;break}else{if(s.hash!==r)continue;n=s;break}}if(n==null)throw new Error("no such tx");return typeof n=="string"?await this.provider.getTransaction(n):n}getPrefetchedTransaction(e){const n=this.prefetchedTransactions;if(typeof e=="number")return n[e];e=e.toLowerCase();for(const r of n)if(r.hash===e)return r;J(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return One(this)}}rl=new WeakMap;class Yx{constructor(e,n){G(this,"provider");G(this,"transactionHash");G(this,"blockHash");G(this,"blockNumber");G(this,"removed");G(this,"address");G(this,"data");G(this,"topics");G(this,"index");G(this,"transactionIndex");this.provider=n;const r=Object.freeze(e.topics.slice());wt(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:n,blockNumber:r,data:s,index:i,removed:o,topics:c,transactionHash:l,transactionIndex:d}=this;return{_type:"log",address:e,blockHash:n,blockNumber:r,data:s,index:i,removed:o,topics:c,transactionHash:l,transactionIndex:d}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return ge(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return ge(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return ge(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return Dne(this)}}var Ix;class T8{constructor(e,n){G(this,"provider");G(this,"to");G(this,"from");G(this,"contractAddress");G(this,"hash");G(this,"index");G(this,"blockHash");G(this,"blockNumber");G(this,"logsBloom");G(this,"gasUsed");G(this,"blobGasUsed");G(this,"cumulativeGasUsed");G(this,"gasPrice");G(this,"blobGasPrice");G(this,"type");G(this,"status");G(this,"root");se(this,Ix);V(this,Ix,Object.freeze(e.logs.map(s=>new Yx(s,n))));let r=S8;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),wt(this,{provider:n,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return R(this,Ix)}toJSON(){const{to:e,from:n,contractAddress:r,hash:s,index:i,blockHash:o,blockNumber:c,logsBloom:l,logs:d,status:u,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:c,contractAddress:r,cumulativeGasUsed:lr(this.cumulativeGasUsed),from:n,gasPrice:lr(this.gasPrice),blobGasUsed:lr(this.blobGasUsed),blobGasPrice:lr(this.blobGasPrice),gasUsed:lr(this.gasUsed),hash:s,index:i,logs:d,logsBloom:l,root:h,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return k8(this)}reorderedEvent(e){return ge(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),_8(this,e)}}Ix=new WeakMap;var _d;const CR=class CR{constructor(e,n){G(this,"provider");G(this,"blockNumber");G(this,"blockHash");G(this,"index");G(this,"hash");G(this,"type");G(this,"to");G(this,"from");G(this,"nonce");G(this,"gasLimit");G(this,"gasPrice");G(this,"maxPriorityFeePerGas");G(this,"maxFeePerGas");G(this,"maxFeePerBlobGas");G(this,"data");G(this,"value");G(this,"chainId");G(this,"signature");G(this,"accessList");G(this,"blobVersionedHashes");G(this,"authorizationList");se(this,_d);this.provider=n,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,V(this,_d,-1)}toJSON(){const{blockNumber:e,blockHash:n,index:r,hash:s,type:i,to:o,from:c,nonce:l,data:d,signature:u,accessList:h,blobVersionedHashes:f}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:n,blobVersionedHashes:f,chainId:lr(this.chainId),data:d,from:c,gasLimit:lr(this.gasLimit),gasPrice:lr(this.gasPrice),hash:s,maxFeePerGas:lr(this.maxFeePerGas),maxPriorityFeePerGas:lr(this.maxPriorityFeePerGas),maxFeePerBlobGas:lr(this.maxFeePerBlobGas),nonce:l,signature:u,to:o,index:r,type:i,value:lr(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const n=this.provider.getBlock(e);if(n==null)throw new Error("TODO");return n}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:n,blockNumber:r}=await $s({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return n==null||n.blockNumber==null?0:r-n.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,n){const r=e??1,s=n??0;let i=R(this,_d),o=-1,c=i===-1;const l=async()=>{if(c)return null;const{blockNumber:f,nonce:p}=await $s({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(p<this.nonce){i=f;return}if(c)return null;const m=await this.getTransaction();if(!(m&&m.blockNumber!=null))for(o===-1&&(o=i-3,o<R(this,_d)&&(o=R(this,_d)));o<=f;){if(c)return null;const g=await this.provider.getBlock(o,!0);if(g==null)return;for(const y of g)if(y===this.hash)return;for(let y=0;y<g.length;y++){const x=await g.getTransaction(y);if(x.from===this.from&&x.nonce===this.nonce){if(c)return null;const w=await this.provider.getTransactionReceipt(x.hash);if(w==null||f-w.blockNumber+1<r)return;let b="replaced";x.data===this.data&&x.to===this.to&&x.value===this.value?b="repriced":x.data==="0x"&&x.from===x.to&&x.value===S8&&(b="cancelled"),ge(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:b==="replaced"||b==="cancelled",reason:b,replacement:x.replaceableTransaction(i),hash:x.hash,receipt:w})}}o++}},d=f=>{if(f==null||f.status!==0)return f;ge(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:f.to,from:f.from,data:""},receipt:f})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return d(u);if(u){if(r===1||await u.confirmations()>=r)return d(u)}else if(await l(),r===0)return null;return await new Promise((f,p)=>{const m=[],g=()=>{m.forEach(x=>x())};if(m.push(()=>{c=!0}),s>0){const x=setTimeout(()=>{g(),p(Bn("wait for transaction timeout","TIMEOUT"))},s);m.push(()=>{clearTimeout(x)})}const y=async x=>{if(await x.confirmations()>=r){g();try{f(d(x))}catch(w){p(w)}}};if(m.push(()=>{this.provider.off(this.hash,y)}),this.provider.on(this.hash,y),i>=0){const x=async()=>{try{await l()}catch(w){if(rs(w,"TRANSACTION_REPLACED")){g(),p(w);return}}c||this.provider.once("block",x)};m.push(()=>{this.provider.off("block",x)}),this.provider.once("block",x)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return ge(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),k8(this)}reorderedEvent(e){return ge(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),ge(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),_8(this,e)}replaceableTransaction(e){J(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const n=new CR(this,this.provider);return V(n,_d,e),n}};_d=new WeakMap;let vw=CR;function One(t){return{orphan:"drop-block",hash:t.hash,number:t.number}}function _8(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function k8(t){return{orphan:"drop-transaction",tx:t}}function Dne(t){return{orphan:"drop-log",log:{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}}}class BI extends Yx{constructor(n,r,s){super(n,n.provider);G(this,"interface");G(this,"fragment");G(this,"args");const i=r.decodeEventLog(s,n.data,n.topics);wt(this,{args:i,fragment:s,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class I8 extends Yx{constructor(n,r){super(n,n.provider);G(this,"error");wt(this,{error:r})}}var $m;class Une extends T8{constructor(n,r,s){super(s,r);se(this,$m);V(this,$m,n)}get logs(){return super.logs.map(n=>{const r=n.topics.length?R(this,$m).getEvent(n.topics[0]):null;if(r)try{return new BI(n,R(this,$m),r)}catch(s){return new I8(n,s)}return n})}}$m=new WeakMap;var jx;class $I extends vw{constructor(n,r,s){super(s,r);se(this,jx);V(this,jx,n)}async wait(n,r){const s=await super.wait(n,r);return s==null?null:new Une(R(this,jx),this.provider,s)}}jx=new WeakMap;class j8 extends t${constructor(n,r,s,i){super(n,r,s);G(this,"log");wt(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Mne extends j8{constructor(e,n,r,s,i){super(e,n,r,new BI(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);wt(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const vO=BigInt(0);function R8(t){return t&&typeof t.call=="function"}function P8(t){return t&&typeof t.estimateGas=="function"}function GC(t){return t&&typeof t.resolveName=="function"}function O8(t){return t&&typeof t.sendTransaction=="function"}function D8(t){if(t!=null){if(GC(t))return t;if(t.provider)return t.provider}}var Rx;class Lne{constructor(e,n,r){se(this,Rx);G(this,"fragment");if(wt(this,{fragment:n}),n.inputs.length<r.length)throw new Error("too many arguments");const s=mf(e.runner,"resolveName"),i=GC(s)?s:null;V(this,Rx,async function(){const o=await Promise.all(n.inputs.map((c,l)=>r[l]==null?null:c.walkAsync(r[l],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(f=>Hs(f,i))):Hs(h,i):h)));return e.interface.encodeFilterTopics(n,o)}())}getTopicFilter(){return R(this,Rx)}}Rx=new WeakMap;function mf(t,e){return t==null?null:typeof t[e]=="function"?t:t.provider&&typeof t.provider[e]=="function"?t.provider:null}function fh(t){return t==null?null:t.provider||null}async function U8(t,e){const n=Rs.dereference(t,"overrides");J(typeof n=="object","invalid overrides parameter","overrides",t);const r=fE(n);return J(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),J(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function Bne(t,e,n){const r=mf(t,"resolveName"),s=GC(r)?r:null;return await Promise.all(e.map((i,o)=>i.walkAsync(n[o],(c,l)=>(l=Rs.dereference(l,c),c==="address"?Hs(l,s):l))))}function $ne(t){const e=async function(o){const c=await U8(o,["data"]);c.to=await t.getAddress(),c.from&&(c.from=await Hs(c.from,D8(t.runner)));const l=t.interface,d=Je(c.value||vO,"overrides.value")===vO,u=(c.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!u&&!d&&J(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),J(l.fallback||u,"cannot send data to receive-only contract","overrides.data",c.data);const h=l.receive||l.fallback&&l.fallback.payable;return J(h||d,"cannot send value to non-payable fallback","overrides.value",c.value),J(l.fallback||u,"cannot send data to receive-only contract","overrides.data",c.data),c},n=async function(o){const c=mf(t.runner,"call");ge(R8(c),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await e(o);try{return await c.call(l)}catch(d){throw SI(d)&&d.data?t.interface.makeError(d.data,l):d}},r=async function(o){const c=t.runner;ge(O8(c),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await c.sendTransaction(await e(o)),d=fh(t.runner);return new $I(t.interface,d,l)},s=async function(o){const c=mf(t.runner,"estimateGas");return ge(P8(c),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await c.estimateGas(await e(o))},i=async o=>await r(o);return wt(i,{_contract:t,estimateGas:s,populateTransaction:e,send:r,staticCall:n}),i}function Fne(t,e){const n=function(...d){const u=t.interface.getFunction(e,d);return ge(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:d}}),u},r=async function(...d){const u=n(...d);let h={};if(u.inputs.length+1===d.length&&(h=await U8(d.pop()),h.from&&(h.from=await Hs(h.from,D8(t.runner)))),u.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const f=await Bne(t.runner,u.inputs,d);return Object.assign({},h,await $s({to:t.getAddress(),data:t.interface.encodeFunctionData(u,f)}))},s=async function(...d){const u=await c(...d);return u.length===1?u[0]:u},i=async function(...d){const u=t.runner;ge(O8(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await r(...d)),f=fh(t.runner);return new $I(t.interface,f,h)},o=async function(...d){const u=mf(t.runner,"estimateGas");return ge(P8(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...d))},c=async function(...d){const u=mf(t.runner,"call");ge(R8(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await r(...d);let f="0x";try{f=await u.call(h)}catch(m){throw SI(m)&&m.data?t.interface.makeError(m.data,h):m}const p=n(...d);return t.interface.decodeFunctionResult(p,f)},l=async(...d)=>n(...d).constant?await s(...d):await i(...d);return wt(l,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:o,populateTransaction:r,send:i,staticCall:s,staticCallResult:c}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=t.interface.getFunction(e);return ge(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),d}}),l}function zne(t,e){const n=function(...s){const i=t.interface.getEvent(e,s);return ge(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},r=function(...s){return new Lne(t,n(...s),s)};return wt(r,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=t.interface.getEvent(e);return ge(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),r}const pE=Symbol.for("_ethersInternal_contract"),M8=new WeakMap;function Hne(t,e){M8.set(t[pE],e)}function Mi(t){return M8.get(t[pE])}function Vne(t){return t&&typeof t=="object"&&"getTopicFilter"in t&&typeof t.getTopicFilter=="function"&&t.fragment}async function FI(t,e){let n,r=null;if(Array.isArray(e)){const i=function(o){if(Sn(o,32))return o;const c=t.interface.getEvent(o);return J(c,"unknown fragment","name",o),c.topicHash};n=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?n=[null]:typeof e=="string"?Sn(e,32)?n=[e]:(r=t.interface.getEvent(e),J(r,"unknown fragment","event",e),n=[r.topicHash]):Vne(e)?n=await e.getTopicFilter():"fragment"in e?(r=e.fragment,n=[r.topicHash]):J(!1,"unknown event name","event",e);n=n.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(c=>c.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=n.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:r,tag:s,topics:n}}async function ny(t,e){const{subs:n}=Mi(t);return n.get((await FI(t,e)).tag)||null}async function EO(t,e,n){const r=fh(t.runner);ge(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await FI(t,n),{addr:c,subs:l}=Mi(t);let d=l.get(i);if(!d){const h={address:c||t,topics:o},f=y=>{let x=s;if(x==null)try{x=t.interface.getEvent(y.topics[0])}catch{}if(x){const w=x,b=s?t.interface.decodeEventLog(s,y.data,y.topics):[];CT(t,n,b,v=>new Mne(t,v,n,w,y))}else CT(t,n,[],w=>new j8(t,w,n,y))};let p=[];d={tag:i,listeners:[],start:()=>{p.length||p.push(r.on(h,f))},stop:async()=>{if(p.length==0)return;let y=p;p=[],await Promise.all(y),r.off(h,f)}},l.set(i,d)}return d}let ET=Promise.resolve();async function Wne(t,e,n,r){await ET;const s=await ny(t,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:c})=>{const l=Array.from(n);r&&l.push(r(c?null:o));try{o.call(t,...l)}catch{}return!c}),s.listeners.length===0&&(s.stop(),Mi(t).subs.delete(s.tag)),i>0}async function CT(t,e,n,r){try{await ET}catch{}const s=Wne(t,e,n,r);return ET=s,await s}const Gb=["then"];var UU;UU=pE;const Hy=class Hy{constructor(e,n,r,s){G(this,"target");G(this,"interface");G(this,"runner");G(this,"filters");G(this,UU);G(this,"fallback");J(typeof e=="string"||z$(e),"invalid value for Contract target","target",e),r==null&&(r=null);const i=hE.from(n);wt(this,{target:e,runner:r,interface:i}),Object.defineProperty(this,pE,{value:{}});let o,c=null,l=null;if(s){const h=fh(r);l=new $I(this.interface,h,s)}let d=new Map;if(typeof e=="string")if(Sn(e))c=e,o=Promise.resolve(e);else{const h=mf(r,"resolveName");if(!GC(h))throw Bn("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(f=>{if(f==null)throw Bn("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Mi(this).addr=f,f})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Mi(this).addr=h,h});Hne(this,{addrPromise:o,addr:c,deployTx:l,subs:d});const u=new Proxy({},{get:(h,f,p)=>{if(typeof f=="symbol"||Gb.indexOf(f)>=0)return Reflect.get(h,f,p);try{return this.getEvent(f)}catch(m){if(!rs(m,"INVALID_ARGUMENT")||m.argument!=="key")throw m}},has:(h,f)=>Gb.indexOf(f)>=0?Reflect.has(h,f):Reflect.has(h,f)||this.interface.hasEvent(String(f))});return wt(this,{filters:u}),wt(this,{fallback:i.receive||i.fallback?$ne(this):null}),new Proxy(this,{get:(h,f,p)=>{if(typeof f=="symbol"||f in h||Gb.indexOf(f)>=0)return Reflect.get(h,f,p);try{return h.getFunction(f)}catch(m){if(!rs(m,"INVALID_ARGUMENT")||m.argument!=="key")throw m}},has:(h,f)=>typeof f=="symbol"||f in h||Gb.indexOf(f)>=0?Reflect.has(h,f):h.interface.hasFunction(f)})}connect(e){return new Hy(this.target,this.interface,e)}attach(e){return new Hy(e,this.interface,this.runner)}async getAddress(){return await Mi(this).addrPromise}async getDeployedCode(){const e=fh(this.runner);ge(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const n=await e.getCode(await this.getAddress());return n==="0x"?null:n}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=fh(this.runner);return ge(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);r.once("block",o)}catch(c){i(c)}};o()})}deploymentTransaction(){return Mi(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),Fne(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),zne(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,n,r){n==null&&(n=0),r==null&&(r="latest");const{addr:s,addrPromise:i}=Mi(this),o=s||await i,{fragment:c,topics:l}=await FI(this,e),d={address:o,topics:l,fromBlock:n,toBlock:r},u=fh(this.runner);return ge(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(d)).map(h=>{let f=c;if(f==null)try{f=this.interface.getEvent(h.topics[0])}catch{}if(f)try{return new BI(h,this.interface,f)}catch(p){return new I8(h,p)}return new Yx(h,u)})}async on(e,n){const r=await EO(this,"on",e);return r.listeners.push({listener:n,once:!1}),r.start(),this}async once(e,n){const r=await EO(this,"once",e);return r.listeners.push({listener:n,once:!0}),r.start(),this}async emit(e,...n){return await CT(this,e,n,null)}async listenerCount(e){if(e){const s=await ny(this,e);return s?s.listeners.length:0}const{subs:n}=Mi(this);let r=0;for(const{listeners:s}of n.values())r+=s.length;return r}async listeners(e){if(e){const s=await ny(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:n}=Mi(this);let r=[];for(const{listeners:s}of n.values())r=r.concat(s.map(({listener:i})=>i));return r}async off(e,n){const r=await ny(this,e);if(!r)return this;if(n){const s=r.listeners.map(({listener:i})=>i).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(n==null||r.listeners.length===0)&&(r.stop(),Mi(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const n=await ny(this,e);if(!n)return this;n.stop(),Mi(this).subs.delete(n.tag)}else{const{subs:n}=Mi(this);for(const{tag:r,stop:s}of n.values())s(),n.delete(r)}return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return await this.off(e,n)}static buildClass(e){class n extends Hy{constructor(s,i=null){super(s,e,i)}}return n}static from(e,n,r){return r==null&&(r=null),new this(e,n,r)}};let NT=Hy;function qne(){return NT}class rr extends qne(){}function AA(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):J(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class Kne{constructor(e){G(this,"name");wt(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,n){throw new Error("unsupported coin")}async decodeAddress(e,n){throw new Error("unsupported coin")}}const L8=new RegExp("^(ipfs)://(.*)$","i"),CO=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),L8,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var kd,Mh,Id,vp,sC,B8;const Qp=class Qp{constructor(e,n,r){se(this,Id);G(this,"provider");G(this,"address");G(this,"name");se(this,kd);se(this,Mh);wt(this,{provider:e,address:n,name:r}),V(this,kd,null),V(this,Mh,new rr(n,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return R(this,kd)==null&&V(this,kd,(async()=>{try{return await R(this,Mh).supportsInterface("0x9061b923")}catch(e){if(rs(e,"CALL_EXCEPTION"))return!1;throw V(this,kd,null),e}})()),await R(this,kd)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await Ce(this,Id,vp).call(this,"addr(bytes32)");return i==null||i===fw?null:i}catch(i){if(rs(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await Ce(this,Id,vp).call(this,"addr(bytes32,uint)",[i]);if(Sn(o,20))return un(o)}let n=null;for(const i of this.provider.plugins)if(i instanceof Kne&&i.supportsCoinType(e)){n=i;break}if(n==null)return null;const r=await Ce(this,Id,vp).call(this,"addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const s=await n.decodeAddress(e,r);if(s!=null)return s;ge(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const n=await Ce(this,Id,vp).call(this,"text(bytes32,string)",[e]);return n==null||n==="0x"?null:n}async getContentHash(){const e=await Ce(this,Id,vp).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const n=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(n){const s=n[1]==="e3010170"?"ipfs":"ipns",i=parseInt(n[4],16);if(n[5].length===i*2)return`${s}://${JZ("0x"+n[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;ge(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const n=await this.getText("avatar");if(n==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:n});for(let r=0;r<CO.length;r++){const s=n.match(CO[r]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:n}),{linkage:e,url:n};case"ipfs":{const o=AA(n);return e.push({type:"ipfs",value:n}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:n});const c=await this.getAddress();if(c==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const l=(s[2]||"").split("/");if(l.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const d=l[1],u=new rr(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const g=await u.ownerOf(d);if(c!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(i==="erc1155"){const g=await u.balanceOf(c,d);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let h=await u[o](d);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",ou(d,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=AA(h)),e.push({type:"metadata-url",value:h});let f={};const p=await new kl(h).send();p.assertOk();try{f=p.bodyJson}catch{try{e.push({type:"!metadata",value:p.bodyText})}catch{const x=p.body;return x&&e.push({type:"!metadata",value:$e(x)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!f)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(f)});let m=f.image;if(typeof m!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!m.match(/^(https:\/\/|data:)/i)){if(m.match(L8)==null)return e.push({type:"!imageUrl-ipfs",value:m}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:m}),m=AA(m)}return e.push({type:"url",value:m}),{linkage:e,url:m}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const n=await e.getNetwork(),r=n.getPlugin("org.ethers.plugins.network.Ens");return ge(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:n}}),r.address}static async fromName(e,n){var s;let r=n;for(;;){if(r===""||r==="."||n!=="eth"&&r==="eth")return null;const i=await Ce(s=Qp,sC,B8).call(s,e,r);if(i!=null){const o=new Qp(e,i,n);return r!==n&&!await o.supportsWildcard()?null:o}r=r.split(".").slice(1).join(".")}}};kd=new WeakMap,Mh=new WeakMap,Id=new WeakSet,vp=async function(e,n){n=(n||[]).slice();const r=R(this,Mh).interface;n.unshift(bT(this.name));let s=null;await this.supportsWildcard()&&(s=r.getFunction(e),ge(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),n=[cne(this.name,255),r.encodeFunctionData(s,n)],e="resolve(bytes,bytes)"),n.push({enableCcipRead:!0});try{const i=await R(this,Mh)[e](...n);return s?r.decodeFunctionResult(s,i)[0]:i}catch(i){if(!rs(i,"CALL_EXCEPTION"))throw i}return null},sC=new WeakSet,B8=async function(e,n){const r=await Qp.getEnsAddress(e);try{const i=await new rr(r,["function resolver(bytes32) view returns (address)"],e).resolver(bT(n),{enableCcipRead:!0});return i===fw?null:i}catch(s){throw s}return null},se(Qp,sC);let mE=Qp;const NO=BigInt(0);function Ht(t,e){return function(n){return n==null?e:t(n)}}function Ew(t,e){return n=>{if(e&&n==null)return null;if(!Array.isArray(n))throw new Error("not an array");return n.map(r=>t(r))}}function Qx(t,e){return n=>{const r={};for(const s in t){let i=s;if(e&&s in e&&!(i in n)){for(const o of e[s])if(o in n){i=o;break}}try{const o=t[s](n[i]);o!==void 0&&(r[s]=o)}catch(o){const c=o instanceof Error?o.message:"not-an-error";ge(!1,`invalid value for value.${s} (${c})`,"BAD_DATA",{value:n})}}return r}}function Gne(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}J(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}function vg(t){return J(Sn(t,!0),"invalid data","value",t),t}function ns(t){return J(Sn(t,32),"invalid hash","value",t),t}const Yne=Qx({address:un,blockHash:ns,blockNumber:St,data:vg,index:St,removed:Ht(Gne,!1),topics:Ew(ns),transactionHash:ns,transactionIndex:St},{index:["logIndex"]});function Qne(t){return Yne(t)}const Jne=Qx({hash:Ht(ns),parentHash:ns,parentBeaconBlockRoot:Ht(ns,null),number:St,timestamp:St,nonce:Ht(vg),difficulty:Je,gasLimit:Je,gasUsed:Je,stateRoot:Ht(ns,null),receiptsRoot:Ht(ns,null),blobGasUsed:Ht(Je,null),excessBlobGas:Ht(Je,null),miner:Ht(un),prevRandao:Ht(ns,null),extraData:vg,baseFeePerGas:Ht(Je)},{prevRandao:["mixHash"]});function Zne(t){const e=Jne(t);return e.transactions=t.transactions.map(n=>typeof n=="string"?n:$8(n)),e}const Xne=Qx({transactionIndex:St,blockNumber:St,transactionHash:ns,address:un,topics:Ew(ns),data:vg,index:St,blockHash:ns},{index:["logIndex"]});function ere(t){return Xne(t)}const tre=Qx({to:Ht(un,null),from:Ht(un,null),contractAddress:Ht(un,null),index:St,root:Ht($e),gasUsed:Je,blobGasUsed:Ht(Je,null),logsBloom:Ht(vg),blockHash:ns,hash:ns,logs:Ew(ere),blockNumber:St,cumulativeGasUsed:Je,effectiveGasPrice:Ht(Je),blobGasPrice:Ht(Je,null),status:Ht(St),type:Ht(St,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function nre(t){return tre(t)}function $8(t){t.to&&Je(t.to)===NO&&(t.to="0x0000000000000000000000000000000000000000");const e=Qx({hash:ns,index:Ht(St,void 0),type:n=>n==="0x"||n==null?0:St(n),accessList:Ht(If,null),blobVersionedHashes:Ht(Ew(ns,!0),null),authorizationList:Ht(Ew(n=>{let r;if(n.signature)r=n.signature;else{let s=n.yParity;s==="0x1b"?s=0:s==="0x1c"&&(s=1),r=Object.assign({},n,{yParity:s})}return{address:un(n.address),chainId:Je(n.chainId),nonce:Je(n.nonce),signature:Ti.from(r)}},!1),null),blockHash:Ht(ns,null),blockNumber:Ht(St,null),transactionIndex:Ht(St,null),from:un,gasPrice:Ht(Je),maxPriorityFeePerGas:Ht(Je),maxFeePerGas:Ht(Je),maxFeePerBlobGas:Ht(Je,null),gasLimit:Je,to:Ht(un,null),value:Je,nonce:St,data:vg,creates:Ht(un,null),chainId:Ht(Je,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(e.to==null&&e.creates==null&&(e.creates=Vee(e)),(t.type===1||t.type===2)&&t.accessList==null&&(e.accessList=[]),t.signature?e.signature=Ti.from(t.signature):e.signature=Ti.from(t),e.chainId==null){const n=e.signature.legacyChainId;n!=null&&(e.chainId=n)}return e.blockHash&&Je(e.blockHash)===NO&&(e.blockHash=null),e}const rre="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Jx{constructor(e){G(this,"name");wt(this,{name:e})}clone(){return new Jx(this.name)}}class YC extends Jx{constructor(n,r){n==null&&(n=0);super(`org.ethers.network.plugins.GasCost#${n||0}`);G(this,"effectiveBlock");G(this,"txBase");G(this,"txCreate");G(this,"txDataZero");G(this,"txDataNonzero");G(this,"txAccessListStorageKey");G(this,"txAccessListAddress");const s={effectiveBlock:n};function i(o,c){let l=(r||{})[o];l==null&&(l=c),J(typeof l=="number",`invalud value for ${o}`,"costs",r),s[o]=l}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),wt(this,s)}clone(){return new YC(this.effectiveBlock,this)}}class QC extends Jx{constructor(n,r){super("org.ethers.plugins.network.Ens");G(this,"address");G(this,"targetNetwork");wt(this,{address:n||rre,targetNetwork:r??1})}clone(){return new QC(this.address,this.targetNetwork)}}var Px,Ox;class sre extends Jx{constructor(n,r){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");se(this,Px);se(this,Ox);V(this,Px,n),V(this,Ox,r)}get url(){return R(this,Px)}get processFunc(){return R(this,Ox)}clone(){return this}}Px=new WeakMap,Ox=new WeakMap;const SA=new Map;var Fm,zm,jd;const Jp=class Jp{constructor(e,n){se(this,Fm);se(this,zm);se(this,jd);V(this,Fm,e),V(this,zm,Je(n)),V(this,jd,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return R(this,Fm)}set name(e){V(this,Fm,e)}get chainId(){return R(this,zm)}set chainId(e){V(this,zm,Je(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===Je(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===Je(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===Je(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(R(this,jd).values())}attachPlugin(e){if(R(this,jd).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return R(this,jd).set(e.name,e.clone()),this}getPlugin(e){return R(this,jd).get(e)||null}getPlugins(e){return this.plugins.filter(n=>n.name.split("#")[0]===e)}clone(){const e=new Jp(this.name,this.chainId);return this.plugins.forEach(n=>{e.attachPlugin(n.clone())}),e}computeIntrinsicGas(e){const n=this.getPlugin("org.ethers.plugins.network.GasCost")||new YC;let r=n.txBase;if(e.to==null&&(r+=n.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?r+=n.txDataZero:r+=n.txDataNonzero;if(e.accessList){const s=If(e.accessList);for(const i in s)r+=n.txAccessListAddress+n.txAccessListStorageKey*s[i].storageKeys.length}return r}static from(e){if(ire(),e==null)return Jp.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const n=SA.get(e);if(n)return n();if(typeof e=="bigint")return new Jp("unknown",e);J(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){J(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const n=new Jp(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&n.attachPlugin(new QC(e.ensAddress,e.ensNetwork)),n}J(!1,"invalid network","network",e)}static register(e,n){typeof e=="number"&&(e=BigInt(e));const r=SA.get(e);r&&J(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),SA.set(e,n)}};Fm=new WeakMap,zm=new WeakMap,jd=new WeakMap;let cc=Jp;function AO(t,e){const n=String(t);if(!n.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const r=n.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${t}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let s=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||s++,r[1]=s.toString()}return BigInt(r[0]+r[1])}function SO(t){return new sre(t,async(e,n,r)=>{r.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([r.send(),e()]);s=i;const c=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:AO(c.maxFee,9),maxPriorityFeePerGas:AO(c.maxPriorityFee,9)}}catch(i){ge(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:s,error:i})}})}let TO=!1;function ire(){if(TO)return;TO=!0;function t(e,n,r){const s=function(){const i=new cc(e,n);return r.ensNetwork!=null&&i.attachPlugin(new QC(null,r.ensNetwork)),i.attachPlugin(new YC),(r.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};cc.register(e,s),cc.register(n,s),r.altNames&&r.altNames.forEach(i=>{cc.register(i,s)})}t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[SO("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[SO("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}function AT(t){return JSON.parse(JSON.stringify(t))}var sl,yo,Rd,Za,Hm,t1;class ore{constructor(e){se(this,Hm);se(this,sl);se(this,yo);se(this,Rd);se(this,Za);V(this,sl,e),V(this,yo,null),V(this,Rd,4e3),V(this,Za,-2)}get pollingInterval(){return R(this,Rd)}set pollingInterval(e){V(this,Rd,e)}start(){R(this,yo)||(V(this,yo,R(this,sl)._setTimeout(Ce(this,Hm,t1).bind(this),R(this,Rd))),Ce(this,Hm,t1).call(this))}stop(){R(this,yo)&&(R(this,sl)._clearTimeout(R(this,yo)),V(this,yo,null))}pause(e){this.stop(),e&&V(this,Za,-2)}resume(){this.start()}}sl=new WeakMap,yo=new WeakMap,Rd=new WeakMap,Za=new WeakMap,Hm=new WeakSet,t1=async function(){try{const e=await R(this,sl).getBlockNumber();if(R(this,Za)===-2){V(this,Za,e);return}if(e!==R(this,Za)){for(let n=R(this,Za)+1;n<=e;n++){if(R(this,yo)==null)return;await R(this,sl).emit("block",n)}V(this,Za,e)}}catch{}R(this,yo)!=null&&V(this,yo,R(this,sl)._setTimeout(Ce(this,Hm,t1).bind(this),R(this,Rd)))};var Lh,Bh,Pd;class zI{constructor(e){se(this,Lh);se(this,Bh);se(this,Pd);V(this,Lh,e),V(this,Pd,!1),V(this,Bh,n=>{this._poll(n,R(this,Lh))})}async _poll(e,n){throw new Error("sub-classes must override this")}start(){R(this,Pd)||(V(this,Pd,!0),R(this,Bh).call(this,-2),R(this,Lh).on("block",R(this,Bh)))}stop(){R(this,Pd)&&(V(this,Pd,!1),R(this,Lh).off("block",R(this,Bh)))}pause(e){this.stop()}resume(){this.start()}}Lh=new WeakMap,Bh=new WeakMap,Pd=new WeakMap;var Vm,il;class are extends zI{constructor(n,r){super(n);se(this,Vm);se(this,il);V(this,Vm,r),V(this,il,-2)}pause(n){n&&V(this,il,-2),super.pause(n)}async _poll(n,r){const s=await r.getBlock(R(this,Vm));s!=null&&(R(this,il)===-2?V(this,il,s.number):s.number>R(this,il)&&(r.emit(R(this,Vm),s.number),V(this,il,s.number)))}}Vm=new WeakMap,il=new WeakMap;var iC;class cre extends zI{constructor(n,r){super(n);se(this,iC);V(this,iC,AT(r))}async _poll(n,r){throw new Error("@TODO")}}iC=new WeakMap;var Wm;class lre extends zI{constructor(n,r){super(n);se(this,Wm);V(this,Wm,r)}async _poll(n,r){const s=await r.getTransactionReceipt(R(this,Wm));s&&r.emit(R(this,Wm),s)}}Wm=new WeakMap;var ol,qm,Km,Od,wo,oC,F8;class HI{constructor(e,n){se(this,oC);se(this,ol);se(this,qm);se(this,Km);se(this,Od);se(this,wo);V(this,ol,e),V(this,qm,AT(n)),V(this,Km,Ce(this,oC,F8).bind(this)),V(this,Od,!1),V(this,wo,-2)}start(){R(this,Od)||(V(this,Od,!0),R(this,wo)===-2&&R(this,ol).getBlockNumber().then(e=>{V(this,wo,e)}),R(this,ol).on("block",R(this,Km)))}stop(){R(this,Od)&&(V(this,Od,!1),R(this,ol).off("block",R(this,Km)))}pause(e){this.stop(),e&&V(this,wo,-2)}resume(){this.start()}}ol=new WeakMap,qm=new WeakMap,Km=new WeakMap,Od=new WeakMap,wo=new WeakMap,oC=new WeakSet,F8=async function(e){if(R(this,wo)===-2)return;const n=AT(R(this,qm));n.fromBlock=R(this,wo)+1,n.toBlock=e;const r=await R(this,ol).getLogs(n);if(r.length===0){R(this,wo)<e-60&&V(this,wo,e-60);return}for(const s of r)R(this,ol).emit(R(this,qm),s),V(this,wo,s.blockNumber)};const dre=BigInt(2),ure=10;function Yb(t){return t&&typeof t.then=="function"}function n1(t,e){return t+":"+JSON.stringify(e,(n,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const s=Object.keys(r);return s.sort(),s.reduce((i,o)=>(i[o]=r[o],i),{})}return r})}class z8{constructor(e){G(this,"name");wt(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function hre(t){return JSON.parse(JSON.stringify(t))}function ST(t){return t=Array.from(new Set(t).values()),t.sort(),t}async function TA(t,e){if(t==null)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),typeof t=="string")switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(Sn(t,32)){const n=t.toLowerCase();return{type:"transaction",tag:n1("tx",{hash:n}),hash:n}}if(t.orphan){const n=t;return{type:"orphan",tag:n1("orphan",n),filter:hre(n)}}if(t.address||t.topics){const n=t,r={topics:(n.topics||[]).map(s=>s==null?null:Array.isArray(s)?ST(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(n.address){const s=[],i=[],o=c=>{Sn(c)?s.push(c):i.push((async()=>{s.push(await Hs(c,e))})())};Array.isArray(n.address)?n.address.forEach(o):o(n.address),i.length&&await Promise.all(i),r.address=ST(s.map(c=>c.toLowerCase()))}return{filter:r,tag:n1("event",r),type:"event"}}J(!1,"unknown ProviderEvent","event",t)}function _A(){return new Date().getTime()}const fre={cacheTimeout:250,pollingInterval:4e3};var Ss,Dd,Ts,Gm,Fi,$h,Ud,al,Dx,xo,Ym,Qm,Ot,Oi,TT,_T,ry,kT,sy,r1;class pre{constructor(e,n){se(this,Ot);se(this,Ss);se(this,Dd);se(this,Ts);se(this,Gm);se(this,Fi);se(this,$h);se(this,Ud);se(this,al);se(this,Dx);se(this,xo);se(this,Ym);se(this,Qm);if(V(this,Qm,Object.assign({},fre,n||{})),e==="any")V(this,$h,!0),V(this,Fi,null);else if(e){const r=cc.from(e);V(this,$h,!1),V(this,Fi,Promise.resolve(r)),setTimeout(()=>{this.emit("network",r,null)},0)}else V(this,$h,!1),V(this,Fi,null);V(this,al,-1),V(this,Ud,new Map),V(this,Ss,new Map),V(this,Dd,new Map),V(this,Ts,null),V(this,Gm,!1),V(this,Dx,1),V(this,xo,new Map),V(this,Ym,!1)}get pollingInterval(){return R(this,Qm).pollingInterval}get provider(){return this}get plugins(){return Array.from(R(this,Dd).values())}attachPlugin(e){if(R(this,Dd).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return R(this,Dd).set(e.name,e.connect(this)),this}getPlugin(e){return R(this,Dd).get(e)||null}get disableCcipRead(){return R(this,Ym)}set disableCcipRead(e){V(this,Ym,!!e)}async ccipReadFetch(e,n,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=n.toLowerCase(),o=[];for(let c=0;c<r.length;c++){const l=r[c],d=l.replace("{sender}",s).replace("{data}",i),u=new kl(d);l.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:c,urls:r});let h="unknown error",f;try{f=await u.send()}catch(p){o.push(p.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:p}});continue}try{const p=f.bodyJson;if(p.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:p}),p.data;p.message&&(h=p.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:p})}catch{}ge(f.statusCode<400||f.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:l,errorMessage:h}}),o.push(h)}ge(!1,`error encountered during CCIP fetch: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,n){return new Pne(Zne(e),this)}_wrapLog(e,n){return new Yx(Qne(e),this)}_wrapTransactionReceipt(e,n){return new T8(nre(e),this)}_wrapTransactionResponse(e,n){return new vw($8(e),this)}_detectNetwork(){ge(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){ge(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=St(await Ce(this,Ot,Oi).call(this,{method:"getBlockNumber"}),"%response");return R(this,al)>=0&&V(this,al,e),e}_getAddress(e){return Hs(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Sn(e))return Sn(e,32)?e:ha(e);if(typeof e=="bigint"&&(e=St(e,"blockTag")),typeof e=="number")return e>=0?ha(e):R(this,al)>=0?ha(R(this,al)+e):this.getBlockNumber().then(n=>ha(n+e));J(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const n=(e.topics||[]).map(l=>l==null?null:Array.isArray(l)?ST(l.map(d=>d.toLowerCase())):l.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,s=(l,d,u)=>{let h;switch(l.length){case 0:break;case 1:h=l[0];break;default:l.sort(),h=l}if(r&&(d!=null||u!=null))throw new Error("invalid filter");const f={};return h&&(f.address=h),n.length&&(f.topics=n),d&&(f.fromBlock=d),u&&(f.toBlock=u),r&&(f.blockHash=r),f};let i=[];if(e.address)if(Array.isArray(e.address))for(const l of e.address)i.push(this._getAddress(l));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let c;return"toBlock"in e&&(c=this._getBlockTag(e.toBlock)),i.filter(l=>typeof l!="string").length||o!=null&&typeof o!="string"||c!=null&&typeof c!="string"?Promise.all([Promise.all(i),o,c]).then(l=>s(l[0],l[1],l[2])):s(i,o,c)}_getTransactionRequest(e){const n=fE(e),r=[];if(["to","from"].forEach(s=>{if(n[s]==null)return;const i=Hs(n[s],this);Yb(i)?r.push(async function(){n[s]=await i}()):n[s]=i}),n.blockTag!=null){const s=this._getBlockTag(n.blockTag);Yb(s)?r.push(async function(){n.blockTag=await s}()):n.blockTag=s}return r.length?async function(){return await Promise.all(r),n}():n}async getNetwork(){if(R(this,Fi)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw R(this,Fi)===s&&V(this,Fi,null),i}})();return V(this,Fi,s),(await s).clone()}const e=R(this,Fi),[n,r]=await Promise.all([e,this._detectNetwork()]);return n.chainId!==r.chainId&&(R(this,$h)?(this.emit("network",r,n),R(this,Fi)===e&&V(this,Fi,Promise.resolve(r))):ge(!1,`network changed: ${n.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),n.clone()}async getFeeData(){const e=await this.getNetwork(),n=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await $s({_block:Ce(this,Ot,kT).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await Ce(this,Ot,Oi).call(this,{method:"getGasPrice"});return Je(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await Ce(this,Ot,Oi).call(this,{method:"getPriorityFee"});return Je(u,"%response")}catch{}return null})()});let c=null,l=null;const d=this._wrapBlock(s,e);return d&&d.baseFeePerGas&&(l=o??BigInt("1000000000"),c=d.baseFeePerGas*dre+l),new bO(i,c,l)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const s=new kl(r.url),i=await r.processFunc(n,this,s);return new bO(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await n()}async estimateGas(e){let n=this._getTransactionRequest(e);return Yb(n)&&(n=await n),Je(await Ce(this,Ot,Oi).call(this,{method:"estimateGas",transaction:n}),"%response")}async call(e){const{tx:n,blockTag:r}=await $s({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await Ce(this,Ot,_T).call(this,Ce(this,Ot,TT).call(this,n,r,e.enableCcipRead?0:-1))}async getBalance(e,n){return Je(await Ce(this,Ot,ry).call(this,{method:"getBalance"},e,n),"%response")}async getTransactionCount(e,n){return St(await Ce(this,Ot,ry).call(this,{method:"getTransactionCount"},e,n),"%response")}async getCode(e,n){return $e(await Ce(this,Ot,ry).call(this,{method:"getCode"},e,n))}async getStorage(e,n,r){const s=Je(n,"position");return $e(await Ce(this,Ot,ry).call(this,{method:"getStorage",position:s},e,r))}async broadcastTransaction(e){const{blockNumber:n,hash:r,network:s}=await $s({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=iE.from(e);if(i.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(n)}async getBlock(e,n){const{network:r,params:s}=await $s({network:this.getNetwork(),params:Ce(this,Ot,kT).call(this,e,!!n)});return s==null?null:this._wrapBlock(s,r)}async getTransaction(e){const{network:n,params:r}=await $s({network:this.getNetwork(),params:Ce(this,Ot,Oi).call(this,{method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,n)}async getTransactionReceipt(e){const{network:n,params:r}=await $s({network:this.getNetwork(),params:Ce(this,Ot,Oi).call(this,{method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const s=await Ce(this,Ot,Oi).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(r,n)}async getTransactionResult(e){const{result:n}=await $s({network:this.getNetwork(),result:Ce(this,Ot,Oi).call(this,{method:"getTransactionResult",hash:e})});return n==null?null:$e(n)}async getLogs(e){let n=this._getFilter(e);Yb(n)&&(n=await n);const{network:r,params:s}=await $s({network:this.getNetwork(),params:Ce(this,Ot,Oi).call(this,{method:"getLogs",filter:n})});return s.map(i=>this._wrapLog(i,r))}_getProvider(e){ge(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await mE.fromName(this,e)}async getAvatar(e){const n=await this.getResolver(e);return n?await n.getAvatar():null}async resolveName(e){const n=await this.getResolver(e);return n?await n.getAddress():null}async lookupAddress(e){e=un(e);const n=bT(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await mE.getEnsAddress(this),i=await new rr(r,["function resolver(bytes32) view returns (address)"],this).resolver(n);if(i==null||i===fw)return null;const c=await new rr(i,["function name(bytes32) view returns (string)"],this).name(n);return await this.resolveName(c)!==e?null:c}catch(r){if(rs(r,"BAD_DATA")&&r.value==="0x"||rs(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,n,r){const s=n??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let c=null;const l=async d=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&d-u.blockNumber+1>=s){i(u),c&&(clearTimeout(c),c=null);return}}catch(u){console.log("EEE",u)}this.once("block",l)};r!=null&&(c=setTimeout(()=>{c!=null&&(c=null,this.off("block",l),o(Bn("timeout","TIMEOUT",{reason:"timeout"})))},r)),l(await this.getBlockNumber())})}async waitForBlock(e){ge(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const n=R(this,xo).get(e);n&&(n.timer&&clearTimeout(n.timer),R(this,xo).delete(e))}_setTimeout(e,n){n==null&&(n=0);const r=d0(this,Dx)._++,s=()=>{R(this,xo).delete(r),e()};if(this.paused)R(this,xo).set(r,{timer:null,func:s,time:n});else{const i=setTimeout(s,n);R(this,xo).set(r,{timer:i,func:s,time:_A()})}return r}_forEachSubscriber(e){for(const n of R(this,Ss).values())e(n.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new z8(e.type);case"block":{const n=new ore(this);return n.pollingInterval=this.pollingInterval,n}case"safe":case"finalized":return new are(this,e.type);case"event":return new HI(this,e.filter);case"transaction":return new lre(this,e.hash);case"orphan":return new cre(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,n){for(const r of R(this,Ss).values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=n,r.started&&n.start(),R(this,Ts)!=null&&n.pause(R(this,Ts));break}}async on(e,n){const r=await Ce(this,Ot,r1).call(this,e);return r.listeners.push({listener:n,once:!1}),r.started||(r.subscriber.start(),r.started=!0,R(this,Ts)!=null&&r.subscriber.pause(R(this,Ts))),this}async once(e,n){const r=await Ce(this,Ot,r1).call(this,e);return r.listeners.push({listener:n,once:!0}),r.started||(r.subscriber.start(),r.started=!0,R(this,Ts)!=null&&r.subscriber.pause(R(this,Ts))),this}async emit(e,...n){const r=await Ce(this,Ot,sy).call(this,e,n);if(!r||r.listeners.length===0)return!1;const s=r.listeners.length;return r.listeners=r.listeners.filter(({listener:i,once:o})=>{const c=new t$(this,o?null:i,e);try{i.call(this,...n,c)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),R(this,Ss).delete(r.tag)),s>0}async listenerCount(e){if(e){const r=await Ce(this,Ot,sy).call(this,e);return r?r.listeners.length:0}let n=0;for(const{listeners:r}of R(this,Ss).values())n+=r.length;return n}async listeners(e){if(e){const r=await Ce(this,Ot,sy).call(this,e);return r?r.listeners.map(({listener:s})=>s):[]}let n=[];for(const{listeners:r}of R(this,Ss).values())n=n.concat(r.map(({listener:s})=>s));return n}async off(e,n){const r=await Ce(this,Ot,sy).call(this,e);if(!r)return this;if(n){const s=r.listeners.map(({listener:i})=>i).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(!n||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),R(this,Ss).delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:n,started:r,subscriber:s}=await Ce(this,Ot,r1).call(this,e);r&&s.stop(),R(this,Ss).delete(n)}else for(const[n,{started:r,subscriber:s}]of R(this,Ss))r&&s.stop(),R(this,Ss).delete(n);return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return this.off(e,n)}get destroyed(){return R(this,Gm)}destroy(){this.removeAllListeners();for(const e of R(this,xo).keys())this._clearTimeout(e);V(this,Gm,!0)}get paused(){return R(this,Ts)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(V(this,al,-1),R(this,Ts)!=null){if(R(this,Ts)==!!e)return;ge(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(n=>n.pause(e)),V(this,Ts,!!e);for(const n of R(this,xo).values())n.timer&&clearTimeout(n.timer),n.time=_A()-n.time}resume(){if(R(this,Ts)!=null){this._forEachSubscriber(e=>e.resume()),V(this,Ts,null);for(const e of R(this,xo).values()){let n=e.time;n<0&&(n=0),e.time=_A(),setTimeout(e.func,n)}}}}Ss=new WeakMap,Dd=new WeakMap,Ts=new WeakMap,Gm=new WeakMap,Fi=new WeakMap,$h=new WeakMap,Ud=new WeakMap,al=new WeakMap,Dx=new WeakMap,xo=new WeakMap,Ym=new WeakMap,Qm=new WeakMap,Ot=new WeakSet,Oi=async function(e){const n=R(this,Qm).cacheTimeout;if(n<0)return await this._perform(e);const r=n1(e.method,e);let s=R(this,Ud).get(r);return s||(s=this._perform(e),R(this,Ud).set(r,s),setTimeout(()=>{R(this,Ud).get(r)===s&&R(this,Ud).delete(r)},n)),await s},TT=async function(e,n,r){ge(r<ure,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:n,enableCcipRead:!0})});const s=fE(e);try{return $e(await this._perform({method:"call",transaction:s,blockTag:n}))}catch(i){if(!this.disableCcipRead&&SI(i)&&i.data&&r>=0&&n==="latest"&&s.to!=null&&Xn(i.data,0,4)==="0x556f1830"){const o=i.data,c=await Hs(s.to,this);let l;try{l=xre(Xn(i.data,4))}catch(h){ge(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}ge(l.sender.toLowerCase()===c.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const d=await this.ccipReadFetch(s,l.calldata,l.urls);ge(d!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:l.errorArgs}});const u={to:c,data:ir([l.selector,wre([d,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await Ce(this,Ot,TT).call(this,u,n,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw i}},_T=async function(e){const{value:n}=await $s({network:this.getNetwork(),value:e});return n},ry=async function(e,n,r){let s=this._getAddress(n),i=this._getBlockTag(r);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await Ce(this,Ot,_T).call(this,Ce(this,Ot,Oi).call(this,Object.assign(e,{address:s,blockTag:i})))},kT=async function(e,n){if(Sn(e,32))return await Ce(this,Ot,Oi).call(this,{method:"getBlock",blockHash:e,includeTransactions:n});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await Ce(this,Ot,Oi).call(this,{method:"getBlock",blockTag:r,includeTransactions:n})},sy=async function(e,n){let r=await TA(e,this);return r.type==="event"&&n&&n.length>0&&n[0].removed===!0&&(r=await TA({orphan:"drop-log",log:n[0]},this)),R(this,Ss).get(r.tag)||null},r1=async function(e){const n=await TA(e,this),r=n.tag;let s=R(this,Ss).get(r);return s||(s={subscriber:this._getSubscriber(n),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},R(this,Ss).set(r,s)),s};function mre(t,e){try{const n=IT(t,e);if(n)return nE(n)}catch{}return null}function IT(t,e){if(t==="0x")return null;try{const n=St(Xn(t,e,e+32)),r=St(Xn(t,n,n+32));return Xn(t,n+32,n+32+r)}catch{}return null}function _O(t){const e=Or(t);if(e.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(e,32-e.length),n}function gre(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}const yre=new Uint8Array([]);function wre(t){const e=[];let n=0;for(let r=0;r<t.length;r++)e.push(yre),n+=32;for(let r=0;r<t.length;r++){const s=jt(t[r]);e[r]=_O(n),e.push(_O(s.length)),e.push(gre(s)),n+=32+Math.ceil(s.length/32)*32}return ir(e)}const kO="0x0000000000000000000000000000000000000000000000000000000000000000";function xre(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};ge(im(t)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const n=Xn(t,0,32);ge(Xn(n,0,12)===Xn(kO,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Xn(n,12);try{const r=[],s=St(Xn(t,32,64)),i=St(Xn(t,s,s+32)),o=Xn(t,s+32);for(let c=0;c<i;c++){const l=mre(o,c*32);if(l==null)throw new Error("abort");r.push(l)}e.urls=r}catch{ge(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=IT(t,64);if(r==null)throw new Error("abort");e.calldata=r}catch{ge(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}ge(Xn(t,100,128)===Xn(kO,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Xn(t,96,100);try{const r=IT(t,128);if(r==null)throw new Error("abort");e.extraData=r}catch{ge(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function ju(t,e){if(t.provider)return t.provider;ge(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function IO(t,e){let n=fE(e);if(n.to!=null&&(n.to=Hs(n.to,t)),n.from!=null){const r=n.from;n.from=Promise.all([t.getAddress(),Hs(r,t)]).then(([s,i])=>(J(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else n.from=t.getAddress();return await $s(n)}class bre{constructor(e){G(this,"provider");wt(this,{provider:e||null})}async getNonce(e){return ju(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await IO(this,e)}async populateTransaction(e){const n=ju(this,"populateTransaction"),r=await IO(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const s=await this.provider.getNetwork();if(r.chainId!=null){const o=Je(r.chainId);J(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=s.chainId;const i=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||i)?J(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&i&&J(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await n.getFeeData();ge(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await n.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){const c=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=c,r.maxPriorityFeePerGas=c}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(ge(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):ge(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await $s(r)}async populateAuthorization(e){const n=Object.assign({},e);return n.chainId==null&&(n.chainId=(await ju(this,"getNetwork").getNetwork()).chainId),n.nonce==null&&(n.nonce=await this.getNonce()),n}async estimateGas(e){return ju(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return ju(this,"call").call(await this.populateCall(e))}async resolveName(e){return await ju(this,"resolveName").resolveName(e)}async sendTransaction(e){const n=ju(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const s=iE.from(r);return await n.broadcastTransaction(await this.signTransaction(s))}authorize(e){ge(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function vre(t){return JSON.parse(JSON.stringify(t))}var Ls,Xa,Fh,Md,zh,Jm,mu,jT,RT;class H8{constructor(e){se(this,mu);se(this,Ls);se(this,Xa);se(this,Fh);se(this,Md);se(this,zh);se(this,Jm);V(this,Ls,e),V(this,Xa,null),V(this,Fh,Ce(this,mu,jT).bind(this)),V(this,Md,!1),V(this,zh,null),V(this,Jm,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,n){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){R(this,Md)||(V(this,Md,!0),Ce(this,mu,jT).call(this,-2))}stop(){R(this,Md)&&(V(this,Md,!1),V(this,Jm,!0),Ce(this,mu,RT).call(this),R(this,Ls).off("block",R(this,Fh)))}pause(e){e&&Ce(this,mu,RT).call(this),R(this,Ls).off("block",R(this,Fh))}resume(){this.start()}}Ls=new WeakMap,Xa=new WeakMap,Fh=new WeakMap,Md=new WeakMap,zh=new WeakMap,Jm=new WeakMap,mu=new WeakSet,jT=async function(e){try{R(this,Xa)==null&&V(this,Xa,this._subscribe(R(this,Ls)));let n=null;try{n=await R(this,Xa)}catch(i){if(!rs(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(n==null){V(this,Xa,null),R(this,Ls)._recoverSubscriber(this,this._recover(R(this,Ls)));return}const r=await R(this,Ls).getNetwork();if(R(this,zh)||V(this,zh,r),R(this,zh).chainId!==r.chainId)throw new Error("chaid changed");if(R(this,Jm))return;const s=await R(this,Ls).send("eth_getFilterChanges",[n]);await this._emitResults(R(this,Ls),s)}catch(n){console.log("@TODO",n)}R(this,Ls).once("block",R(this,Fh))},RT=function(){const e=R(this,Xa);e&&(V(this,Xa,null),e.then(n=>{R(this,Ls).destroyed||R(this,Ls).send("eth_uninstallFilter",[n])}))};var Hh;class Ere extends H8{constructor(n,r){super(n);se(this,Hh);V(this,Hh,vre(r))}_recover(n){return new HI(n,R(this,Hh))}async _subscribe(n){return await n.send("eth_newFilter",[R(this,Hh)])}async _emitResults(n,r){for(const s of r)n.emit(R(this,Hh),n._wrapLog(s,n._network))}}Hh=new WeakMap;class Cre extends H8{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,n){for(const r of n)e.emit("pending",r)}}const Nre="bigint,boolean,function,number,string,symbol".split(/,/g);function s1(t){if(t==null||Nre.indexOf(typeof t)>=0||typeof t.getAddress=="function")return t;if(Array.isArray(t))return t.map(s1);if(typeof t=="object")return Object.keys(t).reduce((e,n)=>(e[n]=t[n],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function Are(t){return new Promise(e=>{setTimeout(e,t)})}function Gf(t){return t&&t.toLowerCase()}function jO(t){return t&&typeof t.pollingInterval=="number"}const V8={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class dm extends bre{constructor(n,r){super(n);G(this,"address");r=un(r),wt(this,{address:r})}connect(n){ge(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(n){return await this.populateCall(n)}async sendUncheckedTransaction(n){const r=s1(n),s=[];if(r.from){const o=r.from;s.push((async()=>{const c=await Hs(o,this.provider);J(c!=null&&c.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",n),r.from=c})())}else r.from=this.address;if(r.gasLimit==null&&s.push((async()=>{r.gasLimit=await this.provider.estimateGas({...r,from:this.address})})()),r.to!=null){const o=r.to;s.push((async()=>{r.to=await Hs(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(r);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(n){const r=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(n);return await new Promise((i,o)=>{const c=[1e3,100];let l=0;const d=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(r));return}}catch(u){if(rs(u,"CANCELLED")||rs(u,"BAD_DATA")||rs(u,"NETWORK_ERROR")||rs(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(rs(u,"INVALID_ARGUMENT")&&(l++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,l>10)){o(u);return}this.provider.emit("error",Bn("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{d()},c.pop()||4e3)};d()})}async signTransaction(n){const r=s1(n);if(r.from){const i=await Hs(r.from,this.provider);J(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",n),r.from=i}else r.from=this.address;const s=this.provider.getRpcTransaction(r);return await this.provider.send("eth_signTransaction",[s])}async signMessage(n){const r=typeof n=="string"?mc(n):n;return await this.provider.send("personal_sign",[$e(r),this.address.toLowerCase()])}async signTypedData(n,r,s){const i=s1(s),o=await uE.resolveNames(n,r,i,async c=>{const l=await Hs(c);return J(l!=null,"TypedData does not support null address","value",c),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(uE.getPayload(o.domain,r,o.value))])}async unlock(n){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),n,null])}async _legacySignMessage(n){const r=typeof n=="string"?mc(n):n;return await this.provider.send("eth_sign",[this.address.toLowerCase(),$e(r)])}}var Vh,Zm,cl,ec,aa,bo,ui,Ux,PT;class Sre extends pre{constructor(n,r){super(n,r);se(this,Ux);se(this,Vh);se(this,Zm);se(this,cl);se(this,ec);se(this,aa);se(this,bo);se(this,ui);V(this,Zm,1),V(this,Vh,Object.assign({},V8,r||{})),V(this,cl,[]),V(this,ec,null),V(this,bo,null),V(this,ui,null);{let i=null;const o=new Promise(c=>{i=c});V(this,aa,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(J(!s||n!=="any","staticNetwork cannot be used on special network 'any'","options",r),s&&n!=null&&V(this,bo,cc.from(n))):s&&(J(n==null||s.matches(n),"staticNetwork MUST match network object","options",r),V(this,bo,s))}_getOption(n){return R(this,Vh)[n]}get _network(){return ge(R(this,bo),"network is not available yet","NETWORK_ERROR"),R(this,bo)}async _perform(n){if(n.method==="call"||n.method==="estimateGas"){let s=n.transaction;if(s&&s.type!=null&&Je(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(n=Object.assign({},n,{transaction:Object.assign({},s,{type:void 0})}))}}const r=this.getRpcRequest(n);return r!=null?await this.send(r.method,r.args):super._perform(n)}async _detectNetwork(){const n=this._getOption("staticNetwork");if(n)if(n===!0){if(R(this,bo))return R(this,bo)}else return n;return R(this,ui)?await R(this,ui):this.ready?(V(this,ui,(async()=>{try{const r=cc.from(Je(await this.send("eth_chainId",[])));return V(this,ui,null),r}catch(r){throw V(this,ui,null),r}})()),await R(this,ui)):(V(this,ui,(async()=>{const r={id:d0(this,Zm)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:r});let s;try{s=(await this._send(r))[0],V(this,ui,null)}catch(i){throw V(this,ui,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return cc.from(Je(s.result));throw this.getRpcError(r,s)})()),await R(this,ui))}_start(){R(this,aa)==null||R(this,aa).resolve==null||(R(this,aa).resolve(),V(this,aa,null),(async()=>{for(;R(this,bo)==null&&!this.destroyed;)try{V(this,bo,await this._detectNetwork())}catch(n){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Bn("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:n}})),await Are(1e3)}Ce(this,Ux,PT).call(this)})())}async _waitUntilReady(){if(R(this,aa)!=null)return await R(this,aa).promise}_getSubscriber(n){return n.type==="pending"?new Cre(this):n.type==="event"?this._getOption("polling")?new HI(this,n.filter):new Ere(this,n.filter):n.type==="orphan"&&n.filter.orphan==="drop-log"?new z8("orphan"):super._getSubscriber(n)}get ready(){return R(this,aa)==null}getRpcTransaction(n){const r={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(n[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),r[i]=ha(Je(n[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{n[s]!=null&&(r[s]=$e(n[s]))}),n.accessList&&(r.accessList=If(n.accessList)),n.blobVersionedHashes&&(r.blobVersionedHashes=n.blobVersionedHashes.map(s=>s.toLowerCase())),n.authorizationList&&(r.authorizationList=n.authorizationList.map(s=>{const i=q$(s);return{address:i.address,nonce:ha(i.nonce),chainId:ha(i.chainId),yParity:ha(i.signature.yParity),r:ha(i.signature.r),s:ha(i.signature.s)}})),r}getRpcRequest(n){switch(n.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Gf(n.address),n.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Gf(n.address),n.blockTag]};case"getCode":return{method:"eth_getCode",args:[Gf(n.address),n.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Gf(n.address),"0x"+n.position.toString(16),n.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[n.signedTransaction]};case"getBlock":if("blockTag"in n)return{method:"eth_getBlockByNumber",args:[n.blockTag,!!n.includeTransactions]};if("blockHash"in n)return{method:"eth_getBlockByHash",args:[n.blockHash,!!n.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[n.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[n.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(n.transaction),n.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(n.transaction)]};case"getLogs":return n.filter&&n.filter.address!=null&&(Array.isArray(n.filter.address)?n.filter.address=n.filter.address.map(Gf):n.filter.address=Gf(n.filter.address)),{method:"eth_getLogs",args:[n.filter]}}return null}getRpcError(n,r){const{method:s}=n,{error:i}=r;if(s==="eth_estimateGas"&&i.message){const l=i.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return Bn("insufficient funds","INSUFFICIENT_FUNDS",{transaction:n.params[0],info:{payload:n,error:i}});if(l.match(/nonce/i)&&l.match(/too low/i))return Bn("nonce has already been used","NONCE_EXPIRED",{transaction:n.params[0],info:{payload:n,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const l=OT(i),d=bw.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",n.params[0],l?l.data:null);return d.info={error:i,payload:n},d}const o=JSON.stringify(Tre(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Bn("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:n,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const l=n.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Bn("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Bn("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Bn("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:i}});if(o.match(/only replay-protected/i))return Bn("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:l,info:{error:i}}})}let c=!!o.match(/the method .* does not exist/i);return c||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(c=!0),c?Bn("unsupported operation","UNSUPPORTED_OPERATION",{operation:n.method,info:{error:i,payload:n}}):Bn("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:n})}send(n,r){if(this.destroyed)return Promise.reject(Bn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:n}));const s=d0(this,Zm)._++,i=new Promise((o,c)=>{R(this,cl).push({resolve:o,reject:c,payload:{method:n,params:r,id:s,jsonrpc:"2.0"}})});return Ce(this,Ux,PT).call(this),i}async getSigner(n){n==null&&(n=0);const r=this.send("eth_accounts",[]);if(typeof n=="number"){const i=await r;if(n>=i.length)throw new Error("no such account");return new dm(this,i[n])}const{accounts:s}=await $s({network:this.getNetwork(),accounts:r});n=un(n);for(const i of s)if(un(i)===n)return new dm(this,n);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(r=>new dm(this,r))}destroy(){R(this,ec)&&(clearTimeout(R(this,ec)),V(this,ec,null));for(const{payload:n,reject:r}of R(this,cl))r(Bn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:n.method}));V(this,cl,[]),super.destroy()}}Vh=new WeakMap,Zm=new WeakMap,cl=new WeakMap,ec=new WeakMap,aa=new WeakMap,bo=new WeakMap,ui=new WeakMap,Ux=new WeakSet,PT=function(){if(R(this,ec))return;const n=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");V(this,ec,setTimeout(()=>{V(this,ec,null);const r=R(this,cl);for(V(this,cl,[]);r.length;){const s=[r.shift()];for(;r.length&&s.length!==R(this,Vh).batchMaxCount;)if(s.push(r.shift()),JSON.stringify(s.map(o=>o.payload)).length>R(this,Vh).batchMaxSize){r.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:c,reject:l,payload:d}of s){if(this.destroyed){l(Bn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:d.method}));continue}const u=o.filter(h=>h.id===d.id)[0];if(u==null){const h=Bn("missing response for request","BAD_DATA",{value:o,info:{payload:d}});this.emit("error",h),l(h);continue}if("error"in u){l(this.getRpcError(d,u));continue}c(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:c}of s)c(o)}})()}},n))};var Ld;class W8 extends Sre{constructor(n,r){super(n,r);se(this,Ld);let s=this._getOption("pollingInterval");s==null&&(s=V8.pollingInterval),V(this,Ld,s)}_getSubscriber(n){const r=super._getSubscriber(n);return jO(r)&&(r.pollingInterval=R(this,Ld)),r}get pollingInterval(){return R(this,Ld)}set pollingInterval(n){if(!Number.isInteger(n)||n<0)throw new Error("invalid interval");V(this,Ld,n),this._forEachSubscriber(r=>{jO(r)&&(r.pollingInterval=R(this,Ld))})}}Ld=new WeakMap;var Xm;class Eg extends W8{constructor(n,r,s){n==null&&(n="http://localhost:8545");super(r,s);se(this,Xm);typeof n=="string"?V(this,Xm,new kl(n)):V(this,Xm,n.clone())}_getConnection(){return R(this,Xm).clone()}async send(n,r){return await this._start(),await super.send(n,r)}async _send(n){const r=this._getConnection();r.body=JSON.stringify(n),r.setHeader("content-type","application/json");const s=await r.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}Xm=new WeakMap;function OT(t){if(t==null)return null;if(typeof t.message=="string"&&t.message.match(/revert/i)&&Sn(t.data))return{message:t.message,data:t.data};if(typeof t=="object"){for(const e in t){const n=OT(t[e]);if(n)return n}return null}if(typeof t=="string")try{return OT(JSON.parse(t))}catch{}return null}function DT(t,e){if(t!=null){if(typeof t.message=="string"&&e.push(t.message),typeof t=="object")for(const n in t)DT(t[n],e);if(typeof t=="string")try{return DT(JSON.parse(t),e)}catch{}}}function Tre(t){const e=[];return DT(t,e),e}var eg,tg;const nh=class nh extends W8{constructor(n,r,s){const i=Object.assign({},s??{},{batchMaxCount:1});J(n&&n.request,"invalid EIP-1193 provider","ethereum",n);super(r,i);se(this,eg);se(this,tg);V(this,tg,null),s&&s.providerInfo&&V(this,tg,s.providerInfo),V(this,eg,async(o,c)=>{const l={method:o,params:c};this.emit("debug",{action:"sendEip1193Request",payload:l});try{const d=await n.request(l);return this.emit("debug",{action:"receiveEip1193Result",result:d}),d}catch(d){const u=new Error(d.message);throw u.code=d.code,u.data=d.data,u.payload=l,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return R(this,tg)}async send(n,r){return await this._start(),await super.send(n,r)}async _send(n){J(!Array.isArray(n),"EIP-1193 does not support batch request","payload",n);try{const r=await R(this,eg).call(this,n.method,n.params||[]);return[{id:n.id,result:r}]}catch(r){return[{id:n.id,error:{code:r.code,data:r.data,message:r.message}}]}}getRpcError(n,r){switch(r=JSON.parse(JSON.stringify(r)),r.error.code||-1){case 4001:r.error.message=`ethers-user-denied: ${r.error.message}`;break;case 4200:r.error.message=`ethers-unsupported: ${r.error.message}`;break}return super.getRpcError(n,r)}async hasSigner(n){n==null&&(n=0);const r=await this.send("eth_accounts",[]);return typeof n=="number"?r.length>n:(n=n.toLowerCase(),r.filter(s=>s.toLowerCase()===n).length!==0)}async getSigner(n){if(n==null&&(n=0),!await this.hasSigner(n))try{await R(this,eg).call(this,"eth_requestAccounts",[])}catch(r){const s=r.payload;throw this.getRpcError(s,{id:s.id,error:r})}return await super.getSigner(n)}static async discover(n){if(n==null&&(n={}),n.provider)return new nh(n.provider);const r=n.window?n.window:typeof window<"u"?window:null;if(r==null)return null;const s=n.anyProvider;if(s&&r.ethereum)return new nh(r.ethereum);if(!("addEventListener"in r&&"dispatchEvent"in r&&"removeEventListener"in r))return null;const i=n.timeout?n.timeout:300;return i===0?null:await new Promise((o,c)=>{let l=[];const d=f=>{l.push(f.detail),s&&u()},u=()=>{if(clearTimeout(h),l.length)if(n&&n.filter){const f=n.filter(l.map(p=>Object.assign({},p.info)));if(f==null)o(null);else if(f instanceof nh)o(f);else{let p=null;if(f.uuid&&(p=l.filter(g=>f.uuid===g.info.uuid)[0]),p){const{provider:m,info:g}=p;o(new nh(m,void 0,{providerInfo:g}))}else c(Bn("filter returned unknown info","UNSUPPORTED_OPERATION",{value:f}))}}else{const{provider:f,info:p}=l[0];o(new nh(f,void 0,{providerInfo:p}))}else o(null);r.removeEventListener("eip6963:announceProvider",d)},h=setTimeout(()=>{u()},i);r.addEventListener("eip6963:announceProvider",d),r.dispatchEvent(new Event("eip6963:requestProvider"))})}};eg=new WeakMap,tg=new WeakMap;let Dr=nh;const vi=[{inputs:[{internalType:"address",name:"_admin",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"oldAdmin",type:"address"},{indexed:!1,internalType:"address",name:"newAdmin",type:"address"}],name:"AdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"receiver",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"AdminDecision",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"by",type:"address"},{indexed:!1,internalType:"string",name:"evidenceCid",type:"string"}],name:"AppealFiled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"appealStartAt",type:"uint256"},{indexed:!1,internalType:"uint256",name:"appealDeadline",type:"uint256"}],name:"AppealWindowOpened",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"locker",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"totalLocked",type:"uint256"},{indexed:!1,internalType:"bool",name:"isNative",type:"bool"}],name:"FundsLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bool",name:"allowed",type:"bool"}],name:"NativeAllowed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Redeemed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"seller",type:"address"}],name:"SellerConfirmed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"bool",name:"allowed",type:"bool"}],name:"TokenAllowed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"}],name:"TradeCompleted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"seller",type:"address"},{indexed:!0,internalType:"address",name:"buyer",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"TradeCreated",type:"event"},{stateMutability:"payable",type:"fallback"},{inputs:[],name:"APPEAL_DEADLINE_WINDOW",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"APPEAL_OPEN_DELAY",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"BPS_DENOM",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"BUYER_FEE_BPS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SELLER_EXTRA_BPS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"TOTAL_ADMIN_BPS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"admin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"},{internalType:"bool",name:"releaseToBuyer",type:"bool"}],name:"adminDecision",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"allowedNative",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"allowedTokens",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"autoOpenAppealWindow",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"confirmReceived",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"},{internalType:"address",name:"_buyer",type:"address"}],name:"createTrade",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"evidenceCIDs",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"},{internalType:"string",name:"_evidenceCid",type:"string"}],name:"fileAppeal",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"},{internalType:"uint256",name:"index",type:"uint256"}],name:"getEvidenceAt",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"getEvidenceCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"lockFunds",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"lockFundsNative",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"},{internalType:"address",name:"_to",type:"address"}],name:"recoverTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"redeemAfterAppealWindow",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newAdmin",type:"address"}],name:"setAdmin",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_allowed",type:"bool"}],name:"setAllowedNative",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"bool",name:"_allowed",type:"bool"}],name:"setAllowedToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"tradeCounter",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"trades",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"address",name:"buyer",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"enum P2PEscrowV2.Status",name:"status",type:"uint8"},{internalType:"uint256",name:"lockedAt",type:"uint256"},{internalType:"uint256",name:"appealStartAt",type:"uint256"},{internalType:"bool",name:"sellerConfirmed",type:"bool"},{internalType:"bool",name:"appealFiled",type:"bool"},{internalType:"bool",name:"isNativeLocked",type:"bool"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],Di=56,On="0x02ADD84281025BeeB807f5b94Ea947599146ca00",ph={BNB:{symbol:"BNB",address:"0x0000000000000000000000000000000000000000",decimals:18,isNative:!0},WBNB:{symbol:"WBNB",address:"0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c",decimals:18,isNative:!1},USDT:{symbol:"USDT",address:"0x55d398326f99059fF775485246999027B3197955",decimals:18,isNative:!1},USDC:{symbol:"USDC",address:"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d",decimals:18,isNative:!1},BUSD:{symbol:"BUSD",address:"0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56",decimals:18,isNative:!1},CAKE:{symbol:"CAKE",address:"0x0E09FaBB73Bd3Ade0a17ECC321fD13a19e81cE82",decimals:18,isNative:!1}},Cw="https://bsc-dataseed.binance.org/",_re={chainId:"0x38",chainName:"BSC Mainnet",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:[Cw],blockExplorerUrls:["https://bscscan.com"]},q8=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],type:"function"}],K8={56:{name:"BSC Mainnet",rpcUrl:"https://bsc-dataseed.binance.org/",blockExplorerUrl:"https://bscscan.com"}},RO=Object.freeze(Object.defineProperty({__proto__:null,BSC_MAINNET_CHAIN_ID:Di,BSC_MAINNET_PARAMS:_re,BSC_MAINNET_RPC:Cw,ERC20_ABI:q8,NETWORKS:K8,TOKENS:ph,ZOTRUST_CONTRACT_ABI:vi,ZOTRUST_CONTRACT_ADDRESS:On},Symbol.toStringTag,{value:"Module"})),PO=()=>localStorage.getItem("authToken"),kre=t=>{localStorage.setItem("authToken",t)},ss=AI((t,e)=>({user:null,agents:[],locations:[],isLoading:!1,setUser:n=>{t({user:n})},updateProfile:async n=>{try{const r=PO();if(!r)return console.warn("No auth token found - user needs to login first"),alert("Please connect your wallet and login first before updating your profile."),!1;const s=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({name:n.name,phone:n.phone,location_id:n.locationId,selected_agent_ids:n.selectedAgentIds})});if(s.ok){if((await s.json()).success){const o=e().user;return o&&t({user:{...o,name:n.name,phone:n.phone,locationId:n.locationId,selectedAgentIds:n.selectedAgentIds}}),!0}}else{const i=await s.json();console.error("Profile update failed:",i.error),alert(`Failed to update profile: ${i.error||"Unknown error"}`)}return!1}catch(r){return console.error("Profile update error:",r),alert("Failed to update profile. Please try again."),!1}},fetchAgents:async n=>{try{const r=n?`/api/agents?location_id=${encodeURIComponent(n)}`:"/api/agents",s=await fetch(r);if(s.ok){const i=await s.json();if(i.success){const o=i.data.map(c=>({id:c.id,branchName:c.branch_name,mobile:c.mobile,address:c.address||"",locationId:c.location_id,locationName:c.location_name||"Unknown Location",verified:c.verified,createdByAdmin:c.created_by_admin,createdAt:c.created_at}));t({agents:o})}else console.error("Failed to fetch agents:",i.error),t({agents:[]})}else console.error("Failed to fetch agents"),t({agents:[]})}catch(r){console.error("Failed to fetch agents:",r),t({agents:[]})}},fetchLocations:async()=>{try{const n=await fetch("/api/locations");if(n.ok){const r=await n.json();r.success?t({locations:r.data}):(console.error("Failed to fetch locations:",r.error),t({locations:[]}))}else console.error("Failed to fetch locations"),t({locations:[]})}catch(n){console.error("Failed to fetch locations:",n),t({locations:[]})}},fetchUserProfile:async n=>{t({isLoading:!0});try{const r=PO(),s=await fetch(`/api/auth/user-by-address?address=${encodeURIComponent(n)}`,{method:"GET",headers:r?{Authorization:`Bearer ${r}`}:{}});if(s.ok){const i=await s.json();if(i.success&&i.data){const o=i.data,c={id:String(o.id??""),address:o.address,name:o.name??void 0,phone:o.phone??void 0,locationId:o.location_id??void 0,selectedAgentIds:o.selected_agent_ids?o.selected_agent_ids.map(String):[],verified:!!o.verified,verifiedAt:o.verified_at??void 0,createdAt:o.created_at??new Date().toISOString()};t({user:c});return}}if(!r){const i={id:Date.now().toString(),address:n,verified:!1,createdAt:new Date().toISOString()};t({user:i})}}catch(r){console.error("Failed to fetch user profile:",r)}finally{t({isLoading:!1})}},loginWithWallet:async(n,r,s)=>{try{const i=await fetch("/api/auth/wallet-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:n,signature:r,message:s})});if(i.ok){const o=await i.json();if(o.success&&o.data.token)return kre(o.data.token),await e().fetchUserProfile(n),!0}return!1}catch(i){return console.error("Login error:",i),!1}},refreshUserProfile:async()=>{const n=e().user;n!=null&&n.address&&(console.log(" Refreshing user profile after verification..."),await e().fetchUserProfile(n.address))}})),Ire=Symbol(),OO=Object.getPrototypeOf,UT=new WeakMap,jre=t=>t&&(UT.has(t)?UT.get(t):OO(t)===Object.prototype||OO(t)===Array.prototype),Rre=t=>jre(t)&&t[Ire]||null,DO=(t,e=!0)=>{UT.set(t,e)},gE={},VI=t=>typeof t=="object"&&t!==null,Pre=t=>VI(t)&&!Zx.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),G8=(t,e)=>{const n=MT.get(t);if((n==null?void 0:n[0])===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return DO(r,!0),MT.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),c={value:i,enumerable:o,configurable:!0};if(Zx.has(i))DO(i,!1);else if(cu.has(i)){const[l,d]=cu.get(i);c.value=G8(l,d())}Object.defineProperty(r,s,c)}),Object.preventExtensions(r)},Ore=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const c=Reflect.deleteProperty(s,i);return c&&r(["delete",[i],o]),c},set(s,i,o,c){const l=!t()&&Reflect.has(s,i),d=Reflect.get(s,i,c);if(l&&(UO(d,o)||Nw.has(o)&&UO(d,Nw.get(o))))return!0;n(i),VI(o)&&(o=Rre(o)||o);const u=!cu.has(o)&&Ure(o)?Un(o):o;return e(i,u),Reflect.set(s,i,u,c),r(["set",[i],o,d]),!0}}),cu=new WeakMap,Zx=new WeakSet,MT=new WeakMap,i1=[1],Nw=new WeakMap;let UO=Object.is,Dre=(t,e)=>new Proxy(t,e),Ure=Pre,Mre=G8,Lre=Ore;function Un(t={}){if(!VI(t))throw new Error("object required");const e=Nw.get(t);if(e)return e;let n=i1[0];const r=new Set,s=(y,x=++i1[0])=>{n!==x&&(i=n=x,r.forEach(w=>w(y,x)))};let i=n;const o=(y=i1[0])=>(i!==y&&(i=y,l.forEach(([x])=>{const w=x[1](y);w>n&&(n=w)})),n),c=y=>(x,w)=>{const b=[...x];b[1]=[y,...b[1]],s(b,w)},l=new Map,d=(y,x)=>{const w=!Zx.has(x)&&cu.get(x);if(w){if((gE?"production":void 0)!=="production"&&l.has(y))throw new Error("prop listener already exists");if(r.size){const b=w[2](c(y));l.set(y,[w,b])}else l.set(y,[w])}},u=y=>{var x;const w=l.get(y);w&&(l.delete(y),(x=w[1])==null||x.call(w))},h=y=>(r.add(y),r.size===1&&l.forEach(([w,b],v)=>{if((gE?"production":void 0)!=="production"&&b)throw new Error("remove already exists");const E=w[2](c(v));l.set(v,[w,E])}),()=>{r.delete(y),r.size===0&&l.forEach(([w,b],v)=>{b&&(b(),l.set(v,[w]))})});let f=!0;const p=Lre(()=>f,d,u,s),m=Dre(t,p);Nw.set(t,m);const g=[t,o,h];return cu.set(m,g),Reflect.ownKeys(t).forEach(y=>{const x=Object.getOwnPropertyDescriptor(t,y);"value"in x&&x.writable&&(m[y]=t[y])}),f=!1,m}function cs(t,e,n){const r=cu.get(t);(gE?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let c=!1;const d=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,c&&e(i.splice(0))}))});return c=!0,()=>{c=!1,d()}}function Aw(t){const e=cu.get(t);(gE?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return Mre(n,r())}function Cg(t){return Zx.add(t),t}function Bre(){return{proxyStateMap:cu,refSet:Zx,snapCache:MT,versionHolder:i1,proxyCache:Nw}}function ls(t,e,n,r){let s=t[e];return cs(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:$re,snapCache:Fre}=Bre(),Qb=t=>$re.has(t);function zre(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const d=Fre.get(c),u=d==null?void 0:d[1];if(u&&!s.has(u)){const h=new Map(r);s.set(u,h)}},o=d=>s.get(d)||r,c={data:e,index:n,epoch:0,get size(){return Qb(this)||i(),o(this).size},get(d){const h=o(this).get(d);if(h===void 0){this.epoch;return}return this.data[h]},has(d){const u=o(this);return this.epoch,u.has(d)},set(d,u){if(!Qb(this))throw new Error("Cannot perform mutations on a snapshot");const h=r.get(d);return h===void 0?(r.set(d,this.index),this.data[this.index++]=u):this.data[h]=u,this.epoch++,this},delete(d){if(!Qb(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(d);return u===void 0?!1:(delete this.data[u],r.delete(d),this.epoch++,!0)},clear(){if(!Qb(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(d){this.epoch,o(this).forEach((h,f)=>{d(this.data[h],f,this)})},*entries(){this.epoch;const d=o(this);for(const[u,h]of d)yield[u,this.data[h]]},*keys(){this.epoch;const d=o(this);for(const u of d.keys())yield u},*values(){this.epoch;const d=o(this);for(const u of d.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},l=Un(c);return Object.defineProperties(l,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(l),l}var MO={};const ne={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof MO<"u"?MO.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}},IS_DEVELOPMENT:typeof process<"u"&&!1},Y8={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return(t==null?void 0:t.filter(n=>n.chainNamespace===e))||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){var s;if(!e)return;const n=t.find(i=>i.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return((s=ne.CHAIN_NAME_MAP)==null?void 0:s[r])||void 0}},Q8=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var Hre=20,Vre=1,gf=1e6,LO=1e6,Wre=-7,qre=21,Kre=!1,Xx="[big.js] ",Rf=Xx+"Invalid ",JC=Rf+"decimal places",Gre=Rf+"rounding mode",J8=Xx+"Division by zero",bn={},yc=void 0,Yre=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Z8(){function t(e){var n=this;if(!(n instanceof t))return e===yc?Z8():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Rf+"value");e=e===0&&1/e<0?"-0":String(e)}Qre(n,e)}n.constructor=t}return t.prototype=bn,t.DP=Hre,t.RM=Vre,t.NE=Wre,t.PE=qre,t.strict=Kre,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function Qre(t,e){var n,r,s;if(!Yre.test(e))throw Error(Rf+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function Pf(t,e,n,r){var s=t.c;if(n===yc&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(Gre);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==yc))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==yc||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function Of(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}bn.abs=function(){var t=new this.constructor(this);return t.s=1,t};bn.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,c=n.e,l=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,c!=l)return c>l^e?1:-1;for(o=(c=r.length)<(l=s.length)?c:l,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return c==l?0:c>l^e?1:-1};bn.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>gf)throw Error(JC);if(!s[0])throw Error(J8);if(!r[0])return t.s=i,t.c=[t.e=0],t;var c,l,d,u,h,f=s.slice(),p=c=s.length,m=r.length,g=r.slice(0,c),y=g.length,x=t,w=x.c=[],b=0,v=o+(x.e=e.e-t.e)+1;for(x.s=i,i=v<0?0:v,f.unshift(0);y++<c;)g.push(0);do{for(d=0;d<10;d++){if(c!=(y=g.length))u=c>y?1:-1;else for(h=-1,u=0;++h<c;)if(s[h]!=g[h]){u=s[h]>g[h]?1:-1;break}if(u<0){for(l=y==c?s:f;y;){if(g[--y]<l[y]){for(h=y;h&&!g[--h];)g[h]=9;--g[h],g[y]+=10}g[y]-=l[y]}for(;!g[0];)g.shift()}else break}w[b++]=u?d:++d,g[0]&&u?g[y]=r[p]||0:g=[r[p]]}while((p++<m||g[0]!==yc)&&i--);return!w[0]&&b!=1&&(w.shift(),x.e--,v--),b>v&&Pf(x,v,n.RM,g[0]!==yc),x};bn.eq=function(t){return this.cmp(t)===0};bn.gt=function(t){return this.cmp(t)>0};bn.gte=function(t){return this.cmp(t)>-1};bn.lt=function(t){return this.cmp(t)<0};bn.lte=function(t){return this.cmp(t)<1};bn.minus=bn.sub=function(t){var e,n,r,s,i=this,o=i.constructor,c=i.s,l=(t=new o(t)).s;if(c!=l)return t.s=-l,i.plus(t);var d=i.c.slice(),u=i.e,h=t.c,f=t.e;if(!d[0]||!h[0])return h[0]?t.s=-l:d[0]?t=new o(i):t.s=1,t;if(c=u-f){for((s=c<0)?(c=-c,r=d):(f=u,r=h),r.reverse(),l=c;l--;)r.push(0);r.reverse()}else for(n=((s=d.length<h.length)?d:h).length,c=l=0;l<n;l++)if(d[l]!=h[l]){s=d[l]<h[l];break}if(s&&(r=d,d=h,h=r,t.s=-t.s),(l=(n=h.length)-(e=d.length))>0)for(;l--;)d[e++]=0;for(l=e;n>c;){if(d[--n]<h[n]){for(e=n;e&&!d[--e];)d[e]=9;--d[e],d[n]+=10}d[n]-=h[n]}for(;d[--l]===0;)d.pop();for(;d[0]===0;)d.shift(),--f;return d[0]||(t.s=1,d=[f=0]),t.c=d,t.e=f,t};bn.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(J8);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};bn.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};bn.plus=bn.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,c=s.c,l=t.e,d=t.c;if(!c[0]||!d[0])return d[0]||(c[0]?t=new i(s):t.s=s.s),t;if(c=c.slice(),e=o-l){for(e>0?(l=o,r=d):(e=-e,r=c),r.reverse();e--;)r.push(0);r.reverse()}for(c.length-d.length<0&&(r=d,d=c,c=r),e=d.length,n=0;e;c[e]%=10)n=(c[--e]=c[e]+d[e]+n)/10|0;for(n&&(c.unshift(n),++l),e=c.length;c[--e]===0;)c.pop();return t.c=c,t.e=l,t};bn.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-LO||t>LO)throw Error(Rf+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};bn.prec=function(t,e){if(t!==~~t||t<1||t>gf)throw Error(Rf+"precision");return Pf(new this.constructor(this),t,e)};bn.round=function(t,e){if(t===yc)t=0;else if(t!==~~t||t<-gf||t>gf)throw Error(JC);return Pf(new this.constructor(this),t+this.e+1,e)};bn.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,c=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(Xx+"No square root");i=Math.sqrt(+Of(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=c.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return Pf(t,(s.DP-=4)+t.e+1,s.RM)};bn.times=bn.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,c=i.length,l=n.e,d=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=l+d,o<c&&(e=s,s=i,i=e,d=o,o=c,c=d),e=new Array(d=o+c);d--;)e[d]=0;for(l=c;l--;){for(c=0,d=o+l;d>l;)c=e[d]+i[l]*s[d-l-1]+c,e[d--]=c%10,c=c/10|0;e[d]=c}for(c?++t.e:e.shift(),l=e.length;!e[--l];)e.pop();return t.c=e,t};bn.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==yc){if(t!==~~t||t<0||t>gf)throw Error(JC);for(n=Pf(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return Of(n,!0,!!r)};bn.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==yc){if(t!==~~t||t<0||t>gf)throw Error(JC);for(n=Pf(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return Of(n,!1,!!r)};bn[Symbol.for("nodejs.util.inspect.custom")]=bn.toJSON=bn.toString=function(){var t=this,e=t.constructor;return Of(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};bn.toNumber=function(){var t=+Of(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Xx+"Imprecise conversion");return t};bn.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==yc){if(t!==~~t||t<1||t>gf)throw Error(Rf+"precision");for(n=Pf(new r(n),t,e);n.c.length<t;)n.c.push(0)}return Of(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};bn.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Xx+"valueOf disallowed");return Of(t,t.e<=e.NE||t.e>=e.PE,!0)};var Vl=Z8();const Jre={bigNumber(t){return t?new Vl(t):new Vl(0)},multiply(t,e){if(t===void 0||e===void 0)return new Vl(0);const n=new Vl(t),r=new Vl(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new Vl(0).toFixed(e):new Vl(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new Vl(e).toNumber()}},Zre=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],Xre=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],ese=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],tse={getERC20Abi:t=>ne.USDT_CONTRACT_ADDRESSES.includes(t)?ese:Zre,getSwapAbi:()=>Xre},jr={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},ml={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.message=="string",r=typeof e.code=="number";return n&&r}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){return ml.isRpcProviderError(t)?t.code===ml.RPC_ERROR_CODE.USER_REJECTED_REQUEST||ml.isUserRejectedMessage(t.message):t instanceof Error?ml.isUserRejectedMessage(t.message):!1}};let nse=class extends Error{constructor(e,n){super(n.message,{cause:e}),this.name=ml.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=n.code}},WI=class extends nse{constructor(e){super(e,{code:ml.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=ml.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}};const lt={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version"};function kA(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const st={setItem(t,e){iy()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(iy())return localStorage.getItem(t)||void 0},removeItem(t){iy()&&localStorage.removeItem(t)},clear(){iy()&&localStorage.clear()}};function iy(){return typeof window<"u"&&typeof localStorage<"u"}function Sw(t,e){return e==="light"?{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var BO={};const IA=(typeof process<"u"&&typeof BO<"u"?BO.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",X8=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],rse="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Vt={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:IA,SECURE_SITE_DASHBOARD:`${IA}/dashboard`,SECURE_SITE_FAVICON:`${IA}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[ne.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[ne.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[ne.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},ye={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=ye.getActiveNamespace(),e=ye.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{st.setItem(lt.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=st.getItem(lt.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{st.removeItem(lt.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{st.setItem(lt.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{st.setItem(lt.ACTIVE_CAIP_NETWORK_ID,t),ye.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return st.getItem(lt.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{st.removeItem(lt.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=kA(t);st.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=ye.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),st.setItem(lt.RECENT_WALLETS,JSON.stringify(e)),st.setItem(lt.RECENT_WALLET,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=st.getItem(lt.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},getRecentWallet(){try{const t=st.getItem(lt.RECENT_WALLET);return t?JSON.parse(t):null}catch{console.info("Unable to get AppKit recent")}return null},deleteRecentWallet(){try{st.removeItem(lt.RECENT_WALLET)}catch{console.info("Unable to delete AppKit recent")}},setConnectedConnectorId(t,e){try{const n=kA(t);st.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return st.getItem(lt.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=kA(t);return st.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{st.setItem(lt.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return st.getItem(lt.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{st.removeItem(lt.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return st.getItem(lt.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var n;const t=st.getItem(lt.ACTIVE_CAIP_NETWORK_ID);return(n=t==null?void 0:t.split(":"))==null?void 0:n[1]},setConnectionStatus(t){try{st.setItem(lt.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return st.getItem(lt.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=st.getItem(lt.CONNECTED_NAMESPACES);return t!=null&&t.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));st.setItem(lt.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=ye.getConnectedNamespaces();e.includes(t)||(e.push(t),ye.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=ye.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),ye.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return st.getItem(lt.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{st.setItem(lt.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{st.removeItem(lt.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=st.getItem(lt.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=ye.getBalanceCache();st.setItem(lt.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=ye.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;ye.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=ye.getBalanceCache();e[t.caipAddress]=t,st.setItem(lt.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=st.getItem(lt.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=ye.getBalanceCache();st.setItem(lt.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=ye.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),ye.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=ye.getNativeBalanceCache();e[t.caipAddress]=t,st.setItem(lt.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=st.getItem(lt.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=ye.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;ye.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=ye.getEnsCache();e[t.address]=t,st.setItem(lt.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=ye.getEnsCache();st.setItem(lt.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=st.getItem(lt.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=ye.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;ye.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=ye.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},st.setItem(lt.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=ye.getIdentityCache();st.setItem(lt.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{st.removeItem(lt.PORTFOLIO_CACHE),st.removeItem(lt.NATIVE_BALANCE_CACHE),st.removeItem(lt.ENS_CACHE),st.removeItem(lt.IDENTITY_CACHE),st.removeItem(lt.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{st.setItem(lt.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=st.getItem(lt.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=ye.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const c=s.get(o.connectorId),l=o.connectorId===ne.CONNECTOR_ID.AUTH;if(c&&!l){const d=new Set(c.accounts.map(h=>h.address.toLowerCase())),u=o.accounts.filter(h=>!d.has(h.address.toLowerCase()));c.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};st.setItem(lt.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=st.getItem(lt.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=ye.getConnections(),s=r[n]??[],i=new Map(s.map(c=>[c.connectorId,c])),o=i.get(t);o&&(o.accounts.filter(l=>l.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(l=>l.address.toLowerCase()!==e.toLowerCase())})),st.setItem(lt.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=st.getItem(lt.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=ye.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),st.setItem(lt.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=ye.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),st.setItem(lt.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(ye.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=st.getItem(lt.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){var n;try{const s=(n=ye.getTransactionsCache()[t])==null?void 0:n[e];if(s&&!this.isCacheExpired(s.timestamp,this.cacheExpiry.transactionsHistory))return s.transactions;ye.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=ye.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},st.setItem(lt.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:n,transactions:r})}},removeTransactionsCache({address:t,chainId:e}){try{const n=ye.getTransactionsCache(),r=(n==null?void 0:n[t])||{},{[e]:s,...i}=r;st.setItem(lt.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=st.getItem(lt.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const n=ye.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;ye.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=ye.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},st.setItem(lt.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=ye.getTokenPriceCache();st.setItem(lt.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t==null?void 0:t.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{console.info("Unable to get latest AppKit version")}},getLatestAppKitVersionCache(){try{const t=st.getItem(lt.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{console.info("Unable to get latest AppKit version cache")}return{}},updateLatestAppKitVersion(t){try{const e=ye.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,st.setItem(lt.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{console.info("Unable to update latest AppKit version on local storage",t)}}},Be={isMobile(){var t;return this.isClient()?!!(window!=null&&window.matchMedia&&typeof window.matchMedia=="function"&&((t=window.matchMedia("(pointer:coarse)"))!=null&&t.matches)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t==null?void 0:t.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return Be.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Vt.TEN_SEC_MS:!0},isAllowedRetry(t,e=Vt.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},isSafeApp(){var t,e;if(Be.isClient()&&window.self!==window.top)try{const n=(e=(t=window==null?void 0:window.location)==null?void 0:t.ancestorOrigins)==null?void 0:e[0],r="https://app.safe.global";if(n){const s=new URL(n),i=new URL(r);return s.hostname===i.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Vt.FOUR_MINUTES_MS},getNetworkId(t){return t==null?void 0:t.split(":")[1]},getPlainAddress(t){return t==null?void 0:t.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(Be.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r&&(r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`)),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!Be.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?ye.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window==null||window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window==null?void 0:window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var n,r;if(typeof window>"u")return!1;const t=window!=null&&window.matchMedia&&typeof window.matchMedia=="function"?(n=window.matchMedia("(display-mode: standalone)"))==null?void 0:n.matches:!1,e=(r=window==null?void 0:window.navigator)==null?void 0:r.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,Be.wait(2e3)])},parseBalance(t,e){let n="0.000";if(typeof t=="string"){const l=Number(t);if(!isNaN(l)){const d=(Math.floor(l*1e3)/1e3).toFixed(3);d&&(n=d)}}const[r,s]=n.split("."),i=r||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return ne.W3M_API_URL},getBlockchainApiUrl(){return ne.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return ne.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){var e,n;return typeof t=="string"?t:typeof((n=(e=t==null?void 0:t.issues)==null?void 0:e[0])==null?void 0:n.message)=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?Vt.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in ne.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,c=t.substring(0,r+i),l=t.substring(r+i,o),d=t.substring(s),u=l+n;return c+u+d}};function sse(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function $O(t){return sse(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const eF="2.37.12";let S0={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${eF}`},Mn=class LT extends Error{constructor(e,n={}){var c;const r=(()=>{var l;return n.cause instanceof LT?n.cause.details:(l=n.cause)!=null&&l.message?n.cause.message:n.details})(),s=n.cause instanceof LT&&n.cause.docsPath||n.docsPath,i=(c=S0.getDocsUrl)==null?void 0:c.call(S0,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...S0.version?[`Version: ${S0.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=eF}walk(e){return tF(this,e)}};function tF(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?tF(t.cause,e):e?null:t}class dje extends Mn{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}}let nF=class extends Mn{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class hje extends Mn{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function qI(t,{dir:e,size:n=32}={}){return typeof t=="string"?ise(t,{dir:e,size:n}):ose(t,{dir:e,size:n})}function ise(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new nF({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function ose(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new nF({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let ase=class extends Mn{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}};class pje extends Mn{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class cse extends Mn{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let lse=class extends Mn{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function jA(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function ZC(t,{size:e}){if($O(t)>e)throw new lse({givenSize:$O(t),maxSize:e})}function dse(t,e={}){const{signed:n}=e;e.size&&ZC(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function gje(t,e={}){let n=t;if(e.size&&(ZC(n,{size:e.size}),n=jA(n)),jA(n)==="0x00")return!1;if(jA(n)==="0x01")return!0;throw new cse(n)}function yje(t,e={}){return Number(dse(t,e))}const use=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function FO(t,e={}){return typeof t=="number"||typeof t=="bigint"?fse(t,e):typeof t=="string"?sF(t,e):typeof t=="boolean"?hse(t,e):rF(t,e)}function hse(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(ZC(n,{size:e.size}),qI(n,{size:e.size})):n}function rF(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=use[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(ZC(r,{size:e.size}),qI(r,{dir:"right",size:e.size})):r}function fse(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new ase({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?qI(c,{size:r}):c}const pse=new TextEncoder;function sF(t,e={}){const n=pse.encode(t);return rF(n,e)}let mse=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const Yh=(t,e,n)=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString():s,n),xje={gwei:9,wei:18},gse={ether:-9,wei:9};function KI(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function yE(t,e="wei"){return KI(t,gse[e])}const bje=t=>t,GI=t=>t;class Ey extends Mn{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${GI(o)}`,e&&`Request body: ${Yh(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class iF extends Mn{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${GI(r)}`,`Request body: ${Yh(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}class zO extends Mn{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${GI(n)}`,`Request body: ${Yh(e)}`],name:"TimeoutError"})}}const yse=-1;class Ii extends Mn{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof iF?e.code:n??yse}}class ro extends Ii{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class Tw extends Ii{constructor(e){super(e,{code:Tw.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Tw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class _w extends Ii{constructor(e){super(e,{code:_w.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(_w,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class kw extends Ii{constructor(e,{method:n}={}){super(e,{code:kw.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(kw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Iw extends Ii{constructor(e){super(e,{code:Iw.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Iw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Ng extends Ii{constructor(e){super(e,{code:Ng.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(Ng,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class jw extends Ii{constructor(e){super(e,{code:jw.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(jw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Rw extends Ii{constructor(e){super(e,{code:Rw.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Rw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Pw extends Ii{constructor(e){super(e,{code:Pw.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Pw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Ag extends Ii{constructor(e){super(e,{code:Ag.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Ag,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class mh extends Ii{constructor(e,{method:n}={}){super(e,{code:mh.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(mh,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Sg extends Ii{constructor(e){super(e,{code:Sg.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Sg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Ow extends Ii{constructor(e){super(e,{code:Ow.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Ow,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Qh extends ro{constructor(e){super(e,{code:Qh.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Qh,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class Dw extends ro{constructor(e){super(e,{code:Dw.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(Dw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Uw extends ro{constructor(e,{method:n}={}){super(e,{code:Uw.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(Uw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Mw extends ro{constructor(e){super(e,{code:Mw.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Mw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Lw extends ro{constructor(e){super(e,{code:Lw.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Lw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Bw extends ro{constructor(e){super(e,{code:Bw.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Bw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class $w extends ro{constructor(e){super(e,{code:$w.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty($w,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Fw extends ro{constructor(e){super(e,{code:Fw.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Fw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class zw extends ro{constructor(e){super(e,{code:zw.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(zw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Hw extends ro{constructor(e){super(e,{code:Hw.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(Hw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Vw extends ro{constructor(e){super(e,{code:Vw.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Vw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Ww extends ro{constructor(e){super(e,{code:Ww.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(Ww,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class qw extends ro{constructor(e){super(e,{code:qw.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(qw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class wse extends Ii{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class YI extends Mn{constructor({cause:e,message:n}={}){var s;const r=(s=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(YI,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(YI,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class xse extends Mn{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${yE(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(xse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class bse extends Mn{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${yE(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(bse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class vse extends Mn{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(vse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class Ese extends Mn{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(Ese,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class Cse extends Mn{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(Cse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class Nse extends Mn{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(Nse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class Ase extends Mn{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(Ase,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class Sse extends Mn{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(Sse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class Tse extends Mn{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(Tse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class _se extends Mn{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${yE(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${yE(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(_se,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class vje extends Mn{constructor({cause:e}){super(`An error occurred while executing: ${e==null?void 0:e.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}const Eje=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockTimestamp",outputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],stateMutability:"view",type:"function"}],Cje=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],oF=[{inputs:[{name:"dns",type:"bytes"}],name:"DNSDecodingFailed",type:"error"},{inputs:[{name:"ens",type:"string"}],name:"DNSEncodingFailed",type:"error"},{inputs:[],name:"EmptyAddress",type:"error"},{inputs:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"HttpError",type:"error"},{inputs:[],name:"InvalidBatchGatewayResponse",type:"error"},{inputs:[{name:"errorData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{name:"name",type:"bytes"},{name:"resolver",type:"address"}],name:"ResolverNotContract",type:"error"},{inputs:[{name:"name",type:"bytes"}],name:"ResolverNotFound",type:"error"},{inputs:[{name:"primary",type:"string"},{name:"primaryAddress",type:"bytes"}],name:"ReverseAddressMismatch",type:"error"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"UnsupportedResolverProfile",type:"error"}],Nje=[...oF,{name:"resolveWithGateways",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],Aje=[...oF,{name:"reverseWithGateways",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"uint256",name:"coinType"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolver"},{type:"address",name:"reverseResolver"}]}],Sje=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],Tje=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],_je=[{name:"isValidSignature",type:"function",stateMutability:"view",inputs:[{name:"hash",type:"bytes32"},{name:"signature",type:"bytes"}],outputs:[{name:"",type:"bytes4"}]}],kje=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],Jb=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}];function kse(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const RA=new Map;function Ise({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=l();o();const h=u.map(({args:f})=>f);h.length!==0&&t(h).then(f=>{s&&Array.isArray(f)&&f.sort(s);for(let p=0;p<u.length;p++){const{resolve:m}=u[p];m==null||m([f[p],f])}}).catch(f=>{for(let p=0;p<u.length;p++){const{reject:m}=u[p];m==null||m(f)}})},o=()=>RA.delete(e),c=()=>l().map(({args:u})=>u),l=()=>RA.get(e)||[],d=u=>RA.set(e,[...l(),u]);return{flush:o,async schedule(u){const{promise:h,resolve:f,reject:p}=kse();return(n==null?void 0:n([...c(),u]))&&i(),l().length>0?(d({args:u,resolve:f,reject:p}),h):(d({args:u,resolve:f,reject:p}),setTimeout(i,r),h)}}}async function aF(t){return new Promise(e=>setTimeout(e,t))}function jse(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:c=0}={})=>{const l=async({error:d})=>{const u=typeof e=="function"?e({count:c,error:d}):e;u&&await aF(u),o({count:c+1})};try{const d=await t();s(d)}catch(d){if(c<n&&await r({count:c,error:d}))return l({error:d});i(d)}};o()})}const BT=256;let Zb=BT,Xb;function Rse(t=11){if(!Xb||Zb+t>BT*2){Xb="",Zb=0;for(let e=0;e<BT;e++)Xb+=(256+Math.random()*256|0).toString(16).substring(1)}return Xb.substring(Zb,Zb+++t)}const ev=new mse(8192);function Pse(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(ev.get(n))return ev.get(n);const r=t().finally(()=>ev.delete(n));return ev.set(n,r),r}function Ose(t,e={}){return async(n,r={})=>{var h;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:c=3,uid:l}={...e,...r},{method:d}=n;if((h=i==null?void 0:i.exclude)!=null&&h.includes(d))throw new mh(new Error("method not supported"),{method:d});if(i!=null&&i.include&&!i.include.includes(d))throw new mh(new Error("method not supported"),{method:d});const u=s?sF(`${l}.${Yh(n)}`):void 0;return Pse(()=>jse(async()=>{try{return await t(n)}catch(f){const p=f;switch(p.code){case Tw.code:throw new Tw(p);case _w.code:throw new _w(p);case kw.code:throw new kw(p,{method:n.method});case Iw.code:throw new Iw(p);case Ng.code:throw new Ng(p);case jw.code:throw new jw(p);case Rw.code:throw new Rw(p);case Pw.code:throw new Pw(p);case Ag.code:throw new Ag(p);case mh.code:throw new mh(p,{method:n.method});case Sg.code:throw new Sg(p);case Ow.code:throw new Ow(p);case Qh.code:throw new Qh(p);case Dw.code:throw new Dw(p);case Uw.code:throw new Uw(p);case Mw.code:throw new Mw(p);case Lw.code:throw new Lw(p);case Bw.code:throw new Bw(p);case $w.code:throw new $w(p);case Fw.code:throw new Fw(p);case zw.code:throw new zw(p);case Hw.code:throw new Hw(p);case Vw.code:throw new Vw(p);case Ww.code:throw new Ww(p);case qw.code:throw new qw(p);case 5e3:throw new Qh(p);default:throw f instanceof Mn?f:new wse(p)}}},{delay:({count:f,error:p})=>{var m;if(p&&p instanceof Ey){const g=(m=p==null?void 0:p.headers)==null?void 0:m.get("Retry-After");if(g!=null&&g.match(/\d/))return Number.parseInt(g,10)*1e3}return~~(1<<f)*o},retryCount:c,shouldRetry:({error:f})=>Dse(f)}),{enabled:s,id:u})}}function Dse(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===Sg.code||t.code===Ng.code:t instanceof Ey&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function Use(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}function Mse(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const c=new AbortController;n>0&&(o=setTimeout(()=>{r&&c.abort()},n)),s(await t({signal:(c==null?void 0:c.signal)||null}))}catch(c){(c==null?void 0:c.name)==="AbortError"&&i(e),i(c)}finally{clearTimeout(o)}})()})}function Lse(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const HO=Lse();function Bse(t,e={}){return{async request(n){var f;const{body:r,fetchFn:s=e.fetchFn??fetch,onRequest:i=e.onRequest,onResponse:o=e.onResponse,timeout:c=e.timeout??1e4}=n,l={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:d,method:u,signal:h}=l;try{const p=await Mse(async({signal:g})=>{const y={...l,body:Array.isArray(r)?Yh(r.map(v=>({jsonrpc:"2.0",id:v.id??HO.take(),...v}))):Yh({jsonrpc:"2.0",id:r.id??HO.take(),...r}),headers:{"Content-Type":"application/json",...d},method:u||"POST",signal:h||(c>0?g:null)},x=new Request(t,y),w=await(i==null?void 0:i(x,y))??{...y,url:t};return await s(w.url??t,w)},{errorInstance:new zO({body:r,url:t}),timeout:c,signal:!0});o&&await o(p);let m;if((f=p.headers.get("Content-Type"))!=null&&f.startsWith("application/json"))m=await p.json();else{m=await p.text();try{m=JSON.parse(m||"{}")}catch(g){if(p.ok)throw g;m={error:m}}}if(!p.ok)throw new Ey({body:r,details:Yh(m.error)||p.statusText,headers:p.headers,status:p.status,url:t});return m}catch(p){throw p instanceof Ey||p instanceof zO?p:new Ey({body:r,cause:p,url:t})}}}}function cF({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:c},l){const d=Rse();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:c},request:Ose(r,{methods:e,retryCount:s,retryDelay:i,uid:d}),value:l}}function VO(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=$se,retryCount:o,retryDelay:c}=e;return({chain:l,pollingInterval:d=4e3,timeout:u,...h})=>{let f=t,p=()=>{};const m=cF({key:n,name:r,async request({method:g,params:y}){let x;const w=async(b=0)=>{const v=f[b]({...h,chain:l,retryCount:0,timeout:u});try{const E=await v.request({method:g,params:y});return p({method:g,params:y,response:E,transport:v,status:"success"}),E}catch(E){if(p({error:E,method:g,params:y,transport:v,status:"error"}),i(E)||b===f.length-1||(x??(x=f.slice(b+1).some(k=>{const{include:C,exclude:S}=k({chain:l}).config.methods||{};return C?C.includes(g):S?!S.includes(g):!0})),!x))throw E;return w(b+1)}};return w()},retryCount:o,retryDelay:c,type:"fallback"},{onResponse:g=>p=g,transports:f.map(g=>g({chain:l,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};Fse({chain:l,interval:g.interval??d,onTransports:y=>f=y,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:f,weights:g.weights})}return m}}function $se(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===Ag.code||t.code===Qh.code||YI.nodeMessage.test(t.message)||t.code===5e3))}function Fse({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:c={}}){const{stability:l=.7,latency:d=.3}=c,u=[],h=async()=>{const f=await Promise.all(o.map(async g=>{const y=g({chain:t,retryCount:0,timeout:i}),x=Date.now();let w,b;try{await(r?r({transport:y}):y.request({method:"net_listening"})),b=1}catch{b=0}finally{w=Date.now()}return{latency:w-x,success:b}}));u.push(f),u.length>s&&u.shift();const p=Math.max(...u.map(g=>Math.max(...g.map(({latency:y})=>y)))),m=o.map((g,y)=>{const x=u.map(k=>k[y].latency),b=1-x.reduce((k,C)=>k+C,0)/x.length/p,v=u.map(k=>k[y].success),E=v.reduce((k,C)=>k+C,0)/v.length;return E===0?[0,y]:[d*b+l*E,y]}).sort((g,y)=>y[0]-g[0]);n(m.map(([,g])=>o[g])),await aF(e),h()};h()}class zse extends Mn{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function tv(t,e={}){const{batch:n,fetchFn:r,fetchOptions:s,key:i="http",methods:o,name:c="HTTP JSON-RPC",onFetchRequest:l,onFetchResponse:d,retryDelay:u,raw:h}=e;return({chain:f,retryCount:p,timeout:m})=>{const{batchSize:g=1e3,wait:y=0}=typeof n=="object"?n:{},x=e.retryCount??p,w=m??e.timeout??1e4,b=t||(f==null?void 0:f.rpcUrls.default.http[0]);if(!b)throw new zse;const v=Bse(b,{fetchFn:r,fetchOptions:s,onRequest:l,onResponse:d,timeout:w});return cF({key:i,methods:o,name:c,async request({method:E,params:k}){const C={method:E,params:k},{schedule:S}=Ise({id:b,wait:y,shouldSplitBatch(P){return P.length>g},fn:P=>v.request({body:P}),sort:(P,H)=>P.id-H.id}),N=async P=>n?S(P):[await v.request({body:P})],[{error:I,result:F}]=await N(C);if(h)return{error:I,result:F};if(I)throw new iF({body:C,error:I,url:b});return F},retryCount:x,retryDelay:u,timeout:w,type:"http"},{fetchOptions:s,url:b})}}async function T0(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class eb{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await T0(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}sendBeacon({body:e,...n}){const r=this.createUrl(n);return navigator.sendBeacon(r.toString(),e?JSON.stringify(e):void 0)}}const Hse={getFeatureValue(t,e){const n=e==null?void 0:e[t];return n===void 0?Vt.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(Be.isTelegram()){if(Be.isIos())return t.filter(e=>e!=="google");if(Be.isMac())return t.filter(e=>e!=="x");if(Be.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},ct=Un({features:Vt.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Vt.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1}),fe={state:ct,subscribeKey(t,e){return ls(ct,t,e)},setOptions(t){Object.assign(ct,t)},setRemoteFeatures(t){var n,r;if(!t)return;const e={...ct.remoteFeatures,...t};ct.remoteFeatures=e,(n=ct.remoteFeatures)!=null&&n.socials&&(ct.remoteFeatures.socials=Hse.filterSocialsByPlatform(ct.remoteFeatures.socials)),(r=ct.features)!=null&&r.pay&&(ct.remoteFeatures.email=!1,ct.remoteFeatures.socials=!1)},setFeatures(t){var n;if(!t)return;ct.features||(ct.features=Vt.DEFAULT_FEATURES);const e={...ct.features,...t};ct.features=e,(n=ct.features)!=null&&n.pay&&ct.remoteFeatures&&(ct.remoteFeatures.email=!1,ct.remoteFeatures.socials=!1)},setProjectId(t){ct.projectId=t},setCustomRpcUrls(t){ct.customRpcUrls=t},setAllWallets(t){ct.allWallets=t},setIncludeWalletIds(t){ct.includeWalletIds=t},setExcludeWalletIds(t){ct.excludeWalletIds=t},setFeaturedWalletIds(t){ct.featuredWalletIds=t},setTokens(t){ct.tokens=t},setTermsConditionsUrl(t){ct.termsConditionsUrl=t},setPrivacyPolicyUrl(t){ct.privacyPolicyUrl=t},setCustomWallets(t){ct.customWallets=t},setIsSiweEnabled(t){ct.isSiweEnabled=t},setIsUniversalProvider(t){ct.isUniversalProvider=t},setSdkVersion(t){ct.sdkVersion=t},setMetadata(t){ct.metadata=t},setDisableAppend(t){ct.disableAppend=t},setEIP6963Enabled(t){ct.enableEIP6963=t},setDebug(t){ct.debug=t},setEnableWalletGuide(t){ct.enableWalletGuide=t},setEnableAuthLogger(t){ct.enableAuthLogger=t},setEnableWallets(t){ct.enableWallets=t},setPreferUniversalLinks(t){ct.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(Vt.SIWX_DEFAULTS))t[e]??(t[e]=n);ct.siwx=t},setConnectMethodsOrder(t){ct.features={...ct.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){ct.features={...ct.features,walletFeaturesOrder:t}},setSocialsOrder(t){ct.remoteFeatures={...ct.remoteFeatures,socials:t}},setCollapseWallets(t){ct.features={...ct.features,collapseWallets:t}},setEnableEmbedded(t){ct.enableEmbedded=t},setAllowUnsupportedChain(t){ct.allowUnsupportedChain=t},setManualWCControl(t){ct.manualWCControl=t},setEnableNetworkSwitch(t){ct.enableNetworkSwitch=t},setEnableMobileFullScreen(t){ct.enableMobileFullScreen=Be.isMobile()&&t},setEnableReconnect(t){ct.enableReconnect=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(ct.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){ct.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return ct.universalProviderConfigOverride},getSnapshot(){return Aw(ct)}},Hu=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Cr=Un({...Hu}),Vse={state:Cr,subscribeKey(t,e){return ls(Cr,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=Be.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){Cr.message=Hu.message,Cr.variant=Hu.variant,Cr.svg=Hu.svg,Cr.open=Hu.open,Cr.autoClose=Hu.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=Hu.autoClose}){Cr.open?(Cr.open=!1,setTimeout(()=>{Cr.message=t,Cr.variant=n,Cr.svg=e,Cr.open=!0,Cr.autoClose=r},150)):(Cr.message=t,Cr.variant=n,Cr.svg=e,Cr.open=!0,Cr.autoClose=r)}},lc=Vse,Wse={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},lF=Be.getBlockchainApiUrl(),ti=Un({clientId:null,api:new eb({baseUrl:lF,clientId:null}),supportedChains:{http:[],ws:[]}}),yt={state:ti,async get(t){const{st:e,sv:n}=yt.getSdkProperties(),r=fe.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return ti.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=fe.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{ti.supportedChains.http.length||await yt.getSupportedNetworks()}catch{return!1}return ti.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await yt.get({path:"v1/supported-chains"});return ti.supportedChains=t,t}catch{return ti.supportedChains}},async fetchIdentity({address:t}){const e=ye.getIdentityFromCacheForAddress(t);if(e)return e;const n=await yt.get({path:`/v1/identity/${t}`,params:{sender:$.state.activeCaipAddress?Be.getPlainAddress($.state.activeCaipAddress):void 0}});return ye.updateIdentityCache({address:t,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){var l;if(!await yt.isNetworkSupported((l=$.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return{data:[],next:void 0};const o=ye.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const c=await yt.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return ye.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:c}),c},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){var o;return await yt.isNetworkSupported((o=$.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?yt.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){var n;return await yt.isNetworkSupported((n=$.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?yt.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){var s;if(!await yt.isNetworkSupported((s=$.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))return{fungibles:[]};const n=ye.getTokenPriceCacheForAddresses(t);if(n)return n;const r=await ti.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:fe.state.projectId},headers:{"Content-Type":"application/json"}});return ye.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){var r;return await yt.isNetworkSupported((r=$.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?yt.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){var s;const{st:e,sv:n}=yt.getSdkProperties();if(!await yt.isNetworkSupported((s=$.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return yt.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){var o;if(!await yt.isNetworkSupported((o=$.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return ti.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Vt.CONVERT_SLIPPAGE_TOLERANCE},projectId:fe.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){var o;const{st:r,sv:s}=yt.getSdkProperties();if(!await yt.isNetworkSupported((o=$.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return yt.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){var d;const{st:r,sv:s}=yt.getSdkProperties();if(!await yt.isNetworkSupported((d=$.state.activeCaipNetwork)==null?void 0:d.caipNetworkId))return lc.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,c=ye.getBalanceCacheForCaipAddress(o);if(c)return c;const l=await yt.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return ye.updateBalanceCache({caipAddress:o,balance:l,timestamp:Date.now()}),l},async lookupEnsName(t){var n;return await yt.isNetworkSupported((n=$.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?yt.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){var r,s;if(!await yt.isNetworkSupported((r=$.state.activeCaipNetwork)==null?void 0:r.caipNetworkId))return[];const n=(s=$.getAccountData())==null?void 0:s.address;return yt.get({path:`/v1/profile/reverse/${t}`,params:{sender:n,apiVersion:"2"}})},async getEnsNameSuggestions(t){var n;return await yt.isNetworkSupported((n=$.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?yt.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){var i;return await yt.isNetworkSupported((i=$.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?ti.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){var c;return await yt.isNetworkSupported((c=$.state.activeCaipNetwork)==null?void 0:c.caipNetworkId)?(await ti.api.post({path:"/v1/generators/onrampurl",params:{projectId:fe.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await yt.isNetworkSupported((e=$.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await yt.get({path:"/v1/onramp/options"})}catch{return Wse}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){var s;try{return await yt.isNetworkSupported((s=$.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await ti.api.post({path:"/v1/onramp/quote",params:{projectId:fe.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){var n;return await yt.isNetworkSupported((n=$.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?yt.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){var s;return await yt.isNetworkSupported((s=$.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?ti.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:fe.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){ti.clientId=t,ti.api=new eb({baseUrl:lF,clientId:t})}};var Tg={};const qse="https://secure.walletconnect.org/sdk",Kse=(typeof process<"u"&&typeof Tg<"u"?Tg.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||qse,Gse=(typeof process<"u"&&typeof Tg<"u"?Tg.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",Yse=(typeof process<"u"&&typeof Tg<"u"?Tg.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",Ze={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},fr={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},ho={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},Qse={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===ho.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${ho.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===ho.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${ho.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===ne.CHAIN.SOLANA&&t===ho.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${ho.COINBASE.url}/dapp?cb_url=${r}`),e===ne.CHAIN.BITCOIN&&t===ho.BINANCE.id&&!("binancew3w"in window)){const s=$.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${(s==null?void 0:s.id)??1}`),c=new URL(ho.BINANCE.deeplink);c.searchParams.set("appId",ho.BINANCE.appId),c.searchParams.set("startPagePath",i),c.searchParams.set("startPageQuery",o);const l=new URL(ho.BINANCE.url);l.searchParams.set("_dp",window.btoa(c.toString())),window.location.href=l.toString()}}},Jse=Object.freeze({enabled:!0,events:[]}),Zse=new eb({baseUrl:Be.getAnalyticsUrl(),clientId:null}),Xse=5,eie=60*1e3,Wl=Un({...Jse}),tie={state:Wl,subscribeKey(t,e){return ls(Wl,t,e)},async sendError(t,e){if(!Wl.enabled)return;const n=Date.now();if(Wl.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<eie}).length>=Xse)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};Wl.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:c}=fe.state;await Zse.post({path:"/e",params:{projectId:i,st:o,sv:c||"html-wagmi-4.2.2"},body:{eventId:Be.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){Wl.enabled=!0},disable(){Wl.enabled=!1},clearEvents(){Wl.events=[]}};class yf extends Error{constructor(e,n,r){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=n,this.originalError=r,r&&r instanceof Error&&(this.originalName=r.name),Object.setPrototypeOf(this,yf.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const c=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${c}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,yf):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function WO(t,e){let n="";try{t instanceof Error?n=t.message:typeof t=="string"?n=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?n="Unknown error":n=(t==null?void 0:t.message)||JSON.stringify(t):n=String(t)}catch(s){n="Unknown error",console.error("Error parsing error message",s)}const r=t instanceof yf?t:new yf(n,e,t);throw tie.sendError(r,r.category),r}function $o(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(c){return WO(c,e)}}:i=(...o)=>{try{return s(...o)}catch(c){return WO(c,e)}},n[r]=i}else n[r]=s}),n}const Ri=Un({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),nie={state:Ri,subscribeNetworkImages(t){return cs(Ri.networkImages,()=>t(Ri.networkImages))},subscribeKey(t,e){return ls(Ri,t,e)},subscribe(t){return cs(Ri,()=>t(Ri))},setWalletImage(t,e){Ri.walletImages[t]=e},setNetworkImage(t,e){Ri.networkImages[t]=e},setChainImage(t,e){Ri.chainImages[t]=e},setConnectorImage(t,e){Ri.connectorImages={...Ri.connectorImages,[t]:e}},setTokenImage(t,e){Ri.tokenImages[t]=e},setCurrencyImage(t,e){Ri.currencyImages[t]=e}},No=$o(nie),rie={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},PA=Un({networkImagePromises:{}}),dF={async fetchWalletImage(t){if(t)return await dt._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(PA.networkImagePromises[t]||(PA.networkImagePromises[t]=dt._fetchNetworkImage(t)),await PA.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return No.state.walletImages[t]},getWalletImage(t){if(t!=null&&t.image_url)return t==null?void 0:t.image_url;if(t!=null&&t.image_id)return No.state.walletImages[t.image_id]},getNetworkImage(t){var e,n,r;if((e=t==null?void 0:t.assets)!=null&&e.imageUrl)return(n=t==null?void 0:t.assets)==null?void 0:n.imageUrl;if((r=t==null?void 0:t.assets)!=null&&r.imageId)return No.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return No.state.networkImages[t]},getConnectorImage(t){var e;if(t!=null&&t.imageUrl)return t.imageUrl;if((e=t==null?void 0:t.info)!=null&&e.icon)return t.info.icon;if(t!=null&&t.imageId)return No.state.connectorImages[t.imageId]},getChainImage(t){return No.state.networkImages[rie[t]]},getTokenImage(t){if(t)return No.state.tokenImages[t]}},sie=Be.getAnalyticsUrl(),iie=new eb({baseUrl:sie,clientId:null}),oie=["MODAL_CREATED"],aie=45,Us=Un({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1}),Lt={state:Us,subscribe(t){return cs(Us,()=>t(Us))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=fe.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},_setPendingEvent(t){var e,n;try{let r=(e=$.getAccountData())==null?void 0:e.address;if("address"in t.data&&t.data.address&&(r=t.data.address),oie.includes(t.data.event)||typeof window>"u")return;const s=(n=$.getActiveCaipNetwork())==null?void 0:n.caipNetworkId;this.state.pendingEvents.push({eventId:Be.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:r,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:s}}}),Us.reportedErrors.FORBIDDEN=!1,JSON.stringify(Us.pendingEvents).length/1024>aie&&Lt._submitPendingEvents()}catch(r){console.warn("_setPendingEvent",r)}},sendEvent(t){var n;Us.timestamp=Date.now(),Us.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];((n=fe.state.features)!=null&&n.analytics||e.includes(t.event))&&Lt._setPendingEvent(Us),this._subscribeToVisibilityChange()},_submitPendingEvents(){if(Us.pendingEvents.length!==0)try{iie.sendBeacon({path:"/batch",params:Lt.getSdkProperties(),body:Us.pendingEvents}),Us.reportedErrors.FORBIDDEN=!1,Us.pendingEvents=[]}catch{Us.reportedErrors.FORBIDDEN=!0}},_subscribeToVisibilityChange(){var t;Us.subscribedToVisibilityChange||typeof document>"u"||(Us.subscribedToVisibilityChange=!0,(t=document==null?void 0:document.addEventListener)==null||t.call(document,"visibilitychange",()=>{document.visibilityState==="hidden"&&Lt._submitPendingEvents()}))}},cie=Be.getApiUrl(),ni=new eb({baseUrl:cie,clientId:null}),lie=40,qO=4,die=20,vt=Un({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[]}),dt={state:vt,subscribeKey(t,e){return ls(vt,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=fe.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return fe.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${ni.baseUrl}/getWalletImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});No.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${ni.baseUrl}/public/getAssetImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});No.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${ni.baseUrl}/public/getAssetImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});No.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${ni.baseUrl}/public/getCurrencyImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});No.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${ni.baseUrl}/public/getTokenImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});No.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){const e=t.length,n=Be.isMobile()?t==null?void 0:t.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(ho).map(o=>o.id).includes(s.id)):t,r=e-n.length;return{filteredWallets:n,mobileFilteredOutWalletsLength:r}},async fetchProjectConfig(){return(await ni.get({path:"/appkit/v1/config",params:dt._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await ni.get({path:"/projects/v1/origins",params:dt._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===ne.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=ne.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const t=$.getAllRequestedCaipNetworks(),e=t==null?void 0:t.map(({assets:n})=>n==null?void 0:n.imageId).filter(Boolean).filter(n=>!dF.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>dt._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=Ie.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>dt._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>dt._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>dt._fetchTokenImage(e)))},async fetchWallets(t){var o;const e=t.exclude??[];dt._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(ho).map(c=>c.id));const r=await ni.get({path:"/getWallets",params:{...dt._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:(o=t.include)==null?void 0:o.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=dt._filterWalletsByPlatform(r==null?void 0:r.data);return{data:s||[],count:r==null?void 0:r.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=Ie.state.connectors;if(!(t!=null&&t.length))return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),$.state.activeChain===ne.CHAIN.EVM){const s=[...t.flatMap(i=>{var o;return((o=i.connectors)==null?void 0:o.map(c=>{var l;return(l=c.info)==null?void 0:l.rdns}))||[]}),...t.map(i=>{var o;return(o=i.info)==null?void 0:o.rdns})].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:n}=await dt.fetchWallets(e);vt.explorerWallets=n;const r=$.getRequestedCaipNetworkIds().join(",");vt.explorerFilteredWallets=n.filter(s=>{var i;return(i=s.chains)==null?void 0:i.some(o=>r.includes(o))})},async fetchFeaturedWallets(){const{featuredWalletIds:t}=fe.state;if(t!=null&&t.length){const e={...dt._getSdkProperties(),page:1,entries:(t==null?void 0:t.length)??qO,include:t},{data:n}=await dt.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>dt._fetchWalletImage(i))),vt.featured=r,vt.allFeatured=r}},async fetchRecommendedWallets(){try{vt.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=fe.state,r=[...e??[],...n??[]].filter(Boolean),s=$.getRequestedCaipNetworkIds().join(","),i={page:1,entries:qO,include:t,exclude:r,chains:s},{data:o,count:c}=await dt.fetchWallets(i),l=ye.getRecentWallets(),d=o.map(h=>h.image_id).filter(Boolean),u=l.map(h=>h.image_id).filter(Boolean);await Promise.allSettled([...d,...u].map(h=>dt._fetchWalletImage(h))),vt.recommended=o,vt.allRecommended=o,vt.count=c??0}catch{}finally{vt.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=fe.state,s=$.getRequestedCaipNetworkIds().join(","),i=[...vt.recommended.map(({id:h})=>h),...n??[],...r??[]].filter(Boolean),o={page:t,entries:lie,include:e,exclude:i,chains:s},{data:c,count:l,mobileFilteredOutWalletsLength:d}=await dt.fetchWallets(o);vt.mobileFilteredOutWalletsLength=d+(vt.mobileFilteredOutWalletsLength??0);const u=c.slice(0,die).map(h=>h.image_id).filter(Boolean);await Promise.allSettled(u.map(h=>dt._fetchWalletImage(h))),vt.wallets=Be.uniqueBy([...vt.wallets,...dt._filterOutExtensions(c)],"id").filter(h=>{var f;return(f=h.chains)==null?void 0:f.some(p=>s.includes(p))}),vt.count=l>vt.count?l:vt.count,vt.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await dt.fetchWallets(e);n&&n.forEach(r=>{vt.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=fe.state,s=$.getRequestedCaipNetworkIds().join(",");vt.search=[];const i={page:1,entries:100,search:t==null?void 0:t.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await dt.fetchWallets(i);Lt.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const c=o.map(l=>l.image_id).filter(Boolean);await Promise.allSettled([...c.map(l=>dt._fetchWalletImage(l)),Be.wait(300)]),vt.search=dt._filterOutExtensions(o)},initPromise(t,e){const n=vt.promises[t];return n||(vt.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0,fetchWalletRanks:s=!0}={}){const i=[t&&dt.initPromise("connectorImages",dt.fetchConnectorImages),e&&dt.initPromise("featuredWallets",dt.fetchFeaturedWallets),n&&dt.initPromise("recommendedWallets",dt.fetchRecommendedWallets),r&&dt.initPromise("networkImages",dt.fetchNetworkImages),s&&dt.initPromise("walletRanks",dt.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){var t;(t=fe.state.features)!=null&&t.analytics&&dt.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await ni.get({path:"/getAnalyticsConfig",params:dt._getSdkProperties()});fe.setFeatures({analytics:t})}catch{fe.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!(t!=null&&t.length)){vt.featured=vt.allFeatured,vt.recommended=vt.allRecommended;return}const e=$.getRequestedCaipNetworkIds().join(",");vt.featured=vt.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.recommended=vt.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.filteredWallets=vt.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})},clearFilterByNamespaces(){vt.filteredWallets=[]},setFilterByNamespace(t){if(!t){vt.featured=vt.allFeatured,vt.recommended=vt.allRecommended;return}const e=$.getRequestedCaipNetworkIds().join(",");vt.featured=vt.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.recommended=vt.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.filteredWallets=vt.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})}},hn=Un({view:"Connect",history:["Connect"],transactionStack:[]}),uie={state:hn,subscribeKey(t,e){return ls(hn,t,e)},pushTransactionStack(t){hn.transactionStack.push(t)},popTransactionStack(t){const e=hn.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n==null||n();break;case"error":r==null||r(),ut.goBack();break;case"cancel":s==null||s(),ut.goBack();break}},push(t,e){t!==hn.view&&(hn.view=t,hn.history.push(t),hn.data=e)},reset(t,e){hn.view=t,hn.history=[t],hn.data=e},replace(t,e){hn.history.at(-1)===t||(hn.view=t,hn.history[hn.history.length-1]=t,hn.data=e)},goBack(){var r,s;const t=$.state.activeCaipAddress,e=ut.state.view==="ConnectingFarcaster",n=!t&&e;if(hn.history.length>1){hn.history.pop();const[i]=hn.history.slice(-1);i&&(t&&i==="Connect"?hn.view="Account":hn.view=i)}else Dt.close();(r=hn.data)!=null&&r.wallet&&(hn.data.wallet=void 0),(s=hn.data)!=null&&s.redirectView&&(hn.data.redirectView=void 0),setTimeout(()=>{var i,o,c;if(n){$.setAccountProp("farcasterUrl",void 0,$.state.activeChain);const l=Ie.getAuthConnector();(i=l==null?void 0:l.provider)==null||i.reload();const d=Aw(fe.state);(c=(o=l==null?void 0:l.provider)==null?void 0:o.syncDappData)==null||c.call(o,{metadata:d.metadata,sdkVersion:d.sdkVersion,projectId:d.projectId,sdkType:d.sdkType})}},100)},goBackToIndex(t){if(hn.history.length>1){hn.history=hn.history.slice(0,t+1);const[e]=hn.history.slice(-1);e&&(hn.view=e)}},goBackOrCloseModal(){ut.state.history.length>1?ut.goBack():Dt.close()}},ut=$o(uie),Oc=Un({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),$T={state:Oc,subscribe(t){return cs(Oc,()=>t(Oc))},setThemeMode(t){Oc.themeMode=t;try{const e=Ie.getAuthConnector();if(e){const n=$T.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:Sw(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){Oc.themeVariables={...Oc.themeVariables,...t};try{const e=Ie.getAuthConnector();if(e){const n=$T.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:Sw(Oc.themeVariables,Oc.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Aw(Oc)}},fi=$o($T),uF=Object.fromEntries(Q8.map(t=>[t,void 0])),hie=Object.fromEntries(Q8.map(t=>[t,!0])),rn=Un({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:uF,filterByNamespaceMap:hie}),fie={state:rn,subscribe(t){return cs(rn,()=>{t(rn)})},subscribeKey(t,e){return ls(rn,t,e)},initialize(t){t.forEach(e=>{const n=ye.getConnectedConnectorId(e);n&&Ie.setConnectorId(n,e)})},setActiveConnector(t){t&&(rn.activeConnector=Cg(t))},setConnectors(t){t.filter(s=>!rn.allConnectors.some(i=>i.id===s.id&&Ie.getConnectorName(i.name)===Ie.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&rn.allConnectors.push(Cg(s))});const n=Ie.getEnabledNamespaces(),r=Ie.getEnabledConnectors(n);rn.connectors=Ie.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(rn.filterByNamespaceMap).forEach(e=>{rn.filterByNamespaceMap[e]=!1}),t.forEach(e=>{rn.filterByNamespaceMap[e]=!0}),Ie.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){rn.filterByNamespaceMap[t]=e,Ie.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=Ie.getEnabledNamespaces(),e=Ie.getEnabledConnectors(t),n=Ie.areAllNamespacesEnabled();rn.connectors=Ie.mergeMultiChainConnectors(e),n?dt.clearFilterByNamespaces():dt.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(rn.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return rn.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(rn.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=Ie.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=(s==null?void 0:s.id)===ne.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=Ie.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(c=>c.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){var e,n,r;if(t.id===ne.CONNECTOR_ID.AUTH){const s=t,i=Aw(fe.state),o=fi.getSnapshot().themeMode,c=fi.getSnapshot().themeVariables;(n=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||n.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(r=s==null?void 0:s.provider)==null||r.syncTheme({themeMode:o,themeVariables:c,w3mThemeVariables:Sw(c,o)}),Ie.setConnectors([t])}else Ie.setConnectors([t])},getAuthConnector(t){var r;const e=t||$.state.activeChain,n=rn.connectors.find(s=>s.id===ne.CONNECTOR_ID.AUTH);if(n)return(r=n==null?void 0:n.connectors)!=null&&r.length?n.connectors.find(i=>i.chain===e):n},getAnnouncedConnectorRdns(){return rn.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>{var e;return(e=t.info)==null?void 0:e.rdns})},getConnectorById(t){return rn.allConnectors.find(e=>e.id===t)},getConnector({id:t,rdns:e,namespace:n}){const r=n||$.state.activeChain;return rn.allConnectors.filter(i=>i.chain===r).find(i=>{var o;return i.explorerId===t||((o=i.info)==null?void 0:o.rdns)===e})},syncIfAuthConnector(t){var i,o;if(t.id!=="ID_AUTH")return;const e=t,n=Aw(fe.state),r=fi.getSnapshot().themeMode,s=fi.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Sw(s,r)})},getConnectorsByNamespace(t){const e=rn.allConnectors.filter(n=>n.chain===t);return Ie.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return $.checkIfSmartAccountEnabled()&&Ws(t)===fr.ACCOUNT_TYPES.EOA},selectWalletConnector(t){var r;const e=(r=ut.state.data)==null?void 0:r.redirectView,n=Ie.getConnector({id:t.id,rdns:t.rdns});Qse.handleMobileDeeplinkRedirect((n==null?void 0:n.explorerId)||t.id,$.state.activeChain),n?ut.push("ConnectingExternal",{connector:n,wallet:t,redirectView:e}):ut.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?Ie.getConnectorsByNamespace(t):Ie.mergeMultiChainConnectors(rn.allConnectors)},setFilterByNamespace(t){rn.filterByNamespace=t,rn.connectors=Ie.getConnectors(t),dt.setFilterByNamespace(t)},setConnectorId(t,e){t&&(rn.activeConnectorIds={...rn.activeConnectorIds,[e]:t},ye.setConnectedConnectorId(e,t))},removeConnectorId(t){rn.activeConnectorIds={...rn.activeConnectorIds,[t]:void 0},ye.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return rn.activeConnectorIds[t]},isConnected(t){return t?!!rn.activeConnectorIds[t]:Object.values(rn.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){rn.activeConnectorIds={...uF}}},Ie=$o(fie),pie=1e3,_0={checkNamespaceConnectorId(t,e){return Ie.getConnectorId(t)===e},isSocialProvider(t){return Vt.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,c)=>{if(t&&Ie.setActiveConnector(e),s==null||s(Be.isMobile()&&t),r){const d=Dt.subscribeKey("open",u=>{u||(ut.state.view!==r&&ut.replace(r),d(),c(new Error("Modal closed")))})}const l=$.subscribeKey("activeCaipAddress",d=>{d&&(i==null||i(),n&&Dt.close(),l(),o(jr.parseCaipAddress(d)))})})},connectExternal(t){return new Promise((e,n)=>{const r=$.subscribeKey("activeCaipAddress",s=>{s&&(Dt.close(),r(),e(jr.parseCaipAddress(s)))});De.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){const i=$.getAccountData(e);let o=i==null?void 0:i.socialWindow,c=i==null?void 0:i.socialProvider,l=!1,d=null;const u=e||$.state.activeChain,h=$.subscribeKey("activeCaipAddress",f=>{f&&(n&&Dt.close(),h())});return new Promise((f,p)=>{async function m(y){var x;if((x=y.data)!=null&&x.resultUri)if(y.origin===ne.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",m,!1);try{const w=Ie.getAuthConnector(u);if(w&&!l){const b=$.getAccountData(u);o&&(o.close(),$.setAccountProp("socialWindow",void 0,u),o=b==null?void 0:b.socialWindow),l=!0;const v=y.data.resultUri;if(c&&Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:c}}),c){ye.setConnectedSocialProvider(c),await De.connectExternal({id:w.id,type:w.type,socialUri:v},w.chain);const E=$.state.activeCaipAddress;if(!E){p(new Error("Failed to connect"));return}f(jr.parseCaipAddress(E)),Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:c}})}}}catch(w){c&&Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:c,message:Be.parseError(w)}}),p(new Error("Failed to connect"))}}else c&&Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:c,message:"Untrusted Origin"}})}async function g(){if(t){const y=$.getAccountData(u);$.setAccountProp("socialProvider",t,u),c=y==null?void 0:y.socialProvider,Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:c}})}if(c==="farcaster"){r==null||r();const y=Dt.subscribeKey("open",w=>{!w&&t==="farcaster"&&(p(new Error("Popup closed")),s==null||s(),y())}),x=Ie.getAuthConnector();if(x){const w=$.getAccountData(u);if(!(w!=null&&w.farcasterUrl))try{const{url:b}=await x.provider.getFarcasterUri();$.setAccountProp("farcasterUrl",b,u)}catch{p(new Error("Failed to connect to farcaster"))}}}else{const y=Ie.getAuthConnector();d=Be.returnOpenHref(`${ne.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(y&&c){const{uri:x}=await y.provider.getSocialRedirectUri({provider:c});if(d&&x){$.setAccountProp("socialWindow",Cg(d),u),o=i==null?void 0:i.socialWindow,d.location.href=x;const w=setInterval(()=>{o!=null&&o.closed&&!l&&(p(new Error("Popup closed")),clearInterval(w))},1e3);window.addEventListener("message",m,!1)}else d==null||d.close(),p(new Error("Failed to initiate social connection"))}}catch{p(new Error("Failed to initiate social connection")),d==null||d.close()}}}g()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n==null||n(),e){const c=Dt.subscribeKey("open",l=>{l||(ut.state.view!==e&&ut.replace(e),c(),i(new Error("Modal closed")))})}const o=$.subscribeKey("activeCaipAddress",c=>{c&&(r==null||r(),t&&Dt.close(),o(),s(jr.parseCaipAddress(c)))})})},async updateEmail(){const t=ye.getConnectedConnectorId($.state.activeChain),e=Ie.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==ne.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await Dt.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const c=e.provider.getEmail()??"";c!==n&&(Dt.close(),clearInterval(i),o(),r({email:c}))},pie),o=Dt.subscribeKey("open",c=>{c||(ut.state.view!=="Connect"&&ut.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return $.checkIfSmartAccountEnabled()&&Ws(t)===fr.ACCOUNT_TYPES.EOA}};function hF(){var r,s;const t=((r=$.state.activeCaipNetwork)==null?void 0:r.chainNamespace)||"eip155",e=((s=$.state.activeCaipNetwork)==null?void 0:s.id)||1,n=Vt.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function Ws(t){var n;return(n=$.getAccountData(t))==null?void 0:n.preferredAccountType}function oy(t){var e,n;return t?(n=(e=$.state.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:$.state.activeCaipNetwork}const wE={getConnectionStatus(t,e){const n=Ie.state.activeConnectorIds[e],r=De.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(l=>l.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){var c;const e=!!((c=fe.state.remoteFeatures)!=null&&c.multiWallet),n=Ie.state.activeConnectorIds[t],r=De.getConnections(t),i=(De.state.recentConnections.get(t)??[]).filter(l=>Ie.getConnectorById(l.connectorId)),o=wE.excludeExistingConnections([...r.map(l=>l.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(l=>l.connectorId.toLowerCase()===(n==null?void 0:n.toLowerCase())),recentConnections:[]}}},Ln=Un({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),mie={state:Ln,subscribe(t){return cs(Ln,()=>t(Ln))},setLastNetworkInView(t){Ln.lastNetworkInView=t},async fetchTransactions(t){var e;if(!t)throw new Error("Transactions can't be fetched without an accountAddress");Ln.loading=!0;try{const n=await yt.fetchTransactions({account:t,cursor:Ln.next,chainId:(e=$.state.activeCaipNetwork)==null?void 0:e.caipNetworkId}),r=o1.filterSpamTransactions(n.data),s=o1.filterByConnectedChain(r),i=[...Ln.transactions,...s];Ln.loading=!1,Ln.transactions=i,Ln.transactionsByYear=o1.groupTransactionsByYearAndMonth(Ln.transactionsByYear,s),Ln.empty=i.length===0,Ln.next=n.next?n.next:void 0}catch{const r=$.state.activeChain;Lt.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:fe.state.projectId,cursor:Ln.next,isSmartAccount:Ws(r)===fr.ACCOUNT_TYPES.SMART_ACCOUNT}}),lc.showError("Failed to fetch transactions"),Ln.loading=!1,Ln.empty=!0,Ln.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},l=(o[i]??[]).filter(d=>d.id!==r.id);n[s]={...o,[i]:[...l,r].sort((d,u)=>new Date(u.metadata.minedAt).getTime()-new Date(d.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(r=>{var s;return((s=r.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(t){var r;const e=(r=$.state.activeCaipNetwork)==null?void 0:r.caipNetworkId;return t.filter(s=>s.metadata.chain===e)},clearCursor(){Ln.next=void 0},resetTransactions(){Ln.transactions=[],Ln.transactionsByYear={},Ln.lastNetworkInView=void 0,Ln.loading=!1,Ln.empty=!1,Ln.next=void 0}},o1=$o(mie,"API_ERROR"),Yt=Un({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let Ru;const gie={state:Yt,subscribe(t){return cs(Yt,()=>t(Yt))},subscribeKey(t,e){return ls(Yt,t,e)},_getClient(){return Yt._client},setClient(t){Yt._client=Cg(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);De.syncStorageConnections(e)},syncStorageConnections(t){const e=ye.getConnections(),n=t??Array.from($.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(Yt.recentConnections);i.set(r,s),Yt.recentConnections=i}},getConnections(t){return t?Yt.connections.get(t)??[]:[]},hasAnyConnection(t){const e=De.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect({cache:t="auto"}={}){var n,r,s,i;const e=Be.isTelegram()||Be.isSafari()&&Be.isIos();if(t==="always"||t==="auto"&&e){if(Ru){await Ru,Ru=void 0;return}if(!Be.isPairingExpired(Yt==null?void 0:Yt.wcPairingExpiry)){const o=Yt.wcUri;Yt.wcUri=o;return}Ru=(r=(n=De._getClient())==null?void 0:n.connectWalletConnect)==null?void 0:r.call(n).catch(()=>{}),De.state.status="connecting",await Ru,Ru=void 0,Yt.wcPairingExpiry=void 0,De.state.status="connected"}else await((i=(s=De._getClient())==null?void 0:s.connectWalletConnect)==null?void 0:i.call(s))},async connectExternal(t,e,n=!0){var s,i;const r=await((i=(s=De._getClient())==null?void 0:s.connectExternal)==null?void 0:i.call(s,t));return n&&$.setActiveNamespace(e),r},async reconnectExternal(t){var n,r;await((r=(n=De._getClient())==null?void 0:n.reconnectExternal)==null?void 0:r.call(n,t));const e=t.chain||$.state.activeChain;e&&Ie.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){var r;if(!e)return;Dt.setLoading(!0,$.state.activeChain);const n=Ie.getAuthConnector();n&&($.setAccountProp("preferredAccountType",t,e),await n.provider.setPreferredAccount(t),ye.setPreferredAccountTypes(Object.entries($.state.chains).reduce((s,[i,o])=>{const c=i,l=Ws(c);return l!==void 0&&(s[c]=l),s},{})),await De.reconnectExternal(n),Dt.setLoading(!1,$.state.activeChain),Lt.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:((r=$.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}))},async signMessage(t){var e;return(e=De._getClient())==null?void 0:e.signMessage(t)},parseUnits(t,e){var n;return(n=De._getClient())==null?void 0:n.parseUnits(t,e)},formatUnits(t,e){var n;return(n=De._getClient())==null?void 0:n.formatUnits(t,e)},updateBalance(t){var e;return(e=De._getClient())==null?void 0:e.updateBalance(t)},async sendTransaction(t){var e;return(e=De._getClient())==null?void 0:e.sendTransaction(t)},async getCapabilities(t){var e;return(e=De._getClient())==null?void 0:e.getCapabilities(t)},async grantPermissions(t){var e;return(e=De._getClient())==null?void 0:e.grantPermissions(t)},async walletGetAssets(t){var e;return((e=De._getClient())==null?void 0:e.walletGetAssets(t))??{}},async estimateGas(t){var e;return(e=De._getClient())==null?void 0:e.estimateGas(t)},async writeContract(t){var e;return(e=De._getClient())==null?void 0:e.writeContract(t)},async getEnsAddress(t){var e;return(e=De._getClient())==null?void 0:e.getEnsAddress(t)},async getEnsAvatar(t){var e;return(e=De._getClient())==null?void 0:e.getEnsAvatar(t)},checkInstalled(t){var e,n;return((n=(e=De._getClient())==null?void 0:e.checkInstalled)==null?void 0:n.call(e,t))||!1},resetWcConnection(){Yt.wcUri=void 0,Yt.wcPairingExpiry=void 0,Yt.wcLinking=void 0,Yt.recentWallet=void 0,Yt.status="disconnected",o1.resetTransactions(),ye.deleteWalletConnectDeepLink(),ye.deleteRecentWallet()},resetUri(){Yt.wcUri=void 0,Yt.wcPairingExpiry=void 0,Ru=void 0},finalizeWcConnection(t){var r,s;const{wcLinking:e,recentWallet:n}=De.state;e&&ye.setWalletConnectDeepLink(e),n&&ye.setAppKitRecent(n),t&&Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:((s=(r=ut.state.data)==null?void 0:r.wallet)==null?void 0:s.name)||"Unknown",view:ut.state.view,walletRank:n==null?void 0:n.order}})},setWcBasic(t){Yt.wcBasic=t},setUri(t){Yt.wcUri=t,Yt.wcPairingExpiry=Be.getPairingExpiry()},setWcLinking(t){Yt.wcLinking=t},setWcError(t){Yt.wcError=t,Yt.buffering=!1},setRecentWallet(t){Yt.recentWallet=t},setBuffering(t){Yt.buffering=t},setStatus(t){Yt.status=t},setIsSwitchingConnection(t){Yt.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){var r;try{await((r=De._getClient())==null?void 0:r.disconnect({id:t,chainNamespace:e,initialDisconnect:n}))}catch(s){throw new yf("Failed to disconnect","INTERNAL_SDK_ERROR",s)}},async disconnectConnector({id:t,namespace:e}){var n;try{await((n=De._getClient())==null?void 0:n.disconnectConnector({id:t,namespace:e}))}catch(r){throw new yf("Failed to disconnect connector","INTERNAL_SDK_ERROR",r)}},setConnections(t,e){const n=new Map(Yt.connections);n.set(e,t),Yt.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){var i,o;const n=$.getAccountData(e),r=(o=(i=n==null?void 0:n.user)==null?void 0:i.accounts)==null?void 0:o.find(c=>c.type==="smartAccount"),s=r&&r.address.toLowerCase()===t.toLowerCase()&&_0.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await De.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=Ie.getConnectorById(t.connectorId),s=t.connectorId===ne.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)s&&n&&await De.handleAuthAccountSwitch({address:n,namespace:e});else{const i=await De.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e);return i==null?void 0:i.address}return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){var d,u;const s=Ie.getConnectorById(t.connectorId),i=(u=(d=t.auth)==null?void 0:d.name)==null?void 0:u.toLowerCase(),o=t.connectorId===ne.CONNECTOR_ID.AUTH,c=t.connectorId===ne.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let l;if(o)if(i&&_0.isSocialProvider(i)){const{address:h}=await _0.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Dt.open({view:"ConnectingFarcaster"})},onConnect(){ut.replace("ProfileWallets")}});l=h}else{const{address:h}=await _0.connectEmail({closeModalOnConnect:r,onOpen(){Dt.open({view:"EmailLogin"})},onConnect(){ut.replace("ProfileWallets")}});l=h}else if(c){const{address:h}=await _0.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(f){const p=f?"AllWallets":"ConnectingWalletConnect";Dt.state.open?ut.push(p):Dt.open({view:p})},onConnect(){ut.replace("ProfileWallets")}});l=h}else{const h=await De.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);h&&(l=h.address)}return o&&n&&await De.handleAuthAccountSwitch({address:n,namespace:e}),l},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){var l;let i;const o=(l=$.getAccountData(n))==null?void 0:l.caipAddress;if(o){const{address:d}=jr.parseCaipAddress(o);i=d}const c=wE.getConnectionStatus(t,n);switch(c){case"connected":case"active":{const d=await De.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&d){const u=d.toLowerCase()!==i.toLowerCase();s==null||s({address:d,namespace:n,hasSwitchedAccount:u,hasSwitchedWallet:c==="active"})}break}case"disconnected":{const d=await De.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});d&&(s==null||s({address:d,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0}));break}default:throw new Error(`Invalid connection status: ${c}`)}}},De=$o(gie),OA={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return KI(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let DA;async function KO(){if(!DA){const{createPublicClient:t,http:e,defineChain:n}=await $n(async()=>{const{createPublicClient:r,http:s,defineChain:i}=await import("./index-BFspv573.js");return{createPublicClient:r,http:s,defineChain:i}},__vite__mapDeps([0,1,2,3]));DA={createPublicClient:t,http:e,defineChain:n}}return DA}const FT={getBlockchainApiRpcUrl(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()},async getViemChain(t){const{defineChain:e}=await KO(),{chainId:n}=jr.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(n)})},async createViemPublicClient(t){const{createPublicClient:e,http:n}=await KO(),r=fe.state.projectId,s=await FT.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:n(FT.getBlockchainApiRpcUrl(t.caipNetworkId,r))})}},QI={async getMyTokensWithBalance(t){var c;const e=(c=$.getAccountData())==null?void 0:c.address,n=$.state.activeCaipNetwork,r=Ie.getConnectorId("eip155")===ne.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=ye.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===ne.CHAIN.EVM&&r){const l=await this.getEIP155Balances(e,n);if(l)return this.filterLowQualityTokens(l)}const o=await yt.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){var n,r;try{const s=OA.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await De.getCapabilities(t);if(!((r=(n=i==null?void 0:i[s])==null?void 0:n.assetDiscovery)!=null&&r.supported))return null;const o=await De.walletGetAssets({account:t,chainFilter:[s]});if(!OA.isWalletGetAssetsResponse(o))return null;const l=(o[s]||[]).map(d=>OA.createBalance(d,e.caipNetworkId));return ye.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:l},timestamp:Date.now()}),l}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:n}){const r=await FT.createViemPublicClient(n),{address:s}=jr.parseCaipAddress(t),[{result:i},{result:o},{result:c},{result:l}]=await r.multicall({contracts:[{address:e,functionName:"name",args:[],abi:Jb},{address:e,functionName:"symbol",args:[],abi:Jb},{address:e,functionName:"balanceOf",args:[s],abi:Jb},{address:e,functionName:"decimals",args:[],abi:Jb}]});return{name:i,symbol:o,decimals:l,balance:c&&l?KI(c,l):"0"}}},Yf=Un({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),ma={state:Yf,subscribe(t){return cs(Yf,()=>t(Yf))},subscribeOpen(t){return ls(Yf,"open",t)},set(t){Object.assign(Yf,{...Yf,...t})}},yie={async getTokenList(t){var r;const e=await yt.fetchSwapTokens({chainId:t});return((r=e==null?void 0:e.tokens)==null?void 0:r.map(s=>({...s,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0})))||[]},async fetchGasPrice(){var e;const t=$.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const n=(e=await(De==null?void 0:De.estimateGas({chainNamespace:"solana"})))==null?void 0:e.toString();return{standard:n,fast:n,instant:n};case"eip155":default:return await yt.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await yt.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s!=null&&s.allowance&&n&&r){const i=De.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await QI.getMyTokensWithBalance(t);return $.setAccountProp("tokenBalance",e,$.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return(t==null?void 0:t.map(e=>({...e,address:e!=null&&e.address?e.address:hF(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]},async handleSwapError(t){var e,n;try{const r=t==null?void 0:t.cause;if(!(r!=null&&r.json))return;const s=await r.json(),i=(n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description;return i!=null&&i.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},Qt=Un({tokenBalances:[],loading:!1}),wie={state:Qt,subscribe(t){return cs(Qt,()=>t(Qt))},subscribeKey(t,e){return ls(Qt,t,e)},setToken(t){t&&(Qt.token=Cg(t))},setTokenAmount(t){Qt.sendTokenAmount=t},setReceiverAddress(t){Qt.receiverAddress=t},setReceiverProfileImageUrl(t){Qt.receiverProfileImageUrl=t},setReceiverProfileName(t){Qt.receiverProfileName=t},setNetworkBalanceInUsd(t){Qt.networkBalanceInUSD=t},setLoading(t){Qt.loading=t},getSdkEventProperties(t){var e,n;return{message:Be.parseError(t),isSmartAccount:Ws($.state.activeChain)===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((e=Qt.token)==null?void 0:e.symbol)||"",amount:Qt.sendTokenAmount??0,network:((n=$.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}},async sendToken(){var t;try{switch(Pt.setLoading(!0),(t=$.state.activeCaipNetwork)==null?void 0:t.chainNamespace){case"eip155":await Pt.sendEvmToken();return;case"solana":await Pt.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(e){throw ml.isUserRejectedRequestError(e)?new WI(e):e}finally{Pt.setLoading(!1)}},async sendEvmToken(){var n,r,s;const t=$.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=Ws(t);if(!Pt.state.sendTokenAmount||!Pt.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Pt.state.token)throw new Error("A token is required");if((n=Pt.state.token)!=null&&n.address){Lt.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:Pt.state.token.address,amount:Pt.state.sendTokenAmount,network:((r=$.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}});const{hash:i}=await Pt.sendERC20Token({receiverAddress:Pt.state.receiverAddress,tokenAddress:Pt.state.token.address,sendTokenAmount:Pt.state.sendTokenAmount,decimals:Pt.state.token.quantity.decimals});i&&(Qt.hash=i)}else{Lt.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:Pt.state.token.symbol||"",amount:Pt.state.sendTokenAmount,network:((s=$.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}});const{hash:i}=await Pt.sendNativeToken({receiverAddress:Pt.state.receiverAddress,sendTokenAmount:Pt.state.sendTokenAmount,decimals:Pt.state.token.quantity.decimals});i&&(Qt.hash=i)}},async fetchTokenBalance(t){var o,c,l;Qt.loading=!0;const e=$.state.activeChain,n=(o=$.state.activeCaipNetwork)==null?void 0:o.caipNetworkId,r=(c=$.state.activeCaipNetwork)==null?void 0:c.chainNamespace,s=((l=$.getAccountData(e))==null?void 0:l.caipAddress)??$.state.activeCaipAddress,i=s?Be.getPlainAddress(s):void 0;if(Qt.lastRetry&&!Be.isAllowedRetry(Qt.lastRetry,30*Vt.ONE_SEC_MS))return Qt.loading=!1,[];try{if(i&&n&&r){const d=await QI.getMyTokensWithBalance();return Qt.tokenBalances=d,Qt.lastRetry=void 0,d}}catch(d){Qt.lastRetry=Date.now(),t==null||t(d),lc.showError("Token Balance Unavailable")}finally{Qt.loading=!1}return[]},fetchNetworkBalance(){if(Qt.tokenBalances.length===0)return;const t=yie.mapBalancesToSwapTokens(Qt.tokenBalances);if(!t)return;const e=t.find(n=>n.address===hF());e&&(Qt.networkBalanceInUSD=e?Jre.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){var o,c,l,d;ut.pushTransactionStack({});const e=t.receiverAddress,n=(o=$.getAccountData())==null?void 0:o.address,r=De.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await De.sendTransaction({chainNamespace:ne.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)});return Lt.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Ws("eip155")===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((c=Pt.state.token)==null?void 0:c.symbol)||"",amount:t.sendTokenAmount,network:((l=$.state.activeCaipNetwork)==null?void 0:l.caipNetworkId)||"",hash:i||""}}),(d=De._getClient())==null||d.updateBalance("eip155"),Pt.resetSend(),{hash:i}},async sendERC20Token(t){var r,s,i;ut.pushTransactionStack({onSuccess(){ut.replace("Account")}});const e=De.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),n=(r=$.getAccountData())==null?void 0:r.address;if(n&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const o=Be.getPlainAddress(t.tokenAddress);if(!o)throw new Error("SendController:sendERC20Token - tokenAddress is required");const c=await De.writeContract({fromAddress:n,tokenAddress:o,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:tse.getERC20Abi(o),chainNamespace:ne.CHAIN.EVM});return Lt.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Ws("eip155")===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((s=Pt.state.token)==null?void 0:s.symbol)||"",amount:t.sendTokenAmount,network:((i=$.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||"",hash:c||""}}),Pt.resetSend(),{hash:c}}return{hash:void 0}},async sendSolanaToken(){var n;if(!Pt.state.sendTokenAmount||!Pt.state.receiverAddress)throw new Error("An amount and receiver address are required");ut.pushTransactionStack({onSuccess(){ut.replace("Account")}});let t;Pt.state.token&&Pt.state.token.address!==Vt.SOLANA_NATIVE_TOKEN_ADDRESS&&(Be.isCaipAddress(Pt.state.token.address)?t=Be.getPlainAddress(Pt.state.token.address):t=Pt.state.token.address);const e=await De.sendTransaction({chainNamespace:"solana",tokenMint:t,to:Pt.state.receiverAddress,value:Pt.state.sendTokenAmount});e&&(Qt.hash=e),(n=De._getClient())==null||n.updateBalance("solana"),Pt.resetSend()},resetSend(){Qt.token=void 0,Qt.sendTokenAmount=void 0,Qt.receiverAddress=void 0,Qt.receiverProfileImageUrl=void 0,Qt.receiverProfileName=void 0,Qt.loading=!1,Qt.tokenBalances=[]}},Pt=$o(wie),UA={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},nv={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},Le=Un({chains:zre(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),fF={state:Le,subscribe(t){return cs(Le,()=>{t(Le)})},subscribeKey(t,e){return ls(Le,t,e)},subscribeAccountStateProp(t,e,n){var s;const r=n||Le.activeChain;return r?ls(((s=Le.chains.get(r))==null?void 0:s.accountState)||{},t,e):()=>{}},subscribeChainProp(t,e,n){let r;return cs(Le.chains,()=>{var i;const s=n||Le.activeChain;if(s){const o=(i=Le.chains.get(s))==null?void 0:i[t];r!==o&&(r=o,e(o))}})},initialize(t,e,n){const{chainId:r,namespace:s}=ye.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(r==null?void 0:r.toString())),c=t.find(u=>(u==null?void 0:u.namespace)===s)||(t==null?void 0:t[0]),l=t.map(u=>u.namespace).filter(u=>u!==void 0),d=fe.state.enableEmbedded?new Set([...l]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((t==null?void 0:t.length)===0||!c)&&(Le.noAdapters=!0),Le.noAdapters||(Le.activeChain=c==null?void 0:c.namespace,Le.activeCaipNetwork=i,$.setChainNetworkData(c==null?void 0:c.namespace,{caipNetwork:i}),Le.activeChain&&ma.set({activeChain:c==null?void 0:c.namespace})),d.forEach(u=>{const h=e==null?void 0:e.filter(m=>m.chainNamespace===u),f=ye.getPreferredAccountTypes()||{},p={...fe.state.defaultAccountTypes,...f};$.state.chains.set(u,{namespace:u,networkState:Un({...nv,caipNetwork:h==null?void 0:h[0]}),accountState:Un({...UA,preferredAccountType:p[u]}),caipNetworks:h??[],...n}),$.setRequestedCaipNetworks(h??[],u)})},removeAdapter(t){var e,n;if(Le.activeChain===t){const r=Array.from(Le.chains.entries()).find(([s])=>s!==t);if(r){const s=(n=(e=r[1])==null?void 0:e.caipNetworks)==null?void 0:n[0];s&&$.setActiveCaipNetwork(s)}}Le.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:n},r){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");Le.chains.set(t.namespace,{namespace:t.namespace,networkState:{...nv,caipNetwork:r[0]},accountState:{...UA},caipNetworks:r,connectionControllerClient:n,networkControllerClient:e}),$.setRequestedCaipNetworks((r==null?void 0:r.filter(s=>s.chainNamespace===t.namespace))??[],t.namespace)},addNetwork(t){var n;const e=Le.chains.get(t.chainNamespace);if(e){const r=[...e.caipNetworks||[]];(n=e.caipNetworks)!=null&&n.find(s=>s.id===t.id)||r.push(t),Le.chains.set(t.chainNamespace,{...e,caipNetworks:r}),$.setRequestedCaipNetworks(r,t.chainNamespace),Ie.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){var r,s,i;const n=Le.chains.get(t);if(n){const o=((r=Le.activeCaipNetwork)==null?void 0:r.id)===e,c=[...((s=n.caipNetworks)==null?void 0:s.filter(l=>l.id!==e))||[]];o&&((i=n==null?void 0:n.caipNetworks)!=null&&i[0])&&$.setActiveCaipNetwork(n.caipNetworks[0]),Le.chains.set(t,{...n,caipNetworks:c}),$.setRequestedCaipNetworks(c||[],t),c.length===0&&Ie.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=Le.chains.get(t);n&&(n.networkState={...n.networkState||nv,...e},Le.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=Le.chains.get(t);if(r){const s={...r.accountState||UA,...e};Le.chains.set(t,{...r,accountState:s}),(Le.chains.size===1||Le.activeChain===t)&&e.caipAddress&&(Le.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const n=Le.chains.get(t);if(n){const r={...n.networkState||nv,...e};Le.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){$.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){var r,s;Le.activeChain=t;const e=t?Le.chains.get(t):void 0,n=(r=e==null?void 0:e.networkState)==null?void 0:r.caipNetwork;n!=null&&n.id&&t&&(Le.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,Le.activeCaipNetwork=n,$.setChainNetworkData(t,{caipNetwork:n}),ye.setActiveCaipNetworkId(n==null?void 0:n.caipNetworkId),ma.set({activeChain:t,selectedNetworkId:n==null?void 0:n.caipNetworkId}))},setActiveCaipNetwork(t){var i,o;if(!t)return;const e=Le.activeChain===t.chainNamespace;e||$.setIsSwitchingNamespace(!0);const n=Le.chains.get(t.chainNamespace);Le.activeChain=t.chainNamespace,Le.activeCaipNetwork=t,$.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let r=(i=n==null?void 0:n.accountState)==null?void 0:i.address;if(r)Le.activeCaipAddress=`${t.chainNamespace}:${t.id}:${r}`;else if(e&&Le.activeCaipAddress){const{address:c}=jr.parseCaipAddress(Le.activeCaipAddress);r=c,Le.activeCaipAddress=`${t.caipNetworkId}:${r}`}else Le.activeCaipAddress=void 0;$.setChainAccountData(t.chainNamespace,{address:r,caipAddress:Le.activeCaipAddress}),Pt.resetSend(),ma.set({activeChain:Le.activeChain,selectedNetworkId:(o=Le.activeCaipNetwork)==null?void 0:o.caipNetworkId}),ye.setActiveCaipNetworkId(t.caipNetworkId),!$.checkIfSupportedNetwork(t.chainNamespace)&&fe.state.enableNetworkSwitch&&!fe.state.allowUnsupportedChain&&!De.state.wcBasic&&$.showUnsupportedChainUI()},addCaipNetwork(t){var n;if(!t)return;const e=Le.chains.get(t.chainNamespace);e&&((n=e==null?void 0:e.caipNetworks)==null||n.push(t))},async switchActiveNamespace(t){var s;if(!t)return;const e=t!==$.state.activeChain,n=(s=$.getNetworkData(t))==null?void 0:s.caipNetwork,r=$.getCaipNetworkByNamespace(t,n==null?void 0:n.id);e&&r&&await $.switchActiveNetwork(r)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){var o;const n=$.state.activeChain;if(!n)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=$.state.chains.get(n),s=!((o=r==null?void 0:r.caipNetworks)!=null&&o.some(c=>{var l;return c.id===((l=Le.activeCaipNetwork)==null?void 0:l.id)})),i=$.getNetworkControllerClient(t.chainNamespace);if(i){try{await i.switchCaipNetwork(t),s&&Dt.close()}catch(c){if(e)throw c;ut.goBack()}Lt.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})}},getNetworkControllerClient(t){const e=t||Le.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=Le.chains.get(e);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(t){const e=t||Le.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=Le.chains.get(e);if(!(n!=null&&n.connectionControllerClient))throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){var r;const n=(r=Le.chains.get(e))==null?void 0:r.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=Le.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=(e==null?void 0:e.networkState)||{};return Be.sortRequestedNetworks(n,r).filter(o=>o==null?void 0:o.id)},getAllRequestedCaipNetworks(){const t=[];return Le.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=$.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){$.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=$.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));Ie.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return Le.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=$.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){var e,n;return t?(n=(e=Le.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:Le.activeCaipNetwork},getActiveCaipAddress(){return Le.activeCaipAddress},getApprovedCaipNetworkIds(t){var r;const e=Le.chains.get(t);return((r=e==null?void 0:e.networkState)==null?void 0:r.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(t){const e=$.getNetworkControllerClient(),n=await(e==null?void 0:e.getApprovedCaipNetworksData());$.setAdapterNetworkState(t,{approvedCaipNetworkIds:n==null?void 0:n.approvedCaipNetworkIds,supportsAllNetworks:n==null?void 0:n.supportsAllNetworks})},checkIfSupportedNetwork(t,e){var s;const n=e||((s=Le.activeCaipNetwork)==null?void 0:s.caipNetworkId),r=$.getRequestedCaipNetworks(t);return r.length?r==null?void 0:r.some(i=>i.caipNetworkId===n):!0},checkIfSupportedChainId(t){if(!Le.activeChain)return!0;const e=$.getRequestedCaipNetworks(Le.activeChain);return e==null?void 0:e.some(n=>n.id===t)},setSmartAccountEnabledNetworks(t,e){$.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){var r;const t=Y8.caipNetworkIdToNumber((r=Le.activeCaipNetwork)==null?void 0:r.caipNetworkId),e=Le.activeChain;if(!e||!t)return!1;const n=$.getNetworkProp("smartAccountEnabledNetworks",e);return!!(n!=null&&n.includes(Number(t)))},showUnsupportedChainUI(){Dt.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=Le.activeCaipNetwork;return!!(t!=null&&t.chainNamespace&&Vt.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){$.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){var s,i;const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=(i=(s=$.state.chains.get(e))==null?void 0:s.accountState)==null?void 0:i.preferredAccountType,r=fe.state.defaultAccountTypes[e];Le.activeCaipAddress=void 0,$.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),Ie.removeConnectorId(e)},setIsSwitchingNamespace(t){Le.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){var n,r;const t=[];let e;if(Le.chains.forEach(s=>{ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&t.push(s.namespace)}),t.length>0){const s=t[0];return e=s?(r=(n=Le.chains.get(s))==null?void 0:n.caipNetworks)==null?void 0:r[0]:void 0,e}},getAccountData(t){var n;const e=t||Le.activeChain;if(e)return(n=$.state.chains.get(e))==null?void 0:n.accountState},getNetworkData(t){var n;const e=t||Le.activeChain;if(e)return(n=$.state.chains.get(e))==null?void 0:n.networkState},getCaipNetworkByNamespace(t,e){var s,i,o;if(!t)return;const n=$.state.chains.get(t),r=(s=n==null?void 0:n.caipNetworks)==null?void 0:s.find(c=>c.id===e);return r||((i=n==null?void 0:n.networkState)==null?void 0:i.caipNetwork)||((o=n==null?void 0:n.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const t=Ie.state.filterByNamespace;return(t?[Le.chains.get(t)]:Array.from(Le.chains.values())).flatMap(n=>(n==null?void 0:n.caipNetworks)||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?$.getRequestedCaipNetworks(t):$.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return fF.getCaipNetworks(e).find(n=>n.id.toString()===t.toString()||n.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){Le.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return Le.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){var o,c;const e=$.getAccountData();if(!e)return[];const n=(o=$.state.activeCaipNetwork)==null?void 0:o.caipNetworkId,r=(c=$.state.activeCaipNetwork)==null?void 0:c.chainNamespace,s=$.state.activeCaipAddress,i=s?Be.getPlainAddress(s):void 0;if($.setAccountProp("balanceLoading",!0,r),e.lastRetry&&!Be.isAllowedRetry(e.lastRetry,30*Vt.ONE_SEC_MS))return $.setAccountProp("balanceLoading",!1,r),[];try{if(i&&n&&r){const l=await QI.getMyTokensWithBalance();return $.setAccountProp("tokenBalance",l,r),$.setAccountProp("lastRetry",void 0,r),$.setAccountProp("balanceLoading",!1,r),l}}catch(l){$.setAccountProp("lastRetry",Date.now(),r),t==null||t(l),lc.showError("Token Balance Unavailable")}finally{$.setAccountProp("balanceLoading",!1,r)}return[]}},$=$o(fF),xie={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){var f,p;const n=$.state.activeCaipNetwork,r=$.state.activeChain,s=ut.state.data;if(t.id===(n==null?void 0:n.id))return;const o=!!((f=$.getAccountData(r))!=null&&f.address),c=!!((p=$.getAccountData(t.chainNamespace))!=null&&p.address),l=t.chainNamespace!==r,u=Ie.getConnectorId(r)===ne.CONNECTOR_ID.AUTH,h=ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(m=>m===t.chainNamespace);e||u&&h?ut.push("SwitchNetwork",{...s,network:t}):o&&l&&!c?ut.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):ut.push("SwitchNetwork",{...s,network:t})}},ri=Un({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),bie={state:ri,subscribe(t){return cs(ri,()=>t(ri))},subscribeKey(t,e){return ls(ri,t,e)},async open(t){var o,c;const e=t==null?void 0:t.namespace,n=$.state.activeChain,r=e&&e!==n,s=(o=$.getAccountData(t==null?void 0:t.namespace))==null?void 0:o.caipAddress,i=$.state.noAdapters;if(De.state.wcBasic?dt.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await dt.prefetch(),Ie.setFilterByNamespace(t==null?void 0:t.namespace),Dt.setLoading(!0,e),e&&r){const l=((c=$.getNetworkData(e))==null?void 0:c.caipNetwork)||$.getRequestedCaipNetworks(e)[0];l&&(i?(await $.switchActiveNetwork(l),ut.push("ConnectingWalletConnectBasic")):xie.onSwitchNetwork({network:l,ignoreSwitchConfirmation:!0}))}else fe.state.manualWCControl||i&&!s?Be.isMobile()?ut.reset("AllWallets"):ut.reset("ConnectingWalletConnectBasic"):t!=null&&t.view?ut.reset(t.view,t.data):s?ut.reset("Account"):ut.reset("Connect");ri.open=!0,ma.set({open:!0}),Lt.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=fe.state.enableEmbedded,e=!!$.state.activeCaipAddress;ri.open&&Lt.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),ri.open=!1,ut.reset("Connect"),Dt.clearLoading(),t?e?ut.replace("Account"):ut.push("Connect"):ma.set({open:!1}),De.resetUri()},setLoading(t,e){e&&ri.loadingNamespaceMap.set(e,t),ri.loading=t,ma.set({loading:t})},clearLoading(){ri.loadingNamespaceMap.clear(),ri.loading=!1,ma.set({loading:!1})},shake(){ri.shake||(ri.shake=!0,setTimeout(()=>{ri.shake=!1},500))}},Dt=$o(bie),xE={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},si=Un({providers:{...xE},providerIds:{...xE}}),Jt={state:si,subscribeKey(t,e){return ls(si,t,e)},subscribe(t){return cs(si,()=>{t(si)})},subscribeProviders(t){return cs(si.providers,()=>t(si.providers))},setProvider(t,e){t&&e&&(si.providers[t]=Cg(e))},getProvider(t){if(t)return si.providers[t]},setProviderId(t,e){e&&(si.providerIds[t]=e)},getProviderId(t){if(t)return si.providerIds[t]},reset(){si.providers={...xE},si.providerIds={...xE}},resetChain(t){si.providers[t]=void 0,si.providerIds[t]=void 0}},Cy={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},zT={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},vie={providers:X8,selectedProvider:null,error:null,purchaseCurrency:Cy,paymentCurrency:zT,purchaseCurrencies:[Cy],paymentCurrencies:[],quotesLoading:!1},Zt=Un(vie),Eie={state:Zt,subscribe(t){return cs(Zt,()=>t(Zt))},subscribeKey(t,e){return ls(Zt,t,e)},setSelectedProvider(t){var e,n;if(t&&t.name==="meld"){const r=$.state.activeChain,s=r===ne.CHAIN.SOLANA?"SOL":"USDC",i=r?((n=(e=$.state.chains.get(r))==null?void 0:e.accountState)==null?void 0:n.address)??"":"",o=new URL(t.url);o.searchParams.append("publicKey",rse),o.searchParams.append("destinationCurrencyCode",s),o.searchParams.append("walletAddress",i),o.searchParams.append("externalCustomerId",fe.state.projectId),Zt.selectedProvider={...t,url:o.toString()}}else Zt.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=X8.filter(r=>e.includes(r.name));Zt.providers=n}else Zt.providers=[]},setPurchaseCurrency(t){Zt.purchaseCurrency=t},setPaymentCurrency(t){Zt.paymentCurrency=t},setPurchaseAmount(t){HT.state.purchaseAmount=t},setPaymentAmount(t){HT.state.paymentAmount=t},async getAvailableCurrencies(){const t=await yt.getOnrampOptions();Zt.purchaseCurrencies=t.purchaseCurrencies,Zt.paymentCurrencies=t.paymentCurrencies,Zt.paymentCurrency=t.paymentCurrencies[0]||zT,Zt.purchaseCurrency=t.purchaseCurrencies[0]||Cy,await dt.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await dt.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){var t,e;Zt.quotesLoading=!0;try{const n=await yt.getOnrampQuote({purchaseCurrency:Zt.purchaseCurrency,paymentCurrency:Zt.paymentCurrency,amount:((t=Zt.paymentAmount)==null?void 0:t.toString())||"0",network:(e=Zt.purchaseCurrency)==null?void 0:e.symbol});return Zt.quotesLoading=!1,Zt.purchaseAmount=Number(n==null?void 0:n.purchaseAmount.amount),n}catch(n){return Zt.error=n.message,Zt.quotesLoading=!1,null}finally{Zt.quotesLoading=!1}},resetState(){Zt.selectedProvider=null,Zt.error=null,Zt.purchaseCurrency=Cy,Zt.paymentCurrency=zT,Zt.purchaseCurrencies=[Cy],Zt.paymentCurrencies=[],Zt.paymentAmount=void 0,Zt.purchaseAmount=void 0,Zt.quotesLoading=!1}},HT=$o(Eie),Wo=Un({message:"",variant:"info",open:!1}),Cie={state:Wo,subscribeKey(t,e){return ls(Wo,t,e)},open(t,e){const{debug:n}=fe.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(Wo.message=s,Wo.variant=e,Wo.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},warn(t,e,n){Wo.open=!0,Wo.message=t,Wo.variant="warning",e&&console.warn(e,n)},close(){Wo.open=!1,Wo.message="",Wo.variant="info"}},_s=$o(Cie),GO=2147483648,Nie={convertEVMChainIdToCoinType(t){if(t>=GO)throw new Error("Invalid chainId");return(GO|t)>>>0}},oo=Un({suggestions:[],loading:!1}),Aie={state:oo,subscribe(t){return cs(oo,()=>t(oo))},subscribeKey(t,e){return ls(oo,t,e)},async resolveName(t){var e,n;try{return await yt.lookupEnsName(t)}catch(r){const s=r;throw new Error(((n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description)||"Error resolving name")}},async isNameRegistered(t){try{return await yt.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{oo.loading=!0,oo.suggestions=[];const e=await yt.getEnsNameSuggestions(t);return oo.suggestions=e.suggestions||[],oo.suggestions}catch(e){const n=Ny.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{oo.loading=!1}},async getNamesForAddress(t){try{if(!$.state.activeCaipNetwork)return[];const n=ye.getEnsFromCacheForAddress(t);if(n)return n;const r=await yt.reverseLookupEnsName({address:t});return ye.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=Ny.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){var s;const e=$.state.activeCaipNetwork,n=(s=$.getAccountData(e==null?void 0:e.chainNamespace))==null?void 0:s.address,r=Ie.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");oo.loading=!0;try{const i=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});ut.pushTransactionStack({onCancel(){ut.replace("RegisterAccountName")}});const o=await De.signMessage(i);oo.loading=!1;const c=e.id;if(!c)throw new Error("Network not found");const l=Nie.convertEVMChainIdToCoinType(Number(c));await yt.registerEnsName({coinType:l,address:n,signature:o,message:i}),$.setAccountProp("profileName",t,e.chainNamespace),ye.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),ut.replace("RegisterAccountNameSuccess")}catch(i){const o=Ny.parseEnsApiError(i,`Error registering name ${t}`);throw ut.replace("RegisterAccountName"),new Error(o)}finally{oo.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){var r,s;const n=t;return((s=(r=n==null?void 0:n.reasons)==null?void 0:r[0])==null?void 0:s.description)||e}},Ny=$o(Aie),Sie={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}};class Tie extends Error{}function _ie(){const{sdkType:t,sdkVersion:e,projectId:n}=fe.getSnapshot(),r=new URL("https://rpc.walletconnect.org/v1/json-rpc");return r.searchParams.set("projectId",n),r.searchParams.set("st",t),r.searchParams.set("sv",e),r.searchParams.set("source","fund-wallet"),r.toString()}async function JI(t,e){const n=_ie(),{projectId:r}=fe.getSnapshot(),s={jsonrpc:"2.0",id:1,method:t,params:{...e||{},projectId:r}},o=await(await fetch(n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new Tie(o.error.message);return o}async function Ije(t){return(await JI("reown_getExchanges",t)).result}async function jje(t){return(await JI("reown_getExchangePayUrl",t)).result}async function Rje(t){return(await JI("reown_getExchangeBuyStatus",t)).result}function Pje(t,e){const{chainNamespace:n,chainId:r}=jr.parseCaipNetworkId(t),s=Sie[n];if(!s)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${n}`);let i=s.native.assetNamespace,o=s.native.assetReference;return e!=="native"&&(i=s.defaultTokenNamespace,o=e),`${`${n}:${r}`}/${i}:${o}`}const kie={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},Iie={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},pF={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},jie={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},Rie={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},Pie={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Oie={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Die={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Uie={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Mie={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},Lie={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},Bie={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},$ie={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},Fie={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},zie={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},Hie={ethereumETH:kie,baseETH:Iie,baseUSDC:pF,baseSepoliaETH:Rie,ethereumUSDC:Pie,arbitrumUSDC:Oie,polygonUSDC:Die,solanaUSDC:Uie,ethereumUSDT:Mie,optimismUSDT:Lie,arbitrumUSDT:Bie,polygonUSDT:$ie,solanaUSDT:Fie,solanaSOL:zie};function Oje(t){return Object.values(Hie).filter(e=>e.network===t)}var ZI={exports:{}},um=typeof Reflect=="object"?Reflect:null,YO=um&&typeof um.apply=="function"?um.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},a1;um&&typeof um.ownKeys=="function"?a1=um.ownKeys:Object.getOwnPropertySymbols?a1=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:a1=function(e){return Object.getOwnPropertyNames(e)};function Vie(t){console&&console.warn&&console.warn(t)}var mF=Number.isNaN||function(e){return e!==e};function Nn(){Nn.init.call(this)}ZI.exports=Nn;ZI.exports.once=Gie;Nn.EventEmitter=Nn;Nn.prototype._events=void 0;Nn.prototype._eventsCount=0;Nn.prototype._maxListeners=void 0;var QO=10;function XC(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Nn,"defaultMaxListeners",{enumerable:!0,get:function(){return QO},set:function(t){if(typeof t!="number"||t<0||mF(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");QO=t}});Nn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Nn.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||mF(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function gF(t){return t._maxListeners===void 0?Nn.defaultMaxListeners:t._maxListeners}Nn.prototype.getMaxListeners=function(){return gF(this)};Nn.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var l=i[e];if(l===void 0)return!1;if(typeof l=="function")YO(l,this,n);else for(var d=l.length,u=vF(l,d),r=0;r<d;++r)YO(u[r],this,n);return!0};function yF(t,e,n,r){var s,i,o;if(XC(n),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),o=i[e]),o===void 0)o=i[e]=n,++t._eventsCount;else if(typeof o=="function"?o=i[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),s=gF(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,Vie(c)}return t}Nn.prototype.addListener=function(e,n){return yF(this,e,n,!1)};Nn.prototype.on=Nn.prototype.addListener;Nn.prototype.prependListener=function(e,n){return yF(this,e,n,!0)};function Wie(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function wF(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=Wie.bind(r);return s.listener=n,r.wrapFn=s,s}Nn.prototype.once=function(e,n){return XC(n),this.on(e,wF(this,e,n)),this};Nn.prototype.prependOnceListener=function(e,n){return XC(n),this.prependListener(e,wF(this,e,n)),this};Nn.prototype.removeListener=function(e,n){var r,s,i,o,c;if(XC(n),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){c=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():qie(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,c||n)}return this};Nn.prototype.off=Nn.prototype.removeListener;Nn.prototype.removeAllListeners=function(e){var n,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function xF(t,e,n){var r=t._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?Kie(s):vF(s,s.length)}Nn.prototype.listeners=function(e){return xF(this,e,!0)};Nn.prototype.rawListeners=function(e){return xF(this,e,!1)};Nn.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):bF.call(t,e)};Nn.prototype.listenerCount=bF;function bF(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Nn.prototype.eventNames=function(){return this._eventsCount>0?a1(this._events):[]};function vF(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function qie(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Kie(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function Gie(t,e){return new Promise(function(n,r){function s(o){t.removeListener(e,i),r(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}EF(t,e,i,{once:!0}),e!=="error"&&Yie(t,s,{once:!0})})}function Yie(t,e,n){typeof t.on=="function"&&EF(t,"error",e,n)}function EF(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){r.once&&t.removeEventListener(e,s),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Fo=ZI.exports;const XI=Mg(Fo);var Re={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var VT=function(t,e){return VT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},VT(t,e)};function Qie(t,e){VT(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var WT=function(){return WT=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},WT.apply(this,arguments)};function Jie(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Zie(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function Xie(t,e){return function(n,r){e(n,r,t)}}function eoe(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function toe(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(u){try{d(r.next(u))}catch(h){o(h)}}function l(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})}function noe(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(u){return l([d,u])}}function l(d){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,s=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){n.label=d[1];break}if(d[0]===6&&n.label<i[1]){n.label=i[1],i=d;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(d);break}i[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(u){d=[6,u],s=0}finally{r=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function roe(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function soe(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function qT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function CF(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(c){o={error:c}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function ioe(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(CF(arguments[e]));return t}function ooe(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,c=i.length;o<c;o++,s++)r[s]=i[o];return r}function Kw(t){return this instanceof Kw?(this.v=t,this):new Kw(t)}function aoe(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(p){return new Promise(function(m,g){i.push([f,p,m,g])>1||c(f,p)})})}function c(f,p){try{l(r[f](p))}catch(m){h(i[0][3],m)}}function l(f){f.value instanceof Kw?Promise.resolve(f.value.v).then(d,u):h(i[0][2],f)}function d(f){c("next",f)}function u(f){c("throw",f)}function h(f,p){f(p),i.shift(),i.length&&c(i[0][0],i[0][1])}}function coe(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:Kw(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function loe(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof qT=="function"?qT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(c,l){o=t[i](o),s(c,l,o.done,o.value)})}}function s(i,o,c,l){Promise.resolve(l).then(function(d){i({value:d,done:c})},o)}}function doe(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function uoe(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function hoe(t){return t&&t.__esModule?t:{default:t}}function foe(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function poe(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const moe=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return WT},__asyncDelegator:coe,__asyncGenerator:aoe,__asyncValues:loe,__await:Kw,__awaiter:toe,__classPrivateFieldGet:foe,__classPrivateFieldSet:poe,__createBinding:roe,__decorate:Zie,__exportStar:soe,__extends:Qie,__generator:noe,__importDefault:hoe,__importStar:uoe,__makeTemplateObject:doe,__metadata:eoe,__param:Xie,__read:CF,__rest:Jie,__spread:ioe,__spreadArrays:ooe,__values:qT},Symbol.toStringTag,{value:"Module"})),eN=BU(moe);var MA={},k0={},JO;function goe(){if(JO)return k0;JO=1,Object.defineProperty(k0,"__esModule",{value:!0}),k0.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return k0.delay=t,k0}var Pu={},LA={},Ou={},ZO;function yoe(){return ZO||(ZO=1,Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.ONE_THOUSAND=Ou.ONE_HUNDRED=void 0,Ou.ONE_HUNDRED=100,Ou.ONE_THOUSAND=1e3),Ou}var BA={},XO;function woe(){return XO||(XO=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(BA)),BA}var e4;function NF(){return e4||(e4=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=eN;e.__exportStar(yoe(),t),e.__exportStar(woe(),t)}(LA)),LA}var t4;function xoe(){if(t4)return Pu;t4=1,Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.fromMiliseconds=Pu.toMiliseconds=void 0;const t=NF();function e(r){return r*t.ONE_THOUSAND}Pu.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return Pu.fromMiliseconds=n,Pu}var n4;function boe(){return n4||(n4=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=eN;e.__exportStar(goe(),t),e.__exportStar(xoe(),t)}(MA)),MA}var Qf={},r4;function voe(){if(r4)return Qf;r4=1,Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Qf.Watch=t,Qf.default=t,Qf}var $A={},I0={},s4;function Eoe(){if(s4)return I0;s4=1,Object.defineProperty(I0,"__esModule",{value:!0}),I0.IWatch=void 0;class t{}return I0.IWatch=t,I0}var i4;function Coe(){return i4||(i4=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),eN.__exportStar(Eoe(),t)}($A)),$A}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=eN;e.__exportStar(boe(),t),e.__exportStar(voe(),t),e.__exportStar(Coe(),t),e.__exportStar(NF(),t)})(Re);class Df{}let Noe=class extends Df{constructor(e){super()}};const o4=Re.FIVE_SECONDS,Uf={pulse:"heartbeat_pulse"};let Aoe=class AF extends Noe{constructor(e){super(e),this.events=new Fo.EventEmitter,this.interval=o4,this.interval=(e==null?void 0:e.interval)||o4}static async init(e){const n=new AF(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Re.toMiliseconds(this.interval))}pulse(){this.events.emit(Uf.pulse)}};const Soe=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Toe=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,_oe=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function koe(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Ioe(t);return}return e}function Ioe(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function rv(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!_oe.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(Soe.test(t)||Toe.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,koe)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function joe(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Lr(t,...e){try{return joe(t(...e))}catch(n){return Promise.reject(n)}}function Roe(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function Poe(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function c1(t){if(Roe(t))return String(t);if(Poe(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return c1(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const KT="base64:";function Ooe(t){return typeof t=="string"?t:KT+Moe(t)}function Doe(t){return typeof t!="string"||!t.startsWith(KT)?t:Uoe(t.slice(KT.length))}function Uoe(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function Moe(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function ci(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function Loe(...t){return ci(t.join(":"))}function sv(t){return t=ci(t),t?t+":":""}function Boe(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function $oe(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const Foe="memory",zoe=()=>{const t=new Map;return{name:Foe,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function Hoe(t={}){const e={mounts:{"":t.driver||zoe()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=d=>{for(const u of e.mountpoints)if(d.startsWith(u))return{base:u,relativeKey:d.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:d,driver:e.mounts[""]}},r=(d,u)=>e.mountpoints.filter(h=>h.startsWith(d)||u&&d.startsWith(h)).map(h=>({relativeBase:d.length>h.length?d.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(d,u)=>{if(e.watching){u=ci(u);for(const h of e.watchListeners)h(d,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const d in e.mounts)e.unwatch[d]=await a4(e.mounts[d],s,d)}},o=async()=>{if(e.watching){for(const d in e.unwatch)await e.unwatch[d]();e.unwatch={},e.watching=!1}},c=(d,u,h)=>{const f=new Map,p=m=>{let g=f.get(m.base);return g||(g={driver:m.driver,base:m.base,items:[]},f.set(m.base,g)),g};for(const m of d){const g=typeof m=="string",y=ci(g?m:m.key),x=g?void 0:m.value,w=g||!m.options?u:{...u,...m.options},b=n(y);p(b).items.push({key:y,value:x,relativeKey:b.relativeKey,options:w})}return Promise.all([...f.values()].map(m=>h(m))).then(m=>m.flat())},l={hasItem(d,u={}){d=ci(d);const{relativeKey:h,driver:f}=n(d);return Lr(f.hasItem,h,u)},getItem(d,u={}){d=ci(d);const{relativeKey:h,driver:f}=n(d);return Lr(f.getItem,h,u).then(p=>rv(p))},getItems(d,u={}){return c(d,u,h=>h.driver.getItems?Lr(h.driver.getItems,h.items.map(f=>({key:f.relativeKey,options:f.options})),u).then(f=>f.map(p=>({key:Loe(h.base,p.key),value:rv(p.value)}))):Promise.all(h.items.map(f=>Lr(h.driver.getItem,f.relativeKey,f.options).then(p=>({key:f.key,value:rv(p)})))))},getItemRaw(d,u={}){d=ci(d);const{relativeKey:h,driver:f}=n(d);return f.getItemRaw?Lr(f.getItemRaw,h,u):Lr(f.getItem,h,u).then(p=>Doe(p))},async setItem(d,u,h={}){if(u===void 0)return l.removeItem(d);d=ci(d);const{relativeKey:f,driver:p}=n(d);p.setItem&&(await Lr(p.setItem,f,c1(u),h),p.watch||s("update",d))},async setItems(d,u){await c(d,u,async h=>{if(h.driver.setItems)return Lr(h.driver.setItems,h.items.map(f=>({key:f.relativeKey,value:c1(f.value),options:f.options})),u);h.driver.setItem&&await Promise.all(h.items.map(f=>Lr(h.driver.setItem,f.relativeKey,c1(f.value),f.options)))})},async setItemRaw(d,u,h={}){if(u===void 0)return l.removeItem(d,h);d=ci(d);const{relativeKey:f,driver:p}=n(d);if(p.setItemRaw)await Lr(p.setItemRaw,f,u,h);else if(p.setItem)await Lr(p.setItem,f,Ooe(u),h);else return;p.watch||s("update",d)},async removeItem(d,u={}){typeof u=="boolean"&&(u={removeMeta:u}),d=ci(d);const{relativeKey:h,driver:f}=n(d);f.removeItem&&(await Lr(f.removeItem,h,u),(u.removeMeta||u.removeMata)&&await Lr(f.removeItem,h+"$",u),f.watch||s("remove",d))},async getMeta(d,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),d=ci(d);const{relativeKey:h,driver:f}=n(d),p=Object.create(null);if(f.getMeta&&Object.assign(p,await Lr(f.getMeta,h,u)),!u.nativeOnly){const m=await Lr(f.getItem,h+"$",u).then(g=>rv(g));m&&typeof m=="object"&&(typeof m.atime=="string"&&(m.atime=new Date(m.atime)),typeof m.mtime=="string"&&(m.mtime=new Date(m.mtime)),Object.assign(p,m))}return p},setMeta(d,u,h={}){return this.setItem(d+"$",u,h)},removeMeta(d,u={}){return this.removeItem(d+"$",u)},async getKeys(d,u={}){var y;d=sv(d);const h=r(d,!0);let f=[];const p=[];let m=!0;for(const x of h){(y=x.driver.flags)!=null&&y.maxDepth||(m=!1);const w=await Lr(x.driver.getKeys,x.relativeBase,u);for(const b of w){const v=x.mountpoint+ci(b);f.some(E=>v.startsWith(E))||p.push(v)}f=[x.mountpoint,...f.filter(b=>!b.startsWith(x.mountpoint))]}const g=u.maxDepth!==void 0&&!m;return p.filter(x=>(!g||Boe(x,u.maxDepth))&&$oe(x,d))},async clear(d,u={}){d=sv(d),await Promise.all(r(d,!1).map(async h=>{if(h.driver.clear)return Lr(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const f=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(f.map(p=>h.driver.removeItem(p,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(d=>c4(d)))},async watch(d){return await i(),e.watchListeners.push(d),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==d),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(d,u){if(d=sv(d),d&&e.mounts[d])throw new Error(`already mounted at ${d}`);return d&&(e.mountpoints.push(d),e.mountpoints.sort((h,f)=>f.length-h.length)),e.mounts[d]=u,e.watching&&Promise.resolve(a4(u,s,d)).then(h=>{e.unwatch[d]=h}).catch(console.error),l},async unmount(d,u=!0){var h,f;d=sv(d),!(!d||!e.mounts[d])&&(e.watching&&d in e.unwatch&&((f=(h=e.unwatch)[d])==null||f.call(h),delete e.unwatch[d]),u&&await c4(e.mounts[d]),e.mountpoints=e.mountpoints.filter(p=>p!==d),delete e.mounts[d])},getMount(d=""){d=ci(d)+":";const u=n(d);return{driver:u.driver,base:u.base}},getMounts(d="",u={}){return d=ci(d),r(d,u.parents).map(f=>({driver:f.driver,base:f.mountpoint}))},keys:(d,u={})=>l.getKeys(d,u),get:(d,u={})=>l.getItem(d,u),set:(d,u,h={})=>l.setItem(d,u,h),has:(d,u={})=>l.hasItem(d,u),del:(d,u={})=>l.removeItem(d,u),remove:(d,u={})=>l.removeItem(d,u)};return l}function a4(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function c4(t){typeof t.dispose=="function"&&await Lr(t.dispose)}function Mf(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function SF(t,e){let n;const r=()=>{if(n)return n;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),n=Mf(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(e,s).objectStore(e)))}let FA;function tb(){return FA||(FA=SF("keyval-store","keyval")),FA}function l4(t,e=tb()){return e("readonly",n=>Mf(n.get(t)))}function Voe(t,e,n=tb()){return n("readwrite",r=>(r.put(e,t),Mf(r.transaction)))}function Woe(t,e=tb()){return e("readwrite",n=>(n.delete(t),Mf(n.transaction)))}function qoe(t=tb()){return t("readwrite",e=>(e.clear(),Mf(e.transaction)))}function Koe(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Mf(t.transaction)}function Goe(t=tb()){return t("readonly",e=>{if(e.getAllKeys)return Mf(e.getAllKeys());const n=[];return Koe(e,r=>n.push(r.key)).then(()=>n)})}const Yoe=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),Qoe=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function wf(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Qoe(t)}catch{return t}}function jl(t){return typeof t=="string"?t:Yoe(t)||""}const Joe="idb-keyval";var Zoe=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=SF(t.dbName,t.storeName)),{name:Joe,options:t,async hasItem(s){return!(typeof await l4(n(s),r)>"u")},async getItem(s){return await l4(n(s),r)??null},setItem(s,i){return Voe(n(s),i,r)},removeItem(s){return Woe(n(s),r)},getKeys(){return Goe(r)},clear(){return qoe(r)}}};const Xoe="WALLET_CONNECT_V2_INDEXED_DB",eae="keyvaluestorage";let tae=class{constructor(){this.indexedDb=Hoe({driver:Zoe({dbName:Xoe,storeName:eae})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,jl(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var zA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l1={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof zA<"u"&&zA.localStorage?l1.exports=zA.localStorage:typeof window<"u"&&window.localStorage?l1.exports=window.localStorage:l1.exports=new e})();function nae(t){var e;return[t[0],wf((e=t[1])!=null?e:"")]}let rae=class{constructor(){this.localStorage=l1.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(nae)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return wf(n)}async setItem(e,n){this.localStorage.setItem(e,jl(n))}async removeItem(e){this.localStorage.removeItem(e)}};const sae="wc_storage_version",d4=1,iae=async(t,e,n)=>{const r=sae,s=await e.getItem(r);if(s&&s>=d4){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const c=i.shift();if(!c)continue;const l=c.toLowerCase();if(l.includes("wc@")||l.includes("walletconnect")||l.includes("wc_")||l.includes("wallet_connect")){const d=await t.getItem(c);await e.setItem(c,d),o.push(c)}}await e.setItem(r,d4),n(e),oae(t,o)},oae=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let aae=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new rae;this.storage=e;try{const n=new tae;iae(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};function cae(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var lae=dae;function dae(t,e,n){var r=n&&n.stringify||cae,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=r(t);for(var c=1;c<i;c++)o[c]=r(e[c]);return o.join(" ")}if(typeof t!="string")return t;var l=e.length;if(l===0)return t;for(var d="",u=1-s,h=-1,f=t&&t.length||0,p=0;p<f;){if(t.charCodeAt(p)===37&&p+1<f){switch(h=h>-1?h:0,t.charCodeAt(p+1)){case 100:case 102:if(u>=l||e[u]==null)break;h<p&&(d+=t.slice(h,p)),d+=Number(e[u]),h=p+2,p++;break;case 105:if(u>=l||e[u]==null)break;h<p&&(d+=t.slice(h,p)),d+=Math.floor(Number(e[u])),h=p+2,p++;break;case 79:case 111:case 106:if(u>=l||e[u]===void 0)break;h<p&&(d+=t.slice(h,p));var m=typeof e[u];if(m==="string"){d+="'"+e[u]+"'",h=p+2,p++;break}if(m==="function"){d+=e[u].name||"<anonymous>",h=p+2,p++;break}d+=r(e[u]),h=p+2,p++;break;case 115:if(u>=l)break;h<p&&(d+=t.slice(h,p)),d+=String(e[u]),h=p+2,p++;break;case 37:h<p&&(d+=t.slice(h,p)),d+="%",h=p+2,p++,u--;break}++u}++p}return h===-1?t:(h<f&&(d+=t.slice(h)),d)}const u4=lae;var Ep=wc;const Gw=bae().console||{},uae={mapHttpRequest:iv,mapHttpResponse:iv,wrapRequestSerializer:HA,wrapResponseSerializer:HA,wrapErrorSerializer:HA,req:iv,res:iv,err:gae};function hae(t,e){return Array.isArray(t)?t.filter(function(r){return r!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function wc(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const n=t.browser.write||Gw;t.browser.write&&(t.browser.asObject=!0);const r=t.serializers||{},s=hae(t.browser.serialize,r);let i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof n=="function"&&(n.error=n.fatal=n.warn=n.info=n.debug=n.trace=n),t.enabled===!1&&(t.level="silent");const c=t.level||"info",l=Object.create(n);l.log||(l.log=Yw),Object.defineProperty(l,"levelVal",{get:u}),Object.defineProperty(l,"level",{get:h,set:f});const d={transmit:e,serialize:s,asObject:t.browser.asObject,levels:o,timestamp:yae(t)};l.levels=wc.levels,l.level=c,l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=Yw,l.serializers=r,l._serialize=s,l._stdErrSerialize=i,l.child=p,e&&(l._logEvent=GT());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function h(){return this._level}function f(m){if(m!=="silent"&&!this.levels.values[m])throw Error("unknown level "+m);this._level=m,Jf(d,l,"error","log"),Jf(d,l,"fatal","error"),Jf(d,l,"warn","error"),Jf(d,l,"info","log"),Jf(d,l,"debug","log"),Jf(d,l,"trace","log")}function p(m,g){if(!m)throw new Error("missing bindings for child Pino");g=g||{},s&&m.serializers&&(g.serializers=m.serializers);const y=g.serializers;if(s&&y){var x=Object.assign({},r,y),w=t.browser.serialize===!0?Object.keys(x):s;delete m.serializers,tN([m],w,x,this._stdErrSerialize)}function b(v){this._childLevel=(v._childLevel|0)+1,this.error=Zf(v,m,"error"),this.fatal=Zf(v,m,"fatal"),this.warn=Zf(v,m,"warn"),this.info=Zf(v,m,"info"),this.debug=Zf(v,m,"debug"),this.trace=Zf(v,m,"trace"),x&&(this.serializers=x,this._serialize=w),e&&(this._logEvent=GT([].concat(v._logEvent.bindings,m)))}return b.prototype=this,new b(this)}return l}wc.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};wc.stdSerializers=uae;wc.stdTimeFunctions=Object.assign({},{nullTime:TF,epochTime:_F,unixTime:wae,isoTime:xae});function Jf(t,e,n,r){const s=Object.getPrototypeOf(e);e[n]=e.levelVal>e.levels.values[n]?Yw:s[n]?s[n]:Gw[n]||Gw[r]||Yw,fae(t,e,n)}function fae(t,e,n){!t.transmit&&e[n]===Yw||(e[n]=function(r){return function(){const i=t.timestamp(),o=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Gw?Gw:this;for(var l=0;l<o.length;l++)o[l]=arguments[l];if(t.serialize&&!t.asObject&&tN(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?r.call(c,pae(this,n,o,i)):r.apply(c,o),t.transmit){const d=t.transmit.level||e.level,u=wc.levels.values[d],h=wc.levels.values[n];if(h<u)return;mae(this,{ts:i,methodLevel:n,methodValue:h,transmitValue:wc.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[n]))}function pae(t,e,n,r){t._serialize&&tN(n,t._serialize,t.serializers,t._stdErrSerialize);const s=n.slice();let i=s[0];const o={};r&&(o.time=r),o.level=wc.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),i!==null&&typeof i=="object"){for(;c--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?u4(s.shift(),s):void 0}else typeof i=="string"&&(i=u4(s.shift(),s));return i!==void 0&&(o.msg=i),o}function tN(t,e,n,r){for(const s in t)if(r&&t[s]instanceof Error)t[s]=wc.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s]))for(const i in t[s])e&&e.indexOf(i)>-1&&i in n&&(t[s][i]=n[i](t[s][i]))}function Zf(t,e,n){return function(){const r=new Array(1+arguments.length);r[0]=e;for(var s=1;s<r.length;s++)r[s]=arguments[s-1];return t[n].apply(this,r)}}function mae(t,e,n){const r=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,c=e.val,l=t._logEvent.bindings;tN(n,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=s,t._logEvent.messages=n.filter(function(d){return l.indexOf(d)===-1}),t._logEvent.level.label=i,t._logEvent.level.value=o,r(i,t._logEvent,c),t._logEvent=GT(l)}function GT(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function gae(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const n in t)e[n]===void 0&&(e[n]=t[n]);return e}function yae(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?TF:_F}function iv(){return{}}function HA(t){return t}function Yw(){}function TF(){return!1}function _F(){return Date.now()}function wae(){return Math.round(Date.now()/1e3)}function xae(){return new Date(Date.now()).toISOString()}function bae(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const nb=Mg(Ep),vae={level:"info"},rb="custom_context",ej=1e3*1024;let Eae=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},h4=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new Eae(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}},kF=class{constructor(e,n=ej){this.level=e??"error",this.levelValue=Ep.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new h4(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===Ep.levels.values.error?console.error(e):n===Ep.levels.values.warn?console.warn(e):n===Ep.levels.values.debug?console.debug(e):n===Ep.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(jl({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new h4(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(jl({extraMetadata:e})),new Blob(n,{type:"application/json"})}},Cae=class{constructor(e,n=ej){this.baseChunkLogger=new kF(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},Nae=class{constructor(e,n=ej){this.baseChunkLogger=new kF(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var Aae=Object.defineProperty,Sae=Object.defineProperties,Tae=Object.getOwnPropertyDescriptors,f4=Object.getOwnPropertySymbols,_ae=Object.prototype.hasOwnProperty,kae=Object.prototype.propertyIsEnumerable,p4=(t,e,n)=>e in t?Aae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bE=(t,e)=>{for(var n in e||(e={}))_ae.call(e,n)&&p4(t,n,e[n]);if(f4)for(var n of f4(e))kae.call(e,n)&&p4(t,n,e[n]);return t},vE=(t,e)=>Sae(t,Tae(e));function qg(t){return vE(bE({},t),{level:(t==null?void 0:t.level)||vae.level})}function Iae(t,e=rb){return t[e]||""}function jae(t,e,n=rb){return t[n]=e,t}function ji(t,e=rb){let n="";return typeof t.bindings>"u"?n=Iae(t,e):n=t.bindings().context||"",n}function Rae(t,e,n=rb){const r=ji(t,n);return r.trim()?`${r}/${e}`:e}function Ds(t,e,n=rb){const r=Rae(t,e,n),s=t.child({context:r});return jae(s,r,n)}function Pae(t){var e,n;const r=new Cae((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:nb(vE(bE({},t.opts),{level:"trace",browser:vE(bE({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function Oae(t){var e;const n=new Nae((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:nb(vE(bE({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function tj(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Pae(t):Oae(t)}var Dae=Object.defineProperty,Uae=(t,e,n)=>e in t?Dae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,m4=(t,e,n)=>Uae(t,typeof e!="symbol"?e+"":e,n);let Mae=class extends Df{constructor(e){super(),this.opts=e,m4(this,"protocol","wc"),m4(this,"version",2)}};var Lae=Object.defineProperty,Bae=(t,e,n)=>e in t?Lae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$ae=(t,e,n)=>Bae(t,e+"",n);let Fae=class extends Df{constructor(e,n){super(),this.core=e,this.logger=n,$ae(this,"records",new Map)}},zae=class{constructor(e,n){this.logger=e,this.core=n}},Hae=class extends Df{constructor(e,n){super(),this.relayer=e,this.logger=n}},Vae=class extends Df{constructor(e){super()}},Wae=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},qae=class extends Df{constructor(e,n){super(),this.relayer=e,this.logger=n}},Kae=class extends Df{constructor(e,n){super(),this.core=e,this.logger=n}},Gae=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},Yae=class{constructor(e,n){this.projectId=e,this.logger=n}},Qae=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var Jae=Object.defineProperty,Zae=(t,e,n)=>e in t?Jae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,g4=(t,e,n)=>Zae(t,typeof e!="symbol"?e+"":e,n);let Xae=class{constructor(e){this.opts=e,g4(this,"protocol","wc"),g4(this,"version",2)}},ece=class{constructor(e){this.client=e}};function tce(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function IF(t,...e){if(!tce(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function y4(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function nce(t,e){IF(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Xf=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const VA=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function rce(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function jF(t){return typeof t=="string"&&(t=rce(t)),IF(t),t}let sce=class{clone(){return this._cloneInto()}};function ice(t){const e=r=>t().update(jF(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function RF(t=32){if(Xf&&typeof Xf.getRandomValues=="function")return Xf.getRandomValues(new Uint8Array(t));if(Xf&&typeof Xf.randomBytes=="function")return Xf.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function oce(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),c=Number(n&i),l=r?4:0,d=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+d,c,r)}let ace=class extends sce{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=VA(this.buffer)}update(e){y4(this);const{view:n,buffer:r,blockLen:s}=this;e=jF(e);const i=e.length;for(let o=0;o<i;){const c=Math.min(s-this.pos,i-o);if(c===s){const l=VA(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){y4(this),nce(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;oce(r,s-8,BigInt(this.length*8),i),this.process(r,0);const c=VA(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)c.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:c}=this;return e.length=s,e.pos=c,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const ov=BigInt(2**32-1),YT=BigInt(32);function PF(t,e=!1){return e?{h:Number(t&ov),l:Number(t>>YT&ov)}:{h:Number(t>>YT&ov)|0,l:Number(t&ov)|0}}function cce(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=PF(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const lce=(t,e)=>BigInt(t>>>0)<<YT|BigInt(e>>>0),dce=(t,e,n)=>t>>>n,uce=(t,e,n)=>t<<32-n|e>>>n,hce=(t,e,n)=>t>>>n|e<<32-n,fce=(t,e,n)=>t<<32-n|e>>>n,pce=(t,e,n)=>t<<64-n|e>>>n-32,mce=(t,e,n)=>t>>>n-32|e<<64-n,gce=(t,e)=>e,yce=(t,e)=>t,wce=(t,e,n)=>t<<n|e>>>32-n,xce=(t,e,n)=>e<<n|t>>>32-n,bce=(t,e,n)=>e<<n-32|t>>>64-n,vce=(t,e,n)=>t<<n-32|e>>>64-n;function Ece(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Cce=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Nce=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,Ace=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),Sce=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,Tce=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),_ce=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,_t={fromBig:PF,split:cce,toBig:lce,shrSH:dce,shrSL:uce,rotrSH:hce,rotrSL:fce,rotrBH:pce,rotrBL:mce,rotr32H:gce,rotr32L:yce,rotlSH:wce,rotlSL:xce,rotlBH:bce,rotlBL:vce,add:Ece,add3L:Cce,add3H:Nce,add4L:Ace,add4H:Sce,add5H:_ce,add5L:Tce},[kce,Ice]=_t.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ql=new Uint32Array(80),Kl=new Uint32Array(80);let jce=class extends ace{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:c,Dl:l,Eh:d,El:u,Fh:h,Fl:f,Gh:p,Gl:m,Hh:g,Hl:y}=this;return[e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y]}set(e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=c|0,this.Dl=l|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=p|0,this.Gl=m|0,this.Hh=g|0,this.Hl=y|0}process(e,n){for(let b=0;b<16;b++,n+=4)ql[b]=e.getUint32(n),Kl[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const v=ql[b-15]|0,E=Kl[b-15]|0,k=_t.rotrSH(v,E,1)^_t.rotrSH(v,E,8)^_t.shrSH(v,E,7),C=_t.rotrSL(v,E,1)^_t.rotrSL(v,E,8)^_t.shrSL(v,E,7),S=ql[b-2]|0,N=Kl[b-2]|0,I=_t.rotrSH(S,N,19)^_t.rotrBH(S,N,61)^_t.shrSH(S,N,6),F=_t.rotrSL(S,N,19)^_t.rotrBL(S,N,61)^_t.shrSL(S,N,6),P=_t.add4L(C,F,Kl[b-7],Kl[b-16]),H=_t.add4H(P,k,I,ql[b-7],ql[b-16]);ql[b]=H|0,Kl[b]=P|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:c,Cl:l,Dh:d,Dl:u,Eh:h,El:f,Fh:p,Fl:m,Gh:g,Gl:y,Hh:x,Hl:w}=this;for(let b=0;b<80;b++){const v=_t.rotrSH(h,f,14)^_t.rotrSH(h,f,18)^_t.rotrBH(h,f,41),E=_t.rotrSL(h,f,14)^_t.rotrSL(h,f,18)^_t.rotrBL(h,f,41),k=h&p^~h&g,C=f&m^~f&y,S=_t.add5L(w,E,C,Ice[b],Kl[b]),N=_t.add5H(S,x,v,k,kce[b],ql[b]),I=S|0,F=_t.rotrSH(r,s,28)^_t.rotrBH(r,s,34)^_t.rotrBH(r,s,39),P=_t.rotrSL(r,s,28)^_t.rotrBL(r,s,34)^_t.rotrBL(r,s,39),H=r&i^r&c^i&c,z=s&o^s&l^o&l;x=g|0,w=y|0,g=p|0,y=m|0,p=h|0,m=f|0,{h,l:f}=_t.add(d|0,u|0,N|0,I|0),d=c|0,u=l|0,c=i|0,l=o|0,i=r|0,o=s|0;const T=_t.add3L(I,P,z);r=_t.add3H(T,N,F,H),s=T|0}({h:r,l:s}=_t.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=_t.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:c,l}=_t.add(this.Ch|0,this.Cl|0,c|0,l|0),{h:d,l:u}=_t.add(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:f}=_t.add(this.Eh|0,this.El|0,h|0,f|0),{h:p,l:m}=_t.add(this.Fh|0,this.Fl|0,p|0,m|0),{h:g,l:y}=_t.add(this.Gh|0,this.Gl|0,g|0,y|0),{h:x,l:w}=_t.add(this.Hh|0,this.Hl|0,x|0,w|0),this.set(r,s,i,o,c,l,d,u,h,f,p,m,g,y,x,w)}roundClean(){ql.fill(0),Kl.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const Rce=ice(()=>new jce);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nj=BigInt(0),OF=BigInt(1),Pce=BigInt(2);function rj(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function sj(t){if(!rj(t))throw new Error("Uint8Array expected")}function WA(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Oce=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ij(t){sj(t);let e="";for(let n=0;n<t.length;n++)e+=Oce[t[n]];return e}function DF(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?nj:BigInt("0x"+t)}const Dc={_0:48,_9:57,A:65,F:70,a:97,f:102};function w4(t){if(t>=Dc._0&&t<=Dc._9)return t-Dc._0;if(t>=Dc.A&&t<=Dc.F)return t-(Dc.A-10);if(t>=Dc.a&&t<=Dc.f)return t-(Dc.a-10)}function UF(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=w4(t.charCodeAt(i)),c=w4(t.charCodeAt(i+1));if(o===void 0||c===void 0){const l=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}r[s]=o*16+c}return r}function Dce(t){return DF(ij(t))}function d1(t){return sj(t),DF(ij(Uint8Array.from(t).reverse()))}function MF(t,e){return UF(t.toString(16).padStart(e*2,"0"))}function QT(t,e){return MF(t,e).reverse()}function Uc(t,e,n){let r;if(typeof e=="string")try{r=UF(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(rj(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function x4(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];sj(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const qA=t=>typeof t=="bigint"&&nj<=t;function Uce(t,e,n){return qA(t)&&qA(e)&&qA(n)&&e<=t&&t<n}function j0(t,e,n,r){if(!Uce(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function Mce(t){let e;for(e=0;t>nj;t>>=OF,e+=1);return e}const Lce=t=>(Pce<<BigInt(t-1))-OF,Bce={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||rj(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function oj(t,e,n={}){const r=(s,i,o)=>{const c=Bce[i];if(typeof c!="function")throw new Error("invalid validator function");const l=t[s];if(!(o&&l===void 0)&&!c(l,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+l)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function b4(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Vr=BigInt(0),hr=BigInt(1),Qu=BigInt(2),$ce=BigInt(3),JT=BigInt(4),v4=BigInt(5),E4=BigInt(8);function _r(t,e){const n=t%e;return n>=Vr?n:e+n}function Fce(t,e,n){if(e<Vr)throw new Error("invalid exponent, negatives unsupported");if(n<=Vr)throw new Error("invalid modulus");if(n===hr)return Vr;let r=hr;for(;e>Vr;)e&hr&&(r=r*t%n),t=t*t%n,e>>=hr;return r}function Da(t,e,n){let r=t;for(;e-- >Vr;)r*=r,r%=n;return r}function C4(t,e){if(t===Vr)throw new Error("invert: expected non-zero number");if(e<=Vr)throw new Error("invert: expected positive modulus, got "+e);let n=_r(t,e),r=e,s=Vr,i=hr;for(;n!==Vr;){const o=r/n,c=r%n,l=s-i*o;r=n,n=c,s=i,i=l}if(r!==hr)throw new Error("invert: does not exist");return _r(s,e)}function zce(t){const e=(t-hr)/Qu;let n,r,s;for(n=t-hr,r=0;n%Qu===Vr;n/=Qu,r++);for(s=Qu;s<t&&Fce(s,e,t)!==t-hr;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+hr)/JT;return function(c,l){const d=c.pow(l,o);if(!c.eql(c.sqr(d),l))throw new Error("Cannot find square root");return d}}const i=(n+hr)/Qu;return function(o,c){if(o.pow(c,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let l=r,d=o.pow(o.mul(o.ONE,s),n),u=o.pow(c,i),h=o.pow(c,n);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let f=1;for(let m=o.sqr(h);f<l&&!o.eql(m,o.ONE);f++)m=o.sqr(m);const p=o.pow(d,hr<<BigInt(l-f-1));d=o.sqr(p),u=o.mul(u,p),h=o.mul(h,d),l=f}return u}}function Hce(t){if(t%JT===$ce){const e=(t+hr)/JT;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%E4===v4){const e=(t-v4)/E4;return function(n,r){const s=n.mul(r,Qu),i=n.pow(s,e),o=n.mul(r,i),c=n.mul(n.mul(o,Qu),i),l=n.mul(o,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),r))throw new Error("Cannot find square root");return l}}return zce(t)}const Vce=(t,e)=>(_r(t,e)&hr)===hr,Wce=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qce(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Wce.reduce((r,s)=>(r[s]="function",r),e);return oj(t,n)}function Kce(t,e,n){if(n<Vr)throw new Error("invalid exponent, negatives unsupported");if(n===Vr)return t.ONE;if(n===hr)return e;let r=t.ONE,s=e;for(;n>Vr;)n&hr&&(r=t.mul(r,s)),s=t.sqr(s),n>>=hr;return r}function Gce(t,e){const n=new Array(e.length),r=e.reduce((i,o,c)=>t.is0(o)?i:(n[c]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,c)=>t.is0(o)?i:(n[c]=t.mul(i,n[c]),t.mul(i,o)),s),n}function LF(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function BF(t,e,n=!1,r={}){if(t<=Vr)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=LF(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const c=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:Lce(s),ZERO:Vr,ONE:hr,create:l=>_r(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof l);return Vr<=l&&l<t},is0:l=>l===Vr,isOdd:l=>(l&hr)===hr,neg:l=>_r(-l,t),eql:(l,d)=>l===d,sqr:l=>_r(l*l,t),add:(l,d)=>_r(l+d,t),sub:(l,d)=>_r(l-d,t),mul:(l,d)=>_r(l*d,t),pow:(l,d)=>Kce(c,l,d),div:(l,d)=>_r(l*C4(d,t),t),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>C4(l,t),sqrt:r.sqrt||(l=>(o||(o=Hce(t)),o(c,l))),invertBatch:l=>Gce(c,l),cmov:(l,d,u)=>u?d:l,toBytes:l=>n?QT(l,i):MF(l,i),fromBytes:l=>{if(l.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+l.length);return n?d1(l):Dce(l)}});return Object.freeze(c)}const N4=BigInt(0),av=BigInt(1);function KA(t,e){const n=e.negate();return t?n:e}function $F(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function GA(t,e){$F(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function Yce(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function Qce(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const YA=new WeakMap,FF=new WeakMap;function QA(t){return FF.get(t)||1}function Jce(t,e){return{constTimeNegate:KA,hasPrecomputes(n){return QA(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>N4;)r&av&&(s=s.add(i)),i=i.double(),r>>=av;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=GA(r,e),o=[];let c=n,l=c;for(let d=0;d<s;d++){l=c,o.push(l);for(let u=1;u<i;u++)l=l.add(c),o.push(l);c=l.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=GA(n,e);let c=t.ZERO,l=t.BASE;const d=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let f=0;f<i;f++){const p=f*o;let m=Number(s&d);s>>=h,m>o&&(m-=u,s+=av);const g=p,y=p+Math.abs(m)-1,x=f%2!==0,w=m<0;m===0?l=l.add(KA(x,r[g])):c=c.add(KA(w,r[y]))}return{p:c,f:l}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:c}=GA(n,e),l=BigInt(2**n-1),d=2**n,u=BigInt(n);for(let h=0;h<o;h++){const f=h*c;if(s===N4)break;let p=Number(s&l);if(s>>=u,p>c&&(p-=d,s+=av),p===0)continue;let m=r[f+Math.abs(p)-1];p<0&&(m=m.negate()),i=i.add(m)}return i},getPrecomputes(n,r,s){let i=YA.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&YA.set(r,s(i))),i},wNAFCached(n,r,s){const i=QA(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=QA(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){$F(r,e),FF.set(n,r),YA.delete(n)}}}function Zce(t,e,n,r){if(Yce(n,t),Qce(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=Mce(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,c=(1<<o)-1,l=new Array(c+1).fill(s),d=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=d;h>=0;h-=o){l.fill(s);for(let p=0;p<r.length;p++){const m=r[p],g=Number(m>>BigInt(h)&BigInt(c));l[g]=l[g].add(n[p])}let f=s;for(let p=l.length-1,m=s;p>0;p--)m=m.add(l[p]),f=f.add(m);if(u=u.add(f),h!==0)for(let p=0;p<o;p++)u=u.double()}return u}function Xce(t){return qce(t.Fp),oj(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...LF(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const qo=BigInt(0),ii=BigInt(1),cv=BigInt(2),ele=BigInt(8),tle={zip215:!0};function nle(t){const e=Xce(t);return oj(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function rle(t){const e=nle(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:c,h:l}=e,d=cv<<BigInt(c*8)-ii,u=n.create,h=BF(e.n,e.nBitLength),f=e.uvRatio||((T,_)=>{try{return{isValid:!0,value:n.sqrt(T*n.inv(_))}}catch{return{isValid:!1,value:qo}}}),p=e.adjustScalarBytes||(T=>T),m=e.domain||((T,_,L)=>{if(WA("phflag",L),_.length||L)throw new Error("Contexts/pre-hash are not supported");return T});function g(T,_){j0("coordinate "+T,_,qo,d)}function y(T){if(!(T instanceof b))throw new Error("ExtendedPoint expected")}const x=b4((T,_)=>{const{ex:L,ey:O,ez:M}=T,B=T.is0();_==null&&(_=B?ele:n.inv(M));const W=u(L*_),Z=u(O*_),ie=u(M*_);if(B)return{x:qo,y:ii};if(ie!==ii)throw new Error("invZ was invalid");return{x:W,y:Z}}),w=b4(T=>{const{a:_,d:L}=e;if(T.is0())throw new Error("bad point: ZERO");const{ex:O,ey:M,ez:B,et:W}=T,Z=u(O*O),ie=u(M*M),ae=u(B*B),oe=u(ae*ae),Ne=u(Z*_),de=u(ae*u(Ne+ie)),_e=u(oe+u(L*u(Z*ie)));if(de!==_e)throw new Error("bad point: equation left != right (1)");const Ue=u(O*M),ee=u(B*W);if(Ue!==ee)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(_,L,O,M){this.ex=_,this.ey=L,this.ez=O,this.et=M,g("x",_),g("y",L),g("z",O),g("t",M),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(_){if(_ instanceof b)throw new Error("extended point not allowed");const{x:L,y:O}=_||{};return g("x",L),g("y",O),new b(L,O,ii,u(L*O))}static normalizeZ(_){const L=n.invertBatch(_.map(O=>O.ez));return _.map((O,M)=>O.toAffine(L[M])).map(b.fromAffine)}static msm(_,L){return Zce(b,h,_,L)}_setWindowSize(_){k.setWindowSize(this,_)}assertValidity(){w(this)}equals(_){y(_);const{ex:L,ey:O,ez:M}=this,{ex:B,ey:W,ez:Z}=_,ie=u(L*Z),ae=u(B*M),oe=u(O*Z),Ne=u(W*M);return ie===ae&&oe===Ne}is0(){return this.equals(b.ZERO)}negate(){return new b(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:_}=e,{ex:L,ey:O,ez:M}=this,B=u(L*L),W=u(O*O),Z=u(cv*u(M*M)),ie=u(_*B),ae=L+O,oe=u(u(ae*ae)-B-W),Ne=ie+W,de=Ne-Z,_e=ie-W,Ue=u(oe*de),ee=u(Ne*_e),q=u(oe*_e),ue=u(de*Ne);return new b(Ue,ee,ue,q)}add(_){y(_);const{a:L,d:O}=e,{ex:M,ey:B,ez:W,et:Z}=this,{ex:ie,ey:ae,ez:oe,et:Ne}=_;if(L===BigInt(-1)){const Tn=u((B-M)*(ae+ie)),nt=u((B+M)*(ae-ie)),mn=u(nt-Tn);if(mn===qo)return this.double();const Ve=u(W*cv*Ne),rt=u(Z*cv*oe),ht=rt+Ve,pt=nt+Tn,jn=rt-Ve,so=u(ht*mn),Gt=u(pt*jn),or=u(ht*jn),jc=u(mn*pt);return new b(so,Gt,jc,or)}const de=u(M*ie),_e=u(B*ae),Ue=u(Z*O*Ne),ee=u(W*oe),q=u((M+B)*(ie+ae)-de-_e),ue=ee-Ue,Ae=ee+Ue,tt=u(_e-L*de),me=u(q*ue),je=u(Ae*tt),pe=u(q*tt),ot=u(ue*Ae);return new b(me,je,ot,pe)}subtract(_){return this.add(_.negate())}wNAF(_){return k.wNAFCached(this,_,b.normalizeZ)}multiply(_){const L=_;j0("scalar",L,ii,r);const{p:O,f:M}=this.wNAF(L);return b.normalizeZ([O,M])[0]}multiplyUnsafe(_,L=b.ZERO){const O=_;return j0("scalar",O,qo,r),O===qo?E:this.is0()||O===ii?this:k.wNAFCachedUnsafe(this,O,b.normalizeZ,L)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return k.unsafeLadder(this,r).is0()}toAffine(_){return x(this,_)}clearCofactor(){const{h:_}=e;return _===ii?this:this.multiplyUnsafe(_)}static fromHex(_,L=!1){const{d:O,a:M}=e,B=n.BYTES;_=Uc("pointHex",_,B),WA("zip215",L);const W=_.slice(),Z=_[B-1];W[B-1]=Z&-129;const ie=d1(W),ae=L?d:n.ORDER;j0("pointHex.y",ie,qo,ae);const oe=u(ie*ie),Ne=u(oe-ii),de=u(O*oe-M);let{isValid:_e,value:Ue}=f(Ne,de);if(!_e)throw new Error("Point.fromHex: invalid y coordinate");const ee=(Ue&ii)===ii,q=(Z&128)!==0;if(!L&&Ue===qo&&q)throw new Error("Point.fromHex: x=0 and x_0=1");return q!==ee&&(Ue=u(-Ue)),b.fromAffine({x:Ue,y:ie})}static fromPrivateKey(_){return N(_).point}toRawBytes(){const{x:_,y:L}=this.toAffine(),O=QT(L,n.BYTES);return O[O.length-1]|=_&ii?128:0,O}toHex(){return ij(this.toRawBytes())}}b.BASE=new b(e.Gx,e.Gy,ii,u(e.Gx*e.Gy)),b.ZERO=new b(qo,ii,ii,qo);const{BASE:v,ZERO:E}=b,k=Jce(b,c*8);function C(T){return _r(T,r)}function S(T){return C(d1(T))}function N(T){const _=n.BYTES;T=Uc("private key",T,_);const L=Uc("hashed private key",i(T),2*_),O=p(L.slice(0,_)),M=L.slice(_,2*_),B=S(O),W=v.multiply(B),Z=W.toRawBytes();return{head:O,prefix:M,scalar:B,point:W,pointBytes:Z}}function I(T){return N(T).pointBytes}function F(T=new Uint8Array,..._){const L=x4(..._);return S(i(m(L,Uc("context",T),!!s)))}function P(T,_,L={}){T=Uc("message",T),s&&(T=s(T));const{prefix:O,scalar:M,pointBytes:B}=N(_),W=F(L.context,O,T),Z=v.multiply(W).toRawBytes(),ie=F(L.context,Z,B,T),ae=C(W+ie*M);j0("signature.s",ae,qo,r);const oe=x4(Z,QT(ae,n.BYTES));return Uc("result",oe,n.BYTES*2)}const H=tle;function z(T,_,L,O=H){const{context:M,zip215:B}=O,W=n.BYTES;T=Uc("signature",T,2*W),_=Uc("message",_),L=Uc("publicKey",L,W),B!==void 0&&WA("zip215",B),s&&(_=s(_));const Z=d1(T.slice(W,2*W));let ie,ae,oe;try{ie=b.fromHex(L,B),ae=b.fromHex(T.slice(0,W),B),oe=v.multiplyUnsafe(Z)}catch{return!1}if(!B&&ie.isSmallOrder())return!1;const Ne=F(M,ae.toRawBytes(),ie.toRawBytes(),_);return ae.add(ie.multiplyUnsafe(Ne)).subtract(oe).clearCofactor().equals(b.ZERO)}return v._setWindowSize(8),{CURVE:e,getPublicKey:I,sign:P,verify:z,ExtendedPoint:b,utils:{getExtendedPublicKey:N,randomPrivateKey:()=>o(n.BYTES),precompute(T=8,_=b.BASE){return _._setWindowSize(T),_.multiply(BigInt(3)),_}}}}BigInt(0),BigInt(1);const aj=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),A4=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const sle=BigInt(1),S4=BigInt(2);BigInt(3);const ile=BigInt(5),ole=BigInt(8);function ale(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=aj,o=t*t%i*t%i,c=Da(o,S4,i)*o%i,l=Da(c,sle,i)*t%i,d=Da(l,ile,i)*l%i,u=Da(d,e,i)*d%i,h=Da(u,n,i)*u%i,f=Da(h,r,i)*h%i,p=Da(f,s,i)*f%i,m=Da(p,s,i)*f%i,g=Da(m,e,i)*d%i;return{pow_p_5_8:Da(g,S4,i)*t%i,b2:o}}function cle(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function lle(t,e){const n=aj,r=_r(e*e*e,n),s=_r(r*r*e,n),i=ale(t*s).pow_p_5_8;let o=_r(t*r*i,n);const c=_r(e*o*o,n),l=o,d=_r(o*A4,n),u=c===t,h=c===_r(-t,n),f=c===_r(-t*A4,n);return u&&(o=l),(h||f)&&(o=d),Vce(o,n)&&(o=_r(-o,n)),{isValid:u||h,value:o}}const dle=BF(aj,void 0,!0),ule={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:dle,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:ole,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Rce,randomBytes:RF,adjustScalarBytes:cle,uvRatio:lle},zF=rle(ule),hle="EdDSA",fle="JWT",EE=".",nN="base64url",HF="utf8",VF="utf8",ple=":",mle="did",gle="key",T4="base58btc",yle="z",wle="K36",xle=32;function cj(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function WF(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?cj(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function qF(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=WF(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return cj(n)}function ble(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var c=t.length,l=t.charAt(0),d=Math.log(c)/Math.log(256),u=Math.log(256)/Math.log(c);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,y=0,x=0,w=m.length;x!==w&&m[x]===0;)x++,g++;for(var b=(w-x)*u+1>>>0,v=new Uint8Array(b);x!==w;){for(var E=m[x],k=0,C=b-1;(E!==0||k<y)&&C!==-1;C--,k++)E+=256*v[C]>>>0,v[C]=E%c>>>0,E=E/c>>>0;if(E!==0)throw new Error("Non-zero carry");y=k,x++}for(var S=b-y;S!==b&&v[S]===0;)S++;for(var N=l.repeat(g);S<b;++S)N+=t.charAt(v[S]);return N}function f(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var y=0,x=0;m[g]===l;)y++,g++;for(var w=(m.length-g)*d+1>>>0,b=new Uint8Array(w);m[g];){var v=n[m.charCodeAt(g)];if(v===255)return;for(var E=0,k=w-1;(v!==0||E<x)&&k!==-1;k--,E++)v+=c*b[k]>>>0,b[k]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");x=E,g++}if(m[g]!==" "){for(var C=w-x;C!==w&&b[C]===0;)C++;for(var S=new Uint8Array(y+(w-C)),N=y;C!==w;)S[N++]=b[C++];return S}}}function p(m){var g=f(m);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:p}}var vle=ble,Ele=vle;const KF=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Cle=t=>new TextEncoder().encode(t),Nle=t=>new TextDecoder().decode(t);let Ale=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Sle=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return GF(this,e)}},Tle=class{constructor(e){this.decoders=e}or(e){return GF(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const GF=(t,e)=>new Tle({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let _le=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new Ale(e,n,r),this.decoder=new Sle(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const rN=({name:t,prefix:e,encode:n,decode:r})=>new _le(t,e,n,r),sb=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=Ele(n,e);return rN({prefix:t,name:e,encode:r,decode:i=>KF(s(i))})},kle=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let c=0,l=0,d=0;for(let u=0;u<i;++u){const h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<n|h,c+=n,c>=8&&(c-=8,o[d++]=255&l>>c)}if(c>=n||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return o},Ile=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],o+=8;o>n;)o-=n,i+=e[s&c>>o];if(o&&(i+=e[s&c<<n-o]),r)for(;i.length*n&7;)i+="=";return i},us=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>rN({prefix:e,name:t,encode(s){return Ile(s,r,n)},decode(s){return kle(s,r,n,t)}}),jle=rN({prefix:"\0",name:"identity",encode:t=>Nle(t),decode:t=>Cle(t)});var Rle=Object.freeze({__proto__:null,identity:jle});const Ple=us({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ole=Object.freeze({__proto__:null,base2:Ple});const Dle=us({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ule=Object.freeze({__proto__:null,base8:Dle});const Mle=sb({prefix:"9",name:"base10",alphabet:"0123456789"});var Lle=Object.freeze({__proto__:null,base10:Mle});const Ble=us({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),$le=us({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Fle=Object.freeze({__proto__:null,base16:Ble,base16upper:$le});const zle=us({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hle=us({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vle=us({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Wle=us({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qle=us({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kle=us({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Gle=us({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Yle=us({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qle=us({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Jle=Object.freeze({__proto__:null,base32:zle,base32upper:Hle,base32pad:Vle,base32padupper:Wle,base32hex:qle,base32hexupper:Kle,base32hexpad:Gle,base32hexpadupper:Yle,base32z:Qle});const Zle=sb({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xle=sb({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ede=Object.freeze({__proto__:null,base36:Zle,base36upper:Xle});const tde=sb({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),nde=sb({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var rde=Object.freeze({__proto__:null,base58btc:tde,base58flickr:nde});const sde=us({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ide=us({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ode=us({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ade=us({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var cde=Object.freeze({__proto__:null,base64:sde,base64pad:ide,base64url:ode,base64urlpad:ade});const YF=Array.from(""),lde=YF.reduce((t,e,n)=>(t[n]=e,t),[]),dde=YF.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function ude(t){return t.reduce((e,n)=>(e+=lde[n],e),"")}function hde(t){const e=[];for(const n of t){const r=dde[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const fde=rN({prefix:"",name:"base256emoji",encode:ude,decode:hde});var pde=Object.freeze({__proto__:null,base256emoji:fde}),mde=QF,_4=128,gde=-128,yde=Math.pow(2,31);function QF(t,e,n){e=e||[],n=n||0;for(var r=n;t>=yde;)e[n++]=t&255|_4,t/=128;for(;t&gde;)e[n++]=t&255|_4,t>>>=7;return e[n]=t|0,QF.bytes=n-r+1,e}var wde=ZT,xde=128,k4=127;function ZT(t,r){var n=0,r=r||0,s=0,i=r,o,c=t.length;do{if(i>=c)throw ZT.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&k4)<<s:(o&k4)*Math.pow(2,s),s+=7}while(o>=xde);return ZT.bytes=i-r,n}var bde=Math.pow(2,7),vde=Math.pow(2,14),Ede=Math.pow(2,21),Cde=Math.pow(2,28),Nde=Math.pow(2,35),Ade=Math.pow(2,42),Sde=Math.pow(2,49),Tde=Math.pow(2,56),_de=Math.pow(2,63),kde=function(t){return t<bde?1:t<vde?2:t<Ede?3:t<Cde?4:t<Nde?5:t<Ade?6:t<Sde?7:t<Tde?8:t<_de?9:10},Ide={encode:mde,decode:wde,encodingLength:kde},JF=Ide;const I4=(t,e,n=0)=>(JF.encode(t,e,n),e),j4=t=>JF.encodingLength(t),XT=(t,e)=>{const n=e.byteLength,r=j4(t),s=r+j4(n),i=new Uint8Array(s+n);return I4(t,i,0),I4(n,i,r),i.set(e,s),new jde(t,n,e,i)};let jde=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const ZF=({name:t,code:e,encode:n})=>new Rde(t,e,n);let Rde=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?XT(this.code,n):n.then(r=>XT(this.code,r))}else throw Error("Unknown type, must be binary type")}};const XF=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Pde=ZF({name:"sha2-256",code:18,encode:XF("SHA-256")}),Ode=ZF({name:"sha2-512",code:19,encode:XF("SHA-512")});var Dde=Object.freeze({__proto__:null,sha256:Pde,sha512:Ode});const e9=0,Ude="identity",t9=KF,Mde=t=>XT(e9,t9(t)),Lde={code:e9,name:Ude,encode:t9,digest:Mde};var Bde=Object.freeze({__proto__:null,identity:Lde});new TextEncoder,new TextDecoder;const R4={...Rle,...Ole,...Ule,...Lle,...Fle,...Jle,...ede,...rde,...cde,...pde};({...Dde,...Bde});function n9(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const P4=n9("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),JA=n9("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=WF(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),r9={utf8:P4,"utf-8":P4,hex:R4.base16,latin1:JA,ascii:JA,binary:JA,...R4};function sN(t,e="utf8"){const n=r9[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function Kg(t,e="utf8"){const n=r9[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?cj(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function O4(t){return wf(sN(Kg(t,nN),HF))}function CE(t){return sN(Kg(jl(t),HF),nN)}function s9(t){const e=Kg(wle,T4),n=yle+sN(qF([e,t]),T4);return[mle,gle,n].join(ple)}function $de(t){return sN(t,nN)}function Fde(t){return Kg(t,nN)}function zde(t){return Kg([CE(t.header),CE(t.payload)].join(EE),VF)}function Hde(t){return[CE(t.header),CE(t.payload),$de(t.signature)].join(EE)}function e_(t){const e=t.split(EE),n=O4(e[0]),r=O4(e[1]),s=Fde(e[2]),i=Kg(e.slice(0,2).join(EE),VF);return{header:n,payload:r,signature:s,data:i}}function D4(t=RF(xle)){const e=zF.getPublicKey(t);return{secretKey:qF([t,e]),publicKey:e}}async function Vde(t,e,n,r,s=Re.fromMiliseconds(Date.now())){const i={alg:hle,typ:fle},o=s9(r.publicKey),c=s+n,l={iss:o,sub:t,aud:e,iat:s,exp:c},d=zde({header:i,payload:l}),u=zF.sign(d,r.secretKey.slice(0,32));return Hde({header:i,payload:l,signature:u})}var U4=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},Wde=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),qde=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Kde=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),Gde=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Yde=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Qde=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Jde=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,M4=3,Zde=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Qde]],L4=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Xde(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Yde:typeof navigator<"u"?tue(navigator.userAgent):rue()}function eue(t){return t!==""&&Zde.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function tue(t){var e=eue(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new Gde;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<M4&&(s=U4(U4([],s,!0),sue(M4-s.length),!0)):s=[];var i=s.join("."),o=nue(t),c=Jde.exec(t);return c&&c[1]?new Kde(n,i,o,c[1]):new Wde(n,i,o)}function nue(t){for(var e=0,n=L4.length;e<n;e++){var r=L4[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function rue(){var t=typeof process<"u"&&process.version;return t?new qde(process.version.slice(1)):null}function sue(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var kn={};Object.defineProperty(kn,"__esModule",{value:!0});kn.getLocalStorage=kn.getLocalStorageOrThrow=kn.getCrypto=kn.getCryptoOrThrow=i9=kn.getLocation=kn.getLocationOrThrow=lj=kn.getNavigator=kn.getNavigatorOrThrow=xf=kn.getDocument=kn.getDocumentOrThrow=kn.getFromWindowOrThrow=kn.getFromWindow=void 0;function Lf(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}kn.getFromWindow=Lf;function Gg(t){const e=Lf(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}kn.getFromWindowOrThrow=Gg;function iue(){return Gg("document")}kn.getDocumentOrThrow=iue;function oue(){return Lf("document")}var xf=kn.getDocument=oue;function aue(){return Gg("navigator")}kn.getNavigatorOrThrow=aue;function cue(){return Lf("navigator")}var lj=kn.getNavigator=cue;function lue(){return Gg("location")}kn.getLocationOrThrow=lue;function due(){return Lf("location")}var i9=kn.getLocation=due;function uue(){return Gg("crypto")}kn.getCryptoOrThrow=uue;function hue(){return Lf("crypto")}kn.getCrypto=hue;function fue(){return Gg("localStorage")}kn.getLocalStorageOrThrow=fue;function pue(){return Lf("localStorage")}kn.getLocalStorage=pue;var dj={};Object.defineProperty(dj,"__esModule",{value:!0});var o9=dj.getWindowMetadata=void 0;const B4=kn;function mue(){let t,e;try{t=B4.getDocumentOrThrow(),e=B4.getLocationOrThrow()}catch{return null}function n(){const h=t.getElementsByTagName("link"),f=[];for(let p=0;p<h.length;p++){const m=h[p],g=m.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const y=m.getAttribute("href");if(y)if(y.toLowerCase().indexOf("https:")===-1&&y.toLowerCase().indexOf("http:")===-1&&y.indexOf("//")!==0){let x=e.protocol+"//"+e.host;if(y.indexOf("/")===0)x+=y;else{const w=e.pathname.split("/");w.pop();const b=w.join("/");x+=b+"/"+y}f.push(x)}else if(y.indexOf("//")===0){const x=e.protocol+y;f.push(x)}else f.push(y)}}return f}function r(...h){const f=t.getElementsByTagName("meta");for(let p=0;p<f.length;p++){const m=f[p],g=["itemprop","property","name"].map(y=>m.getAttribute(y)).filter(y=>y?h.includes(y):!1);if(g.length&&g){const y=m.getAttribute("content");if(y)return y}}return""}function s(){let h=r("name","og:site_name","og:title","twitter:title");return h||(h=t.title),h}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),c=i(),l=e.origin,d=n();return{description:c,url:l,icons:d,name:o}}o9=dj.getWindowMetadata=mue;function Qw(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function t_(t){return Qw(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const a9="2.31.0";let R0={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${a9}`};class bf extends Error{constructor(e,n={}){var c;const r=(()=>{var l;return n.cause instanceof bf?n.cause.details:(l=n.cause)!=null&&l.message?n.cause.message:n.details})(),s=n.cause instanceof bf&&n.cause.docsPath||n.docsPath,i=(c=R0.getDocsUrl)==null?void 0:c.call(R0,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...R0.version?[`Version: ${R0.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=a9}walk(e){return c9(this,e)}}function c9(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?c9(t.cause,e):e?null:t}class l9 extends bf{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Yg(t,{dir:e,size:n=32}={}){return typeof t=="string"?gue(t,{dir:e,size:n}):yue(t,{dir:e,size:n})}function gue(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new l9({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function yue(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new l9({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}class wue extends bf{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class xue extends bf{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Qg(t,{size:e}){if(t_(t)>e)throw new xue({givenSize:t_(t),maxSize:e})}function n_(t,e={}){const{signed:n}=e;e.size&&Qg(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function bue(t,e={}){return Number(n_(t,e))}const vue=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function r_(t,e={}){return typeof t=="number"||typeof t=="bigint"?u9(t,e):typeof t=="string"?Nue(t,e):typeof t=="boolean"?Eue(t,e):d9(t,e)}function Eue(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Qg(n,{size:e.size}),Yg(n,{size:e.size})):n}function d9(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=vue[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Qg(r,{size:e.size}),Yg(r,{dir:"right",size:e.size})):r}function u9(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new wue({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Yg(c,{size:r}):c}const Cue=new TextEncoder;function Nue(t,e={}){const n=Cue.encode(t);return d9(n,e)}const Aue=new TextEncoder;function Sue(t,e={}){return typeof t=="number"||typeof t=="bigint"?_ue(t,e):typeof t=="boolean"?Tue(t,e):Qw(t)?h9(t,e):f9(t,e)}function Tue(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Qg(n,{size:e.size}),Yg(n,{size:e.size})):n}const Mc={zero:48,nine:57,A:65,F:70,a:97,f:102};function $4(t){if(t>=Mc.zero&&t<=Mc.nine)return t-Mc.zero;if(t>=Mc.A&&t<=Mc.F)return t-(Mc.A-10);if(t>=Mc.a&&t<=Mc.f)return t-(Mc.a-10)}function h9(t,e={}){let n=t;e.size&&(Qg(n,{size:e.size}),n=Yg(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,c=0;o<s;o++){const l=$4(r.charCodeAt(c++)),d=$4(r.charCodeAt(c++));if(l===void 0||d===void 0)throw new bf(`Invalid byte sequence ("${r[c-2]}${r[c-1]}" in "${r}").`);i[o]=l*16+d}return i}function _ue(t,e){const n=u9(t,e);return h9(n)}function f9(t,e={}){const n=Aue.encode(t);return typeof e.size=="number"?(Qg(n,{size:e.size}),Yg(n,{dir:"right",size:e.size})):n}const lv=BigInt(2**32-1),F4=BigInt(32);function kue(t,e=!1){return e?{h:Number(t&lv),l:Number(t>>F4&lv)}:{h:Number(t>>F4&lv)|0,l:Number(t&lv)|0}}function Iue(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:c}=kue(t[i],e);[r[i],s[i]]=[o,c]}return[r,s]}const jue=(t,e,n)=>t<<n|e>>>32-n,Rue=(t,e,n)=>e<<n|t>>>32-n,Pue=(t,e,n)=>e<<n-32|t>>>64-n,Oue=(t,e,n)=>t<<n-32|e>>>64-n,ep=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Due(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function NE(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Jw(t,...e){if(!Due(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function hRe(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");NE(t.outputLen),NE(t.blockLen)}function z4(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Uue(t,e){Jw(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Mue(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function p9(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function fRe(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function pRe(t,e){return t<<32-e|t>>>e}const Lue=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Bue(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function $ue(t){for(let e=0;e<t.length;e++)t[e]=Bue(t[e]);return t}const H4=Lue?t=>t:$ue;function Fue(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function m9(t){return typeof t=="string"&&(t=Fue(t)),Jw(t),t}function mRe(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Jw(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}class zue{}function Hue(t){const e=r=>t().update(m9(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function gRe(t=32){if(ep&&typeof ep.getRandomValues=="function")return ep.getRandomValues(new Uint8Array(t));if(ep&&typeof ep.randomBytes=="function")return Uint8Array.from(ep.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const Vue=BigInt(0),P0=BigInt(1),Wue=BigInt(2),que=BigInt(7),Kue=BigInt(256),Gue=BigInt(113),g9=[],y9=[],w9=[];for(let t=0,e=P0,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],g9.push(2*(5*r+n)),y9.push((t+1)*(t+2)/2%64);let s=Vue;for(let i=0;i<7;i++)e=(e<<P0^(e>>que)*Gue)%Kue,e&Wue&&(s^=P0<<(P0<<BigInt(i))-P0);w9.push(s)}const x9=Iue(w9,!0),Yue=x9[0],Que=x9[1],V4=(t,e,n)=>n>32?Pue(t,e,n):jue(t,e,n),W4=(t,e,n)=>n>32?Oue(t,e,n):Rue(t,e,n);function Jue(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,l=(o+2)%10,d=n[l],u=n[l+1],h=V4(d,u,1)^n[c],f=W4(d,u,1)^n[c+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const c=y9[o],l=V4(s,i,c),d=W4(s,i,c),u=g9[o];s=t[u],i=t[u+1],t[u]=l,t[u+1]=d}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)n[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~n[(c+2)%10]&n[(c+4)%10]}t[0]^=Yue[r],t[1]^=Que[r]}p9(n)}class uj extends zue{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,NE(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Mue(this.state)}clone(){return this._cloneInto()}keccak(){H4(this.state32),Jue(this.state32,this.rounds),H4(this.state32),this.posOut=0,this.pos=0}update(e){z4(this),e=m9(e),Jw(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let c=0;c<o;c++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){z4(this,!1),Jw(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return NE(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Uue(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,p9(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new uj(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Zue=(t,e,n)=>Hue(()=>new uj(e,t,n)),Xue=Zue(1,136,256/8);function b9(t,e){const n=e||"hex",r=Xue(Qw(t,{strict:!1})?Sue(t):t);return n==="bytes"?r:r_(r)}class ehe extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const ZA=new ehe(8192);function the(t,e){if(ZA.has(`${t}.${e}`))return ZA.get(`${t}.${e}`);const n=t.substring(2).toLowerCase(),r=b9(f9(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return ZA.set(`${t}.${e}`,i),i}function nhe(t){const e=b9(`0x${t.substring(4)}`).substring(26);return the(`0x${e}`)}async function rhe({hash:t,signature:e}){const n=Qw(t)?t:r_(t),{secp256k1:r}=await $n(async()=>{const{secp256k1:o}=await import("./secp256k1-VBVllK36.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:d,s:u,v:h,yParity:f}=e,p=Number(f??h),m=q4(p);return new r.Signature(n_(d),n_(u)).addRecoveryBit(m)}const o=Qw(e)?e:r_(e);if(t_(o)!==65)throw new Error("invalid signature length");const c=bue(`0x${o.slice(130)}`),l=q4(c);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(l)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function q4(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function she({hash:t,signature:e}){return nhe(await rhe({hash:t,signature:e}))}function ihe(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let d=0;d<e.length;d++)e[d]=255;for(let d=0;d<t.length;d++){const u=t.charAt(d),h=u.charCodeAt(0);if(e[h]!==255)throw new TypeError(u+" is ambiguous");e[h]=d}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";let u=0,h=0,f=0;const p=d.length;for(;f!==p&&d[f]===0;)f++,u++;const m=(p-f)*i+1>>>0,g=new Uint8Array(m);for(;f!==p;){let w=d[f],b=0;for(let v=m-1;(w!==0||b<h)&&v!==-1;v--,b++)w+=256*g[v]>>>0,g[v]=w%n>>>0,w=w/n>>>0;if(w!==0)throw new Error("Non-zero carry");h=b,f++}let y=m-h;for(;y!==m&&g[y]===0;)y++;let x=r.repeat(u);for(;y<m;++y)x+=t.charAt(g[y]);return x}function c(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;let u=0,h=0,f=0;for(;d[u]===r;)h++,u++;const p=(d.length-u)*s+1>>>0,m=new Uint8Array(p);for(;u<d.length;){const w=d.charCodeAt(u);if(w>255)return;let b=e[w];if(b===255)return;let v=0;for(let E=p-1;(b!==0||v<f)&&E!==-1;E--,v++)b+=n*m[E]>>>0,m[E]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");f=v,u++}let g=p-f;for(;g!==p&&m[g]===0;)g++;const y=new Uint8Array(h+(p-g));let x=h;for(;g!==p;)y[x++]=m[g++];return y}function l(d){const u=c(d);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:c,decode:l}}var ohe="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Jg=ihe(ohe);function ahe(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?n+=4:n+=3}else{n++;continue}}return n}function che(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const c=t.charCodeAt(i);(c&64512)===56320&&(++i,o=((o&1023)<<10)+(c&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const lhe=new TextEncoder,dhe=50;function uhe(t,e,n){lhe.encodeInto(t,e.subarray(n))}function hhe(t,e,n){t.length>dhe?uhe(t,e,n):che(t,e,n)}const fhe=4096;function v9(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const c=t[r++];if(!(c&128))i.push(c);else if((c&224)===192){const l=t[r++]&63;i.push((c&31)<<6|l)}else if((c&240)===224){const l=t[r++]&63,d=t[r++]&63;i.push((c&31)<<12|l<<6|d)}else if((c&248)===240){const l=t[r++]&63,d=t[r++]&63,u=t[r++]&63;let h=(c&7)<<18|l<<12|d<<6|u;h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|h&1023),i.push(h)}else i.push(c);i.length>=fhe&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const phe=new TextDecoder,mhe=200;function ghe(t,e,n){const r=t.subarray(e,e+n);return phe.decode(r)}function yhe(t,e,n){return n>mhe?ghe(t,e,n):v9(t,e,n)}class dv{constructor(e,n){this.type=e,this.data=n}}class Hi extends Error{constructor(e){super(e);const n=Object.create(Hi.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Hi.name})}}const O0=4294967295;function whe(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function E9(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function C9(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function xhe(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const bhe=-1,vhe=4294967296-1,Ehe=17179869184-1;function Che({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=Ehe)if(e===0&&t<=vhe){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),E9(r,4,t),n}}function Nhe(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function Ahe(t){if(t instanceof Date){const e=Nhe(t);return Che(e)}else return null}function She(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=C9(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new Hi(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function The(t){const e=She(t);return new Date(e.sec*1e3+e.nsec/1e6)}const _he={type:bhe,encode:Ahe,decode:The};class AE{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(_he)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new dv(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new dv(o,i)}}}return e instanceof dv?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new dv(n,e)}}AE.defaultCodec=new AE;function khe(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function s_(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):khe(t)?new Uint8Array(t):Uint8Array.from(t)}const Ihe=100,jhe=2048;let Rhe=class N9{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??AE.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??Ihe,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??jhe,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new N9({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=ahe(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),hhe(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=s_(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),whe(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),E9(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function Phe(t,e){return new Rhe(e).encodeSharedRef(t)}function XA(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const Ohe=16,Dhe=16;class Uhe{constructor(e=Ohe,n=Dhe){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let c=0;c<r;c++)if(o[c]!==e[n+c])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=v9(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const i_="array",Ay="map_key",A9="map_value",Mhe=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Hi("The type of key must be string or number but "+typeof t)};class Lhe{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=i_,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Ay,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===i_){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===Ay||e.type===A9){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const D0=-1,hj=new DataView(new ArrayBuffer(0)),Bhe=new Uint8Array(hj.buffer);try{hj.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const K4=new RangeError("Insufficient data"),$he=new Uhe;let Fhe=class S9{constructor(e){this.totalPos=0,this.pos=0,this.view=hj,this.bytes=Bhe,this.headByte=D0,this.stack=new Lhe,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??AE.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??O0,this.maxBinLength=(e==null?void 0:e.maxBinLength)??O0,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??O0,this.maxMapLength=(e==null?void 0:e.maxMapLength)??O0,this.maxExtLength=(e==null?void 0:e.maxExtLength)??O0,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:$he,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??Mhe}clone(){return new S9({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=D0,this.stack.reset()}setBuffer(e){const n=s_(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===D0&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=s_(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const c of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(c);try{r=this.doDecodeSync(),n=!0}catch(l){if(!(l instanceof RangeError))throw l}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${XA(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new Hi(`Unrecognized type byte: ${XA(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===i_)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===Ay){if(n==="__proto__")throw new Hi("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=A9;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=Ay;continue e}}return n}}readHeadByte(){return this.headByte===D0&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=D0}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Hi(`Unrecognized array type byte: ${XA(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Hi(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Hi(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){var i;if(e>this.maxStrLength)throw new Hi(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw K4;const r=this.pos+n;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,r,e):s=yhe(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Ay:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new Hi(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw K4;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new Hi(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=xhe(this.view,this.pos);return this.pos+=8,e}readI64(){const e=C9(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function zhe(t,e){return new Fhe(e).decode(t)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Hhe(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function T9(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(n=>typeof n=="string"):e.every(n=>Number.isSafeInteger(n)):!1}function SE(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function fj(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function o_(t){if(!Array.isArray(t))throw new Error("array expected")}function TE(t,e){if(!T9(!0,e))throw new Error(`${t}: array of strings expected`)}function Vhe(t,e){if(!T9(!1,e))throw new Error(`${t}: array of numbers expected`)}function Whe(...t){const e=i=>i,n=(i,o)=>c=>i(o(c)),r=t.map(i=>i.encode).reduceRight(n,e),s=t.map(i=>i.decode).reduce(n,e);return{encode:r,decode:s}}function qhe(t){const e=typeof t=="string"?t.split(""):t,n=e.length;TE("alphabet",e);const r=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(o_(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:s=>(o_(s),s.map(i=>{SE("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return o}))}}function Khe(t=""){return SE("join",t),{encode:e=>(TE("join.decode",e),e.join(t)),decode:e=>(SE("join.decode",e),e.split(t))}}function Ghe(t,e="="){return fj(t),SE("padding",e),{encode(n){for(TE("padding.encode",n);n.length*t%8;)n.push(e);return n},decode(n){TE("padding.decode",n);let r=n.length;if(r*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if((r-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const _9=(t,e)=>e===0?t:_9(e,t%e),_E=(t,e)=>t+(e-_9(t,e)),eS=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function G4(t,e,n,r){if(o_(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(_E(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${_E(e,n)}`);let s=0,i=0;const o=eS[e],c=eS[n]-1,l=[];for(const d of t){if(fj(d),d>=o)throw new Error(`convertRadix2: invalid data word=${d} from=${e}`);if(s=s<<e|d,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)l.push((s>>i-n&c)>>>0);const u=eS[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&c,!r&&i>=e)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&l.push(s>>>0),l}function Yhe(t,e=!1){if(fj(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(_E(8,t)>32||_E(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Hhe(n))throw new Error("radix2.encode input should be Uint8Array");return G4(Array.from(n),8,t,!e)},decode:n=>(Vhe("radix2.decode",n),Uint8Array.from(G4(n,t,8,e)))}}const Qhe=Whe(Yhe(5),qhe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Ghe(5),Khe(""));function pj(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function k9(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?pj(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Sy(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=k9(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return pj(n)}function Jhe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var c=t.length,l=t.charAt(0),d=Math.log(c)/Math.log(256),u=Math.log(256)/Math.log(c);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,y=0,x=0,w=m.length;x!==w&&m[x]===0;)x++,g++;for(var b=(w-x)*u+1>>>0,v=new Uint8Array(b);x!==w;){for(var E=m[x],k=0,C=b-1;(E!==0||k<y)&&C!==-1;C--,k++)E+=256*v[C]>>>0,v[C]=E%c>>>0,E=E/c>>>0;if(E!==0)throw new Error("Non-zero carry");y=k,x++}for(var S=b-y;S!==b&&v[S]===0;)S++;for(var N=l.repeat(g);S<b;++S)N+=t.charAt(v[S]);return N}function f(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var y=0,x=0;m[g]===l;)y++,g++;for(var w=(m.length-g)*d+1>>>0,b=new Uint8Array(w);m[g];){var v=n[m.charCodeAt(g)];if(v===255)return;for(var E=0,k=w-1;(v!==0||E<x)&&k!==-1;k--,E++)v+=c*b[k]>>>0,b[k]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");x=E,g++}if(m[g]!==" "){for(var C=w-x;C!==w&&b[C]===0;)C++;for(var S=new Uint8Array(y+(w-C)),N=y;C!==w;)S[N++]=b[C++];return S}}}function p(m){var g=f(m);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:p}}var Zhe=Jhe,Xhe=Zhe;const efe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},tfe=t=>new TextEncoder().encode(t),nfe=t=>new TextDecoder().decode(t);class rfe{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class sfe{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return I9(this,e)}}class ife{constructor(e){this.decoders=e}or(e){return I9(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const I9=(t,e)=>new ife({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class ofe{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new rfe(e,n,r),this.decoder=new sfe(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const iN=({name:t,prefix:e,encode:n,decode:r})=>new ofe(t,e,n,r),ib=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=Xhe(n,e);return iN({prefix:t,name:e,encode:r,decode:i=>efe(s(i))})},afe=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let c=0,l=0,d=0;for(let u=0;u<i;++u){const h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<n|h,c+=n,c>=8&&(c-=8,o[d++]=255&l>>c)}if(c>=n||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return o},cfe=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],o+=8;o>n;)o-=n,i+=e[s&c>>o];if(o&&(i+=e[s&c<<n-o]),r)for(;i.length*n&7;)i+="=";return i},hs=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>iN({prefix:e,name:t,encode(s){return cfe(s,r,n)},decode(s){return afe(s,r,n,t)}}),lfe=iN({prefix:"\0",name:"identity",encode:t=>nfe(t),decode:t=>tfe(t)}),dfe=Object.freeze(Object.defineProperty({__proto__:null,identity:lfe},Symbol.toStringTag,{value:"Module"})),ufe=hs({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),hfe=Object.freeze(Object.defineProperty({__proto__:null,base2:ufe},Symbol.toStringTag,{value:"Module"})),ffe=hs({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),pfe=Object.freeze(Object.defineProperty({__proto__:null,base8:ffe},Symbol.toStringTag,{value:"Module"})),mfe=ib({prefix:"9",name:"base10",alphabet:"0123456789"}),gfe=Object.freeze(Object.defineProperty({__proto__:null,base10:mfe},Symbol.toStringTag,{value:"Module"})),yfe=hs({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wfe=hs({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),xfe=Object.freeze(Object.defineProperty({__proto__:null,base16:yfe,base16upper:wfe},Symbol.toStringTag,{value:"Module"})),bfe=hs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),vfe=hs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Efe=hs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Cfe=hs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Nfe=hs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Afe=hs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Sfe=hs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tfe=hs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_fe=hs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),kfe=Object.freeze(Object.defineProperty({__proto__:null,base32:bfe,base32hex:Nfe,base32hexpad:Sfe,base32hexpadupper:Tfe,base32hexupper:Afe,base32pad:Efe,base32padupper:Cfe,base32upper:vfe,base32z:_fe},Symbol.toStringTag,{value:"Module"})),Ife=ib({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jfe=ib({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Rfe=Object.freeze(Object.defineProperty({__proto__:null,base36:Ife,base36upper:jfe},Symbol.toStringTag,{value:"Module"})),Pfe=ib({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ofe=ib({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Dfe=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Pfe,base58flickr:Ofe},Symbol.toStringTag,{value:"Module"})),Ufe=hs({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Mfe=hs({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lfe=hs({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Bfe=hs({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),$fe=Object.freeze(Object.defineProperty({__proto__:null,base64:Ufe,base64pad:Mfe,base64url:Lfe,base64urlpad:Bfe},Symbol.toStringTag,{value:"Module"})),j9=Array.from(""),Ffe=j9.reduce((t,e,n)=>(t[n]=e,t),[]),zfe=j9.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Hfe(t){return t.reduce((e,n)=>(e+=Ffe[n],e),"")}function Vfe(t){const e=[];for(const n of t){const r=zfe[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const Wfe=iN({prefix:"",name:"base256emoji",encode:Hfe,decode:Vfe}),qfe=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Wfe},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Y4={...dfe,...hfe,...pfe,...gfe,...xfe,...kfe,...Rfe,...Dfe,...$fe,...qfe};function R9(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Q4=R9("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),tS=R9("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=k9(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),P9={utf8:Q4,"utf-8":Q4,hex:Y4.base16,latin1:tS,ascii:tS,binary:tS,...Y4};function jo(t,e="utf8"){const n=P9[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?pj(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function _i(t,e="utf8"){const n=P9[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const Kfe={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},Gfe="Input must be an string, Buffer or Uint8Array";function Yfe(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(Gfe);return e}function Qfe(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function uv(t){return(4294967296+t).toString(16).substring(1)}function Jfe(t,e,n){let r=`
`+t+" = ";for(let s=0;s<e.length;s+=2){if(n===32)r+=uv(e[s]).toUpperCase(),r+=" ",r+=uv(e[s+1]).toUpperCase();else if(n===64)r+=uv(e[s+1]).toUpperCase(),r+=uv(e[s]).toUpperCase();else throw new Error("Invalid size "+n);s%6===4?r+=`
`+new Array(t.length+4).join(" "):s<e.length-2&&(r+=" ")}console.log(r)}function Zfe(t,e,n){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;const i=new Date().getTime();console.log("Generated random input in "+(i-r)+"ms"),r=i;for(let o=0;o<n;o++){const c=t(s),l=new Date().getTime(),d=l-r;r=l,console.log("Hashed in "+d+"ms: "+c.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(d/1e3)*100)/100+" MB PER SECOND")}}var O9={normalizeInput:Yfe,toHex:Qfe,debugPrint:Jfe,testSpeed:Zfe};const u1=O9;function hv(t,e,n){const r=t[e]+t[n];let s=t[e+1]+t[n+1];r>=4294967296&&s++,t[e]=r,t[e+1]=s}function J4(t,e,n,r){let s=t[e]+n;n<0&&(s+=4294967296);let i=t[e+1]+r;s>=4294967296&&i++,t[e]=s,t[e+1]=i}function D9(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Gl(t,e,n,r,s,i){const o=ay[s],c=ay[s+1],l=ay[i],d=ay[i+1];hv(Nt,t,e),J4(Nt,t,o,c);let u=Nt[r]^Nt[t],h=Nt[r+1]^Nt[t+1];Nt[r]=h,Nt[r+1]=u,hv(Nt,n,r),u=Nt[e]^Nt[n],h=Nt[e+1]^Nt[n+1],Nt[e]=u>>>24^h<<8,Nt[e+1]=h>>>24^u<<8,hv(Nt,t,e),J4(Nt,t,l,d),u=Nt[r]^Nt[t],h=Nt[r+1]^Nt[t+1],Nt[r]=u>>>16^h<<16,Nt[r+1]=h>>>16^u<<16,hv(Nt,n,r),u=Nt[e]^Nt[n],h=Nt[e+1]^Nt[n+1],Nt[e]=h>>>31^u<<1,Nt[e+1]=u>>>31^h<<1}const U9=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Xfe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],ys=new Uint8Array(Xfe.map(function(t){return t*2})),Nt=new Uint32Array(32),ay=new Uint32Array(32);function M9(t,e){let n=0;for(n=0;n<16;n++)Nt[n]=t.h[n],Nt[n+16]=U9[n];for(Nt[24]=Nt[24]^t.t,Nt[25]=Nt[25]^t.t/4294967296,e&&(Nt[28]=~Nt[28],Nt[29]=~Nt[29]),n=0;n<32;n++)ay[n]=D9(t.b,4*n);for(n=0;n<12;n++)Gl(0,8,16,24,ys[n*16+0],ys[n*16+1]),Gl(2,10,18,26,ys[n*16+2],ys[n*16+3]),Gl(4,12,20,28,ys[n*16+4],ys[n*16+5]),Gl(6,14,22,30,ys[n*16+6],ys[n*16+7]),Gl(0,10,20,30,ys[n*16+8],ys[n*16+9]),Gl(2,12,22,24,ys[n*16+10],ys[n*16+11]),Gl(4,14,16,26,ys[n*16+12],ys[n*16+13]),Gl(6,8,18,28,ys[n*16+14],ys[n*16+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^Nt[n]^Nt[n+16]}const Yl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function L9(t,e,n,r){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(n&&n.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};Yl.fill(0),Yl[0]=t,e&&(Yl[1]=e.length),Yl[2]=1,Yl[3]=1,n&&Yl.set(n,32),r&&Yl.set(r,48);for(let i=0;i<16;i++)s.h[i]=U9[i]^D9(Yl,i*4);return e&&(mj(s,e),s.c=128),s}function mj(t,e){for(let n=0;n<e.length;n++)t.c===128&&(t.t+=t.c,M9(t,!1),t.c=0),t.b[t.c++]=e[n]}function B9(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;M9(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3);return e}function $9(t,e,n,r,s){n=n||64,t=u1.normalizeInput(t),r&&(r=u1.normalizeInput(r)),s&&(s=u1.normalizeInput(s));const i=L9(n,e,r,s);return mj(i,t),B9(i)}function epe(t,e,n,r,s){const i=$9(t,e,n,r,s);return u1.toHex(i)}var tpe={blake2b:$9,blake2bHex:epe,blake2bInit:L9,blake2bUpdate:mj,blake2bFinal:B9};const F9=O9;function npe(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Ql(t,e,n,r,s,i){an[t]=an[t]+an[e]+s,an[r]=fv(an[r]^an[t],16),an[n]=an[n]+an[r],an[e]=fv(an[e]^an[n],12),an[t]=an[t]+an[e]+i,an[r]=fv(an[r]^an[t],8),an[n]=an[n]+an[r],an[e]=fv(an[e]^an[n],7)}function fv(t,e){return t>>>e^t<<32-e}const z9=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ws=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),an=new Uint32Array(16),Kr=new Uint32Array(16);function H9(t,e){let n=0;for(n=0;n<8;n++)an[n]=t.h[n],an[n+8]=z9[n];for(an[12]^=t.t,an[13]^=t.t/4294967296,e&&(an[14]=~an[14]),n=0;n<16;n++)Kr[n]=npe(t.b,4*n);for(n=0;n<10;n++)Ql(0,4,8,12,Kr[ws[n*16+0]],Kr[ws[n*16+1]]),Ql(1,5,9,13,Kr[ws[n*16+2]],Kr[ws[n*16+3]]),Ql(2,6,10,14,Kr[ws[n*16+4]],Kr[ws[n*16+5]]),Ql(3,7,11,15,Kr[ws[n*16+6]],Kr[ws[n*16+7]]),Ql(0,5,10,15,Kr[ws[n*16+8]],Kr[ws[n*16+9]]),Ql(1,6,11,12,Kr[ws[n*16+10]],Kr[ws[n*16+11]]),Ql(2,7,8,13,Kr[ws[n*16+12]],Kr[ws[n*16+13]]),Ql(3,4,9,14,Kr[ws[n*16+14]],Kr[ws[n*16+15]]);for(n=0;n<8;n++)t.h[n]^=an[n]^an[n+8]}function V9(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array(z9),b:new Uint8Array(64),c:0,t:0,outlen:t};return r.h[0]^=16842752^n<<8^t,n>0&&(gj(r,e),r.c=64),r}function gj(t,e){for(let n=0;n<e.length;n++)t.c===64&&(t.t+=t.c,H9(t,!1),t.c=0),t.b[t.c++]=e[n]}function W9(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;H9(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3)&255;return e}function q9(t,e,n){n=n||32,t=F9.normalizeInput(t);const r=V9(n,e);return gj(r,t),W9(r)}function rpe(t,e,n){const r=q9(t,e,n);return F9.toHex(r)}var spe={blake2s:q9,blake2sHex:rpe,blake2sInit:V9,blake2sUpdate:gj,blake2sFinal:W9};const U0=tpe,M0=spe;var ipe={blake2b:U0.blake2b,blake2bHex:U0.blake2bHex,blake2bInit:U0.blake2bInit,blake2bUpdate:U0.blake2bUpdate,blake2bFinal:U0.blake2bFinal,blake2s:M0.blake2s,blake2sHex:M0.blake2sHex,blake2sInit:M0.blake2sInit,blake2sUpdate:M0.blake2sUpdate,blake2sFinal:M0.blake2sFinal},ope={};const ape=":";function Jh(t){const[e,n]=t.split(ape);return{namespace:e,reference:n}}function K9(t,e){return t.includes(":")?[t]:e.chains||[]}var cpe=Object.defineProperty,lpe=Object.defineProperties,dpe=Object.getOwnPropertyDescriptors,Z4=Object.getOwnPropertySymbols,upe=Object.prototype.hasOwnProperty,hpe=Object.prototype.propertyIsEnumerable,a_=(t,e,n)=>e in t?cpe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X4=(t,e)=>{for(var n in e||(e={}))upe.call(e,n)&&a_(t,n,e[n]);if(Z4)for(var n of Z4(e))hpe.call(e,n)&&a_(t,n,e[n]);return t},fpe=(t,e)=>lpe(t,dpe(e)),eD=(t,e,n)=>a_(t,typeof e!="symbol"?e+"":e,n);const ppe="ReactNative",Yi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},mpe="js";function kE(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Nu(){return!xf()&&!!lj()&&navigator.product===ppe}function gpe(){return Nu()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function ype(){return Nu()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Zg(){return!kE()&&!!lj()&&!!xf()}function ob(){return Nu()?Yi.reactNative:kE()?Yi.node:Zg()?Yi.browser:Yi.unknown}function tD(){var t;try{return Nu()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function wpe(t,e){const n=new URLSearchParams(t);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const s=e[r];s!==void 0&&n.set(r,s)}return n.toString()}function xpe(t){var e,n;const r=G9();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),fpe(X4(X4({},r),t),{url:(t==null?void 0:t.url)||r.url,name:(t==null?void 0:t.name)||r.name,description:(t==null?void 0:t.description)||r.description,icons:(n=t==null?void 0:t.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function G9(){return o9()||{name:"",description:"",url:"",icons:[""]}}function bpe(){if(ob()===Yi.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const t=Xde();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function vpe(){var t;const e=ob();return e===Yi.browser?[e,((t=i9())==null?void 0:t.host)||"unknown"].join(":"):e}function Y9(t,e,n){const r=bpe(),s=vpe();return[[t,e].join("-"),[mpe,n].join("-"),r,s].join("/")}function Epe({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:c,packageName:l}){const d=n.split("?"),u=Y9(t,e,r),h={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:l||void 0,bundleId:c||void 0},f=wpe(d[1]||"",h);return d[0]+"?"+f}function gh(t,e){return t.filter(n=>e.includes(n)).length===t.length}function c_(t){return Object.fromEntries(t.entries())}function l_(t){return new Map(Object.entries(t))}function Vu(t=Re.FIVE_MINUTES,e){const n=Re.toMiliseconds(t||Re.FIVE_MINUTES);let r,s,i,o;return{resolve:c=>{i&&r&&(clearTimeout(i),r(c),o=Promise.resolve(c))},reject:c=>{i&&s&&(clearTimeout(i),s(c))},done:()=>new Promise((c,l)=>{if(o)return c(o);i=setTimeout(()=>{const d=new Error(e);o=Promise.reject(d),l(d)},n),r=c,s=l})}}function dc(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function Q9(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Cpe(t){return Q9("topic",t)}function Npe(t){return Q9("id",t)}function J9(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function Ar(t,e){return Re.fromMiliseconds(Date.now()+Re.toMiliseconds(t))}function dd(t){return Date.now()>=Re.toMiliseconds(t)}function fn(t,e){return`${t}${e?`:${e}`:""}`}function xc(t=[],e=[]){return[...new Set([...t,...e])]}async function Ape({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=Spe(i,t,e),c=ob();if(c===Yi.browser){if(!((r=xf())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}Tpe(o)}else c===Yi.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function Spe(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${jpe(r,!0)}`}else s=`${s}/wc?${r}`;return s}function Tpe(t){let e="_self";Ipe()?e="_top":(kpe()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function _pe(t,e){let n="";try{if(Zg()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function nD(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function rD(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function yj(){return typeof process<"u"&&ope.IS_VITEST==="true"}function kpe(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function Ipe(){try{return window.self!==window.top}catch{return!1}}function jpe(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function Z9(t){return Buffer.from(t,"base64").toString("utf-8")}function Rpe(t){return new Promise(e=>setTimeout(e,t))}let Ppe=class{constructor({limit:e}){eD(this,"limit"),eD(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const pv=BigInt(2**32-1),sD=BigInt(32);function X9(t,e=!1){return e?{h:Number(t&pv),l:Number(t>>sD&pv)}:{h:Number(t>>sD&pv)|0,l:Number(t&pv)|0}}function e7(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:c}=X9(t[i],e);[r[i],s[i]]=[o,c]}return[r,s]}const iD=(t,e,n)=>t>>>n,oD=(t,e,n)=>t<<32-n|e>>>n,ud=(t,e,n)=>t>>>n|e<<32-n,hd=(t,e,n)=>t<<32-n|e>>>n,cy=(t,e,n)=>t<<64-n|e>>>n-32,ly=(t,e,n)=>t>>>n-32|e<<64-n,Ope=(t,e)=>e,Dpe=(t,e)=>t,Upe=(t,e,n)=>t<<n|e>>>32-n,Mpe=(t,e,n)=>e<<n|t>>>32-n,Lpe=(t,e,n)=>e<<n-32|t>>>64-n,Bpe=(t,e,n)=>t<<n-32|e>>>64-n;function Qo(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const wj=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),xj=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,$pe=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),Fpe=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,zpe=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),Hpe=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,tp=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function bj(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Rl(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Lo(t,...e){if(!bj(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function vj(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Rl(t.outputLen),Rl(t.blockLen)}function lu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ej(t,e){Lo(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Zw(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Bo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function nS(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ua(t,e){return t<<32-e|t>>>e}const t7=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function n7(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const zc=t7?t=>t:t=>n7(t);function Vpe(t){for(let e=0;e<t.length;e++)t[e]=n7(t[e]);return t}const fd=t7?t=>t:Vpe,r7=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Wpe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Xw(t){if(Lo(t),r7)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=Wpe[t[n]];return e}const Lc={_0:48,_9:57,A:65,F:70,a:97,f:102};function aD(t){if(t>=Lc._0&&t<=Lc._9)return t-Lc._0;if(t>=Lc.A&&t<=Lc.F)return t-(Lc.A-10);if(t>=Lc.a&&t<=Lc.f)return t-(Lc.a-10)}function Cj(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(r7)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=aD(t.charCodeAt(i)),c=aD(t.charCodeAt(i+1));if(o===void 0||c===void 0){const l=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}r[s]=o*16+c}return r}function qpe(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ba(t){return typeof t=="string"&&(t=qpe(t)),Lo(t),t}function yh(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Lo(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let oN=class{};function ab(t){const e=r=>t().update(ba(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Kpe(t){const e=(r,s)=>t(s).update(ba(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function Xg(t=32){if(tp&&typeof tp.getRandomValues=="function")return tp.getRandomValues(new Uint8Array(t));if(tp&&typeof tp.randomBytes=="function")return Uint8Array.from(tp.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const Gpe=BigInt(0),L0=BigInt(1),Ype=BigInt(2),Qpe=BigInt(7),Jpe=BigInt(256),Zpe=BigInt(113),s7=[],i7=[],o7=[];for(let t=0,e=L0,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],s7.push(2*(5*r+n)),i7.push((t+1)*(t+2)/2%64);let s=Gpe;for(let i=0;i<7;i++)e=(e<<L0^(e>>Qpe)*Zpe)%Jpe,e&Ype&&(s^=L0<<(L0<<BigInt(i))-L0);o7.push(s)}const a7=e7(o7,!0),Xpe=a7[0],eme=a7[1],cD=(t,e,n)=>n>32?Lpe(t,e,n):Upe(t,e,n),lD=(t,e,n)=>n>32?Bpe(t,e,n):Mpe(t,e,n);function tme(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,l=(o+2)%10,d=n[l],u=n[l+1],h=cD(d,u,1)^n[c],f=lD(d,u,1)^n[c+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const c=i7[o],l=cD(s,i,c),d=lD(s,i,c),u=s7[o];s=t[u],i=t[u+1],t[u]=l,t[u+1]=d}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)n[c]=t[o+c];for(let c=0;c<10;c++)t[o+c]^=~n[(c+2)%10]&n[(c+4)%10]}t[0]^=Xpe[r],t[1]^=eme[r]}Bo(n)}let nme=class c7 extends oN{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Rl(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Zw(this.state)}clone(){return this._cloneInto()}keccak(){fd(this.state32),tme(this.state32,this.rounds),fd(this.state32),this.posOut=0,this.pos=0}update(e){lu(this),e=ba(e),Lo(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let c=0;c<o;c++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){lu(this,!1),Lo(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Rl(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Ej(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Bo(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new c7(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const rme=(t,e,n)=>ab(()=>new nme(e,t,n)),sme=rme(1,136,256/8);function ime(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),c=Number(n&i),l=r?4:0,d=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+d,c,r)}function ome(t,e,n){return t&e^~t&n}function ame(t,e,n){return t&e^t&n^e&n}let l7=class extends oN{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=nS(this.buffer)}update(e){lu(this),e=ba(e),Lo(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const c=Math.min(s-this.pos,i-o);if(c===s){const l=nS(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){lu(this),Ej(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Bo(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;ime(r,s-8,BigInt(this.length*8),i),this.process(r,0);const c=nS(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)c.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:c}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=c,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Jl=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),xs=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),bs=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),cme=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zl=new Uint32Array(64);let lme=class extends l7{constructor(e=32){super(64,e,8,!1),this.A=Jl[0]|0,this.B=Jl[1]|0,this.C=Jl[2]|0,this.D=Jl[3]|0,this.E=Jl[4]|0,this.F=Jl[5]|0,this.G=Jl[6]|0,this.H=Jl[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:c,H:l}=this;return[e,n,r,s,i,o,c,l]}set(e,n,r,s,i,o,c,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=c|0,this.H=l|0}process(e,n){for(let h=0;h<16;h++,n+=4)Zl[h]=e.getUint32(n,!1);for(let h=16;h<64;h++){const f=Zl[h-15],p=Zl[h-2],m=Ua(f,7)^Ua(f,18)^f>>>3,g=Ua(p,17)^Ua(p,19)^p>>>10;Zl[h]=g+Zl[h-7]+m+Zl[h-16]|0}let{A:r,B:s,C:i,D:o,E:c,F:l,G:d,H:u}=this;for(let h=0;h<64;h++){const f=Ua(c,6)^Ua(c,11)^Ua(c,25),p=u+f+ome(c,l,d)+cme[h]+Zl[h]|0,m=(Ua(r,2)^Ua(r,13)^Ua(r,22))+ame(r,s,i)|0;u=d,d=l,l=c,c=o+p|0,o=i,i=s,s=r,r=p+m|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,c=c+this.E|0,l=l+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(r,s,i,o,c,l,d,u)}roundClean(){Bo(Zl)}destroy(){this.set(0,0,0,0,0,0,0,0),Bo(this.buffer)}};const d7=e7(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),dme=d7[0],ume=d7[1],Xl=new Uint32Array(80),ed=new Uint32Array(80);let Nj=class extends l7{constructor(e=64){super(128,e,16,!1),this.Ah=bs[0]|0,this.Al=bs[1]|0,this.Bh=bs[2]|0,this.Bl=bs[3]|0,this.Ch=bs[4]|0,this.Cl=bs[5]|0,this.Dh=bs[6]|0,this.Dl=bs[7]|0,this.Eh=bs[8]|0,this.El=bs[9]|0,this.Fh=bs[10]|0,this.Fl=bs[11]|0,this.Gh=bs[12]|0,this.Gl=bs[13]|0,this.Hh=bs[14]|0,this.Hl=bs[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:c,Dl:l,Eh:d,El:u,Fh:h,Fl:f,Gh:p,Gl:m,Hh:g,Hl:y}=this;return[e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y]}set(e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=c|0,this.Dl=l|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=p|0,this.Gl=m|0,this.Hh=g|0,this.Hl=y|0}process(e,n){for(let b=0;b<16;b++,n+=4)Xl[b]=e.getUint32(n),ed[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const v=Xl[b-15]|0,E=ed[b-15]|0,k=ud(v,E,1)^ud(v,E,8)^iD(v,E,7),C=hd(v,E,1)^hd(v,E,8)^oD(v,E,7),S=Xl[b-2]|0,N=ed[b-2]|0,I=ud(S,N,19)^cy(S,N,61)^iD(S,N,6),F=hd(S,N,19)^ly(S,N,61)^oD(S,N,6),P=$pe(C,F,ed[b-7],ed[b-16]),H=Fpe(P,k,I,Xl[b-7],Xl[b-16]);Xl[b]=H|0,ed[b]=P|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:c,Cl:l,Dh:d,Dl:u,Eh:h,El:f,Fh:p,Fl:m,Gh:g,Gl:y,Hh:x,Hl:w}=this;for(let b=0;b<80;b++){const v=ud(h,f,14)^ud(h,f,18)^cy(h,f,41),E=hd(h,f,14)^hd(h,f,18)^ly(h,f,41),k=h&p^~h&g,C=f&m^~f&y,S=zpe(w,E,C,ume[b],ed[b]),N=Hpe(S,x,v,k,dme[b],Xl[b]),I=S|0,F=ud(r,s,28)^cy(r,s,34)^cy(r,s,39),P=hd(r,s,28)^ly(r,s,34)^ly(r,s,39),H=r&i^r&c^i&c,z=s&o^s&l^o&l;x=g|0,w=y|0,g=p|0,y=m|0,p=h|0,m=f|0,{h,l:f}=Qo(d|0,u|0,N|0,I|0),d=c|0,u=l|0,c=i|0,l=o|0,i=r|0,o=s|0;const T=wj(I,P,z);r=xj(T,N,F,H),s=T|0}({h:r,l:s}=Qo(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Qo(this.Bh|0,this.Bl|0,i|0,o|0),{h:c,l}=Qo(this.Ch|0,this.Cl|0,c|0,l|0),{h:d,l:u}=Qo(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:f}=Qo(this.Eh|0,this.El|0,h|0,f|0),{h:p,l:m}=Qo(this.Fh|0,this.Fl|0,p|0,m|0),{h:g,l:y}=Qo(this.Gh|0,this.Gl|0,g|0,y|0),{h:x,l:w}=Qo(this.Hh|0,this.Hl|0,x|0,w|0),this.set(r,s,i,o,c,l,d,u,h,f,p,m,g,y,x,w)}roundClean(){Bo(Xl,ed)}destroy(){Bo(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},hme=class extends Nj{constructor(){super(48),this.Ah=xs[0]|0,this.Al=xs[1]|0,this.Bh=xs[2]|0,this.Bl=xs[3]|0,this.Ch=xs[4]|0,this.Cl=xs[5]|0,this.Dh=xs[6]|0,this.Dl=xs[7]|0,this.Eh=xs[8]|0,this.El=xs[9]|0,this.Fh=xs[10]|0,this.Fl=xs[11]|0,this.Gh=xs[12]|0,this.Gl=xs[13]|0,this.Hh=xs[14]|0,this.Hl=xs[15]|0}};const vs=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class fme extends Nj{constructor(){super(32),this.Ah=vs[0]|0,this.Al=vs[1]|0,this.Bh=vs[2]|0,this.Bl=vs[3]|0,this.Ch=vs[4]|0,this.Cl=vs[5]|0,this.Dh=vs[6]|0,this.Dl=vs[7]|0,this.Eh=vs[8]|0,this.El=vs[9]|0,this.Fh=vs[10]|0,this.Fl=vs[11]|0,this.Gh=vs[12]|0,this.Gl=vs[13]|0,this.Hh=vs[14]|0,this.Hl=vs[15]|0}}const aN=ab(()=>new lme),pme=ab(()=>new Nj),mme=ab(()=>new hme),gme=ab(()=>new fme),yme=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Nr=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Fe=new Uint32Array(32);function td(t,e,n,r,s,i){const o=s[i],c=s[i+1];let l=Fe[2*t],d=Fe[2*t+1],u=Fe[2*e],h=Fe[2*e+1],f=Fe[2*n],p=Fe[2*n+1],m=Fe[2*r],g=Fe[2*r+1],y=wj(l,u,o);d=xj(y,d,h,c),l=y|0,{Dh:g,Dl:m}={Dh:g^d,Dl:m^l},{Dh:g,Dl:m}={Dh:Ope(g,m),Dl:Dpe(g)},{h:p,l:f}=Qo(p,f,g,m),{Bh:h,Bl:u}={Bh:h^p,Bl:u^f},{Bh:h,Bl:u}={Bh:ud(h,u,24),Bl:hd(h,u,24)},Fe[2*t]=l,Fe[2*t+1]=d,Fe[2*e]=u,Fe[2*e+1]=h,Fe[2*n]=f,Fe[2*n+1]=p,Fe[2*r]=m,Fe[2*r+1]=g}function nd(t,e,n,r,s,i){const o=s[i],c=s[i+1];let l=Fe[2*t],d=Fe[2*t+1],u=Fe[2*e],h=Fe[2*e+1],f=Fe[2*n],p=Fe[2*n+1],m=Fe[2*r],g=Fe[2*r+1],y=wj(l,u,o);d=xj(y,d,h,c),l=y|0,{Dh:g,Dl:m}={Dh:g^d,Dl:m^l},{Dh:g,Dl:m}={Dh:ud(g,m,16),Dl:hd(g,m,16)},{h:p,l:f}=Qo(p,f,g,m),{Bh:h,Bl:u}={Bh:h^p,Bl:u^f},{Bh:h,Bl:u}={Bh:cy(h,u,63),Bl:ly(h,u,63)},Fe[2*t]=l,Fe[2*t+1]=d,Fe[2*e]=u,Fe[2*e+1]=h,Fe[2*n]=f,Fe[2*n+1]=p,Fe[2*r]=m,Fe[2*r+1]=g}function wme(t,e={},n,r,s){if(Rl(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:c}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(c!==void 0&&c.length!==s)throw new Error("personalization must be undefined or "+s)}class xme extends oN{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Rl(e),Rl(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=Zw(this.buffer)}update(e){lu(this),e=ba(e),Lo(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,c=e.buffer;for(let l=0;l<i;){this.pos===n&&(fd(s),this.compress(s,0,!1),fd(s),this.pos=0);const d=Math.min(n-this.pos,i-l),u=o+l;if(d===n&&!(u%4)&&l+d<i){const h=new Uint32Array(c,u,Math.floor((i-l)/4));fd(h);for(let f=0;l+n<i;f+=s.length,l+=n)this.length+=n,this.compress(h,f,!1);fd(h);continue}r.set(e.subarray(l,l+d),this.pos),this.pos+=d,this.length+=d,l+=d}return this}digestInto(e){lu(this),Ej(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Bo(this.buffer.subarray(n)),fd(r),this.compress(r,0,!0),fd(r);const s=Zw(e);this.get().forEach((i,o)=>s[o]=zc(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:c}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=c,e.outputLen=o,e}clone(){return this._cloneInto()}}class bme extends xme{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=Nr[0]|0,this.v0h=Nr[1]|0,this.v1l=Nr[2]|0,this.v1h=Nr[3]|0,this.v2l=Nr[4]|0,this.v2h=Nr[5]|0,this.v3l=Nr[6]|0,this.v3h=Nr[7]|0,this.v4l=Nr[8]|0,this.v4h=Nr[9]|0,this.v5l=Nr[10]|0,this.v5h=Nr[11]|0,this.v6l=Nr[12]|0,this.v6h=Nr[13]|0,this.v7l=Nr[14]|0,this.v7h=Nr[15]|0,wme(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=ba(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=ba(i);const c=Zw(i);this.v4l^=zc(c[0]),this.v4h^=zc(c[1]),this.v5l^=zc(c[2]),this.v5h^=zc(c[3])}if(s!==void 0){s=ba(s);const c=Zw(s);this.v6l^=zc(c[0]),this.v6h^=zc(c[1]),this.v7l^=zc(c[2]),this.v7h^=zc(c[3])}if(r!==void 0){const c=new Uint8Array(this.blockLen);c.set(r),this.update(c)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:c,v3h:l,v4l:d,v4h:u,v5l:h,v5h:f,v6l:p,v6h:m,v7l:g,v7h:y}=this;return[e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y]}set(e,n,r,s,i,o,c,l,d,u,h,f,p,m,g,y){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=c|0,this.v3h=l|0,this.v4l=d|0,this.v4h=u|0,this.v5l=h|0,this.v5h=f|0,this.v6l=p|0,this.v6h=m|0,this.v7l=g|0,this.v7h=y|0}compress(e,n,r){this.get().forEach((l,d)=>Fe[d]=l),Fe.set(Nr,16);let{h:s,l:i}=X9(BigInt(this.length));Fe[24]=Nr[8]^i,Fe[25]=Nr[9]^s,r&&(Fe[28]=~Fe[28],Fe[29]=~Fe[29]);let o=0;const c=yme;for(let l=0;l<12;l++)td(0,4,8,12,e,n+2*c[o++]),nd(0,4,8,12,e,n+2*c[o++]),td(1,5,9,13,e,n+2*c[o++]),nd(1,5,9,13,e,n+2*c[o++]),td(2,6,10,14,e,n+2*c[o++]),nd(2,6,10,14,e,n+2*c[o++]),td(3,7,11,15,e,n+2*c[o++]),nd(3,7,11,15,e,n+2*c[o++]),td(0,5,10,15,e,n+2*c[o++]),nd(0,5,10,15,e,n+2*c[o++]),td(1,6,11,12,e,n+2*c[o++]),nd(1,6,11,12,e,n+2*c[o++]),td(2,7,8,13,e,n+2*c[o++]),nd(2,7,8,13,e,n+2*c[o++]),td(3,4,9,14,e,n+2*c[o++]),nd(3,4,9,14,e,n+2*c[o++]);this.v0l^=Fe[0]^Fe[16],this.v0h^=Fe[1]^Fe[17],this.v1l^=Fe[2]^Fe[18],this.v1h^=Fe[3]^Fe[19],this.v2l^=Fe[4]^Fe[20],this.v2h^=Fe[5]^Fe[21],this.v3l^=Fe[6]^Fe[22],this.v3h^=Fe[7]^Fe[23],this.v4l^=Fe[8]^Fe[24],this.v4h^=Fe[9]^Fe[25],this.v5l^=Fe[10]^Fe[26],this.v5h^=Fe[11]^Fe[27],this.v6l^=Fe[12]^Fe[28],this.v6h^=Fe[13]^Fe[29],this.v7l^=Fe[14]^Fe[30],this.v7h^=Fe[15]^Fe[31],Bo(Fe)}destroy(){this.destroyed=!0,Bo(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const vme=Kpe(t=>new bme(t)),Eme="https://rpc.walletconnect.org/v1";function u7(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(sme(n)).toString("hex")}async function Cme(t,e,n,r,s,i){switch(n.t){case"eip191":return await Nme(t,e,n.s);case"eip1271":return await Ame(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function Nme(t,e,n){return(await she({hash:u7(e),signature:n})).toLowerCase()===t.toLowerCase()}async function Ame(t,e,n,r,s,i){const o=Jh(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const c="0x1626ba7e",l="0000000000000000000000000000000000000000000000000000000000000040",d=n.substring(2),u=(d.length/2).toString(16).padStart(64,"0"),h=(e.startsWith("0x")?e:u7(e)).substring(2),f=c+h+l+u+d,p=await fetch(`${i||Eme}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Sme(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:f},"latest"]})}),{result:m}=await p.json();return m?m.slice(0,c.length).toLowerCase()===c.toLowerCase():!1}catch(c){return console.error("isValidEip1271Signature: ",c),!1}}function Sme(){return Date.now()+Math.floor(Math.random()*1e3)}function Tme(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Jg.encode(i)}function _me(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=vme(r,{dkLen:32});return Jg.encode(s)}function dD(t){const e=new Uint8Array(aN(kme(t)));return Jg.encode(e)}function kme(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function uD(t){const e=Buffer.from(t,"base64"),n=zhe(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=Phe(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=gme(i);return Qhe.encode(o).replace(/=+$/,"")}function rS(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function Ime(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(rS(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(rS(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(rS(r.length)),s.push(r);const i=Buffer.concat(s),o=aN(i);return Buffer.from(o).toString("hex").toUpperCase()}var jme=Object.defineProperty,Rme=Object.defineProperties,Pme=Object.getOwnPropertyDescriptors,hD=Object.getOwnPropertySymbols,Ome=Object.prototype.hasOwnProperty,Dme=Object.prototype.propertyIsEnumerable,fD=(t,e,n)=>e in t?jme(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ume=(t,e)=>{for(var n in e||(e={}))Ome.call(e,n)&&fD(t,n,e[n]);if(hD)for(var n of hD(e))Dme.call(e,n)&&fD(t,n,e[n]);return t},Mme=(t,e)=>Rme(t,Pme(e));const Lme="did:pkh:",Aj=t=>t==null?void 0:t.split(":"),Bme=t=>{const e=t&&Aj(t);if(e)return t.includes(Lme)?e[3]:e[1]},d_=t=>{const e=t&&Aj(t);if(e)return e[2]+":"+e[3]},IE=t=>{const e=t&&Aj(t);if(e)return e.pop()};async function pD(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=h7(s,s.iss),o=IE(s.iss);return await Cme(o,i,r,d_(s.iss),n)}const h7=(t,e)=>{const n=`${t.domain} wants you to sign in with your Ethereum account:`,r=IE(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,c=`Chain ID: ${Bme(e)}`,l=`Nonce: ${t.nonce}`,d=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,h=t.nbf?`Not Before: ${t.nbf}`:void 0,f=t.requestId?`Request ID: ${t.requestId}`:void 0,p=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,m=h1(t.resources);if(m){const g=ex(m);s=Gme(s,g)}return[n,r,"",s,"",i,o,c,l,d,u,h,f,p].filter(g=>g!=null).join(`
`)};function $me(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function Fme(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function vf(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function zme(t,e,n,r={}){return n==null||n.sort((s,i)=>s.localeCompare(i)),{att:{[t]:Hme(e,n,r)}}}function Hme(t,e,n={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function f7(t){return vf(t),`urn:recap:${$me(t).replace(/=/g,"")}`}function ex(t){const e=Fme(t.replace("urn:recap:",""));return vf(e),e}function Vme(t,e,n){const r=zme(t,e,n);return f7(r)}function Wme(t){return t&&t.includes("urn:recap:")}function qme(t,e){const n=ex(t),r=ex(e),s=Kme(n,r);return f7(s)}function Kme(t,e){vf(t),vf(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((c,l)=>c.localeCompare(l)).forEach(c=>{var l,d;r.att[s]=Mme(Ume({},r.att[s]),{[c]:((l=t.att[s])==null?void 0:l[c])||((d=e.att[s])==null?void 0:d[c])})})}),r}function Gme(t="",e){vf(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(c=>{const l=Object.keys(e.att[c]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));l.sort((h,f)=>h.action.localeCompare(f.action));const d={};l.forEach(h=>{d[h.ability]||(d[h.ability]=[]),d[h.ability].push(h.action)});const u=Object.keys(d).map(h=>(s++,`(${s}) '${h}': '${d[h].join("', '")}' for '${c}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function mD(t){var e;const n=ex(t);vf(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function gD(t){const e=ex(t);vf(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function h1(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return Wme(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function p7(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function u_(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function sS(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function gi(t,...e){if(!p7(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function yD(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Yme(t,e){gi(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function nu(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function _g(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Qme(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const Jme=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Zme(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function h_(t){if(typeof t=="string")t=Zme(t);else if(p7(t))t=f_(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function Xme(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function ege(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const tge=(t,e)=>{function n(r,...s){if(gi(r),!Jme)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const d=s[0];if(!d)throw new Error("nonce / iv required");t.varSizeNonce?gi(d):gi(d,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&gi(s[1]);const o=e(r,...s),c=(d,u)=>{if(u!==void 0){if(d!==2)throw new Error("cipher output not supported");gi(u)}};let l=!1;return{encrypt(d,u){if(l)throw new Error("cannot encrypt() twice with same key + nonce");return l=!0,gi(d),c(o.encrypt.length,u),o.encrypt(d,u)},decrypt(d,u){if(gi(d),i&&d.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return c(o.decrypt.length,u),o.decrypt(d,u)}}}return Object.assign(n,t),n};function wD(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!rge(e))throw new Error("invalid output, must be aligned");return e}function xD(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),c=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,c,r)}function nge(t,e,n){u_(n);const r=new Uint8Array(16),s=Qme(r);return xD(s,0,BigInt(e),n),xD(s,8,BigInt(t),n),r}function rge(t){return t.byteOffset%4===0}function f_(t){return Uint8Array.from(t)}const m7=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),sge=m7("expand 16-byte k"),ige=m7("expand 32-byte k"),oge=nu(sge),age=nu(ige);function sn(t,e){return t<<e|t>>>32-e}function p_(t){return t.byteOffset%4===0}const mv=64,cge=16,g7=2**32-1,bD=new Uint32Array;function lge(t,e,n,r,s,i,o,c){const l=s.length,d=new Uint8Array(mv),u=nu(d),h=p_(s)&&p_(i),f=h?nu(s):bD,p=h?nu(i):bD;for(let m=0;m<l;o++){if(t(e,n,r,u,o,c),o>=g7)throw new Error("arx: counter overflow");const g=Math.min(mv,l-m);if(h&&g===mv){const y=m/4;if(m%4!==0)throw new Error("arx: invalid block position");for(let x=0,w;x<cge;x++)w=y+x,p[w]=f[w]^u[x];m+=mv;continue}for(let y=0,x;y<g;y++)x=m+y,i[x]=s[x]^d[y];m+=g}}function dge(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=Xme({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return sS(s),sS(o),u_(i),u_(n),(c,l,d,u,h=0)=>{gi(c),gi(l),gi(d);const f=d.length;if(u===void 0&&(u=new Uint8Array(f)),gi(u),sS(h),h<0||h>=g7)throw new Error("arx: counter overflow");if(u.length<f)throw new Error(`arx: output (${u.length}) is shorter than data (${f})`);const p=[];let m=c.length,g,y;if(m===32)p.push(g=f_(c)),y=age;else if(m===16&&n)g=new Uint8Array(32),g.set(c),g.set(c,16),y=oge,p.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${m}`);p_(l)||p.push(l=f_(l));const x=nu(g);if(r){if(l.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(y,x,nu(l.subarray(0,16)),x),l=l.subarray(16)}const w=16-s;if(w!==l.length)throw new Error(`arx: nonce must be ${w} or 16 bytes`);if(w!==12){const v=new Uint8Array(12);v.set(l,i?0:12-l.length),l=v,p.push(l)}const b=nu(l);return lge(t,y,x,b,d,u,h,o),_g(...p),u}}const Gr=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class uge{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=h_(e),gi(e,32);const n=Gr(e,0),r=Gr(e,2),s=Gr(e,4),i=Gr(e,6),o=Gr(e,8),c=Gr(e,10),l=Gr(e,12),d=Gr(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|c<<2)&8191,this.r[7]=(c>>>11|l<<5)&8065,this.r[8]=(l>>>8|d<<8)&8191,this.r[9]=d>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Gr(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,c=o[0],l=o[1],d=o[2],u=o[3],h=o[4],f=o[5],p=o[6],m=o[7],g=o[8],y=o[9],x=Gr(e,n+0),w=Gr(e,n+2),b=Gr(e,n+4),v=Gr(e,n+6),E=Gr(e,n+8),k=Gr(e,n+10),C=Gr(e,n+12),S=Gr(e,n+14);let N=i[0]+(x&8191),I=i[1]+((x>>>13|w<<3)&8191),F=i[2]+((w>>>10|b<<6)&8191),P=i[3]+((b>>>7|v<<9)&8191),H=i[4]+((v>>>4|E<<12)&8191),z=i[5]+(E>>>1&8191),T=i[6]+((E>>>14|k<<2)&8191),_=i[7]+((k>>>11|C<<5)&8191),L=i[8]+((C>>>8|S<<8)&8191),O=i[9]+(S>>>5|s),M=0,B=M+N*c+I*(5*y)+F*(5*g)+P*(5*m)+H*(5*p);M=B>>>13,B&=8191,B+=z*(5*f)+T*(5*h)+_*(5*u)+L*(5*d)+O*(5*l),M+=B>>>13,B&=8191;let W=M+N*l+I*c+F*(5*y)+P*(5*g)+H*(5*m);M=W>>>13,W&=8191,W+=z*(5*p)+T*(5*f)+_*(5*h)+L*(5*u)+O*(5*d),M+=W>>>13,W&=8191;let Z=M+N*d+I*l+F*c+P*(5*y)+H*(5*g);M=Z>>>13,Z&=8191,Z+=z*(5*m)+T*(5*p)+_*(5*f)+L*(5*h)+O*(5*u),M+=Z>>>13,Z&=8191;let ie=M+N*u+I*d+F*l+P*c+H*(5*y);M=ie>>>13,ie&=8191,ie+=z*(5*g)+T*(5*m)+_*(5*p)+L*(5*f)+O*(5*h),M+=ie>>>13,ie&=8191;let ae=M+N*h+I*u+F*d+P*l+H*c;M=ae>>>13,ae&=8191,ae+=z*(5*y)+T*(5*g)+_*(5*m)+L*(5*p)+O*(5*f),M+=ae>>>13,ae&=8191;let oe=M+N*f+I*h+F*u+P*d+H*l;M=oe>>>13,oe&=8191,oe+=z*c+T*(5*y)+_*(5*g)+L*(5*m)+O*(5*p),M+=oe>>>13,oe&=8191;let Ne=M+N*p+I*f+F*h+P*u+H*d;M=Ne>>>13,Ne&=8191,Ne+=z*l+T*c+_*(5*y)+L*(5*g)+O*(5*m),M+=Ne>>>13,Ne&=8191;let de=M+N*m+I*p+F*f+P*h+H*u;M=de>>>13,de&=8191,de+=z*d+T*l+_*c+L*(5*y)+O*(5*g),M+=de>>>13,de&=8191;let _e=M+N*g+I*m+F*p+P*f+H*h;M=_e>>>13,_e&=8191,_e+=z*u+T*d+_*l+L*c+O*(5*y),M+=_e>>>13,_e&=8191;let Ue=M+N*y+I*g+F*m+P*p+H*f;M=Ue>>>13,Ue&=8191,Ue+=z*h+T*u+_*d+L*l+O*c,M+=Ue>>>13,Ue&=8191,M=(M<<2)+M|0,M=M+B|0,B=M&8191,M=M>>>13,W+=M,i[0]=B,i[1]=W,i[2]=Z,i[3]=ie,i[4]=ae,i[5]=oe,i[6]=Ne,i[7]=de,i[8]=_e,i[9]=Ue}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let c=2;c<10;c++)e[c]+=s,s=e[c]>>>13,e[c]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=e[c]+s,s=r[c]>>>13,r[c]&=8191;r[9]-=8192;let i=(s^1)-1;for(let c=0;c<10;c++)r[c]&=i;i=~i;for(let c=0;c<10;c++)e[c]=e[c]&i|r[c];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let c=1;c<8;c++)o=(e[c]+n[c]|0)+(o>>>16)|0,e[c]=o&65535;_g(r)}update(e){yD(this),e=h_(e),gi(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){_g(this.h,this.r,this.buffer,this.pad)}digestInto(e){yD(this),Yme(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function hge(t){const e=(r,s)=>t(s).update(h_(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const fge=hge(t=>new uge(t));function pge(t,e,n,r,s,i=20){let o=t[0],c=t[1],l=t[2],d=t[3],u=e[0],h=e[1],f=e[2],p=e[3],m=e[4],g=e[5],y=e[6],x=e[7],w=s,b=n[0],v=n[1],E=n[2],k=o,C=c,S=l,N=d,I=u,F=h,P=f,H=p,z=m,T=g,_=y,L=x,O=w,M=b,B=v,W=E;for(let ie=0;ie<i;ie+=2)k=k+I|0,O=sn(O^k,16),z=z+O|0,I=sn(I^z,12),k=k+I|0,O=sn(O^k,8),z=z+O|0,I=sn(I^z,7),C=C+F|0,M=sn(M^C,16),T=T+M|0,F=sn(F^T,12),C=C+F|0,M=sn(M^C,8),T=T+M|0,F=sn(F^T,7),S=S+P|0,B=sn(B^S,16),_=_+B|0,P=sn(P^_,12),S=S+P|0,B=sn(B^S,8),_=_+B|0,P=sn(P^_,7),N=N+H|0,W=sn(W^N,16),L=L+W|0,H=sn(H^L,12),N=N+H|0,W=sn(W^N,8),L=L+W|0,H=sn(H^L,7),k=k+F|0,W=sn(W^k,16),_=_+W|0,F=sn(F^_,12),k=k+F|0,W=sn(W^k,8),_=_+W|0,F=sn(F^_,7),C=C+P|0,O=sn(O^C,16),L=L+O|0,P=sn(P^L,12),C=C+P|0,O=sn(O^C,8),L=L+O|0,P=sn(P^L,7),S=S+H|0,M=sn(M^S,16),z=z+M|0,H=sn(H^z,12),S=S+H|0,M=sn(M^S,8),z=z+M|0,H=sn(H^z,7),N=N+I|0,B=sn(B^N,16),T=T+B|0,I=sn(I^T,12),N=N+I|0,B=sn(B^N,8),T=T+B|0,I=sn(I^T,7);let Z=0;r[Z++]=o+k|0,r[Z++]=c+C|0,r[Z++]=l+S|0,r[Z++]=d+N|0,r[Z++]=u+I|0,r[Z++]=h+F|0,r[Z++]=f+P|0,r[Z++]=p+H|0,r[Z++]=m+z|0,r[Z++]=g+T|0,r[Z++]=y+_|0,r[Z++]=x+L|0,r[Z++]=w+O|0,r[Z++]=b+M|0,r[Z++]=v+B|0,r[Z++]=E+W|0}const mge=dge(pge,{counterRight:!1,counterLength:4,allowShortKeys:!1}),gge=new Uint8Array(16),vD=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(gge.subarray(n))},yge=new Uint8Array(32);function ED(t,e,n,r,s){const i=t(e,n,yge),o=fge.create(i);s&&vD(o,s),vD(o,r);const c=nge(r.length,s?s.length:0,!0);o.update(c);const l=o.digest();return _g(i,c),l}const wge=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=wD(o+16,i,!1),i.set(s);const c=i.subarray(0,-16);t(e,n,c,c,1);const l=ED(t,e,n,c,r);return i.set(l,o),_g(l),i},decrypt(s,i){i=wD(s.length-16,i,!1);const o=s.subarray(0,-16),c=s.subarray(-16),l=ED(t,e,n,o,r);if(!ege(c,l))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),_g(l),i}}),y7=tge({blockSize:64,nonceLength:12,tagLength:16},wge(mge));let w7=class extends oN{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,vj(e);const r=ba(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Bo(i)}update(e){return lu(this),this.iHash.update(e),this}digestInto(e){lu(this),Lo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:c}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const cN=(t,e,n)=>new w7(t,e).update(n).digest();cN.create=(t,e)=>new w7(t,e);function xge(t,e,n){return vj(t),n===void 0&&(n=new Uint8Array(t.outputLen)),cN(t,ba(n),ba(e))}const iS=Uint8Array.from([0]),CD=Uint8Array.of();function bge(t,e,n,r=32){vj(t),Rl(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=CD);const o=new Uint8Array(i*s),c=cN.create(t,e),l=c._cloneInto(),d=new Uint8Array(c.outputLen);for(let u=0;u<i;u++)iS[0]=u+1,l.update(u===0?CD:d).update(n).update(iS).digestInto(d),o.set(d,s*u),c._cloneInto(l);return c.destroy(),l.destroy(),Bo(d,iS),o.slice(0,r)}const vge=(t,e,n,r,s)=>bge(t,xge(t,e,n),r,s),lN=aN,Sj=BigInt(0),m_=BigInt(1);function jE(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function gv(t){const e=t.toString(16);return e.length&1?"0"+e:e}function x7(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Sj:BigInt("0x"+t)}function dN(t){return x7(Xw(t))}function RE(t){return Lo(t),x7(Xw(Uint8Array.from(t).reverse()))}function Tj(t,e){return Cj(t.toString(16).padStart(e*2,"0"))}function _j(t,e){return Tj(t,e).reverse()}function pi(t,e,n){let r;if(typeof e=="string")try{r=Cj(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(bj(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const oS=t=>typeof t=="bigint"&&Sj<=t;function Ege(t,e,n){return oS(t)&&oS(e)&&oS(n)&&e<=t&&t<n}function g_(t,e,n,r){if(!Ege(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function Cge(t){let e;for(e=0;t>Sj;t>>=m_,e+=1);return e}const uN=t=>(m_<<BigInt(t))-m_;function Nge(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=f=>new Uint8Array(f),s=f=>Uint8Array.of(f);let i=r(t),o=r(t),c=0;const l=()=>{i.fill(1),o.fill(0),c=0},d=(...f)=>n(o,i,...f),u=(f=r(0))=>{o=d(s(0),f),i=d(),f.length!==0&&(o=d(s(1),f),i=d())},h=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const p=[];for(;f<e;){i=d();const m=i.slice();p.push(m),f+=i.length}return yh(...p)};return(f,p)=>{l(),u(f);let m;for(;!(m=p(h()));)u();return l(),m}}function hN(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const c=t[s];if(o&&c===void 0)return;const l=typeof c;if(l!==i||c===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${l}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function ND(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Ei=BigInt(0),Gs=BigInt(1),wh=BigInt(2),Age=BigInt(3),b7=BigInt(4),v7=BigInt(5),E7=BigInt(8);function Ao(t,e){const n=t%e;return n>=Ei?n:e+n}function Go(t,e,n){let r=t;for(;e-- >Ei;)r*=r,r%=n;return r}function AD(t,e){if(t===Ei)throw new Error("invert: expected non-zero number");if(e<=Ei)throw new Error("invert: expected positive modulus, got "+e);let n=Ao(t,e),r=e,s=Ei,i=Gs;for(;n!==Ei;){const o=r/n,c=r%n,l=s-i*o;r=n,n=c,s=i,i=l}if(r!==Gs)throw new Error("invert: does not exist");return Ao(s,e)}function C7(t,e){const n=(t.ORDER+Gs)/b7,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function Sge(t,e){const n=(t.ORDER-v7)/E7,r=t.mul(e,wh),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,wh),s),c=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(c),e))throw new Error("Cannot find square root");return c}function Tge(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-Gs,n=0;for(;e%wh===Ei;)e/=wh,n++;let r=wh;const s=e0(t);for(;SD(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return C7;let i=s.pow(r,e);const o=(e+Gs)/wh;return function(c,l){if(c.is0(l))return l;if(SD(c,l)!==1)throw new Error("Cannot find square root");let d=n,u=c.mul(c.ONE,i),h=c.pow(l,e),f=c.pow(l,o);for(;!c.eql(h,c.ONE);){if(c.is0(h))return c.ZERO;let p=1,m=c.sqr(h);for(;!c.eql(m,c.ONE);)if(p++,m=c.sqr(m),p===d)throw new Error("Cannot find square root");const g=Gs<<BigInt(d-p-1),y=c.pow(u,g);d=p,u=c.sqr(y),h=c.mul(h,u),f=c.mul(f,y)}return f}}function _ge(t){return t%b7===Age?C7:t%E7===v7?Sge:Tge(t)}const kge=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ige(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=kge.reduce((r,s)=>(r[s]="function",r),e);return hN(t,n),t}function jge(t,e,n){if(n<Ei)throw new Error("invalid exponent, negatives unsupported");if(n===Ei)return t.ONE;if(n===Gs)return e;let r=t.ONE,s=e;for(;n>Ei;)n&Gs&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Gs;return r}function N7(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,c,l)=>t.is0(c)?o:(r[l]=o,t.mul(o,c)),t.ONE),i=t.inv(s);return e.reduceRight((o,c,l)=>t.is0(c)?o:(r[l]=t.mul(o,r[l]),t.mul(o,c)),i),r}function SD(t,e){const n=(t.ORDER-Gs)/wh,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function Rge(t,e){e!==void 0&&Rl(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function e0(t,e,n=!1,r={}){if(t<=Ei)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const u=e;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(n=u.isLE)}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:c}=Rge(t,s);if(c>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const d=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:c,MASK:uN(o),ZERO:Ei,ONE:Gs,create:u=>Ao(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return Ei<=u&&u<t},is0:u=>u===Ei,isValidNot0:u=>!d.is0(u)&&d.isValid(u),isOdd:u=>(u&Gs)===Gs,neg:u=>Ao(-u,t),eql:(u,h)=>u===h,sqr:u=>Ao(u*u,t),add:(u,h)=>Ao(u+h,t),sub:(u,h)=>Ao(u-h,t),mul:(u,h)=>Ao(u*h,t),pow:(u,h)=>jge(d,u,h),div:(u,h)=>Ao(u*AD(h,t),t),sqrN:u=>u*u,addN:(u,h)=>u+h,subN:(u,h)=>u-h,mulN:(u,h)=>u*h,inv:u=>AD(u,t),sqrt:i||(u=>(l||(l=_ge(t)),l(d,u))),toBytes:u=>n?_j(u,c):Tj(u,c),fromBytes:u=>{if(u.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+u.length);return n?RE(u):dN(u)},invertBatch:u=>N7(d,u),cmov:(u,h,f)=>f?h:u});return Object.freeze(d)}function A7(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function S7(t){const e=A7(t);return e+Math.ceil(e/2)}function Pge(t,e,n=!1){const r=t.length,s=A7(e),i=S7(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?RE(t):dN(t),c=Ao(o,e-Gs)+Gs;return n?_j(c,s):Tj(c,s)}const kg=BigInt(0),xh=BigInt(1);function Ty(t,e){const n=e.negate();return t?n:e}function Oge(t,e,n){const r=i=>i.pz,s=N7(t.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(t.fromAffine)}function T7(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function aS(t,e){T7(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=uN(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function TD(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let c=Number(t&s),l=t>>o;c>r&&(c-=i,l+=xh);const d=e*r,u=d+Math.abs(c)-1,h=c===0,f=c<0,p=e%2!==0;return{nextN:l,offset:u,isZero:h,isNeg:f,isNegF:p,offsetF:d}}function Dge(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function Uge(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const cS=new WeakMap,_7=new WeakMap;function lS(t){return _7.get(t)||1}function _D(t){if(t!==kg)throw new Error("invalid wNAF")}function Mge(t,e){return{constTimeNegate:Ty,hasPrecomputes(n){return lS(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>kg;)r&xh&&(s=s.add(i)),i=i.double(),r>>=xh;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=aS(r,e),o=[];let c=n,l=c;for(let d=0;d<s;d++){l=c,o.push(l);for(let u=1;u<i;u++)l=l.add(c),o.push(l);c=l.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const c=aS(n,e);for(let l=0;l<c.windows;l++){const{nextN:d,offset:u,isZero:h,isNeg:f,isNegF:p,offsetF:m}=TD(s,l,c);s=d,h?o=o.add(Ty(p,r[m])):i=i.add(Ty(f,r[u]))}return _D(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=aS(n,e);for(let c=0;c<o.windows&&s!==kg;c++){const{nextN:l,offset:d,isZero:u,isNeg:h}=TD(s,c,o);if(s=l,!u){const f=r[d];i=i.add(h?f.negate():f)}}return _D(s),i},getPrecomputes(n,r,s){let i=cS.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),cS.set(r,i))),i},wNAFCached(n,r,s){const i=lS(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=lS(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){T7(r,e),_7.set(n,r),cS.delete(n)}}}function Lge(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>kg||r>kg;)n&xh&&(i=i.add(s)),r&xh&&(o=o.add(s)),s=s.double(),n>>=xh,r>>=xh;return{p1:i,p2:o}}function Bge(t,e,n,r){Dge(n,t),Uge(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,c=Cge(BigInt(s));let l=1;c>12?l=c-3:c>4?l=c-2:c>0&&(l=2);const d=uN(l),u=new Array(Number(d)+1).fill(o),h=Math.floor((e.BITS-1)/l)*l;let f=o;for(let p=h;p>=0;p-=l){u.fill(o);for(let g=0;g<i;g++){const y=r[g],x=Number(y>>BigInt(p)&d);u[x]=u[x].add(n[g])}let m=o;for(let g=u.length-1,y=o;g>0;g--)y=y.add(u[g]),m=m.add(y);if(f=f.add(m),p!==0)for(let g=0;g<l;g++)f=f.double()}return f}function kD(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Ige(e),e}else return e0(t)}function $ge(t,e,n={}){if(!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const o of["p","n","h"]){const c=e[o];if(!(typeof c=="bigint"&&c>kg))throw new Error(`CURVE.${o} must be positive bigint`)}const r=kD(e.p,n.Fp),s=kD(e.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const B0=BigInt(0),np=BigInt(1),yv=BigInt(2);function Fge(t){return hN(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function zge(t){const e=Fge(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,c=r==="x25519";if(!c&&r!=="x448")throw new Error("invalid type");const l=o||Xg,d=c?255:448,u=c?32:56,h=BigInt(c?9:5),f=BigInt(c?121665:39081),p=c?yv**BigInt(254):yv**BigInt(447),m=c?BigInt(8)*yv**BigInt(251)-np:BigInt(4)*yv**BigInt(445)-np,g=p+m+np,y=N=>Ao(N,n),x=w(h);function w(N){return _j(y(N),u)}function b(N){const I=pi("u coordinate",N,u);return c&&(I[31]&=127),y(RE(I))}function v(N){return RE(s(pi("scalar",N,u)))}function E(N,I){const F=S(b(I),v(N));if(F===B0)throw new Error("invalid private or public key received");return w(F)}function k(N){return E(N,x)}function C(N,I,F){const P=y(N*(I-F));return I=y(I-P),F=y(F+P),{x_2:I,x_3:F}}function S(N,I){g_("u",N,B0,n),g_("scalar",I,p,g);const F=I,P=N;let H=np,z=B0,T=N,_=np,L=B0;for(let M=BigInt(d-1);M>=B0;M--){const B=F>>M&np;L^=B,{x_2:H,x_3:T}=C(L,H,T),{x_2:z,x_3:_}=C(L,z,_),L=B;const W=H+z,Z=y(W*W),ie=H-z,ae=y(ie*ie),oe=Z-ae,Ne=T+_,de=T-_,_e=y(de*W),Ue=y(Ne*ie),ee=_e+Ue,q=_e-Ue;T=y(ee*ee),_=y(P*y(q*q)),H=y(Z*ae),z=y(oe*(Z+y(f*oe)))}({x_2:H,x_3:T}=C(L,H,T)),{x_2:z,x_3:_}=C(L,z,_);const O=i(z);return y(H*O)}return{scalarMult:E,scalarMultBase:k,getSharedSecret:(N,I)=>E(N,I),getPublicKey:N=>k(N),utils:{randomPrivateKey:()=>l(u)},GuBytes:x.slice()}}BigInt(0);const Hge=BigInt(1),ID=BigInt(2),Vge=BigInt(3),Wge=BigInt(5);BigInt(8);const k7={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function qge(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=k7.p,o=t*t%i*t%i,c=Go(o,ID,i)*o%i,l=Go(c,Hge,i)*t%i,d=Go(l,Wge,i)*l%i,u=Go(d,e,i)*d%i,h=Go(u,n,i)*u%i,f=Go(h,r,i)*h%i,p=Go(f,s,i)*f%i,m=Go(p,s,i)*f%i,g=Go(m,e,i)*d%i;return{pow_p_5_8:Go(g,ID,i)*t%i,b2:o}}function Kge(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const y_=(()=>{const t=k7.p;return zge({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=qge(e);return Ao(Go(n,Vge,t)*r,t)},adjustScalarBytes:Kge})})();function jD(t){t.lowS!==void 0&&jE("lowS",t.lowS),t.prehash!==void 0&&jE("prehash",t.prehash)}class Gge extends Error{constructor(e=""){super(e)}}const Jc={Err:Gge,_tlv:{encode:(t,e)=>{const{Err:n}=Jc;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=gv(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?gv(s.length/2|128):"";return gv(t)+i+s+e},decode(t,e){const{Err:n}=Jc;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const l=s&127;if(!l)throw new n("tlv.decode(long): indefinite length not supported");if(l>4)throw new n("tlv.decode(long): byte length is too big");const d=e.subarray(r,r+l);if(d.length!==l)throw new n("tlv.decode: length bytes not complete");if(d[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of d)o=o<<8|u;if(r+=l,o<128)throw new n("tlv.decode(long): not minimal encoding")}const c=e.subarray(r,r+o);if(c.length!==o)throw new n("tlv.decode: wrong value length");return{v:c,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Jc;if(t<_y)throw new e("integer: negative integers are not allowed");let n=gv(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Jc;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return dN(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Jc,s=pi("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:c,l}=r.decode(2,i),{v:d,l:u}=r.decode(2,l);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(d)}},hexFromSig(t){const{_tlv:e,_int:n}=Jc,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},_y=BigInt(0),ky=BigInt(1),Yge=BigInt(2),wv=BigInt(3),Qge=BigInt(4);function Jge(t,e,n){function r(s){const i=t.sqr(s),o=t.mul(i,s);return t.add(t.add(o,t.mul(s,e)),n)}return r}function I7(t,e,n){const{BYTES:r}=t;function s(i){let o;if(typeof i=="bigint")o=i;else{let c=pi("private key",i);if(e){if(!e.includes(c.length*2))throw new Error("invalid private key");const l=new Uint8Array(r);l.set(c,l.length-c.length),c=l}try{o=t.fromBytes(c)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function Zge(t,e={}){const{Fp:n,Fn:r}=$ge("weierstrass",t,e),{h:s,n:i}=t;hN(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!n.is0(t.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function c(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function l(S,N,I){const{x:F,y:P}=N.toAffine(),H=n.toBytes(F);if(jE("isCompressed",I),I){c();const z=!n.isOdd(P);return yh(j7(z),H)}else return yh(Uint8Array.of(4),H,n.toBytes(P))}function d(S){Lo(S);const N=n.BYTES,I=N+1,F=2*N+1,P=S.length,H=S[0],z=S.subarray(1);if(P===I&&(H===2||H===3)){const T=n.fromBytes(z);if(!n.isValid(T))throw new Error("bad point: is not on curve, wrong x");const _=f(T);let L;try{L=n.sqrt(_)}catch(M){const B=M instanceof Error?": "+M.message:"";throw new Error("bad point: is not on curve, sqrt error"+B)}c();const O=n.isOdd(L);return(H&1)===1!==O&&(L=n.neg(L)),{x:T,y:L}}else if(P===F&&H===4){const T=n.fromBytes(z.subarray(N*0,N*1)),_=n.fromBytes(z.subarray(N*1,N*2));if(!p(T,_))throw new Error("bad point: is not on curve");return{x:T,y:_}}else throw new Error(`bad point: got length ${P}, expected compressed=${I} or uncompressed=${F}`)}const u=e.toBytes||l,h=e.fromBytes||d,f=Jge(n,t.a,t.b);function p(S,N){const I=n.sqr(N),F=f(S);return n.eql(I,F)}if(!p(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const m=n.mul(n.pow(t.a,wv),Qge),g=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(m,g)))throw new Error("bad curve params: a or b");function y(S,N,I=!1){if(!n.isValid(N)||I&&n.is0(N))throw new Error(`bad point coordinate ${S}`);return N}function x(S){if(!(S instanceof E))throw new Error("ProjectivePoint expected")}const w=ND((S,N)=>{const{px:I,py:F,pz:P}=S;if(n.eql(P,n.ONE))return{x:I,y:F};const H=S.is0();N==null&&(N=H?n.ONE:n.inv(P));const z=n.mul(I,N),T=n.mul(F,N),_=n.mul(P,N);if(H)return{x:n.ZERO,y:n.ZERO};if(!n.eql(_,n.ONE))throw new Error("invZ was invalid");return{x:z,y:T}}),b=ND(S=>{if(S.is0()){if(e.allowInfinityPoint&&!n.is0(S.py))return;throw new Error("bad point: ZERO")}const{x:N,y:I}=S.toAffine();if(!n.isValid(N)||!n.isValid(I))throw new Error("bad point: x or y not field elements");if(!p(N,I))throw new Error("bad point: equation left != right");if(!S.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function v(S,N,I,F,P){return I=new E(n.mul(I.px,S),I.py,I.pz),N=Ty(F,N),I=Ty(P,I),N.add(I)}class E{constructor(N,I,F){this.px=y("x",N),this.py=y("y",I,!0),this.pz=y("z",F),Object.freeze(this)}static fromAffine(N){const{x:I,y:F}=N||{};if(!N||!n.isValid(I)||!n.isValid(F))throw new Error("invalid affine point");if(N instanceof E)throw new Error("projective point not allowed");return n.is0(I)&&n.is0(F)?E.ZERO:new E(I,F,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(N){return Oge(E,"pz",N)}static fromBytes(N){return Lo(N),E.fromHex(N)}static fromHex(N){const I=E.fromAffine(h(pi("pointHex",N)));return I.assertValidity(),I}static fromPrivateKey(N){const I=I7(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return E.BASE.multiply(I(N))}static msm(N,I){return Bge(E,r,N,I)}precompute(N=8,I=!0){return C.setWindowSize(this,N),I||this.multiply(wv),this}_setWindowSize(N){this.precompute(N)}assertValidity(){b(this)}hasEvenY(){const{y:N}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(N)}equals(N){x(N);const{px:I,py:F,pz:P}=this,{px:H,py:z,pz:T}=N,_=n.eql(n.mul(I,T),n.mul(H,P)),L=n.eql(n.mul(F,T),n.mul(z,P));return _&&L}negate(){return new E(this.px,n.neg(this.py),this.pz)}double(){const{a:N,b:I}=t,F=n.mul(I,wv),{px:P,py:H,pz:z}=this;let T=n.ZERO,_=n.ZERO,L=n.ZERO,O=n.mul(P,P),M=n.mul(H,H),B=n.mul(z,z),W=n.mul(P,H);return W=n.add(W,W),L=n.mul(P,z),L=n.add(L,L),T=n.mul(N,L),_=n.mul(F,B),_=n.add(T,_),T=n.sub(M,_),_=n.add(M,_),_=n.mul(T,_),T=n.mul(W,T),L=n.mul(F,L),B=n.mul(N,B),W=n.sub(O,B),W=n.mul(N,W),W=n.add(W,L),L=n.add(O,O),O=n.add(L,O),O=n.add(O,B),O=n.mul(O,W),_=n.add(_,O),B=n.mul(H,z),B=n.add(B,B),O=n.mul(B,W),T=n.sub(T,O),L=n.mul(B,M),L=n.add(L,L),L=n.add(L,L),new E(T,_,L)}add(N){x(N);const{px:I,py:F,pz:P}=this,{px:H,py:z,pz:T}=N;let _=n.ZERO,L=n.ZERO,O=n.ZERO;const M=t.a,B=n.mul(t.b,wv);let W=n.mul(I,H),Z=n.mul(F,z),ie=n.mul(P,T),ae=n.add(I,F),oe=n.add(H,z);ae=n.mul(ae,oe),oe=n.add(W,Z),ae=n.sub(ae,oe),oe=n.add(I,P);let Ne=n.add(H,T);return oe=n.mul(oe,Ne),Ne=n.add(W,ie),oe=n.sub(oe,Ne),Ne=n.add(F,P),_=n.add(z,T),Ne=n.mul(Ne,_),_=n.add(Z,ie),Ne=n.sub(Ne,_),O=n.mul(M,oe),_=n.mul(B,ie),O=n.add(_,O),_=n.sub(Z,O),O=n.add(Z,O),L=n.mul(_,O),Z=n.add(W,W),Z=n.add(Z,W),ie=n.mul(M,ie),oe=n.mul(B,oe),Z=n.add(Z,ie),ie=n.sub(W,ie),ie=n.mul(M,ie),oe=n.add(oe,ie),W=n.mul(Z,oe),L=n.add(L,W),W=n.mul(Ne,oe),_=n.mul(ae,_),_=n.sub(_,W),W=n.mul(ae,Z),O=n.mul(Ne,O),O=n.add(O,W),new E(_,L,O)}subtract(N){return this.add(N.negate())}is0(){return this.equals(E.ZERO)}multiply(N){const{endo:I}=e;if(!r.isValidNot0(N))throw new Error("invalid scalar: out of range");let F,P;const H=z=>C.wNAFCached(this,z,E.normalizeZ);if(I){const{k1neg:z,k1:T,k2neg:_,k2:L}=I.splitScalar(N),{p:O,f:M}=H(T),{p:B,f:W}=H(L);P=M.add(W),F=v(I.beta,O,B,z,_)}else{const{p:z,f:T}=H(N);F=z,P=T}return E.normalizeZ([F,P])[0]}multiplyUnsafe(N){const{endo:I}=e,F=this;if(!r.isValid(N))throw new Error("invalid scalar: out of range");if(N===_y||F.is0())return E.ZERO;if(N===ky)return F;if(C.hasPrecomputes(this))return this.multiply(N);if(I){const{k1neg:P,k1:H,k2neg:z,k2:T}=I.splitScalar(N),{p1:_,p2:L}=Lge(E,F,H,T);return v(I.beta,_,L,P,z)}else return C.wNAFCachedUnsafe(F,N)}multiplyAndAddUnsafe(N,I,F){const P=this.multiplyUnsafe(I).add(N.multiplyUnsafe(F));return P.is0()?void 0:P}toAffine(N){return w(this,N)}isTorsionFree(){const{isTorsionFree:N}=e;return s===ky?!0:N?N(E,this):C.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:N}=e;return s===ky?this:N?N(E,this):this.multiplyUnsafe(s)}toBytes(N=!0){return jE("isCompressed",N),this.assertValidity(),u(E,this,N)}toRawBytes(N=!0){return this.toBytes(N)}toHex(N=!0){return Xw(this.toBytes(N))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}E.BASE=new E(t.Gx,t.Gy,n.ONE),E.ZERO=new E(n.ZERO,n.ONE,n.ZERO),E.Fp=n,E.Fn=r;const k=r.BITS,C=Mge(E,e.endo?Math.ceil(k/2):k);return E}function j7(t){return Uint8Array.of(t?2:3)}function Xge(t,e,n={}){hN(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||Xg,s=e.hmac||((F,...P)=>cN(e.hash,F,yh(...P))),{Fp:i,Fn:o}=t,{ORDER:c,BITS:l}=o;function d(F){const P=c>>ky;return F>P}function u(F){return d(F)?o.neg(F):F}function h(F,P){if(!o.isValidNot0(P))throw new Error(`invalid signature ${F}: out of range 1..CURVE.n`)}class f{constructor(P,H,z){h("r",P),h("s",H),this.r=P,this.s=H,z!=null&&(this.recovery=z),Object.freeze(this)}static fromCompact(P){const H=o.BYTES,z=pi("compactSignature",P,H*2);return new f(o.fromBytes(z.subarray(0,H)),o.fromBytes(z.subarray(H,H*2)))}static fromDER(P){const{r:H,s:z}=Jc.toSig(pi("DER",P));return new f(H,z)}assertValidity(){}addRecoveryBit(P){return new f(this.r,this.s,P)}recoverPublicKey(P){const H=i.ORDER,{r:z,s:T,recovery:_}=this;if(_==null||![0,1,2,3].includes(_))throw new Error("recovery id invalid");if(c*Yge<H&&_>1)throw new Error("recovery id is ambiguous for h>1 curve");const L=_===2||_===3?z+c:z;if(!i.isValid(L))throw new Error("recovery id 2 or 3 invalid");const O=i.toBytes(L),M=t.fromHex(yh(j7((_&1)===0),O)),B=o.inv(L),W=b(pi("msgHash",P)),Z=o.create(-W*B),ie=o.create(T*B),ae=t.BASE.multiplyUnsafe(Z).add(M.multiplyUnsafe(ie));if(ae.is0())throw new Error("point at infinify");return ae.assertValidity(),ae}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new f(this.r,o.neg(this.s),this.recovery):this}toBytes(P){if(P==="compact")return yh(o.toBytes(this.r),o.toBytes(this.s));if(P==="der")return Cj(Jc.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Xw(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Xw(this.toBytes("compact"))}}const p=I7(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),m={isValidPrivateKey(F){try{return p(F),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const F=c;return Pge(r(S7(F)),F)},precompute(F=8,P=t.BASE){return P.precompute(F,!1)}};function g(F,P=!0){return t.fromPrivateKey(F).toBytes(P)}function y(F){if(typeof F=="bigint")return!1;if(F instanceof t)return!0;const P=pi("key",F).length,H=i.BYTES,z=H+1,T=2*H+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===z))return P===z||P===T}function x(F,P,H=!0){if(y(F)===!0)throw new Error("first arg must be private key");if(y(P)===!1)throw new Error("second arg must be public key");return t.fromHex(P).multiply(p(F)).toBytes(H)}const w=e.bits2int||function(F){if(F.length>8192)throw new Error("input is too large");const P=dN(F),H=F.length*8-l;return H>0?P>>BigInt(H):P},b=e.bits2int_modN||function(F){return o.create(w(F))},v=uN(l);function E(F){return g_("num < 2^"+l,F,_y,v),o.toBytes(F)}function k(F,P,H=C){if(["recovered","canonical"].some(ae=>ae in H))throw new Error("sign() legacy options not supported");const{hash:z}=e;let{lowS:T,prehash:_,extraEntropy:L}=H;T==null&&(T=!0),F=pi("msgHash",F),jD(H),_&&(F=pi("prehashed msgHash",z(F)));const O=b(F),M=p(P),B=[E(M),E(O)];if(L!=null&&L!==!1){const ae=L===!0?r(i.BYTES):L;B.push(pi("extraEntropy",ae))}const W=yh(...B),Z=O;function ie(ae){const oe=w(ae);if(!o.isValidNot0(oe))return;const Ne=o.inv(oe),de=t.BASE.multiply(oe).toAffine(),_e=o.create(de.x);if(_e===_y)return;const Ue=o.create(Ne*o.create(Z+_e*M));if(Ue===_y)return;let ee=(de.x===_e?0:2)|Number(de.y&ky),q=Ue;return T&&d(Ue)&&(q=u(Ue),ee^=1),new f(_e,q,ee)}return{seed:W,k2sig:ie}}const C={lowS:e.lowS,prehash:!1},S={lowS:e.lowS,prehash:!1};function N(F,P,H=C){const{seed:z,k2sig:T}=k(F,P,H);return Nge(e.hash.outputLen,o.BYTES,s)(z,T)}t.BASE.precompute(8);function I(F,P,H,z=S){const T=F;P=pi("msgHash",P),H=pi("publicKey",H),jD(z);const{lowS:_,prehash:L,format:O}=z;if("strict"in z)throw new Error("options.strict was renamed to lowS");if(O!==void 0&&!["compact","der","js"].includes(O))throw new Error('format must be "compact", "der" or "js"');const M=typeof T=="string"||bj(T),B=!M&&!O&&typeof T=="object"&&T!==null&&typeof T.r=="bigint"&&typeof T.s=="bigint";if(!M&&!B)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let W,Z;try{if(B)if(O===void 0||O==="js")W=new f(T.r,T.s);else throw new Error("invalid format");if(M){try{O!=="compact"&&(W=f.fromDER(T))}catch(ee){if(!(ee instanceof Jc.Err))throw ee}!W&&O!=="der"&&(W=f.fromCompact(T))}Z=t.fromHex(H)}catch{return!1}if(!W||_&&W.hasHighS())return!1;L&&(P=e.hash(P));const{r:ie,s:ae}=W,oe=b(P),Ne=o.inv(ae),de=o.create(oe*Ne),_e=o.create(ie*Ne),Ue=t.BASE.multiplyUnsafe(de).add(Z.multiplyUnsafe(_e));return Ue.is0()?!1:o.create(Ue.x)===ie}return Object.freeze({getPublicKey:g,getSharedSecret:x,sign:N,verify:I,utils:m,Point:t,Signature:f})}function e0e(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=e0(e.n,t.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function t0e(t){const{CURVE:e,curveOpts:n}=e0e(t),r={hash:t.hash,hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,ecdsaOpts:r}}function n0e(t,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:t})}function r0e(t){const{CURVE:e,curveOpts:n,ecdsaOpts:r}=t0e(t),s=Zge(e,n),i=Xge(s,r,n);return n0e(t,i)}function w_(t,e){const n=r=>r0e({...t,hash:r});return{...n(e),create:n}}const R7={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},P7={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},O7={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},s0e=e0(R7.p),i0e=e0(P7.p),o0e=e0(O7.p),a0e=w_({...R7,Fp:s0e,lowS:!1},aN);w_({...P7,Fp:i0e,lowS:!1},mme),w_({...O7,Fp:o0e,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},pme);const c0e=a0e,D7="base10",Ys="base16",yi="base64pad",wd="base64url",cb="utf8",U7=0,bl=1,lb=2,l0e=0,RD=1,Iy=12,kj=32;function d0e(){const t=y_.utils.randomPrivateKey(),e=y_.getPublicKey(t);return{privateKey:_i(t,Ys),publicKey:_i(e,Ys)}}function x_(){const t=Xg(kj);return _i(t,Ys)}function u0e(t,e){const n=y_.getSharedSecret(jo(t,Ys),jo(e,Ys)),r=vge(lN,n,void 0,void 0,kj);return _i(r,Ys)}function f1(t){const e=lN(jo(t,Ys));return _i(e,Ys)}function Eo(t){const e=lN(jo(t,cb));return _i(e,Ys)}function M7(t){return jo(`${t}`,D7)}function Ef(t){return Number(_i(t,D7))}function L7(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function B7(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function h0e(t){const e=M7(typeof t.type<"u"?t.type:U7);if(Ef(e)===bl&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?jo(t.senderPublicKey,Ys):void 0,r=typeof t.iv<"u"?jo(t.iv,Ys):Xg(Iy),s=jo(t.symKey,Ys),i=y7(s,r).encrypt(jo(t.message,cb)),o=$7({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===wd?L7(o):o}function f0e(t){const e=jo(t.symKey,Ys),{sealed:n,iv:r}=tx({encoded:t.encoded,encoding:t.encoding}),s=y7(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return _i(s,cb)}function p0e(t,e){const n=M7(lb),r=Xg(Iy),s=jo(t,cb),i=$7({type:n,sealed:s,iv:r});return e===wd?L7(i):i}function m0e(t,e){const{sealed:n}=tx({encoded:t,encoding:e});return _i(n,cb)}function $7(t){if(Ef(t.type)===lb)return _i(Sy([t.type,t.sealed]),yi);if(Ef(t.type)===bl){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return _i(Sy([t.type,t.senderPublicKey,t.iv,t.sealed]),yi)}return _i(Sy([t.type,t.iv,t.sealed]),yi)}function tx(t){const e=(t.encoding||yi)===wd?B7(t.encoded):t.encoded,n=jo(e,yi),r=n.slice(l0e,RD),s=RD;if(Ef(r)===bl){const l=s+kj,d=l+Iy,u=n.slice(s,l),h=n.slice(l,d),f=n.slice(d);return{type:r,sealed:f,iv:h,senderPublicKey:u}}if(Ef(r)===lb){const l=n.slice(s),d=Xg(Iy);return{type:r,sealed:l,iv:d}}const i=s+Iy,o=n.slice(s,i),c=n.slice(i);return{type:r,sealed:c,iv:o}}function g0e(t,e){const n=tx({encoded:t,encoding:e==null?void 0:e.encoding});return F7({type:Ef(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?_i(n.senderPublicKey,Ys):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function F7(t){const e=(t==null?void 0:t.type)||U7;if(e===bl){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function PD(t){return t.type===bl&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function OD(t){return t.type===lb}function y0e(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return Sy([new Uint8Array([4]),e,n])}function w0e(t,e){const[n,r,s]=t.split("."),i=Buffer.from(B7(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),c=i.slice(32,64),l=`${n}.${r}`,d=lN(l),u=y0e(e);if(!c0e.verify(Sy([o,c]),d,u))throw new Error("Invalid signature");return e_(t).payload}const x0e="irn";function PE(t){return(t==null?void 0:t.relay)||{protocol:x0e}}function Fp(t){const e=Kfe[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function b0e(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function DD(t){if(!t.includes("wc:")){const d=Z9(t);d!=null&&d.includes("wc:")&&(t=d)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),c={};o.forEach((d,u)=>{c[u]=d});const l=typeof c.methods=="string"?c.methods.split(","):void 0;return{protocol:r,topic:v0e(s[0]),version:parseInt(s[1],10),symKey:c.symKey,relay:b0e(c),methods:l,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function v0e(t){return t.startsWith("//")?t.substring(2):t}function E0e(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function UD(t){const e=new URLSearchParams,n=E0e(t.relay);Object.keys(n).sort().forEach(s=>{e.set(s,n[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const r=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${r}`}function xv(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var C0e=Object.defineProperty,N0e=Object.defineProperties,A0e=Object.getOwnPropertyDescriptors,MD=Object.getOwnPropertySymbols,S0e=Object.prototype.hasOwnProperty,T0e=Object.prototype.propertyIsEnumerable,LD=(t,e,n)=>e in t?C0e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_0e=(t,e)=>{for(var n in e||(e={}))S0e.call(e,n)&&LD(t,n,e[n]);if(MD)for(var n of MD(e))T0e.call(e,n)&&LD(t,n,e[n]);return t},k0e=(t,e)=>N0e(t,A0e(e));function t0(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function I0e(t){const e=[];return Object.values(t).forEach(n=>{e.push(...t0(n.accounts))}),e}function j0e(t,e){const n=[];return Object.values(t).forEach(r=>{t0(r.accounts).includes(e)&&n.push(...r.methods)}),n}function R0e(t,e){const n=[];return Object.values(t).forEach(r=>{t0(r.accounts).includes(e)&&n.push(...r.events)}),n}function fN(t){return t.includes(":")}function zp(t){return fN(t)?t.split(":")[0]:t}function BD(t){var e,n,r;const s={};if(!bc(t))return s;for(const[i,o]of Object.entries(t)){const c=fN(i)?[i]:o.chains,l=o.methods||[],d=o.events||[],u=zp(i);s[u]=k0e(_0e({},s[u]),{chains:xc(c,(e=s[u])==null?void 0:e.chains),methods:xc(l,(n=s[u])==null?void 0:n.methods),events:xc(d,(r=s[u])==null?void 0:r.events)})}return s}function P0e(t){const e={};return t==null||t.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function $D(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=P0e(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=xc(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function O0e(t,e){var n,r,s,i,o,c;const l=BD(t),d=BD(e),u={},h=Object.keys(l).concat(Object.keys(d));for(const f of h)u[f]={chains:xc((n=l[f])==null?void 0:n.chains,(r=d[f])==null?void 0:r.chains),methods:xc((s=l[f])==null?void 0:s.methods,(i=d[f])==null?void 0:i.methods),events:xc((o=l[f])==null?void 0:o.events,(c=d[f])==null?void 0:c.events)};return u}const D0e={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},U0e={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Pe(t,e){const{message:n,code:r}=U0e[t];return{message:e?`${n} ${e}`:n,code:r}}function Fn(t,e){const{message:n,code:r}=D0e[t];return{message:e?`${n} ${e}`:n,code:r}}function vl(t,e){return!!Array.isArray(t)}function bc(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function kr(t){return typeof t>"u"}function wr(t,e){return e&&kr(t)?!0:typeof t=="string"&&!!t.trim().length}function Ij(t,e){return e&&kr(t)?!0:typeof t=="number"&&!isNaN(t)}function M0e(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return gh(s,r)?(r.forEach(o=>{const{accounts:c,methods:l,events:d}=t.namespaces[o],u=t0(c),h=n[o];(!gh(K9(o,h),u)||!gh(h.methods,l)||!gh(h.events,d))&&(i=!1)}),i):!1}function OE(t){return wr(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function L0e(t){if(wr(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&OE(n)}}return!1}function B0e(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(wr(t,!1)){if(e(t))return!0;const n=Z9(t);return e(n)}}catch{}return!1}function $0e(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function F0e(t){return t==null?void 0:t.topic}function z0e(t,e){let n=null;return wr(t==null?void 0:t.publicKey,!1)||(n=Pe("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function FD(t){let e=!0;return vl(t)?t.length&&(e=t.every(n=>wr(n,!1))):e=!1,e}function H0e(t,e,n){let r=null;return vl(e)&&e.length?e.forEach(s=>{r||OE(s)||(r=Fn("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):OE(t)||(r=Fn("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function V0e(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=H0e(s,K9(s,i),`${e} ${n}`);o&&(r=o)}),r}function W0e(t,e){let n=null;return vl(t)?t.forEach(r=>{n||L0e(r)||(n=Fn("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=Fn("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function q0e(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=W0e(r==null?void 0:r.accounts,`${e} namespace`);s&&(n=s)}),n}function K0e(t,e){let n=null;return FD(t==null?void 0:t.methods)?FD(t==null?void 0:t.events)||(n=Fn("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=Fn("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function z7(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=K0e(r,`${e}, namespace`);s&&(n=s)}),n}function G0e(t,e,n){let r=null;if(t&&bc(t)){const s=z7(t,e);s&&(r=s);const i=V0e(t,e,n);i&&(r=i)}else r=Pe("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function dS(t,e){let n=null;if(t&&bc(t)){const r=z7(t,e);r&&(n=r);const s=q0e(t,e);s&&(n=s)}else n=Pe("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function H7(t){return wr(t.protocol,!0)}function Y0e(t,e){let n=!1;return t?t&&vl(t)&&t.length&&t.forEach(r=>{n=H7(r)}):n=!0,n}function Q0e(t){return typeof t=="number"}function li(t){return typeof t<"u"&&typeof t!==null}function J0e(t){return!(!t||typeof t!="object"||!t.code||!Ij(t.code,!1)||!t.message||!wr(t.message,!1))}function Z0e(t){return!(kr(t)||!wr(t.method,!1))}function X0e(t){return!(kr(t)||kr(t.result)&&kr(t.error)||!Ij(t.id,!1)||!wr(t.jsonrpc,!1))}function eye(t){return!(kr(t)||!wr(t.name,!1))}function zD(t,e){return!(!OE(e)||!I0e(t).includes(e))}function tye(t,e,n){return wr(n,!1)?j0e(t,e).includes(n):!1}function nye(t,e,n){return wr(n,!1)?R0e(t,e).includes(n):!1}function HD(t,e,n){let r=null;const s=rye(t),i=sye(e),o=Object.keys(s),c=Object.keys(i),l=VD(Object.keys(t)),d=VD(Object.keys(e)),u=l.filter(h=>!d.includes(h));return u.length&&(r=Pe("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),gh(o,c)||(r=Pe("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||r)return;const f=t0(e[h].accounts);f.includes(h)||(r=Pe("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${f.toString()}`))}),o.forEach(h=>{r||(gh(s[h].methods,i[h].methods)?gh(s[h].events,i[h].events)||(r=Pe("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${h}`)):r=Pe("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${h}`))}),r}function rye(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function VD(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function sye(t){const e={};return Object.keys(t).forEach(n=>{if(n.includes(":"))e[n]=t[n];else{const r=t0(t[n].accounts);r==null||r.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}}),e}function iye(t,e){return Ij(t,!1)&&t<=e.max&&t>=e.min}function WD(){const t=ob();return new Promise(e=>{switch(t){case Yi.browser:e(oye());break;case Yi.reactNative:e(aye());break;case Yi.node:e(cye());break;default:e(!0)}})}function oye(){return Zg()&&(navigator==null?void 0:navigator.onLine)}async function aye(){if(Nu()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function cye(){return!0}function lye(t){switch(ob()){case Yi.browser:dye(t);break;case Yi.reactNative:uye(t);break}}function dye(t){!Nu()&&Zg()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function uye(t){Nu()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}function hye(){var t;return Zg()&&xf()?((t=xf())==null?void 0:t.visibilityState)==="visible":!0}const uS={};class $0{static get(e){return uS[e]}static set(e,n){uS[e]=n}static delete(e){delete uS[e]}}function fye(t){const e=Jg.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function pye({publicKey:t,signature:e,payload:n}){var r;const s=b_(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=yye(n.address),c=n.era==="00"?new Uint8Array([0]):b_(n.era);if(c.length!==1&&c.length!==2)throw new Error("Invalid era length");const l=parseInt(n.nonce,16),d=new Uint8Array([l&255,l>>8&255]),u=BigInt(`0x${gye(n.tip)}`),h=xye(u),f=new Uint8Array([0,...t,o,...e,...c,...d,...h,...s]),p=wye(f.length+1);return new Uint8Array([...p,i,...f])}function mye(t){const e=b_(t),n=ipe.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function b_(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function gye(t){return t.startsWith("0x")?t.slice(2):t}function yye(t){const e=Jg.decode(t)[0];return e===42?0:e===60?2:1}function wye(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function xye(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function bye(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=fye(t.transaction.address),r=pye({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return mye(s)}const vye="PARSE_ERROR",Eye="INVALID_REQUEST",Cye="METHOD_NOT_FOUND",Nye="INVALID_PARAMS",V7="INTERNAL_ERROR",jj="SERVER_ERROR",Aye=[-32700,-32600,-32601,-32602,-32603],jy={[vye]:{code:-32700,message:"Parse error"},[Eye]:{code:-32600,message:"Invalid Request"},[Cye]:{code:-32601,message:"Method not found"},[Nye]:{code:-32602,message:"Invalid params"},[V7]:{code:-32603,message:"Internal error"},[jj]:{code:-32e3,message:"Server error"}},W7=jj;function Sye(t){return Aye.includes(t)}function qD(t){return Object.keys(jy).includes(t)?jy[t]:jy[W7]}function Tye(t){const e=Object.values(jy).find(n=>n.code===t);return e||jy[W7]}function q7(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var K7={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var v_=function(t,e){return v_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},v_(t,e)};function _ye(t,e){v_(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var E_=function(){return E_=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},E_.apply(this,arguments)};function kye(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Iye(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function jye(t,e){return function(n,r){e(n,r,t)}}function Rye(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Pye(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(u){try{d(r.next(u))}catch(h){o(h)}}function l(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((r=r.apply(t,e||[])).next())})}function Oye(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(u){return l([d,u])}}function l(d){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,s=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){n.label=d[1];break}if(d[0]===6&&n.label<i[1]){n.label=i[1],i=d;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(d);break}i[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(u){d=[6,u],s=0}finally{r=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Dye(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function Uye(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function C_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function G7(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(c){o={error:c}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function Mye(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(G7(arguments[e]));return t}function Lye(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,c=i.length;o<c;o++,s++)r[s]=i[o];return r}function nx(t){return this instanceof nx?(this.v=t,this):new nx(t)}function Bye(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(p){return new Promise(function(m,g){i.push([f,p,m,g])>1||c(f,p)})})}function c(f,p){try{l(r[f](p))}catch(m){h(i[0][3],m)}}function l(f){f.value instanceof nx?Promise.resolve(f.value.v).then(d,u):h(i[0][2],f)}function d(f){c("next",f)}function u(f){c("throw",f)}function h(f,p){f(p),i.shift(),i.length&&c(i[0][0],i[0][1])}}function $ye(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:nx(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function Fye(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof C_=="function"?C_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(c,l){o=t[i](o),s(c,l,o.done,o.value)})}}function s(i,o,c,l){Promise.resolve(l).then(function(d){i({value:d,done:c})},o)}}function zye(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Hye(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function Vye(t){return t&&t.__esModule?t:{default:t}}function Wye(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function qye(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const Kye=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return E_},__asyncDelegator:$ye,__asyncGenerator:Bye,__asyncValues:Fye,__await:nx,__awaiter:Pye,__classPrivateFieldGet:Wye,__classPrivateFieldSet:qye,__createBinding:Dye,__decorate:Iye,__exportStar:Uye,__extends:_ye,__generator:Oye,__importDefault:Vye,__importStar:Hye,__makeTemplateObject:zye,__metadata:Rye,__param:jye,__read:G7,__rest:kye,__spread:Mye,__spreadArrays:Lye,__values:C_},Symbol.toStringTag,{value:"Module"})),Gye=BU(Kye);var Bc={},KD;function Yye(){if(KD)return Bc;KD=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.isBrowserCryptoAvailable=Bc.getSubtleCrypto=Bc.getBrowerCrypto=void 0;function t(){return(tc==null?void 0:tc.crypto)||(tc==null?void 0:tc.msCrypto)||{}}Bc.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Bc.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Bc.isBrowserCryptoAvailable=n,Bc}var $c={},GD;function Qye(){if(GD)return $c;GD=1,Object.defineProperty($c,"__esModule",{value:!0}),$c.isBrowser=$c.isNode=$c.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}$c.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}$c.isNode=e;function n(){return!t()&&!e()}return $c.isBrowser=n,$c}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Gye;e.__exportStar(Yye(),t),e.__exportStar(Qye(),t)})(K7);function za(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function Hd(t=6){return BigInt(za(t))}function nc(t,e,n){return{id:n||za(),jsonrpc:"2.0",method:t,params:e}}function rx(t,e){return{id:t,jsonrpc:"2.0",result:e}}function pN(t,e,n){return{id:t,jsonrpc:"2.0",error:Jye(e)}}function Jye(t,e){return typeof t>"u"?qD(V7):(typeof t=="string"&&(t=Object.assign(Object.assign({},qD(jj)),{message:t})),Sye(t.code)&&(t=Tye(t.code)),t)}let Zye=class{},Xye=class extends Zye{constructor(){super()}},ewe=class extends Xye{constructor(e){super()}};const twe="^https?:",nwe="^wss?:";function rwe(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Y7(t,e){const n=rwe(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function YD(t){return Y7(t,twe)}function QD(t){return Y7(t,nwe)}function swe(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Q7(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Rj(t){return Q7(t)&&"method"in t}function mN(t){return Q7(t)&&(Ha(t)||Co(t))}function Ha(t){return"result"in t}function Co(t){return"error"in t}let zo=class extends ewe{constructor(e){super(e),this.events=new Fo.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(nc(e.method,e.params||[],e.id||Hd().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{Co(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),mN(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const iwe=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),owe=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",JD=t=>t.split("?")[0],ZD=10,awe=iwe();let cwe=class{constructor(e){if(this.url=e,this.events=new Fo.EventEmitter,this.registering=!1,!QD(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(jl(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!QD(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=K7.isReactNative()?void 0:{rejectUnauthorized:!swe(e)},i=new awe(e,[],s);owe()?i.onerror=o=>{const c=o;r(this.emitError(c.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?wf(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=pN(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return q7(e,JD(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>ZD&&this.events.setMaxListeners(ZD)}emitError(e){const n=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${JD(this.url)}`));return this.events.emit("register_error",n),n}};var lwe={};const J7="wc",Z7=2,N_="core",Tc=`${J7}@2:${N_}:`,dwe={logger:"error"},uwe={database:":memory:"},hwe="crypto",XD="client_ed25519_seed",fwe=Re.ONE_DAY,pwe="keychain",mwe="0.3",gwe="messages",ywe="0.3",wwe=Re.SIX_HOURS,xwe="publisher",X7="irn",bwe="error",ez="wss://relay.walletconnect.org",vwe="relayer",cr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Ewe="_subscription",ao={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Cwe=.1,A_="2.21.7",Pn={link_mode:"link_mode",relay:"relay"},p1={inbound:"inbound",outbound:"outbound"},Nwe="0.3",Awe="WALLETCONNECT_CLIENT_ID",e5="WALLETCONNECT_LINK_MODE_APPS",Ui={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Swe="subscription",Twe="0.3",_we="pairing",kwe="0.3",F0={wc_pairingDelete:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Re.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Re.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Re.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:0},res:{ttl:Re.ONE_DAY,prompt:!1,tag:0}}},Ju={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Ko={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Iwe="history",jwe="0.3",Rwe="expirer",fo={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Pwe="0.3",Owe="verify-api",Dwe="https://verify.walletconnect.com",tz="https://verify.walletconnect.org",Ry=tz,Uwe=`${Ry}/v3`,Mwe=[Dwe,tz],Lwe="echo",Bwe="https://echo.walletconnect.com",$a={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Hc={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},rd={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},z0={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Du={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},H0={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},$we=.1,Fwe="event-client",zwe=86400,Hwe="https://pulse.walletconnect.org/batch";function Vwe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var c=t.length,l=t.charAt(0),d=Math.log(c)/Math.log(256),u=Math.log(256)/Math.log(c);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,y=0,x=0,w=m.length;x!==w&&m[x]===0;)x++,g++;for(var b=(w-x)*u+1>>>0,v=new Uint8Array(b);x!==w;){for(var E=m[x],k=0,C=b-1;(E!==0||k<y)&&C!==-1;C--,k++)E+=256*v[C]>>>0,v[C]=E%c>>>0,E=E/c>>>0;if(E!==0)throw new Error("Non-zero carry");y=k,x++}for(var S=b-y;S!==b&&v[S]===0;)S++;for(var N=l.repeat(g);S<b;++S)N+=t.charAt(v[S]);return N}function f(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var y=0,x=0;m[g]===l;)y++,g++;for(var w=(m.length-g)*d+1>>>0,b=new Uint8Array(w);m[g];){var v=n[m.charCodeAt(g)];if(v===255)return;for(var E=0,k=w-1;(v!==0||E<x)&&k!==-1;k--,E++)v+=c*b[k]>>>0,b[k]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");x=E,g++}if(m[g]!==" "){for(var C=w-x;C!==w&&b[C]===0;)C++;for(var S=new Uint8Array(y+(w-C)),N=y;C!==w;)S[N++]=b[C++];return S}}}function p(m){var g=f(m);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:p}}var Wwe=Vwe,qwe=Wwe;const nz=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Kwe=t=>new TextEncoder().encode(t),Gwe=t=>new TextDecoder().decode(t);class Ywe{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Qwe{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return rz(this,e)}}class Jwe{constructor(e){this.decoders=e}or(e){return rz(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const rz=(t,e)=>new Jwe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Zwe{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new Ywe(e,n,r),this.decoder=new Qwe(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const gN=({name:t,prefix:e,encode:n,decode:r})=>new Zwe(t,e,n,r),db=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=qwe(n,e);return gN({prefix:t,name:e,encode:r,decode:i=>nz(s(i))})},Xwe=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let c=0,l=0,d=0;for(let u=0;u<i;++u){const h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<n|h,c+=n,c>=8&&(c-=8,o[d++]=255&l>>c)}if(c>=n||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return o},exe=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],o+=8;o>n;)o-=n,i+=e[s&c>>o];if(o&&(i+=e[s&c<<n-o]),r)for(;i.length*n&7;)i+="=";return i},fs=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>gN({prefix:e,name:t,encode(s){return exe(s,r,n)},decode(s){return Xwe(s,r,n,t)}}),txe=gN({prefix:"\0",name:"identity",encode:t=>Gwe(t),decode:t=>Kwe(t)});var nxe=Object.freeze({__proto__:null,identity:txe});const rxe=fs({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sxe=Object.freeze({__proto__:null,base2:rxe});const ixe=fs({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var oxe=Object.freeze({__proto__:null,base8:ixe});const axe=db({prefix:"9",name:"base10",alphabet:"0123456789"});var cxe=Object.freeze({__proto__:null,base10:axe});const lxe=fs({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),dxe=fs({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var uxe=Object.freeze({__proto__:null,base16:lxe,base16upper:dxe});const hxe=fs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),fxe=fs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),pxe=fs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),mxe=fs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),gxe=fs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),yxe=fs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wxe=fs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),xxe=fs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bxe=fs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var vxe=Object.freeze({__proto__:null,base32:hxe,base32upper:fxe,base32pad:pxe,base32padupper:mxe,base32hex:gxe,base32hexupper:yxe,base32hexpad:wxe,base32hexpadupper:xxe,base32z:bxe});const Exe=db({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Cxe=db({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nxe=Object.freeze({__proto__:null,base36:Exe,base36upper:Cxe});const Axe=db({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Sxe=db({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Txe=Object.freeze({__proto__:null,base58btc:Axe,base58flickr:Sxe});const _xe=fs({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),kxe=fs({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ixe=fs({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),jxe=fs({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Rxe=Object.freeze({__proto__:null,base64:_xe,base64pad:kxe,base64url:Ixe,base64urlpad:jxe});const sz=Array.from(""),Pxe=sz.reduce((t,e,n)=>(t[n]=e,t),[]),Oxe=sz.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Dxe(t){return t.reduce((e,n)=>(e+=Pxe[n],e),"")}function Uxe(t){const e=[];for(const n of t){const r=Oxe[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const Mxe=gN({prefix:"",name:"base256emoji",encode:Dxe,decode:Uxe});var Lxe=Object.freeze({__proto__:null,base256emoji:Mxe}),Bxe=iz,t5=128,$xe=-128,Fxe=Math.pow(2,31);function iz(t,e,n){e=e||[],n=n||0;for(var r=n;t>=Fxe;)e[n++]=t&255|t5,t/=128;for(;t&$xe;)e[n++]=t&255|t5,t>>>=7;return e[n]=t|0,iz.bytes=n-r+1,e}var zxe=S_,Hxe=128,n5=127;function S_(t,r){var n=0,r=r||0,s=0,i=r,o,c=t.length;do{if(i>=c)throw S_.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&n5)<<s:(o&n5)*Math.pow(2,s),s+=7}while(o>=Hxe);return S_.bytes=i-r,n}var Vxe=Math.pow(2,7),Wxe=Math.pow(2,14),qxe=Math.pow(2,21),Kxe=Math.pow(2,28),Gxe=Math.pow(2,35),Yxe=Math.pow(2,42),Qxe=Math.pow(2,49),Jxe=Math.pow(2,56),Zxe=Math.pow(2,63),Xxe=function(t){return t<Vxe?1:t<Wxe?2:t<qxe?3:t<Kxe?4:t<Gxe?5:t<Yxe?6:t<Qxe?7:t<Jxe?8:t<Zxe?9:10},ebe={encode:Bxe,decode:zxe,encodingLength:Xxe},oz=ebe;const r5=(t,e,n=0)=>(oz.encode(t,e,n),e),s5=t=>oz.encodingLength(t),T_=(t,e)=>{const n=e.byteLength,r=s5(t),s=r+s5(n),i=new Uint8Array(s+n);return r5(t,i,0),r5(n,i,r),i.set(e,s),new tbe(t,n,e,i)};class tbe{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const az=({name:t,code:e,encode:n})=>new nbe(t,e,n);class nbe{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?T_(this.code,n):n.then(r=>T_(this.code,r))}else throw Error("Unknown type, must be binary type")}}const cz=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),rbe=az({name:"sha2-256",code:18,encode:cz("SHA-256")}),sbe=az({name:"sha2-512",code:19,encode:cz("SHA-512")});var ibe=Object.freeze({__proto__:null,sha256:rbe,sha512:sbe});const lz=0,obe="identity",dz=nz,abe=t=>T_(lz,dz(t)),cbe={code:lz,name:obe,encode:dz,digest:abe};var lbe=Object.freeze({__proto__:null,identity:cbe});new TextEncoder,new TextDecoder;const i5={...nxe,...sxe,...oxe,...cxe,...uxe,...vxe,...Nxe,...Txe,...Rxe,...Lxe};({...ibe,...lbe});function uz(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function dbe(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?uz(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function hz(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const o5=hz("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),hS=hz("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=dbe(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),ube={utf8:o5,"utf-8":o5,hex:i5.base16,latin1:hS,ascii:hS,binary:hS,...i5};function hbe(t,e="utf8"){const n=ube[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?uz(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var fbe=Object.defineProperty,pbe=(t,e,n)=>e in t?fbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ma=(t,e,n)=>pbe(t,typeof e!="symbol"?e+"":e,n);class mbe{constructor(e,n){this.core=e,this.logger=n,Ma(this,"keychain",new Map),Ma(this,"name",pwe),Ma(this,"version",mwe),Ma(this,"initialized",!1),Ma(this,"storagePrefix",Tc),Ma(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),Ma(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),Ma(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),Ma(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=Pe("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),Ma(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=Ds(n,this.name)}get context(){return ji(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,c_(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?l_(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var gbe=Object.defineProperty,ybe=(t,e,n)=>e in t?gbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yr=(t,e,n)=>ybe(t,typeof e!="symbol"?e+"":e,n);class wbe{constructor(e,n,r){this.core=e,this.logger=n,Yr(this,"name",hwe),Yr(this,"keychain"),Yr(this,"randomSessionIdentifier",x_()),Yr(this,"initialized",!1),Yr(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Yr(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Yr(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=D4(s);return s9(i.publicKey)}),Yr(this,"generateKeyPair",()=>{this.isInitialized();const s=d0e();return this.setPrivateKey(s.publicKey,s.privateKey)}),Yr(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=D4(i),c=this.randomSessionIdentifier;return await Vde(c,s,fwe,o)}),Yr(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const c=this.getPrivateKey(s),l=u0e(c,i);return this.setSymKey(l,o)}),Yr(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||f1(s);return await this.keychain.set(o,s),o}),Yr(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Yr(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Yr(this,"encode",async(s,i,o)=>{this.isInitialized();const c=F7(o),l=jl(i);if(OD(c))return p0e(l,o==null?void 0:o.encoding);if(PD(c)){const f=c.senderPublicKey,p=c.receiverPublicKey;s=await this.generateSharedKey(f,p)}const d=this.getSymKey(s),{type:u,senderPublicKey:h}=c;return h0e({type:u,symKey:d,message:l,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),Yr(this,"decode",async(s,i,o)=>{this.isInitialized();const c=g0e(i,o);if(OD(c)){const l=m0e(i,o==null?void 0:o.encoding);return wf(l)}if(PD(c)){const l=c.receiverPublicKey,d=c.senderPublicKey;s=await this.generateSharedKey(l,d)}try{const l=this.getSymKey(s),d=f0e({symKey:l,encoded:i,encoding:o==null?void 0:o.encoding});return wf(d)}catch(l){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(l)}}),Yr(this,"getPayloadType",(s,i=yi)=>{const o=tx({encoded:s,encoding:i});return Ef(o.type)}),Yr(this,"getPayloadSenderPublicKey",(s,i=yi)=>{const o=tx({encoded:s,encoding:i});return o.senderPublicKey?_i(o.senderPublicKey,Ys):void 0}),this.core=e,this.logger=Ds(n,this.name),this.keychain=r||new mbe(this.core,this.logger)}get context(){return ji(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(XD)}catch{e=x_(),await this.keychain.set(XD,e)}return hbe(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var xbe=Object.defineProperty,bbe=Object.defineProperties,vbe=Object.getOwnPropertyDescriptors,a5=Object.getOwnPropertySymbols,Ebe=Object.prototype.hasOwnProperty,Cbe=Object.prototype.propertyIsEnumerable,__=(t,e,n)=>e in t?xbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nbe=(t,e)=>{for(var n in e||(e={}))Ebe.call(e,n)&&__(t,n,e[n]);if(a5)for(var n of a5(e))Cbe.call(e,n)&&__(t,n,e[n]);return t},Abe=(t,e)=>bbe(t,vbe(e)),Pi=(t,e,n)=>__(t,typeof e!="symbol"?e+"":e,n);class Sbe extends zae{constructor(e,n){super(e,n),this.logger=e,this.core=n,Pi(this,"messages",new Map),Pi(this,"messagesWithoutClientAck",new Map),Pi(this,"name",gwe),Pi(this,"version",ywe),Pi(this,"initialized",!1),Pi(this,"storagePrefix",Tc),Pi(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Pi(this,"set",async(r,s,i)=>{this.isInitialized();const o=Eo(s);let c=this.messages.get(r);if(typeof c>"u"&&(c={}),typeof c[o]<"u")return o;if(c[o]=s,this.messages.set(r,c),i===p1.inbound){const l=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,Abe(Nbe({},l),{[o]:s}))}return await this.persist(),o}),Pi(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),Pi(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Pi(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=Eo(s);return typeof i[o]<"u"}),Pi(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=Eo(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),Pi(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Ds(e,this.name),this.core=n}get context(){return ji(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,c_(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,c_(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?l_(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?l_(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Tbe=Object.defineProperty,_be=Object.defineProperties,kbe=Object.getOwnPropertyDescriptors,c5=Object.getOwnPropertySymbols,Ibe=Object.prototype.hasOwnProperty,jbe=Object.prototype.propertyIsEnumerable,k_=(t,e,n)=>e in t?Tbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rp=(t,e)=>{for(var n in e||(e={}))Ibe.call(e,n)&&k_(t,n,e[n]);if(c5)for(var n of c5(e))jbe.call(e,n)&&k_(t,n,e[n]);return t},l5=(t,e)=>_be(t,kbe(e)),co=(t,e,n)=>k_(t,typeof e!="symbol"?e+"":e,n);class Rbe extends Hae{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,co(this,"events",new Fo.EventEmitter),co(this,"name",xwe),co(this,"queue",new Map),co(this,"publishTimeout",Re.toMiliseconds(Re.ONE_MINUTE)),co(this,"initialPublishTimeout",Re.toMiliseconds(Re.ONE_SECOND*15)),co(this,"needsTransportRestart",!1),co(this,"publish",async(r,s,i)=>{var o,c,l,d,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const h=(i==null?void 0:i.ttl)||wwe,f=(i==null?void 0:i.prompt)||!1,p=(i==null?void 0:i.tag)||0,m=(i==null?void 0:i.id)||Hd().toString(),g=Fp(PE().protocol),y={id:m,method:(i==null?void 0:i.publishMethod)||g.publish,params:rp({topic:r,message:s,ttl:h,prompt:f,tag:p,attestation:i==null?void 0:i.attestation},(i==null?void 0:i.tvf)&&{tvf:i.tvf})},x=`Failed to publish payload, please try again. id:${m} tag:${p}`;try{kr((o=y.params)==null?void 0:o.prompt)&&((c=y.params)==null||delete c.prompt),kr((l=y.params)==null?void 0:l.tag)&&((d=y.params)==null||delete d.tag);const w=new Promise(async b=>{const v=({id:k})=>{var C;((C=y.id)==null?void 0:C.toString())===k.toString()&&(this.removeRequestFromQueue(k),this.relayer.events.removeListener(cr.publish,v),b())};this.relayer.events.on(cr.publish,v);const E=dc(new Promise((k,C)=>{this.rpcPublish(y,i).then(k).catch(S=>{this.logger.warn(S,S==null?void 0:S.message),C(S)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${m} tag:${p}`);try{await E,this.events.removeListener(cr.publish,v)}catch(k){this.queue.set(m,{request:y,opts:i,attempt:1}),this.logger.warn(k,k==null?void 0:k.message)}});this.logger.trace({type:"method",method:"publish",params:{id:m,topic:r,message:s,opts:i}}),await dc(w,this.publishTimeout,x)}catch(w){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(w),(u=i==null?void 0:i.internal)!=null&&u.throwOnFailedPublish)throw w}finally{this.queue.delete(m)}}),co(this,"publishCustom",async r=>{var s,i,o,c,l;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:d,opts:u={}}=r,{attestation:h,tvf:f,publishMethod:p,prompt:m,tag:g,ttl:y=Re.FIVE_MINUTES}=u,x=u.id||Hd().toString(),w=Fp(PE().protocol),b=p||w.publish,v={id:x,method:b,params:rp(l5(rp({},d),{ttl:y,prompt:m,tag:g,attestation:h}),f)},E=`Failed to publish custom payload, please try again. id:${x} tag:${g}`;try{kr((s=v.params)==null?void 0:s.prompt)&&((i=v.params)==null||delete i.prompt),kr((o=v.params)==null?void 0:o.tag)&&((c=v.params)==null||delete c.tag);const k=new Promise(async C=>{const S=({id:I})=>{var F;((F=v.id)==null?void 0:F.toString())===I.toString()&&(this.removeRequestFromQueue(I),this.relayer.events.removeListener(cr.publish,S),C())};this.relayer.events.on(cr.publish,S);const N=dc(new Promise((I,F)=>{this.rpcPublish(v,u).then(I).catch(P=>{this.logger.warn(P,P==null?void 0:P.message),F(P)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${b} id:${x} tag:${g}`);try{await N,this.events.removeListener(cr.publish,S)}catch(I){this.queue.set(x,{request:v,opts:u,attempt:1}),this.logger.warn(I,I==null?void 0:I.message)}});this.logger.trace({type:"method",method:"publish",params:{id:x,payload:d,opts:u}}),await dc(k,this.publishTimeout,E)}catch(k){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(k),(l=u==null?void 0:u.internal)!=null&&l.throwOnFailedPublish)throw k}finally{this.queue.delete(x)}}),co(this,"on",(r,s)=>{this.events.on(r,s)}),co(this,"once",(r,s)=>{this.events.once(r,s)}),co(this,"off",(r,s)=>{this.events.off(r,s)}),co(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=Ds(n,this.name),this.registerEventListeners()}get context(){return ji(this.logger)}async rpcPublish(e,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(cr.publish,rp(rp({},e),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{var r;const s=e.attempt+1;this.queue.set(n,l5(rp({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Uf.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(cr.connection_stalled);return}this.checkQueue()}),this.relayer.on(cr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var Pbe=Object.defineProperty,Obe=(t,e,n)=>e in t?Pbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sp=(t,e,n)=>Obe(t,typeof e!="symbol"?e+"":e,n);class Dbe{constructor(){sp(this,"map",new Map),sp(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),sp(this,"get",e=>this.map.get(e)||[]),sp(this,"exists",(e,n)=>this.get(e).includes(n)),sp(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),sp(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var Ube=Object.defineProperty,Mbe=Object.defineProperties,Lbe=Object.getOwnPropertyDescriptors,d5=Object.getOwnPropertySymbols,Bbe=Object.prototype.hasOwnProperty,$be=Object.prototype.propertyIsEnumerable,I_=(t,e,n)=>e in t?Ube(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V0=(t,e)=>{for(var n in e||(e={}))Bbe.call(e,n)&&I_(t,n,e[n]);if(d5)for(var n of d5(e))$be.call(e,n)&&I_(t,n,e[n]);return t},fS=(t,e)=>Mbe(t,Lbe(e)),An=(t,e,n)=>I_(t,typeof e!="symbol"?e+"":e,n);class Fbe extends qae{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,An(this,"subscriptions",new Map),An(this,"topicMap",new Dbe),An(this,"events",new Fo.EventEmitter),An(this,"name",Swe),An(this,"version",Twe),An(this,"pending",new Map),An(this,"cached",[]),An(this,"initialized",!1),An(this,"storagePrefix",Tc),An(this,"subscribeTimeout",Re.toMiliseconds(Re.ONE_MINUTE)),An(this,"initialSubscribeTimeout",Re.toMiliseconds(Re.ONE_SECOND*15)),An(this,"clientId"),An(this,"batchSubscribeTopicsLimit",500),An(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),An(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=PE(s),c={topic:r,relay:o,transportType:s==null?void 0:s.transportType};(i=s==null?void 0:s.internal)!=null&&i.skipSubscribe||this.pending.set(r,c);const l=await this.rpcSubscribe(r,o,s);return typeof l=="string"&&(this.onSubscribe(l,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),l}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),An(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),An(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),An(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),An(this,"on",(r,s)=>{this.events.on(r,s)}),An(this,"once",(r,s)=>{this.events.once(r,s)}),An(this,"off",(r,s)=>{this.events.off(r,s)}),An(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),An(this,"start",async()=>{await this.onConnect()}),An(this,"stop",async()=>{await this.onDisconnect()}),An(this,"restart",async()=>{await this.restore(),await this.onRestart()}),An(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),An(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Uf.pulse,async()=>{await this.checkPending()}),this.events.on(Ui.created,async r=>{const s=Ui.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(Ui.deleted,async r=>{const s=Ui.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=Ds(n,this.name),this.clientId=""}get context(){return ji(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=PE(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=Fn("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r==null?void 0:r.internal)!=null&&s.skipSubscribe)return o;(!r||(r==null?void 0:r.transportType)===Pn.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const c={method:Fp(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:c});const l=(i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish;try{if((r==null?void 0:r.transportType)===Pn.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(c).catch(h=>this.logger.warn(h))},Re.toMiliseconds(Re.ONE_SECOND)),o;const d=new Promise(async h=>{const f=p=>{p.topic===e&&(this.events.removeListener(Ui.created,f),h(p.id))};this.events.on(Ui.created,f);try{const p=await dc(new Promise((m,g)=>{this.relayer.request(c).catch(y=>{this.logger.warn(y,y==null?void 0:y.message),g(y)}).then(m)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Ui.created,f),h(p)}catch{}}),u=await dc(d,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&l)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(d){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(cr.connection_stalled),l)throw d}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:Fp(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await dc(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(cr.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:Fp(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await dc(new Promise((i,o)=>{this.relayer.request(r).catch(c=>{this.logger.warn(c),o(c)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(cr.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:Fp(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,fS(V0({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,V0({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,V0({},n)),this.topicMap.set(n.topic,e),this.events.emit(Ui.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=Pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Ui.deleted,fS(V0({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ui.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Ui.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=Pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>fS(V0({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await Rpe(Re.toMiliseconds(Re.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Eo(e+await this.getClientId())}}var zbe=Object.defineProperty,u5=Object.getOwnPropertySymbols,Hbe=Object.prototype.hasOwnProperty,Vbe=Object.prototype.propertyIsEnumerable,j_=(t,e,n)=>e in t?zbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h5=(t,e)=>{for(var n in e||(e={}))Hbe.call(e,n)&&j_(t,n,e[n]);if(u5)for(var n of u5(e))Vbe.call(e,n)&&j_(t,n,e[n]);return t},on=(t,e,n)=>j_(t,typeof e!="symbol"?e+"":e,n);class Wbe extends Vae{constructor(e){super(e),on(this,"protocol","wc"),on(this,"version",2),on(this,"core"),on(this,"logger"),on(this,"events",new Fo.EventEmitter),on(this,"provider"),on(this,"messages"),on(this,"subscriber"),on(this,"publisher"),on(this,"name",vwe),on(this,"transportExplicitlyClosed",!1),on(this,"initialized",!1),on(this,"connectionAttemptInProgress",!1),on(this,"relayUrl"),on(this,"projectId"),on(this,"packageName"),on(this,"bundleId"),on(this,"hasExperiencedNetworkDisruption",!1),on(this,"pingTimeout"),on(this,"heartBeatTimeout",Re.toMiliseconds(Re.THIRTY_SECONDS+Re.FIVE_SECONDS)),on(this,"reconnectTimeout"),on(this,"connectPromise"),on(this,"reconnectInProgress",!1),on(this,"requestsInFlight",[]),on(this,"connectTimeout",Re.toMiliseconds(Re.ONE_SECOND*15)),on(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||Hd().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const c=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==o),c}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),on(this,"resetPingTimeout",()=>{kE()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),on(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),on(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(cr.connect)}),on(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),on(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(cr.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),on(this,"registerProviderListeners",()=>{this.provider.on(ao.payload,this.onPayloadHandler),this.provider.on(ao.connect,this.onConnectHandler),this.provider.on(ao.disconnect,this.onDisconnectHandler),this.provider.on(ao.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ds(e.logger,this.name):nb(qg({level:e.logger||bwe})),this.messages=new Sbe(this.logger,e.core),this.subscriber=new Fbe(this,this.logger),this.publisher=new Rbe(this,this.logger),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||ez,gpe()?this.packageName=tD():ype()&&(this.bundleId=tD()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return ji(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:Pn.relay},p1.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||(n==null?void 0:n.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((r=n==null?void 0:n.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;let c=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",l;const d=u=>{u.topic===e&&(this.subscriber.off(Ui.created,d),l())};return await Promise.all([new Promise(u=>{l=u,this.subscriber.on(Ui.created,d)}),new Promise(async(u,h)=>{c=await this.subscriber.subscribe(e,h5({internal:{throwOnFailedPublish:o}},n)).catch(f=>{o&&h(f)})||c,u()})]),c}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await dc(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await WD())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=Ar(Re.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(cr.message,e),await this.recordMessageEvent(e,p1.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(ao.disconnect,i),await dc(new Promise((o,c)=>{this.provider.connect().then(o).catch(c)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(ao.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,c)=>{const l=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(ao.disconnect,l),await this.subscriber.start().then(o).catch(c).finally(()=>{this.provider.off(ao.disconnect,l)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,Re.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(kE())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new zo(new cwe(Epe({sdkVersion:A_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Rj(e)){if(!e.method.endsWith(Ewe))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,c={topic:r,message:s,publishedAt:i,transportType:Pn.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(h5({type:"event",event:n.id},c)),this.events.emit(n.id,c),await this.acknowledgePayload(e),await this.onMessageEvent(c)}else mN(e)&&this.events.emit(cr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,p1.inbound),this.events.emit(cr.message,e))}async acknowledgePayload(e){const n=rx(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(ao.payload,this.onPayloadHandler),this.provider.off(ao.connect,this.onConnectHandler),this.provider.off(ao.disconnect,this.onDisconnectHandler),this.provider.off(ao.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await WD();lye(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r==null?void 0:r.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Uf.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&hye())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n==null?void 0:n.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(cr.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Re.toMiliseconds(Cwe)))))}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function qbe(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function f5(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function p5(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Kbe="[object RegExp]",Gbe="[object String]",Ybe="[object Number]",Qbe="[object Boolean]",m5="[object Arguments]",Jbe="[object Symbol]",Zbe="[object Date]",Xbe="[object Map]",eve="[object Set]",tve="[object Array]",nve="[object Function]",rve="[object ArrayBuffer]",pS="[object Object]",sve="[object Error]",ive="[object DataView]",ove="[object Uint8Array]",ave="[object Uint8ClampedArray]",cve="[object Uint16Array]",lve="[object Uint32Array]",dve="[object BigUint64Array]",uve="[object Int8Array]",hve="[object Int16Array]",fve="[object Int32Array]",pve="[object BigInt64Array]",mve="[object Float32Array]",gve="[object Float64Array]";function yve(){}function g5(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function wve(t,e,n){return dy(t,e,void 0,void 0,void 0,void 0,n)}function dy(t,e,n,r,s,i,o){const c=o(t,e,n,r,s,i);if(c!==void 0)return c;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Py(t,e,i,o)}return Py(t,e,i,o)}function Py(t,e,n,r){if(Object.is(t,e))return!0;let s=p5(t),i=p5(e);if(s===m5&&(s=pS),i===m5&&(i=pS),s!==i)return!1;switch(s){case Gbe:return t.toString()===e.toString();case Ybe:{const l=t.valueOf(),d=e.valueOf();return qbe(l,d)}case Qbe:case Zbe:case Jbe:return Object.is(t.valueOf(),e.valueOf());case Kbe:return t.source===e.source&&t.flags===e.flags;case nve:return t===e}n=n??new Map;const o=n.get(t),c=n.get(e);if(o!=null&&c!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case Xbe:{if(t.size!==e.size)return!1;for(const[l,d]of t.entries())if(!e.has(l)||!dy(d,e.get(l),l,t,e,n,r))return!1;return!0}case eve:{if(t.size!==e.size)return!1;const l=Array.from(t.values()),d=Array.from(e.values());for(let u=0;u<l.length;u++){const h=l[u],f=d.findIndex(p=>dy(h,p,void 0,t,e,n,r));if(f===-1)return!1;d.splice(f,1)}return!0}case tve:case ove:case ave:case cve:case lve:case dve:case uve:case hve:case fve:case pve:case mve:case gve:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let l=0;l<t.length;l++)if(!dy(t[l],e[l],l,t,e,n,r))return!1;return!0}case rve:return t.byteLength!==e.byteLength?!1:Py(new Uint8Array(t),new Uint8Array(e),n,r);case ive:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Py(new Uint8Array(t),new Uint8Array(e),n,r);case sve:return t.name===e.name&&t.message===e.message;case pS:{if(!(Py(t.constructor,e.constructor,n,r)||g5(t)&&g5(e)))return!1;const l=[...Object.keys(t),...f5(t)],d=[...Object.keys(e),...f5(e)];if(l.length!==d.length)return!1;for(let u=0;u<l.length;u++){const h=l[u],f=t[h];if(!Object.hasOwn(e,h))return!1;const p=e[h];if(!dy(f,p,h,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function xve(t,e){return wve(t,e,yve)}var bve=Object.defineProperty,y5=Object.getOwnPropertySymbols,vve=Object.prototype.hasOwnProperty,Eve=Object.prototype.propertyIsEnumerable,R_=(t,e,n)=>e in t?bve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,w5=(t,e)=>{for(var n in e||(e={}))vve.call(e,n)&&R_(t,n,e[n]);if(y5)for(var n of y5(e))Eve.call(e,n)&&R_(t,n,e[n]);return t},oi=(t,e,n)=>R_(t,typeof e!="symbol"?e+"":e,n);class Bf extends Wae{constructor(e,n,r,s=Tc,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,oi(this,"map",new Map),oi(this,"version",Nwe),oi(this,"cached",[]),oi(this,"initialized",!1),oi(this,"getKey"),oi(this,"storagePrefix",Tc),oi(this,"recentlyDeleted",[]),oi(this,"recentlyDeletedLimit",200),oi(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!kr(o)?this.map.set(this.getKey(o),o):$0e(o)?this.map.set(o.id,o):F0e(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),oi(this,"set",async(o,c)=>{this.isInitialized(),this.map.has(o)?await this.update(o,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:c}),this.map.set(o,c),await this.persist())}),oi(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),oi(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(c=>Object.keys(o).every(l=>xve(c[l],o[l]))):this.values)),oi(this,"update",async(o,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:c});const l=w5(w5({},this.getData(o)),c);this.map.set(o,l),await this.persist()}),oi(this,"delete",async(o,c)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:c}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Ds(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return ji(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=Pe("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=Pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=Pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Cve=Object.defineProperty,Nve=(t,e,n)=>e in t?Cve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$t=(t,e,n)=>Nve(t,typeof e!="symbol"?e+"":e,n);class Ave{constructor(e,n){this.core=e,this.logger=n,$t(this,"name",_we),$t(this,"version",kwe),$t(this,"events",new XI),$t(this,"pairings"),$t(this,"initialized",!1),$t(this,"storagePrefix",Tc),$t(this,"ignoredPayloadTypes",[bl]),$t(this,"registeredMethods",[]),$t(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),$t(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),$t(this,"create",async r=>{this.isInitialized();const s=x_(),i=await this.core.crypto.setSymKey(s),o=Ar(Re.FIVE_MINUTES),c={protocol:X7},l={topic:i,expiry:o,relay:c,active:!1,methods:r==null?void 0:r.methods},d=UD({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:c,expiryTimestamp:o,methods:r==null?void 0:r.methods});return this.events.emit(Ju.create,l),this.core.expirer.set(i,o),await this.pairings.set(i,l),await this.core.relayer.subscribe(i,{transportType:r==null?void 0:r.transportType,internal:r==null?void 0:r.internal}),{topic:i,uri:d}}),$t(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r==null?void 0:r.uri,trace:[$a.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:c,expiryTimestamp:l,methods:d}=DD(r.uri);s.props.properties.topic=i,s.addTrace($a.pairing_uri_validation_success),s.addTrace($a.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace($a.existing_pairing),u.active)throw s.setError(Hc.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace($a.pairing_not_expired)}const h=l||Ar(Re.FIVE_MINUTES),f={topic:i,relay:c,expiry:h,active:!1,methods:d};this.core.expirer.set(i,h),await this.pairings.set(i,f),s.addTrace($a.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(Ju.create,f),s.addTrace($a.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace($a.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Hc.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:c})}catch(p){throw s.setError(Hc.subscribe_pairing_topic_failure),p}return s.addTrace($a.subscribe_pairing_topic_success),f}),$t(this,"activate",async({topic:r})=>{this.isInitialized();const s=Ar(Re.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),$t(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:c,reject:l}=Vu();this.events.once(fn("pairing_ping",i),({error:d})=>{d?l(d):c()}),await o()}}),$t(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),$t(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),$t(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),$t(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Fn("USER_DISCONNECTED")),await this.deletePairing(s))}),$t(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:c}=r,l=this.core.crypto.keychain.get(s);return UD({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:l,relay:i,expiryTimestamp:o,methods:c})}),$t(this,"sendRequest",async(r,s,i)=>{const o=nc(s,i),c=await this.core.crypto.encode(r,o),l=F0[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,c,l),o.id}),$t(this,"sendResult",async(r,s,i)=>{const o=rx(r,i),c=await this.core.crypto.encode(s,o),l=(await this.core.history.get(s,r)).request.method,d=F0[l].res;await this.core.relayer.publish(s,c,d),await this.core.history.resolve(o)}),$t(this,"sendError",async(r,s,i)=>{const o=pN(r,i),c=await this.core.crypto.encode(s,o),l=(await this.core.history.get(s,r)).request.method,d=F0[l]?F0[l].res:F0.unregistered_method.res;await this.core.relayer.publish(s,c,d),await this.core.history.resolve(o)}),$t(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,Fn("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),$t(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>dd(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),$t(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),$t(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),$t(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(Ju.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),$t(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{Ha(s)?this.events.emit(fn("pairing_ping",i),{}):Co(s)&&this.events.emit(fn("pairing_ping",i),{error:s.error})},500)}),$t(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Ju.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),$t(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const c=Fn("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,c),this.logger.error(c)}catch(c){await this.sendError(i,r,c),this.logger.error(c)}}),$t(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(Fn("WC_METHOD_UNSUPPORTED",r))}),$t(this,"isValidPair",(r,s)=>{var i;if(!li(r)){const{message:c}=Pe("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(Hc.malformed_pairing_uri),new Error(c)}if(!B0e(r.uri)){const{message:c}=Pe("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(Hc.malformed_pairing_uri),new Error(c)}const o=DD(r==null?void 0:r.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:c}=Pe("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Hc.malformed_pairing_uri),new Error(c)}if(!(o!=null&&o.symKey)){const{message:c}=Pe("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Hc.malformed_pairing_uri),new Error(c)}if(o!=null&&o.expiryTimestamp&&Re.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(Hc.pairing_expired);const{message:c}=Pe("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(c)}}),$t(this,"isValidPing",async r=>{if(!li(r)){const{message:i}=Pe("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),$t(this,"isValidDisconnect",async r=>{if(!li(r)){const{message:i}=Pe("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),$t(this,"isValidPairingTopic",async r=>{if(!wr(r,!1)){const{message:s}=Pe("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=Pe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(dd(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=Pe("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=Ds(n,this.name),this.pairings=new Bf(this.core,this.logger,this.name,this.storagePrefix)}get context(){return ji(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(cr.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==Pn.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);Rj(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):mN(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(fo.expired,async e=>{const{topic:n}=J9(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Ju.expire,{topic:n}))})}}var Sve=Object.defineProperty,Tve=(t,e,n)=>e in t?Sve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qr=(t,e,n)=>Tve(t,typeof e!="symbol"?e+"":e,n);class _ve extends Fae{constructor(e,n){super(e,n),this.core=e,this.logger=n,Qr(this,"records",new Map),Qr(this,"events",new Fo.EventEmitter),Qr(this,"name",Iwe),Qr(this,"version",jwe),Qr(this,"cached",[]),Qr(this,"initialized",!1),Qr(this,"storagePrefix",Tc),Qr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Qr(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:Ar(Re.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Ko.created,o)}),Qr(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=Co(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Ko.updated,s))}),Qr(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Qr(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Ko.deleted,i)}}),this.persist()}),Qr(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Qr(this,"on",(r,s)=>{this.events.on(r,s)}),Qr(this,"once",(r,s)=>{this.events.once(r,s)}),Qr(this,"off",(r,s)=>{this.events.off(r,s)}),Qr(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Ds(n,this.name)}get context(){return ji(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:nc(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=Pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Ko.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=Pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Ko.created,e=>{const n=Ko.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Ko.updated,e=>{const n=Ko.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Ko.deleted,e=>{const n=Ko.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(Uf.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{Re.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Ko.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var kve=Object.defineProperty,Ive=(t,e,n)=>e in t?kve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Es=(t,e,n)=>Ive(t,typeof e!="symbol"?e+"":e,n);class jve extends Kae{constructor(e,n){super(e,n),this.core=e,this.logger=n,Es(this,"expirations",new Map),Es(this,"events",new Fo.EventEmitter),Es(this,"name",Rwe),Es(this,"version",Pwe),Es(this,"cached",[]),Es(this,"initialized",!1),Es(this,"storagePrefix",Tc),Es(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Es(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Es(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(fo.created,{target:i,expiration:o})}),Es(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),Es(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(fo.deleted,{target:s,expiration:i})}}),Es(this,"on",(r,s)=>{this.events.on(r,s)}),Es(this,"once",(r,s)=>{this.events.once(r,s)}),Es(this,"off",(r,s)=>{this.events.off(r,s)}),Es(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Ds(n,this.name)}get context(){return ji(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Cpe(e);if(typeof e=="number")return Npe(e);const{message:n}=Pe("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(fo.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=Pe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=Pe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;Re.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(fo.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(Uf.pulse,()=>this.checkExpirations()),this.events.on(fo.created,e=>{const n=fo.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(fo.expired,e=>{const n=fo.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(fo.deleted,e=>{const n=fo.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Rve=Object.defineProperty,Pve=(t,e,n)=>e in t?Rve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mr=(t,e,n)=>Pve(t,typeof e!="symbol"?e+"":e,n);class Ove extends Gae{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,mr(this,"name",Owe),mr(this,"abortController"),mr(this,"isDevEnv"),mr(this,"verifyUrlV3",Uwe),mr(this,"storagePrefix",Tc),mr(this,"version",Z7),mr(this,"publicKey"),mr(this,"fetchPromise"),mr(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Re.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),mr(this,"register",async s=>{if(!Zg()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:c}=s,l=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${c}`;try{const d=xf(),u=this.startAbortTimer(Re.ONE_SECOND*5),h=await new Promise((f,p)=>{const m=()=>{window.removeEventListener("message",y),d.body.removeChild(g),p("attestation aborted")};this.abortController.signal.addEventListener("abort",m);const g=d.createElement("iframe");g.src=l,g.style.display="none",g.addEventListener("error",m,{signal:this.abortController.signal});const y=x=>{if(x.data&&typeof x.data=="string")try{const w=JSON.parse(x.data);if(w.type==="verify_attestation"){if(e_(w.attestation).payload.id!==o)return;clearInterval(u),d.body.removeChild(g),this.abortController.signal.removeEventListener("abort",m),window.removeEventListener("message",y),f(w.attestation===null?"":w.attestation)}}catch(w){this.logger.warn(w)}};d.body.appendChild(g),window.addEventListener("message",y,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(d){this.logger.warn(d)}return""}),mr(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:c}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(e_(i).payload.id!==c)return;const d=await this.isValidJwtAttestation(i);if(d){if(!d.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return d}}if(!o)return;const l=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,l)}),mr(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Re.ONE_SECOND*5),c=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),c.status===200?await c.json():void 0}),mr(this,"getVerifyUrl",s=>{let i=s||Ry;return Mwe.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Ry}`),i=Ry),i}),mr(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Re.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),mr(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),mr(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),mr(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(c){this.logger.error(c),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(c){this.logger.error(c),this.logger.warn("error validating attestation")}}),mr(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),mr(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),mr(this,"validateAttestation",(s,i)=>{const o=w0e(s,i.publicKey),c={hasExpired:Re.toMiliseconds(o.exp)<Date.now(),payload:o};if(c.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:c.payload.origin,isScam:c.payload.isScam,isVerified:c.payload.isVerified}}),this.logger=Ds(n,this.name),this.abortController=new AbortController,this.isDevEnv=yj(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return ji(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Re.toMiliseconds(e))}}var Dve=Object.defineProperty,Uve=(t,e,n)=>e in t?Dve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,x5=(t,e,n)=>Uve(t,typeof e!="symbol"?e+"":e,n);class Mve extends Yae{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,x5(this,"context",Lwe),x5(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:c=!1}=r,l=`${Bwe}/${this.projectId}/clients`;await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:c})})}),this.logger=Ds(n,this.context)}}var Lve=Object.defineProperty,b5=Object.getOwnPropertySymbols,Bve=Object.prototype.hasOwnProperty,$ve=Object.prototype.propertyIsEnumerable,P_=(t,e,n)=>e in t?Lve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W0=(t,e)=>{for(var n in e||(e={}))Bve.call(e,n)&&P_(t,n,e[n]);if(b5)for(var n of b5(e))$ve.call(e,n)&&P_(t,n,e[n]);return t},Mr=(t,e,n)=>P_(t,typeof e!="symbol"?e+"":e,n);class Fve extends Qae{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,Mr(this,"context",Fwe),Mr(this,"storagePrefix",Tc),Mr(this,"storageVersion",$we),Mr(this,"events",new Map),Mr(this,"shouldPersist",!1),Mr(this,"init",async()=>{if(!yj())try{const s={eventId:rD(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Y9(this.core.relayer.protocol,this.core.relayer.version,A_)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Mr(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:c,trace:l}}=s,d=rD(),u=this.core.projectId||"",h=Date.now(),f=W0({eventId:d,timestamp:h,props:{event:i,type:o,properties:{topic:c,trace:l}},bundleId:u,domain:this.getAppDomain()},this.setMethods(d));return this.telemetryEnabled&&(this.events.set(d,f),this.shouldPersist=!0),f}),Mr(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const c=Array.from(this.events.values()).find(l=>l.props.properties.topic===o);if(c)return W0(W0({},c),this.setMethods(c.eventId))}),Mr(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Mr(this,"setEventListeners",()=>{this.core.heartbeat.on(Uf.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Re.fromMiliseconds(Date.now())-Re.fromMiliseconds(s.timestamp)>zwe&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Mr(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Mr(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Mr(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Mr(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Mr(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,W0(W0({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Mr(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Mr(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${Hwe}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${A_}${i}`,{method:"POST",body:JSON.stringify(s)})}),Mr(this,"getAppDomain",()=>G9().url),this.logger=Ds(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var zve=Object.defineProperty,v5=Object.getOwnPropertySymbols,Hve=Object.prototype.hasOwnProperty,Vve=Object.prototype.propertyIsEnumerable,O_=(t,e,n)=>e in t?zve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,E5=(t,e)=>{for(var n in e||(e={}))Hve.call(e,n)&&O_(t,n,e[n]);if(v5)for(var n of v5(e))Vve.call(e,n)&&O_(t,n,e[n]);return t},_n=(t,e,n)=>O_(t,typeof e!="symbol"?e+"":e,n);let Wve=class fz extends Mae{constructor(e){var n;super(e),_n(this,"protocol",J7),_n(this,"version",Z7),_n(this,"name",N_),_n(this,"relayUrl"),_n(this,"projectId"),_n(this,"customStoragePrefix"),_n(this,"events",new Fo.EventEmitter),_n(this,"logger"),_n(this,"heartbeat"),_n(this,"relayer"),_n(this,"crypto"),_n(this,"storage"),_n(this,"history"),_n(this,"expirer"),_n(this,"pairing"),_n(this,"verify"),_n(this,"echoClient"),_n(this,"linkModeSupportedApps"),_n(this,"eventClient"),_n(this,"initialized",!1),_n(this,"logChunkController"),_n(this,"on",(c,l)=>this.events.on(c,l)),_n(this,"once",(c,l)=>this.events.once(c,l)),_n(this,"off",(c,l)=>this.events.off(c,l)),_n(this,"removeListener",(c,l)=>this.events.removeListener(c,l)),_n(this,"dispatchEnvelope",({topic:c,message:l,sessionExists:d})=>{if(!c||!l)return;const u={topic:c,message:l,publishedAt:Date.now(),transportType:Pn.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:d})});const r=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(c){console.warn("Failed to copy global core",c)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||ez,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=qg({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:dwe.logger,name:N_}),{logger:i,chunkLoggerController:o}=tj({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var c,l;(c=this.logChunkController)!=null&&c.downloadLogsBlobInBrowser&&((l=this.logChunkController)==null||l.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ds(i,this.name),this.heartbeat=new Aoe,this.crypto=new wbe(this,this.logger,e==null?void 0:e.keychain),this.history=new _ve(this,this.logger),this.expirer=new jve(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new aae(E5(E5({},uwe),e==null?void 0:e.storageOptions)),this.relayer=new Wbe({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ave(this,this.logger),this.verify=new Ove(this,this.logger,this.storage),this.echoClient=new Mve(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Fve(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new fz(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(Awe,r),n}get context(){return ji(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(e5,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(e5)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&lwe.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const qve=Wve,pz="wc",mz=2,gz="client",Pj=`${pz}@${mz}:${gz}:`,mS={name:gz,logger:"error"},C5="WALLETCONNECT_DEEPLINK_CHOICE",Kve="proposal",N5="Proposal expired",Gve="session",ip=Re.SEVEN_DAYS,Yve="engine",Jr={wc_sessionPropose:{req:{ttl:Re.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Re.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Re.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Re.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Re.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Re.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Re.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Re.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Re.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Re.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Re.FIVE_MINUTES,prompt:!1,tag:1119}}},gS={min:Re.FIVE_MINUTES,max:Re.SEVEN_DAYS},La={idle:"IDLE",active:"ACTIVE"},Qve={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Jve="request",Zve=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Xve="wc",e1e="auth",t1e="authKeys",n1e="pairingTopics",r1e="requests",yN=`${Xve}@${1.5}:${e1e}:`,m1=`${yN}:PUB_KEY`;var s1e=Object.defineProperty,i1e=Object.defineProperties,o1e=Object.getOwnPropertyDescriptors,A5=Object.getOwnPropertySymbols,a1e=Object.prototype.hasOwnProperty,c1e=Object.prototype.propertyIsEnumerable,D_=(t,e,n)=>e in t?s1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yn=(t,e)=>{for(var n in e||(e={}))a1e.call(e,n)&&D_(t,n,e[n]);if(A5)for(var n of A5(e))c1e.call(e,n)&&D_(t,n,e[n]);return t},Cs=(t,e)=>i1e(t,o1e(e)),Ee=(t,e,n)=>D_(t,typeof e!="symbol"?e+"":e,n);class l1e extends ece{constructor(e){super(e),Ee(this,"name",Yve),Ee(this,"events",new XI),Ee(this,"initialized",!1),Ee(this,"requestQueue",{state:La.idle,queue:[]}),Ee(this,"sessionRequestQueue",{state:La.idle,queue:[]}),Ee(this,"emittedSessionRequests",new Ppe({limit:500})),Ee(this,"requestQueueDelay",Re.ONE_SECOND),Ee(this,"expectedPairingMethodMap",new Map),Ee(this,"recentlyDeletedMap",new Map),Ee(this,"recentlyDeletedLimit",200),Ee(this,"relayMessageCache",[]),Ee(this,"pendingSessions",new Map),Ee(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Jr)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Re.toMiliseconds(this.requestQueueDelay)))}),Ee(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=Cs(yn({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=O0e(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:c,scopedProperties:l,relays:d}=r;let u=s,h,f=!1;try{if(u){const k=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),f=k.active}}catch(k){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),k}if(!u||!f){const{topic:k,uri:C}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=k,h=C}if(!u){const{message:k}=Pe("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(k)}const p=await this.client.core.crypto.generateKeyPair(),m=Jr.wc_sessionPropose.req.ttl||Re.FIVE_MINUTES,g=Ar(m),y=Cs(yn(yn({requiredNamespaces:i,optionalNamespaces:o,relays:d??[{protocol:X7}],proposer:{publicKey:p,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:za()}),x=fn("session_connect",y.id),{reject:w,resolve:b,done:v}=Vu(m,N5),E=({id:k})=>{k===y.id&&(this.client.events.off("proposal_expire",E),this.pendingSessions.delete(y.id),this.events.emit(x,{error:{message:N5,code:0}}))};return this.client.events.on("proposal_expire",E),this.events.once(x,({error:k,session:C})=>{this.client.events.off("proposal_expire",E),k?w(k):C&&b(C)}),await this.sendProposeSession({proposal:y,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:y.id}}}),await this.setProposal(y.id,y),{uri:h,approval:v}}),Ee(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),Ee(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n==null?void 0:n.id)==null?void 0:r.toString(),trace:[rd.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(N){throw o.setError(z0.no_internet_connection),N}try{await this.isValidProposalId(n==null?void 0:n.id)}catch(N){throw this.client.logger.error(`approve() -> proposal.get(${n==null?void 0:n.id}) failed`),o.setError(z0.proposal_not_found),N}try{await this.isValidApprove(n)}catch(N){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(z0.session_approve_namespace_validation_failure),N}const{id:c,relayProtocol:l,namespaces:d,sessionProperties:u,scopedProperties:h,sessionConfig:f}=n,p=this.client.proposal.get(c);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:m,proposer:g,requiredNamespaces:y,optionalNamespaces:x}=p;let w=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:m});w||(w=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:rd.session_approve_started,properties:{topic:m,trace:[rd.session_approve_started,rd.session_namespaces_validation_success]}}));const b=await this.client.core.crypto.generateKeyPair(),v=g.publicKey,E=await this.client.core.crypto.generateSharedKey(b,v),k=yn(yn(yn({relay:{protocol:l??"irn"},namespaces:d,controller:{publicKey:b,metadata:this.client.metadata},expiry:Ar(ip)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),C=Pn.relay;w.addTrace(rd.subscribing_session_topic);try{await this.client.core.relayer.subscribe(E,{transportType:C,internal:{skipSubscribe:!0}})}catch(N){throw w.setError(z0.subscribe_session_topic_failure),N}w.addTrace(rd.subscribe_session_topic_success);const S=Cs(yn({},k),{topic:E,requiredNamespaces:y,optionalNamespaces:x,pairingTopic:m,acknowledged:!1,self:k.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:b,transportType:Pn.relay});await this.client.session.set(E,S),w.addTrace(rd.store_session);try{await this.sendApproveSession({sessionTopic:E,proposal:p,pairingProposalResponse:{relay:{protocol:l??"irn"},responderPublicKey:b},sessionSettleRequest:k,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:c}}}),w.addTrace(rd.session_approve_publish_success)}catch(N){throw this.client.logger.error(N),this.client.session.delete(E,Fn("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(E),N}return this.client.core.eventClient.deleteEvent({eventId:w.eventId}),await this.client.core.pairing.updateMetadata({topic:m,metadata:g.metadata}),await this.deleteProposal(c),await this.client.core.pairing.activate({topic:m}),await this.setExpiry(E,Ar(ip)),{topic:E,acknowledged:()=>Promise.resolve(this.client.session.get(E))}}),Ee(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Jr.wc_sessionPropose.reject}),await this.deleteProposal(r)}),Ee(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:c}=Vu(),l=za(),d=Hd().toString(),u=this.client.session.get(r).namespaces;return this.events.once(fn("session_update",l),({error:h})=>{h?c(h):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:l,relayRpcId:d}).catch(h=>{this.client.logger.error(h),this.client.session.update(r,{namespaces:u}),c(h)}),{acknowledged:i}}),Ee(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(l){throw this.client.logger.error("extend() -> isValidExtend() failed"),l}const{topic:r}=n,s=za(),{done:i,resolve:o,reject:c}=Vu();return this.events.once(fn("session_extend",s),({error:l})=>{l?c(l):o()}),await this.setExpiry(r,Ar(ip)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(l=>{c(l)}),{acknowledged:i}}),Ee(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(y){throw this.client.logger.error("request() -> isValidRequest() failed"),y}const{chainId:r,request:s,topic:i,expiry:o=Jr.wc_sessionRequest.req.ttl}=n,c=this.client.session.get(i);(c==null?void 0:c.transportType)===Pn.relay&&await this.confirmOnlineStateOrThrow();const l=za(),d=Hd().toString(),{done:u,resolve:h,reject:f}=Vu(o,"Request expired. Please try again.");this.events.once(fn("session_request",l),({error:y,result:x})=>{y?f(y):h(x)});const p="wc_sessionRequest",m=this.getAppLinkIfEnabled(c.peer.metadata,c.transportType);if(m)return await this.sendRequest({clientRpcId:l,relayRpcId:d,topic:i,method:p,params:{request:Cs(yn({},s),{expiryTimestamp:Ar(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:m}).catch(y=>f(y)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:l}),await u();const g={request:Cs(yn({},s),{expiryTimestamp:Ar(o)}),chainId:r};return await Promise.all([new Promise(async y=>{await this.sendRequest({clientRpcId:l,relayRpcId:d,topic:i,method:p,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(l,g)}).catch(x=>f(x)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:l}),y()}),new Promise(async y=>{var x;if(!((x=c.sessionConfig)!=null&&x.disableDeepLink)){const w=await _pe(this.client.core.storage,C5);await Ape({id:l,topic:i,wcDeepLink:w})}y()}),u()]).then(y=>y[2])}),Ee(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===Pn.relay&&await this.confirmOnlineStateOrThrow();const c=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Ha(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:c}):Co(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:c}),this.cleanupAfterResponse(n)}),Ee(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=za(),i=Hd().toString(),{done:o,resolve:c,reject:l}=Vu();this.events.once(fn("session_ping",s),({error:d})=>{d?l(d):c()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),Ee(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=Hd().toString(),c=za();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:c})}),Ee(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:Fn("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=Pe("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),Ee(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>M0e(r,n)))),Ee(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),Ee(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Pn.link_mode:Pn.relay;o===Pn.relay&&await this.confirmOnlineStateOrThrow();const{chains:c,statement:l="",uri:d,domain:u,nonce:h,type:f,exp:p,nbf:m,methods:g=[],expiry:y}=n,x=[...n.resources||[]],{topic:w,uri:b}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:b}});const v=await this.client.core.crypto.generateKeyPair(),E=f1(v);if(await Promise.all([this.client.auth.authKeys.set(m1,{responseTopic:E,publicKey:v}),this.client.auth.pairingTopics.set(E,{topic:E,pairingTopic:w})]),await this.client.core.relayer.subscribe(E,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${w}`),g.length>0){const{namespace:M}=Jh(c[0]);let B=Vme(M,"request",g);h1(x)&&(B=qme(B,x.pop())),x.push(B)}const k=y&&y>Jr.wc_sessionAuthenticate.req.ttl?y:Jr.wc_sessionAuthenticate.req.ttl,C={authPayload:{type:f??"caip122",chains:c,statement:l,aud:d,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:p,nbf:m,resources:x},requester:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:Ar(k)},S={eip155:{chains:c,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},N={requiredNamespaces:{},optionalNamespaces:S,relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:Ar(Jr.wc_sessionPropose.req.ttl),id:za()},{done:I,resolve:F,reject:P}=Vu(k,"Request expired"),H=za(),z=fn("session_connect",N.id),T=fn("session_request",H),_=async({error:M,session:B})=>{this.events.off(T,L),M?P(M):B&&F({session:B})},L=async M=>{var B,W,Z;if(await this.deletePendingAuthRequest(H,{message:"fulfilled",code:0}),M.error){const Ue=Fn("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return M.error.code===Ue.code?void 0:(this.events.off(z,_),P(M.error.message))}await this.deleteProposal(N.id),this.events.off(z,_);const{cacaos:ie,responder:ae}=M.result,oe=[],Ne=[];for(const Ue of ie){await pD({cacao:Ue,projectId:this.client.core.projectId})||(this.client.logger.error(Ue,"Signature verification failed"),P(Fn("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:ee}=Ue,q=h1(ee.resources),ue=[d_(ee.iss)],Ae=IE(ee.iss);if(q){const tt=mD(q),me=gD(q);oe.push(...tt),ue.push(...me)}for(const tt of ue)Ne.push(`${tt}:${Ae}`)}const de=await this.client.core.crypto.generateSharedKey(v,ae.publicKey);let _e;oe.length>0&&(_e={topic:de,acknowledged:!0,self:{publicKey:v,metadata:this.client.metadata},peer:ae,controller:ae.publicKey,expiry:Ar(ip),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:$D([...new Set(oe)],[...new Set(Ne)]),transportType:o},await this.client.core.relayer.subscribe(de,{transportType:o}),await this.client.session.set(de,_e),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:ae.metadata}),_e=this.client.session.get(de)),(B=this.client.metadata.redirect)!=null&&B.linkMode&&(W=ae.metadata.redirect)!=null&&W.linkMode&&(Z=ae.metadata.redirect)!=null&&Z.universal&&r&&(this.client.core.addLinkModeSupportedApp(ae.metadata.redirect.universal),this.client.session.update(de,{transportType:Pn.link_mode})),F({auths:ie,session:_e})};this.events.once(z,_),this.events.once(T,L);let O;try{if(i){const M=nc("wc_sessionAuthenticate",C,H);this.client.core.history.set(w,M);const B=await this.client.core.crypto.encode("",M,{type:lb,encoding:wd});O=xv(r,w,B)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:C,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:H}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:N,expiry:Jr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:N.id})])}catch(M){throw this.events.off(z,_),this.events.off(T,L),M}return await this.setProposal(N.id,N),await this.setAuthRequest(H,{request:Cs(yn({},C),{verifyContext:{}}),pairingTopic:w,transportType:o}),{uri:O??b,response:I}}),Ee(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Du.authenticated_session_approve_started]}});try{this.isInitialized()}catch(y){throw i.setError(H0.no_internet_connection),y}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(H0.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const c=o.transportType||Pn.relay;c===Pn.relay&&await this.confirmOnlineStateOrThrow();const l=o.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),u=f1(l),h={type:bl,receiverPublicKey:l,senderPublicKey:d},f=[],p=[];for(const y of s){if(!await pD({cacao:y,projectId:this.client.core.projectId})){i.setError(H0.invalid_cacao);const E=Fn("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:E,encodeOpts:h}),new Error(E.message)}i.addTrace(Du.cacaos_verified);const{p:x}=y,w=h1(x.resources),b=[d_(x.iss)],v=IE(x.iss);if(w){const E=mD(w),k=gD(w);f.push(...E),b.push(...k)}for(const E of b)p.push(`${E}:${v}`)}const m=await this.client.core.crypto.generateSharedKey(d,l);i.addTrace(Du.create_authenticated_session_topic);let g;if((f==null?void 0:f.length)>0){g={topic:m,acknowledged:!0,self:{publicKey:d,metadata:this.client.metadata},peer:{publicKey:l,metadata:o.requester.metadata},controller:l,expiry:Ar(ip),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:$D([...new Set(f)],[...new Set(p)]),transportType:c},i.addTrace(Du.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(m,{transportType:c})}catch(y){throw i.setError(H0.subscribe_authenticated_session_topic_failure),y}i.addTrace(Du.subscribe_authenticated_session_topic_success),await this.client.session.set(m,g),i.addTrace(Du.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Du.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:d,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,c)})}catch(y){throw i.setError(H0.authenticated_session_approve_publish_failure),y}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),Ee(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Pn.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),l=f1(o),d={type:bl,receiverPublicKey:o,senderPublicKey:c};await this.sendError({id:r,topic:l,error:s,encodeOpts:d,rpcOpts:Jr.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),Ee(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return h7(r,s)}),Ee(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),Ee(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,c;return((o=i.peerMetadata)==null?void 0:o.url)&&((c=i.peerMetadata)==null?void 0:c.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),Ee(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:c=0}=n,{self:l}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Fn("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(l.publicKey)&&await this.client.core.crypto.deleteKeyPair(l.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(C5).catch(d=>this.client.logger.warn(d)),this.getPendingSessionRequests().forEach(d=>{d.topic===s&&this.deletePendingSessionRequest(d.id,Fn("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=La.idle),o&&this.client.events.emit("session_delete",{id:c,topic:s})}),Ee(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(z0.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,Fn("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),Ee(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=La.idle,this.client.events.emit("session_request_expire",{id:n}))}),Ee(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),Ee(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),Ee(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,Ar(Jr.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),Ee(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=Pn.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),Ee(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,c=i.request.expiryTimestamp||Ar(Jr.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,c),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),Ee(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:c,clientRpcId:l,throwOnFailedPublish:d,appLink:u,tvf:h,publishOpts:f={}}=n,p=nc(s,i,l);let m;const g=!!u;try{const w=g?wd:yi;m=await this.client.core.crypto.encode(r,p,{encoding:w})}catch(w){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),w}let y;if(Zve.includes(s)){const w=Eo(JSON.stringify(p)),b=Eo(m);y=await this.client.core.verify.register({id:b,decryptedId:w})}const x=yn(yn({},Jr[s].req),f);if(x.attestation=y,o&&(x.ttl=o),c&&(x.id=c),this.client.core.history.set(r,p),g){const w=xv(u,r,m);await global.Linking.openURL(w,this.client.name)}else x.tvf=Cs(yn({},h),{correlationId:p.id}),d?(x.internal=Cs(yn({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,m,x)):this.client.core.relayer.publish(r,m,x).catch(w=>this.client.logger.error(w));return p.id}),Ee(this,"sendProposeSession",async n=>{const{proposal:r,publishOpts:s}=n,i=nc("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:yi}),c=Eo(JSON.stringify(i)),l=Eo(o),d=await this.client.core.verify.register({id:l,decryptedId:c});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:Cs(yn({},s),{publishMethod:"wc_proposeSession",attestation:d})})}),Ee(this,"sendApproveSession",async n=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:c}=n,l=rx(i.id,s),d=await this.client.core.crypto.encode(i.pairingTopic,l,{encoding:yi}),u=nc("wc_sessionSettle",o,c==null?void 0:c.id),h=await this.client.core.crypto.encode(r,u,{encoding:yi});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:d,sessionSettlementRequest:h},opts:Cs(yn({},c),{publishMethod:"wc_approveSession"})})}),Ee(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:c,appLink:l}=n,d=rx(r,i);let u;const h=l&&typeof(global==null?void 0:global.Linking)<"u";try{const m=h?wd:yi;u=await this.client.core.crypto.encode(s,d,Cs(yn({},c||{}),{encoding:m}))}catch(m){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),m}let f,p;try{f=await this.client.core.history.get(s,r);const m=f.request;try{p=this.getTVFParams(r,m.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(m){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),m}if(h){const m=xv(l,s,u);await global.Linking.openURL(m,this.client.name)}else{const m=f.request.method,g=Jr[m].res;g.tvf=Cs(yn({},p),{correlationId:r}),o?(g.internal=Cs(yn({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(y=>this.client.logger.error(y))}await this.client.core.history.resolve(d)}),Ee(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:c,appLink:l}=n,d=pN(r,i);let u;const h=l&&typeof(global==null?void 0:global.Linking)<"u";try{const p=h?wd:yi;u=await this.client.core.crypto.encode(s,d,Cs(yn({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),p}let f;try{f=await this.client.core.history.get(s,r)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),p}if(h){const p=xv(l,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=f.request.method,m=c||Jr[p].res;this.client.core.relayer.publish(s,u,m)}await this.client.core.history.resolve(d)}),Ee(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;dd(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{dd(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),Ee(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),Ee(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),Ee(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===La.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=La.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=La.idle}),Ee(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:c}=n,l=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:l}))switch(l){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:c});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:c,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:c,transportType:o});default:return this.client.logger.info(`Unsupported request method ${l}`)}}),Ee(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),Ee(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=Pe("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),Ee(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),Ee(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:c,id:l}=s;try{const d=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),d==null||d.setError(Hc.proposal_listener_not_found)),this.isValidConnect(yn({},s.params));const u=c.expiryTimestamp||Ar(Jr.wc_sessionPropose.req.ttl),h=yn({id:l,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},c);await this.setProposal(l,h);const f=await this.getVerifyContext({attestationId:i,hash:Eo(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});d==null||d.addTrace($a.emit_session_proposal),this.client.events.emit("session_proposal",{id:l,params:h,verifyContext:f})}catch(d){await this.sendError({id:l,topic:r,error:d,rpcOpts:Jr.wc_sessionPropose.autoReject}),this.client.logger.error(d)}}),Ee(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(Ha(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const c=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:c});const l=c.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l});const d=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:d});const u=await this.client.core.crypto.generateSharedKey(l,d);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:l});const h=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:n})}else if(Co(r)){await this.deleteProposal(i);const o=fn("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),Ee(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:c,expiry:l,namespaces:d,sessionProperties:u,scopedProperties:h,sessionConfig:f}=r.params,p=[...this.pendingSessions.values()].find(y=>y.sessionTopic===n);if(!p)return this.client.logger.error(`Pending session not found for topic ${n}`);const m=this.client.proposal.get(p.proposalId),g=Cs(yn(yn(yn({topic:n,relay:o,expiry:l,namespaces:d,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces,controller:c.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),{transportType:Pn.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(fn("session_connect",p.proposalId),{session:g}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),Ee(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;Ha(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(fn("session_approve",s),{})):Co(r)&&(await this.client.session.delete(n,Fn("USER_DISCONNECTED")),this.events.emit(fn("session_approve",s),{error:r.error}))}),Ee(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,c=$0.get(o);if(c&&this.isRequestOutOfSync(c,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:Fn("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(yn({topic:n},s));try{$0.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(l){throw $0.delete(o),l}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),Ee(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),Ee(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=fn("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ha(r)?this.events.emit(fn("session_update",s),{}):Co(r)&&this.events.emit(fn("session_update",s),{error:r.error})}),Ee(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,Ar(ip)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),Ee(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=fn("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ha(r)?this.events.emit(fn("session_extend",s),{}):Co(r)&&this.events.emit(fn("session_extend",s),{error:r.error})}),Ee(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),Ee(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=fn("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Ha(r)?this.events.emit(fn("session_ping",s),{}):Co(r)&&this.events.emit(fn("session_ping",s),{error:r.error})},500)}),Ee(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),await Promise.all([new Promise(i=>{this.client.core.relayer.once(cr.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:Fn("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),Ee(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:c,attestation:l,encryptedId:d,transportType:u}=n,{id:h,params:f}=c;try{await this.isValidRequest(yn({topic:o},f));const p=this.client.session.get(o),m=await this.getVerifyContext({attestationId:l,hash:Eo(JSON.stringify(nc("wc_sessionRequest",f,h))),encryptedId:d,metadata:p.peer.metadata,transportType:u}),g={id:h,topic:o,params:f,verifyContext:m};await this.setPendingSessionRequest(g),u===Pn.link_mode&&(r=p.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=p.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(p){await this.sendError({id:h,topic:o,error:p}),this.client.logger.error(p)}}),Ee(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=fn("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ha(r)?this.events.emit(fn("session_request",s),{result:r.result}):Co(r)&&this.events.emit(fn("session_request",s),{error:r.error})}),Ee(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,c=$0.get(o);if(c&&this.isRequestOutOfSync(c,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(yn({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),$0.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),Ee(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),Ha(r)?this.events.emit(fn("session_request",s),{result:r.result}):Co(r)&&this.events.emit(fn("session_request",s),{error:r.error})}),Ee(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:c,transportType:l}=n;try{const{requester:d,authPayload:u,expiryTimestamp:h}=i.params,f=await this.getVerifyContext({attestationId:o,hash:Eo(JSON.stringify(i)),encryptedId:c,metadata:d.metadata,transportType:l}),p={requester:d,pairingTopic:s,id:i.id,authPayload:u,verifyContext:f,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:p,pairingTopic:s,transportType:l}),l===Pn.link_mode&&(r=d.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(d.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:f})}catch(d){this.client.logger.error(d);const u=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),f=this.getAppLinkIfEnabled(i.params.requester.metadata,l),p={type:bl,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:d,encodeOpts:p,rpcOpts:Jr.wc_sessionAuthenticate.autoReject,appLink:f})}}),Ee(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),Ee(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=La.idle,this.processSessionRequestQueue()},Re.toMiliseconds(this.requestQueueDelay))}),Ee(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,c=fn("session_request",o);if(this.events.listenerCount(c)===0)throw new Error(`emitting ${c} without any listeners`);this.events.emit(fn("session_request",i.request.id),{error:r})})}),Ee(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===La.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),Ee(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=La.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),Ee(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:nc("wc_sessionPropose",Cs(yn({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),Ee(this,"isValidConnect",async n=>{if(!li(n)){const{message:d}=Pe("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(d)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:c,relays:l}=n;if(kr(r)||await this.isValidPairingTopic(r),!Y0e(l)){const{message:d}=Pe("MISSING_OR_INVALID",`connect() relays: ${l}`);throw new Error(d)}if(!kr(s)&&bc(s)!==0){const d="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(d):this.client.logger.warn(d),this.validateNamespaces(s,"requiredNamespaces")}if(!kr(i)&&bc(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),kr(o)||this.validateSessionProps(o,"sessionProperties"),!kr(c)){this.validateSessionProps(c,"scopedProperties");const d=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(c).every(u=>d.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(c)}, required/optional namespaces: ${JSON.stringify(d)}`)}}),Ee(this,"validateNamespaces",(n,r)=>{const s=G0e(n,"connect()",r);if(s)throw new Error(s.message)}),Ee(this,"isValidApprove",async n=>{if(!li(n))throw new Error(Pe("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:c}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const l=this.client.proposal.get(r),d=dS(s,"approve()");if(d)throw new Error(d.message);const u=HD(l.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!wr(i,!0)){const{message:h}=Pe("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(kr(o)||this.validateSessionProps(o,"sessionProperties"),!kr(c)){this.validateSessionProps(c,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(c).every(f=>h.has(f.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(c)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),Ee(this,"isValidReject",async n=>{if(!li(n)){const{message:i}=Pe("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!J0e(s)){const{message:i}=Pe("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),Ee(this,"isValidSessionSettleRequest",n=>{if(!li(n)){const{message:d}=Pe("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(d)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!H7(r)){const{message:d}=Pe("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(d)}const c=z0e(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);const l=dS(i,"onSessionSettleRequest()");if(l)throw new Error(l.message);if(dd(o)){const{message:d}=Pe("EXPIRED","onSessionSettleRequest()");throw new Error(d)}}),Ee(this,"isValidUpdate",async n=>{if(!li(n)){const{message:l}=Pe("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(l)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=dS(s,"update()");if(o)throw new Error(o.message);const c=HD(i.requiredNamespaces,s,"update()");if(c)throw new Error(c.message)}),Ee(this,"isValidExtend",async n=>{if(!li(n)){const{message:s}=Pe("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),Ee(this,"isValidRequest",async n=>{if(!li(n)){const{message:l}=Pe("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(l)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:c}=this.client.session.get(r);if(!zD(c,i)){const{message:l}=Pe("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(l)}if(!Z0e(s)){const{message:l}=Pe("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(l)}if(!tye(c,i,s.method)){const{message:l}=Pe("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(l)}if(o&&!iye(o,gS)){const{message:l}=Pe("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${gS.min} and ${gS.max}`);throw new Error(l)}}),Ee(this,"isValidRespond",async n=>{var r;if(!li(n)){const{message:o}=Pe("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n==null?void 0:n.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!X0e(i)){const{message:o}=Pe("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),Ee(this,"isValidPing",async n=>{if(!li(n)){const{message:s}=Pe("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),Ee(this,"isValidEmit",async n=>{if(!li(n)){const{message:c}=Pe("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(c)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!zD(o,i)){const{message:c}=Pe("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(c)}if(!eye(s)){const{message:c}=Pe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(c)}if(!nye(o,i,s.name)){const{message:c}=Pe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(c)}}),Ee(this,"isValidDisconnect",async n=>{if(!li(n)){const{message:s}=Pe("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),Ee(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!wr(s,!1))throw new Error("uri is required parameter");if(!wr(i,!1))throw new Error("domain is required parameter");if(!wr(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(l=>Jh(l).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:c}=Jh(r[0]);if(c!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),Ee(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:c}=n,l={verified:{verifyUrl:o.verifyUrl||Ry,validation:"UNKNOWN",origin:o.url||""}};try{if(c===Pn.link_mode){const u=this.getAppLinkIfEnabled(o,c);return l.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",l}const d=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});d&&(l.verified.origin=d.origin,l.verified.isScam=d.isScam,l.verified.validation=d.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(d){this.client.logger.warn(d)}return this.client.logger.debug(`Verify context: ${JSON.stringify(l)}`),l}),Ee(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=Pe("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),Ee(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),Ee(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),Ee(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=Pe("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),Ee(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,c,l,d,u,h,f;return!n||r!==Pn.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((c=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:c.universal)!==void 0&&((d=(l=this.client.metadata)==null?void 0:l.redirect)==null?void 0:d.universal)!==""&&((u=n==null?void 0:n.redirect)==null?void 0:u.universal)!==void 0&&((h=n==null?void 0:n.redirect)==null?void 0:h.universal)!==""&&((f=n==null?void 0:n.redirect)==null?void 0:f.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),Ee(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n==null?void 0:n.redirect)==null?void 0:s.universal:void 0}),Ee(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=nD(n,"topic")||"",s=decodeURIComponent(nD(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Pn.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),Ee(this,"registerLinkModeListeners",async()=>{var n;if(yj()||Nu()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),Ee(this,"getTVFParams",(n,r,s)=>{var i,o,c;if(!((i=r.request)!=null&&i.method))return{};const l={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const d=this.extractTxHashesFromResult(r.request,s);l.txHashes=d,l.contractAddresses=this.isValidContractData(r.request.params)?[(c=(o=r.request.params)==null?void 0:o[0])==null?void 0:c.to]:[]}catch(d){this.client.logger.warn("Error getting TVF params",d)}return l}),Ee(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=(n==null?void 0:n.data)||((r=n==null?void 0:n[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),Ee(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=Qve[i];if(i==="sui_signTransaction")return[_me(r.transactionBytes)];if(i==="near_signTransaction")return[dD(r)];if(i==="near_signTransactions")return r.map(l=>dD(l));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[bye({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return vl(r)?r.map(l=>uD(l)):[uD(r)];if(i==="cosmos_signDirect")return[Ime(r)];if(typeof r=="string")return[r];const c=r[o.key];if(vl(c))return i==="solana_signAllTransactions"?c.map(l=>Tme(l)):c;if(typeof c=="string")return[c]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=Pe("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(cr.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(m1)?this.client.auth.authKeys.get(m1):{publicKey:void 0};try{const c=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===Pn.link_mode?wd:yi});Rj(c)?(this.client.core.history.set(n,c),await this.onRelayEventRequest({topic:n,payload:c,attestation:s,transportType:i,encryptedId:Eo(r)})):mN(c)?(await this.client.core.history.resolve(c),await this.onRelayEventResponse({topic:n,payload:c,transportType:i}),this.client.core.history.delete(n,c.id)):await this.onRelayEventUnknownPayload({topic:n,payload:c,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(c){this.client.logger.error(c)}}registerExpirerEvents(){this.client.core.expirer.on(fo.expired,async e=>{const{topic:n,id:r}=J9(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,Pe("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,Pe("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ju.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Ju.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!wr(e,!1)){const{message:n}=Pe("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=Pe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(dd(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=Pe("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!wr(e,!1)){const{message:n}=Pe("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=Pe("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(dd(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=Pe("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=Pe("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(wr(e,!1)){const{message:n}=Pe("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=Pe("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!Q0e(e)){const{message:n}=Pe("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=Pe("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(dd(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=Pe("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}}class d1e extends Bf{constructor(e,n){super(e,n,Kve,Pj),this.core=e,this.logger=n}}let u1e=class extends Bf{constructor(e,n){super(e,n,Gve,Pj),this.core=e,this.logger=n}};class h1e extends Bf{constructor(e,n){super(e,n,Jve,Pj,r=>r.id),this.core=e,this.logger=n}}class f1e extends Bf{constructor(e,n){super(e,n,t1e,yN,()=>m1),this.core=e,this.logger=n}}class p1e extends Bf{constructor(e,n){super(e,n,n1e,yN),this.core=e,this.logger=n}}class m1e extends Bf{constructor(e,n){super(e,n,r1e,yN,r=>r.id),this.core=e,this.logger=n}}var g1e=Object.defineProperty,y1e=(t,e,n)=>e in t?g1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yS=(t,e,n)=>y1e(t,typeof e!="symbol"?e+"":e,n);class w1e{constructor(e,n){this.core=e,this.logger=n,yS(this,"authKeys"),yS(this,"pairingTopics"),yS(this,"requests"),this.authKeys=new f1e(this.core,this.logger),this.pairingTopics=new p1e(this.core,this.logger),this.requests=new m1e(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var x1e=Object.defineProperty,b1e=(t,e,n)=>e in t?x1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ft=(t,e,n)=>b1e(t,typeof e!="symbol"?e+"":e,n);let v1e=class yz extends Xae{constructor(e){super(e),Ft(this,"protocol",pz),Ft(this,"version",mz),Ft(this,"name",mS.name),Ft(this,"metadata"),Ft(this,"core"),Ft(this,"logger"),Ft(this,"events",new Fo.EventEmitter),Ft(this,"engine"),Ft(this,"session"),Ft(this,"proposal"),Ft(this,"pendingRequest"),Ft(this,"auth"),Ft(this,"signConfig"),Ft(this,"on",(r,s)=>this.events.on(r,s)),Ft(this,"once",(r,s)=>this.events.once(r,s)),Ft(this,"off",(r,s)=>this.events.off(r,s)),Ft(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Ft(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Ft(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Ft(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Ft(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||mS.name,this.metadata=xpe(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const n=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nb(qg({level:(e==null?void 0:e.logger)||mS.logger}));this.core=(e==null?void 0:e.core)||new qve(e),this.logger=Ds(n,this.name),this.session=new u1e(this.core,this.logger),this.proposal=new d1e(this.core,this.logger),this.pendingRequest=new h1e(this.core,this.logger),this.engine=new l1e(this),this.auth=new w1e(this.core,this.logger)}static async init(e){const n=new yz(e);return await n.initialize(),n}get context(){return ji(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var U_={exports:{}};(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof tc<"u"&&tc,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var c=typeof i<"u"&&i||typeof self<"u"&&self||typeof tc<"u"&&tc||{},l={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function d(T){return T&&DataView.prototype.isPrototypeOf(T)}if(l.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(T){return T&&u.indexOf(Object.prototype.toString.call(T))>-1};function f(T){if(typeof T!="string"&&(T=String(T)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(T)||T==="")throw new TypeError('Invalid character in header field name: "'+T+'"');return T.toLowerCase()}function p(T){return typeof T!="string"&&(T=String(T)),T}function m(T){var _={next:function(){var L=T.shift();return{done:L===void 0,value:L}}};return l.iterable&&(_[Symbol.iterator]=function(){return _}),_}function g(T){this.map={},T instanceof g?T.forEach(function(_,L){this.append(L,_)},this):Array.isArray(T)?T.forEach(function(_){if(_.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+_.length);this.append(_[0],_[1])},this):T&&Object.getOwnPropertyNames(T).forEach(function(_){this.append(_,T[_])},this)}g.prototype.append=function(T,_){T=f(T),_=p(_);var L=this.map[T];this.map[T]=L?L+", "+_:_},g.prototype.delete=function(T){delete this.map[f(T)]},g.prototype.get=function(T){return T=f(T),this.has(T)?this.map[T]:null},g.prototype.has=function(T){return this.map.hasOwnProperty(f(T))},g.prototype.set=function(T,_){this.map[f(T)]=p(_)},g.prototype.forEach=function(T,_){for(var L in this.map)this.map.hasOwnProperty(L)&&T.call(_,this.map[L],L,this)},g.prototype.keys=function(){var T=[];return this.forEach(function(_,L){T.push(L)}),m(T)},g.prototype.values=function(){var T=[];return this.forEach(function(_){T.push(_)}),m(T)},g.prototype.entries=function(){var T=[];return this.forEach(function(_,L){T.push([L,_])}),m(T)},l.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function y(T){if(!T._noBody){if(T.bodyUsed)return Promise.reject(new TypeError("Already read"));T.bodyUsed=!0}}function x(T){return new Promise(function(_,L){T.onload=function(){_(T.result)},T.onerror=function(){L(T.error)}})}function w(T){var _=new FileReader,L=x(_);return _.readAsArrayBuffer(T),L}function b(T){var _=new FileReader,L=x(_),O=/charset=([A-Za-z0-9_-]+)/.exec(T.type),M=O?O[1]:"utf-8";return _.readAsText(T,M),L}function v(T){for(var _=new Uint8Array(T),L=new Array(_.length),O=0;O<_.length;O++)L[O]=String.fromCharCode(_[O]);return L.join("")}function E(T){if(T.slice)return T.slice(0);var _=new Uint8Array(T.byteLength);return _.set(new Uint8Array(T)),_.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(T){this.bodyUsed=this.bodyUsed,this._bodyInit=T,T?typeof T=="string"?this._bodyText=T:l.blob&&Blob.prototype.isPrototypeOf(T)?this._bodyBlob=T:l.formData&&FormData.prototype.isPrototypeOf(T)?this._bodyFormData=T:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(T)?this._bodyText=T.toString():l.arrayBuffer&&l.blob&&d(T)?(this._bodyArrayBuffer=E(T.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(T)||h(T))?this._bodyArrayBuffer=E(T):this._bodyText=T=Object.prototype.toString.call(T):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof T=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(T)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var T=y(this);if(T)return T;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var T=y(this);return T||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(l.blob)return this.blob().then(w);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var T=y(this);if(T)return T;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(v(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(I)}),this.json=function(){return this.text().then(JSON.parse)},this}var C=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function S(T){var _=T.toUpperCase();return C.indexOf(_)>-1?_:T}function N(T,_){if(!(this instanceof N))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');_=_||{};var L=_.body;if(T instanceof N){if(T.bodyUsed)throw new TypeError("Already read");this.url=T.url,this.credentials=T.credentials,_.headers||(this.headers=new g(T.headers)),this.method=T.method,this.mode=T.mode,this.signal=T.signal,!L&&T._bodyInit!=null&&(L=T._bodyInit,T.bodyUsed=!0)}else this.url=String(T);if(this.credentials=_.credentials||this.credentials||"same-origin",(_.headers||!this.headers)&&(this.headers=new g(_.headers)),this.method=S(_.method||this.method||"GET"),this.mode=_.mode||this.mode||null,this.signal=_.signal||this.signal||function(){if("AbortController"in c){var B=new AbortController;return B.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&L)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(L),(this.method==="GET"||this.method==="HEAD")&&(_.cache==="no-store"||_.cache==="no-cache")){var O=/([?&])_=[^&]*/;if(O.test(this.url))this.url=this.url.replace(O,"$1_="+new Date().getTime());else{var M=/\?/;this.url+=(M.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}N.prototype.clone=function(){return new N(this,{body:this._bodyInit})};function I(T){var _=new FormData;return T.trim().split("&").forEach(function(L){if(L){var O=L.split("="),M=O.shift().replace(/\+/g," "),B=O.join("=").replace(/\+/g," ");_.append(decodeURIComponent(M),decodeURIComponent(B))}}),_}function F(T){var _=new g,L=T.replace(/\r?\n[\t ]+/g," ");return L.split("\r").map(function(O){return O.indexOf(`
`)===0?O.substr(1,O.length):O}).forEach(function(O){var M=O.split(":"),B=M.shift().trim();if(B){var W=M.join(":").trim();try{_.append(B,W)}catch(Z){console.warn("Response "+Z.message)}}}),_}k.call(N.prototype);function P(T,_){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(_||(_={}),this.type="default",this.status=_.status===void 0?200:_.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=_.statusText===void 0?"":""+_.statusText,this.headers=new g(_.headers),this.url=_.url||"",this._initBody(T)}k.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},P.error=function(){var T=new P(null,{status:200,statusText:""});return T.ok=!1,T.status=0,T.type="error",T};var H=[301,302,303,307,308];P.redirect=function(T,_){if(H.indexOf(_)===-1)throw new RangeError("Invalid status code");return new P(null,{status:_,headers:{location:T}})},o.DOMException=c.DOMException;try{new o.DOMException}catch{o.DOMException=function(_,L){this.message=_,this.name=L;var O=Error(_);this.stack=O.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function z(T,_){return new Promise(function(L,O){var M=new N(T,_);if(M.signal&&M.signal.aborted)return O(new o.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function W(){B.abort()}B.onload=function(){var ae={statusText:B.statusText,headers:F(B.getAllResponseHeaders()||"")};M.url.indexOf("file://")===0&&(B.status<200||B.status>599)?ae.status=200:ae.status=B.status,ae.url="responseURL"in B?B.responseURL:ae.headers.get("X-Request-URL");var oe="response"in B?B.response:B.responseText;setTimeout(function(){L(new P(oe,ae))},0)},B.onerror=function(){setTimeout(function(){O(new TypeError("Network request failed"))},0)},B.ontimeout=function(){setTimeout(function(){O(new TypeError("Network request timed out"))},0)},B.onabort=function(){setTimeout(function(){O(new o.DOMException("Aborted","AbortError"))},0)};function Z(ae){try{return ae===""&&c.location.href?c.location.href:ae}catch{return ae}}if(B.open(M.method,Z(M.url),!0),M.credentials==="include"?B.withCredentials=!0:M.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&(l.blob?B.responseType="blob":l.arrayBuffer&&(B.responseType="arraybuffer")),_&&typeof _.headers=="object"&&!(_.headers instanceof g||c.Headers&&_.headers instanceof c.Headers)){var ie=[];Object.getOwnPropertyNames(_.headers).forEach(function(ae){ie.push(f(ae)),B.setRequestHeader(ae,p(_.headers[ae]))}),M.headers.forEach(function(ae,oe){ie.indexOf(oe)===-1&&B.setRequestHeader(oe,ae)})}else M.headers.forEach(function(ae,oe){B.setRequestHeader(oe,ae)});M.signal&&(M.signal.addEventListener("abort",W),B.onreadystatechange=function(){B.readyState===4&&M.signal.removeEventListener("abort",W)}),B.send(typeof M._bodyInit>"u"?null:M._bodyInit)})}return z.polyfill=!0,c.fetch||(c.fetch=z,c.Headers=g,c.Request=N,c.Response=P),o.Headers=g,o.Request=N,o.Response=P,o.fetch=z,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(U_,U_.exports);var E1e=U_.exports;const S5=Mg(E1e);var C1e=Object.defineProperty,N1e=Object.defineProperties,A1e=Object.getOwnPropertyDescriptors,T5=Object.getOwnPropertySymbols,S1e=Object.prototype.hasOwnProperty,T1e=Object.prototype.propertyIsEnumerable,_5=(t,e,n)=>e in t?C1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,k5=(t,e)=>{for(var n in e||(e={}))S1e.call(e,n)&&_5(t,n,e[n]);if(T5)for(var n of T5(e))T1e.call(e,n)&&_5(t,n,e[n]);return t},I5=(t,e)=>N1e(t,A1e(e));const _1e={Accept:"application/json","Content-Type":"application/json"},k1e="POST",j5={headers:_1e,method:k1e},R5=10;let _a=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new Fo.EventEmitter,this.isAvailable=!1,this.registering=!1,!YD(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=jl(e),r=await(await S5(this.url,I5(k5({},j5),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!YD(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=jl({id:1,jsonrpc:"2.0",method:"test",params:[]});await S5(e,I5(k5({},j5),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?wf(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=pN(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return q7(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>R5&&this.events.setMaxListeners(R5)}};const P5="error",I1e="wss://relay.walletconnect.org",j1e="wc",R1e="universal_provider",bv=`${j1e}@2:${R1e}:`,wz="https://rpc.walletconnect.org/v1/",xz="generic",P1e=`${wz}bundler`,Ho={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Oj(t){return t==null||typeof t!="object"&&typeof t!="function"}function bz(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function vz(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const O1e="[object RegExp]",Ez="[object String]",Cz="[object Number]",Nz="[object Boolean]",Az="[object Arguments]",D1e="[object Symbol]",U1e="[object Date]",M1e="[object Map]",L1e="[object Set]",B1e="[object Array]",$1e="[object ArrayBuffer]",F1e="[object Object]",z1e="[object DataView]",H1e="[object Uint8Array]",V1e="[object Uint8ClampedArray]",W1e="[object Uint16Array]",q1e="[object Uint32Array]",K1e="[object Int8Array]",G1e="[object Int16Array]",Y1e="[object Int32Array]",Q1e="[object Float32Array]",J1e="[object Float64Array]";function Dj(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Z1e(t,e){return Hp(t,void 0,t,new Map,e)}function Hp(t,e,n,r=new Map,s=void 0){const i=s==null?void 0:s(t,e,n,r);if(i!=null)return i;if(Oj(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let c=0;c<t.length;c++)o[c]=Hp(t[c],c,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[c,l]of t)o.set(c,Hp(l,c,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const c of t)o.add(Hp(c,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Dj(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let c=0;c<t.length;c++)o[c]=Hp(t[c],c,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Zu(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Zu(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Zu(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Zu(o,t,n,r,s),o}if(typeof t=="object"&&X1e(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Zu(o,t,n,r,s),o}return t}function Zu(t,e,n=t,r,s){const i=[...Object.keys(e),...bz(e)];for(let o=0;o<i.length;o++){const c=i[o],l=Object.getOwnPropertyDescriptor(t,c);(l==null||l.writable)&&(t[c]=Hp(e[c],c,n,r,s))}}function X1e(t){switch(vz(t)){case Az:case B1e:case $1e:case z1e:case Nz:case U1e:case Q1e:case J1e:case K1e:case G1e:case Y1e:case M1e:case Cz:case F1e:case O1e:case L1e:case Ez:case D1e:case H1e:case V1e:case W1e:case q1e:return!0;default:return!1}}function eEe(t,e){return Z1e(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case Cz:case Ez:case Nz:{const o=new t.constructor(t==null?void 0:t.valueOf());return Zu(o,t),o}case Az:{const o={};return Zu(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function O5(t){return eEe(t)}function D5(t){return t!==null&&typeof t=="object"&&vz(t)==="[object Arguments]"}function U5(t){return typeof t=="object"&&t!==null}function tEe(){}function nEe(t){return Dj(t)}function rEe(t){var n;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const r=t[Symbol.toStringTag];return r==null||!((n=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&n.writable)?!1:t.toString()===`[object ${r}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function sEe(t){if(Oj(t))return t;if(Array.isArray(t)||Dj(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function iEe(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=M_(s,o,r,new Map)}return s}function M_(t,e,n,r){if(Oj(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return sEe(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...bz(e)];for(let i=0;i<s.length;i++){const o=s[i];let c=e[o],l=t[o];if(D5(c)&&(c={...c}),D5(l)&&(l={...l}),typeof Buffer<"u"&&Buffer.isBuffer(c)&&(c=O5(c)),Array.isArray(c))if(typeof l=="object"&&l!=null){const u=[],h=Reflect.ownKeys(l);for(let f=0;f<h.length;f++){const p=h[f];u[p]=l[p]}l=u}else l=[];const d=n(l,c,o,t,e,r);d!=null?t[o]=d:Array.isArray(c)||U5(l)&&U5(c)?t[o]=M_(l,c,n,r):l==null&&rEe(c)?t[o]=M_({},c,n,r):l==null&&nEe(c)?t[o]=O5(c):(l===void 0||c!==void 0)&&(t[o]=c)}return t}function oEe(t,...e){return iEe(t,...e,tEe)}var aEe=Object.defineProperty,cEe=Object.defineProperties,lEe=Object.getOwnPropertyDescriptors,M5=Object.getOwnPropertySymbols,dEe=Object.prototype.hasOwnProperty,uEe=Object.prototype.propertyIsEnumerable,L5=(t,e,n)=>e in t?aEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vv=(t,e)=>{for(var n in e||(e={}))dEe.call(e,n)&&L5(t,n,e[n]);if(M5)for(var n of M5(e))uEe.call(e,n)&&L5(t,n,e[n]);return t},hEe=(t,e)=>cEe(t,lEe(e));function eo(t,e,n){var r;const s=Jh(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${wz}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function $f(t){return t.includes(":")?t.split(":")[1]:t}function Sz(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function fEe(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function B5(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n==null?void 0:n.chains)==null?void 0:r.length)&&((s=n==null?void 0:n.chains)==null?void 0:s.length)>0}))}function Ev(t={},e={}){const n=B5($5(t)),r=B5($5(e));return oEe(n,r)}function $5(t){var e,n,r,s,i;const o={};if(!bc(t))return o;for(const[c,l]of Object.entries(t)){const d=fN(c)?[c]:l.chains,u=l.methods||[],h=l.events||[],f=l.rpcMap||{},p=zp(c);o[p]=hEe(vv(vv({},o[p]),l),{chains:xc(d,(e=o[p])==null?void 0:e.chains),methods:xc(u,(n=o[p])==null?void 0:n.methods),events:xc(h,(r=o[p])==null?void 0:r.events)}),(bc(f)||bc(((s=o[p])==null?void 0:s.rpcMap)||{}))&&(o[p].rpcMap=vv(vv({},f),(i=o[p])==null?void 0:i.rpcMap))}return o}function F5(t){return t.includes(":")?t.split(":")[2]:t}function z5(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],c=fN(n)?[n]:r.chains?r.chains:Sz(r.accounts);e[n]={chains:c,methods:s,events:i,accounts:o}}return e}function wS(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const Tz={},ln=t=>Tz[t],xS=(t,e)=>{Tz[t]=e};var pEe=Object.defineProperty,H5=Object.getOwnPropertySymbols,mEe=Object.prototype.hasOwnProperty,gEe=Object.prototype.propertyIsEnumerable,V5=(t,e,n)=>e in t?pEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W5=(t,e)=>{for(var n in e||(e={}))mEe.call(e,n)&&V5(t,n,e[n]);if(H5)for(var n of H5(e))gEe.call(e,n)&&V5(t,n,e[n]);return t};const q5="eip155",yEe=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],wEe=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,bS=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,K5=t=>Object.keys(t).filter(e=>yEe.includes(e)).reduce((e,n)=>(e[n]=t[n],e),{}),xEe=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!bc(s)&&!bc(r))return;const o=K5(r);for(const c of n){const l=wEe(c);if(!l)continue;i[bS(l)]=o;const d=s==null?void 0:s[`${q5}:${l}`];if(d){const u=d==null?void 0:d[`${q5}:${l}:${e}`];i[bS(l)]=W5(W5({},i[bS(l)]),K5(u||d))}}for(const[c,l]of Object.entries(i))Object.keys(l).length===0&&delete i[c];return Object.keys(i).length>0?i:void 0};var bEe=Object.defineProperty,vEe=(t,e,n)=>e in t?bEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,op=(t,e,n)=>vEe(t,typeof e!="symbol"?e+"":e,n);class EEe{constructor(e){op(this,"name","polkadot"),op(this,"client"),op(this,"httpProviders"),op(this,"events"),op(this,"namespace"),op(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=$f(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}}var CEe=Object.defineProperty,NEe=Object.defineProperties,AEe=Object.getOwnPropertyDescriptors,G5=Object.getOwnPropertySymbols,SEe=Object.prototype.hasOwnProperty,TEe=Object.prototype.propertyIsEnumerable,L_=(t,e,n)=>e in t?CEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Y5=(t,e)=>{for(var n in e||(e={}))SEe.call(e,n)&&L_(t,n,e[n]);if(G5)for(var n of G5(e))TEe.call(e,n)&&L_(t,n,e[n]);return t},Q5=(t,e)=>NEe(t,AEe(e)),ap=(t,e,n)=>L_(t,typeof e!="symbol"?e+"":e,n);class _Ee{constructor(e){ap(this,"name","eip155"),ap(this,"client"),ap(this,"chainId"),ap(this,"namespace"),ap(this,"httpProviders"),ap(this,"events"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n),this.chainId=parseInt(e),this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||eo(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt($f(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const c=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],l=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!c)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const d=this.client.session.get(e.topic),u=((o=d==null?void 0:d.sessionProperties)==null?void 0:o.capabilities)||{},h=`${c}${l.join(",")}`,f=u==null?void 0:u[h];if(f)return f;let p;try{p=xEe(d,c,l)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(p)return p;const m=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Q5(Y5({},d.sessionProperties||{}),{capabilities:Q5(Y5({},u||{}),{[h]:m})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return m}async getCallStatus(e){var n,r;const s=this.client.session.get(e.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const c=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(c,e)}catch(l){console.warn("Failed to fetch call status from bundler",l,c)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(c){console.warn("Failed to fetch call status from custom bundler",c,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(nc("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${P1e}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}}var kEe=Object.defineProperty,IEe=(t,e,n)=>e in t?kEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cp=(t,e,n)=>IEe(t,typeof e!="symbol"?e+"":e,n);class jEe{constructor(e){cp(this,"name","solana"),cp(this,"client"),cp(this,"httpProviders"),cp(this,"events"),cp(this,"namespace"),cp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=$f(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}}var REe=Object.defineProperty,PEe=(t,e,n)=>e in t?REe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lp=(t,e,n)=>PEe(t,typeof e!="symbol"?e+"":e,n);class OEe{constructor(e){lp(this,"name","cosmos"),lp(this,"client"),lp(this,"httpProviders"),lp(this,"events"),lp(this,"namespace"),lp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=$f(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}}var DEe=Object.defineProperty,UEe=(t,e,n)=>e in t?DEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dp=(t,e,n)=>UEe(t,typeof e!="symbol"?e+"":e,n);class MEe{constructor(e){dp(this,"name","algorand"),dp(this,"client"),dp(this,"httpProviders"),dp(this,"events"),dp(this,"namespace"),dp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(!this.httpProviders[e]){const r=n||eo(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new zo(new _a(r,ln("disableProviderPing")))}}var LEe=Object.defineProperty,BEe=(t,e,n)=>e in t?LEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,up=(t,e,n)=>BEe(t,typeof e!="symbol"?e+"":e,n);class $Ee{constructor(e){up(this,"name","cip34"),up(this,"client"),up(this,"httpProviders"),up(this,"events"),up(this,"namespace"),up(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=$f(n);e[s]=this.createHttpProvider(s,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}getCardanoRPCUrl(e){const n=this.namespace.rpcMap;if(n)return n[e]}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}}var FEe=Object.defineProperty,zEe=(t,e,n)=>e in t?FEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hp=(t,e,n)=>zEe(t,typeof e!="symbol"?e+"":e,n);class HEe{constructor(e){hp(this,"name","elrond"),hp(this,"client"),hp(this,"httpProviders"),hp(this,"events"),hp(this,"namespace"),hp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=$f(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}}var VEe=Object.defineProperty,WEe=(t,e,n)=>e in t?VEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fp=(t,e,n)=>WEe(t,typeof e!="symbol"?e+"":e,n);class qEe{constructor(e){fp(this,"name","multiversx"),fp(this,"client"),fp(this,"httpProviders"),fp(this,"events"),fp(this,"namespace"),fp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=$f(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}}var KEe=Object.defineProperty,GEe=(t,e,n)=>e in t?KEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pp=(t,e,n)=>GEe(t,typeof e!="symbol"?e+"":e,n);class YEe{constructor(e){pp(this,"name","near"),pp(this,"client"),pp(this,"httpProviders"),pp(this,"events"),pp(this,"namespace"),pp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||eo(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace);return typeof r>"u"?void 0:new zo(new _a(r,ln("disableProviderPing")))}}var QEe=Object.defineProperty,JEe=(t,e,n)=>e in t?QEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mp=(t,e,n)=>JEe(t,typeof e!="symbol"?e+"":e,n);class ZEe{constructor(e){mp(this,"name","tezos"),mp(this,"client"),mp(this,"httpProviders"),mp(this,"events"),mp(this,"namespace"),mp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||eo(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{e[n]=this.createHttpProvider(n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace);return typeof r>"u"?void 0:new zo(new _a(r))}}var XEe=Object.defineProperty,eCe=(t,e,n)=>e in t?XEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gp=(t,e,n)=>eCe(t,typeof e!="symbol"?e+"":e,n);class tCe{constructor(e){gp(this,"name",xz),gp(this,"client"),gp(this,"httpProviders"),gp(this,"events"),gp(this,"namespace"),gp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Ho.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return Jh(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{const i=Jh(s);r[i.reference]=this.createHttpProvider(s)}),r}getHttpProvider(e){const n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||eo(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new zo(new _a(r,ln("disableProviderPing")))}}var nCe=Object.defineProperty,rCe=Object.defineProperties,sCe=Object.getOwnPropertyDescriptors,J5=Object.getOwnPropertySymbols,iCe=Object.prototype.hasOwnProperty,oCe=Object.prototype.propertyIsEnumerable,B_=(t,e,n)=>e in t?nCe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cv=(t,e)=>{for(var n in e||(e={}))iCe.call(e,n)&&B_(t,n,e[n]);if(J5)for(var n of J5(e))oCe.call(e,n)&&B_(t,n,e[n]);return t},vS=(t,e)=>rCe(t,sCe(e)),lo=(t,e,n)=>B_(t,typeof e!="symbol"?e+"":e,n);let aCe=class _z{constructor(e){lo(this,"client"),lo(this,"namespaces"),lo(this,"optionalNamespaces"),lo(this,"sessionProperties"),lo(this,"scopedProperties"),lo(this,"events",new XI),lo(this,"rpcProviders",{}),lo(this,"session"),lo(this,"providerOpts"),lo(this,"logger"),lo(this,"uri"),lo(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nb(qg({level:(e==null?void 0:e.logger)||P5})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const n=new _z(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Cv({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,rx(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Fn("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=z5(this.session.namespaces);this.namespaces=Ev(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){const{uri:n,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=z5(s.namespaces);return this.namespaces=Ev(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(!vl(n))return;for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}catch(n){this.logger.warn("Failed to cleanup pending pairings",n)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await v1e.init({core:this.providerOpts.core,logger:this.providerOpts.logger||P5,relayUrl:this.providerOpts.relayUrl||I1e,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>zp(n)))];xS("client",this.client),xS("events",this.events),xS("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=fEe(n,this.session);if((r==null?void 0:r.length)===0)return;const s=Sz(r),i=Ev(this.namespaces,this.optionalNamespaces),o=vS(Cv({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new _Ee({namespace:o});break;case"algorand":this.rpcProviders[n]=new MEe({namespace:o});break;case"solana":this.rpcProviders[n]=new jEe({namespace:o});break;case"cosmos":this.rpcProviders[n]=new OEe({namespace:o});break;case"polkadot":this.rpcProviders[n]=new EEe({namespace:o});break;case"cip34":this.rpcProviders[n]=new $Ee({namespace:o});break;case"elrond":this.rpcProviders[n]=new HEe({namespace:o});break;case"multiversx":this.rpcProviders[n]=new qEe({namespace:o});break;case"near":this.rpcProviders[n]=new YEe({namespace:o});break;case"tezos":this.rpcProviders[n]=new ZEe({namespace:o});break;default:this.rpcProviders[n]=new tCe({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&vl(o)&&this.events.emit("accountsChanged",o.map(F5))}else if(i.name==="chainChanged"){const o=r.chainId,c=r.event.data,l=zp(o),d=wS(o)!==wS(c)?`${l}:${wS(c)}`:o;this.onChainChanged(d)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=vS(Cv({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",vS(Cv({},Fn("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Ho.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[xz]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Ev(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>zp(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=zp(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(r,s);const i=this.getProvider(r).getDefaultChain();n?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e})):this.getProvider(r).setDefaultChain(s),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const c=o.filter(l=>l.includes(`${r}:`)).map(F5);if(!vl(c))return;this.events.emit("accountsChanged",c)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${bv}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${bv}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${bv}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(bv)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}},Uu=null;const qi={getSIWX(){return fe.state.siwx},async initializeIfEnabled(t=$.getActiveCaipAddress()){var i,o,c;const e=fe.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if($.checkIfSupportedNetwork(n,`${n}:${r}`))try{if((i=fe.state.remoteFeatures)!=null&&i.emailCapture){const d=(o=$.getAccountData(n))==null?void 0:o.user;await Dt.open({view:"DataCapture",data:{email:(d==null?void 0:d.email)??void 0}});return}if(Uu&&await Uu,(await e.getSessions(`${n}:${r}`,s)).length)return;await Dt.open({view:"SIWXSignMessage"})}catch(l){console.error("SIWXUtil:initializeIfEnabled",l),Lt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(l)}),await((c=De._getClient())==null?void 0:c.disconnect().catch(console.error)),ut.reset("Connect"),lc.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=fe.state.siwx,e=Be.getPlainAddress($.getActiveCaipAddress()),n=oy(),r=De._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),i=s.toString();Ie.getConnectorId(n.chainNamespace)===ne.CONNECTOR_ID.AUTH&&ut.pushTransactionStack({});const c=await r.signMessage(i);await t.addSession({data:s,message:i,signature:c}),$.setLastConnectedSIWECaipNetwork(n),Dt.close(),Lt.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){(!Dt.state.open||ut.state.view==="ApproveTransaction")&&await Dt.open({view:"SIWXSignMessage"}),lc.showError("Error signing message"),Lt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(s)}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var t;try{const e=this.getSIWX();if((t=e==null?void 0:e.getRequired)==null?void 0:t.call(e)){const r=$.getLastConnectedSIWECaipNetwork();if(r){const s=await(e==null?void 0:e.getSessions(r==null?void 0:r.caipNetworkId,Be.getPlainAddress($.getActiveCaipAddress())||""));s&&s.length>0?await $.switchActiveNetwork(r):await De.disconnect()}else await De.disconnect()}else Dt.close();Dt.close(),Lt.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const t=this.getSIWX(),e=$.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await(t==null?void 0:t.getSessions(r.caipNetworkId,Be.getPlainAddress($.getActiveCaipAddress())||""));s&&n.push(...s)})),n},async getSessions(t){const e=fe.state.siwx;let n=t==null?void 0:t.address;if(!n){const s=$.getActiveCaipAddress();n=Be.getPlainAddress(s)}let r=t==null?void 0:t.caipNetworkId;if(!r){const s=$.getActiveCaipNetwork();r=s==null?void 0:s.caipNetworkId}return e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){var e;const t=this.getSIWX();if(t){const n=ut.state.view==="ApproveTransaction",r=ut.state.view==="SIWXSignMessage";if(n||r)return((e=t.getRequired)==null?void 0:e.call(t))&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){var h;const i=qi.getSIWX(),o=oy();if(!i||!s.includes(ne.CHAIN.EVM)||(h=fe.state.remoteFeatures)!=null&&h.emailCapture){const f=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:f.address,chainId:f.chainId,accounts:f.accounts}}const c=`${s}:${e}`,l=await i.createMessage({chainId:c,accountAddress:"<<AccountAddress>>"}),d={accountAddress:l.accountAddress,chainId:l.chainId,domain:l.domain,uri:l.uri,version:l.version,nonce:l.nonce,notBefore:l.notBefore,statement:l.statement,resources:l.resources,requestId:l.requestId,issuedAt:l.issuedAt,expirationTime:l.expirationTime,serializedMessage:l.toString()},u=await t.connect({chainId:e,socialUri:n,siwxMessage:d,preferredAccountType:r});return d.accountAddress=u.address,d.serializedMessage=u.message||"",u.signature&&u.message&&await qi.addEmbeddedWalletSession(d,u.message,u.signature),$.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(t,e,n){if(Uu)return Uu;const r=qi.getSIWX();return r?(Uu=r.addSession({data:t,message:e,signature:n}).finally(()=>{Uu=null}),Uu):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){var d,u,h;const r=qi.getSIWX(),s=oy(),i=new Set(e.map(f=>f.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:((d=oy())==null?void 0:d.caipNetworkId)||"",accountAddress:""}),c=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(f=>f!==o.chainId)]});lc.showLoading("Authenticating...",{autoClose:!1});const l={...c.session.peer.metadata,name:c.session.peer.metadata.name,icon:(u=c.session.peer.metadata.icons)==null?void 0:u[0],type:"WALLET_CONNECT"};if($.setAccountProp("connectedWalletInfo",l,Array.from(i)[0]),(h=c==null?void 0:c.auths)!=null&&h.length){const f=c.auths.map(p=>{const m=t.client.formatAuthMessage({request:p.p,iss:p.p.iss});return{data:{...p.p,accountAddress:p.p.iss.split(":").slice(-1).join(""),chainId:p.p.iss.split(":").slice(2,4).join(":"),uri:p.p.aud,version:p.p.version||o.version,expirationTime:p.p.exp,issuedAt:p.p.iat,notBefore:p.p.nbf},message:m,signature:p.s.s,cacao:p}});try{await r.setSessions(f),s&&$.setLastConnectedSIWECaipNetwork(s),Lt.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:qi.getSIWXEventProperties()})}catch(p){throw console.error("SIWX:universalProviderAuth - failed to set sessions",p),Lt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:qi.getSIWXEventProperties(p)}),await t.disconnect().catch(console.error),p}finally{lc.hide()}}return!0},getSIWXEventProperties(t){var n;const e=$.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:((n=$.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||"",isSmartAccount:Ws(e)===fr.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?Be.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},Wt={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",EIP155:ne.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH",getSDKVersionWarningMessage(t,e){return`
     @@@@@@@           @@@@@@@@@@@@@@@@@@      
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@   @@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@   @@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@  @@@@@@@@@@@@@
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@   @@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@   @@@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@   @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
      @@@@@            @@@@@@@@@@@@@@@@@@  
      
AppKit SDK version ${t} is outdated. Latest version is ${e}. Please update to the latest version for bug fixes and new features.
            
Changelog: https://github.com/reown-com/appkit/releases
NPM Registry: https://www.npmjs.com/package/@reown/appkit`}},oc={ConnectorExplorerIds:{[ne.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ne.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ne.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[ne.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[ne.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[Wt.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[Wt.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[Wt.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[Wt.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[Wt.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[Wt.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[Wt.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[Wt.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[Wt.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[Wt.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[Wt.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[Wt.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700"},ConnectorImageIds:{[ne.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ne.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ne.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[ne.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[ne.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[ne.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[ne.CONNECTOR_ID.INJECTED]:"Browser Wallet",[ne.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[ne.CONNECTOR_ID.COINBASE]:"Coinbase",[ne.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[ne.CONNECTOR_ID.LEDGER]:"Ledger",[ne.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[ne.CONNECTOR_ID.INJECTED]:"INJECTED",[ne.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[ne.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[ne.CONNECTOR_ID.AUTH]:"AUTH",[Wt.CONNECTOR_TYPE_AUTH]:"AUTH"}},nr={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${Wt.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())},getActiveNamespaceConnectedToAuth(){const t=$.state.activeChain;return ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>Ie.getConnectorId(e)===ne.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return ne.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(r=>r!==t):[]},getConnectorStorageInfo(t,e){const r=ye.getConnections()[e]??[];return{hasDisconnected:ye.isConnectorDisconnected(t,e),hasConnected:r.some(s=>nr.isLowerCaseMatch(s.connectorId,t))}}},cCe={extractVersion(t){var r;if(!t||typeof t!="string")return null;const e=/(?:[~^>=<]+\s*)?(?<version>\d+(?:\.\d+){0,2})(?:-[a-zA-Z]+\.\d+)?/u,n=t.match(e);return((r=n==null?void 0:n.groups)==null?void 0:r.version)||null},checkSDKVersion(t){this.extractVersion(t)},isValidVersion(t){return typeof t=="string"&&/^\d+\.\d+\.\d+$/u.test(t)},isOlder(t,e){const n=this.extractVersion(t),r=this.extractVersion(e);if(!n||!r)return!1;function s(c){const l=c.split(".").map(Number);for(;l.length<3;)l.push(0);return l}const i=s(n),o=s(r);for(let c=0;c<Math.max(i.length,o.length);c+=1){const l=i[c]||0,d=o[c]||0;if(l<d)return!0;if(l>d)return!1}return!1}},lCe=new AbortController,ks={EmbeddedWalletAbortController:lCe,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${iy()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},kz={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:pF.asset,84532:jie.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(kz.TOKEN_ADDRESSES_BY_SYMBOL).find(([n,r])=>Object.values(r).includes(t))??[];return e}},dCe={createLogger(t,e="error"){const n=qg({level:e}),{logger:r}=tj({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},uCe="rpc.walletconnect.org";function Z5(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const ES=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Cp={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===uCe}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:ne.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${ne.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){var s,i,o;const r=(o=(i=(s=t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return ES.includes(e)?Z5(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){var f,p,m,g,y,x,w;const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=(m=(p=(f=t.rpcUrls)==null?void 0:f.default)==null?void 0:p.http)==null?void 0:m[0],c=this.getDefaultRpcUrl(t,i,n),l=((x=(y=(g=t==null?void 0:t.rpcUrls)==null?void 0:g.chainDefault)==null?void 0:y.http)==null?void 0:x[0])||o,d=((w=r==null?void 0:r[i])==null?void 0:w.map(b=>b.url))||[],u=[...d,...c?[c]:[]],h=[...d];return l&&!h.includes(l)&&h.push(l),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:oc.NetworkImageIds[t.id],imageUrl:e==null?void 0:e[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:h}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>Cp.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){var s,i,o;const r=[];return n==null||n.forEach(c=>{r.push(tv(c.url,c.config))}),ES.includes(t.caipNetworkId)&&r.push(tv(Z5(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=t==null?void 0:t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(c=>{r.push(tv(c))}),VO(r)},extendWagmiTransports(t,e,n){if(ES.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return VO([n,tv(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:ne.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){var l;const e=ye.getActiveCaipNetworkId(),n=$.getAllRequestedCaipNetworks(),r=Array.from(((l=$.state.chains)==null?void 0:l.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?r.includes(s):!1,o=n==null?void 0:n.find(d=>d.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||(n==null?void 0:n[0])}},X5={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Zr={set(t,e){Ki.isClient&&localStorage.setItem(`${Ze.STORAGE_KEY}${t}`,e)},get(t){return Ki.isClient?localStorage.getItem(`${Ze.STORAGE_KEY}${t}`):null},delete(t,e){Ki.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${Ze.STORAGE_KEY}${t}`))}},Nv=30*1e3,Ki={checkIfAllowedToTriggerEmail(){const t=Zr.get(Ze.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Nv){const n=Math.ceil((Nv-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=Zr.get(Ze.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Nv)return Math.ceil((Nv-e)/1e3)}return 0},checkIfRequestExists(t){return fr.NOT_SAFE_RPC_METHODS.includes(t.method)||fr.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&((t==null?void 0:t.match(X5.transactionHash))||(t==null?void 0:t.match(X5.signedMessage)))?Ze.RPC_RESPONSE_TYPE_TX:Ze.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return fr.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var cn;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(c=>typeof s[s[c]]!="number"),o={};for(const c of i)o[c]=s[c];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(cn||(cn={}));var $_;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})($_||($_={}));const We=cn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),xd=t=>{switch(typeof t){case"undefined":return We.undefined;case"string":return We.string;case"number":return isNaN(t)?We.nan:We.number;case"boolean":return We.boolean;case"function":return We.function;case"bigint":return We.bigint;case"symbol":return We.symbol;case"object":return Array.isArray(t)?We.array:t===null?We.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?We.promise:typeof Map<"u"&&t instanceof Map?We.map:typeof Set<"u"&&t instanceof Set?We.set:typeof Date<"u"&&t instanceof Date?We.date:We.object;default:return We.unknown}},ke=cn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),hCe=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class va extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let c=r,l=0;for(;l<o.path.length;){const d=o.path[l];l===o.path.length-1?(c[d]=c[d]||{_errors:[]},c[d]._errors.push(n(o))):c[d]=c[d]||{_errors:[]},c=c[d],l++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,cn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}va.create=t=>new va(t);const sx=(t,e)=>{let n;switch(t.code){case ke.invalid_type:t.received===We.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ke.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,cn.jsonStringifyReplacer)}`;break;case ke.unrecognized_keys:n=`Unrecognized key(s) in object: ${cn.joinValues(t.keys,", ")}`;break;case ke.invalid_union:n="Invalid input";break;case ke.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${cn.joinValues(t.options)}`;break;case ke.invalid_enum_value:n=`Invalid enum value. Expected ${cn.joinValues(t.options)}, received '${t.received}'`;break;case ke.invalid_arguments:n="Invalid function arguments";break;case ke.invalid_return_type:n="Invalid function return type";break;case ke.invalid_date:n="Invalid date";break;case ke.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:cn.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ke.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ke.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ke.custom:n="Invalid input";break;case ke.invalid_intersection_types:n="Intersection results could not be merged";break;case ke.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ke.not_finite:n="Number must be finite";break;default:n=e.defaultError,cn.assertNever(t)}return{message:n}};let Iz=sx;function fCe(t){Iz=t}function DE(){return Iz}const UE=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let c="";const l=r.filter(d=>!!d).slice().reverse();for(const d of l)c=d(o,{data:e,defaultError:c}).message;return{...s,path:i,message:s.message||c}},pCe=[];function Ge(t,e){const n=UE({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,DE(),sx].filter(r=>!!r)});t.common.issues.push(n)}class Os{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return Ct;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return Os.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Ct;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const Ct=Object.freeze({status:"aborted"}),jz=t=>({status:"dirty",value:t}),Qs=t=>({status:"valid",value:t}),F_=t=>t.status==="aborted",z_=t=>t.status==="dirty",ix=t=>t.status==="valid",ME=t=>typeof Promise<"u"&&t instanceof Promise;var ft;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ft||(ft={}));class _c{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const e6=(t,e)=>{if(ix(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new va(t.common.issues);return this._error=n,this._error}}};function At(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,c)=>o.code!=="invalid_type"?{message:c.defaultError}:typeof c.data>"u"?{message:r??c.defaultError}:{message:n??c.defaultError},description:s}}class It{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return xd(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:xd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Os,ctx:{common:e.parent.common,data:e.data,parsedType:xd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ME(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:xd(e)},i=this._parseSync({data:e,path:s.path,parent:s});return e6(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:xd(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(ME(s)?s:Promise.resolve(s));return e6(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),c=()=>i.addIssue({code:ke.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Sa({schema:this,typeName:xt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return El.create(this,this._def)}nullable(){return Af.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ea.create(this,this._def)}promise(){return jg.create(this,this._def)}or(e){return lx.create([this,e],this._def)}and(e){return dx.create(this,e,this._def)}transform(e){return new Sa({...At(this._def),schema:this,typeName:xt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new mx({...At(this._def),innerType:this,defaultValue:n,typeName:xt.ZodDefault})}brand(){return new Pz({typeName:xt.ZodBranded,type:this,...At(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new FE({...At(this._def),innerType:this,catchValue:n,typeName:xt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return ub.create(this,e)}readonly(){return HE.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const mCe=/^c[^\s-]{8,}$/i,gCe=/^[a-z][a-z0-9]*$/,yCe=/^[0-9A-HJKMNP-TV-Z]{26}$/,wCe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xCe=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,bCe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let CS;const vCe=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,ECe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,CCe=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function NCe(t,e){return!!((e==="v4"||!e)&&vCe.test(t)||(e==="v6"||!e)&&ECe.test(t))}class ga extends It{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==We.string){const i=this._getOrReturnCtx(e);return Ge(i,{code:ke.invalid_type,expected:We.string,received:i.parsedType}),Ct}const r=new Os;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,c=e.data.length<i.value;(o||c)&&(s=this._getOrReturnCtx(e,s),o?Ge(s,{code:ke.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&Ge(s,{code:ke.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")xCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"email",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")CS||(CS=new RegExp(bCe,"u")),CS.test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"emoji",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")wCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"uuid",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")mCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"cuid",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")gCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"cuid2",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")yCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"ulid",code:ke.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Ge(s,{validation:"url",code:ke.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"regex",code:ke.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?CCe(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?NCe(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Ge(s,{validation:"ip",code:ke.invalid_string,message:i.message}),r.dirty()):cn.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:ke.invalid_string,...ft.errToObj(r)})}_addCheck(e){return new ga({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ft.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ft.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ft.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ft.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ft.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ft.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ft.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ft.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,...ft.errToObj(e==null?void 0:e.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ft.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ft.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ft.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ft.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ft.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ft.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ft.errToObj(n)})}nonempty(e){return this.min(1,ft.errToObj(e))}trim(){return new ga({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ga({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ga({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ga.create=t=>{var e;return new ga({checks:[],typeName:xt.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...At(t)})};function ACe(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class du extends It{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==We.number){const i=this._getOrReturnCtx(e);return Ge(i,{code:ke.invalid_type,expected:We.number,received:i.parsedType}),Ct}let r;const s=new Os;for(const i of this._def.checks)i.kind==="int"?cn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?ACe(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.not_finite,message:i.message}),s.dirty()):cn.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ft.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ft.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ft.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ft.toString(n))}setLimit(e,n,r,s){return new du({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ft.toString(s)}]})}_addCheck(e){return new du({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ft.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ft.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ft.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ft.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ft.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ft.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ft.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ft.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ft.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&cn.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}du.create=t=>new du({checks:[],typeName:xt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...At(t)});class uu extends It{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==We.bigint){const i=this._getOrReturnCtx(e);return Ge(i,{code:ke.invalid_type,expected:We.bigint,received:i.parsedType}),Ct}let r;const s=new Os;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ge(r,{code:ke.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):cn.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ft.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ft.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ft.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ft.toString(n))}setLimit(e,n,r,s){return new uu({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ft.toString(s)}]})}_addCheck(e){return new uu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ft.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ft.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ft.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ft.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ft.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}uu.create=t=>{var e;return new uu({checks:[],typeName:xt.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...At(t)})};class ox extends It{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==We.boolean){const r=this._getOrReturnCtx(e);return Ge(r,{code:ke.invalid_type,expected:We.boolean,received:r.parsedType}),Ct}return Qs(e.data)}}ox.create=t=>new ox({typeName:xt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...At(t)});class Cf extends It{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==We.date){const i=this._getOrReturnCtx(e);return Ge(i,{code:ke.invalid_type,expected:We.date,received:i.parsedType}),Ct}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Ge(i,{code:ke.invalid_date}),Ct}const r=new Os;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Ge(s,{code:ke.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):cn.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Cf({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ft.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ft.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Cf.create=t=>new Cf({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:xt.ZodDate,...At(t)});class LE extends It{_parse(e){if(this._getType(e)!==We.symbol){const r=this._getOrReturnCtx(e);return Ge(r,{code:ke.invalid_type,expected:We.symbol,received:r.parsedType}),Ct}return Qs(e.data)}}LE.create=t=>new LE({typeName:xt.ZodSymbol,...At(t)});class ax extends It{_parse(e){if(this._getType(e)!==We.undefined){const r=this._getOrReturnCtx(e);return Ge(r,{code:ke.invalid_type,expected:We.undefined,received:r.parsedType}),Ct}return Qs(e.data)}}ax.create=t=>new ax({typeName:xt.ZodUndefined,...At(t)});class cx extends It{_parse(e){if(this._getType(e)!==We.null){const r=this._getOrReturnCtx(e);return Ge(r,{code:ke.invalid_type,expected:We.null,received:r.parsedType}),Ct}return Qs(e.data)}}cx.create=t=>new cx({typeName:xt.ZodNull,...At(t)});class Ig extends It{constructor(){super(...arguments),this._any=!0}_parse(e){return Qs(e.data)}}Ig.create=t=>new Ig({typeName:xt.ZodAny,...At(t)});class Zh extends It{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Qs(e.data)}}Zh.create=t=>new Zh({typeName:xt.ZodUnknown,...At(t)});class Pl extends It{_parse(e){const n=this._getOrReturnCtx(e);return Ge(n,{code:ke.invalid_type,expected:We.never,received:n.parsedType}),Ct}}Pl.create=t=>new Pl({typeName:xt.ZodNever,...At(t)});class BE extends It{_parse(e){if(this._getType(e)!==We.undefined){const r=this._getOrReturnCtx(e);return Ge(r,{code:ke.invalid_type,expected:We.void,received:r.parsedType}),Ct}return Qs(e.data)}}BE.create=t=>new BE({typeName:xt.ZodVoid,...At(t)});class Ea extends It{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==We.array)return Ge(n,{code:ke.invalid_type,expected:We.array,received:n.parsedType}),Ct;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,c=n.data.length<s.exactLength.value;(o||c)&&(Ge(n,{code:o?ke.too_big:ke.too_small,minimum:c?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Ge(n,{code:ke.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Ge(n,{code:ke.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,c)=>s.type._parseAsync(new _c(n,o,n.path,c)))).then(o=>Os.mergeArray(r,o));const i=[...n.data].map((o,c)=>s.type._parseSync(new _c(n,o,n.path,c)));return Os.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Ea({...this._def,minLength:{value:e,message:ft.toString(n)}})}max(e,n){return new Ea({...this._def,maxLength:{value:e,message:ft.toString(n)}})}length(e,n){return new Ea({...this._def,exactLength:{value:e,message:ft.toString(n)}})}nonempty(e){return this.min(1,e)}}Ea.create=(t,e)=>new Ea({type:t,minLength:null,maxLength:null,exactLength:null,typeName:xt.ZodArray,...At(e)});function Np(t){if(t instanceof qn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=El.create(Np(r))}return new qn({...t._def,shape:()=>e})}else return t instanceof Ea?new Ea({...t._def,type:Np(t.element)}):t instanceof El?El.create(Np(t.unwrap())):t instanceof Af?Af.create(Np(t.unwrap())):t instanceof kc?kc.create(t.items.map(e=>Np(e))):t}class qn extends It{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=cn.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==We.object){const d=this._getOrReturnCtx(e);return Ge(d,{code:ke.invalid_type,expected:We.object,received:d.parsedType}),Ct}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof Pl&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||c.push(d);const l=[];for(const d of o){const u=i[d],h=s.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new _c(s,h,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof Pl){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of c)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(d==="strict")c.length>0&&(Ge(s,{code:ke.unrecognized_keys,keys:c}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of c){const h=s.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new _c(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of l){const h=await u.key;d.push({key:h,value:await u.value,alwaysSet:u.alwaysSet})}return d}).then(d=>Os.mergeObjectSync(r,d)):Os.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return ft.errToObj,new qn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,c;const l=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(c=ft.errToObj(e).message)!==null&&c!==void 0?c:l}:{message:l}}}:{}})}strip(){return new qn({...this._def,unknownKeys:"strip"})}passthrough(){return new qn({...this._def,unknownKeys:"passthrough"})}extend(e){return new qn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new qn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:xt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new qn({...this._def,catchall:e})}pick(e){const n={};return cn.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new qn({...this._def,shape:()=>n})}omit(e){const n={};return cn.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new qn({...this._def,shape:()=>n})}deepPartial(){return Np(this)}partial(e){const n={};return cn.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new qn({...this._def,shape:()=>n})}required(e){const n={};return cn.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof El;)i=i._def.innerType;n[r]=i}}),new qn({...this._def,shape:()=>n})}keyof(){return Rz(cn.objectKeys(this.shape))}}qn.create=(t,e)=>new qn({shape:()=>t,unknownKeys:"strip",catchall:Pl.create(),typeName:xt.ZodObject,...At(e)});qn.strictCreate=(t,e)=>new qn({shape:()=>t,unknownKeys:"strict",catchall:Pl.create(),typeName:xt.ZodObject,...At(e)});qn.lazycreate=(t,e)=>new qn({shape:t,unknownKeys:"strip",catchall:Pl.create(),typeName:xt.ZodObject,...At(e)});class lx extends It{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new va(c.ctx.common.issues));return Ge(n,{code:ke.invalid_union,unionErrors:o}),Ct}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const l of r){const d={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(l=>new va(l));return Ge(n,{code:ke.invalid_union,unionErrors:c}),Ct}}get options(){return this._def.options}}lx.create=(t,e)=>new lx({options:t,typeName:xt.ZodUnion,...At(e)});const g1=t=>t instanceof hx?g1(t.schema):t instanceof Sa?g1(t.innerType()):t instanceof fx?[t.value]:t instanceof hu?t.options:t instanceof px?Object.keys(t.enum):t instanceof mx?g1(t._def.innerType):t instanceof ax?[void 0]:t instanceof cx?[null]:null;class wN extends It{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==We.object)return Ge(n,{code:ke.invalid_type,expected:We.object,received:n.parsedType}),Ct;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Ge(n,{code:ke.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ct)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=g1(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of o){if(s.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);s.set(c,i)}}return new wN({typeName:xt.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...At(r)})}}function H_(t,e){const n=xd(t),r=xd(e);if(t===e)return{valid:!0,data:t};if(n===We.object&&r===We.object){const s=cn.objectKeys(e),i=cn.objectKeys(t).filter(c=>s.indexOf(c)!==-1),o={...t,...e};for(const c of i){const l=H_(t[c],e[c]);if(!l.valid)return{valid:!1};o[c]=l.data}return{valid:!0,data:o}}else if(n===We.array&&r===We.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],c=e[i],l=H_(o,c);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===We.date&&r===We.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class dx extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(F_(i)||F_(o))return Ct;const c=H_(i.value,o.value);return c.valid?((z_(i)||z_(o))&&n.dirty(),{status:n.value,value:c.data}):(Ge(r,{code:ke.invalid_intersection_types}),Ct)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}dx.create=(t,e,n)=>new dx({left:t,right:e,typeName:xt.ZodIntersection,...At(n)});class kc extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==We.array)return Ge(r,{code:ke.invalid_type,expected:We.array,received:r.parsedType}),Ct;if(r.data.length<this._def.items.length)return Ge(r,{code:ke.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ct;!this._def.rest&&r.data.length>this._def.items.length&&(Ge(r,{code:ke.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,c)=>{const l=this._def.items[c]||this._def.rest;return l?l._parse(new _c(r,o,r.path,c)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Os.mergeArray(n,o)):Os.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new kc({...this._def,rest:e})}}kc.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new kc({items:t,typeName:xt.ZodTuple,rest:null,...At(e)})};class ux extends It{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==We.object)return Ge(r,{code:ke.invalid_type,expected:We.object,received:r.parsedType}),Ct;const s=[],i=this._def.keyType,o=this._def.valueType;for(const c in r.data)s.push({key:i._parse(new _c(r,c,r.path,c)),value:o._parse(new _c(r,r.data[c],r.path,c))});return r.common.async?Os.mergeObjectAsync(n,s):Os.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof It?new ux({keyType:e,valueType:n,typeName:xt.ZodRecord,...At(r)}):new ux({keyType:ga.create(),valueType:e,typeName:xt.ZodRecord,...At(n)})}}class $E extends It{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==We.map)return Ge(r,{code:ke.invalid_type,expected:We.map,received:r.parsedType}),Ct;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([c,l],d)=>({key:s._parse(new _c(r,c,r.path,[d,"key"])),value:i._parse(new _c(r,l,r.path,[d,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const l of o){const d=await l.key,u=await l.value;if(d.status==="aborted"||u.status==="aborted")return Ct;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),c.set(d.value,u.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const l of o){const d=l.key,u=l.value;if(d.status==="aborted"||u.status==="aborted")return Ct;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),c.set(d.value,u.value)}return{status:n.value,value:c}}}}$E.create=(t,e,n)=>new $E({valueType:e,keyType:t,typeName:xt.ZodMap,...At(n)});class Nf extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==We.set)return Ge(r,{code:ke.invalid_type,expected:We.set,received:r.parsedType}),Ct;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Ge(r,{code:ke.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Ge(r,{code:ke.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(l){const d=new Set;for(const u of l){if(u.status==="aborted")return Ct;u.status==="dirty"&&n.dirty(),d.add(u.value)}return{status:n.value,value:d}}const c=[...r.data.values()].map((l,d)=>i._parse(new _c(r,l,r.path,d)));return r.common.async?Promise.all(c).then(l=>o(l)):o(c)}min(e,n){return new Nf({...this._def,minSize:{value:e,message:ft.toString(n)}})}max(e,n){return new Nf({...this._def,maxSize:{value:e,message:ft.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Nf.create=(t,e)=>new Nf({valueType:t,minSize:null,maxSize:null,typeName:xt.ZodSet,...At(e)});class hm extends It{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==We.function)return Ge(n,{code:ke.invalid_type,expected:We.function,received:n.parsedType}),Ct;function r(c,l){return UE({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,DE(),sx].filter(d=>!!d),issueData:{code:ke.invalid_arguments,argumentsError:l}})}function s(c,l){return UE({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,DE(),sx].filter(d=>!!d),issueData:{code:ke.invalid_return_type,returnTypeError:l}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof jg){const c=this;return Qs(async function(...l){const d=new va([]),u=await c._def.args.parseAsync(l,i).catch(p=>{throw d.addIssue(r(l,p)),d}),h=await Reflect.apply(o,this,u);return await c._def.returns._def.type.parseAsync(h,i).catch(p=>{throw d.addIssue(s(h,p)),d})})}else{const c=this;return Qs(function(...l){const d=c._def.args.safeParse(l,i);if(!d.success)throw new va([r(l,d.error)]);const u=Reflect.apply(o,this,d.data),h=c._def.returns.safeParse(u,i);if(!h.success)throw new va([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new hm({...this._def,args:kc.create(e).rest(Zh.create())})}returns(e){return new hm({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new hm({args:e||kc.create([]).rest(Zh.create()),returns:n||Zh.create(),typeName:xt.ZodFunction,...At(r)})}}class hx extends It{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}hx.create=(t,e)=>new hx({getter:t,typeName:xt.ZodLazy,...At(e)});class fx extends It{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ge(n,{received:n.data,code:ke.invalid_literal,expected:this._def.value}),Ct}return{status:"valid",value:e.data}}get value(){return this._def.value}}fx.create=(t,e)=>new fx({value:t,typeName:xt.ZodLiteral,...At(e)});function Rz(t,e){return new hu({values:t,typeName:xt.ZodEnum,...At(e)})}class hu extends It{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Ge(n,{expected:cn.joinValues(r),received:n.parsedType,code:ke.invalid_type}),Ct}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return Ge(n,{received:n.data,code:ke.invalid_enum_value,options:r}),Ct}return Qs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return hu.create(e)}exclude(e){return hu.create(this.options.filter(n=>!e.includes(n)))}}hu.create=Rz;class px extends It{_parse(e){const n=cn.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==We.string&&r.parsedType!==We.number){const s=cn.objectValues(n);return Ge(r,{expected:cn.joinValues(s),received:r.parsedType,code:ke.invalid_type}),Ct}if(n.indexOf(e.data)===-1){const s=cn.objectValues(n);return Ge(r,{received:r.data,code:ke.invalid_enum_value,options:s}),Ct}return Qs(e.data)}get enum(){return this._def.values}}px.create=(t,e)=>new px({values:t,typeName:xt.ZodNativeEnum,...At(e)});class jg extends It{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==We.promise&&n.common.async===!1)return Ge(n,{code:ke.invalid_type,expected:We.promise,received:n.parsedType}),Ct;const r=n.parsedType===We.promise?n.data:Promise.resolve(n.data);return Qs(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}jg.create=(t,e)=>new jg({type:t,typeName:xt.ZodPromise,...At(e)});class Sa extends It{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===xt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{Ge(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(c=>this._def.schema._parseAsync({data:c,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=c=>{const l=s.refinement(c,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value).then(()=>({status:n.value,value:c.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ix(o))return o;const c=s.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>ix(o)?Promise.resolve(s.transform(o.value,i)).then(c=>({status:n.value,value:c})):o);cn.assertNever(s)}}Sa.create=(t,e,n)=>new Sa({schema:t,typeName:xt.ZodEffects,effect:e,...At(n)});Sa.createWithPreprocess=(t,e,n)=>new Sa({schema:e,effect:{type:"preprocess",transform:t},typeName:xt.ZodEffects,...At(n)});class El extends It{_parse(e){return this._getType(e)===We.undefined?Qs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}El.create=(t,e)=>new El({innerType:t,typeName:xt.ZodOptional,...At(e)});class Af extends It{_parse(e){return this._getType(e)===We.null?Qs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Af.create=(t,e)=>new Af({innerType:t,typeName:xt.ZodNullable,...At(e)});class mx extends It{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===We.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}mx.create=(t,e)=>new mx({innerType:t,typeName:xt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...At(e)});class FE extends It{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ME(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new va(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new va(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}FE.create=(t,e)=>new FE({innerType:t,typeName:xt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...At(e)});class zE extends It{_parse(e){if(this._getType(e)!==We.nan){const r=this._getOrReturnCtx(e);return Ge(r,{code:ke.invalid_type,expected:We.nan,received:r.parsedType}),Ct}return{status:"valid",value:e.data}}}zE.create=t=>new zE({typeName:xt.ZodNaN,...At(t)});const SCe=Symbol("zod_brand");class Pz extends It{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ub extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ct:i.status==="dirty"?(n.dirty(),jz(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ct:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new ub({in:e,out:n,typeName:xt.ZodPipeline})}}class HE extends It{_parse(e){const n=this._def.innerType._parse(e);return ix(n)&&(n.value=Object.freeze(n.value)),n}}HE.create=(t,e)=>new HE({innerType:t,typeName:xt.ZodReadonly,...At(e)});const Oz=(t,e={},n)=>t?Ig.create().superRefine((r,s)=>{var i,o;if(!t(r)){const c=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,l=(o=(i=c.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,d=typeof c=="string"?{message:c}:c;s.addIssue({code:"custom",...d,fatal:l})}}):Ig.create(),TCe={object:qn.lazycreate};var xt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(xt||(xt={}));const _Ce=(t,e={message:`Input not instance of ${t.name}`})=>Oz(n=>n instanceof t,e),Dz=ga.create,Uz=du.create,kCe=zE.create,ICe=uu.create,Mz=ox.create,jCe=Cf.create,RCe=LE.create,PCe=ax.create,OCe=cx.create,DCe=Ig.create,UCe=Zh.create,MCe=Pl.create,LCe=BE.create,BCe=Ea.create,$Ce=qn.create,FCe=qn.strictCreate,zCe=lx.create,HCe=wN.create,VCe=dx.create,WCe=kc.create,qCe=ux.create,KCe=$E.create,GCe=Nf.create,YCe=hm.create,QCe=hx.create,JCe=fx.create,ZCe=hu.create,XCe=px.create,eNe=jg.create,t6=Sa.create,tNe=El.create,nNe=Af.create,rNe=Sa.createWithPreprocess,sNe=ub.create,iNe=()=>Dz().optional(),oNe=()=>Uz().optional(),aNe=()=>Mz().optional(),cNe={string:t=>ga.create({...t,coerce:!0}),number:t=>du.create({...t,coerce:!0}),boolean:t=>ox.create({...t,coerce:!0}),bigint:t=>uu.create({...t,coerce:!0}),date:t=>Cf.create({...t,coerce:!0})},lNe=Ct;var D=Object.freeze({__proto__:null,defaultErrorMap:sx,setErrorMap:fCe,getErrorMap:DE,makeIssue:UE,EMPTY_PATH:pCe,addIssueToContext:Ge,ParseStatus:Os,INVALID:Ct,DIRTY:jz,OK:Qs,isAborted:F_,isDirty:z_,isValid:ix,isAsync:ME,get util(){return cn},get objectUtil(){return $_},ZodParsedType:We,getParsedType:xd,ZodType:It,ZodString:ga,ZodNumber:du,ZodBigInt:uu,ZodBoolean:ox,ZodDate:Cf,ZodSymbol:LE,ZodUndefined:ax,ZodNull:cx,ZodAny:Ig,ZodUnknown:Zh,ZodNever:Pl,ZodVoid:BE,ZodArray:Ea,ZodObject:qn,ZodUnion:lx,ZodDiscriminatedUnion:wN,ZodIntersection:dx,ZodTuple:kc,ZodRecord:ux,ZodMap:$E,ZodSet:Nf,ZodFunction:hm,ZodLazy:hx,ZodLiteral:fx,ZodEnum:hu,ZodNativeEnum:px,ZodPromise:jg,ZodEffects:Sa,ZodTransformer:Sa,ZodOptional:El,ZodNullable:Af,ZodDefault:mx,ZodCatch:FE,ZodNaN:zE,BRAND:SCe,ZodBranded:Pz,ZodPipeline:ub,ZodReadonly:HE,custom:Oz,Schema:It,ZodSchema:It,late:TCe,get ZodFirstPartyTypeKind(){return xt},coerce:cNe,any:DCe,array:BCe,bigint:ICe,boolean:Mz,date:jCe,discriminatedUnion:HCe,effect:t6,enum:ZCe,function:YCe,instanceof:_Ce,intersection:VCe,lazy:QCe,literal:JCe,map:KCe,nan:kCe,nativeEnum:XCe,never:MCe,null:OCe,nullable:nNe,number:Uz,object:$Ce,oboolean:aNe,onumber:oNe,optional:tNe,ostring:iNe,pipeline:sNe,preprocess:rNe,promise:eNe,record:qCe,set:GCe,strictObject:FCe,string:Dz,symbol:RCe,transformer:t6,tuple:WCe,undefined:PCe,union:zCe,unknown:UCe,void:LCe,NEVER:lNe,ZodIssueCode:ke,quotelessJson:hCe,ZodError:va});const Zn=D.object({message:D.string()});function qe(t){return D.literal(Ze[t])}const xN=D.object({serializedMessage:D.string().optional(),accountAddress:D.string(),chainId:D.string(),notBefore:D.string().optional(),domain:D.string(),uri:D.string(),version:D.string(),nonce:D.string(),statement:D.string().optional(),resources:D.array(D.string()).optional(),requestId:D.string().optional(),issuedAt:D.string().optional(),expirationTime:D.string().optional()});D.object({accessList:D.array(D.string()),blockHash:D.string().nullable(),blockNumber:D.string().nullable(),chainId:D.string().or(D.number()),from:D.string(),gas:D.string(),hash:D.string(),input:D.string().nullable(),maxFeePerGas:D.string(),maxPriorityFeePerGas:D.string(),nonce:D.string(),r:D.string(),s:D.string(),to:D.string(),transactionIndex:D.string().nullable(),type:D.string(),v:D.string(),value:D.string()});const dNe=D.object({chainId:D.string().or(D.number()),rpcUrl:D.optional(D.string())}),uNe=D.object({email:D.string().email()}),hNe=D.object({otp:D.string()}),fNe=D.object({uri:D.string(),preferredAccountType:D.optional(D.string()),chainId:D.optional(D.string().or(D.number())),siwxMessage:D.optional(xN),rpcUrl:D.optional(D.string())}),pNe=D.object({chainId:D.optional(D.string().or(D.number())),preferredAccountType:D.optional(D.string()),socialUri:D.optional(D.string()),siwxMessage:D.optional(xN),rpcUrl:D.optional(D.string())}),mNe=D.object({provider:D.enum(["google","github","apple","facebook","x","discord"])}),gNe=D.object({email:D.string().email()}),yNe=D.object({otp:D.string()}),wNe=D.object({otp:D.string()}),xNe=D.object({themeMode:D.optional(D.enum(["light","dark"])),themeVariables:D.optional(D.record(D.string(),D.string().or(D.number()))),w3mThemeVariables:D.optional(D.record(D.string(),D.string()))}),bNe=D.object({metadata:D.object({name:D.string(),description:D.string(),url:D.string(),icons:D.array(D.string())}).optional(),sdkVersion:D.string().optional(),sdkType:D.string().optional(),projectId:D.string()}),vNe=D.object({type:D.string()}),ENe=D.object({action:D.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),CNe=D.object({url:D.string()}),NNe=D.object({userName:D.string()}),ANe=D.object({email:D.string().optional().nullable(),address:D.string(),chainId:D.string().or(D.number()),accounts:D.array(D.object({address:D.string(),type:D.enum([fr.ACCOUNT_TYPES.EOA,fr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:D.string().optional().nullable(),preferredAccountType:D.optional(D.string()),signature:D.string().optional(),message:D.string().optional(),siwxMessage:D.optional(xN)}),SNe=D.object({action:D.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),TNe=D.object({email:D.string().email().optional().nullable(),address:D.string(),chainId:D.string().or(D.number()),smartAccountDeployed:D.optional(D.boolean()),accounts:D.array(D.object({address:D.string(),type:D.enum([fr.ACCOUNT_TYPES.EOA,fr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:D.optional(D.string()),signature:D.string().optional(),message:D.string().optional(),siwxMessage:D.optional(xN)}),_Ne=D.object({uri:D.string()}),kNe=D.object({isConnected:D.boolean()}),INe=D.object({chainId:D.string().or(D.number())}),jNe=D.object({chainId:D.string().or(D.number())}),RNe=D.object({newEmail:D.string().email()}),PNe=D.object({smartAccountEnabledNetworks:D.array(D.number())});D.object({address:D.string(),isDeployed:D.boolean()});const ONe=D.object({version:D.string().optional()}),DNe=D.object({type:D.string(),address:D.string()}),UNe=D.any(),MNe=D.object({method:D.literal("eth_accounts")}),LNe=D.object({method:D.literal("eth_blockNumber")}),BNe=D.object({method:D.literal("eth_call"),params:D.array(D.any())}),$Ne=D.object({method:D.literal("eth_chainId")}),FNe=D.object({method:D.literal("eth_estimateGas"),params:D.array(D.any())}),zNe=D.object({method:D.literal("eth_feeHistory"),params:D.array(D.any())}),HNe=D.object({method:D.literal("eth_gasPrice")}),VNe=D.object({method:D.literal("eth_getAccount"),params:D.array(D.any())}),WNe=D.object({method:D.literal("eth_getBalance"),params:D.array(D.any())}),qNe=D.object({method:D.literal("eth_getBlockByHash"),params:D.array(D.any())}),KNe=D.object({method:D.literal("eth_getBlockByNumber"),params:D.array(D.any())}),GNe=D.object({method:D.literal("eth_getBlockReceipts"),params:D.array(D.any())}),YNe=D.object({method:D.literal("eth_getBlockTransactionCountByHash"),params:D.array(D.any())}),QNe=D.object({method:D.literal("eth_getBlockTransactionCountByNumber"),params:D.array(D.any())}),JNe=D.object({method:D.literal("eth_getCode"),params:D.array(D.any())}),ZNe=D.object({method:D.literal("eth_getFilterChanges"),params:D.array(D.any())}),XNe=D.object({method:D.literal("eth_getFilterLogs"),params:D.array(D.any())}),eAe=D.object({method:D.literal("eth_getLogs"),params:D.array(D.any())}),tAe=D.object({method:D.literal("eth_getProof"),params:D.array(D.any())}),nAe=D.object({method:D.literal("eth_getStorageAt"),params:D.array(D.any())}),rAe=D.object({method:D.literal("eth_getTransactionByBlockHashAndIndex"),params:D.array(D.any())}),sAe=D.object({method:D.literal("eth_getTransactionByBlockNumberAndIndex"),params:D.array(D.any())}),iAe=D.object({method:D.literal("eth_getTransactionByHash"),params:D.array(D.any())}),oAe=D.object({method:D.literal("eth_getTransactionCount"),params:D.array(D.any())}),aAe=D.object({method:D.literal("eth_getTransactionReceipt"),params:D.array(D.any())}),cAe=D.object({method:D.literal("eth_getUncleCountByBlockHash"),params:D.array(D.any())}),lAe=D.object({method:D.literal("eth_getUncleCountByBlockNumber"),params:D.array(D.any())}),dAe=D.object({method:D.literal("eth_maxPriorityFeePerGas")}),uAe=D.object({method:D.literal("eth_newBlockFilter")}),hAe=D.object({method:D.literal("eth_newFilter"),params:D.array(D.any())}),fAe=D.object({method:D.literal("eth_newPendingTransactionFilter")}),pAe=D.object({method:D.literal("eth_sendRawTransaction"),params:D.array(D.any())}),mAe=D.object({method:D.literal("eth_syncing"),params:D.array(D.any())}),gAe=D.object({method:D.literal("eth_uninstallFilter"),params:D.array(D.any())}),n6=D.object({method:D.literal("personal_sign"),params:D.array(D.any())}),yAe=D.object({method:D.literal("eth_signTypedData_v4"),params:D.array(D.any())}),wAe=D.object({method:D.literal("eth_sendTransaction"),params:D.array(D.any())}),xAe=D.object({method:D.literal("solana_signMessage"),params:D.object({message:D.string(),pubkey:D.string()})}),bAe=D.object({method:D.literal("solana_signTransaction"),params:D.object({transaction:D.string()})}),vAe=D.object({method:D.literal("solana_signAllTransactions"),params:D.object({transactions:D.array(D.string())})}),EAe=D.object({method:D.literal("solana_signAndSendTransaction"),params:D.object({transaction:D.string(),options:D.object({skipPreflight:D.boolean().optional(),preflightCommitment:D.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:D.number().optional(),minContextSlot:D.number().optional()}).optional()})}),CAe=D.object({method:D.literal("wallet_sendCalls"),params:D.array(D.object({chainId:D.string().or(D.number()).optional(),from:D.string().optional(),version:D.string().optional(),capabilities:D.any().optional(),calls:D.array(D.object({to:D.string().startsWith("0x"),data:D.string().startsWith("0x").optional(),value:D.string().optional()}))}))}),NAe=D.object({method:D.literal("wallet_getCallsStatus"),params:D.array(D.string())}),AAe=D.object({method:D.literal("wallet_getCapabilities"),params:D.array(D.string().or(D.number()).optional()).optional()}),SAe=D.object({method:D.literal("wallet_grantPermissions"),params:D.array(D.any())}),TAe=D.object({method:D.literal("wallet_revokePermissions"),params:D.any()}),_Ae=D.object({method:D.literal("wallet_getAssets"),params:D.any()}),r6=D.object({token:D.string()}),Ke=D.object({id:D.string().optional()}),NS={appEvent:Ke.extend({type:qe("APP_SWITCH_NETWORK"),payload:dNe}).or(Ke.extend({type:qe("APP_CONNECT_EMAIL"),payload:uNe})).or(Ke.extend({type:qe("APP_CONNECT_DEVICE")})).or(Ke.extend({type:qe("APP_CONNECT_OTP"),payload:hNe})).or(Ke.extend({type:qe("APP_CONNECT_SOCIAL"),payload:fNe})).or(Ke.extend({type:qe("APP_GET_FARCASTER_URI")})).or(Ke.extend({type:qe("APP_CONNECT_FARCASTER")})).or(Ke.extend({type:qe("APP_GET_USER"),payload:D.optional(pNe)})).or(Ke.extend({type:qe("APP_GET_SOCIAL_REDIRECT_URI"),payload:mNe})).or(Ke.extend({type:qe("APP_SIGN_OUT")})).or(Ke.extend({type:qe("APP_IS_CONNECTED"),payload:D.optional(r6)})).or(Ke.extend({type:qe("APP_GET_CHAIN_ID")})).or(Ke.extend({type:qe("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(Ke.extend({type:qe("APP_INIT_SMART_ACCOUNT")})).or(Ke.extend({type:qe("APP_SET_PREFERRED_ACCOUNT"),payload:vNe})).or(Ke.extend({type:qe("APP_RPC_REQUEST"),payload:n6.or(_Ae).or(MNe).or(LNe).or(BNe).or($Ne).or(FNe).or(zNe).or(HNe).or(VNe).or(WNe).or(qNe).or(KNe).or(GNe).or(YNe).or(QNe).or(JNe).or(ZNe).or(XNe).or(eAe).or(tAe).or(nAe).or(rAe).or(sAe).or(iAe).or(oAe).or(aAe).or(cAe).or(lAe).or(dAe).or(uAe).or(hAe).or(fAe).or(pAe).or(mAe).or(gAe).or(n6).or(yAe).or(wAe).or(xAe).or(bAe).or(vAe).or(EAe).or(NAe).or(CAe).or(AAe).or(SAe).or(TAe).and(D.object({chainId:D.string().or(D.number()).optional(),chainNamespace:D.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:D.string().optional()}))})).or(Ke.extend({type:qe("APP_UPDATE_EMAIL"),payload:gNe})).or(Ke.extend({type:qe("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:yNe})).or(Ke.extend({type:qe("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:wNe})).or(Ke.extend({type:qe("APP_SYNC_THEME"),payload:xNe})).or(Ke.extend({type:qe("APP_SYNC_DAPP_DATA"),payload:bNe})).or(Ke.extend({type:qe("APP_RELOAD")})).or(Ke.extend({type:qe("APP_RPC_ABORT")})),frameEvent:Ke.extend({type:qe("FRAME_SWITCH_NETWORK_ERROR"),payload:Zn}).or(Ke.extend({type:qe("FRAME_SWITCH_NETWORK_SUCCESS"),payload:jNe})).or(Ke.extend({type:qe("FRAME_CONNECT_EMAIL_SUCCESS"),payload:ENe})).or(Ke.extend({type:qe("FRAME_CONNECT_EMAIL_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:CNe})).or(Ke.extend({type:qe("FRAME_GET_FARCASTER_URI_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:NNe})).or(Ke.extend({type:qe("FRAME_CONNECT_FARCASTER_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_CONNECT_OTP_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_CONNECT_OTP_SUCCESS")})).or(Ke.extend({type:qe("FRAME_CONNECT_DEVICE_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_CONNECT_DEVICE_SUCCESS")})).or(Ke.extend({type:qe("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:ANe})).or(Ke.extend({type:qe("FRAME_CONNECT_SOCIAL_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_GET_USER_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_GET_USER_SUCCESS"),payload:TNe})).or(Ke.extend({type:qe("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:_Ne})).or(Ke.extend({type:qe("FRAME_SIGN_OUT_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_SIGN_OUT_SUCCESS")})).or(Ke.extend({type:qe("FRAME_IS_CONNECTED_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_IS_CONNECTED_SUCCESS"),payload:kNe})).or(Ke.extend({type:qe("FRAME_GET_CHAIN_ID_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_GET_CHAIN_ID_SUCCESS"),payload:INe})).or(Ke.extend({type:qe("FRAME_RPC_REQUEST_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_RPC_REQUEST_SUCCESS"),payload:UNe})).or(Ke.extend({type:qe("FRAME_SESSION_UPDATE"),payload:r6})).or(Ke.extend({type:qe("FRAME_UPDATE_EMAIL_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_UPDATE_EMAIL_SUCCESS"),payload:SNe})).or(Ke.extend({type:qe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(Ke.extend({type:qe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:RNe})).or(Ke.extend({type:qe("FRAME_SYNC_THEME_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_SYNC_THEME_SUCCESS")})).or(Ke.extend({type:qe("FRAME_SYNC_DAPP_DATA_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(Ke.extend({type:qe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:PNe})).or(Ke.extend({type:qe("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:DNe})).or(Ke.extend({type:qe("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_READY"),payload:ONe})).or(Ke.extend({type:qe("FRAME_RELOAD_ERROR"),payload:Zn})).or(Ke.extend({type:qe("FRAME_RELOAD_SUCCESS")}))};function AS(t,e={}){var n;return typeof(e==null?void 0:e.type)=="string"&&((n=e==null?void 0:e.type)==null?void 0:n.includes(t))}function kAe({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=ne.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(Kse);return i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",Yse),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class IAe{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=ne.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const c=document.getElementById("w3m-iframe");this.iframe&&!c&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(c,l,d)=>{function u({data:h}){var p;if(!AS(Ze.FRAME_EVENT_KEY,h))return;const f=NS.frameEvent.safeParse(h);if(!f.success){console.warn("W3mFrame: invalid frame event",f.error.message);return}((p=f.data)==null?void 0:p.id)===c&&(l(f.data),window.removeEventListener("message",u))}Ki.isClient&&(window.addEventListener("message",u),d.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:c=>{Ki.isClient&&window.addEventListener("message",({data:l})=>{if(!AS(Ze.FRAME_EVENT_KEY,l))return;const d=NS.frameEvent.safeParse(l);d.success?c(d.data):console.warn("W3mFrame: invalid frame event",d.error.message)})},onAppEvent:c=>{Ki.isClient&&window.addEventListener("message",({data:l})=>{if(!AS(Ze.APP_EVENT_KEY,l))return;const d=NS.appEvent.safeParse(l);d.success||console.warn("W3mFrame: invalid app event",d.error.message),c(l)})},postAppEvent:c=>{var l;if(Ki.isClient){if(!((l=this.iframe)!=null&&l.contentWindow))throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(c,"*")}},postFrameEvent:c=>{if(Ki.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(c,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((c,l)=>{this.frameLoadPromiseResolver={resolve:c,reject:l}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((c,l)=>{this.frameLoadPromiseResolver={resolve:c,reject:l}}),Ki.isClient)){const c=document.createElement("iframe");c.id="w3m-iframe",c.src=kAe({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),c.name="w3m-secure-iframe",c.style.position="fixed",c.style.zIndex="999999",c.style.display="none",c.style.border="none",c.style.animationDelay="0s, 50ms",c.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",c.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=c,this.iframe.onerror=()=>{var l;(l=this.frameLoadPromiseResolver)==null||l.reject("Unable to load email login dependency")},this.events.onFrameEvent(l=>{var d;l.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(d=this.frameLoadPromiseResolver)==null||d.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}class jAe{constructor(e){var i;const n=qg({level:Gse}),{logger:r,chunkLoggerController:s}=tj({opts:n});this.logger=Ds(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class RAe{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:c,enableCloudAuthAccount:l}){this.openRpcRequests=new Map,this.isInitialized=!1,r&&(this.w3mLogger=new jAe(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=c;const d=this.getRpcUrl(n);this.w3mFrame=new IAe({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:d,enableCloudAuthAccount:l}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Zr.get(Ze.EMAIL_LOGIN_USED_KEY)}getEmail(){return Zr.get(Ze.EMAIL)}getUsername(){return Zr.get(Ze.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:Ze.APP_RELOAD})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error reloading iframe"),n}}async connectEmail(e){var n;try{Ki.checkIfAllowedToTriggerEmail(),await this.init();const r=await this.appEvent({type:Ze.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting email"),r}}async connectDevice(){var e;try{return this.appEvent({type:Ze.APP_CONNECT_DEVICE})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting device"),n}}async connectOtp(e){var n;try{return this.appEvent({type:Ze.APP_CONNECT_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting otp"),r}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const n=await this.appEvent({type:Ze.APP_IS_CONNECTED});return n!=null&&n.isConnected||this.deleteAuthLoginCache(),n}catch(n){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error checking connection"),n}}async getChainId(){var e;try{const n=await this.appEvent({type:Ze.APP_GET_CHAIN_ID});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting chain id"),n}}async getSocialRedirectUri(e){var n;try{return await this.init(),this.appEvent({type:Ze.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error getting social redirect uri"),r}}async updateEmail(e){var n;try{const r=await this.appEvent({type:Ze.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email"),r}}async updateEmailPrimaryOtp(e){var n;try{return this.appEvent({type:Ze.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email primary otp"),r}}async updateEmailSecondaryOtp(e){var n;try{const r=await this.appEvent({type:Ze.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(r.newEmail),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email secondary otp"),r}}async syncTheme(e){var n;try{return this.appEvent({type:Ze.APP_SYNC_THEME,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing theme"),r}}async syncDappData(e){var n;try{return this.appEvent({type:Ze.APP_SYNC_DAPP_DATA,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing dapp data"),r}}async getSmartAccountEnabledNetworks(){var e;try{const n=await this.appEvent({type:Ze.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(n.smartAccountEnabledNetworks),n}catch(n){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting smart account enabled networks"),n}}async setPreferredAccount(e){var n;try{return this.appEvent({type:Ze.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error setting preferred account"),r}}async connect(e){var n,r;if(e!=null&&e.socialUri)try{await this.init();const s=this.getRpcUrl(e.chainId),i=await this.appEvent({type:Ze.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:s}});return i.userName&&this.setSocialLoginSuccess(i.userName),this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(n=this.w3mLogger)==null||n.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType,siwxMessage:e==null?void 0:e.siwxMessage,rpcUrl:this.getRpcUrl(s)});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting"),s}}async getUser(e){var n;try{await this.init();const r=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:Ze.APP_GET_USER,payload:{...e,chainId:r,rpcUrl:this.getRpcUrl(r)}});return this.user=s,s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting"),r}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){var s;try{await this.init();const i=this.getRpcUrl(n),o=await this.appEvent({type:Ze.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:i,preferredAccountType:r}});return o.userName&&this.setSocialLoginSuccess(o.userName),o}catch(i){throw(s=this.w3mLogger)==null||s.logger.error({error:i},"Error connecting social"),i}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:Ze.APP_GET_FARCASTER_URI})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting farcaster uri"),n}}async connectFarcaster(){var e;try{const n=await this.appEvent({type:Ze.APP_CONNECT_FARCASTER});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting farcaster"),n}}async switchNetwork({chainId:e}){var n;try{const r=this.getRpcUrl(e),s=await this.appEvent({type:Ze.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:r}});return this.setLastUsedChainId(s.chainId),s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error switching network"),r}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async r=>{const s=setTimeout(()=>{r()},3e3);await this.appEvent({type:Ze.APP_SIGN_OUT}),clearTimeout(s),r()})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error disconnecting"),n}}async request(e){var r,s,i,o,c;const n=e;try{if(fr.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const l=e.chainNamespace||"eip155",d=(r=this.getActiveCaipNetwork(l))==null?void 0:r.id;n.chainNamespace=l,n.chainId=d,n.rpcUrl=this.getRpcUrl(d),(s=this.rpcRequestHandler)==null||s.call(this,e);const u=await this.appEvent({type:Ze.APP_RPC_REQUEST,payload:n});return(i=this.rpcSuccessHandler)==null||i.call(this,u,n),u}catch(l){throw(o=this.rpcErrorHandler)==null||o.call(this,l,n),(c=this.w3mLogger)==null||c.logger.error({error:l},"Error requesting"),l}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_IS_CONNECTED_ERROR&&e(),n.type===Ze.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===Ze.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:fr.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){var e;try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:n,method:r})=>{fr.SAFE_RPC_METHODS.includes(r)||n.abort(),await this.appEvent({type:Ze.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(n){(e=this.w3mLogger)==null||e.logger.error({error:n},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(l){return l.replace("@w3m-app/","")}const i=[Ze.APP_SYNC_DAPP_DATA,Ze.APP_SYNC_THEME,Ze.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{var l;(l=this.onTimeout)==null||l.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[Ze.APP_CONNECT_EMAIL,Ze.APP_CONNECT_DEVICE,Ze.APP_CONNECT_OTP,Ze.APP_CONNECT_SOCIAL,Ze.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{var l;(l=this.onTimeout)==null||l.call(this,"iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((l,d)=>{var p,m,g;const u=Math.random().toString(36).substring(7);(g=(p=this.w3mLogger)==null?void 0:(m=p.logger).info)==null||g.call(m,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const h=new AbortController;if(o==="RPC_REQUEST"){const y=e;this.openRpcRequests.set(u,{...y.payload,abortController:h})}h.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?d(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&d(new Error("Something went wrong"))});const f=(y,x)=>{var w,b,v;y.id===u&&((b=x==null?void 0:(w=x.logger).info)==null||b.call(w,{framEvent:y,id:u},"Received frame response"),this.openRpcRequests.delete(y.id),y.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in y&&l(y.payload),l(void 0)):y.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in y&&d(new Error(((v=y.payload)==null?void 0:v.message)||"An error occurred")),d(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(u,y=>f(y,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Zr.set(Ze.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Zr.set(Ze.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Zr.set(Ze.EMAIL,e),Zr.set(Ze.EMAIL_LOGIN_USED_KEY,"true"),Zr.delete(Ze.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Zr.delete(Ze.EMAIL_LOGIN_USED_KEY),Zr.delete(Ze.EMAIL),Zr.delete(Ze.LAST_USED_CHAIN_KEY),Zr.delete(Ze.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Zr.set(Ze.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Zr.get(Ze.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){Zr.set(Ze.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){var i,o;let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=(i=jr.parseCaipNetworkId(e))==null?void 0:i.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n),s=e?r.find(c=>String(c.id)===String(e)||c.caipNetworkId===e):r[0];return(o=s==null?void 0:s.rpcUrls.default.http)==null?void 0:o[0]}}class Oy{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:c}){var l;return Oy.instance||(Oy.instance=new RAe({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:c,enableCloudAuthAccount:!!((l=fe.state.remoteFeatures)!=null&&l.emailCapture)})),Oy.instance}}var s6={};const PAe={ACCOUNT_TABS:[{label:"Tokens"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof s6<"u"?s6.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120},VIEWS_WITH_LEGAL_FOOTER:["Connect","ConnectWallets","OnRampTokenSelect","OnRampFiatSelect","OnRampProviders"],VIEWS_WITH_DEFAULT_FOOTER:["Networks"]},V_={filterOutDuplicatesByRDNS(t){const e=fe.state.enableEIP6963?Ie.state.connectors:[],n=ye.getRecentWallets(),r=e.map(c=>{var l;return(l=c.info)==null?void 0:l.rdns}).filter(Boolean),s=n.map(c=>c.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&Be.isMobile()){const c=i.indexOf("io.metamask.mobile");i[c]="io.metamask"}return t.filter(c=>!(c!=null&&c.rdns&&i.includes(String(c.rdns))||!(c!=null&&c.rdns)&&e.some(d=>d.name===c.name)))},filterOutDuplicatesByIds(t){const e=Ie.state.connectors.filter(c=>c.type==="ANNOUNCED"||c.type==="INJECTED"),n=ye.getRecentWallets(),r=e.map(c=>c.explorerId),s=n.map(c=>c.id),i=r.concat(s);return t.filter(c=>!i.includes(c==null?void 0:c.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=Ie.state,{featuredWalletIds:n}=fe.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,c)=>{var l;return(l=c.info)!=null&&l.rdns&&(o[c.info.rdns]=!0),o},{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,c)=>{const l=Number(c.installed)-Number(o.installed);if(l!==0)return l;if(n!=null&&n.length){const d=n.indexOf(o.id),u=n.indexOf(c.id);if(d!==-1&&u!==-1)return d-u;if(d!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){var l;const n=(t==null?void 0:t.connectMethodsOrder)||((l=fe.state.features)==null?void 0:l.connectMethodsOrder),r=e||Ie.state.connectors;if(n)return n;const{injected:s,announced:i}=y1.getConnectorsByType(r,dt.state.recommended,dt.state.featured),o=s.filter(y1.showConnector),c=i.filter(y1.showConnector);return o.length||c.length?["wallet","email","social"]:PAe.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&dt.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&dt.state.excludedWallets.some(r=>nr.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))}},y1={getConnectorsByType(t,e,n){const{customWallets:r}=fe.state,s=ye.getRecentWallets(),i=V_.filterOutDuplicateWallets(e),o=V_.filterOutDuplicateWallets(n),c=t.filter(h=>h.type==="MULTI_CHAIN"),l=t.filter(h=>h.type==="ANNOUNCED"),d=t.filter(h=>h.type==="INJECTED"),u=t.filter(h=>h.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:c,announced:l,injected:d,recommended:i,featured:o}},showConnector(t){var s;const e=(s=t.info)==null?void 0:s.rdns,n=!!e&&dt.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),r=!!t.name&&dt.state.excludedWallets.some(i=>nr.isLowerCaseMatch(i.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!Be.isMobile()||Be.isMobile()&&!e&&!De.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from($.state.chains.values()).some(n=>Ie.getConnectorId(n.namespace)===ne.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:c,overriddenConnectors:l=(d=>(d=fe.state.features)==null?void 0:d.connectorTypeOrder)()??[]}){const h=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:c.length>0},{type:"recommended",isEnabled:t.length>0}].filter(g=>g.isEnabled),f=new Set(h.map(g=>g.type)),p=l.filter(g=>f.has(g)).map(g=>({type:g,isEnabled:!0})),m=h.filter(({type:g})=>!p.some(({type:x})=>x===g));return Array.from(new Set([...p,...m].map(({type:g})=>g)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,n)=>e.explorerWallet&&n.explorerWallet?(e.explorerWallet.order??0)-(n.explorerWallet.order??0):e.explorerWallet?-1:n.explorerWallet?1:0)},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){var e,n;try{if(t.name==="Browser Wallet"&&!Be.isMobile())return{accounts:[],chainId:void 0};if(t.id===ne.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[r,s]=await Promise.all([(e=t.provider)==null?void 0:e.request({method:"eth_accounts"}),(n=t.provider)==null?void 0:n.request({method:"eth_chainId"}).then(i=>Number(i))]);return{accounts:r,chainId:s}}catch(r){return console.warn(`Failed to fetch provider data for ${t.name}`,r),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const w1=globalThis,Uj=w1.ShadowRoot&&(w1.ShadyCSS===void 0||w1.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Mj=Symbol(),i6=new WeakMap;let Lz=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==Mj)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(Uj&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=i6.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&i6.set(n,e))}return e}toString(){return this.cssText}};const ta=t=>new Lz(typeof t=="string"?t:t+"",void 0,Mj),bd=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new Lz(n,t,Mj)},OAe=(t,e)=>{if(Uj)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=w1.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},o6=Uj?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return ta(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:DAe,defineProperty:UAe,getOwnPropertyDescriptor:MAe,getOwnPropertyNames:LAe,getOwnPropertySymbols:BAe,getPrototypeOf:$Ae}=Object,ru=globalThis,a6=ru.trustedTypes,FAe=a6?a6.emptyScript:"",SS=ru.reactiveElementPolyfillSupport,Dy=(t,e)=>t,W_={toAttribute(t,e){switch(e){case Boolean:t=t?FAe:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},Bz=(t,e)=>!DAe(t,e),c6={attribute:!0,type:String,converter:W_,reflect:!1,useDefault:!1,hasChanged:Bz};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),ru.litPropertyMetadata??(ru.litPropertyMetadata=new WeakMap);let Ap=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=c6){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&UAe(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=MAe(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const c=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,c,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??c6}static _$Ei(){if(this.hasOwnProperty(Dy("elementProperties")))return;const e=$Ae(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Dy("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Dy("properties"))){const n=this.properties,r=[...LAe(n),...BAe(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(o6(s))}else e!==void 0&&n.push(o6(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(n=>n(this))}addController(e){var n;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((n=e.hostConnected)==null||n.call(e))}removeController(e){var n;(n=this._$EO)==null||n.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return OAe(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostConnected)==null?void 0:r.call(n)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostDisconnected)==null?void 0:r.call(n)})}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){var i;const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const o=(((i=r.converter)==null?void 0:i.toAttribute)!==void 0?r.converter:W_).toAttribute(n,r.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,n){var i,o;const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const c=r.getPropertyOptions(s),l=typeof c.converter=="function"?{fromAttribute:c.converter}:((i=c.converter)==null?void 0:i.fromAttribute)!==void 0?c.converter:W_;this._$Em=s;const d=l.fromAttribute(n,c.type);this[s]=d??((o=this._$Ej)==null?void 0:o.get(s))??d,this._$Em=null}}requestUpdate(e,n,r){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(r??(r=i.getPropertyOptions(e)),!((r.hasChanged??Bz)(o,n)||r.useDefault&&r.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:c}=o,l=this[i];c!==!0||this._$AL.has(i)||l===void 0||this.C(i,void 0,o,l)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),(r=this._$EO)==null||r.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(n)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(n)}willUpdate(e){}_$AE(e){var n;(n=this._$EO)==null||n.forEach(r=>{var s;return(s=r.hostUpdated)==null?void 0:s.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};Ap.elementStyles=[],Ap.shadowRootOptions={mode:"open"},Ap[Dy("elementProperties")]=new Map,Ap[Dy("finalized")]=new Map,SS==null||SS({ReactiveElement:Ap}),(ru.reactiveElementVersions??(ru.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Uy=globalThis,VE=Uy.trustedTypes,l6=VE?VE.createPolicy("lit-html",{createHTML:t=>t}):void 0,$z="$lit$",vd=`lit$${Math.random().toFixed(9).slice(2)}$`,Fz="?"+vd,zAe=`<${Fz}>`,Sf=document,gx=()=>Sf.createComment(""),yx=t=>t===null||typeof t!="object"&&typeof t!="function",Lj=Array.isArray,HAe=t=>Lj(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",TS=`[ 	
\f\r]`,q0=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,d6=/-->/g,u6=/>/g,Mu=RegExp(`>|${TS}(?:([^\\s"'>=/]+)(${TS}*=${TS}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),h6=/'/g,f6=/"/g,zz=/^(?:script|style|textarea|title)$/i,Hz=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),PRe=Hz(1),ORe=Hz(2),Rg=Symbol.for("lit-noChange"),zr=Symbol.for("lit-nothing"),p6=new WeakMap,bh=Sf.createTreeWalker(Sf,129);function Vz(t,e){if(!Lj(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return l6!==void 0?l6.createHTML(e):e}const VAe=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=q0;for(let c=0;c<n;c++){const l=t[c];let d,u,h=-1,f=0;for(;f<l.length&&(o.lastIndex=f,u=o.exec(l),u!==null);)f=o.lastIndex,o===q0?u[1]==="!--"?o=d6:u[1]!==void 0?o=u6:u[2]!==void 0?(zz.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Mu):u[3]!==void 0&&(o=Mu):o===Mu?u[0]===">"?(o=s??q0,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,d=u[1],o=u[3]===void 0?Mu:u[3]==='"'?f6:h6):o===f6||o===h6?o=Mu:o===d6||o===u6?o=q0:(o=Mu,s=void 0);const p=o===Mu&&t[c+1].startsWith("/>")?" ":"";i+=o===q0?l+zAe:h>=0?(r.push(d),l.slice(0,h)+$z+l.slice(h)+vd+p):l+vd+(h===-2?c:p)}return[Vz(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class wx{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const c=e.length-1,l=this.parts,[d,u]=VAe(e,n);if(this.el=wx.createElement(d,r),bh.currentNode=this.el.content,n===2||n===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(s=bh.nextNode())!==null&&l.length<c;){if(s.nodeType===1){if(s.hasAttributes())for(const h of s.getAttributeNames())if(h.endsWith($z)){const f=u[o++],p=s.getAttribute(h).split(vd),m=/([.?@])?(.*)/.exec(f);l.push({type:1,index:i,name:m[2],strings:p,ctor:m[1]==="."?qAe:m[1]==="?"?KAe:m[1]==="@"?GAe:bN}),s.removeAttribute(h)}else h.startsWith(vd)&&(l.push({type:6,index:i}),s.removeAttribute(h));if(zz.test(s.tagName)){const h=s.textContent.split(vd),f=h.length-1;if(f>0){s.textContent=VE?VE.emptyScript:"";for(let p=0;p<f;p++)s.append(h[p],gx()),bh.nextNode(),l.push({type:2,index:++i});s.append(h[f],gx())}}}else if(s.nodeType===8)if(s.data===Fz)l.push({type:2,index:i});else{let h=-1;for(;(h=s.data.indexOf(vd,h+1))!==-1;)l.push({type:7,index:i}),h+=vd.length-1}i++}}static createElement(e,n){const r=Sf.createElement("template");return r.innerHTML=e,r}}function Pg(t,e,n=t,r){var o,c;if(e===Rg)return e;let s=r!==void 0?(o=n._$Co)==null?void 0:o[r]:n._$Cl;const i=yx(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((c=s==null?void 0:s._$AO)==null||c.call(s,!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??(n._$Co=[]))[r]=s:n._$Cl=s),s!==void 0&&(e=Pg(t,s._$AS(t,e.values),s,r)),e}class WAe{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=((e==null?void 0:e.creationScope)??Sf).importNode(n,!0);bh.currentNode=s;let i=bh.nextNode(),o=0,c=0,l=r[0];for(;l!==void 0;){if(o===l.index){let d;l.type===2?d=new n0(i,i.nextSibling,this,e):l.type===1?d=new l.ctor(i,l.name,l.strings,this,e):l.type===6&&(d=new YAe(i,this,e)),this._$AV.push(d),l=r[++c]}o!==(l==null?void 0:l.index)&&(i=bh.nextNode(),o++)}return bh.currentNode=Sf,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class n0{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=zr,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Pg(this,e,n),yx(e)?e===zr||e==null||e===""?(this._$AH!==zr&&this._$AR(),this._$AH=zr):e!==this._$AH&&e!==Rg&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):HAe(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==zr&&yx(this._$AH)?this._$AA.nextSibling.data=e:this.T(Sf.createTextNode(e)),this._$AH=e}$(e){var i;const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=wx.createElement(Vz(r.h,r.h[0]),this.options)),r);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(n);else{const o=new WAe(s,this),c=o.u(this.options);o.p(n),this.T(c),this._$AH=o}}_$AC(e){let n=p6.get(e.strings);return n===void 0&&p6.set(e.strings,n=new wx(e)),n}k(e){Lj(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new n0(this.O(gx()),this.O(gx()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,n);e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var n;this._$AM===void 0&&(this._$Cv=e,(n=this._$AP)==null||n.call(this,e))}}class bN{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=zr,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=zr}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=Pg(this,e,n,0),o=!yx(e)||e!==this._$AH&&e!==Rg,o&&(this._$AH=e);else{const c=e;let l,d;for(e=i[0],l=0;l<i.length-1;l++)d=Pg(this,c[r+l],n,l),d===Rg&&(d=this._$AH[l]),o||(o=!yx(d)||d!==this._$AH[l]),d===zr?e=zr:e!==zr&&(e+=(d??"")+i[l+1]),this._$AH[l]=d}o&&!s&&this.j(e)}j(e){e===zr?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class qAe extends bN{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===zr?void 0:e}}class KAe extends bN{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==zr)}}class GAe extends bN{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=Pg(this,e,n,0)??zr)===Rg)return;const r=this._$AH,s=e===zr&&r!==zr||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==zr&&(r===zr||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n;typeof this._$AH=="function"?this._$AH.call(((n=this.options)==null?void 0:n.host)??this.element,e):this._$AH.handleEvent(e)}}class YAe{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Pg(this,e)}}const DRe={I:n0},_S=Uy.litHtmlPolyfillSupport;_S==null||_S(wx,n0),(Uy.litHtmlVersions??(Uy.litHtmlVersions=[])).push("3.3.1");const QAe=(t,e,n)=>{const r=(n==null?void 0:n.renderBefore)??e;let s=r._$litPart$;if(s===void 0){const i=(n==null?void 0:n.renderBefore)??null;r._$litPart$=s=new n0(e.insertBefore(gx(),i),i,void 0,n??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Xh=globalThis;class x1 extends Ap{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var n;const e=super.createRenderRoot();return(n=this.renderOptions).renderBefore??(n.renderBefore=e.firstChild),e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=QAe(n,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Rg}}var MU;x1._$litElement$=!0,x1.finalized=!0,(MU=Xh.litElementHydrateSupport)==null||MU.call(Xh,{LitElement:x1});const kS=Xh.litElementPolyfillSupport;kS==null||kS({LitElement:x1});(Xh.litElementVersions??(Xh.litElementVersions=[])).push("4.2.1");const JAe={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},WE={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},ZAe={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},XAe={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},eSe={regular:"KHTeka",mono:"KHTekaMono"},tSe={regular:"400",medium:"500"},nSe={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},rSe={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},sSe={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},iSe={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},q_={colors:JAe,fontFamily:eSe,fontWeight:tSe,textSize:nSe,typography:rSe,tokens:{core:WE.core,theme:WE.dark},borderRadius:ZAe,spacing:XAe,durations:iSe,easings:sSe},m6="--apkt",Kc={createCSSVariables(t){const e={},n={};function r(i,o,c=""){for(const[l,d]of Object.entries(i)){const u=c?`${c}-${l}`:l;d&&typeof d=="object"&&Object.keys(d).length?(o[l]={},r(d,o[l],u)):typeof d=="string"&&(o[l]=`${m6}-${u}`)}}function s(i,o){for(const[c,l]of Object.entries(i))l&&typeof l=="object"?(o[c]={},s(l,o[c])):typeof l=="string"&&(o[c]=`var(${l})`)}return r(t,e),s(e,n),{cssVariables:e,cssVariablesVarPrefix:n}},assignCSSVariables(t,e){const n={};function r(s,i,o){for(const[c,l]of Object.entries(s)){const d=o?`${o}-${c}`:c,u=i[c];l&&typeof l=="object"?r(l,u,d):typeof u=="string"&&(n[`${m6}-${d}`]=u)}}return r(t,e),n},createRootStyles(t,e){const n={...q_,tokens:{...q_.tokens,theme:t==="light"?WE.light:WE.dark}},{cssVariables:r}=Kc.createCSSVariables(n),s=Kc.assignCSSVariables(r,n),i=Kc.generateW3MVariables(e),o=Kc.generateW3MOverrides(e),c=Kc.generateScaledVariables(e),l=Kc.generateBaseVariables(s),d={...s,...l,...i,...o,...c},u=Kc.applyColorMixToVariables(e,d),h={...d,...u};return`:root {${Object.entries(h).map(([p,m])=>`${p}:${m.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e={};return e["--w3m-font-family"]=t["--w3m-font-family"]||"KHTeka",e["--w3m-accent"]=t["--w3m-accent"]||"#0988F0",e["--w3m-color-mix"]=t["--w3m-color-mix"]||"#000",e["--w3m-color-mix-strength"]=`${t["--w3m-color-mix-strength"]||0}%`,e["--w3m-font-size-master"]=t["--w3m-font-size-master"]||"10px",e["--w3m-border-radius-master"]=t["--w3m-border-radius-master"]||"4px",e},generateW3MOverrides(t){if(!t)return{};const e={};if(t["--w3m-accent"]){const n=t["--w3m-accent"];e["--apkt-tokens-core-iconAccentPrimary"]=n,e["--apkt-tokens-core-borderAccentPrimary"]=n,e["--apkt-tokens-core-textAccentPrimary"]=n,e["--apkt-tokens-core-backgroundAccentPrimary"]=n}return t["--w3m-font-family"]&&(e["--apkt-fontFamily-regular"]=t["--w3m-font-family"]),t["--w3m-z-index"]&&(e["--apkt-tokens-core-zIndex"]=`${t["--w3m-z-index"]}`),e},generateScaledVariables(t){if(!t)return{};const e={};if(t["--w3m-font-size-master"]){const n=parseFloat(t["--w3m-font-size-master"].replace("px",""));e["--apkt-textSize-h1"]=`${Number(n)*5}px`,e["--apkt-textSize-h2"]=`${Number(n)*4.4}px`,e["--apkt-textSize-h3"]=`${Number(n)*3.8}px`,e["--apkt-textSize-h4"]=`${Number(n)*3.2}px`,e["--apkt-textSize-h5"]=`${Number(n)*2.6}px`,e["--apkt-textSize-h6"]=`${Number(n)*2}px`,e["--apkt-textSize-large"]=`${Number(n)*1.6}px`,e["--apkt-textSize-medium"]=`${Number(n)*1.4}px`,e["--apkt-textSize-small"]=`${Number(n)*1.2}px`}if(t["--w3m-border-radius-master"]){const n=parseFloat(t["--w3m-border-radius-master"].replace("px",""));e["--apkt-borderRadius-1"]=`${Number(n)}px`,e["--apkt-borderRadius-2"]=`${Number(n)*2}px`,e["--apkt-borderRadius-3"]=`${Number(n)*3}px`,e["--apkt-borderRadius-4"]=`${Number(n)*4}px`,e["--apkt-borderRadius-5"]=`${Number(n)*5}px`,e["--apkt-borderRadius-6"]=`${Number(n)*6}px`,e["--apkt-borderRadius-8"]=`${Number(n)*8}px`,e["--apkt-borderRadius-16"]=`${Number(n)*16}px`,e["--apkt-borderRadius-20"]=`${Number(n)*20}px`,e["--apkt-borderRadius-32"]=`${Number(n)*32}px`,e["--apkt-borderRadius-64"]=`${Number(n)*64}px`,e["--apkt-borderRadius-128"]=`${Number(n)*128}px`}return e},generateColorMixCSS(t,e){if(!(t!=null&&t["--w3m-color-mix"])||!t["--w3m-color-mix-strength"])return"";const n=t["--w3m-color-mix"],r=t["--w3m-color-mix-strength"];if(!r||r===0)return"";const s=Object.keys(e||{}).filter(o=>{const c=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),l=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return c&&!l});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const c=(e==null?void 0:e[o])||"";return c.includes("color-mix")||c.startsWith("#")||c.startsWith("rgb")?`${o}: color-mix(in srgb, ${n} ${r}%, ${c});`:`${o}: color-mix(in srgb, ${n} ${r}%, var(${o}-base, ${c}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},n=t["--apkt-tokens-theme-backgroundPrimary"];n&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=n);const r=t["--apkt-tokens-core-backgroundAccentPrimary"];return r&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=r),e},applyColorMixToVariables(t,e){const n={};if(e!=null&&e["--apkt-tokens-theme-backgroundPrimary"]&&(n["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e!=null&&e["--apkt-tokens-core-backgroundAccentPrimary"]&&(n["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)"),!(t!=null&&t["--w3m-color-mix"])||!t["--w3m-color-mix-strength"])return n;const r=t["--w3m-color-mix"],s=t["--w3m-color-mix-strength"];if(!s||s===0)return n;const i=Object.keys(e||{}).filter(o=>{const c=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon")||o.includes("-tokens-theme-overlay"),l=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return c&&!l});return i.length===0||i.forEach(o=>{const c=(e==null?void 0:e[o])||"";o.endsWith("-base")||(o==="--apkt-tokens-theme-backgroundPrimary"||o==="--apkt-tokens-core-backgroundAccentPrimary"?n[o]=`color-mix(in srgb, ${r} ${s}%, var(${o}-base))`:c.includes("color-mix")||c.startsWith("#")||c.startsWith("rgb")?n[o]=`color-mix(in srgb, ${r} ${s}%, ${c})`:n[o]=`color-mix(in srgb, ${r} ${s}%, var(${o}-base, ${c}))`)}),n}},{cssVariablesVarPrefix:oSe}=Kc.createCSSVariables(q_);function URe(t,...e){return bd(t,...e.map(n=>ta(typeof n=="function"?n(oSe):n)))}let Xu,vh,uc,Wi,qE;const Vc={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function KE(t,e="dark"){Xu&&document.head.removeChild(Xu),Xu=document.createElement("style"),Xu.textContent=Kc.createRootStyles(e,t),document.head.appendChild(Xu)}function MRe(t,e="dark"){if(qE=t,vh=document.createElement("style"),uc=document.createElement("style"),Wi=document.createElement("style"),vh.textContent=fm(t).core.cssText,uc.textContent=fm(t).dark.cssText,Wi.textContent=fm(t).light.cssText,document.head.appendChild(vh),document.head.appendChild(uc),document.head.appendChild(Wi),KE(t,e),K_(e),!(t!=null&&t["--w3m-font-family"]))for(const[n,r]of Object.entries(Vc)){const s=document.createElement("link");s.rel="preload",s.href=r,s.as="font",s.type=n.includes("woff2")?"font/woff2":"font/woff",s.crossOrigin="anonymous",document.head.appendChild(s)}K_(e)}function K_(t="dark"){uc&&Wi&&Xu&&(t==="light"?(KE(qE,t),uc.removeAttribute("media"),Wi.media="enabled"):(KE(qE,t),Wi.removeAttribute("media"),uc.media="enabled"))}function aSe(t){var e,n,r;if(qE=t,vh&&uc&&Wi&&(vh.textContent=fm(t).core.cssText,uc.textContent=fm(t).dark.cssText,Wi.textContent=fm(t).light.cssText,t!=null&&t["--w3m-font-family"])){const s=t["--w3m-font-family"];vh.textContent=(e=vh.textContent)==null?void 0:e.replace("font-family: KHTeka",`font-family: ${s}`),uc.textContent=(n=uc.textContent)==null?void 0:n.replace("font-family: KHTeka",`font-family: ${s}`),Wi.textContent=(r=Wi.textContent)==null?void 0:r.replace("font-family: KHTeka",`font-family: ${s}`)}if(Xu){const s=(Wi==null?void 0:Wi.media)==="enabled"?"light":"dark";KE(t,s)}}function fm(t){const e=!!(t!=null&&t["--w3m-font-family"]);return{core:bd`
      ${e?bd``:bd`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${ta(Vc["KHTeka-400-woff2"])}) format('woff2'),
                url(${ta(Vc["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${ta(Vc["KHTeka-300-woff2"])}) format('woff2'),
                url(${ta(Vc["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${ta(Vc["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${ta(Vc["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${ta(Vc["KHTeka-400-woff2"])}) format('woff2'),
                url(${ta(Vc["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:bd`
      :root {
      }
    `,light:bd`
      :root {
      }
    `}}const LRe=bd`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,BRe=bd`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,ef={hexStringToNumber(t){const e=t.startsWith("0x")?t.slice(2):t;return parseInt(e,16)},numberToHexString(t){return`0x${t.toString(16)}`},async getUserInfo(t){const[e,n]=await Promise.all([ef.getAddresses(t),ef.getChainId(t)]);return{chainId:n,addresses:e}},async getChainId(t){const e=await t.request({method:"eth_chainId"});return Number(e)},async getAddress(t){const[e]=await t.request({method:"eth_accounts"});return e},async getAddresses(t){return await t.request({method:"eth_accounts"})},async addEthereumChain(t,e){var r,s;const n=((r=e.rpcUrls.chainDefault)==null?void 0:r.http)||[];await t.request({method:"wallet_addEthereumChain",params:[{chainId:ef.numberToHexString(e.id),rpcUrls:[...n],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[oc.NetworkImageIds[e.id]]}]})}},yp={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},cSe=Use({id:56,name:"BNB Smart Chain",blockTime:750,nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://56.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}});function r0(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const g6=r0({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),y6=r0({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});r0({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});r0({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});r0({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});r0({id:"00000008819873e925422c1ff0f99f7c",caipNetworkId:"bip122:00000008819873e925422c1ff0f99f7c",chainNamespace:"bip122",name:"Bitcoin Signet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const Wz={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Zi={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return Wz[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[c,l]=i.split(":");!c||!l||!n[c]||(n[c].rpcMap||(n[c].rpcMap={}),s.has(c)||(n[c].rpcMap={},s.add(c)),n[c].rpcMap[l]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:c}=s,l=c.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const d=`${o}:${i}`,u=r[o];switch(u.chains.push(d),d){case g6.caipNetworkId:u.chains.push(g6.deprecatedCaipNetworkId);break;case y6.caipNetworkId:u.chains.push(y6.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&l&&(u.rpcMap[i]=l),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{var r;const e=await Ny.resolveName(t);return((r=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:r.address)||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.code=="number",r=n&&e.code===Zi.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=n&&e.code===Zi.RPC_ERROR_CODE.USER_REJECTED;return r||s}return!1}catch{return!1}},isOriginAllowed(t,e,n){for(const r of[...e,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(r).origin===t)return!0}catch{if(r===t)return!0}return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const c=Zi.getWalletConnectAccounts(t,e);n(c)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("accountsChanged",c=>{var l,d,u,h,f;try{const p=((u=(d=(l=t.session)==null?void 0:l.namespaces)==null?void 0:d[e])==null?void 0:u.accounts)||[],m=(f=(h=t.rpcProviders)==null?void 0:h[e])==null?void 0:f.getDefaultChain(),g=c.map(y=>{const x=p.find(v=>v.includes(`${e}:${m}:${y}`));if(!x)return;const{chainId:w,chainNamespace:b}=jr.parseCaipAddress(x);return{address:y,chainId:w,chainNamespace:b}}).filter(y=>y!==void 0);g.length>0&&s(g)}catch(p){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,c,p)}}),i&&t.on("chainChanged",c=>{i(c)}),o&&t.on("display_uri",c=>{o(c)})},getWalletConnectAccounts(t,e){var s,i,o,c;const n=new Set,r=(c=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:c.map(l=>jr.parseCaipAddress(l)).filter(({address:l})=>n.has(l.toLowerCase())?!1:(n.add(l.toLowerCase()),!0));return r&&r.length>0?r:[]}};class lSe{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case ne.CHAIN.EVM:await this.syncEVMConnections(e);break;case ne.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case ne.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:c,hasConnected:l}=nr.getConnectorStorageInfo(o.id,this.namespace);return!c&&l}).map(async o=>{if(o.id===ne.CONNECTOR_ID.WALLET_CONNECT){const c=Zi.getWalletConnectAccounts(r,this.namespace),l=n.find(d=>{var u,h;return d.chainNamespace===this.namespace&&d.id.toString()===((h=(u=c[0])==null?void 0:u.chainId)==null?void 0:h.toString())});c.length>0&&s({connectorId:o.id,accounts:c.map(d=>({address:d.address})),caipNetwork:l})}else{const{accounts:c,chainId:l}=await y1.fetchProviderData(o);if(c.length>0&&l){const d=n.find(u=>u.chainNamespace===this.namespace&&u.id.toString()===l.toString());s({connectorId:o.id,accounts:c.map(u=>({address:u})),caipNetwork:d}),o.provider&&o.id!==ne.CONNECTOR_ID.AUTH&&o.id!==ne.CONNECTOR_ID.WALLET_CONNECT&&i(o.id,o.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:c,hasConnected:l}=nr.getConnectorStorageInfo(o.id,this.namespace);return!c&&l}).map(async o=>{if(o.id===ne.CONNECTOR_ID.WALLET_CONNECT){const c=Zi.getWalletConnectAccounts(r,this.namespace);c.length>0&&s({connectorId:o.id,accounts:c.map(l=>({address:l.address})),caipNetwork:n})}else{const c=await o.connect({chainId:n==null?void 0:n.id});c&&(s({connectorId:o.id,accounts:[{address:c}],caipNetwork:n}),i(o.id,o.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:c,hasConnected:l}=nr.getConnectorStorageInfo(o.id,this.namespace);return!c&&l}).map(async o=>{var h,f,p,m,g,y;if(o.id===ne.CONNECTOR_ID.WALLET_CONNECT){const x=Zi.getWalletConnectAccounts(r,this.namespace);x.length>0&&s({connectorId:o.id,accounts:x.map(w=>({address:w.address})),caipNetwork:n});return}const c=await o.connect(),l=await o.getAccountAddresses();let d=l==null?void 0:l.map(x=>Be.createAccount(ne.CHAIN.BITCOIN,x.address,x.purpose||"payment",x.publicKey,x.path));if(d&&d.length>1&&(d=[{namespace:ne.CHAIN.BITCOIN,publicKey:((h=d[yp.ACCOUNT_INDEXES.PAYMENT])==null?void 0:h.publicKey)??"",path:((f=d[yp.ACCOUNT_INDEXES.PAYMENT])==null?void 0:f.path)??"",address:((p=d[yp.ACCOUNT_INDEXES.PAYMENT])==null?void 0:p.address)??"",type:"payment"},{namespace:ne.CHAIN.BITCOIN,publicKey:((m=d[yp.ACCOUNT_INDEXES.ORDINAL])==null?void 0:m.publicKey)??"",path:((g=d[yp.ACCOUNT_INDEXES.ORDINAL])==null?void 0:g.path)??"",address:((y=d[yp.ACCOUNT_INDEXES.ORDINAL])==null?void 0:y.address)??"",type:"ordinal"}]),!(o.chains.find(x=>x.id===(n==null?void 0:n.id))||o.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(i(o.id,o.provider),s({connectorId:o.id,accounts:d.map(x=>({address:x.address,type:x.type,publicKey:x.publicKey,path:x.path})),caipNetwork:n}))}))}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(d=>nr.isLowerCaseMatch(d.connectorId,n));if(!o)return null;const c=s.find(d=>nr.isLowerCaseMatch(d.id,o.connectorId)),l=e?o.accounts.find(d=>nr.isLowerCaseMatch(d.address,e)):o.accounts[0];return{...o,account:l,connector:c}}const i=r.find(o=>o.accounts.length>0&&s.some(c=>nr.isLowerCaseMatch(c.id,o.connectorId)));if(i){const[o]=i.accounts,c=s.find(l=>nr.isLowerCaseMatch(l.id,i.connectorId));return{...i,account:o,connector:c}}return null}}const hc={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class Bj{constructor({provider:e,namespace:n}){this.id=ne.CONNECTOR_ID.WALLET_CONNECT,this.name=oc.ConnectorNamesMap[ne.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=oc.ConnectorImageIds[ne.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=$.getCaipNetworks.bind($),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=fe.state.universalProviderConfigOverride,s=Zi.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return qi.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:dSe})}}const dSe=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],uSe=[ne.CONNECTOR_ID.AUTH,ne.CONNECTOR_ID.WALLET_CONNECT];class qz{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>$.getCaipNetworks(n),this.getConnectorId=n=>Ie.getConnectorId(n),e&&this.construct(e),e!=null&&e.namespace&&(this.connectionManager=new lSe({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===(n==null?void 0:n.toString()));e&&r&&this.addConnection({connectorId:ne.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:ne.CONNECTOR_ID.AUTH,type:"AUTH",name:ne.CONNECTOR_NAMES.AUTH,provider:e,imageId:oc.ConnectorImageIds[ne.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>!nr.isLowerCaseMatch(n.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){$.setAccountProp("status",e,n)}on(e,n){var r;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(r=this.eventListeners.get(e))==null||r.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(n){throw Zi.isUserRejectedRequestError(n)?new WI(n):n}}async switchNetwork(e){const{caipNetwork:n,providerType:r}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=Ws(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const c=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n instanceof Bj);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=Be.getAccount(e[0]),i=this.getCaipNetworks().filter(c=>c.chainNamespace===this.namespace).find(c=>c.id.toString()===(s==null?void 0:s.toString())),o=this.connectors.find(c=>c.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(c=>{const{address:l}=Be.getAccount(c);return{address:l}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){var s,i;if(e.length>0){const{address:o}=Be.getAccount(e[0]),c=(s=this.connectionManager)==null?void 0:s.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});o&&nr.isLowerCaseMatch(this.getConnectorId(ne.CHAIN.EVM),n)&&this.emit("accountChanged",{address:o,chainId:(i=c==null?void 0:c.caipNetwork)==null?void 0:i.id,connector:c==null?void 0:c.connector}),this.addConnection({connectorId:n,accounts:e.map(l=>{const{address:d}=Be.getAccount(l);return{address:d}}),caipNetwork:c==null?void 0:c.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),nr.isLowerCaseMatch(this.getConnectorId(ne.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){var o;const r=typeof e=="string"&&e.startsWith("0x")?ef.hexStringToNumber(e).toString():e.toString(),s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(c=>c.chainNamespace===this.namespace).find(c=>c.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),nr.isLowerCaseMatch(this.getConnectorId(ne.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(uSe.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){var n,r;const e=(n=this.connectionManager)==null?void 0:n.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[s]=e.accounts;this.emit("accountChanged",{address:s==null?void 0:s.address,chainId:(r=e.caipNetwork)==null?void 0:r.id,connector:e.connector})}}}class hSe extends qz{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new Bj({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){var s,i,o,c;const n=this.provider,r=((c=(o=(i=(s=n==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:c.map(l=>{const[,,d]=l.split(":");return d}).filter((l,d,u)=>u.indexOf(l)===d))||[];return Promise.resolve({accounts:r.map(l=>Be.createAccount(e,l,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var o,c,l,d,u;if(!(e.caipNetwork&&Vt.BALANCE_SUPPORTED_CHAINS.includes((o=e.caipNetwork)==null?void 0:o.chainNamespace))||(c=e.caipNetwork)!=null&&c.testnet)return{balance:"0.00",symbol:((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""};const r=$.getAccountData();if(r!=null&&r.balanceLoading&&e.chainId===((d=$.state.activeCaipNetwork)==null?void 0:d.id))return{balance:(r==null?void 0:r.balance)||"0.00",symbol:(r==null?void 0:r.balanceSymbol)||""};const i=(await $.fetchTokenBalance()).find(h=>{var f,p;return h.chainId===`${(f=e.caipNetwork)==null?void 0:f.chainNamespace}:${e.chainId}`&&h.symbol===((p=e.caipNetwork)==null?void 0:p.nativeCurrency.symbol)});return{balance:(i==null?void 0:i.quantity.numeric)||"0.00",symbol:(i==null?void 0:i.symbol)||((u=e.caipNetwork)==null?void 0:u.nativeCurrency.symbol)||""}}async signMessage(e){var o,c,l;const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=$.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===ne.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:Jg.encode(new TextEncoder().encode(r)),pubkey:s}},(c=$.state.activeCaipNetwork)==null?void 0:c.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},(l=$.state.activeCaipNetwork)==null?void 0:l.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,c,l,d;const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===ne.CHAIN.EVM)try{await((s=r.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:FO(n.id)}]}))}catch(u){if(u.code===hc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===hc.ERROR_INVALID_CHAIN_ID||u.code===hc.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===hc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((d=r.provider)==null?void 0:d.request({method:"wallet_addEthereumChain",params:[{chainId:FO(n.id),rpcUrls:[(c=n==null?void 0:n.rpcUrls.chainDefault)==null?void 0:c.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[(l=n.blockExplorers)==null?void 0:l.default.url]}]}))}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(r=>r.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}const fSe=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],Av={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Vt.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Vt.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Vt.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Vt.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Vt.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Vt.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?Vt.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t}},pSe={localSettingsOverridden:new Set,getApiConfig(t,e){return e==null?void 0:e.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=Av[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=Av[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const c=this.getApiConfig(i.apiFeatureName,n);return(c==null?void 0:c.config)===null?this.processFallbackFeature(t,o):c!=null&&c.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,c)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Av[t].processApi(e)},processFallbackFeature(t,e){return Av[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await dt.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Vt.DEFAULT_REMOTE_FEATURES:Vt.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of fSe){const c=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:c})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Vt.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;_s.open({debugMessage:ks.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class mSe{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{var s,i,o;if(n){const c=(s=$.getCaipNetworks(n))==null?void 0:s.find(u=>u.id===r);if(c)return c;const l=(i=$.getNetworkData(n))==null?void 0:i.caipNetwork;return l||((o=$.getRequestedCaipNetworks(n).filter(u=>u.chainNamespace===n))==null?void 0:o[0])}return $.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>$.getCaipNetworks(n),this.getActiveChainNamespace=()=>$.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{$.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>$.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>{var r,s;return $.state.activeChain===n||!n?$.state.activeCaipAddress:(s=(r=$.state.chains.get(n))==null?void 0:r.accountState)==null?void 0:s.caipAddress},this.setClientId=n=>{yt.setClientId(n)},this.getProvider=n=>Jt.getProvider(n),this.getProviderType=n=>Jt.getProviderId(n),this.getPreferredAccountType=n=>Ws(n),this.setCaipAddress=(n,r,s=!1)=>{$.setAccountProp("caipAddress",n,r,s),$.setAccountProp("address",Be.getPlainAddress(n),r,s)},this.setBalance=(n,r,s)=>{$.setAccountProp("balance",n,s),$.setAccountProp("balanceSymbol",r,s)},this.setProfileName=(n,r)=>{$.setAccountProp("profileName",n,r)},this.setProfileImage=(n,r)=>{$.setAccountProp("profileImage",n,r)},this.setUser=(n,r)=>{$.setAccountProp("user",n,r)},this.resetAccount=n=>{$.resetAccount(n)},this.setCaipNetwork=n=>{$.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{$.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{$.setAccountProp("status",n,r),Ie.isConnected()?ye.setConnectionStatus("connected"):ye.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>{var r;return(r=$.getAccountData(n))==null?void 0:r.address},this.setConnectors=n=>{const r=[...Ie.state.allConnectors,...n];Ie.setConnectors(r)},this.setConnections=(n,r)=>{ye.setConnections(n,r),De.setConnections(n,r)},this.fetchIdentity=n=>yt.fetchIdentity(n),this.getReownName=n=>Ny.getNamesForAddress(n),this.getConnectors=()=>Ie.getConnectors(),this.getConnectorImage=n=>dF.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?wE.getConnectionsData(n).connections:(_s.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?wE.getConnectionsData(n).recentConnections:(_s.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){_s.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await De.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){_s.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}ye.deleteAddressFromConnection(n),De.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=Jt.getProviderId(r),i=n?{...n,type:s}:void 0;$.setAccountProp("connectedWalletInfo",i,r)},this.getIsConnectedState=()=>!!$.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{var o;const i=((o=$.getAccountData(s))==null?void 0:o.addressLabels)||{};$.setAccountProp("addressLabels",{...i,[n]:r},s)},this.removeAddressLabel=(n,r)=>{var i;const s=((i=$.getAccountData(r))==null?void 0:i.addressLabels)||{};$.setAccountProp("addressLabels",{...s,[n]:void 0},r)},this.getAddress=n=>{var s;const r=n||$.state.activeChain;return(s=$.getAccountData(r))==null?void 0:s.address},this.setApprovedCaipNetworksData=n=>$.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{$.resetNetwork(n)},this.addConnector=n=>{Ie.addConnector(n)},this.resetWcConnection=()=>{De.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{$.setAccountProp("addressExplorerUrl",n,r)},this.setSmartAccountDeployed=(n,r)=>{$.setAccountProp("smartAccountDeployed",n,r)},this.setPreferredAccountType=(n,r)=>{$.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{fe.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e),cCe.checkSDKVersion(e.sdkVersion)}getChainNamespacesSet(e,n){const r=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(r!=null&&r.length)return[...new Set(r)];const s=n==null?void 0:n.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var n,r,s,i,o;if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),fe.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await pSe.fetchRemoteFeatures(e),fe.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&HT.setOnrampProviders(this.remoteFeatures.onramp),((n=fe.state.remoteFeatures)!=null&&n.email||Array.isArray((r=fe.state.remoteFeatures)==null?void 0:r.socials)&&((s=fe.state.remoteFeatures)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins(),(i=fe.state.features)!=null&&i.reownAuthentication||(o=fe.state.remoteFeatures)!=null&&o.reownAuthentication){const{ReownAuthentication:c}=await $n(async()=>{const{ReownAuthentication:d}=await import("./features-DRZu5TbV.js");return{ReownAuthentication:d}},[]),l=fe.state.siwx;l instanceof c||(l&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),fe.setSIWX(new c))}}async openSend(e){var i;const n=e.namespace||$.state.activeChain,r=this.getCaipAddress(n),s=(i=this.getCaipNetwork(n))==null?void 0:i.id;if(!r)throw new Error("openSend: caipAddress not found");if((s==null?void 0:s.toString())!==e.chainId.toString()){const o=$.getCaipNetworkById(e.chainId,n);if(!o)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(o,{throwOnFailure:!0})}try{const o=kz.getTokenSymbolByAddress(e.assetAddress);o&&await dt.fetchTokenImages([o])}catch{}return await Dt.open({view:"WalletSend",data:{send:e}}),new Promise((o,c)=>{const l=Pt.subscribeKey("hash",h=>{h&&(u(),o({hash:h}))}),d=Dt.subscribe(h=>{h.open||(u(),c(new Error("Modal closed")))}),u=this.createCleanupHandler([l,d])})}toModalOptions(){function e(r){return(r==null?void 0:r.view)==="Swap"}function n(r){return(r==null?void 0:r.view)==="WalletSend"}return{isSwap:e,isSend:n}}async checkAllowedOrigins(){try{const e=await dt.fetchAllowedOrigins();if(!Be.isClient())return;const n=window.location.origin;Zi.isOriginAllowed(n,e,hc.DEFAULT_ALLOWED_ANCESTORS)||_s.open(ks.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":_s.open(ks.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;_s.open({displayMessage:ks.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:ks.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(n=>{try{n()}catch{}})}}sendInitializeEvent(e){var r;const{...n}=e;delete n.adapters,delete n.universalProvider,Lt.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(s=>s.id),siweConfig:{options:((r=e.siweConfig)==null?void 0:r.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&fi.setThemeMode(e.themeMode),e.themeVariables&&fi.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");$.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&$.setActiveCaipNetwork(n)}initializeConnectionController(e){De.initialize(e.adapters??[]),De.setWcBasic(e.basic??!1)}initializeConnectorController(){Ie.initialize(this.chainNamespaces)}initializeProjectSettings(e){fe.setProjectId(e.projectId),fe.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var s;fe.setDebug(e.debug!==!1),fe.setEnableWalletGuide(e.enableWalletGuide!==!1),fe.setEnableWallets(e.enableWallets!==!1),fe.setEIP6963Enabled(e.enableEIP6963!==!1),fe.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),fe.setEnableReconnect(e.enableReconnect!==!1),fe.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),fe.setEnableAuthLogger(e.enableAuthLogger!==!1),fe.setCustomRpcUrls(e.customRpcUrls),fe.setEnableEmbedded(e.enableEmbedded),fe.setAllWallets(e.allWallets),fe.setIncludeWalletIds(e.includeWalletIds),fe.setExcludeWalletIds(e.excludeWalletIds),fe.setFeaturedWalletIds(e.featuredWalletIds),fe.setTokens(e.tokens),fe.setTermsConditionsUrl(e.termsConditionsUrl),fe.setPrivacyPolicyUrl(e.privacyPolicyUrl),fe.setCustomWallets(e.customWallets),fe.setFeatures(e.features),fe.setAllowUnsupportedChain(e.allowUnsupportedChain),fe.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),fe.setPreferUniversalLinks(e.experimental_preferUniversalLinks),fe.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),fe.setMetadata(e.metadata),fe.setDisableAppend(e.disableAppend),fe.setEnableEmbedded(e.enableEmbedded),fe.setSIWX(e.siwx),this.features=fe.state.features??{},!e.projectId){_s.open(ks.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((s=e.adapters)==null?void 0:s.find(i=>i.namespace===ne.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");fe.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,n,r,s;return Be.isClient()?{name:((n=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:n.textContent)||"",description:((r=document.querySelector('meta[property="og:description"]'))==null?void 0:r.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=Cp.getUnsupportedNetwork(`${n}:${e}`);$.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Cp.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return Cp.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return Cp.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return n?Cp.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,n){var r,s;try{this.setLoading(!0,e);let i={connections:[]};const o=this.getAdapter(e);return(((s=(r=$.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.caipAddress)||!fe.state.enableReconnect)&&(o!=null&&o.disconnect)&&(i=await o.disconnect({id:n})),this.setLoading(!1,e),i}catch(i){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${i.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var d;const e=$.state.activeChain,n=this.getAdapter(e),r=(d=this.getCaipNetwork(e))==null?void 0:d.id,s=De.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const c=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId((c==null?void 0:c.clientId)||null),ye.setConnectedNamespaces([...$.state.chains.keys()]),await this.syncWalletConnectAccount(),await qi.initializeIfEnabled()},connectExternal:async e=>{const n=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,n),n?{address:n.address}:void 0},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{var c;const i=$.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:n,type:r,provider:s,chainId:(c=this.getCaipNetwork())==null?void 0:c.id})),ye.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{var d;const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||$.state.activeChain,o=Ie.getConnectorId(i),c=n===ne.CONNECTOR_ID.AUTH||o===ne.CONNECTOR_ID.AUTH,l=n===ne.CONNECTOR_ID.WALLET_CONNECT||o===ne.CONNECTOR_ID.WALLET_CONNECT;try{const u=Array.from($.state.chains.keys());let h=r?[r]:u;(l||c)&&(h=u);const f=h.map(async g=>{const y=Ie.getConnectorId(g),x=n||y,w=await this.disconnectConnector(g,x);w&&(c&&ye.deleteConnectedSocialProvider(),w.connections.forEach(b=>{ye.addDisconnectedConnectorId(b.connectorId,g)})),s&&this.onDisconnectNamespace({chainNamespace:g,closeModal:!1})}),p=await Promise.allSettled(f);Pt.resetSend(),De.resetWcConnection(),(d=qi.getSIWX())!=null&&d.signOutOnDisconnect&&await qi.clearSessions(),Ie.setFilterByNamespace(void 0),De.syncStorageConnections();const m=p.filter(g=>g.status==="rejected");if(m.length>0)throw new Error(m.map(g=>g.reason.message).join(", "));Lt.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(u){throw new Error(`Failed to disconnect chains: ${u.message}`)}},checkInstalled:e=>e?e.some(n=>{var r;return!!((r=window.ethereum)!=null&&r[String(n)])}):!!window.ethereum,signMessage:async e=>{const n=$.state.activeChain,r=this.getAdapter($.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=this.getAddress(n);if(!s)throw new Error("signMessage: address not found");const i=await(r==null?void 0:r.signMessage({message:e,address:s,provider:Jt.getProvider(n)}));return(i==null?void 0:i.signature)||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Vt.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=Jt.getProvider(n),i=await(r==null?void 0:r.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===ne.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=Jt.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");const o=await(r==null?void 0:r.estimateGas({...e,provider:s,caipNetwork:i}));return(o==null?void 0:o.gas)||0n}return 0n},getEnsAvatar:async()=>{var s;const e=$.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const n=this.getAddress(e);if(!n)throw new Error("getEnsAvatar: address not found");await this.syncIdentity({address:n,chainId:Number((s=this.getCaipNetwork())==null?void 0:s.id),chainNamespace:e});const r=$.getAccountData();return(r==null?void 0:r.profileImage)||!1},getEnsAddress:async e=>await Zi.resolveReownName(e),writeContract:async e=>{const n=$.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=Jt.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");const c=await(r==null?void 0:r.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}));return c==null?void 0:c.hash},parseUnits:(e,n)=>{const r=this.getAdapter($.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return(r==null?void 0:r.parseUnits({value:e,decimals:n}))??0n},formatUnits:(e,n)=>{const r=this.getAdapter($.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return(r==null?void 0:r.formatUnits({value:e,decimals:n}))??"0"},getCapabilities:async e=>{const n=this.getAdapter($.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await(n==null?void 0:n.getCapabilities(e))},grantPermissions:async e=>{const n=this.getAdapter($.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await(n==null?void 0:n.grantPermissions(e))},revokePermissions:async e=>{const n=this.getAdapter($.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n!=null&&n.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter($.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await(n==null?void 0:n.walletGetAssets(e))??{}},updateBalance:e=>{const n=this.getAddress(e),r=this.getCaipNetwork(e);!r||!n||this.updateNativeBalance(n,r==null?void 0:r.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},De.setClient(this.connectionControllerClient)}async onConnectExternal(e){var d,u,h,f,p,m,g,y;const n=$.state.activeChain,r=e.chain||n,s=this.getAdapter(r);let i=!0;if(e.type===Wt.CONNECTOR_TYPE_AUTH&&ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(b=>Ie.getConnectorId(b)===ne.CONNECTOR_ID.AUTH)&&e.chain!==n&&(i=!1),e.chain&&e.chain!==n&&!e.caipNetwork){const x=this.getCaipNetworks().find(w=>w.chainNamespace===e.chain);x&&i&&this.setCaipNetwork(x)}if(!r)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(r),c=e.caipNetwork||o,l=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:((d=e.caipNetwork)==null?void 0:d.id)||(o==null?void 0:o.id),rpcUrl:((p=(f=(h=(u=e.caipNetwork)==null?void 0:u.rpcUrls)==null?void 0:h.default)==null?void 0:f.http)==null?void 0:p[0])||((y=(g=(m=o==null?void 0:o.rpcUrls)==null?void 0:m.default)==null?void 0:g.http)==null?void 0:y[0])});if(l)return ye.addConnectedNamespace(r),this.syncProvider({...l,chainNamespace:r}),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),ye.removeDisconnectedConnectorId(e.id,r),{address:l.address,connectedCaipNetwork:c}}async connectInactiveNamespaces(e,n){var l;const r=e.type===Wt.CONNECTOR_TYPE_AUTH,s=nr.getOtherAuthNamespaces((l=n==null?void 0:n.connectedCaipNetwork)==null?void 0:l.chainNamespace),i=$.state.activeCaipNetwork,o=this.getAdapter(i==null?void 0:i.chainNamespace),c=Jt.getProvider(i==null?void 0:i.chainNamespace);r&&(await Promise.all(s.map(async d=>{var u,h,f;try{const p=Jt.getProvider(d),m=this.getCaipNetwork(d),g=this.getAdapter(d);await(g==null?void 0:g.connect({...e,provider:p,socialUri:void 0,chainId:m==null?void 0:m.id,rpcUrl:(f=(h=(u=m==null?void 0:m.rpcUrls)==null?void 0:u.default)==null?void 0:h.http)==null?void 0:f[0]}))&&(ye.addConnectedNamespace(d),ye.removeDisconnectedConnectorId(e.id,d),this.setStatus("connected",d),this.syncConnectedWalletInfo(d))}catch(p){_s.warn(ks.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,ks.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(d,p instanceof Error?p.message:void 0),ks.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await(o==null?void 0:o.switchNetwork({caipNetwork:i,provider:c,providerType:e.type})))}getApprovedCaipNetworksData(){var n,r,s,i,o;if(Jt.getProviderId($.state.activeChain)===Wt.CONNECTOR_TYPE_WALLET_CONNECT){const c=(r=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:r.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(c)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=Jt.getProvider(n),i=Jt.getProviderId(n);if(e.chainNamespace===$.state.activeChain){const o=this.getAdapter(n);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===Wt.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:c}=jr.parseCaipAddress(i);return`${c}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{var i,o;const s=e==null?void 0:e.find(c=>c.namespace===r);return s?(s.construct({namespace:r,projectId:(i=this.options)==null?void 0:i.projectId,networks:(o=this.caipNetworks)==null?void 0:o.filter(({chainNamespace:c})=>c===r)}),n[r]=s):n[r]=new hSe({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){var n;this.onConnectors(e),this.listenAdapter(e),await((n=this.chainAdapters)==null?void 0:n[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const n=this.getAdapter(e);n==null||n.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=ye.getConnectionStatus();fe.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(ye.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{var d,u;const o=this.getCaipNetworks().find(h=>h.id.toString()===i.toString()||h.caipNetworkId.toString()===i.toString()),c=$.state.activeChain===e,l=(u=(d=$.state.chains.get(e))==null?void 0:d.accountState)==null?void 0:u.address;if(o){const h=c&&s?s:l;h&&this.syncAccount({address:h,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(De.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=this.getAddress(e),i=$.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{var u,h;this.handlePreviousConnectorConnection(o);const c=$.state.activeChain===e;o!=null&&o.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o==null?void 0:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const l=(h=(u=$.getNetworkData(e))==null?void 0:u.caipNetwork)==null?void 0:h.id,d=i||l;c&&d?this.syncAccount({address:s,chainId:d,chainNamespace:e}):!c&&d?(this.syncAccountInfo(s,d,e),this.syncBalance({address:s,chainId:d,chainNamespace:e})):this.syncAccountInfo(s,i,e),ye.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){var l;const n=e==null?void 0:e.chain,r=e==null?void 0:e.id,s=Ie.getConnectorId(n),i=(l=fe.state.remoteFeatures)==null?void 0:l.multiWallet,c=n&&r&&s&&s!==r&&!i;try{c&&await De.disconnect({id:s,namespace:n})}catch(d){console.warn("Error disconnecting previous connector",d)}}async createUniversalProviderForAdapter(e){var n,r,s;await this.getUniversalProvider(),this.universalProvider&&await((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setUniversalProvider)==null?void 0:s.call(r,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>De.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||ye.deleteRecentWallet();const n=ye.getRecentWallet();Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:Be.isMobile()?"mobile":"qrcode",name:(n==null?void 0:n.name)||"Unknown",reconnect:!0,view:ut.state.view,walletRank:n==null?void 0:n.order}})}async syncNamespaceConnection(e){try{e===ne.CHAIN.EVM&&Be.isSafeApp()&&Ie.setConnectorId(ne.CONNECTOR_ID.SAFE,e);const n=Ie.getConnectorId(e);switch(this.setStatus("connecting",e),n){case ne.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case ne.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};$.resetAccount(n),$.resetNetwork(n),ye.removeConnectedNamespace(n);const s=Array.from($.state.chains.keys());(n?[n]:s).forEach(o=>ye.addDisconnectedConnectorId(Ie.getConnectorId(o)||"",o)),Ie.removeConnectorId(n),Jt.resetChain(n),this.setUser(null,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(null,n),r!==!1&&Dt.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getAdapter(e),r=this.getCaipAddress(e),s=this.getCaipNetwork(e);return n==null?void 0:n.syncConnections({connectToFirstConnector:!r,caipNetwork:s})}))}async syncAdapterConnection(e){var c,l,d,u;const n=this.getAdapter(e),r=this.getCaipNetwork(e),s=Ie.getConnectorId(e),o=Ie.getConnectors(e).find(h=>h.id===s);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(r!=null&&r.id))throw new Error("CaipNetwork not found");const h=await(n==null?void 0:n.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:(d=(l=(c=r==null?void 0:r.rpcUrls)==null?void 0:c.default)==null?void 0:l.http)==null?void 0:d[0]}));h?(this.syncProvider({...h,chainNamespace:e}),await this.syncAccount({...h,chainNamespace:e}),this.setStatus("connected",e),Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:h.address,properties:{method:"browser",name:((u=o.info)==null?void 0:u.name)||o.name||"Unknown",reconnect:!0,view:ut.state.view,walletRank:void 0}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){var r,s;const e=Object.keys(((s=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:s.namespaces)||{}),n=this.chainNamespaces.map(async i=>{var u,h,f,p,m;const o=this.getAdapter(i);if(!o)return;const c=((p=(f=(h=(u=this.universalProvider)==null?void 0:u.session)==null?void 0:h.namespaces)==null?void 0:f[i])==null?void 0:p.accounts)||[],l=(m=$.state.activeCaipNetwork)==null?void 0:m.id,d=c.find(g=>{const{chainId:y}=jr.parseCaipAddress(g);return y===(l==null?void 0:l.toString())})||c[0];if(d){const g=jr.validateCaipAddress(d),{chainId:y,address:x}=jr.parseCaipAddress(g);if(Jt.setProviderId(i,Wt.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&$.state.activeCaipNetwork&&o.namespace!==ne.CHAIN.EVM){const w=o.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:$.state.activeCaipNetwork});Jt.setProvider(i,w)}else Jt.setProvider(i,this.universalProvider);Ie.setConnectorId(ne.CONNECTOR_ID.WALLET_CONNECT,i),ye.addConnectedNamespace(i),await this.syncAccount({address:x,chainId:y,chainNamespace:i})}else e.includes(i)&&this.setStatus("disconnected",i);this.syncConnectedWalletInfo(i),await $.setApprovedCaipNetworksData(i)});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){Jt.setProviderId(s,e),Jt.setProvider(s,n),Ie.setConnectorId(r,s)}async syncAccount(e){var h,f;const n=e.chainNamespace===$.state.activeChain,r=$.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:c}=ye.getActiveNetworkProps(),l=i||c,d=((h=$.state.activeCaipNetwork)==null?void 0:h.name)===ne.UNSUPPORTED_NETWORK_NAME,u=$.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(d&&!u)&&l){let p=this.getCaipNetworks().find(x=>x.id.toString()===l.toString()),m=this.getCaipNetworks().find(x=>x.chainNamespace===o);if(!u&&!p&&!m){const x=this.getApprovedCaipNetworkIds()||[],w=x.find(v=>{var E;return((E=jr.parseCaipNetworkId(v))==null?void 0:E.chainId)===l.toString()}),b=x.find(v=>{var E;return((E=jr.parseCaipNetworkId(v))==null?void 0:E.chainNamespace)===o});p=this.getCaipNetworks().find(v=>v.caipNetworkId===w),m=this.getCaipNetworks().find(v=>v.caipNetworkId===b||"deprecatedCaipNetworkId"in v&&v.deprecatedCaipNetworkId===b)}const g=p||m;(g==null?void 0:g.chainNamespace)===$.state.activeChain?fe.state.enableNetworkSwitch&&!fe.state.allowUnsupportedChain&&((f=$.state.activeCaipNetwork)==null?void 0:f.name)===ne.UNSUPPORTED_NETWORK_NAME?$.showUnsupportedChainUI():this.setCaipNetwork(g):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);const y=this.getAddress(o);nr.isLowerCaseMatch(s,y)||this.syncAccountInfo(s,g==null?void 0:g.id,o),n?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r==null?void 0:r.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){var s;const n=Ie.getConnectorId(e),r=Jt.getProviderId(e);if(r===Wt.CONNECTOR_TYPE_ANNOUNCED||r===Wt.CONNECTOR_TYPE_INJECTED){if(n){const o=this.getConnectors().find(c=>{var h,f;const l=c.id===n,d=((h=c.info)==null?void 0:h.rdns)===n,u=(f=c.connectors)==null?void 0:f.some(p=>{var m;return p.id===n||((m=p.info)==null?void 0:m.rdns)===n});return l||d||!!u});if(o){const{info:c,name:l,imageUrl:d}=o,u=d||this.getConnectorImage(o);this.setConnectedWalletInfo({name:l,icon:u,...c},e)}}}else if(r===Wt.CONNECTOR_TYPE_WALLET_CONNECT){const i=Jt.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(n&&(n===ne.CONNECTOR_ID.COINBASE_SDK||n===ne.CONNECTOR_ID.COINBASE)){const i=this.getConnectors().find(d=>d.id===n),o=(i==null?void 0:i.name)||"Coinbase Wallet",c=(i==null?void 0:i.imageUrl)||this.getConnectorImage(i),l=i==null?void 0:i.info;this.setConnectedWalletInfo({...l,name:o,icon:c},e)}}async syncBalance(e){!Y8.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>{var s;return r.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=$.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){var r,s,i,o,c,l,d,u,h,f;const e=dCe.createLogger((p,...m)=>{p&&this.handleAlertError(p),console.error(...m)}),n={projectId:(r=this.options)==null?void 0:r.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(c=this.options)==null?void 0:c.metadata.description:"",url:(l=this.options)!=null&&l.metadata?(d=this.options)==null?void 0:d.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(h=this.options)==null?void 0:h.metadata.icons:[""]},logger:e};fe.setManualWCControl(!!((f=this.options)!=null&&f.manualWCControl)),this.universalProvider=this.options.universalProvider??await aCe.init(n),fe.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Zi.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{De.setUri(n)},onConnect:n=>{const{address:r}=Be.getAccount(n[0]);De.finalizeWcConnection(r)},onDisconnect:()=>{$.state.noAdapters&&this.resetAccount(e),De.resetWcConnection()},onChainChanged:n=>{const r=$.state.activeChain,s=r&&Ie.state.activeConnectorIds[r]===ne.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&($.state.noAdapters||s)){const i=this.getCaipNetworks().find(c=>c.id.toString()===n.toString()||c.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}(o==null?void 0:o.id.toString())!==(i==null?void 0:i.id.toString())&&(o==null?void 0:o.chainNamespace)===(i==null?void 0:i.chainNamespace)&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=$.state.activeChain,s=r&&Ie.state.activeConnectorIds[r]===ne.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&($.state.noAdapters||s)){const i=n==null?void 0:n[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&Be.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Lt.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const n=Object.entries(ks.UniversalProviderErrors).find(([,{message:c}])=>e.message.includes(c)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const c=ks.ALERT_ERRORS[o];c&&(_s.open(c,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){var n;if(e)return(n=this.chainAdapters)==null?void 0:n[e]}createAdapter(e){var s,i;if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:(s=this.options)==null?void 0:s.projectId,networks:(i=this.caipNetworks)==null?void 0:i.filter(({chainNamespace:o})=>o===n)}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){await this.injectModalUi(),e!=null&&e.uri&&De.setUri(e.uri);const{isSwap:n,isSend:r}=this.toModalOptions();return n(e)?Dt.open({...e,data:{swap:e.arguments}}):r(e)&&e.arguments?this.openSend(e.arguments):Dt.open(e)}async close(){await this.injectModalUi(),Dt.close()}setLoading(e,n){Dt.setLoading(e,n)}async disconnect(e){await De.disconnect({namespace:e})}getSIWX(){return fe.state.siwx}getError(){return""}getChainId(){var e;return(e=$.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e,{throwOnFailure:n=!1}={}){const r=this.getCaipNetworks().find(s=>s.id===e.id);if(!r){_s.open(ks.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await $.switchActiveNetwork(r,{throwOnFailure:n})}getWalletProvider(){return $.state.activeChain?Jt.state.providers[$.state.activeChain]:null}getWalletProviderType(){return Jt.getProviderId($.state.activeChain)}subscribeProviders(e){return Jt.subscribeProviders(e)}getThemeMode(){return fi.state.themeMode}getThemeVariables(){return fi.state.themeVariables}setThemeMode(e){fi.setThemeMode(e),K_(fi.state.themeMode)}setTermsConditionsUrl(e){fe.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){fe.setPrivacyPolicyUrl(e)}setThemeVariables(e){fi.setThemeVariables(e),aSe(fi.state.themeVariables)}subscribeTheme(e){return fi.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?De.subscribe(e):(_s.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){var r,s;if(e)return(s=(r=$.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.connectedWalletInfo;const n=$.getAccountData();return n==null?void 0:n.connectedWalletInfo}getAccount(e){const n=e||$.state.activeChain,r=Ie.getAuthConnector(n),s=$.getAccountData(n),i=ye.getConnectedConnectorId($.state.activeChain),o=De.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const c=o.flatMap(l=>l.accounts.map(({address:d,type:u,publicKey:h})=>Be.createAccount(n,d,u||"eoa",h)));if(s)return{allAccounts:c,caipAddress:s.caipAddress,address:Be.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===ne.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:ye.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:Ws(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?$.subscribeChainProp("accountState",r,n):$.subscribe(r),Ie.subscribe(r)}subscribeNetwork(e){return $.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n==null?void 0:n.id,caipNetworkId:n==null?void 0:n.caipNetworkId})})}subscribeWalletInfo(e,n){return n?$.subscribeChainProp("accountState",r=>e(r==null?void 0:r.connectedWalletInfo),n):$.subscribeChainProp("accountState",r=>e(r==null?void 0:r.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){$.subscribeChainProp("accountState",n=>e(n==null?void 0:n.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){$.subscribeKey("activeCaipNetwork",e)}getState(){return ma.state}getRemoteFeatures(){return fe.state.remoteFeatures}subscribeState(e){return ma.subscribe(e)}subscribeRemoteFeatures(e){return fe.subscribeKey("remoteFeatures",e)}showErrorMessage(e){lc.showError(e)}showSuccessMessage(e){lc.showSuccess(e)}getEvent(){return{...Lt.state}}subscribeEvents(e){return Lt.subscribe(e)}replace(e){ut.replace(e)}redirect(e){ut.push(e)}popTransactionStack(e){ut.popTransactionStack(e)}isOpen(){return Dt.state.open}isTransactionStackEmpty(){return ut.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){fe.setFeatures(e)}updateRemoteFeatures(e){fe.setRemoteFeatures(e)}updateOptions(e){const r={...fe.state||{},...e};fe.setOptions(r)}setConnectMethodsOrder(e){fe.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){fe.setWalletFeaturesOrder(e)}setCollapseWallets(e){fe.setCollapseWallets(e)}setSocialsOrder(e){fe.setSocialsOrder(e)}getConnectMethodsOrder(){return V_.getConnectOrderMethod(fe.state.features,Ie.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||$.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&$.removeNetwork(e,n)}}let w6=!1;class Kz extends mSe{async onAuthProviderConnected(e){const n=nr.userChainIdToChainNamespace(e==null?void 0:e.chainId);if(e.message&&e.signature&&e.siwxMessage&&await qi.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===ne.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=fe.state.defaultAccountTypes[n],i=Ws(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:c,siwxMessage:l,message:d,...u}=e,h=$.getAccountData(n);this.setUser({...(h==null?void 0:h.user)||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{Ki.checkIfRequestExists(n)?Ki.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(fr.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(fr.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=Ki.checkIfRequestIsSafe(r),i=this.getAddress(),o=$.state.activeCaipNetwork;s||(i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=$.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");Ie.getConnectorId(n)===ne.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=$.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=fi.getSnapshot(),r=fe.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:Sw(n.themeVariables,n.themeMode)})])}async syncAuthConnector(e,n){var u,h,f,p,m,g,y,x,w;const r=ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===$.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),c=e.getUsername(),l=((u=$.getAccountData(n))==null?void 0:u.user)||{};this.setUser({...l,username:c,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:d}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),n&&r&&s){const b=await e.getSmartAccountEnabledNetworks();if($.setSmartAccountEnabledNetworks((b==null?void 0:b.smartAccountEnabledNetworks)||[],n),d&&((h=this.connectionControllerClient)!=null&&h.connectExternal)){await((m=this.connectionControllerClient)==null?void 0:m.connectExternal({id:ne.CONNECTOR_ID.AUTH,info:{name:ne.CONNECTOR_ID.AUTH},type:Wt.CONNECTOR_TYPE_AUTH,provider:e,chainId:(p=(f=$.getNetworkData(n))==null?void 0:f.caipNetwork)==null?void 0:p.id,chain:n})),this.setStatus("connected",n);const v=ye.getConnectedSocialProvider();v?Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:v,reconnect:!0}}):Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:((w=(x=(y=(g=this.universalProvider)==null?void 0:g.session)==null?void 0:y.peer)==null?void 0:x.metadata)==null?void 0:w.name)||"Unknown",reconnect:!0,view:ut.state.view,walletRank:void 0}})}else Ie.getConnectorId(n)===ne.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),ye.removeConnectedNamespace(n))}this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){var n;try{if(!Be.isTelegram())return;const r=ye.getTelegramSocialProvider();if(!r||!Be.isClient())return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;r&&$.setAccountProp("socialProvider",r,e),await((n=this.authProvider)==null?void 0:n.init());const o=Ie.getAuthConnector();r&&o&&(this.setLoading(!0,e),await De.connectExternal({id:o.id,type:o.type,socialUri:i},o.chain),ye.setConnectedSocialProvider(r),ye.removeTelegramSocialProvider(),Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:r}}))}catch(r){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",r)}try{const r=new URL(window.location.href);r.searchParams.delete("result_uri"),window.history.replaceState({},document.title,r.toString())}catch(r){console.error("tma social login failed",r)}}createAuthProvider(e){var d,u,h,f;if(!ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=(d=this.remoteFeatures)==null?void 0:d.email,s=Array.isArray((u=this.remoteFeatures)==null?void 0:u.socials)&&this.remoteFeatures.socials.length>0,i=r||s,c=nr.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&((h=this.options)!=null&&h.projectId)&&i&&(this.authProvider=Oy.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(f=this.getCaipNetwork(c))==null?void 0:f.caipNetworkId,abortController:ks.EmbeddedWalletAbortController,onTimeout:p=>{p==="iframe_load_failed"?_s.open(ks.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):p==="iframe_request_timeout"?_s.open(ks.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):p==="unverified_domain"&&_s.open(ks.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:p=>oy(p),getCaipNetworks:p=>$.getCaipNetworks(p)}),ma.subscribeOpen(p=>{var m;!p&&this.isTransactionStackEmpty()&&((m=this.authProvider)==null||m.rejectRpcRequests())}));const l=e===$.state.activeChain&&fe.state.enableReconnect;fe.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&l&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var n,r,s;this.createAuthProvider(e),this.authProvider&&((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setAuthProvider)==null||s.call(r,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&dt.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var o,c,l;if(!e)return;const n=$.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&((o=$.getAccountData(r))!=null&&o.caipAddress)){const d=this.getAdapter(r),u=Jt.getProvider(r),h=Jt.getProviderId(r);await(d==null?void 0:d.switchNetwork({caipNetwork:e,provider:u,providerType:h})),this.setCaipNetwork(e)}else{const u=Jt.getProviderId(n)===Wt.CONNECTOR_TYPE_AUTH,h=Jt.getProviderId(r),f=h===Wt.CONNECTOR_TYPE_AUTH,p=ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((u&&h===void 0||f)&&p)try{if($.state.activeChain=e.chainNamespace,s){const m=this.getAdapter(r);await(m==null?void 0:m.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:h}))}else await((l=(c=this.connectionControllerClient)==null?void 0:c.connectExternal)==null?void 0:l.call(c,{id:ne.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:Wt.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch{const g=this.getAdapter(r);await(g==null?void 0:g.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:h}))}else if(h===Wt.CONNECTOR_TYPE_WALLET_CONNECT){if(!$.state.noAdapters){const m=this.getAdapter(r),g=Jt.getProvider(r),y=Jt.getProviderId(r);await(m==null?void 0:m.switchNetwork({caipNetwork:e,provider:g,providerType:y}))}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){var n;await super.initialize(e),(n=this.chainNamespaces)==null||n.forEach(r=>{this.createAuthProviderForAdapter(r)}),await this.injectModalUi(),ma.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){var c;const s=`${r}:${n}`,i=(c=this.caipNetworks)==null?void 0:c.find(l=>l.caipNetworkId===s);if(i!=null&&i.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=Ie.getConnectorId(r)===ne.CONNECTOR_ID.AUTH;try{const{name:l,avatar:d}=await this.fetchIdentity({address:e});!l&&o?await this.syncReownName(e,r):(this.setProfileName(l,r),this.setProfileImage(d,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=Jt.getProviderId(e);if(n===Wt.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=ye.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(Be.isClient()&&!w6)try{const e={...Vt.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),Be.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!fe.state.disableAppend&&!fe.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}w6=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!Be.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push($n(()=>import("./embedded-wallet-Qzcsg2k1.js"),__vite__mapDeps([4,5,6,7,8,9,10,11,12,13,14,15,16]))),n.email&&r.push($n(()=>import("./email-Bk1kq5Lr.js"),__vite__mapDeps([17,5,18,15,9,14,7,8,13,19,11]))),n.socials&&r.push($n(()=>import("./socials-CrtpaJlE.js"),__vite__mapDeps([20,5,7,21,8,22,14,23,13,9,24,6,25]))),n.swaps&&n.swaps.length>0&&r.push($n(()=>import("./swaps-BYKJq-q0.js"),__vite__mapDeps([26,5,13,9,14,7,27,28,29,25,30,6,11,8]))),e.send&&r.push($n(()=>import("./send-ONcJxy9f.js"),__vite__mapDeps([31,5,13,9,14,7,32,8,33,15,30,6,25,29,11,34,35]))),e.receive&&r.push($n(()=>import("./receive-BSupas26.js"),__vite__mapDeps([36,5,7,6,24]))),n.onramp&&n.onramp.length>0&&r.push($n(()=>import("./onramp-D4274kAk.js"),__vite__mapDeps([37,5,7,38,9,21,8,6,39,40,15,13,14,23,41,11]))),n.payWithExchange&&r.push($n(()=>import("./pay-with-exchange-B2V9U0n7.js"),__vite__mapDeps([42,5,7,6,12,38,9,25,13,33,8,15,41,14,11,34,32]))),n.activity&&r.push($n(()=>import("./transactions-BGUWgCGU.js"),__vite__mapDeps([43,5,44,14,7,15,6,25]))),(e.pay||n.payments)&&r.push($n(()=>import("./index-DYLTG65y.js"),__vite__mapDeps([45,5,7,13,9,46,12,6,38,47,32,48,14,23]))),n.emailCapture&&r.push($n(()=>import("./data-capture-DFZ8MMYu.js"),__vite__mapDeps([49,5,18,15,9,50]))),await Promise.all([...r,$n(()=>import("./index-CZbXSo3S.js"),__vite__mapDeps([51,5,7,6,9,35,14,52,40,15,10,48,12,38,13,44,25,34,27,28,32,8,11,47,19,21,22,23,24,16,39])),$n(()=>import("./w3m-modal-DfMUZQH4.js"),__vite__mapDeps([53,5,7,46,6,10,9,14,28,52,40,15,48,29]))])}}const gSe="1.8.7";function Gz(t){return new Kz({...t,sdkVersion:Be.generateSdkVersion(t.adapters??[],"html",gSe)})}const ySe=Object.freeze(Object.defineProperty({__proto__:null,AppKit:Kz,CoreHelperUtil:Be,DEFAULT_METHODS:Wz,WcConstantsUtil:hc,WcHelpersUtil:Zi,createAppKit:Gz},Symbol.toStringTag,{value:"Module"})),wp={signMessage:async(t,e,n)=>{if(!e)throw new Error("signMessage - provider is undefined");const r=Sn(t)?t:$e(mc(t));return await e.request({method:"personal_sign",params:[r,n]})},estimateGas:async(t,e,n,r)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!n)throw new Error("estimateGas - address is undefined");if(t.chainNamespace&&t.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const s={from:t.address,to:t.to,data:t.data,type:0},i=new Dr(e,r);return await new dm(i,n).estimateGas(s)},sendTransaction:async(t,e,n,r)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!n)throw new Error("sendTransaction - address is undefined");if(t.chainNamespace&&t.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const s={to:t.to,value:t.value,gasLimit:t.gas,gasPrice:t.gasPrice,data:t.data,type:0},i=new Dr(e,r),l=await(await new dm(i,n).sendTransaction(s)).wait();return(l==null?void 0:l.hash)||null},writeContract:async(t,e,n,r)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!n)throw new Error("writeContract - address is undefined");const s=new Dr(e,r),i=new dm(s,n),o=new rr(t.tokenAddress,t.abi,i);if(!o||!t.method)throw new Error("Contract method is undefined");const c=o[t.method];if(c)return await c(...t.args);throw new Error("Contract method is undefined")},parseWalletCapabilities:t=>{try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:am,formatUnits:fa};class Yz extends qz{constructor(){super({adapterType:ne.ADAPTER_TYPES.ETHERS,namespace:ne.CHAIN.EVM}),this.balancePromises={}}async createEthersConfig(e){if(!e.metadata)return;let n;function r(){if(n)return n;if(!(typeof window>"u")&&window.ethereum)return n=window.ethereum,n}async function s(){const{SafeProvider:c}=await $n(async()=>{const{SafeProvider:f}=await import("./SafeProvider-C8TvZVYd.js");return{SafeProvider:f}},__vite__mapDeps([54,55,1,2])),{default:l}=await $n(async()=>{const{default:f}=await import("./index-Cbi1aINv.js").then(p=>p.e);return{default:f}},__vite__mapDeps([55,1,2])),d=new l,u=await d.safe.getInfo(),h=new c(u,d);return await h.connect().catch(f=>{console.info("Failed to auto-connect to Safe:",f)}),h}async function i(){var c,l,d;try{const{createCoinbaseWalletSDK:u}=await $n(async()=>{const{createCoinbaseWalletSDK:f}=await import("./index-_YhPbmNM.js");return{createCoinbaseWalletSDK:f}},__vite__mapDeps([56,2,3]));return typeof window>"u"?void 0:u({appName:(c=e==null?void 0:e.metadata)==null?void 0:c.name,appLogoUrl:(l=e==null?void 0:e.metadata)==null?void 0:l.icons[0],appChainIds:((d=e.networks)==null?void 0:d.map(f=>f.id))||[1,84532],preference:{options:e.coinbasePreference??"all"}}).getProvider()}catch(u){console.error("Failed to import Coinbase Wallet SDK:",u);return}}const o={metadata:e.metadata};if(e.enableInjected!==!1&&(o.injected=r()),e.enableCoinbase!==!1){const c=await i();c&&(o.coinbase=c)}if(Be.isSafeApp()){const c=await s();c&&(o.safe=c)}return o.EIP6963=e.enableEIP6963!==!1,o}async signMessage(e){const{message:n,address:r,provider:s}=e;if(!s)throw new Error("Provider is undefined");try{return{signature:await wp.signMessage(n,s,r)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){var s,i;if(!e.provider)throw new Error("Provider is undefined");const n=(s=$.getAccountData(ne.CHAIN.EVM))==null?void 0:s.address;if(!n)throw new Error("Address is undefined");return{hash:await wp.sendTransaction({value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),to:e.to,data:e.data?e.data:"0x",gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,address:n},e.provider,n,Number((i=e.caipNetwork)==null?void 0:i.id))}}async writeContract(e){var s;if(!e.provider)throw new Error("Provider is undefined");const{address:n}=jr.parseCaipAddress(e.caipAddress);return{hash:await wp.writeContract(e,e.provider,n,Number((s=e.caipNetwork)==null?void 0:s.id))}}async estimateGas(e){const{provider:n,caipNetwork:r,address:s}=e;if(!n)throw new Error("Provider is undefined");try{return{gas:await wp.estimateGas({data:e.data,to:e.to,address:s},n,s,Number(r==null?void 0:r.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}parseUnits(e){return wp.parseUnits(e.value,e.decimals)}formatUnits(e){return wp.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:n,chainId:r}=e,s=this.connectors.find(l=>l.id===n),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");const o=await i.request({method:"eth_requestAccounts"}),c=await i.request({method:"eth_chainId"});if(this.listenProviderEvents(n,i),!o[0])throw new Error("No accounts found");if(!(s!=null&&s.type))throw new Error("Connector type not found");return{address:this.toChecksummedAddress(o[0]),chainId:Number(c)||Number(r),provider:i,type:s.type,id:n}}async syncConnectors(e){var r;this.ethersConfig=await this.createEthersConfig(e),(r=this.ethersConfig)!=null&&r.EIP6963&&this.listenInjectedConnector(!0),Object.keys(this.ethersConfig||{}).filter(s=>s!=="metadata"&&s!=="EIP6963").forEach(s=>{var c,l;const i=s==="coinbase"?"coinbaseWalletSDK":s,o=s===ne.CONNECTOR_ID.INJECTED;this.namespace&&this.addConnector({id:i,explorerId:oc.ConnectorExplorerIds[i],imageUrl:(c=e==null?void 0:e.connectorImages)==null?void 0:c[i],name:oc.ConnectorNamesMap[i]||"Unknown",imageId:oc.ConnectorImageIds[i],type:oc.ConnectorTypesMap[i]??"EXTERNAL",info:o?void 0:{rdns:i},chain:this.namespace,chains:[],provider:(l=this.ethersConfig)==null?void 0:l[s]})})}async disconnectAll(){return{connections:await Promise.all(this.connections.map(async n=>{const r=this.connectors.find(s=>nr.isLowerCaseMatch(s.id,n.connectorId));if(!r)throw new Error("Connector not found");return await this.disconnect({id:r.id}),n}))}}async syncConnections({connectToFirstConnector:e}){var n;await((n=this.connectionManager)==null?void 0:n.syncConnections({connectors:this.connectors,caipNetworks:this.getCaipNetworks(),universalProvider:this.universalProvider,onConnection:this.addConnection.bind(this),onListenProvider:this.listenProviderEvents.bind(this)})),e&&this.emitFirstAvailableConnection()}async setUniversalProvider(e){this.universalProvider=e;const n=ne.CONNECTOR_ID.WALLET_CONNECT;return Zi.listenWcProvider({universalProvider:e,namespace:ne.CHAIN.EVM,onConnect:r=>this.onConnect(r,n),onDisconnect:()=>this.onDisconnect(n),onAccountsChanged:r=>this.onAccountsChanged(r,n,!1),onChainChanged:r=>this.onChainChanged(r,n)}),this.addConnector(new Bj({provider:e,caipNetworks:this.getCaipNetworks(),namespace:ne.CHAIN.EVM})),Promise.resolve()}eip6963EventHandler(e){var n;if(e.detail){const{info:r,provider:s}=e.detail;if(!((n=this.connectors)==null?void 0:n.find(o=>o.name===(r==null?void 0:r.name)))){const o=oc.ConnectorTypesMap[ne.CONNECTOR_ID.EIP6963],c=(r==null?void 0:r.rdns)||(r==null?void 0:r.name)||(r==null?void 0:r.uuid);this.namespace&&c&&this.addConnector({id:c,type:o,imageUrl:r==null?void 0:r.icon,name:(r==null?void 0:r.name)||"Unknown",provider:s,info:r,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const n=this.eip6963EventHandler.bind(this);window.addEventListener(Wt.EIP6963_ANNOUNCE_EVENT,n),window.dispatchEvent(new Event(Wt.EIP6963_REQUEST_EVENT))}}async connect({id:e,address:n,type:r,chainId:s,socialUri:i}){var o;try{const c=this.connectors.find(f=>nr.isLowerCaseMatch(f.id,e));if(!c)throw new Error("Connector not found");const l=(o=this.connectionManager)==null?void 0:o.getConnection({address:n,connectorId:e,connections:this.connections,connectors:this.connectors});if(l){const f=l.caipNetwork;if(!f)throw new Error("EthersAdapter:connect - could not find the caipNetwork to connect");if(l.account)return this.emit("accountChanged",{address:this.toChecksummedAddress(l.account.address),chainId:f.id,connector:c}),{address:this.toChecksummedAddress(l.account.address),chainId:f.id,provider:c.provider,type:c.type,id:e}}const d=c==null?void 0:c.provider;if(!d)throw new Error("Provider not found");let u=[],h;if(r===Wt.CONNECTOR_TYPE_AUTH){const{address:f,accounts:p}=await qi.authConnectorAuthenticate({authConnector:d,chainNamespace:ne.CHAIN.EVM,chainId:s,socialUri:i,preferredAccountType:Ws("eip155")}),m=this.getCaipNetworks().find(g=>g.id.toString()===(s==null?void 0:s.toString()));u=[f],this.addConnection({connectorId:e,accounts:p?p.map(g=>({address:g.address})):u.map(g=>({address:g})),caipNetwork:m,auth:{name:ye.getConnectedSocialProvider(),username:ye.getConnectedSocialUsername()}}),this.emit("accountChanged",{address:this.toChecksummedAddress(u[0]),chainId:Number(s),connector:c})}else{u=await d.request({method:"eth_requestAccounts"}),h=await d.request({method:"eth_chainId"});const f=this.getCaipNetworks().find(p=>p.id.toString()===(s==null?void 0:s.toString()));if(h!==s){if(!f)throw new Error("EthersAdapter:connect - could not find the caipNetwork to switch");try{await this.switchNetwork({caipNetwork:f,provider:d,providerType:r})}catch{throw new Error("EthersAdapter:connect - Switch network failed")}}this.emit("accountChanged",{address:this.toChecksummedAddress(u[0]),chainId:Number(s),connector:c}),this.addConnection({connectorId:e,accounts:u.map(p=>({address:p})),caipNetwork:f}),c.id!==ne.CONNECTOR_ID.WALLET_CONNECT&&this.listenProviderEvents(e,d)}return{address:this.toChecksummedAddress(u[0]),chainId:Number(s),provider:d,type:r,id:e}}catch(c){throw ml.isUserRejectedRequestError(c)?new WI(c):c}}async reconnect(e){const{id:n,chainId:r}=e,s=this.connectors.find(i=>i.id===n);s&&s.type==="AUTH"&&r&&await qi.authConnectorAuthenticate({authConnector:s.provider,chainNamespace:ne.CHAIN.EVM,chainId:r,preferredAccountType:Ws("eip155")})}async getAccounts(e){var o;const n=this.connectors.find(c=>c.id===e.id),r=n==null?void 0:n.provider;if(!r||!n)throw new Error("Provider not found");const s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});if(s)return{accounts:s.accounts.map(({address:c})=>Be.createAccount(ne.CHAIN.EVM,c,"eoa"))};if(e.id===ne.CONNECTOR_ID.AUTH){const c=n.provider;if(!c.user)return{accounts:[]};const{accounts:l,address:d}=c.user;return Promise.resolve({accounts:(l||[{address:d,type:"eoa"}]).map(u=>Be.createAccount(ne.CHAIN.EVM,u.address,u.type))})}return{accounts:(await r.request({method:"eth_requestAccounts"})).map(c=>Be.createAccount(ne.CHAIN.EVM,c,"eoa"))}}async disconnect(e){var n,r;if(e.id){const s=this.connectors.find(o=>nr.isLowerCaseMatch(o.id,e.id));if(!s)throw new Error("Connector not found");const i=(n=this.connectionManager)==null?void 0:n.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});switch(s.type){case Wt.CONNECTOR_TYPE_WALLET_CONNECT:s.provider.session&&s.provider.disconnect();break;case Wt.CONNECTOR_TYPE_AUTH:await((r=s.provider)==null?void 0:r.disconnect());break;case Wt.CONNECTOR_TYPE_ANNOUNCED:case Wt.CONNECTOR_TYPE_EXTERNAL:await this.revokeProviderPermissions(s.provider);break;default:throw new Error("Unsupported provider type")}return s.id&&(this.removeProviderListeners(s.id),this.deleteConnection(s.id)),this.connections.length===0?this.emit("disconnect"):this.emitFirstAvailableConnection(),{connections:i?[i]:[]}}return this.disconnectAll()}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>{var i;return s.id.toString()===((i=e.chainId)==null?void 0:i.toString())});if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&r.chainNamespace===ne.CHAIN.EVM){const s=`${r.caipNetworkId}:${n}`,i=this.balancePromises[s];if(i)return i;const o=ye.getNativeBalanceCacheForCaipAddress(s);if(o)return{balance:o.balance,symbol:o.symbol};const c=new Eg(r.rpcUrls.default.http[0],{chainId:r.id,name:r.name});if(c)try{return this.balancePromises[s]=new Promise(async l=>{try{const d=await c.getBalance(n),u=gc(d);ye.updateNativeBalanceCache({caipAddress:s,balance:u,symbol:r.nativeCurrency.symbol,timestamp:Date.now()}),l({balance:u,symbol:r.nativeCurrency.symbol})}catch{l({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}async switchNetwork(e){var i,o;const{caipNetwork:n,provider:r,providerType:s}=e;if(s==="AUTH"){await super.switchNetwork(e);return}try{await r.request({method:"wallet_switchEthereumChain",params:[{chainId:ef.numberToHexString(n.id)}]})}catch(c){if(c.code===hc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||c.code===hc.ERROR_INVALID_CHAIN_ID||c.code===hc.ERROR_CODE_DEFAULT||((o=(i=c==null?void 0:c.data)==null?void 0:i.originalError)==null?void 0:o.code)===hc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await ef.addEthereumChain(r,n);else if(s==="ANNOUNCED"||s==="EXTERNAL"||s==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){var e;return(e=this.connectors.find(n=>n.type==="WALLET_CONNECT"))==null?void 0:e.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(s=>s.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(n){console.info("Could not revoke permissions from wallet. Disconnecting...",n)}}async getCapabilities(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_getAssets",params:[e]})}toChecksummedAddress(e){try{return un(e.toLowerCase())}catch{return e}}}const wSe=Object.freeze(Object.defineProperty({__proto__:null,EthersAdapter:Yz,EthersHelpersUtil:ef},Symbol.toStringTag,{value:"Module"})),rh=class rh{constructor(){G(this,"appKit",null);G(this,"provider",null);G(this,"isInitialized",!1);G(this,"connectionCallbacks",[])}static getInstance(){return rh.instance||(rh.instance=new rh),rh.instance}async initialize(){if(!this.isInitialized)try{const e="ec7b7de733ccdb815ca5ef14d3136983",n=new Yz;this.appKit=Gz({adapters:[n],projectId:e,networks:[cSe],metadata:{name:"Zotrust P2P Trading",description:"Decentralized P2P Trading Platform with Voice Calls on BSC",url:typeof window<"u"?window.location.origin:"https://zotrust.app",icons:["https://zotrust.app/icon.png"]},features:{analytics:!0,email:!1,socials:[],emailShowWallets:!1}}),this.appKit.subscribeAccount(async r=>{if(console.log("WalletConnect Account Updated:",r),r.isConnected&&r.address){const s=this.appKit.getWalletProvider();if(s){if(this.provider=new Dr(s),this.appKit.getChainId()!==56){console.log(" WalletConnect: Switching to BSC Mainnet...");try{await this.appKit.switchNetwork({chainId:56})}catch(o){console.warn("Failed to auto-switch to BSC Mainnet:",o)}}this.notifyConnectionChange(!0)}}else this.provider=null,this.notifyConnectionChange(!1)}),this.isInitialized=!0,console.log(" WalletConnect initialized successfully")}catch(e){throw console.error(" Failed to initialize WalletConnect:",e),e}}async openModal(){this.isInitialized||await this.initialize(),this.appKit&&this.appKit.open()}async connect(){this.isInitialized||await this.initialize();try{const e=this.appKit.getAccount();if(e&&e.isConnected&&e.address){const n=this.appKit.getChainId()||56;return{address:e.address,chainId:n}}return await this.appKit.open(),new Promise((n,r)=>{let s=!1,i=null;try{i=this.appKit.subscribeAccount(u=>{if(!s&&u&&u.isConnected&&u.address){s=!0;const h=this.appKit.getChainId()||56;n({address:u.address,chainId:h})}})}catch(u){console.warn("Failed to set up account subscription:",u);const h=()=>{if(s)return;const f=this.appKit.getAccount();if(f&&f.isConnected&&f.address){s=!0;const p=this.appKit.getChainId()||56;n({address:f.address,chainId:p})}else setTimeout(h,1e3)};setTimeout(h,1e3)}const o=setTimeout(()=>{s||(s=!0,r(new Error("Connection cancelled or timed out. Please try again.")))},6e4),c=()=>{if(clearTimeout(o),i&&typeof i=="function")try{i()}catch(u){console.warn("Failed to cleanup subscription:",u)}},l=n;n=u=>{c(),l(u)};const d=r;r=u=>{c(),d(u)}})}catch(e){throw console.error("WalletConnect connection failed:",e),e}}async disconnect(){this.appKit&&await this.appKit.disconnect(),this.provider=null,this.notifyConnectionChange(!1),console.log(" WalletConnect disconnected")}async getAccountInfo(){const e=this.appKit.getAccount(),n=this.appKit.getChainId();if(!e||!e.address)throw new Error("No account connected");return{address:e.address,chainId:n||56}}getProvider(){return this.provider}async getSigner(){return this.provider?await this.provider.getSigner():null}isConnected(){var n;const e=(n=this.appKit)==null?void 0:n.getAccount();return e?e.isConnected:!1}async signMessage(e){if(!this.provider)throw new Error("Wallet not connected");return await(await this.provider.getSigner()).signMessage(e)}getChainId(){var e;return(e=this.appKit)==null?void 0:e.getChainId()}async switchNetwork(e){if(!this.appKit)throw new Error("WalletConnect not initialized");try{console.log(` WalletConnect: Switching to network ${e}`),await this.appKit.switchNetwork({chainId:e}),console.log(" WalletConnect: Network switched successfully")}catch(n){throw console.error(" WalletConnect: Network switch failed:",n),new Error(`Failed to switch WalletConnect network: ${n.message}`)}}onConnectionChange(e){return this.connectionCallbacks.push(e),()=>{const n=this.connectionCallbacks.indexOf(e);n>-1&&this.connectionCallbacks.splice(n,1)}}notifyConnectionChange(e){this.connectionCallbacks.forEach(n=>{try{n(e)}catch(r){console.error("Error in connection callback:",r)}})}static createTrustWalletDeepLink(e){return`trust://wc?uri=${encodeURIComponent(e)}`}static createTrustWalletUniversalLink(e){return`https://link.trustwallet.com/wc?uri=${encodeURIComponent(e)}`}getQRCodeURI(){return null}static isTrustWalletInstalled(){return typeof window<"u"&&/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static isMobile(){return typeof window<"u"&&/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}};G(rh,"instance");let G_=rh;const ai=G_.getInstance(),xSe=(t,e,n=30)=>{const r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3),document.cookie=`${t}=${e};expires=${r.toUTCString()};path=/;SameSite=Lax`},bSe=t=>{const e=t+"=",n=document.cookie.split(";");for(let r=0;r<n.length;r++){let s=n[r];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return s.substring(e.length,s.length)}return null},vSe=t=>{document.cookie=`${t}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`},IS=(t,e,n)=>{const r={address:t,walletType:e,chainId:n,timestamp:Date.now()};xSe("wallet_state",JSON.stringify(r),30)},ESe=()=>{const t=bSe("wallet_state");if(!t)return null;try{const e=JSON.parse(t),n=Date.now()-30*24*60*60*1e3;return e.timestamp&&e.timestamp<n?(Y_(),null):e}catch(e){return console.error("Failed to parse wallet state from cookie:",e),Y_(),null}},Y_=()=>{vSe("wallet_state")},jS=()=>{var s,i,o,c;const t=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),e=!!window.ethereum,n=e&&((s=window.ethereum)==null?void 0:s.isMetaMask),r=e&&(((i=window.ethereum)==null?void 0:i.isTrust)||((o=window.ethereum)==null?void 0:o.isTrustWallet)||((c=window.ethereum)==null?void 0:c.isTrustWallet)||navigator.userAgent.includes("TrustWallet")||navigator.userAgent.includes("Trust Wallet"));return{isMobile:t,hasEthereum:e,isMetaMask:n,isTrustWallet:r,userAgent:navigator.userAgent}},Xt=AI((t,e)=>({address:null,isConnected:!1,chainId:null,balance:{bnb:"0",usdt:"0",wbnb:"0",usdc:"0"},isConnecting:!1,isUpdatingBalances:!1,connectionError:null,walletType:null,connect:async n=>{const{isConnecting:r}=e();if(r){console.log(" Connection already in progress, skipping...");return}n||(n=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"walletconnect":"metamask"),console.log(" Connecting wallet type:",n);try{t({isConnecting:!0,connectionError:null,walletType:n}),n==="metamask"?await e().connectMetaMask():n==="trustwallet"?await e().connectTrustWallet():await e().connectWalletConnect()}catch(s){console.error("Failed to connect wallet:",s);let i="Wallet connection failed";if(s.code===4001)i="Connection cancelled by user";else if(s.code===-32002){i="Connection request already pending. Please wait and try again.",console.log(" Connection already pending, will retry automatically..."),t({connectionError:null,walletType:null});return}else s.message&&(i=s.message);t({connectionError:i,walletType:null}),U.error(i)}finally{t({isConnecting:!1})}},connectMetaMask:async()=>{var c,l,d;console.log(" Connecting MetaMask...");const n=jS();if(console.log(" Wallet detection:",n),!n.hasEthereum){let u=" MetaMask install   TrustWallet dApp browser   ";n.isMobile&&(u="Mobile  MetaMask app install   Trust Wallet dApp browser   ",console.log(" Mobile detected, suggesting mobile solutions")),t({connectionError:u}),U.error(u);return}n.isMetaMask||(console.log(" Detected wallet is not MetaMask, but proceeding..."),console.log(" Ethereum provider info:",{isMetaMask:(c=window.ethereum)==null?void 0:c.isMetaMask,isTrust:(l=window.ethereum)==null?void 0:l.isTrust,isCoinbaseWallet:(d=window.ethereum)==null?void 0:d.isCoinbaseWallet}));const r=await window.ethereum.request({method:"eth_requestAccounts"});if(!r||r.length===0){const u=" account  ";t({connectionError:u}),U.error(u);return}const s=r[0],i=await window.ethereum.request({method:"eth_chainId"}),o=parseInt(i,16);if(t({address:s,isConnected:!0,chainId:o,walletType:"metamask"}),IS(s,"metamask",o),sessionStorage.setItem("walletType","metamask"),o!==56){console.log(" Switching to BSC Mainnet..."),U.loading("Switching to BSC Mainnet...",{id:"network-switch"});try{await e().switchToNetwork(56),await new Promise(f=>setTimeout(f,1e3));const u=await window.ethereum.request({method:"eth_chainId"});if(parseInt(u,16)===56)t({chainId:56}),U.success("Switched to BSC Mainnet!",{id:"network-switch"});else throw new Error("Failed to switch to BSC Mainnet")}catch(u){console.error("Network switch failed:",u);const h="Please manually switch to BSC Mainnet in MetaMask";t({connectionError:h}),U.error(h,{id:"network-switch"});return}}await e().authenticateUser(s),await e().updateBalances()},connectTrustWallet:async()=>{var c,l,d,u;console.log(" Connecting Trust Wallet...");const n=jS();if(console.log(" Trust Wallet detection:",n),n.isMobile&&!n.hasEthereum){console.log(" Mobile detected, attempting to open Trust Wallet app...");const h=`trust://open_url?url=${encodeURIComponent(window.location.href)}`;try{window.location.href=h,U.loading("Opening Trust Wallet app...",{duration:3e3}),setTimeout(()=>{U.error("Trust Wallet app not found. Please install Trust Wallet from the app store.")},2e3);return}catch{console.log("Trust Wallet deep link failed, falling back to regular connection")}}if(!n.hasEthereum){let h=" Trust Wallet install   MetaMask dApp browser   ";n.isMobile&&(h="Mobile  Trust Wallet app install   MetaMask dApp browser   ",console.log(" Mobile detected, suggesting mobile solutions")),t({connectionError:h}),U.error(h);return}n.isTrustWallet||(console.log(" Detected wallet is not Trust Wallet, but proceeding..."),console.log(" Ethereum provider info:",{isMetaMask:(c=window.ethereum)==null?void 0:c.isMetaMask,isTrust:(l=window.ethereum)==null?void 0:l.isTrust,isTrustWallet:(d=window.ethereum)==null?void 0:d.isTrustWallet,isCoinbaseWallet:(u=window.ethereum)==null?void 0:u.isCoinbaseWallet,userAgent:navigator.userAgent}));const r=await window.ethereum.request({method:"eth_requestAccounts"});if(!r||r.length===0){const h=" account  ";t({connectionError:h}),U.error(h);return}const s=r[0],i=await window.ethereum.request({method:"eth_chainId"}),o=parseInt(i,16);if(t({address:s,isConnected:!0,chainId:o,walletType:"trustwallet"}),IS(s,"trustwallet",o),sessionStorage.setItem("walletType","trustwallet"),o!==56){console.log(" Switching to BSC Mainnet..."),U.loading("Switching to BSC Mainnet...",{id:"network-switch"});try{await e().switchToNetwork(56),await new Promise(p=>setTimeout(p,1e3));const h=await window.ethereum.request({method:"eth_chainId"});if(parseInt(h,16)===56)t({chainId:56}),U.success("Switched to BSC Mainnet!",{id:"network-switch"});else throw new Error("Failed to switch to BSC Mainnet")}catch(h){console.error("Network switch failed:",h);const f="Please manually switch to BSC Mainnet in Trust Wallet";t({connectionError:f}),U.error(f,{id:"network-switch"});return}}await e().authenticateUser(s),await e().updateBalances()},authenticateUser:async n=>{var o,c,l;const{loginWithWallet:r,fetchUserProfile:s}=ss.getState(),i=`Welcome to Zotrust! Please sign this message to authenticate.

Timestamp: ${Date.now()}`;try{let d;const{walletType:u}=e();u==="metamask"?d=await window.ethereum.request({method:"personal_sign",params:[i,n]}):d=await ai.signMessage(i),await r(n,d,i),await s(n),U.success(`Wallet connected and logged in! ${n.slice(0,6)}...${n.slice(-4)}`)}catch(d){if((d==null?void 0:d.code)==="ACTION_REJECTED"||(d==null?void 0:d.code)===4001||((o=d==null?void 0:d.message)==null?void 0:o.includes("User rejected"))||((c=d==null?void 0:d.message)==null?void 0:c.includes("user rejected"))||((l=d==null?void 0:d.message)==null?void 0:l.includes("user-denied"))||(d==null?void 0:d.reason)==="rejected"){console.log(" User skipped signature - wallet connected but not authenticated");try{await s(n),U.success(`Wallet connected! ${n.slice(0,6)}...${n.slice(-4)}`,{duration:3e3,icon:""})}catch{U("Wallet connected! Sign in later to access all features.",{duration:4e3,icon:""})}}else{console.error("Signature failed:",d);try{await s(n),U.success(`Wallet connected! ${n.slice(0,6)}...${n.slice(-4)}`)}catch{U.error("Failed to authenticate. Wallet connected but some features may be limited.",{duration:4e3})}}}},connectWalletConnect:async()=>{console.log(" Connecting WalletConnect...");try{await ai.initialize();const{address:n,chainId:r}=await ai.connect();if(t({address:n,isConnected:!0,chainId:r,walletType:"walletconnect"}),IS(n,"walletconnect",r),sessionStorage.setItem("walletType","walletconnect"),r!==56){console.log(" WalletConnect: Not on BSC Mainnet, attempting to switch..."),U.loading("Switching to BSC Mainnet...",{id:"walletconnect-switch"});try{await ai.switchNetwork(56),await new Promise(i=>setTimeout(i,2e3)),ai.getChainId()===56?(t({chainId:56}),U.success("Switched to BSC Mainnet!",{id:"walletconnect-switch"})):(console.log("Network switch attempted, continuing with connection..."),U.success("Network switch requested!",{id:"walletconnect-switch"}))}catch(s){console.error("WalletConnect network switch failed:",s);const i="Please manually switch to BSC Mainnet in your wallet";t({connectionError:i}),U.error(i,{id:"walletconnect-switch"});return}}await e().authenticateUser(n),console.log(" WalletConnect: Waiting for provider to be ready..."),await new Promise(s=>setTimeout(s,1e3));try{await e().updateBalances(),console.log(" WalletConnect: Balances fetched successfully")}catch(s){console.error(" WalletConnect: Balance fetch failed, retrying...",s),await new Promise(i=>setTimeout(i,2e3)),await e().updateBalances()}}catch(n){if(console.error("WalletConnect connection failed:",n),n.message.includes("Project ID required")){if(U.error("WalletConnect setup incomplete. Using MetaMask instead."),window.ethereum){await e().connectMetaMask();return}}else{if(n.message.includes("timeout")||n.message.includes("cancelled"))throw new Error("Connection was cancelled or timed out. Please try connecting again.");if(n.message.includes("User rejected"))throw new Error("Connection was rejected. Please approve the connection in your wallet.");if(n.message.includes("No accounts"))throw new Error("No wallet accounts found. Please make sure your wallet is unlocked.")}throw n}},disconnect:async()=>{const{address:n,walletType:r}=e();if(r==="walletconnect")try{await ai.disconnect()}catch(s){console.error("Failed to disconnect WalletConnect:",s)}if(t({address:null,isConnected:!1,chainId:null,balance:{bnb:"0",usdt:"0",wbnb:"0",usdc:"0"},connectionError:null,walletType:null}),sessionStorage.removeItem("walletType"),Y_(),n)try{const{fetchUserProfile:s}=ss.getState();await s(n),U.success("Wallet disconnected, but you remain logged in")}catch(s){console.error("Failed to fetch user after disconnect:",s);const{setUser:i}=ss.getState();i(null),localStorage.removeItem("authToken"),U.success("Wallet disconnected and logged out")}else{const{setUser:s}=ss.getState();s(null),localStorage.removeItem("authToken"),U.success("Wallet disconnected and logged out")}},switchToNetwork:async n=>{try{if(!window.ethereum)throw new Error("No wallet detected");const r=`0x${n.toString(16)}`;console.log(` Switching to network: ${n} (${r})`);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]}),console.log(" Network switched successfully")}catch(o){if(console.log(" Network switch failed, trying to add network...",o),o.code===4902){const c=K8[n];if(c)console.log(" Adding BSC Mainnet to wallet..."),await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:c.name,rpcUrls:[c.rpcUrl],blockExplorerUrls:[c.blockExplorerUrl],nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18}}]}),console.log(" BSC Mainnet added to wallet");else throw new Error(`Network configuration not found for chain ID: ${n}`)}else throw new Error(`Failed to switch network: ${o.message}`)}const s=await window.ethereum.request({method:"eth_chainId"}),i=parseInt(s,16);if(i!==n)throw new Error(`Network switch verification failed. Expected: ${n}, Got: ${i}`);console.log(" Network switch verified successfully")}catch(r){throw console.error(" Network switch failed:",r),r}},updateBalances:async(n=!1)=>{var l,d;const{address:r,isConnected:s,chainId:i,walletType:o,isUpdatingBalances:c}=e();if(c){console.log(" Balance update already in progress, skipping duplicate call");return}if(!(!r||!s||!i)){if(t({isUpdatingBalances:!0}),i===56){console.log(" BSC Mainnet: Checking BNB balance");try{let u;if(o==="metamask"||o==="trustwallet"){if(!window.ethereum)throw new Error(`${o==="metamask"?"MetaMask":"Trust Wallet"} provider not available`);u=new Dr(window.ethereum),console.log(` Using ${o==="metamask"?"MetaMask":"Trust Wallet"} provider for balance fetch`)}else{let v=ai.getProvider();if(v||(console.log(" WalletConnect: Initializing service for balance fetch..."),await ai.initialize(),v=ai.getProvider()),v)u=v;else{console.error(" WalletConnect provider not available, retrying..."),await new Promise(k=>setTimeout(k,1e3));const E=ai.getProvider();if(!E)throw new Error("WalletConnect provider not available");u=E}}let h="0.00";try{console.log(" Fetching BNB balance for:",r);const v=await u.getBalance(r);h=parseFloat(gc(v)).toFixed(6),console.log(" BNB Formatted Balance:",h)}catch(v){console.error(" Failed to fetch BNB balance:",v),h="0.000000"}const f=["function balanceOf(address) view returns (uint256)","function decimals() view returns (uint8)"];let p="0.00";const m="0x55d398326f99059fF775485246999027B3197955";let g=0;const y=2;let x=!1;for(;g<y;)try{console.log(` Fetching USDT balance for: ${r} (attempt ${g+1})`);let v=u;if(x||g>0){console.log(" Using read-only RPC provider for USDT balance...");const{BSC_MAINNET_RPC:S}=await $n(async()=>{const{BSC_MAINNET_RPC:N}=await Promise.resolve().then(()=>RO);return{BSC_MAINNET_RPC:N}},void 0);v=new Eg(S)}const E=new rr(m,f,v),k=await Promise.race([E.balanceOf(r),new Promise((S,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]),C=await Promise.race([E.decimals(),new Promise((S,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]);p=parseFloat(fa(k,C)).toFixed(6),console.log(" USDT Formatted Balance:",p);break}catch(v){g++,console.error(` Failed to fetch USDT balance (attempt ${g}):`,v),(v.code==="CALL_EXCEPTION"||(l=v.message)!=null&&l.includes("missing revert data"))&&(x=!0,console.log(" CALL_EXCEPTION detected, will use read-only provider on retry")),g<y?await new Promise(E=>setTimeout(E,2e3*g)):(console.warn(" All USDT balance fetch attempts failed, using fallback"),p="0.000000")}let w="0.00";const b="0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d";for(g=0,x=!1;g<y;)try{console.log(` Fetching USDC balance for: ${r} (attempt ${g+1})`);let v=u;if(x||g>0){console.log(" Using read-only RPC provider for USDC balance...");const{BSC_MAINNET_RPC:S}=await $n(async()=>{const{BSC_MAINNET_RPC:N}=await Promise.resolve().then(()=>RO);return{BSC_MAINNET_RPC:N}},void 0);v=new Eg(S)}const E=new rr(b,f,v),k=await Promise.race([E.balanceOf(r),new Promise((S,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]),C=await Promise.race([E.decimals(),new Promise((S,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]);w=parseFloat(fa(k,C)).toFixed(6),console.log(" USDC Formatted Balance:",w);break}catch(v){g++,console.error(` Failed to fetch USDC balance (attempt ${g}):`,v),(v.code==="CALL_EXCEPTION"||(d=v.message)!=null&&d.includes("missing revert data"))&&(x=!0,console.log(" CALL_EXCEPTION detected, will use read-only provider on retry")),g<y?await new Promise(E=>setTimeout(E,2e3*g)):(console.warn(" All USDC balance fetch attempts failed, using fallback"),w="0.000000")}t({balance:{bnb:h,usdt:p,wbnb:w,usdc:"0.000000"}}),console.log(" BNB balance updated:",h),console.log(" USDT balance updated:",p),console.log(" USDC balance updated:",w),n&&(parseFloat(h)>0||parseFloat(p)>0||parseFloat(w)>0)&&U.success(`Balances: BNB ${parseFloat(h).toFixed(4)}, USDT ${parseFloat(p).toFixed(2)}, USDC ${parseFloat(w).toFixed(2)}`,{duration:3e3,icon:""})}catch(u){console.error("Failed to fetch token balances:",u),t({balance:{bnb:"0.00",usdt:"0.00",wbnb:"0.00",usdc:"0.00"}})}finally{t({isUpdatingBalances:!1})}return}console.log(" Non-BSC Mainnet network: showing native balance only");try{let u;if(o==="metamask"||o==="trustwallet"){if(!window.ethereum)throw new Error(`${o==="metamask"?"MetaMask":"Trust Wallet"} provider not available`);u=new Dr(window.ethereum)}else{const p=ai.getProvider();if(!p)throw new Error("WalletConnect provider not available");u=p}const h=await u.getBalance(r),f=gc(h);t({balance:{bnb:f,usdt:"0.00",wbnb:"0.00",usdc:"0.00"}}),console.log("Native balance updated:",f)}catch(u){console.error("Failed to fetch native balance:",u),t({balance:{bnb:"0.00",usdt:"0.00",wbnb:"0.00",usdc:"0.00"}})}}},clearError:()=>{t({connectionError:null})},debugWalletDetection:()=>{const r={...jS(),ethereum:!!window.ethereum,ethereumProviders:window.ethereum?Object.keys(window.ethereum):[],ethereumMethods:window.ethereum?Object.getOwnPropertyNames(window.ethereum):[],location:window.location.href,referrer:document.referrer};return console.log(" Wallet Debug Info:",r),r},restoreWalletState:async()=>{try{const n=ESe();if(!n)return;console.log(" Restoring wallet state from cookies:",n);let r=n.walletType;const s=sessionStorage.getItem("walletType");if(s&&["metamask","trustwallet","walletconnect"].includes(s)&&(r=s,console.log(" Restored walletType from sessionStorage:",r)),t({address:n.address,isConnected:!0,chainId:n.chainId,walletType:r}),r==="metamask"){if(window.ethereum)try{const i=await window.ethereum.request({method:"eth_accounts"});if(i.length>0&&i[0].toLowerCase()===n.address.toLowerCase()){console.log(" MetaMask wallet restored successfully"),await e().updateBalances(),await e().authenticateUser(n.address);return}}catch{console.log(" MetaMask wallet not available, clearing state"),e().disconnect()}}else if(r==="walletconnect")try{if(await ai.initialize(),ai.isConnected()){console.log(" WalletConnect wallet restored successfully"),await e().updateBalances(),await e().authenticateUser(n.address);return}}catch{console.log(" WalletConnect session not available, clearing state"),e().disconnect()}console.log(" Wallet not available, clearing saved state"),e().disconnect()}catch(n){console.error(" Failed to restore wallet state:",n),e().disconnect()}}}));typeof window<"u"&&(window.__zotrustAutoConnectTriggered||(window.__zotrustAutoConnectTriggered=!0,setTimeout(()=>{Xt.getState().restoreWalletState()},1e3)),window.ethereum&&(window.ethereum.on("accountsChanged",async t=>{if(console.log(" Account changed:",t),t.length===0)Xt.getState().disconnect();else{const{isConnecting:e}=Xt.getState();e||await Xt.getState().connect()}}),window.ethereum.on("chainChanged",async t=>{console.log(" Chain changed:",t);const e=parseInt(t,16);if(Xt.setState({chainId:e}),e!==56){console.log(" Wrong network detected, requesting switch to BSC Mainnet"),U.error("Please switch to BSC Mainnet for proper functionality");try{await Xt.getState().switchToNetwork(56),U.success("Switched to BSC Mainnet!")}catch(n){console.error("Failed to auto-switch network:",n)}}else console.log(" Connected to BSC Mainnet"),U.success("Connected to BSC Mainnet!");setTimeout(()=>{Xt.getState().updateBalances()},1e3)})));const $j=A.createContext({});function Fj(t){const e=A.useRef(null);return e.current===null&&(e.current=t()),e.current}const zj=typeof window<"u",Qz=zj?A.useLayoutEffect:A.useEffect,vN=A.createContext(null);function Hj(t,e){t.indexOf(e)===-1&&t.push(e)}function Vj(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Ol=(t,e,n)=>n>e?e:n<t?t:n;let Wj=()=>{};const Dl={},Jz=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function Zz(t){return typeof t=="object"&&t!==null}const Xz=t=>/^0[^.\s]+$/u.test(t);function qj(t){let e;return()=>(e===void 0&&(e=t()),e)}const Oo=t=>t,CSe=(t,e)=>n=>e(t(n)),hb=(...t)=>t.reduce(CSe),xx=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class Kj{constructor(){this.subscriptions=[]}add(e){return Hj(this.subscriptions,e),()=>Vj(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const vc=t=>t*1e3,Ec=t=>t/1e3;function eH(t,e){return e?t*(1e3/e):0}const tH=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,NSe=1e-7,ASe=12;function SSe(t,e,n,r,s){let i,o,c=0;do o=e+(n-e)/2,i=tH(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>NSe&&++c<ASe);return o}function fb(t,e,n,r){if(t===e&&n===r)return Oo;const s=i=>SSe(i,0,1,t,n);return i=>i===0||i===1?i:tH(s(i),e,r)}const nH=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,rH=t=>e=>1-t(1-e),sH=fb(.33,1.53,.69,.99),Gj=rH(sH),iH=nH(Gj),oH=t=>(t*=2)<1?.5*Gj(t):.5*(2-Math.pow(2,-10*(t-1))),Yj=t=>1-Math.sin(Math.acos(t)),aH=rH(Yj),cH=nH(Yj),TSe=fb(.42,0,1,1),_Se=fb(0,0,.58,1),lH=fb(.42,0,.58,1),kSe=t=>Array.isArray(t)&&typeof t[0]!="number",dH=t=>Array.isArray(t)&&typeof t[0]=="number",ISe={linear:Oo,easeIn:TSe,easeInOut:lH,easeOut:_Se,circIn:Yj,circInOut:cH,circOut:aH,backIn:Gj,backInOut:iH,backOut:sH,anticipate:oH},jSe=t=>typeof t=="string",x6=t=>{if(dH(t)){Wj(t.length===4);const[e,n,r,s]=t;return fb(e,n,r,s)}else if(jSe(t))return ISe[t];return t},Sv=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function RSe(t,e){let n=new Set,r=new Set,s=!1,i=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function l(u){o.has(u)&&(d.schedule(u),t()),u(c)}const d={schedule:(u,h=!1,f=!1)=>{const m=f&&s?n:r;return h&&o.add(u),m.has(u)||m.add(u),u},cancel:u=>{r.delete(u),o.delete(u)},process:u=>{if(c=u,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(l),n.clear(),s=!1,i&&(i=!1,d.process(u))}};return d}const PSe=40;function uH(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Sv.reduce((b,v)=>(b[v]=RSe(i),b),{}),{setup:c,read:l,resolveKeyframes:d,preUpdate:u,update:h,preRender:f,render:p,postRender:m}=o,g=()=>{const b=Dl.useManualTiming?s.timestamp:performance.now();n=!1,Dl.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(b-s.timestamp,PSe),1)),s.timestamp=b,s.isProcessing=!0,c.process(s),l.process(s),d.process(s),u.process(s),h.process(s),f.process(s),p.process(s),m.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(g))},y=()=>{n=!0,r=!0,s.isProcessing||t(g)};return{schedule:Sv.reduce((b,v)=>{const E=o[v];return b[v]=(k,C=!1,S=!1)=>(n||y(),E.schedule(k,C,S)),b},{}),cancel:b=>{for(let v=0;v<Sv.length;v++)o[Sv[v]].cancel(b)},state:s,steps:o}}const{schedule:Wn,cancel:fu,state:ts,steps:RS}=uH(typeof requestAnimationFrame<"u"?requestAnimationFrame:Oo,!0);let b1;function OSe(){b1=void 0}const Ci={now:()=>(b1===void 0&&Ci.set(ts.isProcessing||Dl.useManualTiming?ts.timestamp:performance.now()),b1),set:t=>{b1=t,queueMicrotask(OSe)}},hH=t=>e=>typeof e=="string"&&e.startsWith(t),Qj=hH("--"),DSe=hH("var(--"),Jj=t=>DSe(t)?USe.test(t.split("/*")[0].trim()):!1,USe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,s0={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},bx={...s0,transform:t=>Ol(0,1,t)},Tv={...s0,default:1},My=t=>Math.round(t*1e5)/1e5,Zj=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function MSe(t){return t==null}const LSe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Xj=(t,e)=>n=>!!(typeof n=="string"&&LSe.test(n)&&n.startsWith(t)||e&&!MSe(n)&&Object.prototype.hasOwnProperty.call(n,e)),fH=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,i,o,c]=r.match(Zj);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},BSe=t=>Ol(0,255,t),PS={...s0,transform:t=>Math.round(BSe(t))},Eh={test:Xj("rgb","red"),parse:fH("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+PS.transform(t)+", "+PS.transform(e)+", "+PS.transform(n)+", "+My(bx.transform(r))+")"};function $Se(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Q_={test:Xj("#"),parse:$Se,transform:Eh.transform},pb=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),od=pb("deg"),Cc=pb("%"),bt=pb("px"),FSe=pb("vh"),zSe=pb("vw"),b6={...Cc,parse:t=>Cc.parse(t)/100,transform:t=>Cc.transform(t*100)},Vp={test:Xj("hsl","hue"),parse:fH("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Cc.transform(My(e))+", "+Cc.transform(My(n))+", "+My(bx.transform(r))+")"},yr={test:t=>Eh.test(t)||Q_.test(t)||Vp.test(t),parse:t=>Eh.test(t)?Eh.parse(t):Vp.test(t)?Vp.parse(t):Q_.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Eh.transform(t):Vp.transform(t),getAnimatableNone:t=>{const e=yr.parse(t);return e.alpha=0,yr.transform(e)}},HSe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function VSe(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Zj))==null?void 0:e.length)||0)+(((n=t.match(HSe))==null?void 0:n.length)||0)>0}const pH="number",mH="color",WSe="var",qSe="var(",v6="${}",KSe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function vx(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const c=e.replace(KSe,l=>(yr.test(l)?(r.color.push(i),s.push(mH),n.push(yr.parse(l))):l.startsWith(qSe)?(r.var.push(i),s.push(WSe),n.push(l)):(r.number.push(i),s.push(pH),n.push(parseFloat(l))),++i,v6)).split(v6);return{values:n,split:c,indexes:r,types:s}}function gH(t){return vx(t).values}function yH(t){const{split:e,types:n}=vx(t),r=e.length;return s=>{let i="";for(let o=0;o<r;o++)if(i+=e[o],s[o]!==void 0){const c=n[o];c===pH?i+=My(s[o]):c===mH?i+=yr.transform(s[o]):i+=s[o]}return i}}const GSe=t=>typeof t=="number"?0:yr.test(t)?yr.getAnimatableNone(t):t;function YSe(t){const e=gH(t);return yH(t)(e.map(GSe))}const pu={test:VSe,parse:gH,createTransformer:yH,getAnimatableNone:YSe};function OS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function QSe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const c=n<.5?n*(1+e):n+e-n*e,l=2*n-c;s=OS(l,c,t+1/3),i=OS(l,c,t),o=OS(l,c,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}function GE(t,e){return n=>n>0?e:t}const Yn=(t,e,n)=>t+(e-t)*n,DS=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},JSe=[Q_,Eh,Vp],ZSe=t=>JSe.find(e=>e.test(t));function E6(t){const e=ZSe(t);if(!e)return!1;let n=e.parse(t);return e===Vp&&(n=QSe(n)),n}const C6=(t,e)=>{const n=E6(t),r=E6(e);if(!n||!r)return GE(t,e);const s={...n};return i=>(s.red=DS(n.red,r.red,i),s.green=DS(n.green,r.green,i),s.blue=DS(n.blue,r.blue,i),s.alpha=Yn(n.alpha,r.alpha,i),Eh.transform(s))},J_=new Set(["none","hidden"]);function XSe(t,e){return J_.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function e2e(t,e){return n=>Yn(t,e,n)}function eR(t){return typeof t=="number"?e2e:typeof t=="string"?Jj(t)?GE:yr.test(t)?C6:r2e:Array.isArray(t)?wH:typeof t=="object"?yr.test(t)?C6:t2e:GE}function wH(t,e){const n=[...t],r=n.length,s=t.map((i,o)=>eR(i)(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}}function t2e(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=eR(t[s])(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function n2e(t,e){const n=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],o=t.indexes[i][r[i]],c=t.values[o]??0;n[s]=c,r[i]++}return n}const r2e=(t,e)=>{const n=pu.createTransformer(e),r=vx(t),s=vx(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?J_.has(t)&&!s.values.length||J_.has(e)&&!r.values.length?XSe(t,e):hb(wH(n2e(r,s),s.values),n):GE(t,e)};function xH(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Yn(t,e,n):eR(t)(t,e)}const s2e=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>Wn.update(e,n),stop:()=>fu(e),now:()=>ts.isProcessing?ts.timestamp:Ci.now()}},bH=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let i=0;i<s;i++)r+=Math.round(t(i/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},YE=2e4;function tR(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<YE;)e+=n,r=t.next(e);return e>=YE?1/0:e}function i2e(t,e=100,n){const r=n({...t,keyframes:[0,e]}),s=Math.min(tR(r),YE);return{type:"keyframes",ease:i=>r.next(s*i).value/e,duration:Ec(s)}}const o2e=5;function vH(t,e,n){const r=Math.max(e-o2e,0);return eH(n-t(r),e-r)}const er={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},US=.001;function a2e({duration:t=er.duration,bounce:e=er.bounce,velocity:n=er.velocity,mass:r=er.mass}){let s,i,o=1-e;o=Ol(er.minDamping,er.maxDamping,o),t=Ol(er.minDuration,er.maxDuration,Ec(t)),o<1?(s=d=>{const u=d*o,h=u*t,f=u-n,p=Z_(d,o),m=Math.exp(-h);return US-f/p*m},i=d=>{const h=d*o*t,f=h*n+n,p=Math.pow(o,2)*Math.pow(d,2)*t,m=Math.exp(-h),g=Z_(Math.pow(d,2),o);return(-s(d)+US>0?-1:1)*((f-p)*m)/g}):(s=d=>{const u=Math.exp(-d*t),h=(d-n)*t+1;return-US+u*h},i=d=>{const u=Math.exp(-d*t),h=(n-d)*(t*t);return u*h});const c=5/t,l=l2e(s,i,c);if(t=vc(t),isNaN(l))return{stiffness:er.stiffness,damping:er.damping,duration:t};{const d=Math.pow(l,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const c2e=12;function l2e(t,e,n){let r=n;for(let s=1;s<c2e;s++)r=r-t(r)/e(r);return r}function Z_(t,e){return t*Math.sqrt(1-e*e)}const d2e=["duration","bounce"],u2e=["stiffness","damping","mass"];function N6(t,e){return e.some(n=>t[n]!==void 0)}function h2e(t){let e={velocity:er.velocity,stiffness:er.stiffness,damping:er.damping,mass:er.mass,isResolvedFromDuration:!1,...t};if(!N6(t,u2e)&&N6(t,d2e))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*Ol(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:er.mass,stiffness:s,damping:i}}else{const n=a2e(t);e={...e,...n,mass:er.mass},e.isResolvedFromDuration=!0}return e}function QE(t=er.visualDuration,e=er.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:i},{stiffness:l,damping:d,mass:u,duration:h,velocity:f,isResolvedFromDuration:p}=h2e({...n,velocity:-Ec(n.velocity||0)}),m=f||0,g=d/(2*Math.sqrt(l*u)),y=o-i,x=Ec(Math.sqrt(l/u)),w=Math.abs(y)<5;r||(r=w?er.restSpeed.granular:er.restSpeed.default),s||(s=w?er.restDelta.granular:er.restDelta.default);let b;if(g<1){const E=Z_(x,g);b=k=>{const C=Math.exp(-g*x*k);return o-C*((m+g*x*y)/E*Math.sin(E*k)+y*Math.cos(E*k))}}else if(g===1)b=E=>o-Math.exp(-x*E)*(y+(m+x*y)*E);else{const E=x*Math.sqrt(g*g-1);b=k=>{const C=Math.exp(-g*x*k),S=Math.min(E*k,300);return o-C*((m+g*x*y)*Math.sinh(S)+E*y*Math.cosh(S))/E}}const v={calculatedDuration:p&&h||null,next:E=>{const k=b(E);if(p)c.done=E>=h;else{let C=E===0?m:0;g<1&&(C=E===0?vc(m):vH(b,E,k));const S=Math.abs(C)<=r,N=Math.abs(o-k)<=s;c.done=S&&N}return c.value=c.done?o:k,c},toString:()=>{const E=Math.min(tR(v),YE),k=bH(C=>v.next(E*C).value,E,30);return E+"ms "+k},toTransition:()=>{}};return v}QE.applyToOptions=t=>{const e=i2e(t,100,QE);return t.ease=e.ease,t.duration=vc(e.duration),t.type="keyframes",t};function X_({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:c,max:l,restDelta:d=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},p=S=>c!==void 0&&S<c||l!==void 0&&S>l,m=S=>c===void 0?l:l===void 0||Math.abs(c-S)<Math.abs(l-S)?c:l;let g=n*e;const y=h+g,x=o===void 0?y:o(y);x!==y&&(g=x-h);const w=S=>-g*Math.exp(-S/r),b=S=>x+w(S),v=S=>{const N=w(S),I=b(S);f.done=Math.abs(N)<=d,f.value=f.done?x:I};let E,k;const C=S=>{p(f.value)&&(E=S,k=QE({keyframes:[f.value,m(f.value)],velocity:vH(b,S,f.value),damping:s,stiffness:i,restDelta:d,restSpeed:u}))};return C(0),{calculatedDuration:null,next:S=>{let N=!1;return!k&&E===void 0&&(N=!0,v(S),C(S)),E!==void 0&&S>=E?k.next(S-E):(!N&&v(S),f)}}}function f2e(t,e,n){const r=[],s=n||Dl.mix||xH,i=t.length-1;for(let o=0;o<i;o++){let c=s(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Oo:e;c=hb(l,c)}r.push(c)}return r}function p2e(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(Wj(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const c=f2e(e,r,s),l=c.length,d=u=>{if(o&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=xx(t[h],t[h+1],u);return c[h](f)};return n?u=>d(Ol(t[0],t[i-1],u)):d}function m2e(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=xx(0,e,r);t.push(Yn(n,1,s))}}function g2e(t){const e=[0];return m2e(e,t.length-1),e}function y2e(t,e){return t.map(n=>n*e)}function w2e(t,e){return t.map(()=>e||lH).splice(0,t.length-1)}function Ly({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=kSe(r)?r.map(x6):x6(r),i={done:!1,value:e[0]},o=y2e(n&&n.length===e.length?n:g2e(e),t),c=p2e(o,e,{ease:Array.isArray(s)?s:w2e(e,s)});return{calculatedDuration:t,next:l=>(i.value=c(l),i.done=l>=t,i)}}const x2e=t=>t!==null;function nR(t,{repeat:e,repeatType:n="loop"},r,s=1){const i=t.filter(x2e),c=s<0||e&&n!=="loop"&&e%2===1?0:i.length-1;return!c||r===void 0?i[c]:r}const b2e={decay:X_,inertia:X_,tween:Ly,keyframes:Ly,spring:QE};function EH(t){typeof t.type=="string"&&(t.type=b2e[t.type])}class rR{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const v2e=t=>t/100;class sR extends rR{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,s;const{motionValue:n}=this.options;n&&n.updatedAt!==Ci.now()&&this.tick(Ci.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(r=this.options).onStop)==null||s.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;EH(e);const{type:n=Ly,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=e;let{keyframes:c}=e;const l=n||Ly;l!==Ly&&typeof c[0]!="number"&&(this.mixKeyframes=hb(v2e,xH(c[0],c[1])),c=[0,100]);const d=l({...e,keyframes:c});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...c].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=tR(d));const{calculatedDuration:u}=d;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=d}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:u,repeat:h,repeatType:f,repeatDelay:p,type:m,onUpdate:g,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const x=this.currentTime-d*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let b=this.currentTime,v=r;if(h){const S=Math.min(this.currentTime,s)/c;let N=Math.floor(S),I=S%1;!I&&S>=1&&(I=1),I===1&&N--,N=Math.min(N,h+1),!!(N%2)&&(f==="reverse"?(I=1-I,p&&(I-=p/c)):f==="mirror"&&(v=o)),b=Ol(0,1,I)*c}const E=w?{done:!1,value:u[0]}:v.next(b);i&&(E.value=i(E.value));let{done:k}=E;!w&&l!==null&&(k=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const C=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return C&&m!==X_&&(E.value=nR(u,this.options,y,this.speed)),g&&g(E.value),C&&this.finish(),E}then(e,n){return this.finished.then(e,n)}get duration(){return Ec(this.calculatedDuration)}get time(){return Ec(this.currentTime)}set time(e){var n;e=vc(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ci.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ec(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:e=s2e,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(s=this.options).onPlay)==null||i.call(s);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ci.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function E2e(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Ch=t=>t*180/Math.PI,ek=t=>{const e=Ch(Math.atan2(t[1],t[0]));return tk(e)},C2e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:ek,rotateZ:ek,skewX:t=>Ch(Math.atan(t[1])),skewY:t=>Ch(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},tk=t=>(t=t%360,t<0&&(t+=360),t),A6=ek,S6=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),T6=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),N2e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:S6,scaleY:T6,scale:t=>(S6(t)+T6(t))/2,rotateX:t=>tk(Ch(Math.atan2(t[6],t[5]))),rotateY:t=>tk(Ch(Math.atan2(-t[2],t[0]))),rotateZ:A6,rotate:A6,skewX:t=>Ch(Math.atan(t[4])),skewY:t=>Ch(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function nk(t){return t.includes("scale")?1:0}function rk(t,e){if(!t||t==="none")return nk(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=N2e,s=n;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=C2e,s=c}if(!s)return nk(e);const i=r[e],o=s[1].split(",").map(S2e);return typeof i=="function"?i(o):o[i]}const A2e=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return rk(n,e)};function S2e(t){return parseFloat(t.trim())}const i0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],o0=new Set(i0),_6=t=>t===s0||t===bt,T2e=new Set(["x","y","z"]),_2e=i0.filter(t=>!T2e.has(t));function k2e(t){const e=[];return _2e.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const tf={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>rk(e,"x"),y:(t,{transform:e})=>rk(e,"y")};tf.translateX=tf.x;tf.translateY=tf.y;const nf=new Set;let sk=!1,ik=!1,ok=!1;function CH(){if(ik){const t=Array.from(nf).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=k2e(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,o])=>{var c;(c=r.getValue(i))==null||c.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}ik=!1,sk=!1,nf.forEach(t=>t.complete(ok)),nf.clear()}function NH(){nf.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(ik=!0)})}function I2e(){ok=!0,NH(),CH(),ok=!1}class iR{constructor(e,n,r,s,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(nf.add(this),sk||(sk=!0,Wn.read(NH),Wn.resolveKeyframes(CH))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;if(e[0]===null){const i=s==null?void 0:s.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&n){const c=r.readValue(n,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),s&&i===void 0&&s.set(e[0])}E2e(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),nf.delete(this)}cancel(){this.state==="scheduled"&&(nf.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const j2e=t=>t.startsWith("--");function R2e(t,e,n){j2e(e)?t.style.setProperty(e,n):t.style[e]=n}const P2e=qj(()=>window.ScrollTimeline!==void 0),O2e={};function D2e(t,e){const n=qj(t);return()=>O2e[e]??n()}const AH=D2e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),uy=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,k6={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:uy([0,.65,.55,1]),circOut:uy([.55,0,1,.45]),backIn:uy([.31,.01,.66,-.59]),backOut:uy([.33,1.53,.69,.99])};function SH(t,e){if(t)return typeof t=="function"?AH()?bH(t,e):"ease-out":dH(t)?uy(t):Array.isArray(t)?t.map(n=>SH(n,e)||k6.easeOut):k6[t]}function U2e(t,e,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:c="easeOut",times:l}={},d=void 0){const u={[e]:n};l&&(u.offset=l);const h=SH(c,s);Array.isArray(h)&&(u.easing=h);const f={delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return d&&(f.pseudoElement=d),t.animate(u,f)}function TH(t){return typeof t=="function"&&"applyToOptions"in t}function M2e({type:t,...e}){return TH(t)&&AH()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class L2e extends rR{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:c,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,Wj(typeof e.type!="string");const d=M2e(e);this.animation=U2e(n,r,s,d,i),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=nR(s,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(u):R2e(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,r;const e=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Ec(Number(e))}get time(){return Ec(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=vc(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&P2e()?(this.animation.timeline=e,Oo):n(this)}}const _H={anticipate:oH,backInOut:iH,circInOut:cH};function B2e(t){return t in _H}function $2e(t){typeof t.ease=="string"&&B2e(t.ease)&&(t.ease=_H[t.ease])}const I6=10;class F2e extends L2e{constructor(e){$2e(e),EH(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const c=new sR({...o,autoplay:!1}),l=vc(this.finishedTime??this.time);n.setWithVelocity(c.sample(l-I6).value,c.sample(l).value,I6),c.stop()}}const j6=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(pu.test(t)||t==="0")&&!t.startsWith("url("));function z2e(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function H2e(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=j6(s,e),c=j6(i,e);return!o||!c?!1:z2e(t)||(n==="spring"||TH(n))&&r}function ak(t){t.duration=0,t.type}const V2e=new Set(["opacity","clipPath","filter","transform"]),W2e=qj(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function q2e(t){var u;const{motionValue:e,name:n,repeatDelay:r,repeatType:s,damping:i,type:o}=t;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:d}=e.owner.getProps();return W2e()&&n&&V2e.has(n)&&(n!=="transform"||!d)&&!l&&!r&&s!=="mirror"&&i!==0&&o!=="inertia"}const K2e=40;class G2e extends rR{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",keyframes:c,name:l,motionValue:d,element:u,...h}){var m;super(),this.stop=()=>{var g,y;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(y=this.keyframeResolver)==null||y.cancel()},this.createdAt=Ci.now();const f={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:o,name:l,motionValue:d,element:u,...h},p=(u==null?void 0:u.KeyframeResolver)||iR;this.keyframeResolver=new p(c,(g,y,x)=>this.onKeyframesResolved(g,y,f,!x),l,d,u),(m=this.keyframeResolver)==null||m.scheduleResolve()}onKeyframesResolved(e,n,r,s){this.keyframeResolver=void 0;const{name:i,type:o,velocity:c,delay:l,isHandoff:d,onUpdate:u}=r;this.resolvedAt=Ci.now(),H2e(e,i,o,c)||((Dl.instantAnimations||!l)&&(u==null||u(nR(e,r,n))),e[0]=e[e.length-1],ak(r),r.repeat=0);const f={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>K2e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},p=!d&&q2e(f)?new F2e({...f,element:f.motionValue.owner.current}):new sR(f);p.finished.then(()=>this.notifyFinished()).catch(Oo),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),I2e()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const Y2e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Q2e(t){const e=Y2e.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function kH(t,e,n=1){const[r,s]=Q2e(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return Jz(o)?parseFloat(o):o}return Jj(s)?kH(s,e,n+1):s}function oR(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const IH=new Set(["width","height","top","left","right","bottom",...i0]),J2e={test:t=>t==="auto",parse:t=>t},jH=t=>e=>e.test(t),RH=[s0,bt,Cc,od,zSe,FSe,J2e],R6=t=>RH.find(jH(t));function Z2e(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Xz(t):!0}const X2e=new Set(["brightness","contrast","saturate","opacity"]);function eTe(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(Zj)||[];if(!r)return t;const s=n.replace(r,"");let i=X2e.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const tTe=/\b([a-z-]*)\(.*?\)/gu,ck={...pu,getAnimatableNone:t=>{const e=t.match(tTe);return e?e.map(eTe).join(" "):t}},P6={...s0,transform:Math.round},nTe={rotate:od,rotateX:od,rotateY:od,rotateZ:od,scale:Tv,scaleX:Tv,scaleY:Tv,scaleZ:Tv,skew:od,skewX:od,skewY:od,distance:bt,translateX:bt,translateY:bt,translateZ:bt,x:bt,y:bt,z:bt,perspective:bt,transformPerspective:bt,opacity:bx,originX:b6,originY:b6,originZ:bt},aR={borderWidth:bt,borderTopWidth:bt,borderRightWidth:bt,borderBottomWidth:bt,borderLeftWidth:bt,borderRadius:bt,radius:bt,borderTopLeftRadius:bt,borderTopRightRadius:bt,borderBottomRightRadius:bt,borderBottomLeftRadius:bt,width:bt,maxWidth:bt,height:bt,maxHeight:bt,top:bt,right:bt,bottom:bt,left:bt,padding:bt,paddingTop:bt,paddingRight:bt,paddingBottom:bt,paddingLeft:bt,margin:bt,marginTop:bt,marginRight:bt,marginBottom:bt,marginLeft:bt,backgroundPositionX:bt,backgroundPositionY:bt,...nTe,zIndex:P6,fillOpacity:bx,strokeOpacity:bx,numOctaves:P6},rTe={...aR,color:yr,backgroundColor:yr,outlineColor:yr,fill:yr,stroke:yr,borderColor:yr,borderTopColor:yr,borderRightColor:yr,borderBottomColor:yr,borderLeftColor:yr,filter:ck,WebkitFilter:ck},PH=t=>rTe[t];function OH(t,e){let n=PH(t);return n!==ck&&(n=pu),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const sTe=new Set(["auto","none","0"]);function iTe(t,e,n){let r=0,s;for(;r<t.length&&!s;){const i=t[r];typeof i=="string"&&!sTe.has(i)&&vx(i).values.length&&(s=t[r]),r++}if(s&&n)for(const i of e)t[i]=OH(n,s)}class oTe extends iR{constructor(e,n,r,s,i){super(e,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let d=e[l];if(typeof d=="string"&&(d=d.trim(),Jj(d))){const u=kH(d,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!IH.has(r)||e.length!==2)return;const[s,i]=e,o=R6(s),c=R6(i);if(o!==c)if(_6(o)&&_6(c))for(let l=0;l<e.length;l++){const d=e[l];typeof d=="string"&&(e[l]=parseFloat(d))}else tf[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)(e[s]===null||Z2e(e[s]))&&r.push(s);r.length&&iTe(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tf[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var c;const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,o=r[i];r[i]=tf[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([l,d])=>{e.getValue(l).set(d)}),this.resolveNoneKeyframes()}}function aTe(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const s=(n==null?void 0:n[t])??r.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const DH=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function UH(t){return Zz(t)&&"offsetHeight"in t}const O6=30,cTe=t=>!isNaN(parseFloat(t));class lTe{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var i;const s=Ci.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Ci.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=cTe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new Kj);const r=this.events[e].add(n);return e==="change"?()=>{r(),Wn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ci.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>O6)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,O6);return eH(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Og(t,e){return new lTe(t,e)}const{schedule:cR}=uH(queueMicrotask,!1),Jo={x:!1,y:!1};function MH(){return Jo.x||Jo.y}function dTe(t){return t==="x"||t==="y"?Jo[t]?null:(Jo[t]=!0,()=>{Jo[t]=!1}):Jo.x||Jo.y?null:(Jo.x=Jo.y=!0,()=>{Jo.x=Jo.y=!1})}function LH(t,e){const n=aTe(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function D6(t){return!(t.pointerType==="touch"||MH())}function uTe(t,e,n={}){const[r,s,i]=LH(t,n),o=c=>{if(!D6(c))return;const{target:l}=c,d=e(l,c);if(typeof d!="function"||!l)return;const u=h=>{D6(h)&&(d(h),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(c=>{c.addEventListener("pointerenter",o,s)}),i}const BH=(t,e)=>e?t===e?!0:BH(t,e.parentElement):!1,lR=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,hTe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function fTe(t){return hTe.has(t.tagName)||t.tabIndex!==-1}const v1=new WeakSet;function U6(t){return e=>{e.key==="Enter"&&t(e)}}function MS(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const pTe=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=U6(()=>{if(v1.has(n))return;MS(n,"down");const s=U6(()=>{MS(n,"up")}),i=()=>MS(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function M6(t){return lR(t)&&!MH()}function mTe(t,e,n={}){const[r,s,i]=LH(t,n),o=c=>{const l=c.currentTarget;if(!M6(c))return;v1.add(l);const d=e(l,c),u=(p,m)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),v1.has(l)&&v1.delete(l),M6(p)&&typeof d=="function"&&d(p,{success:m})},h=p=>{u(p,l===window||l===document||n.useGlobalTarget||BH(l,p.target))},f=p=>{u(p,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",f,s)};return r.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,s),UH(c)&&(c.addEventListener("focus",d=>pTe(d,s)),!fTe(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),i}function $H(t){return Zz(t)&&"ownerSVGElement"in t}function gTe(t){return $H(t)&&t.tagName==="svg"}const js=t=>!!(t&&t.getVelocity),yTe=[...RH,yr,pu],wTe=t=>yTe.find(jH(t)),dR=A.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function L6(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function xTe(...t){return e=>{let n=!1;const r=t.map(s=>{const i=L6(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():L6(t[s],null)}}}}function bTe(...t){return A.useCallback(xTe(...t),t)}class vTe extends A.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=UH(r)&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ETe({children:t,isPresent:e,anchorX:n,root:r}){const s=A.useId(),i=A.useRef(null),o=A.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=A.useContext(dR),l=bTe(i,t==null?void 0:t.ref);return A.useInsertionEffect(()=>{const{width:d,height:u,top:h,left:f,right:p}=o.current;if(e||!i.current||!d||!u)return;const m=n==="left"?`left: ${f}`:`right: ${p}`;i.current.dataset.motionPopId=s;const g=document.createElement("style");c&&(g.nonce=c);const y=r??document.head;return y.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${u}px !important;
            ${m}px !important;
            top: ${h}px !important;
          }
        `),()=>{y.contains(g)&&y.removeChild(g)}},[e]),a.jsx(vTe,{isPresent:e,childRef:i,sizeRef:o,children:A.cloneElement(t,{ref:l})})}const CTe=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o,anchorX:c,root:l})=>{const d=Fj(NTe),u=A.useId();let h=!0,f=A.useMemo(()=>(h=!1,{id:u,initial:e,isPresent:n,custom:s,onExitComplete:p=>{d.set(p,!0);for(const m of d.values())if(!m)return;r&&r()},register:p=>(d.set(p,!1),()=>d.delete(p))}),[n,d,r]);return i&&h&&(f={...f}),A.useMemo(()=>{d.forEach((p,m)=>d.set(m,!1))},[n]),A.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(t=a.jsx(ETe,{isPresent:n,anchorX:c,root:l,children:t})),a.jsx(vN.Provider,{value:f,children:t})};function NTe(){return new Map}function FH(t=!0){const e=A.useContext(vN);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,i=A.useId();A.useEffect(()=>{if(t)return s(i)},[t]);const o=A.useCallback(()=>t&&r&&r(i),[i,r,t]);return!n&&r?[!1,o]:[!0]}const _v=t=>t.key||"";function B6(t){const e=[];return A.Children.forEach(t,n=>{A.isValidElement(n)&&e.push(n)}),e}const Do=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:o=!1,anchorX:c="left",root:l})=>{const[d,u]=FH(o),h=A.useMemo(()=>B6(t),[t]),f=o&&!d?[]:h.map(_v),p=A.useRef(!0),m=A.useRef(h),g=Fj(()=>new Map),[y,x]=A.useState(h),[w,b]=A.useState(h);Qz(()=>{p.current=!1,m.current=h;for(let k=0;k<w.length;k++){const C=_v(w[k]);f.includes(C)?g.delete(C):g.get(C)!==!0&&g.set(C,!1)}},[w,f.length,f.join("-")]);const v=[];if(h!==y){let k=[...h];for(let C=0;C<w.length;C++){const S=w[C],N=_v(S);f.includes(N)||(k.splice(C,0,S),v.push(S))}return i==="wait"&&v.length&&(k=v),b(B6(k)),x(h),null}const{forceRender:E}=A.useContext($j);return a.jsx(a.Fragment,{children:w.map(k=>{const C=_v(k),S=o&&!d?!1:h===w||f.includes(C),N=()=>{if(g.has(C))g.set(C,!0);else return;let I=!0;g.forEach(F=>{F||(I=!1)}),I&&(E==null||E(),b(m.current),o&&(u==null||u()),r&&r())};return a.jsx(CTe,{isPresent:S,initial:!p.current||n?void 0:!1,custom:e,presenceAffectsLayout:s,mode:i,root:l,onExitComplete:S?void 0:N,anchorX:c,children:k},C)})})},zH=A.createContext({strict:!1}),$6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Dg={};for(const t in $6)Dg[t]={isEnabled:e=>$6[t].some(n=>!!e[n])};function ATe(t){for(const e in t)Dg[e]={...Dg[e],...t[e]}}const STe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function JE(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||STe.has(t)}let HH=t=>!JE(t);function TTe(t){typeof t=="function"&&(HH=e=>e.startsWith("on")?!JE(e):t(e))}try{TTe(require("@emotion/is-prop-valid").default)}catch{}function _Te(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(HH(s)||n===!0&&JE(s)||!e&&!JE(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}const EN=A.createContext({});function CN(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Ex(t){return typeof t=="string"||Array.isArray(t)}const uR=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],hR=["initial",...uR];function NN(t){return CN(t.animate)||hR.some(e=>Ex(t[e]))}function VH(t){return!!(NN(t)||t.variants)}function kTe(t,e){if(NN(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Ex(n)?n:void 0,animate:Ex(r)?r:void 0}}return t.inherit!==!1?e:{}}function ITe(t){const{initial:e,animate:n}=kTe(t,A.useContext(EN));return A.useMemo(()=>({initial:e,animate:n}),[F6(e),F6(n)])}function F6(t){return Array.isArray(t)?t.join(" "):t}const Cx={};function jTe(t){for(const e in t)Cx[e]=t[e],Qj(e)&&(Cx[e].isCSSVariable=!0)}function WH(t,{layout:e,layoutId:n}){return o0.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Cx[t]||t==="opacity")}const RTe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},PTe=i0.length;function OTe(t,e,n){let r="",s=!0;for(let i=0;i<PTe;i++){const o=i0[i],c=t[o];if(c===void 0)continue;let l=!0;if(typeof c=="number"?l=c===(o.startsWith("scale")?1:0):l=parseFloat(c)===0,!l||n){const d=DH(c,aR[o]);if(!l){s=!1;const u=RTe[o]||o;r+=`${u}(${d}) `}n&&(e[o]=d)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function fR(t,e,n){const{style:r,vars:s,transformOrigin:i}=t;let o=!1,c=!1;for(const l in e){const d=e[l];if(o0.has(l)){o=!0;continue}else if(Qj(l)){s[l]=d;continue}else{const u=DH(d,aR[l]);l.startsWith("origin")?(c=!0,i[l]=u):r[l]=u}}if(e.transform||(o||n?r.transform=OTe(e,t.transform,n):r.transform&&(r.transform="none")),c){const{originX:l="50%",originY:d="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${d} ${u}`}}const pR=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function qH(t,e,n){for(const r in e)!js(e[r])&&!WH(r,n)&&(t[r]=e[r])}function DTe({transformTemplate:t},e){return A.useMemo(()=>{const n=pR();return fR(n,e,t),Object.assign({},n.vars,n.style)},[e])}function UTe(t,e){const n=t.style||{},r={};return qH(r,n,t),Object.assign(r,DTe(t,e)),r}function MTe(t,e){const n={},r=UTe(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const LTe={offset:"stroke-dashoffset",array:"stroke-dasharray"},BTe={offset:"strokeDashoffset",array:"strokeDasharray"};function $Te(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?LTe:BTe;t[i.offset]=bt.transform(-r);const o=bt.transform(e),c=bt.transform(n);t[i.array]=`${o} ${c}`}function KH(t,{attrX:e,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:o=0,...c},l,d,u){if(fR(t,c,d),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:f}=t;h.transform&&(f.transform=h.transform,delete h.transform),(f.transform||h.transformOrigin)&&(f.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete h.transformBox),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),s!==void 0&&$Te(h,s,i,o,!1)}const GH=()=>({...pR(),attrs:{}}),YH=t=>typeof t=="string"&&t.toLowerCase()==="svg";function FTe(t,e,n,r){const s=A.useMemo(()=>{const i=GH();return KH(i,e,YH(r),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};qH(i,t.style,t),s.style={...i,...s.style}}return s}const zTe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function mR(t){return typeof t!="string"||t.includes("-")?!1:!!(zTe.indexOf(t)>-1||/[A-Z]/u.test(t))}function HTe(t,e,n,{latestValues:r},s,i=!1){const c=(mR(t)?FTe:MTe)(e,r,s,t),l=_Te(e,typeof t=="string",i),d=t!==A.Fragment?{...l,...c,ref:n}:{},{children:u}=e,h=A.useMemo(()=>js(u)?u.get():u,[u]);return A.createElement(t,{...d,children:h})}function z6(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function gR(t,e,n,r){if(typeof e=="function"){const[s,i]=z6(r);e=e(n!==void 0?n:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=z6(r);e=e(n!==void 0?n:t.custom,s,i)}return e}function E1(t){return js(t)?t.get():t}function VTe({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,s){return{latestValues:WTe(n,r,s,t),renderState:e()}}function WTe(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=E1(i[f]);let{initial:o,animate:c}=t;const l=NN(t),d=VH(t);e&&d&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?c:o;if(h&&typeof h!="boolean"&&!CN(h)){const f=Array.isArray(h)?h:[h];for(let p=0;p<f.length;p++){const m=gR(t,f[p]);if(m){const{transitionEnd:g,transition:y,...x}=m;for(const w in x){let b=x[w];if(Array.isArray(b)){const v=u?b.length-1:0;b=b[v]}b!==null&&(s[w]=b)}for(const w in g)s[w]=g[w]}}}return s}const QH=t=>(e,n)=>{const r=A.useContext(EN),s=A.useContext(vN),i=()=>VTe(t,e,r,s);return n?i():Fj(i)};function yR(t,e,n){var i;const{style:r}=t,s={};for(const o in r)(js(r[o])||e.style&&js(e.style[o])||WH(o,t)||((i=n==null?void 0:n.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}const qTe=QH({scrapeMotionValuesFromProps:yR,createRenderState:pR});function JH(t,e,n){const r=yR(t,e,n);for(const s in t)if(js(t[s])||js(e[s])){const i=i0.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=t[s]}return r}const KTe=QH({scrapeMotionValuesFromProps:JH,createRenderState:GH}),GTe=Symbol.for("motionComponentSymbol");function Wp(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function YTe(t,e,n){return A.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Wp(n)&&(n.current=r))},[e])}const wR=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),QTe="framerAppearId",ZH="data-"+wR(QTe),XH=A.createContext({});function JTe(t,e,n,r,s){var g,y;const{visualElement:i}=A.useContext(EN),o=A.useContext(zH),c=A.useContext(vN),l=A.useContext(dR).reducedMotion,d=A.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(t,{visualState:e,parent:i,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:l}));const u=d.current,h=A.useContext(XH);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&ZTe(d.current,n,s,h);const f=A.useRef(!1);A.useInsertionEffect(()=>{u&&f.current&&u.update(n,c)});const p=n[ZH],m=A.useRef(!!p&&!((g=window.MotionHandoffIsComplete)!=null&&g.call(window,p))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,p)));return Qz(()=>{u&&(f.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),m.current&&u.animationState&&u.animationState.animateChanges())}),A.useEffect(()=>{u&&(!m.current&&u.animationState&&u.animationState.animateChanges(),m.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,p)}),m.current=!1),u.enteringChildren=void 0)}),u}function ZTe(t,e,n,r){const{layoutId:s,layout:i,drag:o,dragConstraints:c,layoutScroll:l,layoutRoot:d,layoutCrossfade:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:eV(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||c&&Wp(c),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:d})}function eV(t){if(t)return t.options.allowProjection!==!1?t.projection:eV(t.parent)}function LS(t,{forwardMotionProps:e=!1}={},n,r){n&&ATe(n);const s=mR(t)?KTe:qTe;function i(c,l){let d;const u={...A.useContext(dR),...c,layoutId:XTe(c)},{isStatic:h}=u,f=ITe(c),p=s(c,h);if(!h&&zj){e_e();const m=t_e(u);d=m.MeasureLayout,f.visualElement=JTe(t,p,u,r,m.ProjectionNode)}return a.jsxs(EN.Provider,{value:f,children:[d&&f.visualElement?a.jsx(d,{visualElement:f.visualElement,...u}):null,HTe(t,c,YTe(p,f.visualElement,l),p,h,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=A.forwardRef(i);return o[GTe]=t,o}function XTe({layoutId:t}){const e=A.useContext($j).id;return e&&t!==void 0?e+"-"+t:t}function e_e(t,e){A.useContext(zH).strict}function t_e(t){const{drag:e,layout:n}=Dg;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function n_e(t,e){if(typeof Proxy>"u")return LS;const n=new Map,r=(i,o)=>LS(i,o,t,e),s=(i,o)=>r(i,o);return new Proxy(s,{get:(i,o)=>o==="create"?r:(n.has(o)||n.set(o,LS(o,void 0,t,e)),n.get(o))})}function tV({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function r_e({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function s_e(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function BS(t){return t===void 0||t===1}function lk({scale:t,scaleX:e,scaleY:n}){return!BS(t)||!BS(e)||!BS(n)}function Wu(t){return lk(t)||nV(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function nV(t){return H6(t.x)||H6(t.y)}function H6(t){return t&&t!=="0%"}function ZE(t,e,n){const r=t-n,s=e*r;return n+s}function V6(t,e,n,r,s){return s!==void 0&&(t=ZE(t,s,r)),ZE(t,n,r)+e}function dk(t,e=0,n=1,r,s){t.min=V6(t.min,e,n,r,s),t.max=V6(t.max,e,n,r,s)}function rV(t,{x:e,y:n}){dk(t.x,e.translate,e.scale,e.originPoint),dk(t.y,n.translate,n.scale,n.originPoint)}const W6=.999999999999,q6=1.0000000000001;function i_e(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let c=0;c<s;c++){i=n[c],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Kp(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,rV(t,o)),r&&Wu(i.latestValues)&&Kp(t,i.latestValues))}e.x<q6&&e.x>W6&&(e.x=1),e.y<q6&&e.y>W6&&(e.y=1)}function qp(t,e){t.min=t.min+e,t.max=t.max+e}function K6(t,e,n,r,s=.5){const i=Yn(t.min,t.max,s);dk(t,e,n,i,r)}function Kp(t,e){K6(t.x,e.x,e.scaleX,e.scale,e.originX),K6(t.y,e.y,e.scaleY,e.scale,e.originY)}function sV(t,e){return tV(s_e(t.getBoundingClientRect(),e))}function o_e(t,e,n){const r=sV(t,n),{scroll:s}=e;return s&&(qp(r.x,s.offset.x),qp(r.y,s.offset.y)),r}const G6=()=>({translate:0,scale:1,origin:0,originPoint:0}),Gp=()=>({x:G6(),y:G6()}),Y6=()=>({min:0,max:0}),ar=()=>({x:Y6(),y:Y6()}),uk={current:null},iV={current:!1};function a_e(){if(iV.current=!0,!!zj)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>uk.current=t.matches;t.addEventListener("change",e),e()}else uk.current=!1}const c_e=new WeakMap;function l_e(t,e,n){for(const r in e){const s=e[r],i=n[r];if(js(s))t.addValue(r,s);else if(js(i))t.addValue(r,Og(s,{owner:t}));else if(i!==s)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(r);t.addValue(r,Og(o!==void 0?o:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const Q6=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class d_e{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=iR,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Ci.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Wn.render(this.render,!1,!0))};const{latestValues:l,renderState:d}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=d,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=c,this.blockInitialAnimation=!!i,this.isControllingVariants=NN(n),this.isVariantNode=VH(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in h){const p=h[f];l[f]!==void 0&&js(p)&&p.set(l[f])}}mount(e){var n;this.current=e,c_e.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,s)=>this.bindToMotionValue(s,r)),iV.current||a_e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:uk.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),fu(this.notifyUpdate),fu(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const r=this.features[n];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=o0.has(e);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Wn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Dg){const n=Dg[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ar()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Q6.length;r++){const s=Q6[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=l_e(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Og(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(Jz(r)||Xz(r))?r=parseFloat(r):!wTe(r)&&pu.test(n)&&(r=OH(e,n)),this.setBaseTarget(e,js(r)?r.get():r)),js(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const o=gR(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);o&&(r=o[e])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!js(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new Kj),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){cR.render(this.render)}}class oV extends d_e{constructor(){super(...arguments),this.KeyframeResolver=oTe}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;js(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function aV(t,{style:e,vars:n},r,s){const i=t.style;let o;for(o in e)i[o]=e[o];s==null||s.applyProjectionStyles(i,r);for(o in n)i.setProperty(o,n[o])}function u_e(t){return window.getComputedStyle(t)}class h_e extends oV{constructor(){super(...arguments),this.type="html",this.renderInstance=aV}readValueFromInstance(e,n){var r;if(o0.has(n))return(r=this.projection)!=null&&r.isProjecting?nk(n):A2e(e,n);{const s=u_e(e),i=(Qj(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return sV(e,n)}build(e,n,r){fR(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return yR(e,n,r)}}const cV=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function f_e(t,e,n,r){aV(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(cV.has(s)?s:wR(s),e.attrs[s])}class p_e extends oV{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ar}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(o0.has(n)){const r=PH(n);return r&&r.default||0}return n=cV.has(n)?n:wR(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return JH(e,n,r)}build(e,n,r){KH(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,s){f_e(e,n,r,s)}mount(e){this.isSVGTag=YH(e.tagName),super.mount(e)}}const m_e=(t,e)=>mR(t)?new p_e(e):new h_e(e,{allowProjection:t!==A.Fragment});function pm(t,e,n){const r=t.getProps();return gR(r,e,n!==void 0?n:r.custom,t)}const hk=t=>Array.isArray(t);function g_e(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Og(n))}function y_e(t){return hk(t)?t[t.length-1]||0:t}function w_e(t,e){const n=pm(t,e);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const o in i){const c=y_e(i[o]);g_e(t,o,c)}}function x_e(t){return!!(js(t)&&t.add)}function fk(t,e){const n=t.getValue("willChange");if(x_e(n))return n.add(e);if(!n&&Dl.WillChange){const r=new Dl.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function lV(t){return t.props[ZH]}const b_e=t=>t!==null;function v_e(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(b_e),i=e&&n!=="loop"&&e%2===1?0:s.length-1;return s[i]}const E_e={type:"spring",stiffness:500,damping:25,restSpeed:10},C_e=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),N_e={type:"keyframes",duration:.8},A_e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},S_e=(t,{keyframes:e})=>e.length>2?N_e:o0.has(t)?t.startsWith("scale")?C_e(e[1]):E_e:A_e;function T_e({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:c,from:l,elapsed:d,...u}){return!!Object.keys(u).length}const xR=(t,e,n,r={},s,i)=>o=>{const c=oR(r,t)||{},l=c.delay||r.delay||0;let{elapsed:d=0}=r;d=d-vc(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-d,onUpdate:f=>{e.set(f),c.onUpdate&&c.onUpdate(f)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:e,element:i?void 0:s};T_e(c)||Object.assign(u,S_e(t,u)),u.duration&&(u.duration=vc(u.duration)),u.repeatDelay&&(u.repeatDelay=vc(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(ak(u),u.delay===0&&(h=!0)),(Dl.instantAnimations||Dl.skipAnimations)&&(h=!0,ak(u),u.delay=0),u.allowFlatten=!c.type&&!c.ease,h&&!i&&e.get()!==void 0){const f=v_e(u.keyframes,c);if(f!==void 0){Wn.update(()=>{u.onUpdate(f),u.onComplete()});return}}return c.isSync?new sR(u):new G2e(u)};function __e({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function dV(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...c}=e;r&&(i=r);const l=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const u in c){const h=t.getValue(u,t.latestValues[u]??null),f=c[u];if(f===void 0||d&&__e(d,u))continue;const p={delay:n,...oR(i||{},u)},m=h.get();if(m!==void 0&&!h.isAnimating&&!Array.isArray(f)&&f===m&&!p.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const x=lV(t);if(x){const w=window.MotionHandoffAnimation(x,u,Wn);w!==null&&(p.startTime=w,g=!0)}}fk(t,u),h.start(xR(u,h,f,t.shouldReduceMotion&&IH.has(u)?{type:!1}:p,t,g));const y=h.animation;y&&l.push(y)}return o&&Promise.all(l).then(()=>{Wn.update(()=>{o&&w_e(t,o)})}),l}function uV(t,e,n,r=0,s=1){const i=Array.from(t).sort((d,u)=>d.sortNodePosition(u)).indexOf(e),o=t.size,c=(o-1)*r;return typeof n=="function"?n(i,o):s===1?i*r:c-i*r}function pk(t,e,n={}){var l;const r=pm(t,e,n.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(dV(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=s;return k_e(t,e,d,u,h,f,n)}:()=>Promise.resolve(),{when:c}=s;if(c){const[d,u]=c==="beforeChildren"?[i,o]:[o,i];return d().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function k_e(t,e,n=0,r=0,s=0,i=1,o){const c=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),c.push(pk(l,e,{...o,delay:n+(typeof r=="function"?0:r)+uV(t.variantChildren,l,r,s,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(c)}function I_e(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>pk(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=pk(t,e,n);else{const s=typeof e=="function"?pm(t,e,n.custom):e;r=Promise.all(dV(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function hV(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const j_e=hR.length;function fV(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?fV(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<j_e;n++){const r=hR[n],s=t.props[r];(Ex(s)||s===!1)&&(e[r]=s)}return e}const R_e=[...uR].reverse(),P_e=uR.length;function O_e(t){return e=>Promise.all(e.map(({animation:n,options:r})=>I_e(t,n,r)))}function D_e(t){let e=O_e(t),n=J6(),r=!0;const s=l=>(d,u)=>{var f;const h=pm(t,u,l==="exit"?(f=t.presenceContext)==null?void 0:f.custom:void 0);if(h){const{transition:p,transitionEnd:m,...g}=h;d={...d,...g,...m}}return d};function i(l){e=l(t)}function o(l){const{props:d}=t,u=fV(t.parent)||{},h=[],f=new Set;let p={},m=1/0;for(let y=0;y<P_e;y++){const x=R_e[y],w=n[x],b=d[x]!==void 0?d[x]:u[x],v=Ex(b),E=x===l?w.isActive:null;E===!1&&(m=y);let k=b===u[x]&&b!==d[x]&&v;if(k&&r&&t.manuallyAnimateOnMount&&(k=!1),w.protectedKeys={...p},!w.isActive&&E===null||!b&&!w.prevProp||CN(b)||typeof b=="boolean")continue;const C=U_e(w.prevProp,b);let S=C||x===l&&w.isActive&&!k&&v||y>m&&v,N=!1;const I=Array.isArray(b)?b:[b];let F=I.reduce(s(x),{});E===!1&&(F={});const{prevResolvedValues:P={}}=w,H={...P,...F},z=L=>{S=!0,f.has(L)&&(N=!0,f.delete(L)),w.needsAnimating[L]=!0;const O=t.getValue(L);O&&(O.liveStyle=!1)};for(const L in H){const O=F[L],M=P[L];if(p.hasOwnProperty(L))continue;let B=!1;hk(O)&&hk(M)?B=!hV(O,M):B=O!==M,B?O!=null?z(L):f.add(L):O!==void 0&&f.has(L)?z(L):w.protectedKeys[L]=!0}w.prevProp=b,w.prevResolvedValues=F,w.isActive&&(p={...p,...F}),r&&t.blockInitialAnimation&&(S=!1);const T=k&&C;S&&(!T||N)&&h.push(...I.map(L=>{const O={type:x};if(typeof L=="string"&&r&&!T&&t.manuallyAnimateOnMount&&t.parent){const{parent:M}=t,B=pm(M,L);if(M.enteringChildren&&B){const{delayChildren:W}=B.transition||{};O.delay=uV(M.enteringChildren,t,W)}}return{animation:L,options:O}}))}if(f.size){const y={};if(typeof d.initial!="boolean"){const x=pm(t,Array.isArray(d.initial)?d.initial[0]:d.initial);x&&x.transition&&(y.transition=x.transition)}f.forEach(x=>{const w=t.getBaseTarget(x),b=t.getValue(x);b&&(b.liveStyle=!0),y[x]=w??null}),h.push({animation:y})}let g=!!h.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(g=!1),r=!1,g?e(h):Promise.resolve()}function c(l,d){var h;if(n[l].isActive===d)return Promise.resolve();(h=t.variantChildren)==null||h.forEach(f=>{var p;return(p=f.animationState)==null?void 0:p.setActive(l,d)}),n[l].isActive=d;const u=o(l);for(const f in n)n[f].protectedKeys={};return u}return{animateChanges:o,setActive:c,setAnimateFunction:i,getState:()=>n,reset:()=>{n=J6(),r=!0}}}function U_e(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!hV(e,t):!1}function Lu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function J6(){return{animate:Lu(!0),whileInView:Lu(),whileHover:Lu(),whileTap:Lu(),whileDrag:Lu(),whileFocus:Lu(),exit:Lu()}}class Au{constructor(e){this.isMounted=!1,this.node=e}update(){}}class M_e extends Au{constructor(e){super(e),e.animationState||(e.animationState=D_e(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();CN(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let L_e=0;class B_e extends Au{constructor(){super(...arguments),this.id=L_e++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const $_e={animation:{Feature:M_e},exit:{Feature:B_e}};function Nx(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function mb(t){return{point:{x:t.pageX,y:t.pageY}}}const F_e=t=>e=>lR(e)&&t(e,mb(e));function By(t,e,n,r){return Nx(t,e,F_e(n),r)}const pV=1e-4,z_e=1-pV,H_e=1+pV,mV=.01,V_e=0-mV,W_e=0+mV;function qs(t){return t.max-t.min}function q_e(t,e,n){return Math.abs(t-e)<=n}function Z6(t,e,n,r=.5){t.origin=r,t.originPoint=Yn(e.min,e.max,t.origin),t.scale=qs(n)/qs(e),t.translate=Yn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=z_e&&t.scale<=H_e||isNaN(t.scale))&&(t.scale=1),(t.translate>=V_e&&t.translate<=W_e||isNaN(t.translate))&&(t.translate=0)}function $y(t,e,n,r){Z6(t.x,e.x,n.x,r?r.originX:void 0),Z6(t.y,e.y,n.y,r?r.originY:void 0)}function X6(t,e,n){t.min=n.min+e.min,t.max=t.min+qs(e)}function K_e(t,e,n){X6(t.x,e.x,n.x),X6(t.y,e.y,n.y)}function eU(t,e,n){t.min=e.min-n.min,t.max=t.min+qs(e)}function Fy(t,e,n){eU(t.x,e.x,n.x),eU(t.y,e.y,n.y)}function po(t){return[t("x"),t("y")]}const gV=({current:t})=>t?t.ownerDocument.defaultView:null,tU=(t,e)=>Math.abs(t-e);function G_e(t,e){const n=tU(t.x,e.x),r=tU(t.y,e.y);return Math.sqrt(n**2+r**2)}class yV{constructor(e,n,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=FS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,m=G_e(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!m)return;const{point:g}=f,{timestamp:y}=ts;this.history.push({...g,timestamp:y});const{onStart:x,onMove:w}=this.handlers;p||(x&&x(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,f)},this.handlePointerMove=(f,p)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=$S(p,this.transformPagePoint),Wn.update(this.updatePoint,!0)},this.handlePointerUp=(f,p)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=FS(f.type==="pointercancel"?this.lastMoveEventInfo:$S(p,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,x),g&&g(f,x)},!lR(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=s||window;const c=mb(e),l=$S(c,this.transformPagePoint),{point:d}=l,{timestamp:u}=ts;this.history=[{...d,timestamp:u}];const{onSessionStart:h}=n;h&&h(e,FS(l,this.history)),this.removeListeners=hb(By(this.contextWindow,"pointermove",this.handlePointerMove),By(this.contextWindow,"pointerup",this.handlePointerUp),By(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),fu(this.updatePoint)}}function $S(t,e){return e?{point:e(t.point)}:t}function nU(t,e){return{x:t.x-e.x,y:t.y-e.y}}function FS({point:t},e){return{point:t,delta:nU(t,wV(e)),offset:nU(t,Y_e(e)),velocity:Q_e(e,.1)}}function Y_e(t){return t[0]}function wV(t){return t[t.length-1]}function Q_e(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=wV(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>vc(e)));)n--;if(!r)return{x:0,y:0};const i=Ec(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function J_e(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Yn(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Yn(n,t,r.max):Math.min(t,n)),t}function rU(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Z_e(t,{top:e,left:n,bottom:r,right:s}){return{x:rU(t.x,n,s),y:rU(t.y,e,r)}}function sU(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function X_e(t,e){return{x:sU(t.x,e.x),y:sU(t.y,e.y)}}function eke(t,e){let n=.5;const r=qs(t),s=qs(e);return s>r?n=xx(e.min,e.max-r,t.min):r>s&&(n=xx(t.min,t.max-s,e.min)),Ol(0,1,n)}function tke(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const mk=.35;function nke(t=mk){return t===!1?t=0:t===!0&&(t=mk),{x:iU(t,"left","right"),y:iU(t,"top","bottom")}}function iU(t,e,n){return{min:oU(t,e),max:oU(t,n)}}function oU(t,e){return typeof t=="number"?t:t[e]||0}const rke=new WeakMap;class ske{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ar(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(mb(h).point)},o=(h,f)=>{const{drag:p,dragPropagation:m,onDragStart:g}=this.getProps();if(p&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=dTe(p),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),po(x=>{let w=this.getAxisMotionValue(x).get()||0;if(Cc.test(w)){const{projection:b}=this.visualElement;if(b&&b.layout){const v=b.layout.layoutBox[x];v&&(w=qs(v)*(parseFloat(w)/100))}}this.originPoint[x]=w}),g&&Wn.postRender(()=>g(h,f)),fk(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},c=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f;const{dragPropagation:p,dragDirectionLock:m,onDirectionLock:g,onDrag:y}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:x}=f;if(m&&this.currentDirection===null){this.currentDirection=ike(x),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,x),this.updateAxis("y",f.point,x),this.visualElement.render(),y&&y(h,f)},l=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f,this.stop(h,f),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>po(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)==null?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new yV(e,{onSessionStart:i,onStart:o,onMove:c,onSessionEnd:l,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:gV(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,s=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!r)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&Wn.postRender(()=>c(r,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!kv(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=J_e(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;e&&Wp(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=Z_e(r.layoutBox,e):this.constraints=!1,this.elastic=nke(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&po(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=tke(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Wp(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=o_e(r,s.root,this.visualElement.getTransformPagePoint());let o=X_e(s.layout.layoutBox,i);if(n){const c=n(r_e(o));this.hasMutatedConstraints=!!c,c&&(o=tV(c))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),l=this.constraints||{},d=po(u=>{if(!kv(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const f=s?200:1e6,p=s?40:1e7,m={type:"inertia",velocity:r?e[u]:0,bounceStiffness:f,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,m)});return Promise.all(d).then(c)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return fk(this.visualElement,e),r.start(xR(e,r,0,n,this.visualElement,!1))}stopAnimation(){po(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){po(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){po(n=>{const{drag:r}=this.getProps();if(!kv(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:c}=s.layout.layoutBox[n];i.set(e[n]-Yn(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Wp(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};po(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const l=c.get();s[o]=eke({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),po(o=>{if(!kv(o,e,null))return;const c=this.getAxisMotionValue(o),{min:l,max:d}=this.constraints[o];c.set(Yn(l,d,s[o]))})}addListeners(){if(!this.visualElement.current)return;rke.set(this.visualElement,this);const e=this.visualElement.current,n=By(e,"pointerdown",l=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Wp(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Wn.read(r);const o=Nx(window,"resize",()=>this.scalePositionWithinConstraints()),c=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:d})=>{this.isDragging&&d&&(po(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=mk,dragMomentum:c=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:c}}}function kv(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function ike(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class oke extends Au{constructor(e){super(e),this.removeGroupControls=Oo,this.removeListeners=Oo,this.controls=new ske(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Oo}unmount(){this.removeGroupControls(),this.removeListeners()}}const aU=t=>(e,n)=>{t&&Wn.postRender(()=>t(e,n))};class ake extends Au{constructor(){super(...arguments),this.removePointerDownListener=Oo}onPointerDown(e){this.session=new yV(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:gV(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:aU(e),onStart:aU(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&Wn.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=By(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const C1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function cU(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const K0={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(bt.test(t))t=parseFloat(t);else return t;const n=cU(t,e.target.x),r=cU(t,e.target.y);return`${n}% ${r}%`}},cke={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=pu.parse(t);if(s.length>5)return r;const i=pu.createTransformer(t),o=typeof s[0]!="number"?1:0,c=n.x.scale*e.x,l=n.y.scale*e.y;s[0+o]/=c,s[1+o]/=l;const d=Yn(c,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=d),typeof s[3+o]=="number"&&(s[3+o]/=d),i(s)}};let zS=!1;class lke extends A.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;jTe(dke),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),zS&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),C1.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:o}=r;return o&&(o.isPresent=i,zS=!0,s||e.layoutDependency!==n||n===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Wn.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),cR.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;zS=!0,s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function xV(t){const[e,n]=FH(),r=A.useContext($j);return a.jsx(lke,{...t,layoutGroup:r,switchLayoutGroup:A.useContext(XH),isPresent:e,safeToRemove:n})}const dke={borderRadius:{...K0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:K0,borderTopRightRadius:K0,borderBottomLeftRadius:K0,borderBottomRightRadius:K0,boxShadow:cke};function uke(t,e,n){const r=js(t)?t:Og(t);return r.start(xR("",r,e,n)),r.animation}const hke=(t,e)=>t.depth-e.depth;class fke{constructor(){this.children=[],this.isDirty=!1}add(e){Hj(this.children,e),this.isDirty=!0}remove(e){Vj(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(hke),this.isDirty=!1,this.children.forEach(e)}}function pke(t,e){const n=Ci.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(fu(r),t(i-e))};return Wn.setup(r,!0),()=>fu(r)}const bV=["TopLeft","TopRight","BottomLeft","BottomRight"],mke=bV.length,lU=t=>typeof t=="string"?parseFloat(t):t,dU=t=>typeof t=="number"||bt.test(t);function gke(t,e,n,r,s,i){s?(t.opacity=Yn(0,n.opacity??1,yke(r)),t.opacityExit=Yn(e.opacity??1,0,wke(r))):i&&(t.opacity=Yn(e.opacity??1,n.opacity??1,r));for(let o=0;o<mke;o++){const c=`border${bV[o]}Radius`;let l=uU(e,c),d=uU(n,c);if(l===void 0&&d===void 0)continue;l||(l=0),d||(d=0),l===0||d===0||dU(l)===dU(d)?(t[c]=Math.max(Yn(lU(l),lU(d),r),0),(Cc.test(d)||Cc.test(l))&&(t[c]+="%")):t[c]=d}(e.rotate||n.rotate)&&(t.rotate=Yn(e.rotate||0,n.rotate||0,r))}function uU(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const yke=vV(0,.5,aH),wke=vV(.5,.95,Oo);function vV(t,e,n){return r=>r<t?0:r>e?1:n(xx(t,e,r))}function hU(t,e){t.min=e.min,t.max=e.max}function uo(t,e){hU(t.x,e.x),hU(t.y,e.y)}function fU(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function pU(t,e,n,r,s){return t-=e,t=ZE(t,1/n,r),s!==void 0&&(t=ZE(t,1/s,r)),t}function xke(t,e=0,n=1,r=.5,s,i=t,o=t){if(Cc.test(e)&&(e=parseFloat(e),e=Yn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=Yn(i.min,i.max,r);t===i&&(c-=e),t.min=pU(t.min,e,n,c,s),t.max=pU(t.max,e,n,c,s)}function mU(t,e,[n,r,s],i,o){xke(t,e[n],e[r],e[s],e.scale,i,o)}const bke=["x","scaleX","originX"],vke=["y","scaleY","originY"];function gU(t,e,n,r){mU(t.x,e,bke,n?n.x:void 0,r?r.x:void 0),mU(t.y,e,vke,n?n.y:void 0,r?r.y:void 0)}function yU(t){return t.translate===0&&t.scale===1}function EV(t){return yU(t.x)&&yU(t.y)}function wU(t,e){return t.min===e.min&&t.max===e.max}function Eke(t,e){return wU(t.x,e.x)&&wU(t.y,e.y)}function xU(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function CV(t,e){return xU(t.x,e.x)&&xU(t.y,e.y)}function bU(t){return qs(t.x)/qs(t.y)}function vU(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Cke{constructor(){this.members=[]}add(e){Hj(this.members,e),e.scheduleRender()}remove(e){if(Vj(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Nke(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((s||i||o)&&(r=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:d,rotate:u,rotateX:h,rotateY:f,skewX:p,skewY:m}=n;d&&(r=`perspective(${d}px) ${r}`),u&&(r+=`rotate(${u}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),p&&(r+=`skewX(${p}deg) `),m&&(r+=`skewY(${m}deg) `)}const c=t.x.scale*e.x,l=t.y.scale*e.y;return(c!==1||l!==1)&&(r+=`scale(${c}, ${l})`),r||"none"}const HS=["","X","Y","Z"],Ake=1e3;let Ske=0;function VS(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function NV(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=lV(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Wn,!(s||i))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&NV(r)}function AV({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},c=e==null?void 0:e()){this.id=Ske++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(kke),this.nodes.forEach(Pke),this.nodes.forEach(Oke),this.nodes.forEach(Ike)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new fke)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Kj),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const l=this.eventHandlers.get(o);l&&l.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=$H(o)&&!gTe(o),this.instance=o;const{layoutId:c,layout:l,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||c)&&(this.isLayoutDirty=!0),t){let u,h=0;const f=()=>this.root.updateBlockedByResize=!1;Wn.read(()=>{h=window.innerWidth}),t(o,()=>{const p=window.innerWidth;p!==h&&(h=p,this.root.updateBlockedByResize=!0,u&&u(),u=pke(f,250),C1.hasAnimatedSinceResize&&(C1.hasAnimatedSinceResize=!1,this.nodes.forEach(NU)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||d.getDefaultTransition()||Bke,{onLayoutAnimationStart:g,onLayoutAnimationComplete:y}=d.getProps(),x=!this.targetLayout||!CV(this.targetLayout,p),w=!h&&f;if(this.options.layoutRoot||this.resumeFrom||w||h&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const b={...oR(m,"layout"),onPlay:g,onComplete:y};(d.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(u,w)}else h||NU(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),fu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Dke),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&NV(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:c,layout:l}=this.options;if(c===void 0&&!l)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(EU);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(CU);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Rke),this.nodes.forEach(Tke),this.nodes.forEach(_ke)):this.nodes.forEach(CU),this.clearAllSnapshots();const c=Ci.now();ts.delta=Ol(0,1e3/60,c-ts.timestamp),ts.timestamp=c,ts.isProcessing=!0,RS.update.process(ts),RS.preRender.process(ts),RS.render.process(ts),ts.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,cR.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(jke),this.sharedNodes.forEach(Uke)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Wn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Wn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!qs(this.snapshot.measuredBox.x)&&!qs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ar(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!EV(this.projectionDelta),l=this.getTransformTemplate(),d=l?l(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;o&&this.instance&&(c||Wu(this.latestValues)||u)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let l=this.removeElementScroll(c);return o&&(l=this.removeTransform(l)),$ke(l),{animationId:this.root.animationId,measuredBox:c,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:o}=this.options;if(!o)return ar();const c=o.measureViewportBox();if(!(((d=this.scroll)==null?void 0:d.wasRoot)||this.path.some(Fke))){const{scroll:u}=this.root;u&&(qp(c.x,u.offset.x),qp(c.y,u.offset.y))}return c}removeElementScroll(o){var l;const c=ar();if(uo(c,o),(l=this.scroll)!=null&&l.wasRoot)return c;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&uo(c,o),qp(c.x,h.offset.x),qp(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const l=ar();uo(l,o);for(let d=0;d<this.path.length;d++){const u=this.path[d];!c&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Kp(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Wu(u.latestValues)&&Kp(l,u.latestValues)}return Wu(this.latestValues)&&Kp(l,this.latestValues),l}removeTransform(o){const c=ar();uo(c,o);for(let l=0;l<this.path.length;l++){const d=this.path[l];if(!d.instance||!Wu(d.latestValues))continue;lk(d.latestValues)&&d.updateSnapshot();const u=ar(),h=d.measurePageBox();uo(u,h),gU(c,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Wu(this.latestValues)&&gU(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ts.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var f;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==c;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!(!this.layout||!(u||h))){if(this.resolvedRelativeTargetAt=ts.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ar(),this.relativeTargetOrigin=ar(),Fy(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),uo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ar(),this.targetWithTransforms=ar()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),K_e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):uo(this.target,this.layout.layoutBox),rV(this.target,this.targetDelta)):uo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ar(),this.relativeTargetOrigin=ar(),Fy(this.relativeTargetOrigin,this.target,p.target),uo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||lk(this.parent.latestValues)||nV(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var m;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty)&&(l=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ts.timestamp&&(l=!1),l)return;const{layout:d,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||u))return;uo(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;i_e(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=ar());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(fU(this.prevProjectionDelta.x,this.projectionDelta.x),fU(this.prevProjectionDelta.y,this.projectionDelta.y)),$y(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!vU(this.projectionDelta.x,this.prevProjectionDelta.x)||!vU(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Gp(),this.projectionDelta=Gp(),this.projectionDeltaWithTransform=Gp()}setAnimationOrigin(o,c=!1){const l=this.snapshot,d=l?l.latestValues:{},u={...this.latestValues},h=Gp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const f=ar(),p=l?l.source:void 0,m=this.layout?this.layout.source:void 0,g=p!==m,y=this.getStack(),x=!y||y.members.length<=1,w=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(Lke));this.animationProgress=0;let b;this.mixTargetDelta=v=>{const E=v/1e3;AU(h.x,o.x,E),AU(h.y,o.y,E),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Fy(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Mke(this.relativeTarget,this.relativeTargetOrigin,f,E),b&&Eke(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=ar()),uo(b,this.relativeTarget)),g&&(this.animationValues=u,gke(u,d,this.latestValues,E,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var c,l,d;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(d=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||d.stop(),this.pendingAnimation&&(fu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Wn.update(()=>{C1.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Og(0)),this.currentAnimation=uke(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Ake),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:l,layout:d,latestValues:u}=o;if(!(!c||!l||!d)){if(this!==o&&this.layout&&d&&SV(this.options.animationType,this.layout.layoutBox,d.layoutBox)){l=this.target||ar();const h=qs(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const f=qs(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+f}uo(c,l),Kp(c,u),$y(this.projectionDeltaWithTransform,this.layoutCorrected,c,u)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Cke),this.sharedNodes.get(o).add(c);const d=c.options.initialPromotionConfig;c.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:l}={}){const d=this.getStack();d&&d.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(c=!0),!c)return;const d={};l.z&&VS("z",o,d,this.animationValues);for(let u=0;u<HS.length;u++)VS(`rotate${HS[u]}`,o,d,this.animationValues),VS(`skew${HS[u]}`,o,d,this.animationValues);o.render();for(const u in d)o.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=E1(c==null?void 0:c.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=E1(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!Wu(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=d.animationValues||d.latestValues;this.applyTransformsToTarget();let h=Nke(this.projectionDeltaWithTransform,this.treeScale,u);l&&(h=l(u,h)),o.transform=h;const{x:f,y:p}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,d.animationValues?o.opacity=d===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=d===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in Cx){if(u[m]===void 0)continue;const{correct:g,applyTo:y,isCSSVariable:x}=Cx[m],w=h==="none"?u[m]:g(u[m],d);if(y){const b=y.length;for(let v=0;v<b;v++)o[y[v]]=w}else x?this.options.visualElement.renderState.vars[m]=w:o[m]=w}this.options.layoutId&&(o.pointerEvents=d===this?E1(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(EU),this.root.sharedNodes.clear()}}}function Tke(t){t.updateLayout()}function _ke(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=e.source!==t.layout.source;i==="size"?po(h=>{const f=o?e.measuredBox[h]:e.layoutBox[h],p=qs(f);f.min=r[h].min,f.max=f.min+p}):SV(i,e.layoutBox,r)&&po(h=>{const f=o?e.measuredBox[h]:e.layoutBox[h],p=qs(r[h]);f.max=f.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+p)});const c=Gp();$y(c,r,e.layoutBox);const l=Gp();o?$y(l,t.applyTransform(s,!0),e.measuredBox):$y(l,r,e.layoutBox);const d=!EV(c);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:p}=h;if(f&&p){const m=ar();Fy(m,e.layoutBox,f.layoutBox);const g=ar();Fy(g,r,p.layoutBox),CV(m,g)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=m,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:c,hasLayoutChanged:d,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function kke(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Ike(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function jke(t){t.clearSnapshot()}function EU(t){t.clearMeasurements()}function CU(t){t.isLayoutDirty=!1}function Rke(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function NU(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Pke(t){t.resolveTargetDelta()}function Oke(t){t.calcProjection()}function Dke(t){t.resetSkewAndRotation()}function Uke(t){t.removeLeadSnapshot()}function AU(t,e,n){t.translate=Yn(e.translate,0,n),t.scale=Yn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function SU(t,e,n,r){t.min=Yn(e.min,n.min,r),t.max=Yn(e.max,n.max,r)}function Mke(t,e,n,r){SU(t.x,e.x,n.x,r),SU(t.y,e.y,n.y,r)}function Lke(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Bke={duration:.45,ease:[.4,0,.1,1]},TU=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),_U=TU("applewebkit/")&&!TU("chrome/")?Math.round:Oo;function kU(t){t.min=_U(t.min),t.max=_U(t.max)}function $ke(t){kU(t.x),kU(t.y)}function SV(t,e,n){return t==="position"||t==="preserve-aspect"&&!q_e(bU(e),bU(n),.2)}function Fke(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const zke=AV({attachResizeListener:(t,e)=>Nx(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),WS={current:void 0},TV=AV({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!WS.current){const t=new zke({});t.mount(window),t.setOptions({layoutScroll:!0}),WS.current=t}return WS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Hke={pan:{Feature:ake},drag:{Feature:oke,ProjectionNode:TV,MeasureLayout:xV}};function IU(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&Wn.postRender(()=>i(e,mb(e)))}class Vke extends Au{mount(){const{current:e}=this.node;e&&(this.unmount=uTe(e,(n,r)=>(IU(this.node,r,"Start"),s=>IU(this.node,s,"End"))))}unmount(){}}class Wke extends Au{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hb(Nx(this.node.current,"focus",()=>this.onFocus()),Nx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function jU(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&Wn.postRender(()=>i(e,mb(e)))}class qke extends Au{mount(){const{current:e}=this.node;e&&(this.unmount=mTe(e,(n,r)=>(jU(this.node,r,"Start"),(s,{success:i})=>jU(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const gk=new WeakMap,qS=new WeakMap,Kke=t=>{const e=gk.get(t.target);e&&e(t)},Gke=t=>{t.forEach(Kke)};function Yke({root:t,...e}){const n=t||document;qS.has(n)||qS.set(n,{});const r=qS.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Gke,{root:t,...e})),r[s]}function Qke(t,e,n){const r=Yke(e);return gk.set(t,n),r.observe(t),()=>{gk.delete(t),r.unobserve(t)}}const Jke={some:0,all:1};class Zke extends Au{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Jke[s]},c=l=>{const{isIntersecting:d}=l;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=d?u:h;f&&f(l)};return Qke(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Xke(e,n))&&this.startObserver()}unmount(){}}function Xke({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const eIe={inView:{Feature:Zke},tap:{Feature:qke},focus:{Feature:Wke},hover:{Feature:Vke}},tIe={layout:{ProjectionNode:TV,MeasureLayout:xV}},nIe={...$_e,...eIe,...Hke,...tIe},X=n_e(nIe,m_e),sh=class sh{constructor(){}static getInstance(){return sh.instance||(sh.instance=new sh),sh.instance}isWebRTCSupported(){try{const e=!!(window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection),n=!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),r=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia),s=!!(window.RTCSessionDescription||window.webkitRTCSessionDescription),i=!!(window.RTCIceCandidate||window.webkitRTCIceCandidate),o=/Chrome/.test(navigator.userAgent)&&/Mobile/.test(navigator.userAgent),c={hasRTCPeerConnection:e,hasMediaDevices:n,hasGetUserMedia:r,hasRTCSessionDescription:s,hasRTCIceCandidate:i,isMobileChrome:o,userAgent:navigator.userAgent,isSecureContext:this.isSecureContext()};return console.log("WebRTC Support Check:",c),o?e&&(n||r):e&&s&&i&&(n||r)}catch(e){return console.error("WebRTC support check failed:",e),!1}}isSecureContext(){const e=location.hostname,n=e==="localhost"||e==="127.0.0.1"||e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.")||e.endsWith(".local")||e==="0.0.0.0"||/^\d+\.\d+\.\d+\.\d+$/.test(e),r=location.protocol==="https:"||n;return console.log(" Security Context Check:",{hostname:e,protocol:location.protocol,isLocalNetwork:n,isSecure:r,userAgent:navigator.userAgent}),r}async checkMicrophonePermission(){try{if("permissions"in navigator){const e=await navigator.permissions.query({name:"microphone"});return{granted:e.state==="granted",denied:e.state==="denied",prompt:e.state==="prompt"}}try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(n=>n.stop()),{granted:!0,denied:!1,prompt:!1}}catch(e){const n=e;return n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone permission was denied"}:n.name==="NotFoundError"?{granted:!1,denied:!0,prompt:!1,error:"No microphone found on this device"}:{granted:!1,denied:!1,prompt:!0,error:n.message}}}catch{return{granted:!1,denied:!1,prompt:!0,error:"Unable to check microphone permission"}}}async requestMicrophonePermission(){try{return this.isWebRTCSupported()?this.isSecureContext()?((await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})).getTracks().forEach(n=>n.stop()),{granted:!0,denied:!1,prompt:!1}):{granted:!1,denied:!0,prompt:!1,error:"Microphone access requires HTTPS. Please use a secure connection."}:{granted:!1,denied:!0,prompt:!1,error:"WebRTC is not supported in this browser. Please use Chrome, Firefox, Safari, or Edge."}}catch(e){const n=e;return console.error("Microphone permission error:",n),n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone permission was denied. Please allow microphone access and try again."}:n.name==="NotFoundError"?{granted:!1,denied:!0,prompt:!1,error:"No microphone found. Please connect a microphone and try again."}:n.name==="NotReadableError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone is already in use by another application."}:n.name==="OverconstrainedError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone does not meet the required constraints."}:n.name==="SecurityError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone access blocked due to security restrictions."}:{granted:!1,denied:!1,prompt:!0,error:`Microphone access failed: ${n.message}`}}}getPermissionErrorMessage(e){return e.error?e.error:e.denied?"Microphone permission is required for voice calls. Please enable microphone access in your browser settings.":e.prompt?"Please allow microphone access when prompted to enable voice calls.":"Unknown permission error occurred."}getPermissionInstructions(){const e=navigator.userAgent.toLowerCase();return e.includes("chrome")?"Chrome: Click the microphone icon in the address bar, or go to Settings > Privacy and Security > Site Settings > Microphone.":e.includes("firefox")?"Firefox: Click the microphone icon in the address bar, or go to Preferences > Privacy & Security > Permissions > Microphone.":e.includes("safari")?"Safari: Go to Preferences > Websites > Microphone, and allow access for this site.":e.includes("edge")?"Edge: Click the microphone icon in the address bar, or go to Settings > Cookies and site permissions > Microphone.":"Please check your browser settings to allow microphone access for this website."}};G(sh,"instance");let yk=sh;const zy=yk.getInstance(),rIe=({isOpen:t,onClose:e})=>{const[n,r]=A.useState(!1),s=window.location.origin,i=async()=>{try{await navigator.clipboard.writeText(s),r(!0),setTimeout(()=>r(!1),2e3)}catch(o){console.error("Failed to copy URL:",o)}};return t?a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 border border-white/20",onClick:o=>o.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx("div",{className:"p-2 bg-yellow-600 rounded-lg",children:a.jsx(Xd,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-white",children:"Local Network Access"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Microphone permission setup"})]})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsx("div",{className:"p-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:a.jsxs("p",{className:"text-yellow-200 text-sm",children:[a.jsx("strong",{children:"Issue:"})," Browsers require special permission for local network IP addresses to access microphone."]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-white font-medium",children:"Solution Options:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"1"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white text-sm font-medium",children:"Use localhost instead"}),a.jsxs("p",{className:"text-gray-400 text-xs",children:["Access via: ",a.jsx("code",{className:"bg-slate-700 px-1 rounded",children:"https://localhost:5000"})," (HTTPS enabled)"]})]})]}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"2"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white text-sm font-medium",children:"Enable microphone for this IP"}),a.jsx("p",{className:"text-gray-400 text-xs",children:"In Chrome: Settings  Privacy  Site Settings  Microphone"})]})]}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white text-sm font-medium",children:"Use Chrome flags (Advanced)"}),a.jsxs("p",{className:"text-gray-400 text-xs",children:["Enable: ",a.jsx("code",{className:"bg-slate-700 px-1 rounded",children:"--unsafely-treat-insecure-origin-as-secure"})]})]})]})]})]}),a.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[a.jsx("p",{className:"text-gray-300 text-sm mb-2",children:"Current URL:"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("code",{className:"flex-1 bg-slate-800 px-2 py-1 rounded text-xs text-gray-300 break-all",children:s}),a.jsx("button",{onClick:i,className:"p-2 bg-slate-600 hover:bg-slate-500 rounded text-white transition-colors",title:"Copy URL",children:n?a.jsx(X1,{className:"w-4 h-4"}):a.jsx(CB,{className:"w-4 h-4"})})]})]})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"Got It"}),a.jsx("button",{onClick:()=>{window.location.href="https://localhost:5000"},className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Try Localhost"})]})]})}):null},_V=({isOpen:t,onClose:e,onPermissionGranted:n,onPermissionDenied:r})=>{const[s,i]=A.useState(!1),[o,c]=A.useState(null),[l,d]=A.useState(!1),u=async()=>{var f;i(!0),c(null);try{console.log(" Requesting microphone permission...");const p=await zy.checkMicrophonePermission();if(console.log(" Current microphone permission status:",p),p.granted){console.log(" Microphone permission already granted"),n();return}if(p.denied){c("Microphone permission was previously denied. Please enable it in your browser settings."),r();return}const m=await zy.requestMicrophonePermission();if(console.log(" Permission request result:",m),m.granted)console.log(" Microphone permission granted"),n();else{const g=window.location.hostname;if((g.startsWith("192.168.")||g.startsWith("10.")||g.startsWith("172."))&&((f=m.error)!=null&&f.includes("permission"))){d(!0);return}c(m.error||"Failed to get microphone permission"),r()}}catch(p){console.error(" Microphone permission error:",p),c(p.message||"Failed to request microphone permission"),r()}finally{i(!1)}},h=()=>{console.log(" User skipped microphone permission"),r()};return t?a.jsxs(Do,{children:[a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 border border-white/20",onClick:f=>f.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:a.jsx(ug,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-white",children:"Microphone Access Required"}),a.jsx("p",{className:"text-sm text-gray-400",children:"For voice calls"})]})]}),a.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:a.jsx(en,{className:"w-5 h-5 text-gray-400"})})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(qt,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Why do we need microphone access?"}),a.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"To enable voice calls between traders, we need access to your microphone. This allows you to communicate directly with other users during P2P transactions."})]})]}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(kt,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-medium",children:"Your privacy is protected"}),a.jsxs("p",{className:"text-gray-300 text-sm mt-1",children:[" Audio is only transmitted during active calls",a.jsx("br",{})," No recording or storage of conversations",a.jsx("br",{})," You can revoke permission anytime in browser settings"]})]})]}),o&&a.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-900/20 border border-red-500/30 rounded-lg",children:[a.jsx(qt,{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-red-400 font-medium",children:"Permission Error"}),a.jsx("p",{className:"text-red-300 text-sm mt-1",children:o})]})]})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:h,className:"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",disabled:s,children:"Listen Only"}),a.jsx("button",{onClick:u,disabled:s,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-600/50 text-white rounded-lg font-medium transition-colors flex items-center justify-center space-x-2",children:s?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Requesting..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(ug,{className:"w-4 h-4"}),a.jsx("span",{children:"Allow Microphone"})]})})]}),a.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg",children:[a.jsxs("p",{className:"text-xs text-gray-400 text-center",children:[" ",a.jsx("strong",{children:"Listen Only:"})," You can join the call without microphone to hear the other person"]}),a.jsxs("p",{className:"text-xs text-gray-400 text-center mt-1",children:[" ",a.jsx("strong",{children:"Full Access:"})," Allow microphone to speak and listen"]}),window.location.hostname!=="localhost"&&!window.location.protocol.includes("https")&&a.jsxs("p",{className:"text-xs text-yellow-400 text-center mt-2",children:[" ",a.jsx("strong",{children:"Local Network:"})," For local network access, you may need to enable microphone permissions in your browser settings for this IP address"]})]})]})}),a.jsx(rIe,{isOpen:l,onClose:()=>d(!1)})]}):null},bR=({isOpen:t,callerAddress:e,callerName:n,ad:r,callId:s,onAccept:i,onReject:o,onClose:c})=>{const[l,d]=A.useState(!1),[u,h]=A.useState(30),[f,p]=A.useState(!1),[m,g]=A.useState(!1);A.useEffect(()=>{if(t&&u>0){const E=setInterval(()=>{h(k=>k<=1?(x(),0):k-1)},1e3);return()=>clearInterval(E)}},[t,u]);const y=async()=>{d(!0);try{console.log(" IncomingCallModal: Accepting call with callId:",s),i()}catch(E){console.error("Failed to accept call:",E);const k=(E==null?void 0:E.message)||"Failed to accept call";if(k.includes("Microphone permission required")){console.log(" Microphone permission required for answering call, showing permission modal"),p(!0),d(!1);return}U.error(k),o()}finally{d(!1)}},x=async()=>{try{const E=localStorage.getItem("authToken");E&&await fetch(`/api/calls/${s}/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}}),o(),U("Call rejected",{icon:""})}catch(E){console.error("Failed to reject call:",E),o()}},w=()=>{console.log(" Microphone permission granted, retrying call acceptance"),p(!1),y()},b=()=>{console.log(" Microphone permission denied, rejecting call"),p(!1),U.error("Microphone permission is required for voice calls"),o()},v=E=>`${E.slice(0,6)}...${E.slice(-4)}`;return a.jsxs(Do,{children:[t&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"modal-container bg-black/95 backdrop-blur-sm flex items-center justify-center p-4 overflow-hidden",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999},children:a.jsxs(X.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-900 to-slate-800 rounded-2xl p-6 sm:p-8 w-full max-w-sm mx-4 border border-white/20 text-center shadow-2xl relative",style:{maxHeight:"90vh",overflowY:"auto"},children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(hg,{size:40,className:"text-white"})}),a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Incoming Call"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-gray-300 font-medium",children:n||v(e)}),a.jsx("p",{className:"text-gray-400 text-sm",children:v(e)}),r&&a.jsxs("p",{className:"text-blue-400 text-sm",children:["About: ",r.type," ",r.token," Ad"]})]})]}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full animate-pulse"}),a.jsxs("span",{className:"text-red-400 text-sm font-medium",children:[u,"s remaining"]})]})}),m?a.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-4",children:[a.jsx("div",{className:"animate-pulse",children:a.jsx("div",{className:"w-20 h-20 sm:w-16 sm:h-16 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center",children:a.jsx(dn,{size:40,className:"text-green-400 sm:w-8 sm:h-8"})})}),a.jsx("p",{className:"text-green-400 text-base font-medium",children:"Connecting..."}),a.jsx("p",{className:"text-gray-400 text-xs text-center max-w-xs",children:"Please wait while we establish the connection"})]}):a.jsxs("div",{className:"flex items-center justify-center space-x-8 sm:space-x-6",children:[a.jsx(X.button,{onClick:x,disabled:l,className:"p-5 sm:p-4 rounded-full bg-red-500 text-white shadow-lg disabled:opacity-50 min-w-[64px] min-h-[64px] sm:min-w-[56px] sm:min-h-[56px] flex items-center justify-center",whileTap:{scale:.95},whileHover:{scale:1.05},title:"Reject call",style:{touchAction:"manipulation"},children:a.jsx(Vx,{size:28,className:"sm:w-6 sm:h-6"})}),a.jsx(X.button,{onClick:y,disabled:l,className:"p-5 sm:p-4 rounded-full bg-green-500 text-white shadow-lg disabled:opacity-50 relative min-w-[64px] min-h-[64px] sm:min-w-[56px] sm:min-h-[56px] flex items-center justify-center",whileTap:{scale:.95},whileHover:{scale:1.05},title:"Accept call",style:{touchAction:"manipulation"},children:l?a.jsx("div",{className:"animate-spin rounded-full h-7 w-7 sm:h-6 sm:w-6 border-2 border-white border-t-transparent"}):a.jsx(dn,{size:28,className:"sm:w-6 sm:h-6"})})]}),r&&a.jsxs("div",{className:"mt-6 p-4 bg-white/10 rounded-lg border border-white/20",children:[a.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Ad Details"}),a.jsxs("div",{className:"space-y-1 text-xs text-gray-300",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Type:"}),a.jsx("span",{className:r.type==="BUY"?"text-green-400":"text-red-400",children:r.type})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Token:"}),a.jsx("span",{className:"text-blue-400",children:r.token})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Price:"}),a.jsxs("span",{className:"text-yellow-400",children:["",r.priceInr]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Range:"}),a.jsxs("span",{className:"text-gray-300",children:[r.minAmount," - ",r.maxAmount," ",r.token]})]})]})]}),a.jsx("div",{className:"absolute inset-0 rounded-2xl border-2 border-blue-500/30 animate-ping pointer-events-none"})]})},"incoming-call-modal"),a.jsx(_V,{isOpen:f,onClose:()=>p(!1),onPermissionGranted:w,onPermissionDenied:b},"microphone-permission-modal")]})},ih=class ih{constructor(){G(this,"incomingCallAudio",null);G(this,"outgoingCallAudio",null);G(this,"callConnectedAudio",null);G(this,"callEndedAudio",null);G(this,"isPlaying",{});G(this,"audioContext",null);G(this,"activeOscillators",[]);this.initializeAudioElements()}static getInstance(){return ih.instance||(ih.instance=new ih),ih.instance}initializeAudioElements(){try{this.incomingCallAudio=new Audio,this.outgoingCallAudio=new Audio,this.callConnectedAudio=new Audio,this.callEndedAudio=new Audio,this.incomingCallAudio.src="/sounds/ring.mp3",this.outgoingCallAudio.src="/sounds/ring.mp3",this.incomingCallAudio.loop=!0,this.outgoingCallAudio.loop=!0,[this.incomingCallAudio,this.outgoingCallAudio,this.callConnectedAudio,this.callEndedAudio].forEach(e=>{e&&(e.volume=.7,e.preload="auto")}),this.incomingCallAudio.onerror=()=>this.createFallbackAudio("incoming"),this.outgoingCallAudio.onerror=()=>this.createFallbackAudio("outgoing")}catch(e){console.error("Failed to initialize audio elements:",e),this.createFallbackAudio("all")}}createFallbackAudio(e){console.log(`Creating fallback audio for: ${e}`),(e==="incoming"||e==="all")&&(this.incomingCallAudio=this.createBeepAudio(800,.5)),(e==="outgoing"||e==="all")&&(this.outgoingCallAudio=this.createBeepAudio(440,1))}createBeepAudio(e,n){return{play:()=>{try{const s=new(window.AudioContext||window.webkitAudioContext),i=s.createOscillator(),o=s.createGain();i.connect(o),o.connect(s.destination),i.frequency.setValueAtTime(e,s.currentTime),i.type="sine",o.gain.setValueAtTime(.3,s.currentTime),o.gain.exponentialRampToValueAtTime(.01,s.currentTime+n),i.start(s.currentTime),i.stop(s.currentTime+n)}catch{console.log("Web Audio API not available, using silent fallback")}return Promise.resolve()},pause:()=>{},currentTime:0,volume:.7,loop:!1}}async playIncomingCall(){try{this.incomingCallAudio&&(this.isPlaying.incoming=!0,await this.incomingCallAudio.play(),console.log(" Playing incoming call sound"))}catch(e){console.log("Could not play incoming call sound:",e)}}stopIncomingCall(){try{this.incomingCallAudio&&(this.isPlaying.incoming=!1,this.incomingCallAudio.pause(),this.incomingCallAudio.currentTime=0,console.log(" Stopped incoming call sound"))}catch(e){console.log("Could not stop incoming call sound:",e)}}async playOutgoingCall(){try{this.outgoingCallAudio&&(this.isPlaying.outgoing=!0,await this.outgoingCallAudio.play(),console.log(" Playing outgoing call sound"))}catch(e){console.log("Could not play outgoing call sound:",e)}}stopOutgoingCall(){try{this.outgoingCallAudio&&(this.isPlaying.outgoing=!1,this.outgoingCallAudio.pause(),this.outgoingCallAudio.currentTime=0,console.log(" Stopped outgoing call sound"))}catch(e){console.log("Could not stop outgoing call sound:",e)}}async playCallConnected(){try{this.stopAllOscillators(),this.audioContext=new(window.AudioContext||window.webkitAudioContext);const e=this.audioContext.createOscillator(),n=this.audioContext.createGain();e.connect(n),n.connect(this.audioContext.destination),e.frequency.setValueAtTime(600,this.audioContext.currentTime),e.type="sine",n.gain.setValueAtTime(.2,this.audioContext.currentTime),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),this.activeOscillators.push(e),e.start(this.audioContext.currentTime),e.stop(this.audioContext.currentTime+.3),setTimeout(()=>{this.removeOscillator(e)},300),console.log(" Playing call connected sound")}catch(e){console.log("Could not play call connected sound:",e)}}async playCallEnded(){try{this.stopAllOscillators(),this.audioContext=new(window.AudioContext||window.webkitAudioContext);const e=this.audioContext.createOscillator(),n=this.audioContext.createGain();e.connect(n),n.connect(this.audioContext.destination),e.frequency.setValueAtTime(300,this.audioContext.currentTime),e.type="sine",n.gain.setValueAtTime(.2,this.audioContext.currentTime),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.5),this.activeOscillators.push(e),e.start(this.audioContext.currentTime),e.stop(this.audioContext.currentTime+.5),setTimeout(()=>{this.removeOscillator(e)},500),console.log(" Playing call ended sound")}catch(e){console.log("Could not play call ended sound:",e)}}stopAllSounds(){this.stopIncomingCall(),this.stopOutgoingCall(),this.stopAllOscillators(),console.log(" Stopped all call sounds")}stopAllOscillators(){if(this.activeOscillators.forEach(e=>{try{e.stop()}catch{}}),this.activeOscillators=[],this.audioContext){try{this.audioContext.close()}catch{}this.audioContext=null}}removeOscillator(e){const n=this.activeOscillators.indexOf(e);n>-1&&this.activeOscillators.splice(n,1)}setVolume(e){const n=Math.max(0,Math.min(1,e));[this.incomingCallAudio,this.outgoingCallAudio,this.callConnectedAudio,this.callEndedAudio].forEach(r=>{r&&(r.volume=n)})}};G(ih,"instance");let wk=ih;const Ns=wk.getInstance(),sIe={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.ekiga.net"},{urls:"stun:stun.ideasip.com"},{urls:"stun:stun.schlund.de"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.voipbuster.com"},{urls:"stun:stun.voipstunt.com"},{urls:"stun:stun.counterpath.com"},{urls:"stun:stun.1und1.de"},{urls:"stun:stun.gmx.net"},{urls:"stun:stun.callwithus.com"},{urls:"stun:stun.counterpath.net"},{urls:"stun:stun.1und1.de"},{urls:"stun:stun.sipgate.net"},{urls:"stun:stun.voip.aebc.com"}],iceCandidatePoolSize:10},AN=({isOpen:t,ad:e,onClose:n})=>{var ot,Tn,nt,mn;const{user:r}=ss(),{walletAddress:s}=SC(),{address:i}=Xt(),o=(r==null?void 0:r.address)||s||i;console.log(" CallModal: Props received:",{isOpen:t,ad:!!e,user:!!r,effectiveAddress:o});const[c,l]=A.useState("initiating"),[d,u]=A.useState(!1),[h,f]=A.useState(!0),[p,m]=A.useState(0),[g,y]=A.useState(null),[x,w]=A.useState(!1),[b,v]=A.useState("disconnected"),[E,k]=A.useState(!1),[C,S]=A.useState(0),[N,I]=A.useState(!1),[F,P]=A.useState(!1),H=A.useRef(null),z=A.useRef(null),T=A.useRef(null),_=A.useRef(null),L=A.useRef(null),O=A.useRef(null),M=A.useRef(null),B=A.useRef(null),W=A.useRef(null),Z=A.useRef(!1),ie=A.useRef(0),ae=A.useRef(null);A.useEffect(()=>{if(!o){console.log(" CallModal: No effective address available, skipping socket setup");return}return console.log(" CallModal: Setting up socket connection to:",Na),console.log(" CallModal: Using address:",o),L.current=Po(Na,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,timeout:2e4}),L.current.on("connect",()=>{console.log(" CallModal: Connected to signaling server"),L.current.emit("register",o),k(!0),console.log(" CallModal: Registered with address:",o)}),L.current.on("disconnect",()=>{console.log(" CallModal: Disconnected from signaling server"),k(!1)}),L.current.on("answer",async({answer:Ve,from:rt})=>{if(console.log(" CallModal: Received answer from",rt),O.current)try{await O.current.setRemoteDescription(new RTCSessionDescription(Ve)),await _e(),l("active"),v("connected"),oe()}catch(ht){console.error(" CallModal: Failed to set remote description:",ht)}}),L.current.on("ice-candidate",({candidate:Ve,from:rt})=>{console.log("Received ICE candidate from",rt),O.current&&Ve?(O.current.queuedCandidates||(O.current.queuedCandidates=[]),O.current.queuedCandidates.push(new RTCIceCandidate(Ve)),O.current.remoteDescription?(console.log("Processing queued ICE candidates immediately"),_e()):(console.log(" Remote description not set, queuing ICE candidate for later"),ae.current&&clearTimeout(ae.current),ae.current=setTimeout(()=>{O.current&&O.current.queuedCandidates&&(console.log(" Clearing queued ICE candidates due to timeout"),O.current.queuedCandidates=[])},1e4))):console.log(" No peer connection or candidate, ignoring ICE candidate")}),L.current.on("call-ended",({from:Ve})=>{console.log("Call ended by",Ve),q()}),()=>{L.current&&L.current.disconnect(),M.current&&M.current.getTracks().forEach(Ve=>Ve.stop())}},[o]);const oe=()=>{_.current&&clearInterval(_.current),m(0),_.current=setInterval(()=>{m(Ve=>Ve+1)},1e3)},Ne=()=>{_.current&&(clearInterval(_.current),_.current=null),m(0)},de=Ve=>{const rt=Math.floor(Ve/60),ht=Ve%60;return`${rt.toString().padStart(2,"0")}:${ht.toString().padStart(2,"0")}`},_e=async()=>{if(!O.current||!O.current.queuedCandidates)return;console.log("Processing queued ICE candidates:",O.current.queuedCandidates.length);const Ve=[...O.current.queuedCandidates];O.current.queuedCandidates=[];for(const rt of Ve)try{O.current&&O.current.remoteDescription?(await O.current.addIceCandidate(rt),console.log(" Successfully added queued ICE candidate")):(console.log(" Remote description not set, re-queuing ICE candidate"),O.current.queuedCandidates||(O.current.queuedCandidates=[]),O.current.queuedCandidates.push(rt))}catch(ht){console.error(" Failed to add queued ICE candidate:",ht)}},Ue=()=>{O.current&&(console.log("Cleaning up existing peer connection"),O.current.close(),O.current=null),console.log("Creating peer connection");const Ve=new RTCPeerConnection(sIe);return Ve.onicecandidate=rt=>{rt.candidate&&B.current&&(console.log("Sending ICE candidate to",B.current),L.current.emit("ice-candidate",{candidate:rt.candidate,to:B.current}))},Ve.ontrack=rt=>{if(console.log(" Received remote track:",{kind:rt.track.kind,streamCount:rt.streams.length,trackId:rt.track.id,enabled:rt.track.enabled}),rt.streams&&rt.streams[0]&&z.current){const ht=rt.streams[0];console.log(" Setting remote audio stream:",{streamId:ht.id,trackCount:ht.getTracks().length}),z.current.srcObject=ht,z.current.play().then(()=>{console.log(" Remote audio playing successfully")}).catch(pt=>{console.error(" Audio play error:",pt),setTimeout(()=>{z.current&&z.current.srcObject&&z.current.play().catch(jn=>{console.error(" Audio play retry failed:",jn)})},500)})}else console.warn(" Received track but missing stream or audio element")},Ve.onconnectionstatechange=()=>{if(console.log("Connection state:",Ve.connectionState),v(Ve.connectionState),Ve.connectionState==="connected"){const rt=Ve.iceConnectionState;rt==="connected"||rt==="completed"?(l("active"),v("connected"),S(0),oe(),console.log(" Call fully connected - both connection and ICE ready"),U.success("Call connected!")):console.log(" Connection ready but ICE not ready yet:",rt)}else(Ve.connectionState==="disconnected"||Ve.connectionState==="failed")&&(console.log("Connection lost, attempting to reconnect..."),c==="active"&&C<3?(l("ringing"),S(rt=>rt+1),W.current=setTimeout(()=>{B.current&&L.current&&!N&&(console.log("Attempting to reconnect..."),O.current&&O.current.createOffer().then(rt=>{O.current.setLocalDescription(rt),L.current.emit("offer",{offer:rt,to:B.current})}).catch(rt=>{console.error("Failed to create reconnection offer:",rt),q()}))},3e3)):(console.log("Max reconnection attempts reached, ending call"),q()))},Ve.oniceconnectionstatechange=()=>{console.log("ICE connection state:",Ve.iceConnectionState),Ve.iceConnectionState==="connected"||Ve.iceConnectionState==="completed"?(l("active"),v("connected"),oe(),U.success("Voice connection established!")):(Ve.iceConnectionState==="disconnected"||Ve.iceConnectionState==="failed")&&console.log("ICE connection lost, connection may be unstable")},Ve};A.useEffect(()=>(t&&e&&E&&!N&&!F&&(console.log(" CallModal: Starting call to:",e.ownerAddress),setTimeout(()=>{Z.current||ee()},100)),()=>{g&&q()}),[t,e,E]);const ee=async()=>{if(!e||!(r!=null&&r.address)){console.log(" CallModal: Cannot initiate call - missing ad or user address");return}if(N||F||Z.current){console.log(" CallModal: Call already in progress or initializing, skipping initiation");return}const Ve=Date.now();if(Ve-ie.current<2e3){console.log(" CallModal: Call attempt too soon, debouncing...");return}if(ie.current=Ve,!L.current||!E){console.log(" CallModal: Cannot initiate call - socket not connected or not registered"),console.log(" CallModal: Socket ref:",!!L.current,"Registered:",E),setTimeout(()=>{L.current&&E&&!N&&!F&&(console.log(" CallModal: Retrying call initiation"),ee())},500);return}console.log(" CallModal: Initiating call to:",e.ownerAddress);try{Z.current=!0,P(!0),I(!0),l("initiating"),B.current=e.ownerAddress;const rt=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});console.log("Got local stream"),M.current=rt,l("ringing"),O.current=Ue(),rt.getAudioTracks().forEach(pt=>{O.current.addTrack(pt,rt)}),l("ringing");const ht=await O.current.createOffer();await O.current.setLocalDescription(ht),console.log(" CallModal: Sending offer to:",e.ownerAddress),L.current.emit("offer",{offer:ht,to:e.ownerAddress}),l("ringing"),console.log(" CallModal: Call status set to ringing"),T.current=setTimeout(()=>{c==="ringing"&&(l("ended"),U.error("Call not answered"),setTimeout(()=>n(),1e3))},3e4)}catch(rt){console.error("Call initiation error:",rt);const ht=rt instanceof Error?rt.message:"Failed to initiate call";if(ht.includes("Microphone permission required")){console.log(" Microphone permission required, showing permission modal"),w(!0),l("initiating");return}U.error(ht),I(!1),P(!1),Z.current=!1,n()}};A.useEffect(()=>()=>{T.current&&(clearTimeout(T.current),T.current=null),_.current&&(clearInterval(_.current),_.current=null),W.current&&(clearTimeout(W.current),W.current=null),ae.current&&(clearTimeout(ae.current),ae.current=null)},[]);const q=async()=>{try{Ns.stopAllSounds(),Ne(),B.current&&L.current&&L.current.emit("end-call",{to:B.current}),O.current&&(O.current.close(),O.current=null),M.current&&(M.current.getTracks().forEach(Ve=>Ve.stop()),M.current=null)}catch(Ve){console.error("Failed to end call:",Ve)}l("ended"),m(0),y(null),v("disconnected"),I(!1),P(!1),Z.current=!1,B.current=null,n()},ue=()=>{console.log(" Microphone permission granted, retrying call initiation"),w(!1),ee()},Ae=()=>{console.log(" Microphone permission denied, closing call modal"),w(!1),l("ended"),U.error("Microphone permission is required for voice calls"),setTimeout(()=>n(),2e3)},tt=()=>{if(M.current){const Ve=M.current.getAudioTracks()[0];Ve&&(Ve.enabled=!Ve.enabled,u(!Ve.enabled),U(d?"Microphone unmuted":"Microphone muted",{icon:d?"":""}))}},me=()=>{f(!h),z.current&&(z.current.volume=h?0:1),U(h?"Speaker off":"Speaker on",{icon:h?"":""})},je=()=>{switch(c){case"initiating":return"Connecting...";case"ringing":return"Ringing...";case"active":const Ve=de(p);return d&&!navigator.mediaDevices?`${Ve} (Listen Only)`:Ve;case"ended":return"Call ended";default:return""}},pe=()=>{switch(c){case"initiating":return"text-yellow-400";case"ringing":return"text-blue-400";case"active":return"text-green-400";case"ended":return"text-gray-400";default:return"text-white"}};return console.log(" CallModal: Rendering with isOpen:",t,"ad:",!!e),a.jsxs(a.Fragment,{children:[a.jsxs(Do,{children:[t&&e&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 rounded-2xl p-6 w-full max-w-md border border-white/20 text-center shadow-2xl",children:[a.jsx("button",{onClick:n,className:"absolute top-4 right-4 p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:a.jsx(en,{size:20})}),a.jsxs("div",{className:"space-y-6 mb-8",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto shadow-lg",children:a.jsx("span",{className:"text-white font-bold text-2xl",children:((ot=e.agent)==null?void 0:ot.branchName.charAt(0))||"A"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:((Tn=e.agent)==null?void 0:Tn.branchName)||"Agent"}),a.jsx("p",{className:"text-gray-300 text-sm",children:(nt=e.agent)==null?void 0:nt.city}),a.jsx("p",{className:"text-gray-400 text-xs",children:(mn=e.agent)==null?void 0:mn.mobile})]}),a.jsxs("div",{className:"bg-white/10 rounded-xl p-4 border border-white/20",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[a.jsx(Pr,{size:16,className:"text-blue-400"}),a.jsx("span",{className:"text-blue-400 text-sm font-medium",children:"Call Status"})]}),a.jsx("p",{className:`text-lg font-semibold ${pe()}`,children:je()}),b!=="disconnected"&&a.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-2",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${b==="connected"?"bg-green-500":b==="connecting"?"bg-yellow-500":"bg-red-500"}`}),a.jsx("span",{className:"text-xs text-gray-400 capitalize",children:b})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[c==="active"&&a.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[a.jsx(X.button,{onClick:tt,className:`p-4 rounded-full shadow-lg ${d?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-white/10 text-white border border-white/20"}`,whileTap:{scale:.95},whileHover:{scale:1.05},title:d?"Unmute microphone":"Mute microphone",children:d?a.jsx(uw,{size:24}):a.jsx(ug,{size:24})}),a.jsx(X.button,{onClick:me,className:`p-4 rounded-full shadow-lg ${h?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-white/10 text-white border border-white/20"}`,whileTap:{scale:.95},whileHover:{scale:1.05},title:h?"Turn off speaker":"Turn on speaker",children:h?a.jsx(kB,{size:24}):a.jsx(IB,{size:24})})]}),a.jsx(X.button,{onClick:q,className:"p-5 rounded-full bg-red-500 text-white shadow-lg hover:bg-red-600 transition-colors",whileTap:{scale:.95},whileHover:{scale:1.05},title:"End call",children:a.jsx(Vx,{size:28})})]}),(c==="initiating"||c==="ringing")&&a.jsx("div",{className:"mt-6",children:a.jsx("div",{className:"flex justify-center space-x-1",children:[1,2,3].map(Ve=>a.jsx(X.div,{className:"w-2 h-2 bg-blue-400 rounded-full",animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:Ve*.2}},Ve))})})]})}),a.jsx("audio",{ref:H,autoPlay:!0,muted:!0,style:{display:"none"}},"local-audio"),a.jsx("audio",{ref:z,autoPlay:!0,style:{display:"none"}},"remote-audio")]}),a.jsx(_V,{isOpen:x,onClose:()=>w(!1),onPermissionGranted:ue,onPermissionDenied:Ae})]})};var KS={};const iIe=()=>{const t=KS.TURN_SERVER_IP||"YOUR_SERVER_IP",e=KS.TURN_USERNAME||"webrtc",n=KS.TURN_PASSWORD||"password123",r=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.voipbuster.com"}];return t!=="YOUR_SERVER_IP"?[...r,{urls:`turn:${t}:3478`,username:e,credential:n},{urls:`turn:${t}:3478?transport=tcp`,username:e,credential:n},{urls:`turn:${t}:5349?transport=tcp`,username:e,credential:n}]:[...r,{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"}]};class oIe{constructor(){G(this,"peerConnection",null);G(this,"localStream",null);G(this,"remoteStream",null);G(this,"pendingIceCandidates",[]);G(this,"callState",{isConnected:!1,isMuted:!1,isSpeakerOn:!0,callDuration:0,connectionState:"new"});G(this,"callStateCallbacks",[]);G(this,"durationInterval",null);G(this,"networkMonitorInterval",null);G(this,"iceRestartAttempts",0);G(this,"maxIceRestarts",3);G(this,"iceRestartTimeout",null);G(this,"connectionRecoveryAttempts",0);G(this,"maxConnectionRecoveryAttempts",3);G(this,"onIceCandidate",null);G(this,"onOffer",null);G(this,"onAnswer",null);this.setupPeerConnection()}setupPeerConnection(){this.peerConnection&&this.peerConnection.close();const e={iceServers:iIe(),iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(e),this.peerConnection.ontrack=n=>{if(console.log(" Received remote track event:",{kind:n.track.kind,streamCount:n.streams.length,trackId:n.track.id,enabled:n.track.enabled,readyState:n.track.readyState}),n.streams&&n.streams.length>0){const r=n.streams[0];console.log(" Remote stream received:",{id:r.id,active:r.active,trackCount:r.getTracks().length}),r.getTracks().forEach((s,i)=>{console.log(` Remote track ${i}:`,{kind:s.kind,id:s.id,enabled:s.enabled,readyState:s.readyState,muted:s.muted})}),this.remoteStream=r,this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer(),console.log(" Remote stream set successfully and call state updated"),this.onRemoteStream&&this.onRemoteStream(r)}else console.warn(" Received track event without stream")},this.peerConnection.onconnectionstatechange=()=>{var r,s;const n=(r=this.peerConnection)==null?void 0:r.connectionState;if(console.log(" WebRTC Connection state changed:",n),n==="connected"){const i=(s=this.peerConnection)==null?void 0:s.iceConnectionState;i==="connected"||i==="completed"?(console.log(" WebRTC Connection established successfully!"),this.iceRestartAttempts=0,this.connectionRecoveryAttempts=0,this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer(),this.monitorNetworkQuality()):console.log(" Connection state is connected, but ICE not ready yet:",i)}else if(n==="disconnected")console.log(" WebRTC Connection disconnected (temporary - attempting recovery)"),this.connectionRecoveryAttempts>=this.maxConnectionRecoveryAttempts?(this.updateCallState({isConnected:!1,connectionState:"disconnected",callDuration:0}),this.stopCallTimer(),this.stopNetworkMonitor()):this.attemptConnectionRecovery();else if(n==="failed")if(console.log(" WebRTC Connection failed - attempting ICE restart"),this.iceRestartAttempts<this.maxIceRestarts){this.iceRestartTimeout&&clearTimeout(this.iceRestartTimeout);const i=Math.min(1e3*Math.pow(2,this.iceRestartAttempts),5e3);console.log(` Scheduling ICE restart attempt ${this.iceRestartAttempts+1}/${this.maxIceRestarts} after ${i}ms`),this.iceRestartAttempts++,this.iceRestartTimeout=setTimeout(()=>{this.restartIce()},i)}else console.error(" Max ICE restart attempts reached - connection failed"),this.updateCallState({isConnected:!1,connectionState:"failed",callDuration:0}),this.stopCallTimer(),this.stopNetworkMonitor();else n==="connecting"?(console.log(" WebRTC Connection in progress..."),this.updateCallState({connectionState:"connecting"}),setTimeout(()=>{var i;((i=this.peerConnection)==null?void 0:i.connectionState)==="connecting"&&(console.log(" WebRTC connection stuck in connecting state, forcing connection check..."),this.forceConnectionCheck())},5e3)):n==="new"&&(console.log(" WebRTC Connection in new state"),this.updateCallState({connectionState:"new"}))},this.peerConnection.oniceconnectionstatechange=()=>{var r,s;const n=(r=this.peerConnection)==null?void 0:r.iceConnectionState;if(console.log(" ICE Connection state changed:",n),n==="connected"||n==="completed"){console.log(" ICE Connection established!");const i=(s=this.peerConnection)==null?void 0:s.connectionState;i==="connected"||i==="connecting"?(this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer(),console.log(" Call fully connected - both ICE and connection state ready")):console.log(" ICE ready but connection state not ready yet:",i)}else if(n==="disconnected")console.log(" ICE Connection disconnected (temporary - may recover)");else if(n==="failed")if(console.log(" ICE Connection failed - attempting ICE restart"),this.iceRestartAttempts<this.maxIceRestarts){this.iceRestartTimeout&&clearTimeout(this.iceRestartTimeout);const i=Math.min(1e3*Math.pow(2,this.iceRestartAttempts),5e3);console.log(` Scheduling ICE restart attempt ${this.iceRestartAttempts+1}/${this.maxIceRestarts} after ${i}ms`),this.iceRestartAttempts++,this.iceRestartTimeout=setTimeout(()=>{this.restartIce()},i)}else console.error(" Max ICE restart attempts reached - ICE connection failed"),this.updateCallState({isConnected:!1,connectionState:"failed",callDuration:0}),this.stopCallTimer()},this.peerConnection.onicecandidate=n=>{var r;n.candidate?(console.log(" ICE candidate generated:",n.candidate),console.log(" Candidate type:",n.candidate.type),console.log(" Candidate protocol:",n.candidate.protocol),(r=this.onIceCandidate)==null||r.call(this,n.candidate)):console.log(" ICE candidate gathering completed (end-of-candidates indication)")},this.peerConnection.onicegatheringstatechange=()=>{var n;console.log(" ICE gathering state:",(n=this.peerConnection)==null?void 0:n.iceGatheringState)},this.peerConnection.onnegotiationneeded=async()=>{var n,r;console.log(" Negotiation needed - connection parameters changed");try{if(((n=this.peerConnection)==null?void 0:n.signalingState)==="stable"){console.log(" Creating new offer for renegotiation...");const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s),this.onOffer&&s&&(console.log(" Sending renegotiation offer via signaling"),this.onOffer(s))}else console.log(" Negotiation needed but signaling state is:",(r=this.peerConnection)==null?void 0:r.signalingState)}catch(s){console.error(" Error during negotiation:",s)}}}forceConnectionCheck(){if(this.peerConnection){const e=this.peerConnection.connectionState,n=this.peerConnection.iceConnectionState;(e==="failed"||n==="failed")&&(console.log("Connection failed, attempting recovery..."),this.restartIce())}}attemptConnectionRecovery(){if(this.connectionRecoveryAttempts>=this.maxConnectionRecoveryAttempts){console.log(" Max connection recovery attempts reached");return}this.connectionRecoveryAttempts++,console.log(` Attempting connection recovery (${this.connectionRecoveryAttempts}/${this.maxConnectionRecoveryAttempts})...`);const e=Math.min(2e3*Math.pow(2,this.connectionRecoveryAttempts-1),1e4);setTimeout(()=>{if(this.peerConnection){const n=this.peerConnection.connectionState,r=this.peerConnection.iceConnectionState;n==="failed"||r==="failed"?(this.iceRestartAttempts>=this.maxIceRestarts&&(this.iceRestartAttempts=0),this.restartIce()):n==="disconnected"&&r!=="failed"&&this.peerConnection.restartIce&&this.iceRestartAttempts<this.maxIceRestarts&&this.restartIce()}},e)}restartIce(){if(!this.peerConnection){console.warn(" Cannot restart ICE: peer connection not initialized");return}if(!this.peerConnection.restartIce){console.warn(" restartIce() not supported by browser"),this.createOfferWithIceRestart();return}console.log(` Restarting ICE (attempt ${this.iceRestartAttempts}/${this.maxIceRestarts})...`);try{this.peerConnection.restartIce(),console.log(" ICE restart initiated"),this.createOfferWithIceRestart()}catch(e){console.error(" Error restarting ICE:",e),this.createOfferWithIceRestart()}}async createOfferWithIceRestart(){var e;try{if(!this.peerConnection)return;const n=await this.peerConnection.createOffer({iceRestart:!0});await this.peerConnection.setLocalDescription(n),console.log("ICE restart offer created"),(e=this.onOffer)==null||e.call(this,n)}catch(n){console.error("Error creating ICE restart offer:",n)}}monitorNetworkQuality(){this.stopNetworkMonitor(),this.peerConnection&&(this.networkMonitorInterval=setInterval(async()=>{if(!this.peerConnection){this.stopNetworkMonitor();return}try{const e=await this.peerConnection.getStats();let n=0,r=0,s=0,i=0;if(e.forEach(o=>{o.type==="candidate-pair"&&o.state==="succeeded"?o.currentRoundTripTime&&(n+=o.currentRoundTripTime,r++,console.log("Current RTT:",o.currentRoundTripTime)):o.type==="inbound-rtp"&&o.mediaType==="audio"&&(s=o.packetsLost||0,i=o.packetsReceived||0)}),r>0){const o=n/r,c=i>0?s/(s+i)*100:0;let l="good";o>.5||c>5?l="poor":(o>.3||c>2)&&(l="fair"),this.updateCallState({networkQuality:l}),o>1&&console.warn("High latency detected:",o,"seconds")}}catch(e){console.error("Error monitoring network quality:",e)}},3e3))}stopNetworkMonitor(){this.networkMonitorInterval&&(clearInterval(this.networkMonitorInterval),this.networkMonitorInterval=null)}async initiateCall(){var e,n;try{if(this.updateCallState({connectionState:"connecting"}),this.peerConnection||(console.log("Recreating peer connection for new call"),this.setupPeerConnection()),!zy.isWebRTCSupported()){console.error("WebRTC Support Check Failed:",{RTCPeerConnection:!!window.RTCPeerConnection,webkitRTCPeerConnection:!!window.webkitRTCPeerConnection,mozRTCPeerConnection:!!window.mozRTCPeerConnection,mediaDevices:!!navigator.mediaDevices,getUserMedia:!!((e=navigator.mediaDevices)!=null&&e.getUserMedia),navigatorGetUserMedia:!!navigator.getUserMedia,userAgent:navigator.userAgent});try{new RTCPeerConnection().close(),console.log("WebRTC is actually supported, proceeding with call...")}catch(s){throw console.error("WebRTC fallback test failed:",s),new Error("WebRTC is not supported in this browser. Please use Chrome, Firefox, Safari, or Edge.")}}if(!zy.isSecureContext()){const s=window.location.hostname;throw s.startsWith("192.168.")||s.startsWith("10.")||s.startsWith("172.")?new Error("Local network access detected. Please enable microphone permissions in your browser settings for this IP address, or use localhost instead."):new Error("Voice calls require HTTPS. Please use a secure connection.")}if(console.log(" Getting microphone access..."),this.localStream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1}),console.log(" Got local stream with tracks:",this.localStream.getTracks().length),this.peerConnection||(console.log("Creating peer connection for new call"),this.setupPeerConnection()),!this.peerConnection)throw new Error("Peer connection not initialized");this.localStream.getTracks().forEach(s=>{console.log(" Adding track to peer connection:",s.kind,s.label),this.peerConnection.addTrack(s,this.localStream)}),console.log(" Tracks added to peer connection"),console.log(" Creating offer...");const r=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});await this.peerConnection.setLocalDescription(r),console.log(" Offer created and local description set"),(n=this.onOffer)==null||n.call(this,r)}catch(r){throw console.error("Error initiating call:",r),this.updateCallState({connectionState:"failed"}),r}}async prepareForIncomingCall(){try{console.log(" Preparing WebRTC service for incoming call..."),this.updateCallState({connectionState:"connecting"}),this.peerConnection||(console.log("Setting up peer connection for incoming call"),this.setupPeerConnection()),console.log(" Checking microphone permission for incoming call...");const e=await zy.checkMicrophonePermission();if(console.log(" Microphone permission status:",e),e.granted||(console.log(" Microphone permission not granted, proceeding in listen-only mode"),this.updateCallState({isMuted:!0})),e.granted)try{this.localStream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1}),console.log(" Microphone stream obtained successfully for incoming call")}catch(n){console.error("Failed to get user media:",n);const r=n;if(r.name==="NotAllowedError"||r.name==="PermissionDeniedError")console.log(" Microphone permission denied, continuing in listen-only mode"),this.localStream=null;else throw r.name==="NotFoundError"?new Error("No microphone found. Please connect a microphone and try again."):new Error(`Failed to access microphone: ${r.message}`)}else console.log(" No microphone permission, proceeding in listen-only mode"),this.localStream=null;this.localStream?this.localStream.getTracks().forEach(n=>{this.peerConnection&&this.peerConnection.addTrack(n,this.localStream)}):console.log(" No local stream available, call will be listen-only"),console.log(" WebRTC service prepared for incoming call, waiting for offer...")}catch(e){throw console.error("Error preparing for incoming call:",e),this.updateCallState({connectionState:"failed"}),e}}async answerCall(e){try{if(!e||!e.type||!e.sdp)throw new Error("Invalid offer: offer is required");if(console.log(" Answering call with offer (working pattern)"),this.updateCallState({connectionState:"connecting"}),console.log(" Getting microphone access for answering..."),this.localStream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1}),console.log(" Got local stream for answer with tracks:",this.localStream.getTracks().length),this.setupPeerConnection(),!this.peerConnection)throw new Error("Failed to create peer connection");if(this.localStream.getTracks().forEach(r=>{console.log(" Adding track to peer connection for answer:",r.kind,r.label),this.peerConnection.addTrack(r,this.localStream)}),console.log(" Tracks added to peer connection"),console.log(" Setting remote description (offer)..."),await this.peerConnection.setRemoteDescription(e),console.log(" Remote description set"),this.pendingIceCandidates.length>0){console.log(" Processing pending ICE candidates:",this.pendingIceCandidates.length);for(const r of this.pendingIceCandidates)try{await this.addIceCandidate(r)}catch(s){console.error(" Error adding pending ICE candidate:",s)}this.pendingIceCandidates=[]}console.log(" Creating answer...");const n=await this.peerConnection.createAnswer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});if(await this.peerConnection.setLocalDescription(n),console.log(" Answer created and local description set"),this.onAnswer)this.onAnswer(n);else throw new Error("onAnswer callback not set - cannot send answer")}catch(n){throw console.error(" Error answering call:",n),this.updateCallState({connectionState:"failed"}),this.localStream&&(this.localStream.getTracks().forEach(r=>r.stop()),this.localStream=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),n}}async handleAnswer(e){try{if(!this.peerConnection)throw new Error("Peer connection not initialized");if(await this.peerConnection.setRemoteDescription(e),console.log(" Answer received and set"),this.pendingIceCandidates.length>0){console.log(" Processing pending ICE candidates after answer:",this.pendingIceCandidates.length);for(const n of this.pendingIceCandidates)try{await this.addIceCandidate(n)}catch(r){console.error(" Error adding pending ICE candidate after answer:",r)}this.pendingIceCandidates=[]}}catch(n){throw console.error(" Error handling answer:",n),n}}async handleOffer(e){var n;try{if(console.log(" handleOffer called with offer:",e),!e.type||!e.sdp)throw console.error(" Invalid offer format in handleOffer:",e),new Error("Invalid offer format: missing type or sdp");if(this.peerConnection||(console.log(" Peer connection not ready, preparing for incoming call..."),await this.prepareForIncomingCall()),!this.peerConnection)throw new Error("Failed to initialize peer connection");if(console.log(" Setting remote offer description in handleOffer..."),await this.peerConnection.setRemoteDescription(e),console.log(" Remote offer description set successfully in handleOffer"),this.pendingIceCandidates.length>0){console.log(" Processing pending ICE candidates after setting remote offer:",this.pendingIceCandidates.length);const s=[...this.pendingIceCandidates];this.pendingIceCandidates=[];for(const i of s)try{this.peerConnection&&this.peerConnection.remoteDescription?await this.addIceCandidate(i):(console.warn(" Remote description not set, re-queuing ICE candidate"),this.pendingIceCandidates.push(i))}catch(o){console.error(" Error adding pending ICE candidate in handleOffer:",o)}}const r=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(r),console.log(" Answer created and set"),this.updateCallState({isConnected:!0,connectionState:"connected"}),console.log(" Call connection established"),console.log(" Local stream after answer:",!!this.localStream),this.localStream&&console.log(" Local stream tracks:",this.localStream.getTracks().length),(n=this.onAnswer)==null||n.call(this,r)}catch(r){throw console.error("Error handling offer:",r),this.updateCallState({connectionState:"failed"}),r}}async addIceCandidate(e){var n;try{if(!e||e===null||e===void 0){console.log(" Received null/undefined ICE candidate (end-of-candidates) - ignoring per WebRTC spec");return}if(!e.candidate&&!e.sdpMid&&e.sdpMLineIndex===void 0){console.warn(" Invalid ICE candidate missing both sdpMid and sdpMLineIndex - this is a Chrome bug, ignoring");return}if(!this.peerConnection){console.warn(" Cannot add ICE candidate: peer connection not initialized"),this.pendingIceCandidates.push(e),console.log(" ICE candidate queued for later (no peer connection)");return}if(!this.peerConnection.remoteDescription){console.warn(" Cannot add ICE candidate: remote description not set yet"),this.pendingIceCandidates.push(e),console.log(" ICE candidate queued for later (remote description pending)");return}try{await this.peerConnection.addIceCandidate(e),console.log(" ICE candidate added successfully")}catch(r){if((n=r==null?void 0:r.message)!=null&&n.includes("Candidate missing values for both sdpMid and sdpMLineIndex")){console.log(" Chrome bug: Ignoring expected end-of-candidates error");return}console.error(" Error adding ICE candidate:",r)}}catch(r){console.error(" Unexpected error in addIceCandidate:",r)}}toggleMute(){var e;if(this.localStream){const n=this.localStream.getAudioTracks();n.forEach(s=>{s.enabled=!s.enabled});const r=!((e=n[0])!=null&&e.enabled);return this.updateCallState({isMuted:r}),r}return!0}toggleSpeaker(){const e=!this.callState.isSpeakerOn;return this.updateCallState({isSpeakerOn:e}),e}resetConnectionState(){this.iceRestartAttempts=0,this.connectionRecoveryAttempts=0,this.iceRestartTimeout&&(clearTimeout(this.iceRestartTimeout),this.iceRestartTimeout=null)}endCall(){console.log("Ending call"),this.resetConnectionState(),this.localStream&&(this.localStream.getTracks().forEach(e=>e.stop()),this.localStream=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.updateCallState({isConnected:!1,isMuted:!1,isSpeakerOn:!0,callDuration:0,connectionState:"disconnected"}),this.stopCallTimer()}getCallState(){return{...this.callState}}checkConnection(){var o,c;const e=!!this.localStream,n=!!this.remoteStream,r=(o=this.peerConnection)==null?void 0:o.connectionState,s=(c=this.peerConnection)==null?void 0:c.iceConnectionState;console.log(" Connection check:",{hasLocalStream:e,hasRemoteStream:n,peerConnectionState:r,iceConnectionState:s,currentState:this.callState.connectionState});const i=e&&(n||r==="connected"||s==="connected"||s==="completed");return i&&this.callState.connectionState!=="connected"&&(console.log(" Manual connection check: forcing connected state"),this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer()),i}onCallStateChange(e){this.callStateCallbacks.push(e)}offCallStateChange(e){const n=this.callStateCallbacks.indexOf(e);n>-1&&this.callStateCallbacks.splice(n,1)}getLocalStream(){return this.localStream}getRemoteStream(){return this.remoteStream}updateCallState(e){this.callState={...this.callState,...e},this.callStateCallbacks.forEach(n=>n(this.callState))}startCallTimer(){console.log(" Starting call timer..."),this.stopCallTimer(),this.durationInterval=setInterval(()=>{const e=this.callState.callDuration+1;console.log(" Call duration:",e),this.updateCallState({callDuration:e})},1e3)}stopCallTimer(){this.durationInterval&&(clearInterval(this.durationInterval),this.durationInterval=null)}static formatDuration(e){const n=Math.floor(e/60),r=e%60;return`${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}}const Sr=new oIe;class aIe{constructor(){G(this,"socket",null);G(this,"isConnected",!1);G(this,"currentCallId",null);G(this,"callHandlers",new Map);G(this,"currentUserAddress",null);G(this,"receiverAddress",null);G(this,"callerSocketId",null);G(this,"callerAddress",null);this.setupWebRTCIntegration(),this.autoConnect(),Xt.subscribe(e=>{e.address&&e.address!==this.currentUserAddress&&(this.currentUserAddress=e.address,this.socket&&this.isConnected&&this.socket.emit("join-user-room",{address:e.address}))})}autoConnect(){setTimeout(async()=>{try{await this.ensureConnection(),console.log(" Signaling service auto-connected")}catch{console.log(" Signaling service auto-connect failed, will retry when needed")}},1e3)}async ensureConnection(){if(!this.isConnected||!this.socket){console.log(" Not connected to signaling server, attempting to connect...");try{await this.connect()}catch(e){throw console.error(" Failed to connect to signaling server:",e),new Error("Unable to connect to signaling server. Please check your internet connection and try again.")}}}connect(){return new Promise((e,n)=>{try{this.socket=Po(Na,{transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,autoConnect:!0}),this.socket.on("connect",()=>{var s;console.log("Connected to signaling server"),this.isConnected=!0;const{address:r}=Xt.getState();r&&((s=this.socket)==null||s.emit("join-user-room",{address:r}),this.currentUserAddress=r),e()}),this.socket.on("disconnect",()=>{console.log("Disconnected from signaling server"),this.isConnected=!1}),this.socket.on("error",r=>{console.error("Signaling server error:",r),n(r)}),this.socket.on("signaling-message",r=>{this.handleSignalingMessage(r)}),this.socket.on("call-initiated",r=>{console.log("Call initiated:",r),this.handleCallInitiated(r)}),this.socket.on("incoming-call",r=>{console.log(" Incoming call received:",r),r.callerAddress&&(this.callerAddress=r.callerAddress,console.log(" Stored caller address for answer:",this.callerAddress)),this.handleCallInitiated(r)}),this.socket.on("call-answered",r=>{console.log(" Call answered event received:",r),console.log(" Current call ID:",this.currentCallId),console.log(" Event call ID:",r.callId),this.handleCallAnswered(r)}),this.socket.on("call-ended",r=>{console.log("Call ended:",r),this.handleCallEnded(r)}),this.socket.on("call-rejected",r=>{console.log(" Call rejected event received:",r),this.handleCallRejected(r)}),this.socket.on("incoming-call-cleared",r=>{console.log(" Incoming call cleared:",r),this.handleCallRejected(r)}),this.socket.on("call-offer",async r=>{if(console.log(" Received call offer (immediate processing):",r),r.offer){this.callerSocketId=r.callerSocketId,r.callerAddress?(this.callerAddress=r.callerAddress,console.log(" Stored caller address from call-offer:",this.callerAddress)):r.from&&(this.callerAddress=r.from);try{console.log(" Immediately calling webrtcService.answerCall with call-offer..."),await Sr.answerCall(r.offer),console.log(" Answer created and sent via onAnswer callback")}catch(s){console.error(" Error answering call-offer:",s)}}}),this.socket.on("offer",async r=>{if(console.log(" Received offer via socket (immediate processing):",r),r.offer&&r.from){this.callerSocketId=r.from,r.callerAddress?(this.callerAddress=r.callerAddress,console.log(" Stored caller address from offer:",this.callerAddress)):r.from&&(this.callerAddress=r.from,console.log(" Using from field as caller address:",this.callerAddress));try{console.log(" Immediately calling webrtcService.answerCall with offer..."),await Sr.answerCall(r.offer),console.log(" Answer created and sent via onAnswer callback")}catch(s){console.error(" Error answering call:",s)}}}),this.socket.on("call-answer",r=>{console.log(" Received call answer:",r),r.answer&&this.handleAnswer({type:"answer",data:r.answer,from:"",to:this.currentUserAddress||"",callId:r.callId})}),this.socket.on("ice-candidate",r=>{console.log(" Received ICE candidate:",r),r.candidate&&this.handleIceCandidate({type:"ice-candidate",data:r.candidate,from:"",to:this.currentUserAddress||"",callId:r.callId})})}catch(r){console.error("Error connecting to signaling server:",r),n(r)}})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.isConnected=!1)}async initiateCall(e,n,r){const{address:s}=Xt.getState(),i=r||s;if(!i)throw new Error("Wallet not connected or caller address not provided");this.currentUserAddress=i,this.receiverAddress=e,console.log(" Stored receiverAddress for call initiation:",this.receiverAddress),console.log(" Using caller address:",i);try{const o=localStorage.getItem("authToken"),c={"Content-Type":"application/json"};o&&(c.Authorization=`Bearer ${o}`);const l=await fetch("/api/calls",{method:"POST",headers:c,body:JSON.stringify({receiver_address:e,ad_id:n,signaling_data:{callerAddress:i}})});if(!l.ok){const h=await l.json();throw new Error(h.error||"Failed to initiate call")}const u=(await l.json()).data.id.toString();return this.currentCallId=u,await this.ensureConnection(),await Sr.initiateCall(),this.socket&&(this.socket.emit("initiate-call",{callId:u,receiverAddress:e,adId:n,callerAddress:i,timestamp:Date.now()}),console.log(" Call initiation sent to:",e)),console.log("Call initiated:",u),u}catch(o){throw console.error("Error initiating call:",o),o}}async answerCall(e,n,r){console.log(" signalingService.answerCall called:",{callId:e,hasOffer:!!n,callerAddress:r}),await this.ensureConnection(),this.currentCallId=e,r&&(this.callerAddress=r,console.log(" Stored caller address in answerCall:",this.callerAddress));try{n?(console.log(" Answering call with provided offer"),await Sr.answerCall(n),console.log(" webrtcService.answerCall completed")):(console.log(' No offer provided, waiting for offer via socket.on("offer") handler...'),console.log(" Offer will be processed immediately when received")),this.socket?(console.log(" Sending call-answered notification"),this.socket.emit("answer-call",{callId:e,timestamp:Date.now()})):console.warn(" Socket not connected, cannot send call-answered notification"),console.log(" Call answered successfully:",e)}catch(s){throw console.error(" Error answering call:",s),s}}endCall(){this.currentCallId&&this.socket&&this.socket.emit("end-call",{callId:this.currentCallId,timestamp:Date.now()}),Sr.endCall(),this.currentCallId=null}handleSignalingMessage(e){switch(console.log("Received signaling message:",e),e.type){case"offer":this.handleOffer(e);break;case"answer":this.handleAnswer(e);break;case"ice-candidate":this.handleIceCandidate(e);break;default:console.log("Unknown signaling message type:",e.type)}}async handleOffer(e){try{console.log(" Handling incoming offer:",e.data),await Sr.handleOffer(e.data),console.log(" Offer handled successfully")}catch(n){console.error(" Error handling offer:",n)}}async handleAnswer(e){try{console.log(" Handling incoming answer:",e.data),await Sr.handleAnswer(e.data),console.log(" Answer handled successfully")}catch(n){console.error(" Error handling answer:",n)}}async handleIceCandidate(e){try{await Sr.addIceCandidate(e.data)}catch(n){console.error("Error handling ICE candidate:",n)}}handleCallInitiated(e){const n=this.callHandlers.get("call-initiated");n&&n({type:"call-initiated",data:e,from:e.from,to:e.to,callId:e.callId})}handleCallAnswered(e){const n=this.callHandlers.get("call-answered");n&&n({type:"call-answered",data:e,from:e.from,to:e.to,callId:e.callId})}handleCallEnded(e){const n=this.callHandlers.get("call-ended");n&&n({type:"call-ended",data:e,from:e.from,to:e.to,callId:e.callId})}handleCallRejected(e){const n=this.callHandlers.get("call-rejected");n&&n({type:"call-rejected",data:e,from:e.from,to:e.to,callId:e.callId})}setupWebRTCIntegration(){Sr.onOffer=e=>{this.currentCallId&&this.currentUserAddress&&this.receiverAddress&&this.socket&&(console.log(" Sending WebRTC offer to:",this.receiverAddress),this.socket.emit("call-offer",{receiverAddress:this.receiverAddress,offer:e,callId:this.currentCallId,callerAddress:this.currentUserAddress}))},Sr.onAnswer=e=>{var n;if(console.log(" webrtcService.onAnswer callback triggered"),console.log(" Answer details:",{type:e.type,hasSdp:!!e.sdp,sdpLength:((n=e.sdp)==null?void 0:n.length)||0,callerAddress:this.callerAddress,receiverAddress:this.receiverAddress,currentCallId:this.currentCallId}),this.socket){const r=this.callerAddress||this.receiverAddress;r?(console.log(" Sending WebRTC answer to:",r),console.log(" Emitting answer event to socket with target:",r),this.socket.emit("answer",{answer:e,to:r}),console.log(" Answer event emitted via socket"),this.currentCallId&&(console.log(" Also emitting call-answer event for compatibility"),this.socket.emit("call-answer",{answer:e,callId:this.currentCallId}))):(console.error(" Cannot send answer: no target address available"),console.error(" callerAddress:",this.callerAddress),console.error(" receiverAddress:",this.receiverAddress))}else console.error(" Cannot send answer: socket not connected")},Sr.onIceCandidate=e=>{if(!this.socket){console.warn(" Cannot send ICE candidate: socket not connected");return}const n=this.callerAddress||this.receiverAddress;if(!n){console.warn(" Cannot send ICE candidate: no target address (callerAddress or receiverAddress)"),console.warn(" Current state:",{callerAddress:this.callerAddress,receiverAddress:this.receiverAddress,callerSocketId:this.callerSocketId,currentCallId:this.currentCallId});return}console.log(" Sending ICE candidate to:",n),console.log(" Candidate details:",{type:e.type,protocol:e.protocol,address:e.address}),this.socket.emit("ice-candidate",{candidate:e,to:n,callId:this.currentCallId||void 0})}}onCallEvent(e,n){this.callHandlers.set(e,n)}isSignalingConnected(){return this.isConnected}getCurrentCallId(){return this.currentCallId}}const ad=new aIe;class cIe{constructor(){G(this,"activeCall",null);G(this,"callHandlers",new Map)}async initiateCall(e,n,r,s){const{address:i}=Xt.getState(),o=(s==null?void 0:s.callerAddress)||i;if(!o)throw new Error("Wallet not connected or caller address not provided");try{const c=localStorage.getItem("authToken"),l={receiver_address:e,ad_id:r,signaling_data:{context:n,callerAddress:o,...s}};console.log(" Sending call request:",l);const d=await fetch("/api/calls",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(l)});if(!d.ok){const f=await d.json();throw new Error(f.error||"Failed to initiate call")}const h=(await d.json()).data.id.toString();return this.activeCall={callId:h,callerAddress:o,receiverAddress:e,context:n,adId:r,timestamp:Date.now()},await ad.initiateCall(e,r,o),console.log(" Call initiated:",h),h}catch(c){throw console.error(" Call initiation failed:",c),c}}async answerCall(e,n){try{const r=localStorage.getItem("authToken");if(!r)throw new Error("Authentication required");if(!this.activeCall)throw new Error("No active call to answer");const s=await fetch(`/api/calls/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({status:"active",answer:n,signaling_data:{answer:n}})});if(!s.ok){const i=await s.json();throw new Error(i.error||"Failed to answer call")}await ad.answerCall(e,n),console.log(" Call answered:",e),U.success("Call connected!")}catch(r){throw console.error(" Failed to answer call:",r),r}}async rejectCall(e){try{const n=localStorage.getItem("authToken");if(!n)throw new Error("Authentication required");await fetch(`/api/calls/${e}/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}}),console.log(" Call rejected:",e),U("Call rejected",{icon:""})}catch(n){throw console.error(" Failed to reject call:",n),n}}async endCall(){if(this.activeCall)try{const e=localStorage.getItem("authToken");e&&await fetch(`/api/calls/${this.activeCall.callId}/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),ad.endCall(),console.log(" Call ended:",this.activeCall.callId),this.activeCall=null}catch(e){console.error(" Failed to end call:",e)}}getActiveCall(){return this.activeCall}async checkUserAvailability(e){try{const n=await fetch(`/api/auth/user-by-address?address=${e}`);if(n.ok){const r=await n.json();return r.success&&r.data}return!1}catch(n){return console.error("Failed to check user availability:",n),!1}}async getUserInfo(e){try{const n=await fetch(`/api/auth/user-by-address?address=${e}`);if(n.ok){const r=await n.json();if(r.success&&r.data)return{name:r.data.name,verified:r.data.verified}}return null}catch(n){return console.error("Failed to get user info:",n),null}}onCallEvent(e,n){this.callHandlers.set(e,n)}offCallEvent(e){this.callHandlers.delete(e)}emitCallEvent(e,n){const r=this.callHandlers.get(e);r&&r(n)}initialize(){ad.onCallEvent("call-answered",e=>{console.log(" CallService: Received call-answered event:",e),this.emitCallEvent("call-answered",e)}),ad.onCallEvent("call-ended",e=>{console.log(" CallService: Received call-ended event:",e),this.emitCallEvent("call-ended",e),this.activeCall=null}),ad.onCallEvent("call-rejected",e=>{console.log(" CallService: Received call-rejected event:",e),this.emitCallEvent("call-rejected",e),this.activeCall=null}),ad.onCallEvent("call-status-updated",e=>{console.log(" CallService: Received call-status-updated event:",e),e.status==="active"?this.emitCallEvent("call-answered",e):e.status==="ended"&&(this.emitCallEvent("call-ended",e),this.activeCall=null)}),console.log(" Call service initialized")}cleanup(){this.activeCall=null,this.callHandlers.clear(),console.log(" Call service cleaned up")}}const Ug=new cIe;typeof window<"u"&&Ug.initialize();const kV=A.createContext({isConnected:!1,incomingCall:null,activeCall:!1,acceptCall:()=>{},rejectCall:()=>{}}),lIe=()=>A.useContext(kV),dIe=({children:t})=>{const[e,n]=A.useState(null),[r,s]=A.useState(!1),[i,o]=A.useState(null),[c,l]=A.useState(!1),[d,u]=A.useState(null),{address:h}=Xt(),{user:f}=ss();A.useEffect(()=>(h&&f?p():m(),()=>{m()}),[h,f]);const p=()=>{if(e!=null&&e.connected)return;console.log(" Connecting to WebSocket:",Na);const b=Po(Na,{transports:["websocket","polling"],autoConnect:!0,timeout:1e4,reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,query:{userAddress:h}});b.on("connect",()=>{console.log(" Connected to call notification service"),s(!0),b.emit("join-user-room",{address:h}),console.log(" Joined user room for address:",h)}),b.on("disconnect",v=>{console.log(" Disconnected from call notification service:",v),s(!1)}),b.on("connect_error",v=>{console.error(" WebSocket connection error:",v),s(!1)}),b.on("incoming-call",async v=>{console.log(" Incoming call received:",v);try{let E;if(v.adId&&v.adId!=="order-call"&&!v.adId.startsWith("order-")){const C=localStorage.getItem("authToken");if(C)try{const S=await fetch(`/api/ads/${v.adId}`,{headers:{Authorization:`Bearer ${C}`}});if(S.ok){const N=await S.json();N.success&&(E=N.data)}}catch(S){console.error(" Failed to fetch ad:",S)}}let k;try{const C=await fetch(`/api/auth/user-by-address?address=${v.callerAddress}`);if(C.ok){const S=await C.json();S.success&&S.data.name&&(k=S.data.name)}}catch(C){console.error(" Could not fetch caller name:",C)}o({callId:v.callId,callerAddress:v.callerAddress,callerName:k,ad:E,timestamp:v.timestamp,offer:v.offer}),Ns.playIncomingCall(),U(" Incoming call!",{duration:5e3,position:"top-center"})}catch(E){console.error(" Error handling incoming call:",E)}}),b.on("call-offer",async v=>{console.log(" Received WebRTC offer:",v);try{o(E=>E&&E.callId===v.callId?{...E,offer:v.offer}:E)}catch(E){console.error(" Error handling offer:",E)}}),b.on("call-answer",async v=>{console.log(" Received WebRTC answer:",v);try{await Sr.handleAnswer(v.answer),console.log(" Answer processed successfully")}catch(E){console.error(" Error handling answer:",E)}}),b.on("ice-candidate",async v=>{console.log(" Received ICE candidate");try{await Sr.addIceCandidate(v.candidate)}catch(E){console.error(" Error adding ICE candidate:",E)}}),b.on("call-answered",v=>{console.log(" Call answered event received:",v),Ns.stopIncomingCall(),Ns.stopOutgoingCall(),Ns.playCallConnected(),l(!0),o(null),U.success("Call connected!")}),b.on("call-status-updated",v=>{console.log(" Call status updated:",v),v.status==="ended"?g():v.status==="active"&&(Ns.stopIncomingCall(),Ns.stopOutgoingCall(),Ns.playCallConnected(),l(!0),U.success("Call connected!"))}),b.on("call-rejected",v=>{console.log(" Call rejected:",v),g(),U.error("Call was rejected")}),b.on("call-ended",v=>{console.log(" Call ended:",v),g()}),n(b)},m=()=>{e&&(e.disconnect(),n(null),s(!1))},g=()=>{Ns.stopAllSounds(),Ns.playCallEnded(),Sr.endCall(),o(null),l(!1),u(null),U("Call ended",{icon:""})},y=async b=>{if(!i){console.error(" No incoming call to accept");return}try{console.log(" Accepting call:",b),Ns.stopIncomingCall(),await Sr.prepareForIncomingCall(),console.log(" WebRTC prepared for incoming call"),i.offer?(await Sr.answerCall(i.offer),console.log(" Call answered with offer")):(await Sr.answerCall(),console.log(" Call answered without offer")),e&&e.emit("call-answered",{callId:b,receiverAddress:h,callerAddress:i.callerAddress}),Ns.playCallConnected(),l(!0),u((i==null?void 0:i.ad)||null),o(null),U.success("Call connected!")}catch(v){console.error(" Error accepting call:",v),Ns.stopIncomingCall(),U.error("Failed to accept call"),Sr.endCall(),o(null)}},x=async b=>{try{console.log(" Rejecting call:",b),Ns.stopIncomingCall(),await Ug.rejectCall(b),e&&i&&e.emit("call-rejected",{callId:b,receiverAddress:h,callerAddress:i.callerAddress}),Ns.playCallEnded(),o(null)}catch(v){console.error(" Error rejecting call:",v),Ns.stopIncomingCall()}},w={isConnected:r,incomingCall:i,activeCall:c,acceptCall:y,rejectCall:x};return a.jsxs(kV.Provider,{value:w,children:[t,i&&a.jsx(bR,{isOpen:!!i,callerAddress:i.callerAddress,callerName:i.callerName,ad:i.ad,callId:i.callId,onAccept:()=>y(i.callId),onReject:()=>x(i.callId),onClose:()=>o(null)}),c&&a.jsx(AN,{isOpen:c,ad:d,onClose:()=>{Sr.endCall();const b=ad.getCurrentCallId();b&&Ug.endCall(),e&&b&&e.emit("end-call",{callId:b}),g()}})]})},IV=AI(t=>({unreadOrdersCount:0,setUnreadOrdersCount:e=>t({unreadOrdersCount:e}),clearUnreadOrdersCount:()=>t({unreadOrdersCount:0})})),uIe="/assets/logo-BZD251q-.jpeg",hIe=({children:t})=>{const e=vu(),{incomingCall:n,isConnected:r}=lIe(),{isConnected:s,address:i}=Xt(),{user:o}=ss(),{unreadOrdersCount:c}=IV(),l=u=>e.pathname===u,d=e.pathname==="/orders";return A.useEffect(()=>{if(!document.querySelector('meta[name="viewport"]')){const f=document.createElement("meta");f.name="viewport",f.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(f)}const h=()=>{document.addEventListener("touchend",()=>{document.body.style.zoom="1"},{once:!0})};return document.addEventListener("touchstart",h),()=>{document.removeEventListener("touchstart",h)}},[]),A.useEffect(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().then(u=>{console.log("Notification permission:",u)})},[]),A.useEffect(()=>{if(n&&"navigator"in window&&"vibrate"in navigator){const u=[500,300,500,300,500,300];return navigator.vibrate(u),()=>{navigator.vibrate(0)}}},[n]),a.jsxs("div",{className:"min-h-screen flex flex-col relative",children:[s&&a.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 bg-black/10 backdrop-blur-sm",children:a.jsx("div",{className:"max-w-md mx-auto px-4 py-1",children:a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${r?"bg-green-400":"bg-gray-400"}`}),a.jsx("span",{className:"text-gray-300",children:r?"Online":"Offline"})]}),o&&a.jsxs("div",{className:"flex items-center space-x-1",children:[o.verified&&a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400"}),a.jsx("span",{className:"text-gray-300 truncate max-w-20",children:o.name||`${i==null?void 0:i.slice(0,6)}...${i==null?void 0:i.slice(-4)}`})]})]})})}),a.jsx("header",{className:`bg-black/20 backdrop-blur-lg border-b border-white/10 ${s?"mt-6":""}`,children:a.jsx("div",{className:"max-w-md mx-auto px-4 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("img",{src:uIe,alt:"Zotrust Logo",className:"w-12 h-12 object-contain"}),n&&a.jsxs("div",{className:"flex items-center space-x-2 animate-pulse",children:[a.jsx(dn,{size:16,className:"text-green-400"}),a.jsx("span",{className:"text-green-400 text-sm font-medium",children:"Incoming Call"})]}),a.jsx("div",{className:"text-center flex items-center justify-center",children:a.jsx("p",{className:"text-gray-300 text-sm text-center font-bold",children:"Decentralized P2P Trading Platform"})})]})})}),a.jsx("main",{className:"flex-1 overflow-auto pb-safe",children:t}),a.jsx("nav",{className:"bg-black/30 backdrop-blur-lg border-t border-white/20 pb-safe",children:a.jsx("div",{className:"w-full px-2 sm:px-4",children:a.jsxs("div",{className:"flex items-center justify-between py-2 sm:py-3 safe-area-inset-bottom",children:[a.jsxs(zd,{to:"/",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 ${l("/")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[a.jsx(xQ,{size:20,className:"sm:w-5 sm:h-5"}),a.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"Home"})]}),a.jsxs(zd,{to:"/p2p",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 ${l("/p2p")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[a.jsx(wl,{size:20,className:"sm:w-5 sm:h-5"}),a.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"P2P"})]}),a.jsxs(zd,{to:"/orders",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 relative ${l("/orders")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[a.jsxs("div",{className:"relative",children:[a.jsx(ll,{size:20,className:"sm:w-5 sm:h-5"}),n&&a.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-2.5 h-2.5 sm:w-3 sm:h-3 bg-red-500 rounded-full animate-pulse"}),!d&&c>0&&a.jsx("div",{className:"absolute top-0 right-0 min-w-[18px] h-[18px] bg-red-500 rounded-full flex items-center justify-center px-1 translate-x-1/2 -translate-y-1/2",children:a.jsx("span",{className:"text-white text-[10px] font-bold",children:c>99?"99+":c})})]}),a.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"Orders"})]}),a.jsxs(zd,{to:"/profile",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 relative ${l("/profile")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[a.jsx(hg,{size:20,className:"sm:w-5 sm:h-5"}),a.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"Profile"}),(o==null?void 0:o.verified)&&a.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-green-400 rounded-full"})]})]})})})]})},N1=()=>{localStorage.removeItem("adminToken"),console.log("Cleared expired admin token")},fIe=t=>{try{const e=JSON.parse(atob(t.split(".")[1])),n=Math.floor(Date.now()/1e3);return e.exp<n}catch{return!0}},RU=()=>localStorage.getItem("adminToken"),pIe=async()=>{const t=localStorage.getItem("adminToken");if(!t)return!1;if(fIe(t))return N1(),!1;try{return(await fetch("/api/admin/test-token",{headers:{Authorization:`Bearer ${t}`}})).ok?!0:(N1(),!1)}catch{return N1(),!1}},mIe=({children:t})=>{const[e,n]=A.useState(!1),[r,s]=A.useState(!1),[i,o]=A.useState(null),[c,l]=A.useState(!1),[d,u]=A.useState(0),[h,f]=A.useState(!1),[p,m]=A.useState(0),g=ds(),y=vu(),x=A.useRef(null),w=A.useRef(null),b=A.useRef(null),v=A.useRef(null),E=A.useRef(null),k=A.useRef(null),C=A.useRef(null),S=y.pathname==="/admin/login";Lx.useEffect(()=>{S||pIe().then(B=>{B||(g("/admin/login"),U.error("Session expired. Please login again."))})},[g,S]),A.useEffect(()=>{var Z;const B=window.matchMedia("(min-width: 1024px)"),W=()=>s(B.matches);return W(),(Z=B.addEventListener)==null||Z.call(B,"change",W),()=>{var ie;return(ie=B.removeEventListener)==null?void 0:ie.call(B,"change",W)}},[]),A.useEffect(()=>{if(S)return;console.log(" AdminLayout: Setting up socket connection for admin (ALWAYS CONNECTED)...");const B=Po(Na,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:1/0,timeout:2e4,forceNew:!1,autoConnect:!0});let W=null,Z=null;const ie=()=>{B.connected&&(console.log(" AdminLayout: Registering as ADMIN_SUPPORT (fixed address)"),B.emit("register","ADMIN_SUPPORT",!0),console.log(" AdminLayout:  Emitted register event for ADMIN_SUPPORT"))},ae=()=>{B.connected&&B.emit("check-user-status","ADMIN_SUPPORT")};B.on("connect",()=>{console.log(" AdminLayout:  Connected to socket:",B.id),console.log(" AdminLayout: Socket URL:",Na),ie(),setTimeout(()=>{ae()},500),W=setInterval(()=>{B.connected&&(console.log(" AdminLayout: Periodic registration check..."),ie())},3e4),Z=setInterval(()=>{ae()},6e4),U.success(" Connected to support call service",{duration:2e3})}),B.on("registration-confirmed",de=>{console.log(" AdminLayout:  Registration confirmed:",de),console.log(" AdminLayout: Admin is now in support call group")}),B.on("user-status",de=>{console.log(" AdminLayout: User status check result:",de),de.userId==="ADMIN_SUPPORT"&&de.isOnline?console.log(" AdminLayout:  Admin is registered and online in support group"):(console.warn(" AdminLayout: Admin not online, re-registering..."),ie())}),B.on("disconnect",de=>{console.log(" AdminLayout: Disconnected from socket:",de),console.log(" AdminLayout: Will automatically reconnect..."),W&&(clearInterval(W),W=null),Z&&(clearInterval(Z),Z=null)}),B.on("reconnect",de=>{console.log(" AdminLayout:  Reconnected after",de,"attempts"),ie(),W=setInterval(()=>{B.connected&&ie()},3e4),Z=setInterval(()=>{ae()},6e4)}),B.on("connect_error",de=>{console.error(" AdminLayout: Connection error:",de),console.log(" AdminLayout: Will retry connection automatically...")}),B.on("incoming-call",de=>{console.log(" AdminLayout: Incoming support call:",de),fetch(`/api/auth/user-by-address?address=${de.callerAddress}`).then(_e=>_e.json()).then(_e=>{var q;const Ue=_e.success&&((q=_e.data)!=null&&q.name)?_e.data.name:void 0,ee={...de,callerName:Ue,isAdminSupportCall:!0};o(ee),w.current=ee,U(" New support call incoming!",{duration:5e3,position:"top-center",icon:""})}).catch(_e=>{console.error("Error fetching caller info:",_e);const Ue={...de,isAdminSupportCall:!0};o(Ue),w.current=Ue,U(" New support call incoming!",{duration:5e3,position:"top-center",icon:""})})}),B.on("offer",async de=>{var _e;if(console.log(" AdminLayout: Received offer (direct WebRTC processing):",de),console.log(" AdminLayout: Offer data:",{hasOffer:!!de.offer,isAdminSupportCall:de.isAdminSupportCall,from:de.from,callerAddress:de.callerAddress,isCallActive:c,hasIncomingCallRef:!!w.current}),de.offer&&(de.isAdminSupportCall||de.from||de.callerAddress||C.current)){const Ue=de.callerAddress||de.from||C.current||((_e=w.current)==null?void 0:_e.callerAddress);if(Ue&&(C.current=Ue,console.log(" AdminLayout: Caller address set to:",Ue)),c)console.log(" AdminLayout: Call already active, answering with direct WebRTC..."),await I(de.offer,Ue);else if(w.current&&w.current.callId){console.log(" AdminLayout: IncomingCallModal still open, updating with offer");const ee={...w.current,offer:de.offer};o(ee),w.current=ee,console.log(" AdminLayout: Updated IncomingCallModal with offer")}else console.log(" AdminLayout: No modal open but received offer, auto-accepting and answering..."),l(!0),await I(de.offer,Ue)}else console.warn(" AdminLayout: Received offer but missing required data:",de)}),B.on("ice-candidate",async de=>{const{candidate:_e,from:Ue}=de;if(console.log(" AdminLayout: Received ICE candidate from",Ue),v.current&&_e&&_e.candidate)try{await v.current.addIceCandidate(new RTCIceCandidate(_e))}catch(ee){console.error(" Error adding ICE candidate:",ee)}}),B.on("call-ended",de=>{console.log(" AdminLayout: Call ended:",de),o(null),w.current=null,T(),Ug.endCall().catch(_e=>{console.error("Error ending call via service:",_e)})}),B.on("call-connected",de=>{console.log(" AdminLayout: Call connected:",de),l(!0),P()}),B.on("new-chat-message",de=>{if(console.log(" AdminLayout: New chat message notification:",de),de.message&&de.message.sender_type==="user"&&(m(_e=>_e+1),y.pathname!=="/admin/chat")){const _e=de.userAddress?`${de.userAddress.slice(0,6)}...${de.userAddress.slice(-4)}`:"User";U(Ue=>a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-white",children:" New Chat Message"}),a.jsxs("p",{className:"text-sm text-gray-200",children:["From: ",a.jsx("span",{className:"font-medium",children:_e})]}),a.jsx("p",{className:"text-xs text-gray-300 mt-1 truncate max-w-xs",children:de.message.message&&de.message.message.length>50?de.message.message.substring(0,50)+"...":de.message.message||"New message"})]}),a.jsx("button",{onClick:()=>{g("/admin/chat"),U.dismiss(Ue.id)},className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition-colors",children:"View"})]}),{duration:5e3,icon:"",position:"top-right",style:{background:"#1e293b",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.1)",minWidth:"300px"}})}});const oe=async()=>{var de;try{const _e=localStorage.getItem("adminToken")||"",Ue=await fetch("/api/admin/chat/unread-count",{headers:{Authorization:`Bearer ${_e}`}});if(Ue.ok){const ee=await Ue.json();m(((de=ee.data)==null?void 0:de.unread_count)||0)}}catch(_e){console.error("Error fetching unread count:",_e)}};x.current=B;let Ne=null;return S||(oe(),Ne=setInterval(oe,3e4)),()=>{b.current&&(clearInterval(b.current),b.current=null),console.log(" AdminLayout: Cleaning up socket connection..."),W&&clearInterval(W),Z&&clearInterval(Z),Ne&&clearInterval(Ne),x.current&&(x.current.disconnect(),x.current=null)}},[S,y.pathname,g]);const N=()=>{x.current&&(x.current.disconnect(),x.current=null),N1(),g("/admin/login"),U.success("Logged out successfully")},I=async(B,W)=>{try{console.log(" AdminLayout: Handling offer with direct WebRTC for:",W),console.log(" Getting microphone access...");const Z=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});console.log(" Got local stream for answer"),E.current=Z;const ie={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]};v.current=new RTCPeerConnection(ie),Z.getAudioTracks().forEach(oe=>{v.current.addTrack(oe,Z)}),v.current.onicecandidate=oe=>{oe.candidate&&x.current&&W&&(console.log(" Sending ICE candidate to caller"),x.current.emit("ice-candidate",{candidate:oe.candidate,to:W}))},v.current.ontrack=oe=>{console.log(" Received remote track:",oe.track.kind),oe.streams&&oe.streams[0]&&k.current&&(k.current.srcObject=oe.streams[0],k.current.play().catch(Ne=>{console.error(" Audio play error:",Ne),setTimeout(()=>{k.current&&k.current.srcObject&&k.current.play().catch(de=>console.error("Retry failed:",de))},500)}))},v.current.onconnectionstatechange=()=>{var Ne;const oe=(Ne=v.current)==null?void 0:Ne.connectionState;console.log(" AdminLayout: Connection state changed:",oe),oe==="connected"?(l(!0),P(),U.success("Call connected!")):(oe==="disconnected"||oe==="failed")&&(console.log(" AdminLayout: Call disconnected, ending call"),T())},v.current.oniceconnectionstatechange=()=>{var Ne;const oe=(Ne=v.current)==null?void 0:Ne.iceConnectionState;console.log(" AdminLayout: ICE connection state:",oe),oe==="connected"||oe==="completed"?(l(!0),P()):(oe==="disconnected"||oe==="failed")&&console.log(" AdminLayout: ICE connection failed")},console.log(" Setting remote description..."),await v.current.setRemoteDescription(new RTCSessionDescription(B)),console.log(" Creating answer...");const ae=await v.current.createAnswer();await v.current.setLocalDescription(ae),console.log(" Sending answer to caller:",W),x.current&&W?(x.current.emit("answer",{answer:ae,to:W}),console.log(" Answer sent to",W,"connection establishing...")):(console.error(" Cannot send answer - missing socket or callerAddress"),console.error("Socket:",!!x.current,"CallerAddress:",W)),l(!0),P(),U.success("Call connected!")}catch(Z){console.error(" Error handling offer with direct WebRTC:",Z),U.error(Z.message||"Failed to answer call"),T()}},F=async()=>{if(!(!i||!x.current))try{console.log(" Admin accepting call:",i.callId),console.log(" Incoming call data:",i),console.log(" AdminLayout: Emitting call-accepted event to backend"),x.current.emit("call-accepted",{callId:i.callId,callerAddress:i.callerAddress}),console.log(" AdminLayout: Call-accepted event sent"),o(null),w.current=null,l(!0),U.success("Call accepted, waiting for connection..."),C.current=i.callerAddress,i.offer?(console.log(" Offer already available, answering immediately with direct WebRTC..."),await I(i.offer,i.callerAddress)):(console.log(" No offer yet, waiting for caller to send offer via socket..."),console.log(" AdminLayout: Call is active, will handle offer when it arrives"))}catch(B){console.error(" Error accepting call:",B),U.error("Failed to accept call"),o(null),w.current=null,l(!1)}},P=()=>{b.current&&clearInterval(b.current),u(0),b.current=setInterval(()=>{u(B=>B+1)},1e3)},H=()=>{b.current&&(clearInterval(b.current),b.current=null),u(0)},z=B=>{const W=Math.floor(B/60),Z=B%60;return`${W.toString().padStart(2,"0")}:${Z.toString().padStart(2,"0")}`},T=()=>{console.log(" AdminLayout: Ending support call"),H(),v.current&&(v.current.close(),v.current=null),E.current&&(E.current.getTracks().forEach(B=>B.stop()),E.current=null),x.current&&C.current&&x.current.emit("end-call",{to:C.current}),l(!1),C.current=null,U("Call ended",{icon:""})},_=()=>{if(E.current){const B=E.current.getAudioTracks()[0];B&&(B.enabled=!B.enabled,f(!B.enabled),U(h?"Microphone unmuted":"Microphone muted",{icon:h?"":""}))}},L=async()=>{if(!i||!x.current){o(null),w.current=null;return}try{x.current.emit("call-rejected",{callId:i.callId,receiverAddress:"ADMIN_SUPPORT",callerAddress:i.callerAddress}),U("Call rejected",{icon:""})}catch(B){console.error("Error rejecting call:",B)}finally{o(null),w.current=null}},O=[{name:"Dashboard",href:"/admin",icon:vQ},{name:"Orders",href:"/admin/orders",icon:G2},{name:"Transactions",href:"/admin/transactions",icon:dw},{name:"Disputes",href:"/admin/disputes",icon:eE},{name:"Support Calls",href:"/admin/support-calls",icon:dn},{name:"Chat Support",href:"/admin/chat",icon:Zd},{name:"Agents",href:"/admin/agents",icon:wl},{name:"Locations",href:"/admin/locations",icon:df},{name:"Users",href:"/admin/users",icon:sQ},{name:"Reviews",href:"/admin/reviews",icon:xa},{name:"Videos",href:"/admin/videos",icon:fl},{name:"Settings",href:"/admin/settings",icon:q2}],M=B=>B==="/admin"?y.pathname==="/admin":y.pathname.startsWith(B);return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:[!r&&e&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 lg:hidden",onClick:()=>n(!1)}),a.jsxs("div",{className:"flex h-screen overflow-hidden",children:[a.jsxs(X.div,{initial:!1,animate:r?{x:0}:{x:e?0:"-100%"},className:"fixed lg:static inset-y-0 left-0 z-50 w-64 bg-white/10 backdrop-blur-lg border-r border-white/20 flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/20 flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg flex items-center justify-center",children:a.jsx(uf,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-white",children:"Zotrust"}),a.jsx("p",{className:"text-xs text-gray-400",children:"Admin Panel"})]})]}),a.jsx("button",{onClick:()=>n(!1),className:"lg:hidden text-gray-400 hover:text-white transition-colors",children:a.jsx(en,{size:20})})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto px-4 py-6 space-y-2",children:O.map(B=>{const W=M(B.href),Z=B.name==="Chat Support";return a.jsxs(X.button,{onClick:()=>{g(B.href),n(!1),Z&&m(0)},whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full flex items-center justify-between px-4 py-3 rounded-lg text-left transition-all duration-200 relative ${W?"bg-gradient-to-r from-purple-500 to-blue-500 text-white shadow-lg":"text-gray-300 hover:bg-white/10 hover:text-white"}`,children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(B.icon,{size:20}),a.jsx("span",{className:"font-medium",children:B.name})]}),Z&&p>0&&a.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full animate-pulse min-w-[20px] text-center",children:p>99?"99+":p})]},B.name)})}),c&&a.jsx("div",{className:"p-4 border-t border-white/20 flex-shrink-0",children:a.jsxs(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-500/30 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),a.jsx("span",{className:"text-green-300 text-xs font-medium",children:"Call Active"})]}),a.jsx("span",{className:"text-green-400 text-xs font-mono",children:z(d)})]}),C.current&&a.jsxs("div",{className:"text-xs text-green-400 font-mono mb-2 truncate",children:[C.current.slice(0,6),"...",C.current.slice(-4)]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(X.button,{onClick:_,className:`flex-1 p-2 rounded-lg transition-colors flex items-center justify-center ${h?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-white/10 text-green-300 hover:bg-white/20"}`,whileTap:{scale:.95},title:h?"Unmute":"Mute",children:h?a.jsx(uw,{size:16}):a.jsx(ug,{size:16})}),a.jsx(X.button,{onClick:T,className:"flex-1 p-2 rounded-lg bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors flex items-center justify-center",whileTap:{scale:.95},title:"End Call",children:a.jsx(Vx,{size:16})})]})]})}),a.jsx("div",{className:"p-4 border-t border-white/20 flex-shrink-0",children:a.jsxs("button",{onClick:N,className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-red-400 hover:bg-red-500/10 hover:text-red-300 transition-all duration-200",children:[a.jsx(SQ,{size:20}),a.jsx("span",{className:"font-medium",children:"Logout"})]})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-40",children:a.jsx("button",{onClick:()=>n(!0),className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg p-2 text-gray-400 hover:text-white transition-colors",children:a.jsx(jQ,{size:24})})}),a.jsx("main",{className:"p-4 lg:p-6 min-h-full",children:t})]})]}),i&&a.jsx(bR,{isOpen:!!i,callerAddress:i.callerAddress,callerName:i.callerName,callId:i.callId,onAccept:F,onReject:L,onClose:()=>o(null)}),a.jsx("audio",{ref:k,autoPlay:!0,style:{display:"none"}})]})},gIe=({isOpen:t,onClose:e,onWalletSelect:n})=>{var u,h,f,p;const[r,s]=A.useState(!1),i=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),o=!!window.ethereum,c=o&&((u=window.ethereum)==null?void 0:u.isMetaMask),l=o&&(((h=window.ethereum)==null?void 0:h.isTrust)||((f=window.ethereum)==null?void 0:f.isTrustWallet)||((p=window.ethereum)==null?void 0:p.isTrustWallet)||navigator.userAgent.includes("TrustWallet")||navigator.userAgent.includes("Trust Wallet"));console.log(" Wallet Detection Debug:",{isMobileDevice:i,hasEthereum:o,isMetaMask:c,isTrustWallet:l,ethereum:window.ethereum,userAgent:navigator.userAgent});const d=async m=>{s(!0);try{await n(m),e()}catch(g){console.error("Wallet connection failed:",g),U.error("Failed to connect wallet")}finally{s(!1)}};return a.jsx(Do,{children:t&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e,children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-900 rounded-xl p-6 w-full max-w-md border border-white/20",onClick:m=>m.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Connect Wallet"}),a.jsx("button",{onClick:e,className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",disabled:r,children:a.jsx(en,{size:20})})]}),a.jsxs("div",{className:"space-y-3",children:[!i&&a.jsxs(a.Fragment,{children:[a.jsx(X.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("metamask"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-orange-500/20 to-orange-600/20 border border-orange-500/30 rounded-lg text-left hover:from-orange-500/30 hover:to-orange-600/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center",children:a.jsx(LQ,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white",children:"MetaMask"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Browser extension wallet"})]})]})}),a.jsx(X.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("walletconnect"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-blue-500/20 to-blue-600/20 border border-blue-500/30 rounded-lg text-left hover:from-blue-500/30 hover:to-blue-600/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:a.jsx(oA,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white",children:"WalletConnect"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Scan QR with mobile wallet"})]})]})})]}),i&&a.jsxs(a.Fragment,{children:[a.jsx(X.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("metamask"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-orange-500/20 to-orange-600/20 border border-orange-500/30 rounded-lg text-left hover:from-orange-500/30 hover:to-orange-600/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center",children:a.jsx(TB,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white",children:"MetaMask Mobile"}),a.jsx("p",{className:"text-sm text-gray-400",children:c?"Detected - Open in MetaMask app":"Open in MetaMask app"})]})]})}),a.jsx(X.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("walletconnect"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-blue-500/20 to-cyan-500/20 border border-blue-500/30 rounded-lg text-left hover:from-blue-500/30 hover:to-cyan-500/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center",children:a.jsx(oA,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white",children:"Trust Wallet"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Connect via WalletConnect (Universal)"})]})]})})]}),a.jsx(X.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("walletconnect"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 rounded-lg text-left hover:from-purple-500/30 hover:to-pink-500/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:a.jsx(oA,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-white",children:"Other Wallets"}),a.jsx("p",{className:"text-sm text-gray-400",children:i?"Connect with any other wallet":"Trust Wallet, Rainbow, Coinbase & more"})]})]})})]}),r&&a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("div",{className:"inline-flex items-center space-x-2 text-blue-400",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-sm",children:"Connecting wallet..."})]})}),a.jsxs("div",{className:"mt-6 p-3 bg-slate-800 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-400 text-center",children:i?"MetaMask  Trust Wallet app install ,  connect ":"Desktop  MetaMask extension install   mobile wallet  QR scan "}),i&&a.jsxs("div",{className:"bg-gray-500/10 border border-gray-500/20 rounded-lg p-3 mt-4",children:[a.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" Debug Info:"}),a.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[a.jsxs("p",{children:["Mobile: ",i?"Yes":"No"]}),a.jsxs("p",{children:["Ethereum: ",o?"Detected":"Not detected"]}),a.jsxs("p",{children:["MetaMask: ",c?"Yes":"No"]}),a.jsxs("p",{children:["Trust Wallet: ",l?"Yes":"No"]}),a.jsxs("p",{children:["User Agent: ",navigator.userAgent.slice(0,50),"..."]})]})]}),a.jsx("p",{className:"text-xs text-blue-400 text-center mt-2",children:" Connection modal will open - approve in your wallet app"}),a.jsx("p",{className:"text-xs text-yellow-400 text-center mt-1",children:" Only BNB Smart Chain (BSC) network supported"}),a.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:" Connection may take up to 60 seconds"})]})]})})})},yIe=({isOpen:t,onClose:e,onReviewSubmitted:n,userAddress:r})=>{const[s,i]=A.useState(0),[o,c]=A.useState(0),[l,d]=A.useState(""),[u,h]=A.useState(!1),f=async()=>{if(s===0){U.error("Please provide a rating");return}if(!r){U.error("User address not found. Please reconnect your wallet.");return}h(!0);try{const g=localStorage.getItem("authToken")||"",y=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({reviewee_address:r,rating:s,message:l.trim()||void 0})});if(y.ok)U.success("Thank you for your feedback! Your review helps us improve."),n(),e(),i(0),d("");else{const x=await y.json();U.error(x.error||"Failed to submit review")}}catch(g){console.error("Error submitting review:",g),U.error("Failed to submit review")}finally{h(!1)}},p=()=>{u||(i(0),d(""),e())},m=(g,y)=>a.jsx("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(x=>a.jsx("button",{type:"button",onClick:()=>y(x),onMouseEnter:()=>c(x),onMouseLeave:()=>c(0),className:"focus:outline-none",children:a.jsx(xa,{size:32,className:x<=(o||g)?"text-yellow-400 fill-current":"text-gray-400"})},x))});return a.jsx(Do,{children:t&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:p,children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:g=>g.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center",children:a.jsx(xa,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Review Our Platform"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Share your experience with Zotrust"}),a.jsx("p",{className:"text-blue-400 text-xs mt-1",children:"How was your experience on our platform?"})]})]}),a.jsx("button",{onClick:p,disabled:u,className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors disabled:opacity-50",children:a.jsx(en,{size:20})})]}),a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"How would you rate our platform?"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[m(s,i),a.jsx("span",{className:"text-gray-400 text-sm",children:s>0&&`${s} star${s>1?"s":""}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Share your feedback (optional)"}),a.jsx("textarea",{value:l,onChange:g=>d(g.target.value),placeholder:"Tell us about your experience with Zotrust platform...",rows:4,maxLength:500,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),a.jsxs("div",{className:"flex justify-between items-center mt-2",children:[a.jsxs("p",{className:"text-gray-500 text-xs",children:[l.length,"/500 characters"]}),a.jsx("p",{className:"text-gray-500 text-xs",children:"Review will be visible after admin approval"})]})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:p,disabled:u,className:"flex-1 py-3 px-4 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors disabled:opacity-50",children:"Cancel"}),a.jsx("button",{onClick:f,disabled:u||s===0,className:"flex-1 py-3 px-4 rounded-lg bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-medium hover:from-yellow-600 hover:to-orange-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),a.jsx("span",{children:"Submitting..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(xa,{size:16}),a.jsx("span",{children:"Submit Review"})]})})]})]})]})})})},wIe=()=>{const[t,e]=A.useState(!1),[n,r]=A.useState(!0),[s,i]=A.useState([]),[o,c]=A.useState(null),[l,d]=A.useState(!1),[u,h]=A.useState(!1),[f,p]=A.useState(!1),[m,g]=A.useState(!1),[y,x]=A.useState({isOpen:!1,supportUrl:""}),w=A.useRef(!1),b=A.useRef(null),{address:v,isConnected:E,balance:k,chainId:C,isConnecting:S,isUpdatingBalances:N,connectionError:I,connect:F,disconnect:P,updateBalances:H,clearError:z,switchToNetwork:T,debugWalletDetection:_,connectMetaMask:L,connectTrustWallet:O}=Xt(),{user:M,refreshUserProfile:B}=ss(),W=ds(),Z=Lx.useCallback(async()=>{d(!0);try{const q=await fetch("/api/reviews/all");if(q.ok){const Ae=await q.json();i(Ae.data)}const ue=await fetch("/api/reviews/stats/total");if(ue.ok){const Ae=await ue.json();c(Ae.data)}}catch(q){console.error("Error fetching reviews:",q)}finally{d(!1)}},[]);A.useEffect(()=>{if(E&&v){if(r(!1),b.current!==v&&!N){const ue=setTimeout(()=>{console.log(" Dashboard: Fetching balances for connected wallet..."),H()},500);return b.current=v,()=>clearTimeout(ue)}}else{const q=setTimeout(()=>{r(!1)},2e3);return()=>clearTimeout(q)}},[E,v,N,H]),A.useEffect(()=>{E&&v&&b.current!==v&&(console.log(" Dashboard: Wallet connected, refreshing user profile..."),B())},[E,v,B]),A.useEffect(()=>{w.current||(w.current=!0,Z())},[Z]);const ie=async()=>{if(E)P();else if(window.ethereum){const q=window.ethereum.isMetaMask,ue=window.ethereum.isTrust||window.ethereum.isTrustWallet;try{ue?await ae():q?await oe():await oe()}catch(Ae){console.error("Auto-connect failed:",Ae),e(!0)}}else e(!0)},ae=async()=>{try{await O(),C!==56&&await T(56),U.success("Trust Wallet connected successfully!")}catch(q){console.error("Trust Wallet connection error:",q),U.error(q.message||"Failed to connect Trust Wallet")}},oe=async()=>{try{await L(),C!==56&&await T(56),U.success("MetaMask connected successfully!")}catch(q){console.error("MetaMask connection error:",q),U.error(q.message||"Failed to connect MetaMask")}},Ne=async q=>{try{q==="metamask"?await oe():q==="trustwallet"?await ae():await F(q),e(!1)}catch(ue){console.error("Wallet connection failed:",ue)}},de=()=>{E&&H(!0)},_e=()=>{z()},Ue=()=>{switch(C){case 56:return"BSC Mainnet";case 1:return"Ethereum Mainnet";default:return`Network ${C}`}},ee=()=>C===56;return n?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-500"}),a.jsx("p",{className:"text-gray-300",children:"Restoring wallet..."})]})}):a.jsxs("div",{className:" space-y-4 max-w-sm mx-auto",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl mt-3 font-bold text-white",children:"Zotrust"}),M&&a.jsxs("div",{className:"bg-violet-500/20 backdrop-blur-lg rounded-lg p-2 border border-violet-500/30 mt-2",children:[a.jsxs("p",{className:"text-xs text-violet-200",children:["Welcome, ",a.jsx("span",{className:"text-white font-medium",children:M.name||"User"})]}),M.verified&&a.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-1",children:[a.jsx(kt,{size:12,className:"text-violet-400"}),a.jsx("span",{className:"text-xs text-violet-400",children:"Verified"})]})]}),a.jsxs("div",{className:"mt-2 space-x-2",children:[a.jsx(zd,{to:"/benefits",className:"inline-block text-[11px] text-violet-300 hover:text-violet-200 underline underline-offset-2",children:"View platform benefits"}),a.jsx("span",{className:"text-[11px] text-violet-500",children:""}),a.jsx(zd,{to:"/guide",className:"inline-block text-[11px] text-violet-300 hover:text-violet-200 underline underline-offset-2",children:"User guide"}),a.jsx("span",{className:"text-[11px] text-violet-500",children:""}),a.jsx("button",{onClick:()=>g(!0),className:"inline-block text-[11px] text-violet-300 hover:text-violet-200 underline underline-offset-2",children:"Watch demo video"})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-violet-500/20 to-purple-500/20 border border-violet-500/30 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"pr-2",children:[a.jsx("h3",{className:"text-white font-semibold text-base",children:"Why trade with Zotrust?"}),a.jsxs("ul",{className:"mt-1 text-[11px] text-violet-200 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"No bank freeze risk, no middlemen"}),a.jsx("li",{children:"Smartcontract escrow, low fees"}),a.jsxs("li",{children:[a.jsx("span",{className:"font-bold underline px-2 py-0.5 rounded-md ",children:"Cash to USDT"})," ",""," ",a.jsx("span",{className:" underline font-bold px-2 py-0.5 rounded-md",children:"USDT to Cash"}),", global access"]})]})]}),a.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[a.jsx(zd,{to:"/benefits",className:"px-3 py-1 rounded-lg text-xs bg-violet-600 hover:bg-violet-700 text-white transition-colors",children:"View Benefits"}),a.jsx(zd,{to:"/guide",className:"px-3 py-1 rounded-lg text-xs bg-white/10 hover:bg-white/20 text-violet-100 border border-white/10 transition-colors",children:"Read Guide"}),a.jsxs("p",{onClick:()=>g(!0),className:"px-3 py-1 rounded-lg text-center text-xs cursor-pointer bg-white/10 hover:bg-white/20 text-violet-100 border border-white/10 transition-colors",children:["Platform Guide Video ",a.jsx(fl,{className:"w-4 h-4 inline-block"})]})]})]})}),m&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:a.jsxs("div",{className:"w-full max-w-md mx-auto bg-slate-900 border border-white/10 rounded-xl overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-white/10",children:[a.jsx("h3",{className:"text-sm font-semibold text-white",children:"Platform Demo"}),a.jsx("button",{onClick:()=>g(!1),className:"text-gray-300 hover:text-white",children:a.jsx(en,{size:18})})]}),a.jsx("div",{className:"bg-black",children:a.jsx("video",{controls:!0,playsInline:!0,className:"w-full h-64 bg-black",src:"/api/videos/stream/demo"})}),a.jsxs("div",{className:"p-3 flex items-center justify-end gap-2",children:[a.jsx("a",{href:"/api/videos/stream/demo",target:"_blank",rel:"noopener noreferrer",className:"text-xs px-3 py-1 rounded-lg bg-violet-600 hover:bg-violet-700 text-white",children:"Open in new tab"}),a.jsx("button",{onClick:()=>g(!1),className:"text-xs px-3 py-1 rounded-lg bg-white/10 hover:bg-white/20 text-gray-200 border border-white/10",children:"Close"})]})]})}),E&&M&&a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:`p-3 rounded-lg border flex items-center space-x-2 ${M.verified?"bg-violet-500/20 border-violet-500/30":"bg-yellow-500/20 border-yellow-500/30"}`,children:[M.verified?a.jsx(kt,{size:16,className:"text-violet-400"}):a.jsx(qt,{size:16,className:"text-yellow-400"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:`font-medium text-sm ${M.verified?"text-violet-300":"text-yellow-300"}`,children:M.verified?"Verified":"Not Verified"}),a.jsx("p",{className:`text-xs ${M.verified?"text-violet-400":"text-yellow-400"}`,children:M.verified?"Can access P2P trading":"Complete profile to trade"})]})]}),I&&a.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Connection Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:I})]}),a.jsx("button",{onClick:_e,className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),a.jsxs("div",{className:`backdrop-blur-lg rounded-lg p-4 border ${E?"bg-gradient-to-r from-violet-500/20 to-purple-500/20 border-violet-500/30":"bg-gradient-to-r from-orange-500/20 to-red-500/20 border-orange-500/30"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h2",{className:"text-base font-bold text-white",children:E?"Wallet Connected":"Connect Wallet"}),E&&a.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${ee()?"bg-violet-500/20 text-violet-300":"bg-red-500/20 text-red-300"}`,children:[Ue(),!ee()&&" (Switch to BSC Mainnet)"]})]}),E?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{className:"text-gray-300 text-sm",children:["Address: ",v==null?void 0:v.slice(0,6),"...",v==null?void 0:v.slice(-4)]}),!ee()&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:" Wrong Network"}),a.jsx("p",{className:"text-red-400 text-xs",children:C===1?"Connected to Ethereum Mainnet":C===56?"Connected to BSC Mainnet":`Connected to Network ${C}`}),a.jsx("p",{className:"text-red-400 text-xs mt-1",children:"Please switch to BSC Mainnet"})]}),a.jsx("button",{onClick:()=>T(56),className:"w-full bg-orange-500/20 hover:bg-orange-500/30 text-orange-300 py-2 px-4 rounded-lg font-medium transition-colors",children:"Switch to BSC Mainnet"})]}),a.jsx("button",{onClick:ie,className:"w-full bg-red-500/20 hover:bg-red-500/30 text-red-300 py-2 px-4 rounded-lg font-medium transition-colors",children:"Disconnect Wallet"})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-gray-300 text-sm",children:"Connect your wallet to start trading"}),window.ethereum&&a.jsxs("div",{className:"space-y-2",children:[(window.ethereum.isMetaMask||!window.ethereum.isTrust)&&a.jsx("button",{onClick:oe,disabled:S,className:"w-full bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white py-2 px-3 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center space-x-2",children:S?a.jsxs(a.Fragment,{children:[a.jsx(sr,{className:"animate-spin",size:14}),a.jsx("span",{children:"Connecting..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Connect MetaMask"})]})}),(window.ethereum.isTrust||window.ethereum.isTrustWallet)&&a.jsx("button",{onClick:ae,disabled:S,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-2 px-3 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center space-x-2",children:S?a.jsxs(a.Fragment,{children:[a.jsx(sr,{className:"animate-spin",size:14}),a.jsx("span",{children:"Connecting..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Connect Trust Wallet"})]})})]}),a.jsx("button",{onClick:ie,disabled:S,className:"w-full bg-gradient-to-r from-violet-500 to-purple-500 text-white py-2 px-3 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center space-x-2",children:S?a.jsxs(a.Fragment,{children:[a.jsx(sr,{className:"animate-spin",size:14}),a.jsx("span",{children:"Connecting..."})]}):a.jsx("span",{children:"Connect Wallet"})}),a.jsx("button",{onClick:()=>{const q=_();console.log(" Mobile Wallet Debug Info:",q),U.success("Debug info logged to console")},className:"w-full bg-gray-500/20 hover:bg-gray-500/30 text-gray-300 py-2 px-4 rounded-lg font-medium transition-colors text-sm",children:" Debug Wallet Detection"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-base font-semibold text-white",children:"Balances"}),a.jsx("button",{onClick:de,disabled:!E||N,className:"p-1.5 rounded-lg bg-violet-500/20 text-violet-300 hover:bg-violet-500/30 transition-colors disabled:opacity-50",children:a.jsx(Ji,{size:14,className:N?"animate-spin":""})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-violet-200 text-xs font-medium",children:"BNB"}),a.jsx(Lb,{size:14,className:"text-violet-400"})]}),a.jsx("p",{className:"text-white font-bold text-base",children:E?`${parseFloat(k.bnb||"0").toFixed(4)}`:"0.0000"})]}),a.jsxs("div",{className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-violet-200 text-xs font-medium",children:"USDT"}),a.jsx(Lb,{size:14,className:"text-violet-400"})]}),a.jsx("p",{className:"text-white font-bold text-base",children:E?`${parseFloat(k.usdt||"0").toFixed(4)}`:"0.0000"})]}),a.jsxs("div",{className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-violet-200 text-xs font-medium",children:"USDC"}),a.jsx(BY,{size:14,className:"text-violet-400"})]}),a.jsx("p",{className:"text-white font-bold text-base",children:E?`${parseFloat(k.wbnb||"0").toFixed(4)}`:"0.0000"})]})]}),!E&&a.jsx("div",{className:"text-center py-1",children:a.jsx("p",{className:"text-violet-300 text-xs",children:"Connect wallet to view balances"})})]}),a.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-lg space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center space-x-2",children:[a.jsx(xa,{className:"w-5 h-5 text-yellow-500 fill-yellow-500"}),a.jsx("span",{children:"Reviews"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>p(!f),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${f?"bg-violet-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:f?"Approved":"All"}),a.jsxs("button",{onClick:()=>{if(!v){U.error("Please connect your wallet first");return}h(!0)},className:"bg-violet-600 hover:bg-violet-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors flex items-center space-x-1.5",children:[a.jsx(Wx,{size:14}),a.jsx("span",{children:"Add Review"})]})]})]}),o&&a.jsx("div",{className:"bg-gradient-to-r from-violet-50 to-purple-50 rounded-lg p-4 border border-violet-200",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o.total_reviews}),a.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Total Reviews"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center items-center space-x-1 mb-1",children:Array.from({length:5},(q,ue)=>a.jsx(xa,{size:16,className:ue<Math.round(parseFloat(o.average_rating))?"text-yellow-500 fill-yellow-500":"text-gray-300"},ue))}),a.jsxs("div",{className:"text-sm font-semibold text-gray-800",children:[o.average_rating," / 5.0"]}),a.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})]})}),a.jsx("div",{className:"max-h-96 overflow-y-auto space-y-3 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:l?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(sr,{className:"w-6 h-6 animate-spin mx-auto mb-3 text-violet-600"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Loading reviews..."})]}):s.length>0?s.filter(q=>f?q.is_approved:!0).map(q=>a.jsxs(X.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsx("div",{className:"flex items-center space-x-0.5",children:Array.from({length:5},(ue,Ae)=>a.jsx(xa,{size:14,className:Ae<q.rating?"text-yellow-500 fill-yellow-500":"text-gray-300"},Ae))}),a.jsxs("span",{className:"text-xs font-semibold text-gray-700",children:[q.rating,".0"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-800",children:q.reviewer_name||"Anonymous User"}),q.is_approved&&a.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-medium",children:" Verified"})]})]}),a.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap ml-2",children:new Date(q.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),q.comment&&a.jsx("p",{className:"text-sm text-gray-700 leading-relaxed mt-2",children:q.comment})]},q.id)):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Zd,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-700 font-medium text-sm",children:f?"No approved reviews yet":"No reviews yet"}),a.jsx("p",{className:"text-gray-500 text-xs mt-1",children:f?"Reviews are pending admin approval":"Be the first to share your experience!"})]})})]}),a.jsxs("div",{className:"bg-violet-500/20 border-violet-500/30 text-violet-300 p-3 rounded-lg border flex items-center space-x-2",children:[a.jsx(kt,{size:16,className:"text-violet-400"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-xs font-medium",children:"System: Online"}),a.jsx("p",{className:"text-xs opacity-80",children:"All services operational"})]})]}),a.jsxs("button",{onClick:()=>{if(!E||!v){U.error("Please connect your wallet first",{duration:3e3,icon:""}),e(!0);return}if(!M||!M.verified){U.error("Please complete your profile verification first",{duration:4e3,icon:""}),W("/profile");return}const ue=`${window.location.origin}/support-call/${v}`;x({isOpen:!0,supportUrl:ue})},className:"w-full bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-500/30 rounded-lg p-4 flex items-center justify-between hover:from-green-500/30 hover:to-emerald-500/30 transition-all group",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center",children:a.jsx(dn,{size:20,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-semibold text-sm",children:"Support Call"}),a.jsx("p",{className:"text-green-300 text-xs",children:!E||!v?"Connect wallet to call":!M||!M.verified?"Verify profile to call":"Get help from admin"})]})]}),a.jsx(Lb,{size:16,className:"text-green-400 group-hover:text-green-300 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]}),a.jsxs("button",{onClick:()=>{if(!E||!v){U.error("Please connect your wallet first",{duration:3e3,icon:""}),e(!0);return}W("/chat")},className:"w-full bg-gradient-to-r from-blue-500/20 to-cyan-500/20 border border-blue-500/30 rounded-lg p-4 flex items-center justify-between hover:from-blue-500/30 hover:to-cyan-500/30 transition-all group",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center",children:a.jsx(Zd,{size:20,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-semibold text-sm",children:"Chat Support"}),a.jsx("p",{className:"text-blue-300 text-xs",children:!E||!v?"Connect wallet to chat":"Chat with admin support"})]})]}),a.jsx(Lb,{size:16,className:"text-blue-400 group-hover:text-blue-300 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]}),a.jsx(gIe,{isOpen:t,onClose:()=>e(!1),onWalletSelect:Ne}),v&&a.jsx(yIe,{isOpen:u,onClose:()=>h(!1),onReviewSubmitted:Z,userAddress:v}),y.isOpen&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>x({isOpen:!1,supportUrl:""}),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:q=>q.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center",children:a.jsx(dn,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Support Call"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Copy URL to Browser"})]})]}),a.jsx("button",{onClick:()=>x({isOpen:!1,supportUrl:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:a.jsx(en,{size:20})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4",children:a.jsx("p",{className:"text-sm text-blue-300 text-center",children:"Copy and paste in browser to make support call"})}),a.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/10",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Support Call URL"}),a.jsx("p",{id:"support-url-display",className:"text-sm font-mono text-white break-all bg-black/20 p-3 rounded border border-white/10 select-all cursor-text",style:{userSelect:"all",WebkitUserSelect:"all"},onClick:q=>{const ue=document.createRange();ue.selectNodeContents(q.currentTarget);const Ae=window.getSelection();Ae==null||Ae.removeAllRanges(),Ae==null||Ae.addRange(ue)},children:y.supportUrl}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Tap to select, then copy manually"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(X.button,{onClick:async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(y.supportUrl),U.success("URL copied to clipboard! Copy and paste in browser.");else{const q=document.getElementById("support-url-display");if(q){const ue=document.createRange();ue.selectNodeContents(q);const Ae=window.getSelection();Ae==null||Ae.removeAllRanges(),Ae==null||Ae.addRange(ue),U("URL selected! Long press to copy",{icon:"",duration:3e3})}}}catch(q){console.error("Failed to copy:",q);const ue=document.getElementById("support-url-display");if(ue){const Ae=document.createRange();Ae.selectNodeContents(ue);const tt=window.getSelection();tt==null||tt.removeAllRanges(),tt==null||tt.addRange(Ae),U("URL selected! Long press to copy",{icon:"",duration:4e3})}else U.error("Please manually select and copy the URL")}},className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-center space-x-3 transition-all shadow-lg",whileTap:{scale:.98},children:[a.jsx(ll,{size:24}),a.jsx("span",{children:"Copy URL"})]}),a.jsx(X.button,{onClick:()=>{const q=document.getElementById("support-url-display");if(q){const ue=document.createRange();ue.selectNodeContents(q);const Ae=window.getSelection();Ae==null||Ae.removeAllRanges(),Ae==null||Ae.addRange(ue),U("URL selected! Long press to copy",{icon:"",duration:3e3})}},className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},children:a.jsx("span",{children:"Select URL (Manual Copy)"})}),a.jsx(X.a,{href:y.supportUrl,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},onClick:()=>{window.open(y.supportUrl,"_blank")},children:a.jsx("span",{children:"Open in Browser"})})]}),a.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 space-y-2",children:[a.jsx("p",{className:"text-sm text-yellow-300 text-center",children:" Copy the URL and paste it in your browser to make a support call"}),a.jsx("p",{className:"text-xs text-yellow-400 text-center",children:"If copy fails, tap the URL above to select it, then long press to copy"})]})]})]})})]})};var PU={};const xIe={chainId:56,name:"BNB Smart Chain",rpcUrl:"https://bsc-dataseed.binance.org/",blockExplorer:"https://bscscan.com"},XE={NETWORK:xIe,API_BASE_URL:PU.VITE_API_BASE_URL||"http://localhost:3000/api",WS_URL:PU.VITE_WS_URL||(typeof window<"u"&&window.location.protocol==="https:"?"wss://localhost:5000":"ws://localhost:5000"),ACCEPT_TIMEOUT_MINUTES:5,DEFAULT_LOCK_DURATION_HOURS:1,PLATFORM_FEE_PERCENT:2};function jV(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=jV(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function zn(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=jV(t))&&(r&&(r+=" "),r+=e);return r}const bIe=({isOpen:t,onClose:e,onSuccess:n})=>{const{user:r,agents:s,fetchAgents:i}=ss(),{isConnected:o,balance:c,updateBalances:l}=Xt(),[d,u]=A.useState(!1),[h,f]=A.useState({type:"BUY",token:"USDT",priceInr:"",minAmountInr:"500",maxAmountInr:"",sellQuantity:"",buyQuantity:"",lockDurationSeconds:XE.DEFAULT_LOCK_DURATION_HOURS*3600,selectedAgentIds:[]}),m=h.token==="USDT"?parseFloat(c.usdt||"0"):h.token==="USDC"?parseFloat(c.wbnb||"0"):0,g=s.filter(w=>{var b;return(b=r==null?void 0:r.selectedAgentIds)==null?void 0:b.includes(String(w.id))});A.useEffect(()=>{t&&i(),t&&o&&l()},[t,o,i,l]),A.useEffect(()=>{r!=null&&r.selectedAgentIds&&r.selectedAgentIds.length>0&&f(w=>({...w,selectedAgentIds:r.selectedAgentIds||[]}))},[r==null?void 0:r.selectedAgentIds]),A.useEffect(()=>{const w=h.type==="BUY"?h.buyQuantity:h.sellQuantity,b=h.priceInr;if(w&&b&&!isNaN(parseFloat(w))&&!isNaN(parseFloat(b))){const v=(parseFloat(w)*parseFloat(b)).toFixed(2);f(E=>({...E,maxAmountInr:v}))}},[h.buyQuantity,h.sellQuantity,h.priceInr,h.type]),A.useEffect(()=>{const w=h.maxAmountInr,b=h.priceInr;if(w&&b&&!isNaN(parseFloat(w))&&!isNaN(parseFloat(b))){const v=(parseFloat(w)/parseFloat(b)).toFixed(2);f(E=>({...E,minAmountInr:v}))}},[h.maxAmountInr,h.priceInr]),A.useEffect(()=>{f(w=>({...w,priceInr:"",minAmountInr:"500",maxAmountInr:"",sellQuantity:"",buyQuantity:""}))},[h.type,h.token]);const y=async w=>{if(w.preventDefault(),h.type==="SELL"&&!o){U.error("Please connect your wallet first to check your balance");return}if(!(r!=null&&r.verified)){U.error("Please verify your profile first");return}if(!h.selectedAgentIds||h.selectedAgentIds.length===0){U.error("Please select at least one agent");return}const b=parseFloat(h.priceInr);if(isNaN(b)||b<=0){U.error("Please enter valid price per token");return}let v,E;if(h.type==="SELL"){const C=parseFloat(h.sellQuantity);if(isNaN(C)||C<=0){U.error("Please enter valid sell quantity");return}if(C>m){U.error(`Insufficient balance. You only have ${m.toFixed(6)} ${h.token}`);return}const S=parseFloat(h.minAmountInr),N=parseFloat(h.maxAmountInr);if(isNaN(S)||S<=0||isNaN(N)||N<=0){U.error("Please enter valid min and max amounts in INR");return}if(S>N){U.error("Min amount cannot be greater than max amount");return}if(v=S/b,E=N/b,E>C){U.error(`Max amount (${E.toFixed(6)} ${h.token}) cannot exceed sell quantity (${C} ${h.token})`);return}}else{const C=parseFloat(h.buyQuantity);if(isNaN(C)||C<=0){U.error("Please enter valid buy quantity");return}const S=parseFloat(h.minAmountInr),N=parseFloat(h.maxAmountInr);if(isNaN(S)||S<=0||isNaN(N)||N<=0){U.error("Please enter valid min and max amounts in INR");return}if(S>N){U.error("Min amount cannot be greater than max amount");return}if(v=S/b,E=N/b,E>C){U.error(`Max amount (${E.toFixed(6)} ${h.token}) cannot exceed buy quantity (${C} ${h.token})`);return}}const k=localStorage.getItem("authToken");if(!k){U.error("Please login first");return}u(!0);try{const C={type:h.type,token:h.token,price_inr:b,min_amount:v,max_amount:E,sell_quantity:h.type==="SELL"?parseFloat(h.sellQuantity):null,buy_quantity:h.type==="BUY"?parseFloat(h.buyQuantity):null,lock_duration_seconds:h.lockDurationSeconds,city:(r==null?void 0:r.locationId)||"Mumbai",selected_agent_ids:h.selectedAgentIds},S=await fetch("/api/ads",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify(C)});if(S.ok)U.success("Ad created successfully!"),n(),f({type:"BUY",token:"USDT",priceInr:"",minAmountInr:"500",maxAmountInr:"",sellQuantity:"",buyQuantity:"",lockDurationSeconds:XE.DEFAULT_LOCK_DURATION_HOURS*3600,selectedAgentIds:(r==null?void 0:r.selectedAgentIds)||[]});else{let N="Failed to create ad";try{const I=await S.json();N=I.error||I.message||N}catch{}U.error(N)}}catch(C){console.error("Ad creation error:",C),U.error(C.message||"Failed to create ad")}finally{u(!1)}},x=(w,b)=>{f(v=>({...v,[w]:b}))};return a.jsx(Do,{children:t&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e,children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:zn("bg-slate-900 rounded-xl overflow-scroll h-[80vh] p-6 w-full max-w-md border-2",h.type==="BUY"?"border-green-500/50":"border-red-500/50"),onClick:w=>w.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Create New Ad"}),a.jsx("button",{onClick:e,className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:a.jsx(en,{size:20})})]}),!(r!=null&&r.verified)&&a.jsxs("div",{className:"mb-4 p-3 bg-yellow-500/20 border border-yellow-500/30 rounded-lg flex items-center space-x-2",children:[a.jsx(qt,{size:16,className:"text-yellow-400"}),a.jsx("p",{className:"text-yellow-300 text-sm",children:"Please verify your profile to create ads"})]}),a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Type"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:["BUY","SELL"].map(w=>a.jsx("button",{type:"button",onClick:()=>x("type",w),className:zn("py-2 px-4 rounded-lg font-medium transition-all",h.type===w?w==="BUY"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gradient-to-r from-red-500 to-pink-500 text-white":w==="BUY"?"bg-white/10 text-green-300 border border-green-500/30 hover:bg-green-500/10":"bg-white/10 text-red-300 border border-red-500/30 hover:bg-red-500/10"),children:w},w))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Token"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:["USDT","USDC"].map(w=>a.jsx("button",{type:"button",onClick:()=>x("token",w),className:zn("py-2 px-4 rounded-lg font-medium transition-all",h.token===w?"bg-white/20 text-white border border-white/30":"bg-white/10 text-gray-300 border border-white/20"),children:w},w))})]}),h.type==="SELL"&&a.jsx("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-purple-300 text-sm font-medium",children:" Available Balance"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-white font-bold text-lg",children:m.toFixed(6)}),a.jsx("span",{className:"text-purple-300",children:h.token}),a.jsx("button",{type:"button",onClick:()=>l(),className:"p-1 rounded bg-purple-500/20 hover:bg-purple-500/30 transition-colors",title:"Refresh balance",children:a.jsx("svg",{className:"w-3 h-3 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]})}),h.type==="SELL"&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-white mb-2",children:[" Quantity to Sell (",h.token,")"]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",step:"0.000001",value:h.sellQuantity,onChange:w=>x("sellQuantity",w.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-20 py-3 text-white text-lg placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"0.02",max:m,required:!0}),a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:a.jsx("button",{type:"button",onClick:()=>x("sellQuantity",m.toString()),className:"text-blue-400 hover:text-blue-300 text-xs font-medium",children:"MAX"})})]}),a.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Available: ",m.toFixed(6)," ",h.token]}),parseFloat(h.sellQuantity)>m&&a.jsxs("p",{className:"mt-1 text-xs text-red-400",children:[" Insufficient balance! You only have ",m.toFixed(6)," ",h.token]})]}),h.type==="BUY"&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-white mb-2",children:[" Quantity to Buy (",h.token,")"]}),a.jsx("div",{className:"relative",children:a.jsx("input",{type:"number",step:"0.000001",value:h.buyQuantity,onChange:w=>x("buyQuantity",w.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-3 text-white text-lg placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"10.0",required:!0})})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-white mb-2",children:[" Price per 1 ",h.token]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",step:"0.01",value:h.priceInr,onChange:w=>x("priceInr",w.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-12 py-3 text-white text-lg placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"95",required:!0}),a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 font-medium",children:" INR"})]}),a.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Example: 1 ",h.token," = 95 INR"]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:" Order Limits ( INR)"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Min  INR"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",step:"0.01",value:h.minAmountInr,onChange:w=>x("minAmountInr",w.target.value),placeholder:"500",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-8 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",required:!0}),a.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 text-xs font-medium",children:""})]}),h.priceInr&&h.minAmountInr&&a.jsxs("p",{className:"mt-1 text-xs text-green-400",children:["= ",(parseFloat(h.minAmountInr)/parseFloat(h.priceInr)).toFixed(6)," ",h.token]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max  INR"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",step:"0.01",value:h.maxAmountInr,onChange:w=>x("maxAmountInr",w.target.value),placeholder:"5000",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-8 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",required:!0}),a.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 text-xs font-medium",children:""})]}),h.priceInr&&h.maxAmountInr&&a.jsxs("p",{className:"mt-1 text-xs text-green-400",children:["= ",(parseFloat(h.maxAmountInr)/parseFloat(h.priceInr)).toFixed(6)," ",h.token]})]})]}),h.type==="SELL"&&h.priceInr&&h.maxAmountInr&&h.sellQuantity&&(()=>{const w=parseFloat(h.maxAmountInr)/parseFloat(h.priceInr),b=parseFloat(h.sellQuantity);return w>b?a.jsxs("p",{className:"mt-2 text-xs text-yellow-400",children:[" Max limit (",w.toFixed(6)," ",h.token,") exceeds your sell quantity (",b.toFixed(6)," ",h.token,")"]}):null})(),h.type==="BUY"&&h.priceInr&&h.maxAmountInr&&h.buyQuantity&&(()=>{const w=parseFloat(h.maxAmountInr)/parseFloat(h.priceInr),b=parseFloat(h.buyQuantity);return w>b?a.jsxs("p",{className:"mt-2 text-xs text-yellow-400",children:[" Max limit (",w.toFixed(6)," ",h.token,") exceeds your buy quantity (",b.toFixed(6)," ",h.token,")"]}):null})()]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Agents (from your profile)"}),g.length===0?a.jsxs("div",{className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-gray-400",children:[a.jsx("p",{children:"No agents selected in your profile"}),a.jsx("p",{className:"text-sm",children:"Please select agents in your profile first"})]}):a.jsx("div",{className:"max-h-48 overflow-y-auto bg-white/10 border border-white/20 rounded-lg p-3 space-y-2",children:g.map(w=>{var b;return a.jsxs("label",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:((b=h.selectedAgentIds)==null?void 0:b.includes(String(w.id)))||!1,onChange:v=>{const E=String(w.id),k=h.selectedAgentIds||[];v.target.checked?x("selectedAgentIds",[...k,E]):x("selectedAgentIds",k.filter(C=>C!==E))},className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500 focus:ring-2"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-white font-medium truncate",children:w.branchName}),a.jsx("p",{className:"text-gray-300 text-sm truncate",children:w.locationName}),a.jsx("p",{className:"text-gray-400 text-xs truncate",children:w.mobile}),w.address&&a.jsx("p",{className:"text-gray-400 text-xs truncate",children:w.address})]}),a.jsx("div",{className:"flex-shrink-0",children:w.verified?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-400",children:" Verified"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-500/20 text-yellow-400",children:" Unverified"})})]},w.id)})}),h.selectedAgentIds&&h.selectedAgentIds.length>0&&a.jsxs("div",{className:"mt-2 p-2 bg-blue-500/20 border border-blue-500/30 rounded-lg",children:[a.jsxs("p",{className:"text-blue-300 text-sm font-medium",children:["Selected Agents (",h.selectedAgentIds.length,"):"]}),a.jsx("div",{className:"mt-1 space-y-1",children:h.selectedAgentIds.map(w=>{const b=g.find(v=>String(v.id)===w);return b?a.jsxs("p",{className:"text-blue-200 text-xs",children:[" ",b.branchName," - ",b.locationName]},w):null})})]})]}),a.jsx(X.button,{type:"submit",disabled:d||!(r!=null&&r.verified)||!h.selectedAgentIds||h.selectedAgentIds.length===0||h.type==="SELL"&&m===0,className:zn("w-full text-white py-3 px-4 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed",h.type==="BUY"?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-red-500 to-pink-500"),whileTap:{scale:.98},children:d?"Creating...":h.type==="SELL"&&m===0?`No ${h.token} to Sell`:"Create Ad"})]})]})})})},vIe=()=>{const[t,e]=A.useState("BUY"),[n,r]=A.useState("USDT"),[s,i]=A.useState([]),[o,c]=A.useState(!1),[l,d]=A.useState({isOpen:!1,ad:null}),[u,h]=A.useState(!1),[f,p]=A.useState(!1),[m,g]=A.useState(null),[y,x]=A.useState({isOpen:!1,ad:null}),[w,b]=A.useState(""),[v,E]=A.useState(""),[k,C]=A.useState(null),[S,N]=A.useState(null),[I,F]=A.useState({buyEnabled:!0,sellEnabled:!0,startTime:"09:00",endTime:"18:00"}),{user:P,refreshUserProfile:H}=ss(),{isConnected:z,address:T,connectionError:_,clearError:L}=Xt();A.useEffect(()=>{z&&(P!=null&&P.selectedAgentIds)&&P.selectedAgentIds.length>0&&M()},[t,n,z,P==null?void 0:P.selectedAgentIds]),A.useEffect(()=>{z&&T&&P&&(console.log(" P2P: Wallet connected, refreshing user profile..."),H())},[z,T,H]);const O=async()=>{try{const ee=await fetch("/api/admin/trading-hours");if(ee.ok){const q=await ee.json();q.success&&q.data&&F(q.data)}}catch(ee){console.error("Error fetching trading hours:",ee)}};A.useEffect(()=>{O()},[]);const M=async()=>{if(!f){p(!0),h(!0),C(null);try{const ee=localStorage.getItem("authToken");if(!ee){if(z&&T&&window.ethereum){console.log(" P2P: No token but wallet connected, attempting auto-login...");try{const q="Sign this message to authenticate with Zotrust",ue=await window.ethereum.request({method:"personal_sign",params:[q,T]}),{loginWithWallet:Ae}=ss.getState();if(await Ae(T,ue,q)){const me=localStorage.getItem("authToken");if(me)return B(me)}}catch(q){console.error("Auto-login failed:",q)}}C("Please login first"),i([]);return}await B(ee)}catch(ee){console.error("Failed to fetch ads:",ee),C("Failed to load ads"),i([])}finally{h(!1),p(!1)}}},B=async ee=>{try{const ue=await fetch(`/api/ads?type=${t==="BUY"?"SELL":"BUY"}&token=${n}&limit=20`,{headers:{Authorization:`Bearer ${ee}`}});if(ue.ok){const Ae=await ue.json();if(Ae.success){let tt=(Ae.data||[]).map(me=>({id:me.id.toString(),ownerAddress:me.owner_address,ownerSelectedAgentIds:me.selected_agent_ids||[],owner_name:me.owner_name||"",owner_verified:me.owner_verified||!1,type:me.type,token:me.token,priceInr:me.price_inr.toString(),minAmount:me.min_amount.toString(),maxAmount:me.max_amount.toString(),sellQuantity:me.sell_quantity?me.sell_quantity.toString():null,buyQuantity:me.buy_quantity?me.buy_quantity.toString():null,lockDurationSeconds:me.lock_duration_seconds,city:me.city,active:me.active,createdAt:me.created_at,agent:me.agents&&me.agents.length>0?{id:me.agents[0].id.toString(),branchName:me.agents[0].branch_name,city:me.agents[0].city||me.city||"Mumbai",address:me.agents[0].address||"",mobile:me.agents[0].mobile||"",verified:me.agents[0].verified||!0,createdByAdmin:"1",createdAt:new Date().toISOString()}:void 0,agents:me.agents?me.agents.map(je=>({id:je.id.toString(),branchName:je.branch_name,city:je.city,address:je.address||"",mobile:je.mobile||"",verified:je.verified||!0,createdByAdmin:"1",createdAt:new Date().toISOString()})):[]}));T&&(tt=tt.filter(me=>{if(me.ownerAddress.toLowerCase()===T.toLowerCase()||!(P!=null&&P.selectedAgentIds)||P.selectedAgentIds.length===0)return!1;if(me.type==="SELL"){if(me.sellQuantity!==null&&parseFloat(me.sellQuantity)<=0)return!1}else if(me.type==="BUY"&&me.buyQuantity!==null&&parseFloat(me.buyQuantity)<=0)return!1;return!0})),i(tt)}else C(Ae.error||"Failed to load ads"),i([])}else ue.status===401?C("Session expired. Please login again."):C("Failed to load ads"),i([])}catch(q){console.error("Failed to fetch ads:",q),C("Failed to load ads"),i([])}},W=async(ee,q)=>{if(g(ee.id),N(null),ee.type==="BUY"&&!I.sellEnabled){N("SELL trading is currently disabled. Please try again later."),g(null);return}if(ee.type==="SELL"&&!I.buyEnabled){N("BUY trading is currently disabled. Please try again later."),g(null);return}try{const ue=localStorage.getItem("authToken");if(!ue){N("Please login first");return}const Ae=Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Calcutta",tt=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ue}`},body:JSON.stringify({ad_id:ee.id,amount:parseFloat(q),selected_agent_id:v,timezone:Ae})});if(tt.ok){const me=await tt.json();me.success?(U.success("Order created successfully"),M()):N(me.error||"Failed to create order")}else{const me=await tt.json();N(me.error||"Failed to create order")}}catch(ue){console.error("Order creation error:",ue),N("Failed to create order")}finally{g(null)}},Z=ee=>{d({isOpen:!0,ad:ee})},ie=ee=>{oe(ee).disabled||(x({isOpen:!0,ad:ee}),b(""),ee.agents&&ee.agents.length>0?E(ee.agents[0].id):ee.agent?E(ee.agent.id):E(""))},ae=()=>{if(!y.ad)return;const ee=parseFloat(w),q=parseFloat(y.ad.minAmount),ue=parseFloat(y.ad.maxAmount);if(isNaN(ee)){U.error("Please enter a valid amount");return}if(ee<q||ee>ue){U.error(`Quantity must be between ${q.toFixed(2)} and ${ue.toFixed(2)} ${y.ad.token}`);return}W(y.ad,w),x({isOpen:!1,ad:null}),b("")},oe=ee=>(T==null?void 0:T.toLowerCase())===ee.ownerAddress.toLowerCase()?{text:"Your Ad",disabled:!0,className:"bg-gray-500/20 text-gray-400 cursor-not-allowed",action:null}:ee.type==="BUY"?{text:"Sell",disabled:!1,className:"bg-gradient-to-r from-pink-500 to-red-500 text-white hover:from-red-600 hover:to-pink-600",action:"sell"}:{text:"Buy",disabled:!1,className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white hover:from-green-600 hover:to-emerald-600",action:"buy"},Ne=!!(P!=null&&P.verified),de=!!(P!=null&&P.selectedAgentIds&&P.selectedAgentIds.length>0),_e=Ne&&de,Ue=!de||!Ne;return a.jsxs("div",{className:"p-3 sm:p-6 space-y-4 sm:space-y-6",children:[a.jsxs("div",{className:"text-center space-y-1",children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white",children:"P2P Trading"}),a.jsx("p",{className:"text-gray-300 text-xs sm:text-sm",children:"BNB Smart Chain"})]}),(!I.buyEnabled||!I.sellEnabled)&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Trading Disabled"}),a.jsx("p",{className:"text-red-400 text-xs",children:!I.buyEnabled&&!I.sellEnabled?"Both BUY and SELL trading are currently disabled.":I.buyEnabled?"SELL trading is currently disabled.":"BUY trading is currently disabled."})]})]}),_&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Connection Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:_})]}),a.jsx("button",{onClick:L,className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),k&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Load Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:k})]}),a.jsx("button",{onClick:()=>C(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),S&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Order Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:S})]}),a.jsx("button",{onClick:()=>N(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-lg p-1 border border-white/20",children:a.jsx("div",{className:"grid grid-cols-2 gap-1",children:["BUY","SELL"].map(ee=>a.jsx(X.button,{onClick:()=>e(ee),className:zn("py-2 px-3 sm:py-3 sm:px-4 rounded-md font-medium transition-all text-sm sm:text-base",t===ee?ee==="BUY"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gradient-to-r from-red-500 to-pink-500 text-white":ee==="BUY"?"text-green-300 hover:text-green-200 hover:bg-green-500/10":"text-red-300 hover:text-red-200 hover:bg-red-500/10"),whileTap:{scale:.98},children:ee},ee))})}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"flex space-x-1 sm:space-x-2",children:["USDT","USDC"].map(ee=>a.jsx(X.button,{onClick:()=>r(ee),className:zn("px-3 py-1.5 sm:px-4 sm:py-2 rounded-md font-medium transition-all text-sm",n===ee?"bg-white/20 text-white border border-white/30":"bg-white/10 text-gray-300 border border-white/10"),whileTap:{scale:.95},children:ee},ee))}),a.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[a.jsx(X.button,{onClick:M,disabled:u,className:"p-1.5 sm:p-2 rounded-md bg-white/10 text-white hover:bg-white/20 disabled:opacity-50",whileTap:{scale:.95},children:u?a.jsx(sr,{size:14,className:"animate-spin sm:w-4 sm:h-4"}):a.jsx(Ji,{size:14,className:"sm:w-4 sm:h-4"})}),_e&&a.jsxs(X.button,{onClick:()=>c(!0),className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white px-3 py-1.5 sm:px-4 sm:py-2 rounded-md flex items-center space-x-1.5 sm:space-x-2",whileTap:{scale:.95},children:[a.jsx(Wx,{size:14,className:"sm:w-4 sm:h-4"}),a.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Create Ad"})]})]})]}),Ue&&a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 space-y-4",children:[a.jsx("div",{className:"w-16 h-16 bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto",children:a.jsx(bI,{size:32,className:"text-yellow-400"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Profile Verification Required"}),a.jsx("p",{className:"text-gray-300 text-sm max-w-xs mx-auto",children:"Profile verify karein aur ek agent select karein  tabhi aapko local P2P ads dikhengi."})]}),a.jsx(X.button,{onClick:()=>c(!0),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white py-2 px-6 rounded-lg",whileTap:{scale:.98},children:"Complete Profile"})]}),!Ue&&a.jsx("div",{className:"space-y-4",children:a.jsx(Do,{children:u?a.jsx("div",{className:"space-y-4",children:[1,2,3].map(ee=>a.jsxs("div",{className:"bg-white/10 rounded-xl p-4 animate-pulse",children:[a.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-3 bg-white/20 rounded w-1/2"})]},ee))}):s.length===0?a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8 text-gray-400",children:a.jsxs("p",{children:["No ",t.toLowerCase()," ads available for ",n]})}):s.map(ee=>{var tt,me,je,pe,ot,Tn,nt;const q=((me=(tt=ee.agents)==null?void 0:tt[0])==null?void 0:me.city)||((je=ee.agent)==null?void 0:je.city)||ee.city,ue=ee.owner_name||"",Ae=ee.type==="BUY"?ee.buyQuantity||ee.maxAmount:ee.sellQuantity||ee.maxAmount;return a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white/5 backdrop-blur-lg rounded-lg p-3 border border-white/10 hover:border-white/20 transition-all",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-7 h-7 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-xs",children:ue.charAt(0).toUpperCase()}),a.jsxs("div",{className:"flex items-center space-x-1.5",children:[a.jsx("p",{className:"text-white font-medium text-xs",children:ue}),ee.owner_verified&&a.jsx("div",{title:"Verified User",className:"flex items-center",children:a.jsx(K2,{size:12,className:"text-blue-400 flex-shrink-0"})})]})]}),a.jsx("span",{className:zn("px-2 py-0.5 rounded-full text-[10px] font-bold",ee.type==="BUY"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:ee.type})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{children:a.jsxs("div",{className:"flex items-baseline space-x-1",children:[a.jsxs("span",{className:"text-xl font-bold text-white",children:["",parseFloat(ee.priceInr).toFixed(2)]}),a.jsxs("span",{className:"text-xs text-gray-400",children:["/",ee.token]})]})}),a.jsx("div",{className:"bg-blue-500/10 px-2 py-1 rounded",children:a.jsxs("p",{className:"text-blue-300 text-[10px] font-medium",children:["Qty: ",parseFloat(Ae).toFixed(2)," ",ee.token]})})]}),a.jsxs("div",{className:"flex items-center justify-between text-[10px] mb-2 bg-white/5 rounded p-1.5",children:[a.jsxs("span",{className:"text-gray-300",children:["Limit: ",(parseFloat(ee.minAmount)*parseFloat(ee.priceInr)).toLocaleString("en-IN",{maximumFractionDigits:0})," - ",(parseFloat(ee.maxAmount)*parseFloat(ee.priceInr)).toLocaleString("en-IN",{maximumFractionDigits:0})]}),a.jsxs("span",{className:"text-gray-400",children:[" ",Math.floor(ee.lockDurationSeconds/1800),"h"]})]}),a.jsxs("div",{className:"grid grid-cols-1 ",children:[a.jsxs("div",{className:"flex items-center justify-between ",children:[a.jsxs("div",{className:"text-gray-300 text-xs font-bold",children:["Aagnya Branch  ",a.jsxs("span",{className:"bg-blue-500/20 text-blue-300 px-2 py-1 rounded-full text-[10px] font-bold",children:[((pe=ee.agents)==null?void 0:pe.length)||1,((((ot=ee.agents)==null?void 0:ot.length)||1)>1,"")]})]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsxs("div",{className:zn("border rounded px-2 py-1",ee.type==="BUY"?"bg-red-500/10 border-red-500/20":"bg-green-500/10 border-green-500/20"),children:[a.jsx("span",{className:zn("text-[10px] font-medium",ee.type==="BUY"?"text-red-300":"text-green-300"),children:(ee.type==="BUY","Platform Fee")}),a.jsx("span",{className:zn("text-xs font-bold ml-2",ee.type==="BUY"?"text-red-400":"text-green-400"),children:ee.type==="BUY"?"1.0%":"0.8%"})]})})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"flex items-center space-x-2 ",children:a.jsxs("span",{className:"text-gray-400 text-[11px] font-extrabold",children:[" ",q]})}),a.jsxs("div",{className:"text-gray-500 text-[10px]",children:[((Tn=ee.agents)==null?void 0:Tn.length)||1," location",(((nt=ee.agents)==null?void 0:nt.length)||1)>1?"s":""," available"]})]})]}),a.jsxs("div",{className:"flex space-x-1.5",children:[(()=>{const mn=oe(ee),Ve=m===ee.id,rt=ee.type==="BUY"&&!I.sellEnabled||ee.type==="SELL"&&!I.buyEnabled,ht=mn.disabled||Ve||rt;return a.jsx(X.button,{onClick:()=>ie(ee),disabled:ht,className:zn("flex-1 py-2 px-3 rounded-lg font-semibold transition-all flex items-center justify-center space-x-1 text-xs",mn.className,ht&&"opacity-50 cursor-not-allowed"),whileTap:{scale:ht?1:.95},title:rt?`${ee.type==="BUY"?"SELL":"BUY"} trading is currently disabled`:void 0,children:Ve?a.jsxs(a.Fragment,{children:[a.jsx(sr,{size:14,className:"animate-spin"}),a.jsx("span",{children:"Creating..."})]}):a.jsx("span",{children:mn.text})})})(),a.jsx(X.button,{onClick:()=>Z(ee),className:"p-2 rounded-lg bg-blue-500/20 text-blue-400 border border-blue-500/30 hover:bg-blue-500/30 transition-all",whileTap:{scale:.95},children:a.jsx(PQ,{size:16})})]})]},ee.id)})})}),a.jsx(bIe,{isOpen:o,onClose:()=>c(!1),onSuccess:()=>{c(!1),M()}}),a.jsx(AN,{isOpen:l.isOpen,ad:l.ad,onClose:()=>d({isOpen:!1,ad:null})}),a.jsx(Do,{children:y.isOpen&&y.ad&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-2 sm:p-4",onClick:()=>x({isOpen:!1,ad:null}),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:zn("bg-slate-900 rounded-lg p-4 sm:p-6 w-full max-w-md border-2 max-h-[90vh] overflow-y-auto",y.ad.type==="BUY"?"border-red-500/50":"border-green-500/50"),onClick:ee=>ee.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[a.jsx("h3",{className:zn("text-lg sm:text-xl font-bold",y.ad.type==="BUY"?"text-red-400":"text-green-400"),children:y.ad.type==="BUY"?"Sell Request":"Buy Request"}),a.jsx("button",{onClick:()=>x({isOpen:!1,ad:null}),className:"p-1.5 sm:p-2 rounded-md bg-white/10 text-gray-400 hover:text-white transition-colors",children:a.jsx(en,{size:16,className:"sm:w-5 sm:h-5"})})]}),a.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[(!I.buyEnabled||!I.sellEnabled)&&a.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-md p-3",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(qt,{size:16,className:"text-red-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Trading Disabled"}),a.jsx("p",{className:"text-red-400 text-xs",children:!I.buyEnabled&&!I.sellEnabled?"Both BUY and SELL trading are currently disabled.":I.buyEnabled?"SELL trading is currently disabled.":"BUY trading is currently disabled."})]})]})}),a.jsxs("div",{className:"bg-white/5 rounded-md p-3 space-y-1 sm:space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-white font-semibold",children:["",y.ad.priceInr]}),a.jsx("span",{className:"text-gray-300 text-sm bg-white/10 px-2 py-1 rounded",children:y.ad.token})]}),a.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-md p-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-blue-300 text-sm font-medium",children:y.ad.type==="BUY"?"Want to Buy:":"Want to Sell:"}),a.jsx("span",{className:"text-blue-400 font-bold",children:y.ad.type==="BUY"?`${parseFloat(y.ad.buyQuantity||y.ad.maxAmount).toFixed(2)} ${y.ad.token}`:`${parseFloat(y.ad.sellQuantity||y.ad.maxAmount).toFixed(2)} ${y.ad.token}`})]}),a.jsxs("p",{className:"text-blue-200 text-xs mt-1",children:["Min: ",parseFloat(y.ad.minAmount).toFixed(2)," ",y.ad.token," | Max: ",parseFloat(y.ad.maxAmount).toFixed(2)," ",y.ad.token]})]}),a.jsxs("p",{className:"text-gray-300 text-sm",children:["Min: ",(parseFloat(y.ad.minAmount)*parseFloat(y.ad.priceInr)).toFixed(2)," | Max: ",(parseFloat(y.ad.maxAmount)*parseFloat(y.ad.priceInr)).toFixed(2)]}),a.jsx("p",{className:"text-gray-400 text-xs",children:"Lock Duration: 2 hours"})]}),(()=>{let ee=null;return y.ad.agents&&y.ad.agents.length>1&&v?ee=y.ad.agents.find(q=>q.id===v):y.ad.agent&&(ee=y.ad.agent),ee&&a.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-md p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),a.jsx("h4",{className:"text-blue-300 font-medium text-sm",children:"Selected Agent"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-white font-medium text-sm truncate",children:ee.branchName}),a.jsx("span",{className:"text-green-400 text-xs bg-green-500/20 px-1.5 py-0.5 rounded",children:" Verified"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-gray-400 text-xs",children:""}),a.jsx("span",{className:"text-gray-300 text-xs",children:ee.city})]}),ee.address&&a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-gray-400 text-xs",children:""}),a.jsx("span",{className:"text-gray-300 text-xs truncate",children:ee.address})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-gray-400 text-xs",children:""}),a.jsx("span",{className:"text-gray-300 text-xs",children:ee.mobile}),a.jsx("button",{onClick:()=>(ee==null?void 0:ee.mobile)&&window.open(`tel:${ee.mobile}`),className:"p-0.5 rounded bg-green-500/20 text-green-400 hover:bg-green-500/30 transition-colors",children:a.jsx(dn,{size:10})})]})]})]})]})})(),w&&parseFloat(w)>0&&a.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-md p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full"}),a.jsx("h4",{className:"text-yellow-300 font-medium text-sm",children:"Fee Calculation"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Order Amount:"}),a.jsxs("span",{className:"text-white font-medium",children:[w," ",y.ad.token]})]}),y.ad.type==="BUY"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Platform Fee (1.0%):"}),a.jsxs("span",{className:"text-red-400",children:["+",(parseFloat(w)*.01).toFixed(4)," ",y.ad.token]})]}),a.jsx("div",{className:"pt-2 border-t border-red-500/20",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-red-300 font-medium",children:"You need to lock:"}),a.jsxs("span",{className:"text-red-400 font-bold",children:[(parseFloat(w)*1.01).toFixed(4)," ",y.ad.token]})]})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-300",children:"Platform Fee (0.8%):"}),a.jsxs("span",{className:"text-green-400",children:["-",(parseFloat(w)*.008).toFixed(4)," ",y.ad.token]})]}),a.jsx("div",{className:"pt-2 border-t border-green-500/20",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-green-300 font-medium",children:"You will receive:"}),a.jsxs("span",{className:"text-green-400 font-bold",children:[(parseFloat(w)*.992).toFixed(4)," ",y.ad.token]})]})})]})]})]}),y.ad.agents&&y.ad.agents.length>1&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Agent"}),a.jsx("select",{value:v,onChange:ee=>E(ee.target.value),className:"w-full bg-white/10 border border-white/20 rounded-md px-3 py-2 text-white focus:outline-none focus:border-blue-500 text-sm",children:y.ad.agents.map(ee=>a.jsxs("option",{value:ee.id,className:"bg-slate-800",children:[ee.branchName," - ",ee.city]},ee.id))}),a.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Choose which agent you want to work with"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Qty (",y.ad.token,")"]}),a.jsx("input",{type:"number",value:w,onChange:ee=>b(ee.target.value),className:zn("w-full border rounded-md px-3 py-2 text-white placeholder-gray-400 focus:outline-none text-sm",w&&parseFloat(w)>parseFloat(y.ad.maxAmount)?"bg-red-500/10 border-red-500/50 focus:border-red-500":"bg-white/10 border-white/20 focus:border-blue-500"),placeholder:`Enter qty between ${parseFloat(y.ad.minAmount).toFixed(2)} - ${parseFloat(y.ad.maxAmount).toFixed(2)} ${y.ad.token}`,min:y.ad.minAmount,max:y.ad.maxAmount}),w&&parseFloat(w)>parseFloat(y.ad.maxAmount)&&a.jsxs("p",{className:"text-red-400 text-xs mt-1 flex items-center",children:[a.jsx("span",{className:"mr-1",children:""}),"Maximum quantity is ",parseFloat(y.ad.maxAmount).toFixed(2)," ",y.ad.token]}),w&&parseFloat(w)<parseFloat(y.ad.minAmount)&&parseFloat(w)>0&&a.jsxs("p",{className:"text-yellow-400 text-xs mt-1 flex items-center",children:[a.jsx("span",{className:"mr-1",children:""}),"Minimum quantity is ",parseFloat(y.ad.minAmount).toFixed(2)," ",y.ad.token]}),a.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["You will work with ",(()=>{var ee;if(y.ad.agents&&y.ad.agents.length>1){const q=y.ad.agents.find(ue=>ue.id===v);return q?q.branchName:"selected agent"}return((ee=y.ad.agent)==null?void 0:ee.branchName)||"agent"})()," agent for this ",y.ad.type==="BUY"?"sell":"buy"," request"]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(X.button,{onClick:()=>x({isOpen:!1,ad:null}),className:"flex-1 py-2 px-3 rounded-md bg-white/10 text-white hover:bg-white/20 transition-colors text-sm",whileTap:{scale:.98},children:"Cancel"}),a.jsx(X.button,{onClick:ae,disabled:!w||m===y.ad.id||parseFloat(w)>parseFloat(y.ad.maxAmount)||parseFloat(w)<parseFloat(y.ad.minAmount)||y.ad.type==="BUY"&&!I.sellEnabled||y.ad.type==="SELL"&&!I.buyEnabled,className:zn("flex-1 py-2 px-3 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed text-sm",y.ad.type==="BUY"?"bg-gradient-to-r from-red-500 to-pink-500":"bg-gradient-to-r from-green-500 to-emerald-500"),whileTap:{scale:.98},title:y.ad.type==="BUY"&&!I.sellEnabled?"SELL trading is currently disabled":y.ad.type==="SELL"&&!I.buyEnabled?"BUY trading is currently disabled":void 0,children:m===y.ad.id?"Creating...":y.ad.type==="BUY"?"Sell Request":"Buy Request"})]})]})]})})})]})},EIe=({orderId:t,userRole:e,orderState:n,timeRemaining:r,appealTimeRemaining:s,confirmations:i,dispute:o,appeals:c,onConfirmPayment:l,onFileAppeal:d})=>{const[u,h]=A.useState(!1),[f,p]=A.useState({dispute_type:"PAYMENT_NOT_RECEIVED",description:"",evidence_video_url:"",evidence_screenshots:[],evidence_documents:[]}),m=E=>{const k=Math.floor(E/36e5),C=Math.floor(E%(1e3*60*60)/(1e3*60)),S=Math.floor(E%(1e3*60)/1e3);return`${k}h ${C}m ${S}s`},y=n==="LOCKED"&&r>0?"PHASE_1":n==="UNDER_DISPUTE"&&s>0?"PHASE_2":n==="UNDER_REVIEW"?"PHASE_3":n==="RESOLVED"||n==="RELEASED"||n==="REFUNDED"?"PHASE_4":"UNKNOWN",x=()=>a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(Pr,{className:"h-6 w-6 text-blue-600 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Phase 1: Payment Confirmation"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",children:"Time Remaining:"}),a.jsx("span",{className:"text-lg font-bold text-blue-600",children:m(r)})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.max(0,r/(2*60*60*1e3)*100)}%`}})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Buyer Confirmation"}),a.jsxs("div",{className:"flex items-center mb-2",children:[i!=null&&i.buyer_confirmed?a.jsx(kt,{className:"h-5 w-5 text-green-600 mr-2"}):a.jsx(xr,{className:"h-5 w-5 text-red-600 mr-2"}),a.jsx("span",{children:i!=null&&i.buyer_confirmed?"Confirmed":"Pending"})]}),e==="BUYER"&&!(i!=null&&i.buyer_confirmed)&&a.jsx("button",{onClick:()=>l(t,"SENT"),className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Confirm Payment Sent"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Seller Confirmation"}),a.jsxs("div",{className:"flex items-center mb-2",children:[i!=null&&i.seller_confirmed?a.jsx(kt,{className:"h-5 w-5 text-green-600 mr-2"}):a.jsx(xr,{className:"h-5 w-5 text-red-600 mr-2"}),a.jsx("span",{children:i!=null&&i.seller_confirmed?"Confirmed":"Pending"})]}),e==="SELLER"&&!(i!=null&&i.seller_confirmed)&&a.jsx("button",{onClick:()=>l(t,"RECEIVED"),className:"w-full bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700",children:"Confirm Payment Received"})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Xd,{className:"h-5 w-5 text-yellow-600 mr-2"}),a.jsx("span",{className:"font-semibold text-yellow-800",children:"Important"})]}),a.jsx("p",{className:"text-yellow-700 text-sm",children:"Both parties must confirm within 2 hours. If not confirmed, the order will automatically move to dispute phase."})]})]}),w=()=>a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(Xd,{className:"h-6 w-6 text-orange-600 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-orange-900",children:"Phase 2: Appeal Window"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-medium",children:"Appeal Time Remaining:"}),a.jsx("span",{className:"text-lg font-bold text-orange-600",children:m(s)})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-orange-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.max(0,s/(48*60*60*1e3)*100)}%`}})})]}),a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Xd,{className:"h-5 w-5 text-red-600 mr-2"}),a.jsx("span",{className:"font-semibold text-red-800",children:"2 Hours Passed Without Full Confirmation"})]}),a.jsx("p",{className:"text-red-700 text-sm",children:"You have 48 hours to file an appeal if there's an issue with the payment."})]}),u?a.jsxs("div",{className:"bg-white rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold mb-4",children:"File Appeal"}),a.jsxs("form",{onSubmit:E=>{E.preventDefault(),d(t,f)},children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Dispute Type"}),a.jsxs("select",{value:f.dispute_type,onChange:E=>p({...f,dispute_type:E.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[a.jsx("option",{value:"PAYMENT_NOT_RECEIVED",children:"Payment Not Received"}),a.jsx("option",{value:"PAYMENT_NOT_SENT",children:"Payment Not Sent"}),a.jsx("option",{value:"OTHER",children:"Other Issue"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),a.jsx("textarea",{value:f.description,onChange:E=>p({...f,description:E.target.value}),placeholder:"Describe the issue in detail...",className:"w-full border border-gray-300 rounded-md px-3 py-2 h-24",required:!0})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Evidence Video URL (Optional)"}),a.jsx("input",{type:"url",value:f.evidence_video_url,onChange:E=>p({...f,evidence_video_url:E.target.value}),placeholder:"https://...",className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{type:"submit",className:"flex-1 bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700",children:"Submit Appeal"}),a.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:"Cancel"})]})]})]}):a.jsx("button",{onClick:()=>h(!0),className:"w-full bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700",children:"File Appeal"})]}),c.length>0&&a.jsxs("div",{className:"bg-white rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Existing Appeals"}),c.map(E=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 mb-2",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("span",{className:"font-medium",children:[E.appellant_type," Appeal"]}),a.jsx("span",{className:"text-sm text-gray-500",children:new Date(E.created_at).toLocaleString()})]}),a.jsx("p",{className:"text-sm text-gray-700",children:E.description}),E.evidence_video_url&&a.jsxs("div",{className:"mt-2",children:[a.jsx(fl,{className:"h-4 w-4 inline mr-1"}),a.jsx("a",{href:E.evidence_video_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm",children:"View Evidence Video"})]})]},E.id))]})]}),b=()=>a.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(ll,{className:"h-6 w-6 text-purple-600 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-purple-900",children:"Phase 3: Under Review"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Pr,{className:"h-5 w-5 text-purple-600 mr-2"}),a.jsx("span",{className:"font-medium",children:"Admin is reviewing your case"})]}),a.jsx("p",{className:"text-gray-700 text-sm",children:"Your dispute is being reviewed by our admin team. You will be notified once a decision is made."})]})]}),v=()=>a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(kt,{className:"h-6 w-6 text-green-600 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-green-900",children:"Phase 4: Resolved"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(kt,{className:"h-5 w-5 text-green-600 mr-2"}),a.jsx("span",{className:"font-medium",children:"Dispute Resolved"})]}),a.jsx("p",{className:"text-gray-700 text-sm",children:"The dispute has been resolved. Check your wallet for the final transaction."})]})]});return a.jsxs("div",{className:"space-y-4",children:[y==="PHASE_1"&&x(),y==="PHASE_2"&&w(),y==="PHASE_3"&&b(),y==="PHASE_4"&&v()]})};class CIe{constructor(){G(this,"provider",null);G(this,"signer",null);G(this,"contract",null)}async init(){try{const e=Xt.getState().walletType;console.log(" Initializing blockchain service with walletType:",e);let n;if(e==="walletconnect"){const i=ai;i.isInitialized||(console.log(" WalletConnect not initialized, initializing now..."),await i.initialize(),await new Promise(c=>setTimeout(c,1e3)));let o=i.getProvider();if(console.log(" WalletConnect provider from service:",o?"Found":"Not found"),!o){const c=i.appKit;if(c){console.log(" Trying to get provider from appKit...");const l=c.getWalletProvider();l?(o=new Dr(l),console.log(" Got WalletConnect provider from appKit")):console.warn(" appKit.getWalletProvider() returned null")}else console.warn(" appKit is not available")}if(!o){const c=i.isConnected();if(console.log(" WalletConnect connected status:",c),c&&(await new Promise(l=>setTimeout(l,2e3)),o=i.getProvider(),console.log(" Retry: WalletConnect provider:",o?"Found":"Still not found"),!o)){const l=i.appKit;if(l){const d=l.getWalletProvider();d&&(o=new Dr(d),console.log(" Got WalletConnect provider from appKit (retry)"))}}}if(!o)throw new Error("WalletConnect provider not available. Please reconnect your wallet via WalletConnect.");n=o,console.log(" Using WalletConnect provider for transactions")}else{if(!window.ethereum)throw new Error("Please install MetaMask, Trust Wallet, or another Web3 wallet");try{await window.ethereum.request({method:"eth_requestAccounts"})}catch(i){i.code!==4001&&console.warn("eth_requestAccounts failed (might already be connected):",i)}n=new Dr(window.ethereum),console.log(" Using window.ethereum provider")}this.provider=n,this.signer=await n.getSigner();const r=await this.signer.getAddress();console.log(" Signer created, address:",r),this.contract=new rr(On,vi,this.signer),console.log(" Contract initialized"),console.log(" Contract Address:",On),console.log(" Wallet Address:",r);try{const i=await n.getNetwork();if(console.log(" Network:",i.name,"Chain ID:",i.chainId.toString()),this.contract)try{const o=await this.contract.admin();console.log(" Contract is accessible, admin:",o)}catch(o){console.warn(" Could not read from contract (might be expected):",o.message)}}catch(i){console.warn(" Could not get network info:",i.message)}const s=this.detectWalletType();return console.log(" Detected wallet type:",s),!0}catch(e){throw console.error(" Failed to initialize blockchain service:",e),e}}detectWalletType(){var n,r,s;try{if(typeof Xt<"u"&&(Xt!=null&&Xt.getState)){const i=(n=Xt.getState())==null?void 0:n.walletType;if(i)switch(i){case"metamask":return"MetaMask";case"trustwallet":return"Trust Wallet";case"walletconnect":return(r=window.ethereum)!=null&&r.isTrust||(s=window.ethereum)!=null&&s.isTrustWallet?"Trust Wallet (via WalletConnect)":"WalletConnect";default:break}}}catch{}if(!window.ethereum)return"Unknown Wallet";if(window.ethereum.isMetaMask)return"MetaMask";if(window.ethereum.isTrust||window.ethereum.isTrustWallet)return"Trust Wallet";if(window.ethereum.isCoinbaseWallet)return"Coinbase Wallet";if(window.ethereum.isRabby)return"Rabby";if(window.ethereum.isBraveWallet)return"Brave Wallet";const e=navigator.userAgent;return e.includes("TrustWallet")||e.includes("Trust Wallet")?"Trust Wallet (Mobile)":"Unknown Wallet"}isTrustWalletAvailable(){var e;return window.ethereum?!!(window.ethereum.isTrust||window.ethereum.isTrustWallet||(e=window.ethereum)!=null&&e.isTrustWallet||navigator.userAgent.includes("TrustWallet")||navigator.userAgent.includes("Trust Wallet")):!1}getWalletInstructions(){switch(this.detectWalletType()){case"Trust Wallet":return"Trust Wallet detected! Make sure you have sufficient BNB for gas fees and the required token balance.";case"Trust Wallet (Mobile)":return"Trust Wallet Mobile detected! Ensure you have sufficient BNB for gas fees and the required token balance.";case"MetaMask":return"MetaMask detected! Make sure you have sufficient BNB for gas fees and the required token balance.";default:return"Make sure you have sufficient BNB for gas fees and the required token balance."}}async createTrade(e){var r,s,i,o,c,l,d,u,h,f,p,m,g,y;const n=(r=Xt.getState())==null?void 0:r.walletType;if((!this.contract||!this.signer||!this.provider)&&(console.log(" Re-initializing blockchain service for createTrade..."),await this.init()),n==="walletconnect"){if(console.log(" Ensuring WalletConnect provider is ready for createTrade..."),await this.init(),!this.provider||!this.signer||!this.contract)throw new Error("WalletConnect provider not ready. Please ensure your wallet is connected via WalletConnect.");const x=await this.signer.getAddress();console.log(" WalletConnect ready, signer address:",x)}try{console.log(" Creating trade on blockchain (P2PEscrowV2)..."),console.log(" Token:",e.token),console.log(" Amount:",e.amount),console.log(" Buyer:",e.buyer),console.log(" Is Native BNB?",e.isNativeBNB),console.log(" Wallet Type:",n);const x=am(e.amount,18);if(e.token==="0x0000000000000000000000000000000000000000"||e.isNativeBNB?(console.log(" Creating trade with NATIVE BNB (address(0))"),console.log(" Note: No BNB sent now - will be sent during lockFunds()")):console.log(" Creating trade with ERC20 token (WBNB/USDT/USDC)"),!this.contract)throw new Error("Contract not initialized. Please reconnect your wallet.");if(!this.signer)throw new Error("Signer not available. Please reconnect your wallet.");if(!this.contract.createTrade)throw new Error("createTrade function not found in contract. Please check the contract ABI.");let b=0;try{this.contract&&this.contract.tradeCounter&&(b=Number(await this.contract.tradeCounter()),console.log(" Trade counter before transaction:",b))}catch(C){console.warn(" Could not get trade counter before transaction:",C.message)}let v;if(n==="walletconnect"){console.log(" WalletConnect detected - estimating gas for createTrade...");try{console.log(" Estimating gas...");const C=await this.contract.createTrade.estimateGas(e.token,x,e.buyer),S=C*130n/100n;console.log(" Estimated gas:",C.toString()),console.log(" Gas limit with buffer:",S.toString()),console.log(" Sending createTrade transaction with explicit gas..."),v=await this.contract.createTrade(e.token,x,e.buyer,{gasLimit:S}),console.log(" Transaction sent with explicit gas")}catch(C){console.warn(" Gas estimation failed, trying without explicit gas:",C),console.error(" Gas estimation error details:",{code:C.code,message:C.message,reason:C.reason});try{console.log(" Attempting createTrade without explicit gas..."),v=await this.contract.createTrade(e.token,x,e.buyer),console.log(" Transaction sent without explicit gas")}catch(S){throw console.error(" createTrade failed even without explicit gas:",S),console.error(" Fallback error details:",{code:S.code,message:S.message,reason:S.reason,data:S.data}),S}}}else console.log(" Sending createTrade transaction (standard wallet)..."),v=await this.contract.createTrade(e.token,x,e.buyer),console.log(" Transaction sent");console.log(" Transaction sent:",v.hash),console.log(" Waiting for confirmation...");const E=await v.wait();if(console.log(" Trade created on blockchain!"),console.log(" Block number:",E.blockNumber),console.log(" Receipt status:",E.status),E.status!==1)throw new Error(`Transaction failed on blockchain. Status: ${E.status}. Please check on BSCScan: ${v.hash}`);console.log(" Parsing transaction receipt for TradeCreated event..."),console.log(" Receipt logs count:",E.logs.length);let k=0;try{const C=this.contract.filters.TradeCreated(),N=(await this.contract.queryFilter(C,E.blockNumber,E.blockNumber)).find(I=>I.transactionHash===v.hash);if(N&&"args"in N&&N.args){const I=N.args;k=Number(I.tradeId||0),console.log(" TradeCreated event found via queryFilter!"),console.log(" Trade ID from event:",k),console.log(" Event args:",{tradeId:(s=I.tradeId)==null?void 0:s.toString(),seller:I.seller,buyer:I.buyer,token:I.token,amount:(i=I.amount)==null?void 0:i.toString()})}}catch(C){console.warn(" Event filtering failed, trying direct log parsing:",C.message)}if(k===0){console.log(" Trying direct log parsing...");for(let C=0;C<E.logs.length;C++){const S=E.logs[C];try{if(S.address.toLowerCase()!==On.toLowerCase())continue;const N=this.contract.interface.parseLog({topics:S.topics||[],data:S.data||"0x"});if(console.log(` Log ${C}: Event name: ${N==null?void 0:N.name}`),(N==null?void 0:N.name)==="TradeCreated"){k=Number(((o=N.args)==null?void 0:o.tradeId)||0),console.log(" TradeCreated event found via direct parsing!"),console.log(" Trade ID from event:",k),console.log(" Event args:",N.args);break}}catch{continue}}}if(k===0||isNaN(k)){console.warn(" TradeCreated event not found, trying fallback method...");try{console.log(" Fallback: Getting trade ID from contract state...");const C=await this.signer.getAddress();if(console.log(" Signer address for verification:",C),this.contract&&this.contract.tradeCounter){const S=Number(await this.contract.tradeCounter());console.log(" Trade counter after transaction:",S),console.log(" Trade counter before transaction:",b);const N=[];S>0&&N.push(S),b>0&&N.push(b+1);const I=5;for(let P=1;P<=I&&S-P>0;P++)N.push(S-P);const F=[...new Set(N)].sort((P,H)=>H-P);console.log(" Searching through candidate trade IDs:",F);for(const P of F)try{console.log(` Checking trade ID ${P}...`);const H=await this.contract.trades(P);if(H&&H.seller){const z=H.seller.toLowerCase(),T=((c=H.buyer)==null?void 0:c.toLowerCase())||"",_=e.buyer.toLowerCase();if(console.log(` Trade ${P} details:`,{seller:z,buyer:T,expectedBuyer:_,token:H.token,amount:(l=H.amount)==null?void 0:l.toString()}),z===C.toLowerCase())if(!T||T===_||T==="0x0000000000000000000000000000000000000000"){k=P,console.log(" Found matching trade! ID:",k),console.log(" Seller matches:",z),console.log(" Buyer matches or not set yet");break}else console.log(` Trade ${P} seller matches but buyer doesn't match`);else console.log(` Trade ${P} seller doesn't match`)}}catch(H){console.log(` Could not check trade ${P}:`,H.message);continue}if(k===0&&S>0&&(console.warn(" Could not find exact match, using tradeCounterAfter as fallback"),k=S),k===0)throw new Error(`Could not find matching trade ID. Searched ${F.length} candidates.`)}else throw console.error(" tradeCounter function not available in contract"),new Error("tradeCounter function not available")}catch(C){throw console.error(" Fallback method also failed:",C),console.error(" Fallback error details:",{message:C.message,code:C.code,reason:C.reason}),console.error(" Could not extract trade ID from transaction receipt"),console.error(" Transaction hash:",v.hash),console.error(" Block number:",E.blockNumber),console.error(" Receipt status:",E.status),console.error(" Logs count:",E.logs.length),console.error(" Logs:",E.logs.map(S=>{var N,I;return{address:S.address,topics:((N=S.topics)==null?void 0:N.length)||0,dataLength:((I=S.data)==null?void 0:I.length)||0}})),new Error("Failed to extract trade ID from blockchain transaction. The TradeCreated event was not found and fallback method also failed. Please check the transaction on BSCScan: "+v.hash)}}if(k===0||isNaN(k))throw console.error(" Invalid trade ID after all methods:",k),console.error(" Transaction hash:",v.hash),new Error("Failed to extract valid trade ID. Transaction may have failed. Please check on BSCScan: "+v.hash);return console.log(" Final trade ID:",k),{tradeId:k,txHash:v.hash}}catch(x){console.error(" Error creating trade:",x),console.error(" Error details:",{code:x.code,reason:x.reason,message:x.message,data:x.data,transaction:x.transaction});const w=this.detectWalletType(),v=((d=Xt.getState())==null?void 0:d.walletType)||w;if(x.code==="ACTION_REJECTED"||x.code===4001)throw new Error(`Transaction rejected by user in ${v}. Please try again and approve the transaction in your wallet.`);if(x.code==="INSUFFICIENT_FUNDS"||x.code===-32e3)throw new Error(`Insufficient BNB for gas fees in ${v}. Please add more BNB to your wallet for transaction fees.`);if(x.code==="UNSUPPORTED_OPERATION")throw new Error(`Operation not supported by ${v}. Please try with a different wallet or ensure you have sufficient BNB for gas.`);if(x.reason)throw new Error(`Smart contract error: ${x.reason}`);if((u=x.message)!=null&&u.includes("User rejected")||(h=x.message)!=null&&h.includes("user rejected")||(f=x.message)!=null&&f.includes("user-denied"))throw new Error(`Transaction rejected by user in ${v}. Please try again and approve the transaction.`);if((p=x.message)!=null&&p.includes("insufficient funds")||(m=x.message)!=null&&m.includes("insufficient balance"))throw new Error(`Insufficient BNB for gas fees in ${v}. Please add more BNB to your wallet.`);if((g=x.message)!=null&&g.includes("provider not available")||(y=x.message)!=null&&y.includes("provider not ready"))throw new Error(`Wallet provider not available. Please reconnect your wallet via ${v}.`);{const E=x.message||"Unknown error";throw new Error(`Failed to create trade on blockchain using ${v}. ${E}`)}}}async approveToken(e,n){var s,i,o,c,l,d,u,h;const r=(s=Xt.getState())==null?void 0:s.walletType;if((!this.provider||!this.signer)&&await this.init(),r==="walletconnect"){if(console.log(" Ensuring WalletConnect provider is available..."),await this.init(),!this.provider)throw new Error("WalletConnect provider not available. Please ensure your wallet is connected via WalletConnect.");if(!this.signer)throw new Error("WalletConnect signer not available. Please ensure your wallet is connected via WalletConnect.");const f=await this.signer.getAddress();console.log(" WalletConnect provider verified, signer address:",f)}if(e==="0x0000000000000000000000000000000000000000")return console.log(" Native BNB - no approval needed"),"NATIVE_BNB";try{console.log(" Approving ERC20 token spending..."),console.log(" Token:",e),console.log(" Trade Amount:",n),console.log(" Wallet Type:",r);const f=["function approve(address spender, uint256 amount) public returns (bool)","function allowance(address owner, address spender) public view returns (uint256)","function decimals() public view returns (uint8)"],p=new rr(e,f,this.signer);let m=18;try{m=await p.decimals(),console.log(" Token decimals:",m)}catch{console.warn(" Could not fetch token decimals, assuming 18")}console.log(" Fetching fee structure for approval...");let g,y;try{g=await this.contract.SELLER_EXTRA_BPS(),y=await this.contract.BPS_DENOM(),console.log(" Got fee structure from contract")}catch(F){console.warn(" Failed to get fees from contract via signer provider:",F),console.log(" Trying read-only provider as fallback...");try{const P=new Eg(Cw),H=new rr(On,vi,P);g=await H.SELLER_EXTRA_BPS(),y=await H.BPS_DENOM(),console.log(" Got fee structure from read-only provider")}catch(P){console.error(" Failed to get fees from read-only provider:",P),console.warn(" Using default fee values (0% extra fee)"),y=10000n,g=0n}}const x=am(n,m),w=x*g/y,b=x+w;console.log(" Seller Extra Fee (BPS):",g.toString()),console.log(" Extra Fee Amount:",fa(w,m)),console.log(" Total to Approve:",fa(b,m));const v=await this.signer.getAddress(),E=await p.allowance(v,On);if(console.log(" Current allowance:",fa(E,m)),console.log(" Required amount (with fees):",fa(b,m)),E>=b)return console.log(" Already approved - skipping approval"),"ALREADY_APPROVED";if(!this.signer)throw new Error("Signer not available. Please reconnect your wallet.");const k=await this.signer.getAddress();console.log(" Approving with signer address:",k);const C=this.detectWalletType(),S=r==="trustwallet"||r==="walletconnect"||C.toLowerCase().includes("trust");let N;if(S){console.log(" Trust Wallet/WalletConnect detected - using explicit gas settings");try{console.log(" Estimating gas for approval...");const F=await p.approve.estimateGas(On,b),P=F*130n/100n;console.log(" Estimated gas:",F.toString()),console.log(" Gas limit with buffer:",P.toString()),console.log(" Sending approval transaction with explicit gas..."),N=await p.approve(On,b,{gasLimit:P}),console.log(" Approval transaction sent with explicit gas")}catch(F){console.warn(" Gas estimation failed, trying without explicit gas:",F),console.log(" Attempting approval without explicit gas limit...");try{N=await p.approve(On,b),console.log(" Approval transaction sent without explicit gas")}catch(P){throw console.error(" Approval failed even without explicit gas:",P),P}}}else console.log(" Sending approval transaction (standard wallet)..."),N=await p.approve(On,b),console.log(" Approval transaction sent");console.log(" Approval transaction sent:",N.hash),console.log(" Waiting for confirmation...");const I=await N.wait();return console.log(" Token approved!"),console.log(" Block number:",I.blockNumber),N.hash}catch(f){console.error(" Error approving token:",f),console.error(" Error details:",{code:f.code,reason:f.reason,message:f.message,data:f.data});const p=this.detectWalletType();if(f.code==="ACTION_REJECTED"||f.code===4001)throw new Error(`Token approval rejected by user in ${p}. Please try again and approve the transaction in your wallet.`);if(f.code==="INSUFFICIENT_FUNDS"||f.code===-32e3)throw new Error(`Insufficient BNB for gas fees in ${p}. Please add more BNB to your wallet for transaction fees.`);if(f.code==="UNSUPPORTED_OPERATION")throw new Error(`Token approval not supported by ${p}. Please try with a different wallet or ensure you have sufficient BNB for gas.`);if(f.reason)throw new Error(`Approval failed: ${f.reason}`);if((i=f.message)!=null&&i.includes("User rejected")||(o=f.message)!=null&&o.includes("user rejected")||(c=f.message)!=null&&c.includes("user-denied"))throw new Error(`Token approval rejected by user in ${p}. Please try again and approve the transaction.`);if((l=f.message)!=null&&l.includes("insufficient funds")||(d=f.message)!=null&&d.includes("insufficient balance"))throw new Error(`Insufficient BNB for gas fees in ${p}. Please add more BNB to your wallet.`);if((u=f.message)!=null&&u.includes("CALL_EXCEPTION")||(h=f.message)!=null&&h.includes("missing revert data"))throw new Error(`Token approval failed in ${p}. Please ensure you have sufficient token balance and BNB for gas.`);{const m=f.message||"Unknown error";throw new Error(`Failed to approve token spending using ${p}. ${m}`)}}}async createTradeAndLockFunds(e,n,r){console.log(" NEW FLOW: Creating trade and locking funds together..."),console.log(" Step 1: Creating trade...");const s=await this.createTrade(e),i=s.tradeId,o=s.txHash;console.log(" Trade created! ID:",i),console.log(" Step 2: Locking funds...");const c=await this.lockFunds(i,n,r);return console.log(" Funds locked!"),{tradeId:i,createTradeTxHash:o,lockFundsTxHash:c}}async lockFunds(e,n="0x0000000000000000000000000000000000000000",r="0"){var s,i,o,c,l,d,u,h,f;(!this.contract||!this.signer)&&await this.init();try{console.log(" Step 0: Verifying trade on-chain..."),console.log(" Trade ID:",e);try{const w=await this.contract.trades(e),b=Number(w.status),v=Number(w.id);if(console.log(" Trade found on-chain"),console.log(" Trade Status:",b),console.log(" Trade ID from chain:",v),b===1)throw new Error("Trade already locked - funds are already locked on-chain");if(b===2)throw new Error("Trade already released - cannot lock funds");if(b===3)throw new Error("Trade already cancelled - cannot lock funds");b!==0&&console.warn(" Trade is in unexpected status:",b),v!==e&&console.warn(` Trade ID mismatch: expected ${e}, got ${v}`)}catch(w){if((s=w.message)!=null&&s.includes("already locked")||(i=w.message)!=null&&i.includes("already released")||(o=w.message)!=null&&o.includes("already cancelled"))throw w;console.warn(" Could not verify trade on-chain:",w.message)}console.log(" Step 1: Token Approval");const p=await this.approveToken(n,r);p!=="ALREADY_APPROVED"&&p!=="NATIVE_BNB"&&console.log(" Token approval confirmed:",p),console.log(" Step 2: Lock Funds"),console.log(" Locking funds on blockchain..."),console.log(" Trade ID:",e),console.log(" Calling lockFunds() function...");const m=await this.signer.getAddress();console.log(" Wallet address:",m);const g=n==="0x0000000000000000000000000000000000000000";let y;if(g){const w=am(r,18);console.log(" Fetching fee structure from contract...");let b,v;try{b=await this.contract.SELLER_EXTRA_BPS(),v=await this.contract.BPS_DENOM(),console.log(" Got fee structure from contract")}catch(C){console.warn(" Failed to get fees from contract via signer provider:",C),console.log(" Trying read-only provider as fallback...");try{const S=new Eg(Cw),N=new rr(On,vi,S);b=await N.SELLER_EXTRA_BPS(),v=await N.BPS_DENOM(),console.log(" Got fee structure from read-only provider")}catch(S){console.error(" Failed to get fees from read-only provider:",S),console.warn(" Using default fee values (0% extra fee)"),v=10000n,b=0n}}const E=w*b/v,k=w+E;console.log(" Trade Amount:",gc(w),"BNB"),console.log(" Seller Extra Fee (BPS):",b.toString()),console.log(" Extra Fee Amount:",gc(E),"BNB"),console.log(" Total to Send (sellerTotal):",gc(k),"BNB"),console.log(" Calling lockFundsNative() for NATIVE BNB"),y=await this.contract.lockFundsNative(e,{value:k})}else console.log(" Calling lockFunds() for ERC20 token (WBNB/USDT/USDC)"),y=await this.contract.lockFunds(e);console.log(" Transaction sent:",y.hash),console.log(" Waiting for confirmation...");const x=await y.wait();return console.log(" Transaction confirmed!"),console.log(" Block number:",x.blockNumber),console.log(" Gas used:",x.gasUsed.toString()),console.log(" Funds are now LOCKED on blockchain for 2 hours"),y.hash}catch(p){console.error(" Error locking funds:",p),console.error(" Error details:",{code:p.code,reason:p.reason,message:p.message,data:p.data});const m=this.detectWalletType();if(p.code==="CALL_EXCEPTION"||p.code==="UNPREDICTABLE_GAS_LIMIT"){let g=`Contract call failed in ${m}. `;throw p.data?g+=`Error data: ${p.data}`:(g+=`Possible reasons: Trade ID ${e} may not exist on-chain, trade already locked, or insufficient funds. `,g+="Please verify the trade ID matches the blockchain trade ID."),new Error(g)}throw p.code==="ACTION_REJECTED"?new Error(`Transaction rejected by user in ${m}`):p.code==="INSUFFICIENT_FUNDS"?new Error(`Insufficient balance for transaction in ${m}. Please add more funds.`):p.code==="UNSUPPORTED_OPERATION"?new Error(`Fund locking not supported by ${m}. Please try with a different wallet.`):p.reason?new Error(`Smart contract error: ${p.reason}`):(c=p.message)!=null&&c.includes("User rejected")?new Error(`Transaction rejected by user in ${m}`):(l=p.message)!=null&&l.includes("insufficient funds")?new Error(`Insufficient balance for transaction in ${m}. Please add more funds.`):(d=p.message)!=null&&d.includes("gas")?new Error(`Gas estimation failed in ${m}. Please try again or increase gas limit.`):(u=p.message)!=null&&u.includes("already locked")||(h=p.message)!=null&&h.includes("already released")||(f=p.message)!=null&&f.includes("already cancelled")?p:new Error(`Failed to lock funds on blockchain using ${m}. ${p.message||"Unknown error"}`)}}async releaseFunds(e){throw new Error("Direct release not supported. Seller should use confirmReceived() to release funds.")}async cancelTrade(e){(!this.contract||!this.signer)&&await this.init();try{console.log(" Cancelling trade on blockchain..."),console.log(" Trade ID:",e);const n=await this.contract.cancelTrade(e);return console.log(" Transaction sent:",n.hash),await n.wait(),console.log(" Trade cancelled, funds refunded"),n.hash}catch(n){console.error(" Error cancelling trade:",n);const r=this.detectWalletType();throw n.code==="ACTION_REJECTED"?new Error(`Transaction rejected by user in ${r}`):n.code==="INSUFFICIENT_FUNDS"?new Error(`Insufficient balance for gas fees in ${r}`):n.reason?new Error(`Smart contract error: ${n.reason}`):new Error(`Failed to cancel trade using ${r}`)}}async redeemAfterAppealWindow(e){(!this.contract||!this.signer)&&await this.init();try{console.log(" Redeem after appeal window...",e);const n=await this.contract.redeemAfterAppealWindow(e);return await n.wait(),n.hash}catch(n){console.error(" Error redeeming after appeal window:",n);const r=this.detectWalletType();throw n.code==="ACTION_REJECTED"?new Error(`Transaction rejected by user in ${r}`):n.code==="INSUFFICIENT_FUNDS"?new Error(`Insufficient balance for gas fees in ${r}`):n.reason?new Error(`Smart contract error: ${n.reason}`):new Error(`Failed to redeem after appeal window using ${r}`)}}async markPaid(e){return console.log(" Buyer confirmation is now off-chain only. No blockchain transaction needed."),console.log(" This function is deprecated. Buyer should confirm via frontend/database only."),"OFF_CHAIN_CONFIRMATION"}async confirmReceived(e){var n,r,s,i,o;(!this.contract||!this.signer)&&await this.init();try{console.log(" Seller confirming payment received on blockchain..."),console.log(" Trade ID:",e),console.log(" NEW FLOW: Seller confirmation will release funds immediately to buyer");const c=((n=Xt.getState())==null?void 0:n.walletType)||this.detectWalletType();if(console.log(" Wallet Type:",c),!this.contract)throw new Error("Contract not initialized. Please reconnect your wallet.");let l;if(this.contract.confirmReceived)l=this.contract.confirmReceived,console.log(" Using confirmReceived() function");else if(this.contract.markReceived)l=this.contract.markReceived,console.log(" Using markReceived() function (fallback)");else throw new Error("Neither confirmReceived nor markReceived function found in contract");let d;if(c==="walletconnect"){console.log(" WalletConnect detected - estimating gas...");try{const h=await l.estimateGas(e),f=h*130n/100n;console.log(" Estimated gas:",h.toString()),console.log(" Gas limit with buffer:",f.toString()),d=await l(e,{gasLimit:f}),console.log(" Transaction sent with explicit gas")}catch(h){console.warn(" Gas estimation failed, trying without explicit gas:",h),d=await l(e),console.log(" Transaction sent without explicit gas")}}else d=await l(e),console.log(" Transaction sent");console.log(" Transaction hash:",d.hash),console.log(" Waiting for confirmation...");const u=await d.wait();return console.log(" Payment confirmed and funds released to buyer!"),console.log(" Block number:",u.blockNumber),d.hash}catch(c){console.error(" Error confirming received:",c),console.error(" Error details:",{code:c.code,reason:c.reason,message:c.message,data:c.data});const l=this.detectWalletType(),u=((r=Xt.getState())==null?void 0:r.walletType)||l;if(c.code==="ACTION_REJECTED"||c.code===4001)throw new Error(`Payment confirmation cancelled. You can try again later. The transaction was rejected in ${u}.`);if(c.code==="INSUFFICIENT_FUNDS"||c.code===-32e3)throw new Error(`Insufficient BNB for gas fees in ${u}. Please add more BNB to your wallet for transaction fees.`);if(c.reason)throw new Error(`Smart contract error: ${c.reason}`);if((s=c.message)!=null&&s.includes("User rejected")||(i=c.message)!=null&&i.includes("user rejected")||(o=c.message)!=null&&o.includes("user-denied"))throw new Error("Payment confirmation cancelled. You can try again later.");{const h=c.message||"Unknown error";throw new Error(`Failed to confirm payment on blockchain using ${u}. ${h}`)}}}async markReceived(e){return this.confirmReceived(e)}async getTradeDetails(e){this.contract||await this.init();try{const n=await this.contract.trades(e);console.log(" Raw trade data from contract:",n);const r={0:"CREATED",1:"LOCKED",2:"APPEAL_WINDOW_OPEN",3:"UNDER_DISPUTE",4:"RELEASED",5:"REFUNDED",6:"COMPLETED"};let s;if(typeof n=="object"&&n!==null){s={id:n[0]??n.id,seller:n[1]??n.seller,buyer:n[2]??n.buyer,token:n[3]??n.token,amount:n[4]??n.amount,status:n[5]??n.status,lockedAt:n[6]??n.lockedAt,appealStartAt:n[7]??n.appealStartAt,buyerPaid:n[8]??n.buyerPaid??!1,sellerReceived:n[9]??n.sellerReceived??!1,appealFiled:n[10]??n.appealFiled??!1};const l=String(s.token||"0x0").toLowerCase();s.isNativeLocked=l==="0x0000000000000000000000000000000000000000"||l==="0x0"}else s=n,s.isNativeLocked=!1;const i=Number(s.status),o=r[i]||`UNKNOWN(${i})`;let c=18;try{s.token&&s.token!=="0x0000000000000000000000000000000000000000"&&(c=await new rr(s.token,["function decimals() view returns (uint8)"],this.provider).decimals())}catch(l){console.warn(" Could not fetch token decimals, using default 18:",l)}return{id:Number(s.id),seller:s.seller,buyer:s.buyer,token:s.token,amount:fa(s.amount,c),status:i,statusName:o,lockedAt:s.lockedAt&&Number(s.lockedAt)>0?Number(s.lockedAt):null,appealStartAt:s.appealStartAt&&Number(s.appealStartAt)>0?Number(s.appealStartAt):null,buyerPaid:s.buyerPaid||!1,sellerReceived:s.sellerReceived||!1,appealFiled:s.appealFiled||!1,isNativeLocked:s.isNativeLocked||!1}}catch(n){if(console.error("Error fetching trade details:",n),n.code==="BAD_DATA"&&n.data){console.log(" Attempting manual decoding of trade data...");try{return await this.getTradeDetailsManual(e)}catch(r){throw console.error("Manual decoding also failed:",r),n}}throw n}}async getTradeDetailsManual(e){this.provider||await this.init();try{const n=On,r=new hE(vi),s=r.encodeFunctionData("trades",[e]),i=await this.provider.call({to:n,data:s}),o=r.decodeFunctionResult("trades",i),c={0:"CREATED",1:"LOCKED",2:"APPEAL_WINDOW_OPEN",3:"UNDER_DISPUTE",4:"RELEASED",5:"REFUNDED",6:"COMPLETED"},l=Number(o[5]),d=c[l]||`UNKNOWN(${l})`;let u=18;const h=o[3],f=!h||h==="0x0000000000000000000000000000000000000000"||String(h).toLowerCase()==="0x0";try{f||(u=await new rr(h,["function decimals() view returns (uint8)"],this.provider).decimals())}catch(p){console.warn(" Could not fetch token decimals:",p)}return{id:Number(o[0]),seller:o[1],buyer:o[2],token:o[3],amount:fa(o[4],u),status:l,statusName:d,lockedAt:o[6]&&Number(o[6])>0?Number(o[6]):null,appealStartAt:o[7]&&Number(o[7])>0?Number(o[7]):null,buyerPaid:o[8]||!1,sellerReceived:o[9]||!1,appealFiled:o[10]||!1,isNativeLocked:f}}catch(n){throw console.error("Error in manual decoding:",n),n}}async verifyTradeStatus(e){try{console.log(" Verifying trade status on blockchain..."),console.log(" Trade ID:",e);const n=await this.getTradeDetails(e),r=n.status===4||n.status===6;return console.log(" Trade Status on Blockchain:",{status:n.status,statusName:n.statusName,isReleased:r,buyerPaid:n.buyerPaid,sellerReceived:n.sellerReceived}),{tradeId:e,blockchainStatus:n.status,blockchainStatusName:n.statusName,isReleased:r,seller:n.seller,buyer:n.buyer,amount:n.amount,token:n.token,buyerPaid:n.buyerPaid,sellerReceived:n.sellerReceived,details:n}}catch(n){throw console.error(" Error verifying trade status:",n),new Error(`Failed to verify trade status: ${n.message}`)}}async getNetwork(){this.provider||await this.init();const e=await this.provider.getNetwork();return{name:e.name,chainId:Number(e.chainId)}}async checkNetwork(){const e=await this.getNetwork(),n=56;return e.chainId!==n?(console.warn(` Wrong network! Expected: ${n}, Got: ${e.chainId}`),!1):!0}async switchToBSCMainnet(){if(!window.ethereum)throw new Error("Wallet not found");try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x38"}]})}catch(e){if(e.code===4902)await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x38",chainName:"BSC Mainnet",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:["https://bsc-dataseed.binance.org/"],blockExplorerUrls:["https://bscscan.com"]}]});else throw e}}}const Ba=new CIe,NIe=()=>{const[t,e]=A.useState([]);ds(),vu();const[n,r]=A.useState([]),[s,i]=A.useState(!1),[o,c]=A.useState(!1),[l,d]=A.useState("orders"),[u,h]=A.useState("ALL"),[f,p]=A.useState(null),[m,g]=A.useState(Date.now()),[y,x]=A.useState({priceInr:"",minAmount:"",maxAmount:"",active:!0}),[w,b]=A.useState(null),[v,E]=A.useState(null),[k,C]=A.useState(null),[S,N]=A.useState({isOpen:!1,targetAddress:"",targetName:void 0,context:void 0}),[I,F]=A.useState(!1),[P,H]=A.useState(!1),[z,T]=A.useState(null),[_]=A.useState(!1),[L,O]=A.useState(0),[M,B]=A.useState({}),[W,Z]=A.useState({isOpen:!1,orderId:""}),[ie,ae]=A.useState({}),[oe,Ne]=A.useState({isOpen:!1,orderId:""}),[de,_e]=A.useState(new Set),[Ue,ee]=A.useState({isOpen:!1,orderId:""}),[q,ue]=A.useState({isOpen:!1,phoneNumber:"",userName:""}),[Ae,tt]=A.useState({isOpen:!1,appealUrl:"",orderId:""}),[me,je]=A.useState({isOpen:!1,orderId:"",userRole:"buyer"}),{address:pe,connectionError:ot,clearError:Tn}=Xt(),{user:nt}=ss(),{setUnreadOrdersCount:mn,clearUnreadOrdersCount:Ve}=IV(),rt=A.useRef(new Set),ht=A.useRef(null),pt=A.useRef(null),jn=A.useRef(null),so=A.useRef(null),Gt=A.useRef(null),or=A.useRef(null),jc={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]},Rc=A.useCallback(()=>{console.log(" Orders: Creating peer connection");const j=new RTCPeerConnection(jc);return j.onicecandidate=Y=>{Y.candidate&&Gt.current&&(console.log(" Orders: Sending ICE candidate to",Gt.current),pt.current.emit("ice-candidate",{candidate:Y.candidate,to:Gt.current}))},j.ontrack=Y=>{console.log(" Orders: Received remote track:",Y.track.kind),Y.streams&&Y.streams[0]&&console.log(" Orders: Remote audio stream received")},j.onconnectionstatechange=()=>{console.log(" Orders: Connection state:",j.connectionState),j.connectionState==="connected"?(console.log(" Orders: Call connected!"),F(!0),U.success("Call connected!")):(j.connectionState==="disconnected"||j.connectionState==="failed")&&(console.log(" Orders: Call disconnected"),F(!1),T(null),U("Call ended",{icon:""}))},j},[]),Ll=A.useCallback(()=>{console.log(" Orders: Cleaning up call state"),jn.current&&(jn.current.close(),jn.current=null),so.current&&(so.current.getTracks().forEach(j=>j.stop()),so.current=null),F(!1),T(null),N({isOpen:!1,targetAddress:"",targetName:void 0,context:void 0}),Gt.current=null,O(Date.now()),console.log(" Orders: Call state cleaned up")},[pe]),Xs=A.useCallback(async()=>{if(z)try{console.log(" Orders: Accepting incoming call from",z.from);const j=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});so.current=j,Gt.current=z.from,jn.current=Rc(),j.getAudioTracks().forEach(Q=>{jn.current.addTrack(Q,j)}),await jn.current.setRemoteDescription(new RTCSessionDescription(z.offer));const Y=await jn.current.createAnswer();await jn.current.setLocalDescription(Y),pt.current.emit("answer",{answer:Y,to:z.from}),N({isOpen:!0,targetAddress:z.from,targetName:`User ${z.from.slice(0,8)}`,context:"Incoming Call"}),T(null),F(!0),U.success("Call accepted!")}catch(j){console.error(" Orders: Error accepting call:",j),U.error("Failed to accept call"),T(null)}},[z,Rc]);A.useEffect(()=>{if(!(nt!=null&&nt.address))return;const j=window.location.origin;pt.current=Po(j),pt.current.on("disconnect",()=>{console.log(" Orders: Disconnected from signaling server"),H(!1)}),pt.current.on("reconnect",()=>{console.log(" Orders: Reconnected to signaling server"),nt!=null&&nt.address&&pt.current&&(pt.current.emit("register",nt.address),H(!0))}),pt.current.on("connect",()=>{console.log(" Orders: Connected to signaling server"),nt!=null&&nt.address&&pt.current&&(pt.current.emit("register",nt.address),H(!0),console.log(" Orders: User re-registered:",nt.address))}),or.current=setInterval(()=>{pt.current&&pt.current.connected&&(nt!=null&&nt.address)&&pt.current.emit("ping")},3e4);const Y=async({offer:ve,from:Oe})=>{console.log(" Orders: Received incoming call from",Oe),U.success(`Incoming call from ${Oe.slice(0,8)}...`),_?(console.log(" Orders: Auto-accepting incoming call"),T({from:Oe,offer:ve,isOpen:!0}),setTimeout(()=>{Xs()},1e3)):T({from:Oe,offer:ve,isOpen:!0})},Q=({candidate:ve,from:Oe})=>{console.log(" Orders: Received ICE candidate from",Oe),jn.current&&ve&&jn.current.addIceCandidate(new RTCIceCandidate(ve)).catch(xe=>console.error("Error adding ICE candidate:",xe))},le=async({answer:ve,from:Oe})=>{console.log(" Orders: Received answer from",Oe),jn.current&&(await jn.current.setRemoteDescription(new RTCSessionDescription(ve)),F(!0),U.success("Call connected!"))},ce=({from:ve})=>{console.log(" Orders: Call ended by",ve),Ll(),U("Call ended",{icon:""})},he=({target:ve})=>{console.log(" Orders: Target user not found:",ve),U.error("User not available for calling"),Ll()};return pt.current.on("offer",Y),pt.current.on("ice-candidate",Q),pt.current.on("answer",le),pt.current.on("call-ended",ce),pt.current.on("user-not-found",he),pt.current.on("registration-confirmed",({userId:ve,socketId:Oe})=>{console.log(" Orders: Registration confirmed:",{userId:ve,socketId:Oe}),H(!0)}),pt.current.on("user-status",({userId:ve,isOnline:Oe,socketId:xe})=>{console.log(" Orders: User status:",{userId:ve,isOnline:Oe,socketId:xe})}),pt.current.on("pong",()=>{console.log(" Orders: Heartbeat received")}),pt.current.on("online-users",ve=>{console.log(" Orders: Online users:",ve)}),()=>{pt.current&&(pt.current.off("offer",Y),pt.current.off("ice-candidate",Q),pt.current.off("answer",le),pt.current.off("call-ended",ce),pt.current.off("user-not-found",he),pt.current.disconnect()),or.current&&clearInterval(or.current)}},[nt==null?void 0:nt.address,Xs,Ll,_]);const ei=A.useCallback(()=>{console.log(" Orders: Rejecting incoming call from",z==null?void 0:z.from),T(null),U("Call rejected",{icon:""})},[z]);A.useCallback(async()=>!pt.current||!(nt!=null&&nt.address)?(console.log(" Orders: No socket or user address"),!1):pt.current.connected?(P||(console.log(" Orders: User not registered, re-registering"),pt.current.emit("register",nt.address),H(!0),await new Promise(j=>setTimeout(j,1e3))),P):(console.log(" Orders: Socket not connected, attempting to reconnect"),!1),[P,nt==null?void 0:nt.address]),A.useCallback(j=>new Promise(Y=>{if(!pt.current){Y(!1);return}const Q=setTimeout(()=>{console.log(" Orders: User status check timeout"),Y(!1)},3e3);pt.current.once("user-status",({userId:le,isOnline:ce})=>{clearTimeout(Q),console.log(" Orders: User status received:",{userId:le,isOnline:ce}),Y(ce)}),pt.current.emit("check-user-status",j)}),[]),A.useEffect(()=>{console.log(" Orders useEffect: Address changed:",pe),pe?(console.log(" Orders useEffect: Fetching orders and ads for address:",pe),qr(),Ff()):console.log(" Orders useEffect: No address, skipping fetch")},[pe]),A.useEffect(()=>{Ve()},[Ve]);const[Su,ka]=A.useState(0);A.useEffect(()=>{const j=setInterval(()=>{ka(Y=>Y+1),g(Y=>Y+1e3)},1e3);return()=>clearInterval(j)},[]),A.useEffect(()=>{if(!pe)return;const j=setInterval(()=>{console.log(" Auto-refreshing orders every 20 seconds..."),qr()},15e3);return()=>clearInterval(j)},[pe]);const qr=async()=>{var Y;console.log(" fetchOrders: Starting to fetch orders"),i(!0),b(null);const j=t;try{let Q=localStorage.getItem("authToken")||"";if(console.log(" fetchOrders: Token exists:",!!Q),!Q&&pe){console.log(" Orders: No token but wallet connected, attempting auto-login...");try{const xe="Sign this message to authenticate with Zotrust",we=await window.ethereum.request({method:"personal_sign",params:[xe,pe]}),{loginWithWallet:Se}=ss.getState();await Se(pe,we,xe)&&(Q=localStorage.getItem("authToken")||"",console.log(" Orders: Auto-login successful, token:",!!Q))}catch(xe){console.error(" Orders: Auto-login failed:",xe)}}const le=await fetch("/api/orders/my-orders",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${Q}`}});if(console.log(" fetchOrders: Response status:",le.status),!le.ok){let xe="";try{const we=await le.json();xe=(we==null?void 0:we.error)||(we==null?void 0:we.message)||String(le.status),console.log(" fetchOrders: Error response:",we)}catch{}throw new Error(xe||`HTTP ${le.status}`)}const ce=await le.json();console.log(" fetchOrders: Raw response data:",ce);const he=ce.data||[];if(console.log(" fetchOrders: Orders count:",he.length),(Y=ce.meta)!=null&&Y.server_time){const xe=new Date(ce.meta.server_time).getTime();g(xe);const we=Date.now(),Se=Math.abs(xe-we),gt=Math.floor(Se/1e3);console.log(" fetchOrders: Server time sync:",{server_time:ce.meta.server_time,server_time_ms:xe,server_time_utc:new Date(xe).toUTCString(),server_time_local:new Date(xe).toLocaleString(),local_time_ms:we,local_time_utc:new Date(we).toUTCString(),local_time_local:new Date(we).toLocaleString(),time_diff_seconds:gt,note:gt>60?" System time might be wrong!":" Time in sync"})}const ve=he.map(xe=>({id:String(xe.id),adId:String(xe.ad_id),adType:xe.ad_type,buyerAddress:xe.buyer_address,sellerAddress:xe.seller_address,amount:Number(xe.amount),token:xe.token,priceInr:Number(xe.price_inr??0),state:xe.state,agentBranch:xe.agent_branch||xe.branch_name||"",agentNumber:xe.agent_number||xe.agent_mobile||"",agentAddress:xe.agent_address||"",createdAt:xe.created_at,startTime:xe.start_time,timezone:xe.timezone,startDatetimeString:xe.start_datetime_string,acceptedAt:xe.accepted_at,lockExpiresAt:xe.lock_expires_at,txHash:xe.tx_hash||void 0,adOwnerAddress:xe.ad_owner_address,...xe.blockchain_trade_id?{blockchain_trade_id:xe.blockchain_trade_id}:{},...xe.buyer_name?{buyerName:xe.buyer_name}:{},...xe.seller_name?{sellerName:xe.seller_name}:{}}));e(ve);const Oe=ve.filter(xe=>xe.state==="CREATED"||xe.state==="LOCKED");Oe.length>0?mn(Oe.length):Ve(),j.length>0&&ve.forEach(xe=>{const we=j.find(Se=>Se.id===xe.id);we&&we.state==="ACCEPTED"&&xe.state==="LOCKED"&&xe.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase())&&(de.has(xe.id)||(console.log(" Funds locked! Showing popover to buyer for order:",xe.id),Ne({isOpen:!0,orderId:xe.id}))),we&&we.state==="LOCKED"&&xe.state!=="LOCKED"&&oe.isOpen&&oe.orderId===xe.id&&(console.log(" Order status changed, closing popover for order:",xe.id),Ne({isOpen:!1,orderId:""}))})}catch(Q){console.error(" fetchOrders: Error:",Q),b(`Failed to load orders${Q!=null&&Q.message?`: ${Q.message}`:""}`)}finally{i(!1)}},Ff=async()=>{c(!0),E(null);try{let j=localStorage.getItem("authToken")||"";if(!j&&pe)try{const he="Sign this message to authenticate with Zotrust",ve=await window.ethereum.request({method:"personal_sign",params:[he,pe]}),{loginWithWallet:Oe}=ss.getState();await Oe(pe,ve,he)&&(j=localStorage.getItem("authToken")||"")}catch(he){console.error(" Orders: Auto-login failed:",he)}const Y=await fetch("/api/ads/my-ads",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`}});if(!Y.ok){let he="";try{const ve=await Y.json();he=(ve==null?void 0:ve.error)||(ve==null?void 0:ve.message)||String(Y.status),console.log(" fetchMyAds: Error response:",ve)}catch{}throw new Error(he||`HTTP ${Y.status}`)}const ce=((await Y.json()).data||[]).map(he=>{var ve,Oe;return{id:he.id.toString(),ownerAddress:he.owner_address,ownerSelectedAgentId:(ve=he.owner_selected_agent_id)==null?void 0:ve.toString(),type:he.type,token:he.token,priceInr:he.price_inr.toString(),minAmount:he.min_amount.toString(),maxAmount:he.max_amount.toString(),lockDurationSeconds:he.lock_duration_seconds,city:he.city,active:he.active,createdAt:he.created_at,agent:he.branch_name?{id:((Oe=he.owner_selected_agent_id)==null?void 0:Oe.toString())||"1",branchName:he.branch_name,city:he.city||"Mumbai",address:he.agent_address||"",mobile:he.agent_mobile||"",verified:!0,createdByAdmin:"1",createdAt:new Date().toISOString()}:void 0}});console.log(" fetchMyAds: Mapped ads:",ce),r(ce)}catch(j){console.error(" fetchMyAds: Error:",j),E(`Failed to load ads${j!=null&&j.message?`: ${j.message}`:""}`)}finally{c(!1)}},zf=async j=>{console.log(" handleAcceptOrder: Accepting order:",j);const Y=t.find(le=>le.id===j);if(!Y){U.error("Order not found");return}const Q=Me(Y);if(Q.isExpired){U.error(`Order expired. Max wait time is ${XE.ACCEPT_TIMEOUT_MINUTES} minutes.`),console.log(" Order expired:",{orderId:Y.id,startTimeIST:Q.startTimeIST,expiryTimeIST:Q.expiryTimeIST,timeRemaining:Q.timeRemainingSeconds});return}try{const le=localStorage.getItem("authToken")||"";U.loading("Accepting order...",{id:"accept-flow"});const ce=await fetch(`/api/orders/${j}/accept-simple`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${le}`}});if(!ce.ok){const ve=await ce.json();U.error(ve.error||"Failed to accept order",{id:"accept-flow"});return}const he=await ce.json();console.log(" Order accepted:",he),U.success("Order accepted! Seller will now lock funds on blockchain.",{id:"accept-flow",duration:4e3}),qr()}catch(le){console.error(" handleAcceptOrder Error:",le),U.error("Failed to accept order",{id:"accept-flow"})}},gb=async j=>{try{if(!window.ethereum||!pe)return{hasEnoughBalance:!1,message:"Wallet not connected"};const Y=new Dr(window.ethereum),Q=(j==null?void 0:j.token)||"BNB",le=ph[Q]||ph.BNB,ce=le.address,he=le.isNative||!1,ve=(j==null?void 0:j.amount)||0;if(he){const Oe=await Y.getBalance(pe),xe=parseFloat(gc(Oe)),we=parseFloat(ve.toString()),Se=.001,gt=we+Se;if(xe<gt){const ps=gt-xe;return{hasEnoughBalance:!1,message:`Insufficient BNB balance!

Required: ${gt.toFixed(6)} BNB (${we.toFixed(6)} BNB for lock + ${Se.toFixed(6)} BNB for gas)
Your Balance: ${xe.toFixed(6)} BNB
Shortfall: ${ps.toFixed(6)} BNB

Please add more BNB to your wallet.`}}return{hasEnoughBalance:!0,message:""}}else{const Oe=new rr(ce,q8,Y),xe=await Oe.balanceOf(pe),we=await Oe.decimals(),Se=parseFloat(fa(xe,we)),gt=parseFloat(ve.toString()),ps=await Y.getBalance(pe),ja=parseFloat(gc(ps)),vn=.001;if(Se<gt){const Ur=gt-Se;return{hasEnoughBalance:!1,message:`Insufficient ${Q} balance!

Required: ${gt.toFixed(6)} ${Q}
Your Balance: ${Se.toFixed(6)} ${Q}
Shortfall: ${Ur.toFixed(6)} ${Q}

Please add more ${Q} to your wallet.`}}return ja<vn?{hasEnoughBalance:!1,message:`Insufficient BNB for gas fees!

You have enough ${Q} but need BNB for transaction fees.
Required: ${vn.toFixed(6)} BNB
Your Balance: ${ja.toFixed(6)} BNB

Please add at least ${vn.toFixed(6)} BNB to your wallet for gas fees.`}:{hasEnoughBalance:!0,message:""}}}catch(Y){return console.error("Error checking balance:",Y),{hasEnoughBalance:!1,message:`Failed to check balance: ${Y.message||"Unknown error"}`}}},a0=async j=>{var Q,le;console.log(" handleLockFunds: Starting fund lock process:",j);const Y=t.find(ce=>ce.id===j);if(!Y){U.error("Order not found");return}try{console.log(" Checking balance before lock..."),U.loading("Checking balance...",{id:"lock-flow"});const ce=await gb(Y);if(!ce.hasEnoughBalance){U.error(ce.message,{id:"lock-flow",duration:1e4});return}U.dismiss("lock-flow");const he=localStorage.getItem("authToken")||"";console.log(" Step 1: Getting OTP..."),U.loading("Preparing fund lock...",{id:"lock-flow"});const ve=await fetch(`/api/orders/${j}/prepare-lock`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${he}`}});if(!ve.ok){const Ra=await ve.json();throw new Error(Ra.error||"Failed to prepare lock")}const Oe=await ve.json();console.log(" Step 1 Complete: OTP received:",Oe.data.otp),console.log(" OTP Hash:",Oe.data.otpHash),U.success(`OTP: ${Oe.data.otp} - SAVE THIS!`,{id:"lock-flow",duration:8e3,icon:""});const xe=Ba.getWalletInstructions();if(!window.confirm(` Your OTP: ${Oe.data.otp}

 SAVE THIS OTP!

Your funds will be locked for 2 hours. Once you have received the funds, please click the 'Received' button to confirm.

 ${xe}

Click OK to lock ${Y==null?void 0:Y.amount} ${Y==null?void 0:Y.token} on blockchain.`)){U.error("Lock cancelled",{id:"lock-flow"});return}console.log(" Step 2: Creating trade and locking funds..."),U.loading("Creating trade and locking funds on blockchain...",{id:"lock-flow"}),console.log(" Wallet instructions:",Ba.getWalletInstructions());const Se=(Y==null?void 0:Y.token)||"BNB",gt=ph[Se]||ph.BNB,ps=gt.address,ja=gt.isNative||!1;let vn="";(Y==null?void 0:Y.adType)==="SELL"?vn=Y.buyerAddress:vn=Y.adOwnerAddress||Y.buyerAddress;let Ur,_u,ku;try{const Ra=await Ba.createTradeAndLockFunds({token:ps,amount:((Q=Y==null?void 0:Y.amount)==null?void 0:Q.toString())||"0",buyer:vn,isNativeBNB:ja},ps,((le=Y==null?void 0:Y.amount)==null?void 0:le.toString())||"0");Ur=Ra.tradeId,_u=Ra.createTradeTxHash,ku=Ra.lockFundsTxHash,console.log(" Step 2 Complete: Trade created and funds locked!"),console.log(" Trade ID:",Ur),console.log(" Create Trade TX Hash:",_u),console.log(" Lock Funds TX Hash:",ku);try{const l0=await Ba.verifyTradeStatus(Number(Ur));console.log(" Post-lock verify:",l0),!l0.isReleased&&l0.blockchainStatusName!=="LOCKED"&&U("Chain not yet LOCKED, retry after a few seconds.",{icon:""})}catch(l0){console.warn("Post-lock verification failed:",l0)}U.success(`Trade created and funds locked! ID: ${Ur}`,{id:"lock-flow",duration:5e3})}catch(Ra){console.error(" Step 2 FAILED:",Ra),U.error(`Failed to create trade and lock funds: ${Ra.message}`,{id:"lock-flow",duration:8e3});return}console.log(" Step 3: Updating database..."),console.log(" Step 3: Data to send:",{txHash:ku,otpHash:Oe.data.otpHash,blockchainTradeId:Ur,blockchainTradeIdType:typeof Ur,createTradeTxHash:_u});const wb=Number(Ur);if(isNaN(wb)||wb<=0){console.error(" Step 3: Invalid blockchain trade ID:",Ur),U.error("Invalid blockchain trade ID. Please try again.",{id:"lock-flow"});return}console.log(" Step 3: Validated trade ID to send:",wb),U.loading("Finalizing...",{id:"lock-flow"});const NR=await fetch(`/api/orders/${j}/lock-funds`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${he}`},body:JSON.stringify({txHash:ku,otpHash:Oe.data.otpHash,blockchainTradeId:wb,createTradeTxHash:_u})});if(NR.ok)console.log(" Step 3 Complete: Database updated"),U.success(`Funds locked successfully!
OTP: ${Oe.data.otp}
Trade ID: ${Ur}`,{id:"lock-flow",duration:1e4,icon:""}),console.log(" View TX: https://bscscan.com/tx/"+ku),qr();else{const Ra=await NR.json();U.error(Ra.error||"Failed to finalize",{id:"lock-flow"})}}catch(ce){console.error(" handleLockFunds Error:",ce),U.error("Failed to lock funds",{id:"lock-flow"})}},c0=async j=>{console.log(" handleRejectOrder: Rejecting order:",j);try{const Y=localStorage.getItem("authToken")||"";console.log(" handleRejectOrder: Token exists:",!!Y);const Q=await fetch(`/api/orders/${j}/cancel`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Y}`},body:JSON.stringify({reason:"Rejected by seller"})});if(console.log(" handleRejectOrder: Response status:",Q.status),Q.ok)console.log(" handleRejectOrder: Order rejected successfully"),U.success("Order rejected"),qr();else{let le="Failed to reject order";try{const ce=await Q.json();le=(ce==null?void 0:ce.error)||le,console.log(" handleRejectOrder: Error response:",ce)}catch{}console.error(" handleRejectOrder: Failed to reject order:",le),U.error(le)}}catch(Y){console.error(" handleRejectOrder: Error:",Y),U.error("Failed to reject order")}},SN=j=>{console.log(" handleEditAd: Starting to edit ad:",j.id),p(j),x({priceInr:j.priceInr,minAmount:j.minAmount,maxAmount:j.maxAmount,active:j.active})},yb=async()=>{if(f){console.log(" handleUpdateAd: Updating ad:",f.id);try{const j=localStorage.getItem("authToken")||"";console.log(" handleUpdateAd: Token exists:",!!j);const Y=await fetch(`/api/ads/${f.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify({price_inr:parseFloat(y.priceInr),min_amount:parseFloat(y.minAmount),max_amount:parseFloat(y.maxAmount),active:y.active})});if(console.log(" handleUpdateAd: Response status:",Y.status),Y.ok)console.log(" handleUpdateAd: Ad updated successfully"),U.success("Ad updated successfully"),p(null),Ff();else{let Q="Failed to update ad";try{const le=await Y.json();Q=(le==null?void 0:le.error)||Q,console.log(" handleUpdateAd: Error response:",le)}catch{}console.error(" handleUpdateAd: Failed to update ad:",Q),U.error(Q)}}catch(j){console.error(" handleUpdateAd: Error:",j),U.error("Failed to update ad")}}},TN=async j=>{if(console.log(" handleDeleteAd: Deleting ad:",j),!!confirm("Are you sure you want to delete this ad? This action cannot be undone."))try{const Y=localStorage.getItem("authToken")||"";console.log(" handleDeleteAd: Token exists:",!!Y);const Q=await fetch(`/api/ads/${j}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Y}`}});if(console.log(" handleDeleteAd: Response status:",Q.status),Q.ok)console.log(" handleDeleteAd: Ad deleted successfully"),U.success("Ad deleted successfully"),Ff();else{let le="Failed to delete ad";try{const ce=await Q.json();le=(ce==null?void 0:ce.error)||le,console.log(" handleDeleteAd: Error response:",ce)}catch{}console.error(" handleDeleteAd: Failed to delete ad:",le),U.error(le)}}catch(Y){console.error(" handleDeleteAd: Error:",Y),U.error("Failed to delete ad")}},Tu=async j=>{try{const Y=localStorage.getItem("authToken")||"",Q=await fetch(`/api/disputes/${j}/status`,{headers:{Authorization:`Bearer ${Y}`}});if(Q.ok){const le=await Q.json();return B(ce=>({...ce,[j]:le.data})),le.data}}catch(Y){console.error("Error fetching dispute status:",Y)}return null},Ia=async(j,Y)=>{var Q,le;try{const ce=t.find(we=>we.id===j);if(!ce){U.error("Order not found");return}if(console.log(ce),ce.state!=="LOCKED"&&ce.state!=="UNDER_DISPUTE"&&ce.state!=="APPEALED"){U.error(`Order must be LOCKED, UNDER_DISPUTE, or APPEALED to confirm payment. Current state: ${ce.state}`);return}let he=(ce==null?void 0:ce.blockchain_trade_id)||(ce==null?void 0:ce.blockchainTradeId);if(!he){console.log(" Blockchain trade ID not in order, fetching from dispute status...");const we=await Tu(j);he=Number((we==null?void 0:we.blockchain_trade_id)||(we==null?void 0:we.blockchainTradeId))}if(!he||Number.isNaN(he)){U.error("Missing blockchain trade id. The order may not have been locked on the blockchain yet. Please wait for the seller to lock funds."),console.error("Missing blockchain_trade_id for order:",{orderId:j,orderState:ce.state,orderData:ce});return}Y==="SENT"?(console.log(" Buyer confirming payment sent (OFF-CHAIN only)..."),console.log(" NEW FLOW: Buyer confirmation is off-chain, no blockchain transaction needed")):(console.log(" Seller confirming payment received (ON-CHAIN)..."),console.log(" NEW FLOW: Seller confirmation will release funds immediately to buyer"),await Ba.confirmReceived(he));const ve=localStorage.getItem("authToken")||"",Oe=Y==="SENT"?`/api/disputes/${j}/confirm-payment-sent`:`/api/disputes/${j}/confirm-payment-received`,xe=await fetch(Oe,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`}});if(xe.ok){const we=await xe.json();U.success(we.data.message||"Payment confirmation recorded"),Tu(j),qr()}else{const we=await xe.json();U.error(we.error||"Failed to confirm payment")}}catch(ce){console.error("Error confirming payment:",ce),(Q=ce==null?void 0:ce.message)!=null&&Q.includes("cancelled")||(le=ce==null?void 0:ce.message)!=null&&le.includes("rejected")||(ce==null?void 0:ce.code)==="ACTION_REJECTED"||(ce==null?void 0:ce.code)===4001?U("Payment confirmation cancelled. You can try again when ready.",{icon:"",duration:4e3}):U.error((ce==null?void 0:ce.reason)||(ce==null?void 0:ce.message)||"Failed to confirm payment")}},Hf=j=>{if(!pe){U.error("Please connect your wallet first");return}const Q=window.location.href.split("/#")[0],le=pe;let ce;Q.includes("/orders")?ce=`${Q}/appeal/${le}/${j}`:ce=`${Q}/orders/appeal/${le}/${j}`,tt({isOpen:!0,appealUrl:ce,orderId:j})},_N=async(j,Y)=>{try{const Q=localStorage.getItem("authToken")||"",le=await fetch(`/api/disputes/${j}/appeal`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Q}`},body:JSON.stringify(Y)});if(le.ok){const ce=await le.json();U.success(ce.data.message||"Appeal filed successfully"),Tu(j),Z({isOpen:!1,orderId:""})}else{const ce=await le.json();U.error(ce.error||"Failed to file appeal")}}catch(Q){console.error("Error filing appeal:",Q),U.error("Failed to file appeal")}},kN=j=>{Z({isOpen:!0,orderId:j}),Tu(j)},K=j=>{const Y=Math.floor(j/60),Q=j%60;return`${Y}:${Q.toString().padStart(2,"0")}`},te=()=>{const j="2025-10-21T23:20:52.347Z",Y=new Date(j),Q=5.5*60*60*1e3,le=new Date(Y.getTime()+Q);console.log(" Timezone Conversion Test:",{inputUTC:j,utcDate:Y.toISOString(),istOffset:"+05:30 (5.5 hours)",istOffsetMs:Q,istDate:le.toISOString(),istFormatted:re(le),expectedIST:"22/10/2025, 04:50:52"})};A.useEffect(()=>{te()},[]);const re=j=>j.toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),be=A.useCallback(j=>{const Y=new Date(j),Q=5.5*60*60*1e3,le=new Date(Y.getTime()+Q),ce=le.getDate(),ve=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][le.getMonth()],Oe=le.getHours(),xe=le.getMinutes(),we=Oe>=12?"PM":"AM",Se=Oe%12||12,gt=xe.toString().padStart(2,"0");return`${ce} ${ve} ${Se}:${gt} ${we}`},[]),Me=A.useCallback(j=>{const Y=new Date(j.startTime),Q=5.5*60*60*1e3,le=new Date(Y.getTime()+Q),ce=new Date(le.getTime()+XE.ACCEPT_TIMEOUT_MINUTES*60*1e3),he=new Date(m),ve=new Date(he.getTime()+Q),Oe=ce.getTime()-ve.getTime(),xe=Math.max(0,Math.floor(Oe/1e3));return{isExpired:xe<=0,timeRemainingSeconds:xe,startTimeIST:re(le),expiryTimeIST:re(ce)}},[m]),at=A.useCallback(j=>{if(!j.lockExpiresAt)return{isExpired:!1,timeRemainingSeconds:0,timeRemainingHours:0,timeRemainingMinutes:0,timeRemainingSecs:0,lockExpiresAtIST:""};const Y=new Date(j.lockExpiresAt),Q=5.5*60*60*1e3,le=new Date(Y.getTime()+Q),ce=new Date(m),he=new Date(ce.getTime()+Q),ve=le.getTime()-he.getTime(),Oe=Math.max(0,Math.floor(ve/1e3)),xe=Oe<=0,we=Math.floor(Oe/3600),Se=Math.floor(Oe%3600/60),gt=Oe%60;return{isExpired:xe,timeRemainingSeconds:Oe,timeRemainingHours:we,timeRemainingMinutes:Se,timeRemainingSecs:gt,lockExpiresAtIST:re(le)}},[m]),mt=A.useCallback((j,Y,Q)=>`${j.toString().padStart(2,"0")}:${Y.toString().padStart(2,"0")}:${Q.toString().padStart(2,"0")}`,[]),Xe=A.useCallback(j=>{switch(j){case"CREATED":return"text-yellow-400 bg-yellow-500/20";case"ACCEPTED":return"text-blue-400 bg-blue-500/20";case"LOCKED":return"text-purple-400 bg-purple-500/20";case"RELEASED":return"text-green-400 bg-green-500/20";case"CANCELLED":return"text-red-400 bg-red-500/20";case"EXPIRED":return"text-gray-500 bg-gray-600/20";case"UNDER_DISPUTE":return"text-orange-400 bg-orange-500/20";case"REFUNDED":return"text-gray-400 bg-gray-500/20";default:return"text-gray-400 bg-gray-500/20"}},[]),et=A.useCallback(()=>/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),[]);A.useCallback(async()=>{if(!et())return"desktop";try{if(navigator.permissions&&navigator.permissions.query){const Y=await navigator.permissions.query({name:"microphone"});if(console.log(" Microphone permission status:",Y.state),Y.state==="granted"||Y.state==="prompt")return"mobile-browser"}try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(Q=>Q.stop()),"mobile-browser"}catch(Y){return console.log(" Microphone access check:",Y),"mobile-app"}}catch(Y){return console.log(" Permission check error:",Y),"mobile-browser"}},[et]);const He=A.useCallback(async j=>{var Q,le,ce;const Y=j==null?void 0:j.toLowerCase();if(Y){if(ie[Y])return ie[Y];if(rt.current.has(Y))return new Promise(he=>{const ve=setInterval(()=>{ie[Y]?(clearInterval(ve),he(ie[Y])):rt.current.has(Y)||(clearInterval(ve),he(void 0))},100)});rt.current.add(Y);try{const he=await fetch(`/api/auth/user-by-address?address=${j}`);if(he.ok){const ve=await he.json(),Oe={name:(Q=ve==null?void 0:ve.data)==null?void 0:Q.name,mobile:((le=ve==null?void 0:ve.data)==null?void 0:le.mobile)||((ce=ve==null?void 0:ve.data)==null?void 0:ce.phone)};return ae(xe=>({...xe,[Y]:Oe})),Oe}}catch(he){console.log("Error fetching user info:",he)}finally{rt.current.delete(Y)}}},[ie]),it=A.useCallback(async(j,Y)=>{try{if(!pe){U.error("Please connect your wallet first");return}const Q=Y.sellerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),le=Q?Y.buyerAddress:Y.sellerAddress,he=(ie[le.toLowerCase()]||{}).mobile,ve=(Q?Y.buyerName:Y.sellerName)||"User";if(!he){U.loading("Fetching contact number...",{id:"fetch-phone"});const Oe=await He(le);if(Oe&&typeof Oe=="object"&&"mobile"in Oe&&Oe.mobile)return U.dismiss("fetch-phone"),it(le,Y);U.error("Phone number not available for this user",{id:"fetch-phone"});return}ue({isOpen:!0,phoneNumber:he,userName:ve})}catch(Q){console.error("Error handling call:",Q),U.error("Failed to initiate call")}},[pe,ie,He]),Et=A.useMemo(()=>u==="ALL"?t:t.filter(j=>j.state===u),[t,u]);A.useEffect(()=>{if(t.length!==0)return ht.current&&clearTimeout(ht.current),ht.current=setTimeout(()=>{const j=new Set;t.forEach(Q=>{j.add(Q.buyerAddress.toLowerCase()),j.add(Q.sellerAddress.toLowerCase())});const Y=Array.from(j).filter(Q=>!ie[Q]&&!rt.current.has(Q));Y.length>0&&(console.log(" Orders: Fetching user info for",Y.length,"unique addresses"),Y.forEach(async Q=>{try{await He(Q)}catch(le){console.log("Error fetching user info for",Q,le)}}))},500),()=>{ht.current&&clearTimeout(ht.current)}},[t,He]),A.useEffect(()=>{if(oe.isOpen&&oe.orderId){const j=t.find(Y=>Y.id===oe.orderId);if(j){const Y=j.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),Q=j.sellerAddress.toLowerCase(),le=ie[Q]||{};Y&&!le.mobile&&Q&&He(Q)}}},[oe.isOpen,oe.orderId,t,pe,ie,He]);const Rt=A.useCallback(j=>{if(!j.lockExpiresAt)return{canRedeem:!1,timeRemainingSeconds:0,timeRemainingHours:0,timeRemainingMinutes:0,timeRemainingSecs:0,redeemEligibleAt:null,redeemEligibleAtIST:""};const Q=new Date(j.lockExpiresAt).getTime()+48*60*60*1e3,ce=Q-m,he=Math.max(0,Math.floor(ce/1e3)),ve=he<=0,Oe=Math.floor(he/3600),xe=Math.floor(he%3600/60),we=he%60,Se=ve?null:new Date(Q),gt=Se?re(Se):"";return{canRedeem:ve,timeRemainingSeconds:he,timeRemainingHours:Oe,timeRemainingMinutes:xe,timeRemainingSecs:we,redeemEligibleAt:Se,redeemEligibleAtIST:gt}},[m]),pr=async j=>{var Y,Q,le,ce;try{const he=Number((j==null?void 0:j.blockchain_trade_id)||(j==null?void 0:j.blockchainTradeId));if(!he||Number.isNaN(he)){U.error("Missing blockchain trade id. This order may not have been locked on the blockchain yet."),console.error("Missing blockchain_trade_id for redeem:",{orderId:j.id,orderState:j.state,orderData:j});return}const ve=Rt(j);if(!ve.canRedeem){U.error(`Refund not yet available. Please wait ${ve.timeRemainingHours}h ${ve.timeRemainingMinutes}m more.`,{duration:6e3});return}if(!window.confirm(` Claim Refund

You will receive:
- Original Amount: ${j.amount} ${j.token}
- Extra (1%): ${(parseFloat(j.amount.toString())*.01).toFixed(6)} ${j.token}
- Total: ${(parseFloat(j.amount.toString())*1.01).toFixed(6)} ${j.token}

This will refund your funds if buyer hasn't paid within 48 hours.

Continue?`)){U("Refund cancelled",{id:"redeem"});return}U.loading("Claiming refund on blockchain...",{id:"redeem"});const xe=await Ba.redeemAfterAppealWindow(he);U.success(` Refund claimed successfully!
You received: ${(parseFloat(j.amount.toString())*1.01).toFixed(6)} ${j.token}
TX: ${xe.slice(0,10)}...`,{id:"redeem",duration:1e4}),qr()}catch(he){console.error("Error redeeming:",he),(Y=he==null?void 0:he.reason)!=null&&Y.includes("Appeal deadline not passed")?U.error("Please wait for 48 hours appeal window to complete",{id:"redeem",duration:6e3}):(Q=he==null?void 0:he.reason)!=null&&Q.includes("Appeal already filed")?U.error("Buyer has filed an appeal. Admin will resolve the dispute.",{id:"redeem",duration:8e3}):(le=he==null?void 0:he.reason)!=null&&le.includes("Not in appeal window")?U.error("Appeal window not open yet. Please wait for 2 hours after lock.",{id:"redeem",duration:6e3}):(ce=he==null?void 0:he.reason)!=null&&ce.includes("Only seller")?U.error("Only seller can claim refund",{id:"redeem"}):U.error((he==null?void 0:he.reason)||(he==null?void 0:he.message)||"Failed to claim refund",{id:"redeem",duration:6e3})}},gn=async j=>{try{if(!(j.sellerAddress.toLowerCase()===(pe||"").toLowerCase())){U.error("Only seller can release funds on-chain");return}const Q=Number((j==null?void 0:j.blockchain_trade_id)||(j==null?void 0:j.blockchainTradeId));if(!Q||Number.isNaN(Q)){U.error("Missing blockchain trade id. Cannot release on-chain.");return}U.loading("Verifying on-chain status...",{id:"force-release"});const le=await Ba.verifyTradeStatus(Q);if(le.isReleased){U.success(" Already released on-chain!",{id:"force-release"}),qr();return}if(!window.confirm(` Database shows RELEASED but blockchain shows ${le.blockchainStatusName}.

Funds are still locked on blockchain. Do you want to release them now?

This will call confirmReceived() to release funds to buyer.

Trade ID: ${Q}
Amount: ${le.amount} ${le.token}`)){U.dismiss("force-release");return}U.loading("Releasing funds on-chain...",{id:"force-release"});const he=await Ba.confirmReceived(Q);console.log(" Funds released on-chain, TX:",he);try{const ve=localStorage.getItem("authToken")||"",Oe=await fetch(`/api/disputes/${j.id}/confirm-payment-received`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`}});if(Oe.ok){const xe=await Oe.json();console.log(" Backend updated:",xe)}else console.warn(" Backend update failed, but blockchain release succeeded")}catch(ve){console.warn(" Backend update error (blockchain release succeeded):",ve)}U.success(` Funds released on-chain! TX: ${he.slice(0,10)}...`,{id:"force-release",duration:8e3}),qr()}catch(Y){console.error(" Error releasing on-chain:",Y),U.error((Y==null?void 0:Y.reason)||(Y==null?void 0:Y.message)||"Failed to release on-chain",{id:"force-release",duration:8e3})}},Bt=async j=>{try{const Y=Number((j==null?void 0:j.blockchain_trade_id)||(j==null?void 0:j.blockchainTradeId));if(!Y||Number.isNaN(Y)){U.error("Missing blockchain trade id. Cannot verify trade status.");return}U.loading("Checking blockchain status...",{id:"verify-status"});const Q=await Ba.verifyTradeStatus(Y);console.log(" Trade Status Verification:",Q);const le=j.state,ce=Q.blockchainStatusName;let he="",ve=!1;const Oe=Q.isReleased||Q.blockchainStatus===6,xe=Q.blockchainStatus===6;if(le==="RELEASED"&&!Oe)j.sellerAddress.toLowerCase()===(pe||"").toLowerCase()?he=` Database shows RELEASED but blockchain shows ${ce}. Click "Release On-Chain" button below to release funds.`:he=` Database shows RELEASED but blockchain shows ${ce}. Seller needs to call confirmReceived() to release funds.`,ve=!0;else if(le!=="RELEASED"&&Oe){he=` Blockchain shows ${ce} (funds released) but database shows ${le}. Auto-syncing...`,ve=!0,U.loading("Syncing order status with blockchain...",{id:"verify-status"});try{const we=localStorage.getItem("authToken")||"",Se=await fetch(`/api/orders/${j.id}/sync-blockchain-status`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${we}`}});if(Se.ok){const gt=await Se.json();console.log(" Blockchain status synced automatically:",gt),setTimeout(()=>{var ps;qr(),(ps=gt.data)!=null&&ps.synced?U.success(` Order status synced! Updated from ${gt.data.previousState} to ${gt.data.newState}`,{id:"verify-status",duration:6e3}):U.success(` Order status verified! Already in sync (${gt.data.currentState})`,{id:"verify-status",duration:5e3})},1e3);return}else console.warn(" Failed to sync blockchain status automatically"),setTimeout(()=>{qr(),U("Order refreshed. Please verify status again.",{id:"verify-status",duration:5e3})},2e3)}catch(we){console.error("Error auto-syncing:",we),setTimeout(()=>{qr(),U("Order refreshed. Please verify status again.",{id:"verify-status",duration:5e3})},2e3)}}else le===ce||le==="RELEASED"&&Oe?(he=` Status synced! Both database and blockchain show ${ce||"RELEASED"}.`,ve=!1):(he=` Database: ${le}, Blockchain: ${ce}`,ve=!1);U.dismiss("verify-status"),ve?U.error(he,{id:"verify-status",duration:8e3}):U.success(he,{id:"verify-status",duration:5e3}),console.log(" Verification Details:",{tradeId:Q.tradeId,databaseState:le,blockchainStatus:Q.blockchainStatusName,blockchainStatusNumber:Q.blockchainStatus,isReleased:Q.isReleased,buyerPaid:Q.buyerPaid,sellerReceived:Q.sellerReceived,amount:Q.amount,token:Q.token})}catch(Y){console.error("Error verifying trade status:",Y),U.error(`Failed to verify: ${Y.message}`,{id:"verify-status"})}};return a.jsxs("div",{className:"px-6 space-y-6",children:[a.jsxs("div",{className:"relative text-center space-y-2",children:[I&&a.jsx(X.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-500 to-blue-500 rounded-lg p-3 mx-auto max-w-sm",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm font-medium",children:"Call Active"})]})}),S.isOpen&&a.jsx(X.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg p-3 mx-auto max-w-sm",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm font-medium",children:"Call Modal Open"})]})}),z&&a.jsx(X.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-500 to-blue-500 rounded-xl p-6 mx-auto max-w-sm text-white",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto",children:a.jsx(dn,{size:32,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Incoming Call"}),a.jsxs("p",{className:"text-sm opacity-90",children:["From: ",z.from.slice(0,8),"...",z.from.slice(-6)]})]}),a.jsxs("div",{className:"flex space-x-4",children:[a.jsxs(X.button,{onClick:ei,className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",whileTap:{scale:.95},children:[a.jsx(xr,{size:20}),a.jsx("span",{children:"Reject"})]}),a.jsxs(X.button,{onClick:Xs,className:"flex-1 bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",whileTap:{scale:.95},children:[a.jsx(dn,{size:20}),a.jsx("span",{children:"Accept"})]})]})]})})]}),ot&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Connection Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:ot})]}),a.jsx("button",{onClick:Tn,className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),w&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Orders Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:w})]}),a.jsx("button",{onClick:()=>b(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),v&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Ads Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:v})]}),a.jsx("button",{onClick:()=>E(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),k&&a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[a.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Action Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:k})]}),a.jsx("button",{onClick:()=>C(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:16})})]}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-1 border border-white/20",children:a.jsx("div",{className:"grid grid-cols-2 gap-1",children:["orders","ads"].map(j=>a.jsxs(X.button,{onClick:()=>d(j),className:zn("py-3 px-4 rounded-lg font-medium transition-all capitalize",l===j?"bg-gradient-to-r from-blue-500 to-purple-500 text-white":"text-gray-300 hover:text-white"),whileTap:{scale:.98},children:["My ",j]},j))})}),a.jsx("div",{className:" right-0 top-0",children:a.jsx("select",{value:u,onChange:j=>h(j.target.value),className:"text-white bg-slate-900 text-sm rounded-md px-3 py-2",title:"Filter by status",children:["ALL","CREATED","ACCEPTED","LOCKED","RELEASED","CANCELLED","EXPIRED","UNDER_DISPUTE","UNDER_REVIEW","APPEALED","CONFIRMED","REFUNDED"].map(j=>a.jsx("option",{value:j,children:j},j))})}),l==="orders"?a.jsx("div",{className:"space-y-4",children:s?a.jsx("div",{className:"space-y-4",children:[1,2,3].map(j=>a.jsxs("div",{className:"bg-white/10 rounded-xl p-4 animate-pulse",children:[a.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-3 bg-white/20 rounded w-1/2"})]},j))}):Et.length===0?a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 space-y-4",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-500/20 rounded-full flex items-center justify-center mx-auto",children:a.jsx(Pr,{size:32,className:"text-gray-400"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:"No Orders Yet"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Your order requests will appear here"})]})]}):a.jsx(Do,{children:a.jsx("div",{className:"h-[400px] rounded-sm overflow-y-auto ",children:Et.map(j=>{var Oe,xe;const Y=Me(j),Q=Y.isExpired,le=Y.timeRemainingSeconds,ce=j.sellerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),he=j.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),ve=((Oe=j.adOwnerAddress)==null?void 0:Oe.toLowerCase())===(pe==null?void 0:pe.toLowerCase());return a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white/10 backdrop-blur-lg  mb-2 orounded-xl p-4 border border-white/20 space-y-4",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"space-y-1 flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"text-white font-semibold",children:[j.amount," ",j.token]}),a.jsx("span",{className:zn("px-2 py-1 rounded text-xs font-medium",Xe(j.state)),children:j.state})]}),a.jsxs("p",{className:"text-gray-300 text-sm",children:[ce?"Buyer":"Seller",": ",(ce?j.buyerAddress:j.sellerAddress).slice(0,8)+"..."+(ce?j.buyerAddress:j.sellerAddress).slice(-6)]}),a.jsxs("p",{className:"text-xs text-gray-400",children:["Name: ",(ce?j.buyerName:j.sellerName)||""]}),a.jsxs("p",{className:"text-xs text-gray-400",children:["Mobile: ",((xe=ie[(ce?j.buyerAddress:j.sellerAddress).toLowerCase()])==null?void 0:xe.mobile)||""]}),a.jsxs("p",{className:"text-xs text-gray-400",children:["You are the ",ce?"Seller":"Buyer"," in this order",ve&&j.state==="CREATED"&&!Q&&a.jsx("span",{className:"text-green-400 font-semibold",children:" - You can Accept/Reject (Ad Owner)"})]}),a.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded px-2 py-1 mt-1 inline-block",children:a.jsxs("p",{className:"text-xs text-blue-300",children:[" Created: ",a.jsx("span",{className:"font-semibold",children:be(j.startTime)})]})})]}),j.state==="CREATED"&&a.jsxs("div",{className:"text-right space-y-1 ml-4",children:[a.jsx("p",{className:`font-mono text-xl font-bold ${Q?"text-gray-500":le<60?"text-red-500 animate-pulse":"text-yellow-400"}`,children:Q?"0:00":K(le)}),!Q&&le>0&&a.jsxs("p",{className:"text-xs text-green-400 animate-pulse",children:[" Live countdown: ",le," seconds"]}),a.jsx("p",{className:"text-gray-400 text-xs",children:Q?"expired":"remaining"}),a.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5 mt-2",children:a.jsx("div",{className:`h-1.5 rounded-full transition-all ${Q?"bg-gray-500":le<60?"bg-red-500":"bg-yellow-400"}`,style:{width:`${Q?0:le/300*100}%`}})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"of 5:00 min"})]}),a.jsx("div",{className:"flex space-x-2",children:a.jsxs(X.button,{onClick:()=>{const we=ve?ce?j.buyerAddress:j.sellerAddress:j.adOwnerAddress||(he?j.sellerAddress:j.buyerAddress);it(we,j)},className:"p-3 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg hover:from-blue-600 hover:to-purple-600 transition-all duration-200 flex items-center space-x-2",whileTap:{scale:.95},whileHover:{scale:1.05},title:`Call ${ve?"Order Creator":"Ad Owner"}`,children:[a.jsx(kC,{size:18}),a.jsx("span",{className:"text-sm font-medium",children:"Call"})]})})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-3 space-y-2",children:[a.jsx("p",{className:"text-white text-sm font-medium",children:j.agentBranch}),a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-gray-300 text-xs",children:j.agentAddress}),a.jsx("p",{className:"text-gray-300 text-xs",children:j.agentNumber})]})})]}),j.state==="CREATED"&&ve&&!Q&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-center space-x-2 text-green-400",children:[a.jsx(kt,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:"Action Required: Accept or Reject this order"})]})}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs(X.button,{onClick:()=>zf(j.id),disabled:Q,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white py-2 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",whileTap:{scale:.98},children:[a.jsx(kt,{size:16}),a.jsx("span",{children:"Accept"})]}),a.jsxs(X.button,{onClick:()=>c0(j.id),className:"flex-1 bg-gradient-to-r from-red-500 to-pink-500 text-white py-2 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",whileTap:{scale:.98},children:[a.jsx(xr,{size:16}),a.jsx("span",{children:"Reject"})]})]})]}),j.state==="ACCEPTED"&&ce&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"bg-orange-500/20 border border-orange-500/30 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-orange-400",children:[a.jsx(Wa,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:"Action Required: Lock your funds on blockchain"})]}),a.jsxs("p",{className:"text-xs text-orange-300 mt-2",children:["Order accepted! Now you need to lock ",j.amount," ",j.token," as escrow."]}),a.jsxs("div",{className:"mt-2 p-2 bg-blue-500/10 border border-blue-500/20 rounded text-xs text-blue-300",children:[" ",Ba.getWalletInstructions()]})]}),a.jsxs(X.button,{onClick:()=>a0(j.id),className:"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 shadow-lg hover:from-orange-600 hover:to-red-600 transition-all",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsx(Wa,{size:18}),a.jsx("span",{children:" Lock Funds on Blockchain"})]})]}),!1,he&&a.jsxs("div",{className:"space-y-3",children:[j.state==="ACCEPTED"&&a.jsxs("div",{className:"flex items-center space-x-2 text-blue-400 bg-blue-500/20 p-3 rounded-lg",children:[a.jsx(kt,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:"Order accepted! Contact the agent to complete payment"})]}),j.state==="LOCKED"&&(()=>{const we=de.has(j.id),Se=at(j);return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-purple-400 bg-purple-500/20 p-3 rounded-lg",children:[a.jsx(Wa,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:" Funds locked - Proceed to agent for payment"})]}),j.lockExpiresAt&&a.jsxs("div",{className:"bg-gradient-to-r from-purple-500/20 to-blue-500/20 border border-purple-500/30 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Pr,{size:18,className:"text-purple-300"}),a.jsx("span",{className:"text-sm font-semibold text-purple-300",children:"Lock Expires In"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[Se.isExpired?a.jsx("span",{className:"text-red-400 text-sm font-bold",children:"EXPIRED"}):a.jsx("span",{className:`font-mono text-xl font-bold ${Se.timeRemainingHours===0&&Se.timeRemainingMinutes<30?"text-red-500 animate-pulse":Se.timeRemainingHours===0?"text-orange-400":"text-green-400"}`,children:mt(Se.timeRemainingHours,Se.timeRemainingMinutes,Se.timeRemainingSecs)}),a.jsx(X.button,{onClick:()=>je({isOpen:!0,orderId:j.id,userRole:"buyer"}),className:"p-2 rounded-full bg-yellow-500/20 hover:bg-yellow-500/30 border border-yellow-500/30 transition-colors",whileTap:{scale:.95},whileHover:{scale:1.1},title:"Important Instructions",children:a.jsx(qt,{size:20,className:"text-yellow-400"})})]})]}),!Se.isExpired&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all ${Se.timeRemainingHours===0&&Se.timeRemainingMinutes<30?"bg-red-500":Se.timeRemainingHours===0?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.max(0,Math.min(100,Se.timeRemainingSeconds/7200*100))}%`}})}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[a.jsxs("span",{children:["Lock expires at: ",Se.lockExpiresAtIST]}),a.jsxs("span",{children:[Se.timeRemainingHours,"h ",Se.timeRemainingMinutes,"m remaining"]})]})]}),Se.isExpired&&a.jsx("div",{className:"text-red-400 text-sm mt-2",children:" Lock period has expired. Appeal window is now open."})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(X.button,{onClick:()=>{ee({isOpen:!0,orderId:j.id}),_e(gt=>new Set(gt).add(j.id))},className:"flex-1 bg-gradient-to-r from-purple-500 to-blue-500 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 shadow-lg hover:from-purple-600 hover:to-blue-600 transition-all",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsx("span",{children:" View Payment Details"}),!we&&a.jsx("span",{className:"ml-2 bg-yellow-400 text-yellow-900 text-xs px-2 py-0.5 rounded-full font-bold",children:"New"})]}),he&&(j==null?void 0:j.blockchain_trade_id)&&a.jsxs(X.button,{onClick:()=>Ia(j.id,"SENT"),className:"bg-blue-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.98},title:"Confirm payment sent (off-chain only - no gas fee)",children:[a.jsx(kt,{size:18}),a.jsx("span",{children:"Confirm"})]})]})]})})(),j.state==="RELEASED"&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-green-400 bg-green-500/20 p-3 rounded-lg",children:[a.jsx(kt,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:"Order completed successfully!"})]}),(j==null?void 0:j.blockchain_trade_id)&&a.jsxs(X.button,{onClick:()=>Bt(j),className:"w-full bg-blue-500/20 border border-blue-500/30 text-blue-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"Verify if funds were actually released on blockchain",children:[a.jsx(kt,{size:14}),a.jsx("span",{children:" Verify Blockchain Status"})]}),(j==null?void 0:j.blockchain_trade_id)&&ce&&a.jsxs(X.button,{onClick:()=>gn(j),className:"w-full bg-orange-500/20 border border-orange-500/30 text-orange-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-orange-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"If blockchain still shows LOCKED, release funds on-chain",children:[a.jsx(Wa,{size:14}),a.jsx("span",{children:"Release On-Chain (Seller)"})]})]}),j.state==="CANCELLED"&&a.jsxs("div",{className:"flex items-center space-x-2 text-red-400 bg-red-500/20 p-3 rounded-lg",children:[a.jsx(xr,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:"Order was cancelled"})]})]}),ce&&j.state==="LOCKED"&&(()=>{const we=at(j);return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-purple-400 bg-purple-500/20 p-3 rounded-lg",children:[a.jsx(Wa,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:" Funds locked - Wait for buyer to complete payment"})]}),j.lockExpiresAt&&a.jsxs("div",{className:"bg-gradient-to-r from-purple-500/20 to-blue-500/20 border border-purple-500/30 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Pr,{size:18,className:"text-purple-300"}),a.jsx("span",{className:"text-sm font-semibold text-purple-300",children:"Lock Expires In"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[we.isExpired?a.jsx("span",{className:"text-red-400 text-sm font-bold",children:"EXPIRED"}):a.jsx("span",{className:`font-mono text-xl font-bold ${we.timeRemainingHours===0&&we.timeRemainingMinutes<30?"text-red-500 animate-pulse":we.timeRemainingHours===0?"text-orange-400":"text-green-400"}`,children:mt(we.timeRemainingHours,we.timeRemainingMinutes,we.timeRemainingSecs)}),a.jsx(X.button,{onClick:()=>je({isOpen:!0,orderId:j.id,userRole:"seller"}),className:"p-2 rounded-full bg-yellow-500/20 hover:bg-yellow-500/30 border border-yellow-500/30 transition-colors",whileTap:{scale:.95},whileHover:{scale:1.1},title:"Important Instructions",children:a.jsx(qt,{size:20,className:"text-yellow-400"})})]})]}),!we.isExpired&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all ${we.timeRemainingHours===0&&we.timeRemainingMinutes<30?"bg-red-500":we.timeRemainingHours===0?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.max(0,Math.min(100,we.timeRemainingSeconds/7200*100))}%`}})}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[a.jsxs("span",{children:["Lock expires at: ",we.lockExpiresAtIST]}),a.jsxs("span",{children:[we.timeRemainingHours,"h ",we.timeRemainingMinutes,"m remaining"]})]})]}),we.isExpired&&a.jsx("div",{className:"text-red-400 text-sm mt-2",children:" Lock period has expired. Appeal window is now open."})]}),we.isExpired&&(()=>{const Se=Rt(j);return a.jsxs("div",{className:"bg-gradient-to-r from-orange-500/20 to-red-500/20 border border-orange-500/30 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Pr,{size:18,className:"text-orange-300"}),a.jsx("span",{className:"text-sm font-semibold text-orange-300",children:Se.canRedeem?" Ready to Claim Refund":" Time Until Refund Available"})]}),a.jsx("div",{className:"flex items-center space-x-3",children:Se.canRedeem?a.jsx("span",{className:"text-green-400 text-sm font-bold",children:"ELIGIBLE"}):a.jsx("span",{className:`font-mono text-xl font-bold ${Se.timeRemainingHours===0&&Se.timeRemainingMinutes<60?"text-red-500 animate-pulse":Se.timeRemainingHours<6?"text-orange-400":"text-yellow-400"}`,children:mt(Se.timeRemainingHours,Se.timeRemainingMinutes,Se.timeRemainingSecs)})})]}),!Se.canRedeem&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all ${Se.timeRemainingHours===0&&Se.timeRemainingMinutes<60?"bg-red-500":Se.timeRemainingHours<6?"bg-orange-500":"bg-yellow-500"}`,style:{width:`${Math.max(0,Math.min(100,Se.timeRemainingSeconds/(48*60*60)*100))}%`}})}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[a.jsxs("span",{children:["Refund available at: ",Se.redeemEligibleAtIST||"Calculating..."]}),a.jsxs("span",{children:[Se.timeRemainingHours,"h ",Se.timeRemainingMinutes,"m remaining"]})]}),a.jsx("p",{className:"text-xs text-orange-300 mt-2",children:" After 48 hours from appeal window opening, you can claim your full refund (amount + 1% extra)"})]}),Se.canRedeem&&a.jsxs("div",{className:"mt-3",children:[a.jsx("p",{className:"text-sm text-green-300 mb-2",children:" 48 hours have passed! You can now claim your refund if buyer hasn't paid."}),a.jsxs(X.button,{onClick:()=>pr(j),className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 transition-all flex items-center justify-center space-x-2 shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},title:"Claim full refund (amount + 1% extra) after 48 hours appeal window",children:[a.jsx(xr,{size:18}),a.jsx("span",{children:" Claim Refund (Amount + 1% Extra)"})]}),a.jsxs("p",{className:"text-xs text-green-300 mt-2 text-center",children:["You will receive: ",j.amount," ",j.token," + ",(parseFloat(j.amount.toString())*.01).toFixed(6)," ",j.token," = ",(parseFloat(j.amount.toString())*1.01).toFixed(6)," ",j.token]})]})]})})(),(j==null?void 0:j.blockchain_trade_id)&&a.jsxs(X.button,{onClick:()=>Ia(j.id,"RECEIVED"),className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 transition-all flex items-center justify-center space-x-2 shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},title:"Confirm payment received (on-chain - releases funds to buyer)",children:[a.jsx(kt,{size:18}),a.jsx("span",{children:" Confirm Payment Received"})]})]})})(),ce&&j.state==="RELEASED"&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 text-green-400 bg-green-500/20 p-3 rounded-lg",children:[a.jsx(kt,{size:16}),a.jsx("span",{className:"text-sm font-medium",children:" Funds released to buyer! Order completed successfully."})]}),(j==null?void 0:j.blockchain_trade_id)&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs(X.button,{onClick:()=>Bt(j),className:"w-full bg-blue-500/20 border border-blue-500/30 text-blue-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"Verify if funds were actually released on blockchain",children:[a.jsx(kt,{size:14}),a.jsx("span",{children:" Verify Blockchain Status"})]}),a.jsxs(X.button,{onClick:()=>gn(j),className:"w-full bg-orange-500/20 border border-orange-500/30 text-orange-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-orange-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"If database shows RELEASED but blockchain shows LOCKED, click to release funds on-chain",children:[a.jsx(Wa,{size:14}),a.jsx("span",{children:" Release On-Chain (Seller)"})]})]})]}),["LOCKED","UNDER_DISPUTE","APPEALED"].includes(j.state)&&(j.state==="LOCKED"&&!at(j).isExpired?null:a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"bg-gradient-to-r from-purple-500/20 to-blue-500/20 border border-purple-500/30 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(eE,{size:18,className:"text-purple-400"}),a.jsx("span",{className:"text-purple-300 font-medium",children:"Dispute Resolution"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[(j==null?void 0:j.blockchain_trade_id)&&a.jsx("button",{onClick:()=>Bt(j),className:"text-blue-400 hover:text-blue-300 text-sm px-2 py-1 rounded bg-blue-500/20 hover:bg-blue-500/30 transition-colors",title:"Verify trade status on blockchain",children:" Verify Status"}),a.jsx("button",{onClick:()=>kN(j.id),className:"text-purple-400 hover:text-purple-300 text-sm",children:"View Details"})]})]}),a.jsxs("div",{className:"space-y-2",children:[j.state==="LOCKED"&&(()=>{const we=at(j);return a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm text-blue-300",children:" Funds locked - Buyer confirms off-chain, Seller confirms on-chain to release funds"}),j.lockExpiresAt&&a.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-2",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs text-blue-300",children:"Lock Expires:"}),we.isExpired?a.jsx("span",{className:"text-red-400 text-xs font-bold",children:"EXPIRED"}):a.jsx("span",{className:`font-mono text-sm font-bold ${we.timeRemainingHours===0&&we.timeRemainingMinutes<30?"text-red-400":"text-blue-300"}`,children:mt(we.timeRemainingHours,we.timeRemainingMinutes,we.timeRemainingSecs)})]})})]})})(),j.state==="UNDER_DISPUTE"&&a.jsx("div",{className:"text-sm text-orange-300",children:" Dispute filed - 48 hours to appeal"}),j.state==="UNDER_REVIEW"&&a.jsx("div",{className:"text-sm text-purple-300",children:" Under admin review"})]}),a.jsxs("div",{className:"flex space-x-2 mt-3",children:[j.state==="LOCKED"&&a.jsxs(a.Fragment,{children:[he&&(j==null?void 0:j.blockchain_trade_id)&&a.jsxs(X.button,{onClick:()=>Ia(j.id,"SENT"),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-700",whileTap:{scale:.95},title:"Confirm payment sent (off-chain only - no gas fee)",children:[a.jsx(kt,{size:14,className:"inline mr-1"}),"Confirm Payment Sent"]}),ce&&(j==null?void 0:j.blockchain_trade_id)&&a.jsxs(X.button,{onClick:()=>Ia(j.id,"RECEIVED"),className:"flex-1 bg-green-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-green-700",whileTap:{scale:.95},title:"Confirm payment received (on-chain - releases funds to buyer)",children:[a.jsx(kt,{size:14,className:"inline mr-1"}),"Confirm Payment Received"]}),!(j!=null&&j.blockchain_trade_id)&&a.jsx("div",{className:"flex-1 bg-yellow-500/20 border border-yellow-500/30 rounded-md px-3 py-2 text-xs text-yellow-300",children:" Waiting for blockchain trade ID..."})]}),["UNDER_DISPUTE"].includes(j.state)&&a.jsxs(X.button,{onClick:()=>Hf(j.id),className:"flex-1 bg-orange-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-orange-700",whileTap:{scale:.95},children:[a.jsx(ll,{size:14,className:"inline mr-1"}),"File Appeal"]}),j.state==="LOCKED"&&(()=>{const we=Rt(j);return!(j.sellerAddress.toLowerCase()===(pe||"").toLowerCase())||!(j!=null&&j.blockchain_trade_id)?null:we.canRedeem?a.jsxs(X.button,{onClick:()=>pr(j),className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:from-green-700 hover:to-emerald-700 shadow-lg",whileTap:{scale:.95},title:"Claim full refund (amount + 1% extra)",children:[a.jsx(xr,{size:14,className:"inline mr-1"})," Claim Refund"]}):a.jsxs("div",{className:"flex-1 bg-orange-500/20 border border-orange-500/30 rounded-md px-3 py-2 text-xs text-orange-300",children:[" Refund in ",we.timeRemainingHours,"h ",we.timeRemainingMinutes,"m"]})})()]})]})}))]},j.id)})})})}):a.jsx("div",{className:"space-y-4",children:o?a.jsx("div",{className:"space-y-4",children:[1,2,3].map(j=>a.jsxs("div",{className:"bg-white/10 rounded-xl p-4 animate-pulse",children:[a.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-3 bg-white/20 rounded w-1/2"})]},j))}):n.length===0?a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 space-y-4",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-500/20 rounded-full flex items-center justify-center mx-auto",children:a.jsx(Wx,{size:32,className:"text-gray-400"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:"No Ads Yet"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Create your first P2P ad to start trading"})]})]}):a.jsx(Do,{children:n.map(j=>a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 space-y-3",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"text-white font-semibold text-lg",children:["",j.priceInr]}),a.jsx("span",{className:"text-gray-300 text-sm bg-white/10 px-2 py-1 rounded",children:j.token})]}),a.jsxs("p",{className:"text-gray-300 text-sm",children:["Min: ",j.minAmount," | Max: ",j.maxAmount]}),a.jsxs("p",{className:"text-gray-400 text-xs",children:["Lock: ",Math.floor(j.lockDurationSeconds/60)," min"]})]}),a.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[a.jsx("span",{className:zn("px-2 py-1 rounded text-xs font-medium",j.type==="BUY"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:j.type}),a.jsx("span",{className:zn("px-2 py-1 rounded text-xs font-medium",j.active?"bg-green-500/20 text-green-300":"bg-gray-500/20 text-gray-300"),children:j.active?"Active":"Inactive"})]})]}),j.agent&&a.jsxs("div",{className:"bg-white/5 rounded-lg p-3 space-y-2",children:[a.jsx("p",{className:"text-white text-sm font-medium",children:j.agent.branchName}),a.jsx("p",{className:"text-gray-300 text-xs",children:j.agent.city}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-gray-300 text-xs",children:j.agent.mobile}),a.jsx(X.button,{onClick:()=>{var Y;return window.open(`tel:${(Y=j.agent)==null?void 0:Y.mobile}`)},className:"p-1 rounded bg-green-500/20 text-green-400",whileTap:{scale:.95},children:a.jsx(dn,{size:12})})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs(X.button,{onClick:()=>SN(j),className:"flex-1 py-2 px-4 rounded-lg bg-blue-500/20 text-blue-400 border border-blue-500/30 hover:bg-blue-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},children:[a.jsx(IC,{size:16}),a.jsx("span",{children:"Edit"})]}),a.jsx(X.button,{onClick:()=>TN(j.id),className:"p-2 rounded-lg bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30 transition-colors",whileTap:{scale:.95},children:a.jsx(jC,{size:16})})]})]},j.id))})}),a.jsx(Do,{children:f&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>p(null),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-900 rounded-xl p-6 w-full max-w-md border border-white/20",onClick:j=>j.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Edit Ad"}),a.jsx("button",{onClick:()=>p(null),className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:a.jsx(xr,{size:20})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-white/5 rounded-lg p-4 space-y-2",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-white font-semibold",children:[f.type," ",f.token]}),a.jsx("span",{className:"text-gray-300 text-sm bg-white/10 px-2 py-1 rounded",children:f.city})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Price (USDT)"}),a.jsx("input",{type:"number",value:y.priceInr,onChange:j=>x({...y,priceInr:j.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Enter price in USDT"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Amount (USDT)"}),a.jsx("input",{type:"number",value:y.minAmount,onChange:j=>x({...y,minAmount:j.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Min amount"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Amount (USDT)"}),a.jsx("input",{type:"number",value:y.maxAmount,onChange:j=>x({...y,maxAmount:j.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Max amount"})]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"checkbox",id:"active",checked:y.active,onChange:j=>x({...y,active:j.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("label",{htmlFor:"active",className:"text-sm font-medium text-gray-300",children:"Ad is active"})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx(X.button,{onClick:()=>p(null),className:"flex-1 py-2 px-4 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors",whileTap:{scale:.98},children:"Cancel"}),a.jsx(X.button,{onClick:yb,className:"flex-1 py-2 px-4 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 text-white",whileTap:{scale:.98},children:"Update Ad"})]})]})]})})}),S.isOpen&&a.jsx("div",{children:a.jsx(AN,{isOpen:S.isOpen,ad:{id:"order-call",ownerAddress:S.targetAddress,ownerSelectedAgentIds:["1"],type:"BUY",token:"USDT",priceInr:"0",minAmount:"0",maxAmount:"0",lockDurationSeconds:0,city:"Mumbai",active:!0,createdAt:new Date().toISOString(),agent:{id:"1",branchName:S.targetName||"User",city:"Mumbai",address:S.targetAddress,mobile:"",verified:!0,createdByAdmin:"1",createdAt:new Date().toISOString(),locationId:"1",locationName:"Mumbai"}},onClose:()=>{console.log(" Orders: CallModal closed, cleaning up"),Ll()}})}),W.isOpen&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>Z({isOpen:!1,orderId:""}),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-900 rounded-xl  w-full max-w-4xl max-h-[90vh] overflow-y-auto border border-white/20",onClick:j=>j.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Dispute Resolution"}),a.jsx("button",{onClick:()=>Z({isOpen:!1,orderId:""}),className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:a.jsx(en,{size:20})})]}),M[W.orderId]&&a.jsx(EIe,{orderId:W.orderId,userRole:M[W.orderId].userRole,orderState:M[W.orderId].state,timeRemaining:M[W.orderId].timeRemaining||0,appealTimeRemaining:M[W.orderId].appealTimeRemaining||0,confirmations:M[W.orderId].confirmations,dispute:M[W.orderId].dispute,appeals:M[W.orderId].appeals||[],onConfirmPayment:Ia,onFileAppeal:_N})]})}),oe.isOpen&&(()=>{const j=t.find(we=>we.id===oe.orderId);if(!j)return null;const Y=j.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),Q=j.sellerAddress.toLowerCase(),le=ie[Q]||{},ce=(j==null?void 0:j.sellerName)||"Seller",he=le.mobile||"Not available",ve=Number((j==null?void 0:j.priceInr)||0),Oe=Number(j.amount||0),xe=(ve*Oe).toFixed(2);return a.jsx(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>{Ne({isOpen:!1,orderId:""}),j&&_e(we=>new Set(we).add(j.id))},children:a.jsxs(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gradient-to-br from-green-500 to-blue-500 rounded-xl p-6 w-full max-w-lg border border-white/20 text-white overflow-y-auto max-h-[90vh] relative",onClick:we=>we.stopPropagation(),children:[a.jsx("button",{onClick:()=>{Ne({isOpen:!1,orderId:""}),j&&_e(we=>new Set(we).add(j.id))},className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 text-white transition-colors z-10",title:"Close",children:a.jsx(en,{size:20})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(Wa,{size:32,className:"text-white"})}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:" Funds Locked Successfully!"}),a.jsx("p",{className:"text-white/90 text-sm",children:"The seller has locked their funds for 2 hours. You can now proceed with payment."})]}),a.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(dn,{size:18,className:"text-white"}),a.jsx("h4",{className:"font-semibold text-base",children:"Agent Details"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"Name:"}),a.jsx("span",{className:"text-white/90",children:j.agentBranch})]}),a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"Location:"}),a.jsx("span",{className:"text-white/90",children:j.agentAddress})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"Mobile:"}),a.jsxs("a",{href:`tel:${j.agentNumber}`,className:"text-white/90 hover:text-white underline flex items-center space-x-1",children:[a.jsx(dn,{size:14}),a.jsx("span",{children:j.agentNumber})]})]})]})]}),Y&&a.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("h4",{className:"font-semibold text-base",children:"Seller Details"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"Name:"}),a.jsx("span",{className:"text-white/90",children:ce})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"font-medium min-w-[80px]",children:"Mobile:"}),he!=="Not available"?a.jsxs("a",{href:`tel:${he}`,className:"text-white/90 hover:text-white underline flex items-center space-x-1",children:[a.jsx(dn,{size:14}),a.jsx("span",{children:he})]}):a.jsx("span",{className:"text-white/70 italic",children:"Fetching..."})]})]})]}),a.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("h4",{className:"font-semibold text-base",children:"Payment Amount"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:"text-white/80",children:["Rate (per ",j.token,"):"]}),a.jsxs("span",{className:"font-semibold",children:["",ve.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:"text-white/80",children:["Quantity (",j.token,"):"]}),a.jsx("span",{className:"font-semibold",children:Oe.toFixed(6)})]}),a.jsx("div",{className:"border-t border-white/30 pt-2 mt-2",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-semibold text-base",children:"Total Amount to Pay:"}),a.jsxs("span",{className:"font-bold text-lg text-yellow-300",children:["",xe]})]})})]})]}),a.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold text-sm mb-2",children:" Next Steps:"}),a.jsxs("ul",{className:"text-xs text-white/90 space-y-1 list-disc list-inside",children:[a.jsxs("li",{children:["Go to ",a.jsx("strong",{children:j.agentBranch})," within 2 hours"]}),a.jsxs("li",{children:["Pay ",a.jsxs("strong",{children:["",xe]})," to the agent"]}),a.jsxs("li",{children:["Contact agent at ",a.jsx("strong",{children:j.agentNumber})]}),a.jsx("li",{children:"Complete the transaction with the agent"})]})]}),a.jsx("div",{className:"flex space-x-3 pt-2",children:a.jsx(X.button,{onClick:()=>{Ne({isOpen:!1,orderId:""}),_e(we=>new Set(we).add(j.id)),ee({isOpen:!0,orderId:j.id})},className:"flex-1 bg-white/20 hover:bg-white/30 text-white py-3 px-4 rounded-lg font-medium transition-colors",whileTap:{scale:.95},children:"Got It - View Details"})})]})]})})})(),Ue.isOpen&&(()=>{const j=t.find(we=>we.id===Ue.orderId);if(!j)return null;const Y=j.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),Q=j.sellerAddress.toLowerCase(),le=ie[Q]||{},ce=(j==null?void 0:j.sellerName)||"Seller",he=le.mobile||"Not available",ve=Number((j==null?void 0:j.priceInr)||0),Oe=Number(j.amount||0),xe=(ve*Oe).toFixed(2);return a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-3 sm:p-4",onClick:()=>ee({isOpen:!1,orderId:""}),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md sm:max-w-lg border border-white/20 text-white overflow-hidden shadow-2xl flex flex-col max-h-[95vh] sm:max-h-[90vh]",onClick:we=>we.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-white/10 flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(ll,{size:20,className:"text-white"})}),a.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:" Payment Details"})]}),a.jsx("button",{onClick:()=>ee({isOpen:!1,orderId:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors flex-shrink-0",title:"Close",children:a.jsx(en,{size:20})})]}),a.jsxs("div",{className:"overflow-y-auto flex-1 p-4 sm:p-6 space-y-4",children:[a.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx(dn,{size:18,className:"text-blue-400 flex-shrink-0"}),a.jsx("h4",{className:"font-semibold text-base sm:text-lg text-blue-300",children:"Agent Details"})]}),a.jsxs("div",{className:"space-y-2.5 text-sm sm:text-base",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-1 sm:space-y-0 sm:space-x-3",children:[a.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Name:"}),a.jsx("span",{className:"text-white break-words",children:j.agentBranch})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-1 sm:space-y-0 sm:space-x-3",children:[a.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Location:"}),a.jsx("span",{className:"text-white break-words",children:j.agentAddress})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-3",children:[a.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Mobile:"}),a.jsxs("a",{href:`tel:${j.agentNumber}`,className:"text-blue-300 hover:text-blue-200 underline flex items-center space-x-2 text-base sm:text-lg font-medium",children:[a.jsx(dn,{size:16}),a.jsx("span",{children:j.agentNumber})]})]})]})]}),Y&&a.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("span",{className:"text-lg sm:text-xl",children:""}),a.jsx("h4",{className:"font-semibold text-base sm:text-lg text-purple-300",children:"Seller Details"})]}),a.jsxs("div",{className:"space-y-2.5 text-sm sm:text-base",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-1 sm:space-y-0 sm:space-x-3",children:[a.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Name:"}),a.jsx("span",{className:"text-white break-words",children:ce})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-3",children:[a.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Mobile:"}),he!=="Not available"?a.jsxs("a",{href:`tel:${he}`,className:"text-purple-300 hover:text-purple-200 underline flex items-center space-x-2 text-base sm:text-lg font-medium",children:[a.jsx(dn,{size:16}),a.jsx("span",{children:he})]}):a.jsx("span",{className:"text-gray-400 italic text-sm",children:"Fetching..."})]})]})]}),a.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("span",{className:"text-lg sm:text-xl",children:""}),a.jsx("h4",{className:"font-semibold text-base sm:text-lg text-green-300",children:"Payment Amount"})]}),a.jsxs("div",{className:"space-y-3 text-sm sm:text-base",children:[a.jsxs("div",{className:"flex justify-between items-center py-2",children:[a.jsxs("span",{className:"text-gray-300",children:["Rate (per ",j.token,"):"]}),a.jsxs("span",{className:"font-semibold text-white text-base sm:text-lg",children:["",ve.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between items-center py-2",children:[a.jsxs("span",{className:"text-gray-300",children:["Quantity (",j.token,"):"]}),a.jsx("span",{className:"font-semibold text-white text-base sm:text-lg",children:Oe.toFixed(6)})]}),a.jsx("div",{className:"border-t border-white/20 pt-3 mt-3",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-semibold text-base sm:text-lg text-white",children:"Total Amount to Pay:"}),a.jsxs("span",{className:"font-bold text-xl sm:text-2xl text-yellow-300",children:["",xe]})]})})]})]}),a.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a.jsx("span",{className:"text-lg sm:text-xl",children:""}),a.jsx("h4",{className:"font-semibold text-base sm:text-lg text-yellow-300",children:"Next Steps"})]}),a.jsxs("ul",{className:"text-sm sm:text-base text-gray-300 space-y-2 list-disc list-inside",children:[a.jsxs("li",{children:["Go to ",a.jsx("strong",{className:"text-white",children:j.agentBranch})," within 2 hours"]}),a.jsxs("li",{children:["Pay ",a.jsxs("strong",{className:"text-yellow-300",children:["",xe]})," to the agent"]}),a.jsxs("li",{children:["Contact agent at ",a.jsx("strong",{className:"text-white",children:j.agentNumber})]}),a.jsx("li",{children:"Complete the transaction with the agent"})]})]})]}),a.jsx("div",{className:"p-4 sm:p-6 border-t border-white/10 bg-white/5 flex-shrink-0",children:a.jsx(X.button,{onClick:()=>ee({isOpen:!1,orderId:""}),className:"w-full bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white py-3 px-4 rounded-lg font-medium transition-all text-base sm:text-lg",whileTap:{scale:.98},children:"Got It"})})]})})})(),q.isOpen&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>ue({isOpen:!1,phoneNumber:"",userName:""}),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:j=>j.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:a.jsx(dn,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold text-white",children:["Call ",q.userName]}),a.jsx("p",{className:"text-sm text-gray-400",children:"Phone Number"})]})]}),a.jsx("button",{onClick:()=>ue({isOpen:!1,phoneNumber:"",userName:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:a.jsx(en,{size:20})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-white/10 rounded-lg p-6 text-center border border-white/10",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Phone Number"}),a.jsx("p",{id:"phone-number-display",className:"text-3xl font-bold text-white break-all select-all cursor-text",style:{userSelect:"all",WebkitUserSelect:"all"},onClick:j=>{const Y=document.createRange();Y.selectNodeContents(j.currentTarget);const Q=window.getSelection();Q==null||Q.removeAllRanges(),Q==null||Q.addRange(Y)},children:q.phoneNumber}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Tap to select, then copy manually"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(X.button,{onClick:async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(q.phoneNumber),U.success("Phone number copied to clipboard!");else{const j=document.getElementById("phone-number-display");if(j){const Y=document.createRange();Y.selectNodeContents(j);const Q=window.getSelection();Q==null||Q.removeAllRanges(),Q==null||Q.addRange(Y),U("Number selected! Long press to copy",{icon:"",duration:3e3})}}}catch(j){console.error("Failed to copy:",j);const Y=document.getElementById("phone-number-display");if(Y){const Q=document.createRange();Q.selectNodeContents(Y);const le=window.getSelection();le==null||le.removeAllRanges(),le==null||le.addRange(Q),U("Number selected! Long press to copy",{icon:"",duration:4e3})}else U.error("Please manually select and copy the number")}},className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-center space-x-3 transition-all shadow-lg",whileTap:{scale:.98},children:[a.jsx(ll,{size:24}),a.jsx("span",{children:"Copy Number"})]}),a.jsx(X.button,{onClick:()=>{const j=document.getElementById("phone-number-display");if(j){const Y=document.createRange();Y.selectNodeContents(j);const Q=window.getSelection();Q==null||Q.removeAllRanges(),Q==null||Q.addRange(Y),U("Number selected! Long press to copy",{icon:"",duration:3e3})}},className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},children:a.jsx("span",{children:"Select Number (Manual Copy)"})})]}),a.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 space-y-2",children:[a.jsx("p",{className:"text-sm text-blue-300 text-center",children:" Dialog me jakar call kar lo"}),a.jsx("p",{className:"text-xs text-blue-400 text-center",children:"If copy fails, tap the number above to select it, then long press to copy"})]})]})]})}),Ae.isOpen&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>tt({isOpen:!1,appealUrl:"",orderId:""}),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:j=>j.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-full flex items-center justify-center",children:a.jsx(ll,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"File Appeal"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Chrome Browser Required"})]})]}),a.jsx("button",{onClick:()=>tt({isOpen:!1,appealUrl:"",orderId:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:a.jsx(en,{size:20})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4",children:a.jsx("p",{className:"text-sm text-blue-300 text-center",children:"Ye link copy karke browser me open karo"})}),a.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/10",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Appeal URL"}),a.jsx("p",{id:"appeal-url-display",className:"text-sm font-mono text-white break-all bg-black/20 p-3 rounded border border-white/10 select-all cursor-text",style:{userSelect:"all",WebkitUserSelect:"all"},onClick:j=>{const Y=document.createRange();Y.selectNodeContents(j.currentTarget);const Q=window.getSelection();Q==null||Q.removeAllRanges(),Q==null||Q.addRange(Y)},children:Ae.appealUrl}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Tap to select, then copy manually"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(X.button,{onClick:async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(Ae.appealUrl),U.success("URL copied to clipboard! Copy and paste in browser.");else{const j=document.getElementById("appeal-url-display");if(j){const Y=document.createRange();Y.selectNodeContents(j);const Q=window.getSelection();Q==null||Q.removeAllRanges(),Q==null||Q.addRange(Y),U("URL selected! Long press to copy",{icon:"",duration:3e3})}}}catch(j){console.error("Failed to copy:",j);const Y=document.getElementById("appeal-url-display");if(Y){const Q=document.createRange();Q.selectNodeContents(Y);const le=window.getSelection();le==null||le.removeAllRanges(),le==null||le.addRange(Q),U("URL selected! Long press to copy",{icon:"",duration:4e3})}else U.error("Please manually select and copy the URL")}},className:"w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-center space-x-3 transition-all shadow-lg",whileTap:{scale:.98},children:[a.jsx(ll,{size:24}),a.jsx("span",{children:"Copy Link"})]}),a.jsx(X.button,{onClick:()=>{const j=document.getElementById("appeal-url-display");if(j){const Y=document.createRange();Y.selectNodeContents(j);const Q=window.getSelection();Q==null||Q.removeAllRanges(),Q==null||Q.addRange(Y),U("URL selected! Long press to copy",{icon:"",duration:3e3})}},className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},children:a.jsx("span",{children:"Select URL (Manual Copy)"})})]}),a.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 space-y-2",children:[a.jsx("p",{className:"text-sm text-yellow-300 text-center",children:"Ye link copy karke browser me open karo"}),a.jsx("p",{className:"text-xs text-yellow-400 text-center",children:"If copy fails, tap the URL above to select it, then long press to copy"})]})]})]})}),me.isOpen&&a.jsx(X.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>je({isOpen:!1,orderId:"",userRole:"buyer"}),children:a.jsxs(X.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:j=>j.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center",children:a.jsx(qt,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Important Instructions"}),a.jsx("p",{className:"text-sm text-gray-400",children:me.userRole==="buyer"?"For Buyer":"For Seller"})]})]}),a.jsx("button",{onClick:()=>je({isOpen:!1,orderId:"",userRole:"buyer"}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:a.jsx(en,{size:20})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4",children:me.userRole==="buyer"?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(qt,{size:20,className:"text-yellow-400"}),a.jsx("span",{className:"font-semibold text-yellow-300",children:"Buyer Instructions"})]}),a.jsxs("p",{className:"text-white text-base leading-relaxed",children:[a.jsx("strong",{children:" Important:"})," Agent branch me payment ke baad hi confirm karo."]}),a.jsx("p",{className:"text-gray-300 text-sm mt-2",children:'Please complete the payment at the agent branch first, then click the "Confirm Payment Sent" button.'})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(qt,{size:20,className:"text-yellow-400"}),a.jsx("span",{className:"font-semibold text-yellow-300",children:"Seller Instructions"})]}),a.jsxs("p",{className:"text-white text-base leading-relaxed",children:[a.jsx("strong",{children:" Important:"})," Payment milne ke baad confirm button dabao."]}),a.jsx("p",{className:"text-gray-300 text-sm mt-2",children:'Only click the "Confirm Payment Received" button after you have actually received the payment from the buyer.'})]})}),a.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:a.jsx("p",{className:"text-blue-300 text-sm",children:" This action is important for the security of the transaction. Please follow the instructions carefully."})})]}),a.jsx("div",{className:"p-6 border-t border-white/10 bg-white/5",children:a.jsx(X.button,{onClick:()=>je({isOpen:!1,orderId:"",userRole:"buyer"}),className:"w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white py-3 px-4 rounded-lg font-medium transition-all",whileTap:{scale:.98},children:"Got It"})})]})})]})};function AIe(){const{user:t,agents:e,locations:n,isLoading:r,updateProfile:s,fetchAgents:i,fetchLocations:o,fetchUserProfile:c,refreshUserProfile:l}=ss(),{address:d,isConnected:u,connectionError:h,clearError:f}=Xt(),[p,m]=A.useState(!1),[g,y]=A.useState(null),[x,w]=A.useState(!1),[b,v]=A.useState(""),[E,k]=A.useState(!1),[C,S]=A.useState({name:"",phone:"",locationId:"",selectedAgentIds:[]});A.useEffect(()=>{u&&d&&c(d)},[d,u,c]),A.useEffect(()=>{u&&d&&t&&(console.log(" Profile: Wallet connected, refreshing user profile..."),l())},[u,d,l]),A.useEffect(()=>{if(t){S({name:t.name||"",phone:t.phone||"",locationId:t.locationId||"",selectedAgentIds:t.selectedAgentIds||[]});const _=n.find(L=>L.id===t.locationId);_&&v(_.name)}},[t,n]),A.useEffect(()=>{o()},[o]),A.useEffect(()=>{i()},[i]),A.useEffect(()=>{const _=L=>{const O=L.target;E&&!O.closest(".location-search-container")&&k(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[E]);const N=(_,L)=>{S(O=>({...O,[_]:L}))},I=n.filter(_=>{var L,O,M;return((L=_.name)==null?void 0:L.toLowerCase().includes(b.toLowerCase()))||((O=_.city)==null?void 0:O.toLowerCase().includes(b.toLowerCase()))||((M=_.state)==null?void 0:M.toLowerCase().includes(b.toLowerCase()))}),F=C.locationId?e.filter(_=>_.locationId===C.locationId):e,P=(_,L)=>{N("locationId",_),v(L),k(!1)},H=()=>{N("locationId",""),v(""),k(!1)},z=async()=>{if(!C.name.trim()||!C.phone.trim()||C.selectedAgentIds.length===0){y("Please fill in all required fields and select at least one agent");return}const _=e.filter(O=>{var M;return(M=C.selectedAgentIds)==null?void 0:M.includes(String(O.id))});if(new Set(_.map(O=>O.locationId)).size>3){y("You can select agents from maximum 3 different locations");return}try{y(null),await s(C)?(U.success("Profile updated successfully"),m(!1)):y("Failed to update profile")}catch(O){console.error("Profile update error:",O),y("Failed to update profile")}},T=e.filter(_=>{var L;return(L=C.selectedAgentIds)==null?void 0:L.includes(String(_.id))});return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-3",children:a.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-white",children:"Profile"}),a.jsx("p",{className:"text-violet-300 text-sm",children:"Manage your account"})]}),h&&a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3 flex items-center space-x-2",children:[a.jsx(qt,{size:16,className:"text-red-400"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-red-300 font-medium text-sm",children:"Connection Error"}),a.jsx("p",{className:"text-red-400 text-xs",children:h})]}),a.jsx("button",{onClick:f,className:"p-1 rounded bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",children:a.jsx(en,{size:14})})]}),!u&&a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-4 border border-violet-500/20 text-center",children:[a.jsx(RC,{size:32,className:"text-violet-400 mx-auto mb-2"}),a.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Wallet Not Connected"}),a.jsx("p",{className:"text-violet-300 text-sm",children:"Please connect your wallet from Dashboard to view and edit your profile"})]}),u&&a.jsxs(a.Fragment,{children:[a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:zn("p-3 rounded-lg border flex items-center space-x-2",t!=null&&t.verified?"bg-violet-500/20 border-violet-500/30":"bg-yellow-500/20 border-yellow-500/30"),children:[t!=null&&t.verified?a.jsx(kt,{size:16,className:"text-violet-400"}):a.jsx(qt,{size:16,className:"text-yellow-400"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:zn("font-medium text-sm",t!=null&&t.verified?"text-violet-300":"text-yellow-300"),children:t!=null&&t.verified?"Verified":"Not Verified"}),a.jsx("p",{className:zn("text-xs",t!=null&&t.verified?"text-violet-400":"text-yellow-400"),children:t!=null&&t.verified?"Can access P2P trading":"Complete profile to trade"})]})]}),a.jsx(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(hg,{size:16,className:"text-violet-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-violet-300 text-xs",children:"Wallet Address"}),a.jsx("p",{className:"text-white font-mono text-xs",children:d?`${d.slice(0,6)}...${d.slice(-6)}`:"Not connected"})]})]})}),a.jsx(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-4 border border-violet-500/20",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-violet-300 mb-1",children:"Full Name *"}),a.jsx("input",{type:"text",value:C.name,onChange:_=>N("name",_.target.value),disabled:!p,className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-white text-sm focus:outline-none focus:border-violet-500 disabled:opacity-50",placeholder:"Enter your full name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-violet-300 mb-1",children:"Phone Number *"}),a.jsx("input",{type:"tel",value:C.phone,onChange:_=>N("phone",_.target.value),disabled:!p,className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-white text-sm focus:outline-none focus:border-violet-500 disabled:opacity-50",placeholder:"Enter your phone number",required:!0})]}),a.jsxs("div",{className:"relative location-search-container",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("label",{className:"block text-xs font-medium text-violet-300",children:"Filter by Location (Optional)"}),C.locationId&&p&&a.jsx("button",{type:"button",onClick:H,className:"text-xs text-violet-400 hover:text-violet-300 underline",children:"Clear Filter"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:b,onChange:_=>{v(_.target.value),k(!0),_.target.value||N("locationId","")},onFocus:()=>k(!0),disabled:!p,className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 pr-8 text-white text-sm focus:outline-none focus:border-violet-500 disabled:opacity-50",placeholder:"Search location to filter agents...",autoComplete:"off"}),a.jsx(Ac,{size:16,className:"absolute right-2 top-1/2 -translate-y-1/2 text-violet-400 pointer-events-none"})]}),E&&p&&I.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 max-h-48 overflow-y-auto bg-slate-800 border border-violet-500/30 rounded-lg shadow-xl",children:I.map(_=>a.jsxs("button",{type:"button",onClick:()=>P(_.id,_.name),className:zn("w-full text-left px-3 py-2 hover:bg-violet-500/20 transition-colors border-b border-white/5 last:border-b-0",C.locationId===_.id&&"bg-violet-500/30"),children:[a.jsx("p",{className:"text-white font-medium text-sm",children:_.name}),a.jsxs("p",{className:"text-violet-300 text-xs",children:[_.city," ",_.state?`, ${_.state}`:""]})]},_.id))}),E&&p&&b&&I.length===0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-slate-800 border border-violet-500/30 rounded-lg shadow-xl p-3",children:a.jsxs("p",{className:"text-violet-300 text-sm text-center",children:['No locations found for "',b,'"']})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-violet-300 mb-1",children:"Select Agents * (Multiple - Max 3 Locations)"}),C.locationId?F.length===0?a.jsx("div",{className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-violet-300 text-sm",children:a.jsx("p",{children:"No agents available for selected location. Clear the filter to choose another location."})}):a.jsx("div",{className:"max-h-48 overflow-y-auto bg-white/10 border border-violet-500/20 rounded p-2 space-y-1",children:F.map(_=>{var W,Z;const L=e.filter(ie=>{var ae;return(ae=C.selectedAgentIds)==null?void 0:ae.includes(String(ie.id))}),O=new Set(L.map(ie=>ie.locationId).filter(Boolean)),M=_.locationId,B=!!(M&&!O.has(M)&&O.size>=3&&!((W=C.selectedAgentIds)!=null&&W.includes(String(_.id))));return a.jsxs("label",{className:zn("flex items-center space-x-2 p-1.5 rounded hover:bg-white/5 cursor-pointer transition-colors",B&&"opacity-50 cursor-not-allowed"),children:[a.jsx("input",{type:"checkbox",checked:((Z=C.selectedAgentIds)==null?void 0:Z.includes(String(_.id)))||!1,onChange:ie=>{if(B&&ie.target.checked){U.error("Maximum 3 different locations allowed");return}const ae=String(_.id),oe=C.selectedAgentIds||[];if(ie.target.checked){const Ne=e.filter(_e=>oe.includes(String(_e.id))),de=new Set(Ne.map(_e=>_e.locationId).filter(Boolean));if(_.locationId&&!de.has(_.locationId)&&de.size>=3){U.error("You can select agents from maximum 3 different locations");return}N("selectedAgentIds",[...oe,ae])}else N("selectedAgentIds",oe.filter(Ne=>Ne!==ae))},disabled:!p||B,className:"w-3 h-3 text-violet-600 bg-white/10 border-violet-500/20 rounded focus:ring-violet-500 focus:ring-1 disabled:opacity-50"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-white font-medium text-sm truncate",children:_.branchName}),a.jsx("p",{className:"text-violet-300 text-xs break-words",children:_.address}),a.jsxs("div",{className:"flex items-center space-x-2 mt-0.5",children:[a.jsx("p",{className:"text-violet-400 text-xs truncate",children:_.mobile}),_.locationName&&a.jsxs("span",{className:"text-violet-500/70 text-xs",children:[" ",_.locationName]})]})]}),a.jsx("div",{className:"flex-shrink-0",children:_.verified?a.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-400",children:""}):a.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-500/20 text-yellow-400",children:""})})]},_.id)})}):a.jsx("div",{className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-violet-300 text-sm",children:a.jsx("p",{children:"Select a location above to view agents."})}),C.selectedAgentIds&&C.selectedAgentIds.length>0&&a.jsxs("div",{className:"mt-2 p-2 bg-violet-500/20 border border-violet-500/30 rounded",children:[a.jsxs("p",{className:"text-violet-300 text-xs font-medium",children:["Selected (",C.selectedAgentIds.length,"):"]}),a.jsx("div",{className:"mt-1 space-y-0.5",children:T.map(_=>a.jsxs("p",{className:"text-violet-200 text-xs",children:[" ",_.branchName," ",_.locationName&&a.jsxs("span",{className:"text-violet-400",children:["(",_.locationName,")"]})]},_.id))}),(()=>{const _=new Set(T.map(L=>L.locationId));return a.jsxs("p",{className:"text-violet-400 text-xs mt-1",children:["Locations: ",_.size,"/3"]})})()]})]}),p&&a.jsxs("div",{className:"flex space-x-2 pt-3",children:[a.jsx("button",{onClick:z,disabled:r,className:"flex-1 bg-gradient-to-r from-violet-500 to-purple-500 text-white py-2 px-3 rounded font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-1 text-sm",children:r?a.jsxs(a.Fragment,{children:[a.jsx(sr,{size:14,className:"animate-spin"}),a.jsx("span",{children:"Saving..."})]}):a.jsx("span",{children:"Save"})}),a.jsx("button",{onClick:()=>{if(m(!1),y(null),k(!1),t){S({name:t.name||"",phone:t.phone||"",locationId:t.locationId||"",selectedAgentIds:t.selectedAgentIds||[]});const _=n.find(L=>L.id===t.locationId);v(_?_.name:"")}else v("")},className:"px-3 py-2 border border-violet-500/20 text-white rounded hover:bg-white/10 transition-colors text-sm",children:"Cancel"})]}),!p&&a.jsx("button",{onClick:()=>w(!0),className:"w-full bg-gradient-to-r from-violet-500 to-purple-500 text-white py-2 px-3 rounded font-medium text-sm",children:"Edit Profile"}),g&&a.jsxs("div",{className:"p-2 bg-red-500/20 border border-red-500/30 rounded flex items-center space-x-2",children:[a.jsx(qt,{size:14,className:"text-red-400"}),a.jsx("p",{className:"text-red-300 text-xs",children:g})]})]})}),T.length>0&&a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[a.jsxs("h3",{className:"text-base font-bold text-white mb-2 flex items-center space-x-1",children:[a.jsx(df,{size:16,className:"text-violet-400"}),a.jsx("span",{children:"Selected Agents"})]}),a.jsx("div",{className:"space-y-2",children:T.map(_=>a.jsx("div",{className:"p-2 bg-white/5 rounded border border-white/10",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx("p",{className:"text-white font-medium text-sm",children:_.branchName}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(df,{size:12,className:"text-violet-400"}),a.jsx("span",{className:"text-violet-300 text-xs",children:_.locationName})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(dn,{size:12,className:"text-violet-400"}),a.jsx("span",{className:"text-violet-300 text-xs",children:_.mobile})]})]}),a.jsx("div",{className:"flex-shrink-0",children:_.verified?a.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-400",children:""}):a.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-500/20 text-yellow-400",children:""})})]})},_.id))})]})]}),x&&a.jsx(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-3",onClick:()=>w(!1),children:a.jsx(X.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gradient-to-br from-orange-500 to-red-500 rounded-lg p-4 w-full max-w-sm border border-white/20 text-white",onClick:_=>_.stopPropagation(),children:a.jsxs("div",{className:"text-center space-y-3",children:[a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mx-auto",children:a.jsx(qt,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold mb-1",children:" Important Notice"}),a.jsx("p",{className:"text-white/90 text-sm mb-3",children:"Please fill all information correctly and accurately."}),a.jsxs("div",{className:"bg-white/20 rounded p-3 space-y-1",children:[a.jsx("p",{className:"text-white font-semibold text-xs",children:" Important:"}),a.jsx("p",{className:"text-xs text-white/90",children:" Name and mobile number must be correct"}),a.jsx("p",{className:"text-xs text-white/90",children:" Aagnya Branch may verify your information"}),a.jsx("p",{className:"text-xs text-white/90",children:" All other information should also be accurate"})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(X.button,{onClick:()=>w(!1),className:"flex-1 bg-white/20 hover:bg-white/30 text-white py-2 px-3 rounded font-medium transition-colors text-sm",whileTap:{scale:.95},children:"Cancel"}),a.jsx(X.button,{onClick:()=>{w(!1),m(!0)},className:"flex-1 bg-white text-orange-600 py-2 px-3 rounded font-medium hover:bg-white/90 transition-colors text-sm",whileTap:{scale:.95},children:"Continue"})]})]})})})]})})}const SIe=()=>{const{user:t}=ss(),[e,n]=A.useState([]),[r,s]=A.useState([]),[i,o]=A.useState(!0),[c,l]=A.useState(null);A.useEffect(()=>{t!=null&&t.address&&(d(),u())},[t==null?void 0:t.address]);const d=async()=>{try{o(!0);const y=await fetch("/api/transactions",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(y.ok){const x=await y.json();n(x.data||[])}}catch(y){console.error("Error fetching transactions:",y)}finally{o(!1)}},u=async()=>{try{const y=await fetch("/api/support");if(y.ok){const x=await y.json();s(x.data||[])}}catch(y){console.error("Error fetching support contacts:",y)}},h=async(y,x)=>{try{await navigator.clipboard.writeText(y),l(x),setTimeout(()=>l(null),2e3)}catch(w){console.error("Failed to copy:",w)}},f=y=>{switch(y){case"COMPLETED":return a.jsx(kt,{className:"w-4 h-4 text-green-400"});case"PENDING":return a.jsx(Pr,{className:"w-4 h-4 text-yellow-400"});case"FAILED":return a.jsx(xr,{className:"w-4 h-4 text-red-400"});case"CANCELLED":return a.jsx(qt,{className:"w-4 h-4 text-gray-400"});default:return a.jsx(Pr,{className:"w-4 h-4 text-gray-400"})}},p=y=>{switch(y){case"COMPLETED":return"bg-green-500/20 text-green-400 border-green-500/30";case"PENDING":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"FAILED":return"bg-red-500/20 text-red-400 border-red-500/30";case"CANCELLED":return"bg-gray-500/20 text-gray-400 border-gray-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},m=y=>new Date(y).toLocaleString(),g=(y,x)=>`${y.toFixed(6)} ${x}`;return i?a.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:a.jsx("div",{className:"text-white",children:"Loading transactions..."})}):a.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Transaction History"}),a.jsx("p",{className:"text-gray-400",children:"View all your transaction records and support contacts"})]}),r.length>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[a.jsx(dn,{className:"w-5 h-5 mr-2"}),"Support Contacts"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(y=>a.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[y.type==="phone"?a.jsx(dn,{className:"w-4 h-4 text-green-400"}):a.jsx(_Q,{className:"w-4 h-4 text-blue-400"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:y.label||y.type}),a.jsx("div",{className:"text-sm text-gray-400",children:y.value})]})]}),a.jsx("button",{onClick:()=>{y.type==="phone"?window.open(`tel:${y.value}`):window.open(`mailto:${y.value}`)},className:"p-2 rounded-lg bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 transition-colors",children:a.jsx(uQ,{className:"w-4 h-4"})})]})},y.id))})]}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[a.jsx(dw,{className:"w-5 h-5 mr-2"}),"Your Transactions"]}),e.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(dw,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No transactions found"}),a.jsx("p",{className:"text-gray-500",children:"Your transaction history will appear here once you complete orders."})]}):a.jsx("div",{className:"space-y-4",children:e.map(y=>a.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[f(y.status),a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium text-lg",children:["Transaction #",y.transaction_number]}),a.jsx("div",{className:"text-sm text-gray-400",children:m(y.created_at)})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${p(y.status)}`,children:y.status}),a.jsx("button",{onClick:()=>h(y.transaction_number,y.transaction_number),className:"p-1 rounded hover:bg-gray-700 transition-colors",children:c===y.transaction_number?a.jsx(X1,{className:"w-4 h-4 text-green-400"}):a.jsx(CB,{className:"w-4 h-4 text-gray-400"})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Amount"}),a.jsx("div",{className:"font-medium",children:g(y.amount,y.token)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Type"}),a.jsx("div",{className:"font-medium",children:y.transaction_type})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Order ID"}),a.jsxs("div",{className:"font-medium",children:["#",y.order_id]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-400 mb-1",children:"Buyer"}),a.jsx("div",{className:"font-mono text-xs break-all",children:y.buyer_address})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-400 mb-1",children:"Seller"}),a.jsx("div",{className:"font-mono text-xs break-all",children:y.seller_address})]})]}),y.completed_at&&a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700",children:a.jsxs("div",{className:"text-sm text-gray-400",children:["Completed: ",m(y.completed_at)]})})]},y.id))})]})]})})},TIe=()=>{const t=[{icon:uf,title:"No Bank Freeze Risk",description:"Operate outside traditional banking systems. Your trades don't depend on banks, reducing freeze risk.",color:"from-green-500/20 to-emerald-500/20",borderColor:"border-green-500/30",iconColor:"text-green-400"},{icon:CJ,title:"Daily Cash  USDT Trading",description:"Seamlessly convert cash to USDT or USDT to cash daily via automated, peertopeer flows.",color:"from-yellow-500/20 to-orange-500/20",borderColor:"border-yellow-500/30",iconColor:"text-yellow-400"},{icon:AB,title:"Global Access",description:"Borderless access to decentralized financial transactions from anywhere in the world.",color:"from-indigo-500/20 to-blue-500/20",borderColor:"border-indigo-500/30",iconColor:"text-indigo-400"},{icon:ko,title:"Low Transaction Fees",description:"No intermediaries or centralized exchanges means significantly lower costs per trade.",color:"from-green-500/20 to-teal-500/20",borderColor:"border-green-500/30",iconColor:"text-green-400"},{icon:Wa,title:"Privacy & Security",description:"Advanced encryption and onchain verification keep your identity and data private and secure.",color:"from-purple-500/20 to-pink-500/20",borderColor:"border-purple-500/30",iconColor:"text-purple-400"},{icon:TB,title:"No Need for Physical Visits",description:"Handle cash/USDT adjustments over verified callsno repeated inperson visits required.",color:"from-violet-500/20 to-fuchsia-500/20",borderColor:"border-violet-500/30",iconColor:"text-violet-400"},{icon:RC,title:"No Centralized Exchange Required",description:"Trade directly via decentralized wallets like MetaMask or Trust Wallet with full fund control.",color:"from-blue-500/20 to-cyan-500/20",borderColor:"border-blue-500/30",iconColor:"text-blue-400"},{icon:uf,title:"Smart Contract Protection",description:"Secure smart contracts govern every tradeno admin, agent, or third party can interfere.",color:"from-emerald-500/20 to-green-500/20",borderColor:"border-emerald-500/30",iconColor:"text-emerald-400"},{icon:_B,title:"Daily Arbitrage Opportunities",description:"Capitalize on market fluctuations by buying low and selling high for consistent profit.",color:"from-teal-500/20 to-cyan-500/20",borderColor:"border-teal-500/30",iconColor:"text-teal-400"},{icon:KQ,title:"Tax Flexibility",description:"Decentralized structure may enable tax optimizations depending on jurisdiction and setup.",color:"from-amber-500/20 to-yellow-500/20",borderColor:"border-amber-500/30",iconColor:"text-amber-400"},{icon:qY,title:"Full Financial Freedom",description:"Manage, trade, and grow assets without reliance on centralized systemsfreedom and control.",color:"from-pink-500/20 to-rose-500/20",borderColor:"border-pink-500/30",iconColor:"text-pink-400"}],e={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},n={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}};return a.jsxs("div",{className:"p-4 space-y-6 max-w-md mx-auto pb-20",children:[a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"text-center space-y-2",children:[a.jsx("h1",{className:"text-3xl font-bold text-white",children:"Platform Benefits"}),a.jsx("p",{className:"text-violet-300 text-sm",children:"Why choose our decentralized P2P trading platform?"})]}),a.jsx(X.div,{variants:e,initial:"hidden",animate:"visible",className:"space-y-4",children:t.map((r,s)=>{const i=r.icon;return a.jsx(X.div,{variants:n,className:`bg-gradient-to-r ${r.color} backdrop-blur-lg rounded-xl p-4 border ${r.borderColor} hover:scale-[1.02] transition-transform duration-200`,children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:`flex-shrink-0 p-2 rounded-lg bg-black/20 ${r.iconColor}`,children:a.jsx(i,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-semibold text-base mb-1",children:r.title}),a.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:r.description})]})]})},s)})}),a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.8,duration:.5},className:"bg-gradient-to-r from-violet-500/20 to-purple-500/20 backdrop-blur-lg rounded-xl p-6 border border-violet-500/30 text-center space-y-3",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Ready to Get Started?"}),a.jsx("p",{className:"text-violet-200 text-sm",children:"Join thousands of users trading securely on our decentralized platform"}),a.jsxs("div",{className:"flex flex-col space-y-2 pt-2",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2 text-violet-300 text-sm",children:[a.jsx(kt,{size:16,className:"text-violet-400"}),a.jsx("span",{children:"No signup required"})]}),a.jsxs("div",{className:"flex items-center justify-center space-x-2 text-violet-300 text-sm",children:[a.jsx(kt,{size:16,className:"text-violet-400"}),a.jsx("span",{children:"Just connect your wallet"})]}),a.jsxs("div",{className:"flex items-center justify-center space-x-2 text-violet-300 text-sm",children:[a.jsx(kt,{size:16,className:"text-violet-400"}),a.jsx("span",{children:"Start trading in seconds"})]})]})]})]})},OU=()=>{const t=[{icon:RC,title:"Connect Your Wallet",description:"Connect Trust Wallet, MetaMask, OKX Wallet, etc. No signup, no KYC, and no exchange deposits  you stay in full control."},{icon:FY,title:"Choose What You Want to Do",description:"Buy USDT (pay via cash/bank) or Sell USDT (receive cash/bank). See best offers from verified users/agents near you."},{icon:Wa,title:"Trade Escrow Begins (Smart Contract Lock)",description:"When a trade starts, the sellers USDT is locked in a smart contract escrow until both sides confirm."},{icon:ko,title:"Buyer Makes the Payment",description:"Buyer pays seller directly via cash, UPI, or bank transfer as selected, then clicks Payment Done."},{icon:uf,title:"Smart Contract AutoRelease",description:"After the seller verifies payment, the smart contract automatically releases USDT to the buyer  instant and trustless."},{icon:dn,title:"Agent Support (Optional)",description:"Verified Aagnya Agents help convert cash  USDT. Once balance is set, trade anytime without repeated physical visits."},{icon:uf,title:"Smart Contract Escrow Explained",description:"Think of it like a digital locker that opens only when both sides agree. No admin or middleman can touch funds."},{icon:ll,title:"Zotrust Fee Structure",description:"Platform fee is only 1.8% per transaction. No hidden fees or withdrawal fees. Charges shown before confirming."},{icon:xa,title:"Reputation & Trust System",description:"Users and agents have trust scores from trading history. Higher score = more visibility; fraud is autodetected and flagged."},{icon:AB,title:"Once Setup, Always Easy",description:"After setting an amount with an agent (e.g., 1 lakh USDT), keep trading daily over calls/online without visiting again."}];return a.jsxs("div",{className:"p-4 space-y-6 max-w-md mx-auto pb-20",children:[a.jsxs(X.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"text-center space-y-2",children:[a.jsx("h1",{className:"text-3xl font-bold text-white",children:" How Zotrust Works  Simple Explanation for Users"}),a.jsx("p",{className:"text-violet-300 text-sm",children:"Zotrust is a decentralized P2P USDT trading platform. No banks, no middlemen  trades are secured by blockchain smart contracts."})]}),a.jsx("div",{className:"space-y-4",children:t.map((e,n)=>{const r=e.icon;return a.jsx(X.div,{initial:{y:16,opacity:0},animate:{y:0,opacity:1},transition:{delay:n*.05,duration:.4},className:"bg-violet-500/10 backdrop-blur-lg rounded-xl p-4 border border-violet-500/20",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex-shrink-0 p-2 rounded-lg bg-black/20 text-violet-400",children:a.jsx(r,{size:22})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-semibold text-base mb-1",children:e.title}),a.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:e.description})]})]})},n)})})]})},Iv=()=>{const{walletAddress:t,orderId:e}=SC(),[n,r]=A.useState(!1),[s,i]=A.useState(null),[o,c]=A.useState(null),[l,d]=A.useState(null),[u,h]=A.useState(0),[f,p]=A.useState(!1),[m,g]=A.useState({orderId:e||"",walletAddress:t||"",reason:"",description:"This is Tesing 1",evidence:{}}),[y,x]=A.useState(!1),[w,b]=A.useState(null),[v,E]=A.useState({type:null,message:""}),[k,C]=A.useState(!1),S=A.useRef(null),N=A.useRef(null);A.useEffect(()=>()=>{H(),l&&l.getTracks().forEach(O=>O.stop())},[l]);const I=async()=>{try{b(null),p(!0),console.log(" Opening camera interface..."),await new Promise(B=>setTimeout(B,200)),console.log(" Requesting camera access...");const O=[{video:{facingMode:{ideal:"environment"},width:{ideal:1280,max:1920},height:{ideal:720,max:1080}},audio:{echoCancellation:!0,noiseSuppression:!0}},{video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!0},{video:{facingMode:"environment"},audio:!0},{video:{facingMode:"user"},audio:!0},{video:!0,audio:!0}];let M=null;for(let B=0;B<O.length;B++)try{console.log(` Trying camera config ${B+1}...`),M=await navigator.mediaDevices.getUserMedia(O[B]),console.log(` Camera config ${B+1} successful!`);break}catch(W){if(console.log(` Config ${B+1} failed:`,W.message),B===O.length-1)throw W}if(!M)throw new Error("Unable to access camera");if(d(M),S.current){S.current.srcObject=M;try{await S.current.play(),console.log(" Video preview playing")}catch(B){console.warn(" Video play warning:",B)}}L(" Camera opened successfully!","success")}catch(O){console.error(" Camera error:",O);const M=O.name==="NotAllowedError"?"Camera access denied. Please allow permissions.":"Failed to access camera: "+O.message;b(M),p(!1),L(M,"error")}},F=()=>{l&&(l.getTracks().forEach(O=>O.stop()),d(null)),S.current&&(S.current.srcObject=null),p(!1),console.log(" Camera closed")},P=async()=>{try{if(!l){L("Please open camera first","error");return}const O=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm","video/mp4"];let M=O[0];for(const Z of O)if(MediaRecorder.isTypeSupported(Z)){M=Z;break}console.log(" Using MIME type:",M);const B=new MediaRecorder(l,{mimeType:M,videoBitsPerSecond:25e5}),W=[];B.ondataavailable=Z=>{Z.data.size>0&&(W.push(Z.data),console.log(" Video chunk received:",Z.data.size,"bytes"))},B.onstop=()=>{console.log(" Video recording stopped, creating blob...");const Z=new Blob(W,{type:M});console.log(" Video blob created:",Z.size,"bytes"),c(Z),r(!1),N.current&&(clearInterval(N.current),N.current=null),g(ie=>({...ie,evidence:{...ie.evidence,video:Z}})),L(" Video saved and ready for upload!","success")},B.onerror=Z=>{console.error(" Recorder error:",Z),b("Recording failed: "+Z.message)},i(B),B.start(),r(!0),h(0),N.current=setInterval(()=>{h(Z=>Z+1)},1e3),L(" Video recording started!","success")}catch(O){console.error(" Error starting video recording:",O),b("Failed to start recording: "+O.message),L("Failed to start video recording","error")}},H=()=>{s&&n&&(console.log(" Stopping video recording..."),s.stop())},z=()=>{c(null),h(0),L("Video recording deleted","info")},T=async()=>{if(!m.reason||!m.description){E({type:"error",message:"Please fill in all required fields"});return}if(m.description.trim().length<10){E({type:"error",message:"Description must be at least 10 characters long"});return}x(!0),E({type:null,message:""});try{const O=new FormData;O.append("orderId",m.orderId),O.append("appellant_address",m.walletAddress),O.append("appellant_type","BUYER");let M="OTHER";switch(m.reason){case"payment_not_received":M="PAYMENT_NOT_RECEIVED";break;case"payment_sent_but_not_confirmed":M="PAYMENT_NOT_SENT";break;default:M="OTHER"}O.append("dispute_type",M),O.append("description",m.description),m.evidence.video&&(O.append("evidence_video",m.evidence.video,`video_evidence_${Date.now()}.webm`),console.log(" Added video to FormData:",m.evidence.video.size,"bytes")),console.log(" Submitting appeal with FormData..."),console.log(" Order ID:",m.orderId),console.log(" Wallet Address:",m.walletAddress),console.log(" Dispute Type:",M),console.log(" Description:",m.description);for(let[ie,ae]of O.entries())console.log(`  ${ie}:`,ae instanceof Blob?`Blob(${ae.size} bytes)`:ae);const B=`/api/disputes/${m.orderId}/appeal`;console.log(" API URL:",B);const W=await fetch(B,{method:"POST",body:O});if(console.log(" Response status:",W.status),console.log(" Response ok:",W.ok),!W.ok){const ie=await W.json();throw console.error(" Error response:",ie),new Error(ie.error||"Failed to submit appeal")}const Z=await W.json();console.log(" Appeal submitted successfully to backend:",Z),E({type:"success",message:" Appeal submitted successfully! Admin will review within 48 hours."})}catch(O){console.error(" Error submitting appeal:",O);const M=O.message||"Failed to submit appeal";E({type:"error",message:` Error: ${M}`})}finally{x(!1)}},_=O=>{const M=Math.floor(O/60),B=O%60;return`${M}:${B.toString().padStart(2,"0")}`},L=(O,M="info")=>{console.log(`[${M.toUpperCase()}] ${O}`)};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-3xl font-bold text-white",children:" File Appeal"}),a.jsxs("button",{onClick:()=>C(!0),className:"relative px-4 py-2.5 capitalize  text-lg font-medium  text-white border border-violet-400/30 transition-all shadow-lg hover:shadow-violet-500/20 flex items-center gap-2 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0",children:a.jsx("video",{muted:!0,playsInline:!0,className:"w-full h-full object-cover scale-110",src:"/api/videos/stream/appeal"})}),a.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:["guide",a.jsx(iJ,{className:"w-6 h-6"})]})]})]}),a.jsxs("div",{className:"space-y-2 text-white/80",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Order ID:"})," ",e]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Wallet:"})," ",t==null?void 0:t.slice(0,6),"...",t==null?void 0:t.slice(-4)]})]})]}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[a.jsx(fl,{className:"w-5 h-5"})," Video Evidence"]}),w&&a.jsx("div",{className:"mb-4 bg-red-500/20 border border-red-500/30 rounded-lg p-3 text-red-300 text-sm",children:w}),f?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative rounded-xl overflow-hidden border-2 border-white/20",children:[a.jsx("video",{ref:S,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-[400px] object-cover bg-black"}),n&&a.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"REC ",_(u)]})]}),a.jsx("div",{className:"flex items-center gap-3",children:n?a.jsxs("button",{onClick:H,className:"flex-1 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-all",children:[a.jsx(aJ,{className:"w-5 h-5"}),"Stop & Save"]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:P,disabled:!!o,className:"flex-1 bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-all",children:[a.jsx(fl,{className:"w-5 h-5"}),"Start Recording"]}),a.jsxs("button",{onClick:F,className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium flex items-center gap-2 transition-all",children:[a.jsx(en,{className:"w-5 h-5"}),"Close"]})]})}),o&&a.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 text-green-300",children:[a.jsx(kt,{className:"w-5 h-5"}),a.jsxs("span",{className:"font-medium",children:["Video Saved (",o!=null&&o.size?(o.size/1024/1024).toFixed(1):"0"," MB)"]})]}),a.jsx("button",{onClick:z,className:"text-red-400 hover:text-red-300 transition-colors",children:a.jsx(en,{className:"w-5 h-5"})})]})})]}):a.jsxs("button",{onClick:I,className:"w-full bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-all",children:[a.jsx(XY,{className:"w-5 h-5"}),"Open Camera"]})]}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:" Appeal Details"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-white font-medium mb-2",children:"Reason for Appeal *"}),a.jsxs("select",{value:m.reason,onChange:O=>g(M=>({...M,reason:O.target.value})),className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Select a reason"}),a.jsx("option",{value:"payment_not_received",children:"Payment not received"}),a.jsx("option",{value:"payment_sent_but_not_confirmed",children:"Payment sent but not confirmed"}),a.jsx("option",{value:"dispute_over_amount",children:"Dispute over amount"}),a.jsx("option",{value:"technical_issue",children:"Technical issue"}),a.jsx("option",{value:"fraud_suspected",children:"Fraud suspected"}),a.jsx("option",{value:"other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-white font-medium mb-2",children:"Description *"}),a.jsx("textarea",{value:m.description,onChange:O=>g(M=>({...M,description:O.target.value})),placeholder:"Please provide detailed information about your appeal... (Minimum 10 characters)",rows:4,className:`w-full p-3 bg-white/10 border rounded-lg text-white placeholder-gray-400 focus:outline-none ${m.description.length>0&&m.description.length<10?"border-red-500/50 focus:border-red-500":"border-white/20 focus:border-blue-500"}`}),a.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[a.jsxs("div",{className:"text-xs text-gray-400",children:[m.description.length>0&&m.description.length<10&&a.jsxs("span",{className:"text-red-400 flex items-center gap-1",children:[a.jsx(qt,{className:"w-3 h-3"}),"Description must be at least 10 characters (",m.description.length,"/10)"]}),m.description.length>=10&&a.jsxs("span",{className:"text-green-400 flex items-center gap-1",children:[a.jsx(kt,{className:"w-3 h-3"}),m.description.length," characters"]})]}),a.jsxs("div",{className:"text-xs text-gray-400",children:[m.description.length,"/10 minimum"]})]})]})]})]}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:a.jsxs("div",{className:"space-y-4",children:[v.type&&a.jsx("div",{className:`p-4 rounded-lg border ${v.type==="success"?"bg-green-500/20 border-green-500/30 text-green-300":"bg-red-500/20 border-red-500/30 text-red-300"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[v.type==="success"?a.jsx(kt,{className:"w-5 h-5"}):a.jsx(qt,{className:"w-5 h-5"}),a.jsx("span",{className:"font-medium",children:v.message})]})}),a.jsx("button",{onClick:T,disabled:y||!m.reason||!m.description||m.description.trim().length<10,className:"w-full bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-4 rounded-lg font-semibold text-lg flex items-center justify-center gap-3 transition-all shadow-lg hover:shadow-xl",children:y?a.jsxs(a.Fragment,{children:[a.jsx(sr,{className:"w-6 h-6 animate-spin"}),a.jsx("span",{children:"Submitting Appeal..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(kt,{className:"w-6 h-6"}),a.jsx("span",{children:"Submit Appeal"})]})}),(!m.reason||!m.description||m.description.trim().length<10)&&a.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 flex items-start gap-2",children:[a.jsx(qt,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-yellow-200 text-sm",children:[a.jsx("p",{className:"font-medium mb-1",children:"Required fields missing:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-0.5",children:[!m.reason&&a.jsx("li",{children:"Please select a reason for appeal"}),!m.description&&a.jsx("li",{children:"Please provide a description"}),m.description&&m.description.trim().length<10&&a.jsxs("li",{children:["Description must be at least 10 characters (currently ",m.description.trim().length," characters)"]})]})]})]})]})}),k&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:a.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-slate-900 border border-white/10 rounded-xl overflow-hidden",style:{height:"80vh"},children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white",children:"Appeal Guide"}),a.jsx("button",{onClick:()=>C(!1),className:"text-gray-300 hover:text-white transition-colors",children:a.jsx(en,{size:20})})]}),a.jsx("div",{className:"bg-black flex-1 flex items-center justify-center",style:{height:"calc(80vh - 120px)"},children:a.jsx("video",{controls:!0,playsInline:!0,className:"w-full h-full object-contain bg-black",src:"/api/videos/stream/appeal"})}),a.jsxs("div",{className:"p-4 flex items-center justify-end gap-2 border-t border-white/10",children:[a.jsx("a",{href:"/api/videos/stream/appeal",target:"_blank",rel:"noopener noreferrer",className:"text-sm px-4 py-2 rounded-lg bg-violet-600 hover:bg-violet-700 text-white transition-colors",children:"Open in new tab"}),a.jsx("button",{onClick:()=>C(!1),className:"text-sm px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-gray-200 border border-white/10 transition-colors",children:"Close"})]})]})})]})})},Nh="ADMIN_SUPPORT",_Ie={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]},kIe=({isOpen:t,onClose:e,callerAddress:n})=>{const[r,s]=A.useState("initiating"),[i,o]=A.useState(!1),[c,l]=A.useState(!0),[d,u]=A.useState(0),[h,f]=A.useState("disconnected"),p=A.useRef(null),m=A.useRef(null),g=A.useRef(null),y=A.useRef(null),x=A.useRef(null);A.useEffect(()=>{if(!(!t||!n))return console.log(" SupportCallModal: Setting up socket and starting call"),p.current=Po(Na,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,timeout:2e4}),p.current.on("connect",()=>{console.log(" SupportCallModal: Connected to signaling server"),p.current.emit("register",n),console.log(" SupportCallModal: Registered as:",n),p.current.emit("initiate-call",{callId:`support-call-${Date.now()}`,receiverAddress:Nh,callerAddress:n,timestamp:Date.now()}),s("connecting"),U("Waiting for admin to accept...",{icon:""})}),p.current.on("call-accepted-by-admin",N=>{console.log(" SupportCallModal: Admin accepted call!",N),U.success("Admin accepted! Connecting..."),b()}),p.current.on("call-waiting-for-acceptance",N=>{console.log(" SupportCallModal: Call notification sent to admin, waiting for acceptance"),s("connecting")}),p.current.on("answer",async({answer:N,from:I})=>{if(console.log(" SupportCallModal: Received answer from",I),m.current&&N)try{await m.current.setRemoteDescription(new RTCSessionDescription(N)),console.log(" SupportCallModal: Remote description set"),s("connecting")}catch(F){console.error(" SupportCallModal: Error setting remote description:",F)}}),p.current.on("ice-candidate",async({candidate:N,from:I})=>{if(console.log(" SupportCallModal: Received ICE candidate from",I),m.current&&N&&N.candidate)try{await m.current.addIceCandidate(new RTCIceCandidate(N))}catch(F){console.error(" SupportCallModal: Error adding ICE candidate:",F)}}),p.current.on("call-ended",({from:N})=>{console.log(" SupportCallModal: Call ended by",N),v()}),()=>{p.current&&p.current.disconnect(),g.current&&g.current.getTracks().forEach(N=>N.stop()),m.current&&m.current.close()}},[t,n]);const w=()=>{console.log(" SupportCallModal: Creating peer connection");const N=new RTCPeerConnection(_Ie);return N.onicecandidate=I=>{I.candidate&&p.current&&(console.log(" SupportCallModal: Sending ICE candidate to admin"),p.current.emit("ice-candidate",{candidate:I.candidate,to:Nh}))},N.ontrack=I=>{console.log(" SupportCallModal: Received remote track:",I.track.kind),I.streams&&I.streams[0]&&y.current&&(y.current.srcObject=I.streams[0],y.current.play().catch(F=>{console.error(" SupportCallModal: Audio play error:",F),setTimeout(()=>{y.current&&y.current.srcObject&&y.current.play().catch(P=>console.error("Retry failed:",P))},500)}))},N.onconnectionstatechange=()=>{const I=N.connectionState;f(I),console.log(" SupportCallModal: Connection state:",I),I==="connected"?(s("connected"),C(),U.success("Call connected!")):I==="disconnected"||I==="failed"?(s("ended"),v()):I==="connecting"&&s("connecting")},N.oniceconnectionstatechange=()=>{console.log(" SupportCallModal: ICE connection state:",N.iceConnectionState),(N.iceConnectionState==="connected"||N.iceConnectionState==="completed")&&(s("connected"),C())},N},b=async()=>{try{s("connecting"),console.log(" SupportCallModal: Starting call to admin..."),console.log(" Getting microphone access...");const N=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});console.log(" Got local stream"),g.current=N,m.current=w(),N.getAudioTracks().forEach(F=>{m.current.addTrack(F,N)}),console.log(" Creating offer...");const I=await m.current.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});await m.current.setLocalDescription(I),console.log(" Offer created and set"),p.current&&(p.current.emit("offer",{offer:I,to:Nh}),console.log(" Offer sent to admin"))}catch(N){console.error(" SupportCallModal: Error starting call:",N),s("failed"),U.error(N.message||"Failed to start call"),v()}},v=()=>{console.log(" SupportCallModal: Ending call"),x.current&&(clearInterval(x.current),x.current=null),p.current&&p.current.emit("end-call",{to:Nh}),m.current&&(m.current.close(),m.current=null),g.current&&(g.current.getTracks().forEach(N=>N.stop()),g.current=null),s("ended"),u(0),e()},E=()=>{if(g.current){const N=g.current.getAudioTracks()[0];N&&(N.enabled=!N.enabled,o(!N.enabled),U(i?"Microphone unmuted":"Microphone muted",{icon:i?"":""}))}},k=()=>{l(!c),y.current&&(y.current.muted=c),U(c?"Speaker off":"Speaker on",{icon:c?"":""})},C=()=>{if(x.current)return;const N=Date.now();x.current=setInterval(()=>{const I=Math.floor((Date.now()-N)/1e3);u(I)},1e3)},S=N=>{const I=Math.floor(N/60),F=N%60;return`${I.toString().padStart(2,"0")}:${F.toString().padStart(2,"0")}`};return t?a.jsx(Do,{children:t&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:a.jsxs(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 rounded-2xl p-6 w-full max-w-md mx-4 border border-white/20 shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Support Call"}),a.jsx("button",{onClick:v,className:"p-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 transition-colors",children:a.jsx(en,{size:20,className:"text-red-400"})})]}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsxs("div",{className:"w-24 h-24 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4 relative",children:[a.jsx(kC,{size:40,className:"text-white"}),(r==="connecting"||r==="initiating")&&a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-green-400 border-t-transparent animate-spin"})]}),a.jsxs("h3",{className:"text-lg font-semibold text-white mb-2",children:[r==="initiating"&&"Initiating call...",r==="connecting"&&"Connecting...",r==="connected"&&"Connected",r==="ended"&&"Call ended",r==="failed"&&"Call failed"]}),a.jsxs("p",{className:"text-gray-400 text-sm",children:[r==="connected"&&S(d),r!=="connected"&&"Admin Support"]}),h!=="disconnected"&&a.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-2",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${h==="connected"?"bg-green-500":h==="connecting"?"bg-yellow-500":"bg-red-500"}`}),a.jsx("span",{className:"text-xs text-gray-400 capitalize",children:h})]})]}),r==="connected"&&a.jsx("div",{className:"text-center mb-6",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2 text-gray-400",children:[a.jsx(Pr,{size:16}),a.jsx("span",{className:"text-sm font-mono",children:S(d)})]})}),a.jsxs("div",{className:"flex items-center justify-center space-x-6 mb-6",children:[a.jsx("button",{onClick:E,className:`p-4 rounded-full transition-colors ${i?"bg-red-500/20 hover:bg-red-500/30":"bg-white/10 hover:bg-white/20"}`,children:i?a.jsx(uw,{size:24,className:"text-red-400"}):a.jsx(ug,{size:24,className:"text-white"})}),a.jsx("button",{onClick:v,className:"p-4 rounded-full bg-red-500 hover:bg-red-600 transition-colors",children:a.jsx(Vx,{size:24,className:"text-white"})}),a.jsx("button",{onClick:k,className:`p-4 rounded-full transition-colors ${c?"bg-white/10 hover:bg-white/20":"bg-yellow-500/20 hover:bg-yellow-500/30"}`,children:c?a.jsx(kB,{size:24,className:"text-white"}):a.jsx(IB,{size:24,className:"text-yellow-400"})})]}),a.jsx("audio",{ref:y,autoPlay:!0})]})})}):null},RV=()=>{const t="0123456789abcdef";let e="0x";for(let n=0;n<40;n++)e+=t[Math.floor(Math.random()*t.length)];return e},DU=()=>{const[t,e]=A.useState(!0),[n,r]=A.useState(!1),[s,i]=A.useState(null),[o,c]=A.useState(!1),[l,d]=A.useState(null),[u,h]=A.useState(!1),f=ds(),{walletAddress:p}=SC(),{address:m}=Xt(),g=p||m||RV();A.useEffect(()=>{y(),x();const v=()=>{h(!1)};return Ug.onCallEvent("call-ended",v),()=>{Ug.offCallEvent("call-ended")}},[]);const y=()=>{const v=navigator.userAgent.toLowerCase(),E=v.includes("metamask")||v.includes("mim")||window.ethereum&&window.ethereum.isMetaMask&&v.includes("mobile");r(E),e(!1),E&&U("Please open this page in Chrome browser for better call experience",{duration:5e3,icon:""})},x=async()=>{var v;try{const E=await fetch("/api/admin/support-address");if(E.ok){const k=await E.json();k.success&&((v=k.data)!=null&&v.address)?i(k.data.address):(console.log(" Using fixed ADMIN_SUPPORT address"),i(Nh))}else console.log(" API failed, using fixed ADMIN_SUPPORT address"),i(Nh)}catch(E){console.error("Error fetching admin address:",E),console.log(" Using fixed ADMIN_SUPPORT address (fallback)"),i(Nh)}},w=async()=>{try{c(!0),d(null),console.log(" Opening support call modal with address:",g),h(!0),U.success("Connecting to admin support...")}catch(v){console.error("Error opening support call:",v),d(v.message||"Failed to open call"),U.error(v.message||"Failed to open call"),h(!1)}finally{c(!1)}},b=()=>{const v=window.location.href;navigator.userAgent.includes("Android")?window.location.href=`intent://${v.replace(/^https?:\/\//,"")}#Intent;scheme=https;package=com.android.chrome;end`:U("Please copy the URL and open it in Chrome browser",{duration:5e3})};return t?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-violet-500"}),a.jsx("p",{className:"text-gray-300",children:"Checking browser..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:[a.jsxs("div",{className:"max-w-md mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("button",{onClick:()=>f(-1),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:a.jsx(en,{size:20,className:"text-white"})}),a.jsx("h1",{className:"text-xl font-bold text-white",children:"Support Call"}),a.jsx("div",{className:"w-9"})," "]}),n&&a.jsx(X.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(qt,{size:20,className:"text-yellow-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-yellow-300 font-medium text-sm mb-2",children:"MetaMask Browser Detected"}),a.jsx("p",{className:"text-yellow-400 text-xs mb-3",children:"For the best call experience, please open this page in Chrome browser."}),a.jsx("button",{onClick:b,className:"text-xs bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-300 px-3 py-1.5 rounded-lg transition-colors",children:"Open in Chrome"})]})]})}),a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(kC,{size:32,className:"text-white"})}),a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Contact Admin Support"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Get instant help from our admin team through voice call"})]}),p&&a.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(kt,{size:16,className:"text-blue-400"}),a.jsxs("p",{className:"text-blue-300 text-sm",children:["Wallet Address: ",p.slice(0,8),"...",p.slice(-6)]})]}),a.jsx("p",{className:"text-blue-400 text-xs mt-2",children:"Call will be made using wallet address from URL"})]}),!g&&a.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(qt,{size:16,className:"text-red-400"}),a.jsx("p",{className:"text-red-300 text-sm",children:p?"Invalid wallet address in URL":"Please connect your wallet or provide wallet address in URL"})]}),a.jsx("button",{onClick:()=>f("/"),className:"mt-3 w-full bg-red-500/20 hover:bg-red-500/30 text-red-300 py-2 px-4 rounded-lg font-medium transition-colors text-sm",children:"Go to Dashboard"})]}),l&&a.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(qt,{size:16,className:"text-red-400"}),a.jsx("p",{className:"text-red-300 text-sm",children:l})]})}),a.jsx("button",{onClick:w,disabled:!g||o,className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 disabled:from-gray-500 disabled:to-gray-600 disabled:opacity-50 text-white py-4 px-6 rounded-lg font-semibold transition-all flex items-center justify-center space-x-2",children:o?a.jsxs(a.Fragment,{children:[a.jsx(sr,{className:"w-5 h-5 animate-spin"}),a.jsx("span",{children:"Connecting..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(dn,{size:20}),a.jsx("span",{children:"Call Admin Support"})]})}),s===null&&a.jsx("p",{className:"text-center text-gray-400 text-xs mt-4",children:"Preparing admin support connection..."}),a.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:a.jsxs("div",{className:"space-y-2 text-xs text-gray-400",children:[a.jsxs("p",{className:"flex items-center space-x-2",children:[a.jsx(dn,{size:14,className:"text-green-400"}),a.jsx("span",{children:"Voice call powered by WebRTC"})]}),a.jsxs("p",{className:"flex items-center space-x-2",children:[a.jsx(qt,{size:14,className:"text-violet-400"}),a.jsx("span",{children:"Make sure microphone permissions are enabled"})]})]})})]})]}),g&&a.jsx(kIe,{isOpen:u,callerAddress:g,onClose:()=>{h(!1)}})]})},IIe=()=>{const[t,e]=A.useState(!0),[n,r]=A.useState(!1),[s,i]=A.useState(null),[o,c]=A.useState(null),[l,d]=A.useState(!0),[u,h]=A.useState(null),[f,p]=A.useState("idle"),[m,g]=A.useState(!1),[y,x]=A.useState(0),[w,b]=A.useState(!1),[v,E]=A.useState("disconnected"),[k,C]=A.useState(!1),S=ds(),{orderId:N,walletAddress:I}=SC(),F=I||RV(),P=A.useRef(null),H=A.useRef(null),z=A.useRef(null),T=A.useRef(null),_=A.useRef(null),L=A.useRef(null),O={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]},M=A.useCallback(()=>{if(!N||!I)return;const pe=`${window.location.href.split("/#")[0]}/call/${N}/${I}`;if(window.confirm(` Microphone Access Required!

To make voice calls, you need to open this in Chrome browser with microphone permissions.

Click OK to open in Chrome browser.

This will redirect you to: ${pe}

Wallet: ${I}
Order: ${N}`))try{window.open(pe,"_blank"),navigator.clipboard.writeText(pe).then(()=>{U.success("URL copied to clipboard! Paste it in Chrome browser.")}).catch(()=>{U.error("Please copy this URL and open in Chrome browser: "+pe)})}catch(Tn){console.error("Error opening external browser:",Tn),U.error("Please copy this URL and open in Chrome browser: "+pe)}},[N,I]);A.useCallback(()=>{if(!N||!I)return;const pe=`${window.location.href.split("/#")[0]}/call/${N}/${I}`;if(window.confirm(` DApp Browser Detected!

To make voice calls, you need to open this in your default browser (Chrome, Safari, etc.).

Click OK to open in external browser.

This will redirect you to: ${pe}

Wallet: ${I}
Order: ${N}`))try{window.open(pe,"_blank"),navigator.clipboard.writeText(pe).then(()=>{U.success("URL copied to clipboard! Paste it in your browser.")}).catch(()=>{U.error("Please copy this URL and open in your browser: "+pe)})}catch(Tn){console.error("Error opening external browser:",Tn),U.error("Please copy this URL and open in your browser: "+pe)}},[N,I]),A.useEffect(()=>{(async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){console.warn("MediaDevices API not available"),i(!1),e(!1);return}const je=await navigator.permissions.query({name:"microphone"}).catch(()=>null);if((je==null?void 0:je.state)==="denied"){console.warn("Microphone permission denied"),i(!1),e(!1);return}try{(await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})).getTracks().forEach(ot=>ot.stop()),i(!0)}catch(pe){console.warn("Failed to get microphone access:",pe),i(!1)}}catch(je){console.error("Error checking microphone:",je),i(!1)}finally{e(!1)}})()},[]),A.useEffect(()=>{!t&&s!==!1&&B()},[t,s,N,I]);const B=async()=>{var me;try{d(!0),h(null);const je=localStorage.getItem("authToken")||"",pe=await fetch("/api/orders/my-orders",{headers:{"Content-Type":"application/json",...je&&{Authorization:`Bearer ${je}`}}});if(!pe.ok)throw new Error("Failed to fetch order details. Please login to access this feature.");const nt=((await pe.json()).data||[]).find(ht=>String(ht.id)===String(N));if(!nt)throw new Error("Order not found");const mn={id:String(nt.id),buyerAddress:nt.buyer_address,sellerAddress:nt.seller_address,amount:nt.amount,token:nt.token,state:nt.state,buyerName:nt.buyer_name,sellerName:nt.seller_name};c(mn);const Ve=F.toLowerCase()===mn.buyerAddress.toLowerCase(),rt=F.toLowerCase()===mn.sellerAddress.toLowerCase();Ve?L.current=mn.sellerAddress:rt?L.current=mn.buyerAddress:L.current=Ve?mn.sellerAddress:mn.buyerAddress,L.current&&((me=P.current)!=null&&me.connected)&&W()}catch(je){console.error("Error fetching order:",je),h(je.message||"Failed to fetch order details")}finally{d(!1)}},W=()=>{P.current&&L.current&&P.current.emit("check-user-status",L.current)},Z=()=>{H.current&&H.current.close(),console.log(" OrderCallPage: Creating peer connection");const me=new RTCPeerConnection(O);return me.onicecandidate=je=>{je.candidate&&P.current&&L.current&&(console.log(" OrderCallPage: Sending ICE candidate"),P.current.emit("ice-candidate",{candidate:je.candidate,to:L.current}))},me.ontrack=je=>{console.log(" OrderCallPage: Received remote track:",je.track.kind),je.streams&&je.streams[0]&&T.current&&(T.current.srcObject=je.streams[0],T.current.play().catch(pe=>{console.error(" Audio play error:",pe),setTimeout(()=>{T.current&&T.current.srcObject&&T.current.play().catch(ot=>console.error("Retry failed:",ot))},500)}))},me.onconnectionstatechange=()=>{const je=me.connectionState;console.log(" OrderCallPage: Connection state:",je),E(je),je==="connected"?(p("active"),de(),U.success("Call connected!")):(je==="disconnected"||je==="failed")&&ae()},me},ie=async()=>{if(!L.current||!P.current){U.error("Target user not available");return}try{p("connecting");const me=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});z.current=me,H.current=Z(),me.getAudioTracks().forEach(pe=>{H.current.addTrack(pe,me)});const je=await H.current.createOffer();await H.current.setLocalDescription(je),P.current.emit("offer",{offer:je,to:L.current}),p("ringing"),U.success("Call initiated")}catch(me){console.error("Error starting call:",me),U.error(me.message||"Failed to start call"),p("idle"),oe()}},ae=()=>{p("idle"),_e(),oe(),P.current&&L.current&&P.current.emit("end-call",{to:L.current}),U("Call ended",{icon:""})},oe=()=>{H.current&&(H.current.close(),H.current=null),z.current&&(z.current.getTracks().forEach(me=>me.stop()),z.current=null),E("disconnected")},Ne=()=>{if(z.current){const me=z.current.getAudioTracks()[0];me&&(me.enabled=!me.enabled,g(!me.enabled),U(m?"Microphone unmuted":"Microphone muted",{icon:m?"":""}))}},de=()=>{_.current&&clearInterval(_.current),x(0),_.current=setInterval(()=>{x(me=>me+1)},1e3)},_e=()=>{_.current&&(clearInterval(_.current),_.current=null),x(0)},Ue=me=>{const je=Math.floor(me/60),pe=me%60;return`${je.toString().padStart(2,"0")}:${pe.toString().padStart(2,"0")}`};if(t)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-violet-500"}),a.jsx("p",{className:"text-gray-300",children:"Checking microphone access..."})]})});if(s===!1)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 max-w-md text-center",children:[a.jsx(uw,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Microphone Access Required"}),a.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"To make voice calls, you need to grant microphone permissions. Please open this page in Chrome browser and allow microphone access."}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("button",{onClick:M,className:"w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Open in Chrome Browser"}),a.jsx("button",{onClick:()=>S("/orders"),className:"w-full bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go Back to Orders"})]})]})});if(n)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 max-w-md text-center",children:[a.jsx(qt,{className:"w-12 h-12 text-yellow-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"DApp Browser Detected"}),a.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"Please open this page in Chrome or Safari browser for the best call experience."}),a.jsx("button",{onClick:()=>S("/orders"),className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go Back to Orders"})]})});if(l)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:a.jsxs("div",{className:"text-center",children:[a.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-violet-500"}),a.jsx("p",{className:"text-gray-300",children:"Loading order details..."})]})});if(u||!o)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 max-w-md text-center",children:[a.jsx(qt,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Order Not Found"}),a.jsx("p",{className:"text-gray-300 text-sm mb-4",children:u||"Unable to load order details"}),a.jsx("button",{onClick:()=>S("/orders"),className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go Back to Orders"})]})});const ee=F.toLowerCase()===o.buyerAddress.toLowerCase(),q=F.toLowerCase()===o.sellerAddress.toLowerCase(),ue=ee?o.sellerAddress:o.buyerAddress,Ae=ee?o.sellerName:o.buyerName,tt=ee?"Buyer":q?"Seller":"Unknown";return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:[a.jsxs("div",{className:"max-w-md mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("button",{onClick:()=>S("/orders"),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:a.jsx(en,{size:20,className:"text-white"})}),a.jsx("h1",{className:"text-xl font-bold text-white",children:"Order Call"}),a.jsx("div",{className:"w-9"})]}),a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(kC,{size:28,className:"text-white"})}),a.jsxs("h2",{className:"text-lg font-bold text-white mb-2",children:["Order #",o.id]}),a.jsxs("p",{className:"text-gray-300 text-sm",children:[o.amount," ",o.token]})]}),a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsx(kt,{size:14,className:"text-blue-400"}),a.jsxs("p",{className:"text-blue-300 text-sm font-medium",children:["You (",tt,")"]})]}),a.jsx("p",{className:"text-blue-400 text-xs font-mono break-all",children:F}),w&&a.jsxs("div",{className:"flex items-center space-x-1 mt-2",children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),a.jsx("span",{className:"text-green-400 text-xs",children:"Connected"})]})]}),a.jsxs("div",{className:"bg-purple-500/20 border border-purple-500/30 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsx(dn,{size:14,className:"text-purple-400"}),a.jsxs("p",{className:"text-purple-300 text-sm font-medium",children:[ee?"Seller":"Buyer",Ae&&` (${Ae})`]})]}),a.jsx("p",{className:"text-purple-400 text-xs font-mono break-all",children:ue}),a.jsx("div",{className:"flex items-center space-x-1 mt-2",children:k?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),a.jsx("span",{className:"text-green-400 text-xs",children:"Online"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),a.jsx("span",{className:"text-gray-400 text-xs",children:"Offline"})]})})]})]}),!w&&a.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4",children:a.jsx("p",{className:"text-yellow-300 text-sm",children:"Connecting to call service..."})}),w&&a.jsxs("div",{className:"space-y-3",children:[f==="idle"&&a.jsxs("button",{onClick:ie,disabled:!k,className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 disabled:from-gray-500 disabled:to-gray-600 disabled:opacity-50 text-white py-4 px-6 rounded-lg font-semibold transition-all flex items-center justify-center space-x-2",children:[a.jsx(dn,{size:20}),a.jsx("span",{children:k?"Call Other Party":"Other Party Offline"})]}),f==="connecting"&&a.jsxs("div",{className:"text-center py-4",children:[a.jsx(sr,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-blue-400"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Connecting..."})]}),f==="ringing"&&a.jsxs("div",{className:"text-center py-4",children:[a.jsx(sr,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-yellow-400"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Ringing..."})]}),f==="active"&&a.jsxs("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-4",children:[a.jsx("div",{className:"flex items-center justify-center space-x-4 mb-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Pr,{size:24,className:"text-green-400 mx-auto mb-2"}),a.jsx("p",{className:"text-green-300 font-mono text-lg",children:Ue(y)})]})}),a.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[a.jsx(X.button,{onClick:Ne,className:`p-3 rounded-full transition-colors ${m?"bg-red-500/20 text-red-400":"bg-white/10 text-green-400"}`,whileTap:{scale:.95},children:m?a.jsx(uw,{size:24}):a.jsx(ug,{size:24})}),a.jsx(X.button,{onClick:ae,className:"p-3 rounded-full bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors",whileTap:{scale:.95},children:a.jsx(Vx,{size:24})})]}),a.jsx("p",{className:"text-center text-green-300 text-sm mt-4",children:"Call Active"})]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:a.jsxs("div",{className:"space-y-2 text-xs text-gray-400",children:[a.jsxs("p",{className:"flex items-center space-x-2",children:[a.jsx(dn,{size:14,className:"text-green-400"}),a.jsx("span",{children:"Voice call powered by WebRTC"})]}),a.jsxs("p",{className:"flex items-center space-x-2",children:[a.jsx(qt,{size:14,className:"text-violet-400"}),a.jsx("span",{children:"Make sure microphone permissions are enabled"})]})]})})]})]}),a.jsx("audio",{ref:T,autoPlay:!0,style:{display:"none"}})]})},jIe=()=>{const[t,e]=A.useState({email:"admin@zotrust.com",password:"admin123"}),[n,r]=A.useState(!1),[s,i]=A.useState(!1),o=ds(),c=async d=>{var u,h;d.preventDefault(),i(!0);try{const f=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),p=await f.json();f.ok?(console.log("AdminLogin - Response data:",p),console.log("AdminLogin - Token received:",(u=p.data)==null?void 0:u.token),localStorage.setItem("adminToken",(h=p.data)==null?void 0:h.token),console.log("AdminLogin - Token stored in localStorage"),U.success("Login successful!"),o("/admin")):U.error(p.error||"Login failed")}catch(f){console.error("Login error:",f),U.error("Login failed. Please try again.")}finally{i(!1)}},l=d=>{e({...t,[d.target.name]:d.target.value})};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 w-full max-w-md border border-white/20",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(X.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(uf,{className:"w-8 h-8 text-white"})}),a.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Admin Portal"}),a.jsx("p",{className:"text-gray-300",children:"Sign in to access the admin dashboard"})]}),a.jsxs("form",{onSubmit:c,className:"space-y-6",children:[a.jsxs(X.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),a.jsx("div",{className:"relative",children:a.jsx("input",{type:"email",name:"email",value:t.email,onChange:l,required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"admin@zotrust.com"})})]}),a.jsxs(X.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:n?"text":"password",name:"password",value:t.password,onChange:l,required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-12",placeholder:"Enter your password"}),a.jsx("button",{type:"button",onClick:()=>r(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white transition-colors",children:n?a.jsx(NB,{size:20}):a.jsx(dg,{size:20})})]})]}),a.jsx(X.button,{type:"submit",disabled:s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:from-purple-700 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:s?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),a.jsx("span",{children:"Signing in..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Wa,{size:20}),a.jsx("span",{children:"Sign In"})]})})]}),a.jsxs(X.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-8 text-center",children:[a.jsx("p",{className:"text-gray-400 text-sm",children:"Secure admin access to Zotrust platform"}),a.jsx("button",{onClick:()=>{localStorage.clear(),U.success("Local storage cleared")},className:"mt-2 text-xs text-gray-500 hover:text-gray-300 underline",children:"Clear expired tokens"})]})]})})},RIe=()=>{const[t,e]=A.useState({totalOrders:0,totalTransactions:0,totalDisputes:0,totalAgents:0,totalLocations:0,pendingDisputes:0,completedOrders:0,totalVolume:0}),[n,r]=A.useState(!0),s=ds();A.useEffect(()=>{i()},[]);const i=async()=>{try{const l=localStorage.getItem("adminToken");if(console.log("AdminDashboard - Token from localStorage:",l),!l){s("/admin/login");return}console.log("AdminDashboard - Making request to /api/admin/dashboard-stats");const d=await fetch("/api/admin/dashboard-stats",{headers:{Authorization:`Bearer ${l}`}});if(d.ok){const u=await d.json();e(u.data)}else d.status===401?(localStorage.removeItem("adminToken"),s("/admin/login")):U.error("Failed to load dashboard stats")}catch(l){console.error("Error fetching dashboard stats:",l),U.error("Failed to load dashboard stats")}finally{r(!1)}},o=[{title:"Total Orders",value:t.totalOrders,icon:G2,color:"from-blue-500 to-blue-600",bgColor:"bg-blue-500/10",textColor:"text-blue-400"},{title:"Total Transactions",value:t.totalTransactions,icon:dw,color:"from-green-500 to-green-600",bgColor:"bg-green-500/10",textColor:"text-green-400"},{title:"Active Disputes",value:t.totalDisputes,icon:eE,color:"from-orange-500 to-orange-600",bgColor:"bg-orange-500/10",textColor:"text-orange-400"},{title:"Pending Disputes",value:t.pendingDisputes,icon:Xd,color:"from-red-500 to-red-600",bgColor:"bg-red-500/10",textColor:"text-red-400"},{title:"Total Agents",value:t.totalAgents,icon:wl,color:"from-purple-500 to-purple-600",bgColor:"bg-purple-500/10",textColor:"text-purple-400"},{title:"Total Locations",value:t.totalLocations,icon:df,color:"from-indigo-500 to-indigo-600",bgColor:"bg-indigo-500/10",textColor:"text-indigo-400"},{title:"Completed Orders",value:t.completedOrders,icon:kt,color:"from-emerald-500 to-emerald-600",bgColor:"bg-emerald-500/10",textColor:"text-emerald-400"},{title:"Total Volume",value:`$${t.totalVolume.toLocaleString()}`,icon:ko,color:"from-yellow-500 to-yellow-600",bgColor:"bg-yellow-500/10",textColor:"text-yellow-400"}],c=[{title:"Manage Orders",description:"View and manage all orders",icon:G2,color:"from-blue-500 to-blue-600",onClick:()=>s("/admin/orders")},{title:"View Transactions",description:"Monitor all transactions",icon:dw,color:"from-green-500 to-green-600",onClick:()=>s("/admin/transactions")},{title:"Resolve Disputes",description:"Handle dispute cases",icon:eE,color:"from-orange-500 to-orange-600",onClick:()=>s("/admin/disputes")},{title:"Manage Agents",description:"Add and manage agents",icon:wl,color:"from-purple-500 to-purple-600",onClick:()=>s("/admin/agents")},{title:"Manage Locations",description:"Add and manage locations",icon:df,color:"from-indigo-500 to-indigo-600",onClick:()=>s("/admin/locations")}];return n?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading dashboard..."})]})}):a.jsxs("div",{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:o.map((l,d)=>a.jsx(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:d*.1},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 hover:bg-white/20 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-300 text-sm font-medium",children:l.title}),a.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:l.value})]}),a.jsx("div",{className:`w-12 h-12 rounded-lg ${l.bgColor} flex items-center justify-center`,children:a.jsx(l.icon,{className:`w-6 h-6 ${l.textColor}`})})]})},l.title))}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Quick Actions"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map((l,d)=>a.jsx(X.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:d*.1},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:l.onClick,className:"bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg p-4 text-left transition-all duration-300 group",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-r ${l.color} flex items-center justify-center`,children:a.jsx(l.icon,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-white font-medium group-hover:text-white/90",children:l.title}),a.jsx("p",{className:"text-gray-400 text-sm",children:l.description})]})]})},l.title))})]})]})},PIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,c]=A.useState(""),[l,d]=A.useState("all"),[u,h]=A.useState(null),[f,p]=A.useState(!1),[m,g]=A.useState({totalTransactionsToday:0,totalAmountToday:0,totalAdminFees:0,totalReleasedAmount:0,totalTokensReleased:0,totalTokensToAdmin:0,totalTokensToSellers:0}),y=ds();A.useEffect(()=>{w()},[]),A.useEffect(()=>{b(),x()},[t,o,l]);const x=()=>{const S=new Date().toDateString(),N=t.filter(O=>new Date(O.created_at).toDateString()===S),I=t.filter(O=>O.state==="RELEASED");let F=N.length,P=0,H=0,z=0,T=0,_=0,L=0;N.forEach(O=>{const M=parseFloat(O.amount);P+=M}),I.forEach(O=>{const M=parseFloat(O.amount),B=parseFloat(O.price_inr),W=M*B,Z=W*.018,ie=W-Z,ae=M*.018,oe=M-ae;H+=Z,z+=ie,T+=M,_+=ae,L+=oe}),g({totalTransactionsToday:F,totalAmountToday:P,totalAdminFees:H,totalReleasedAmount:z,totalTokensReleased:T,totalTokensToAdmin:_,totalTokensToSellers:L})},w=async()=>{try{const S=localStorage.getItem("adminToken");if(!S){y("/admin/login");return}const N=await fetch("/api/admin/orders",{headers:{Authorization:`Bearer ${S}`}});if(N.ok){const I=await N.json();e(I.data)}else N.status===401?(localStorage.removeItem("adminToken"),y("/admin/login")):U.error("Failed to load orders")}catch(S){console.error("Error fetching orders:",S),U.error("Failed to load orders")}finally{i(!1)}},b=()=>{let S=t;o&&(S=S.filter(N=>{var I,F;return N.id.toString().toLowerCase().includes(o.toLowerCase())||N.buyer_address.toLowerCase().includes(o.toLowerCase())||N.seller_address.toLowerCase().includes(o.toLowerCase())||N.agent_branch.toLowerCase().includes(o.toLowerCase())||((I=N.buyer_name)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))||((F=N.seller_name)==null?void 0:F.toLowerCase().includes(o.toLowerCase()))})),l!=="all"&&(S=S.filter(N=>N.state===l)),r(S)},v=S=>{switch(S){case"CREATED":return"text-blue-400 bg-blue-500/10";case"ACCEPTED":return"text-yellow-400 bg-yellow-500/10";case"LOCKED":return"text-orange-400 bg-orange-500/10";case"RELEASED":return"text-green-400 bg-green-500/10";case"CANCELLED":return"text-red-400 bg-red-500/10";case"EXPIRED":return"text-gray-400 bg-gray-500/10";case"UNDER_DISPUTE":return"text-purple-400 bg-purple-500/10";case"REFUNDED":return"text-pink-400 bg-pink-500/10";default:return"text-gray-400 bg-gray-500/10"}},E=S=>{switch(S){case"CREATED":return a.jsx(Pr,{size:16});case"ACCEPTED":return a.jsx(kt,{size:16});case"LOCKED":return a.jsx(Xd,{size:16});case"RELEASED":return a.jsx(kt,{size:16});case"CANCELLED":return a.jsx(xr,{size:16});case"EXPIRED":return a.jsx(xr,{size:16});case"UNDER_DISPUTE":return a.jsx(Xd,{size:16});case"REFUNDED":return a.jsx(ko,{size:16});default:return a.jsx(Pr,{size:16})}},k=S=>{h(S),p(!0)},C=async S=>{try{const N=localStorage.getItem("adminToken"),I=await fetch(`/api/admin/orders/${S}/manual-refund`,{method:"POST",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"}});if(I.ok)U.success("Manual refund initiated"),w(),p(!1);else{const F=await I.json();U.error(F.error||"Failed to initiate refund")}}catch(N){console.error("Error initiating manual refund:",N),U.error("Failed to initiate refund")}};return s?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading orders..."})]})}):a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-100 text-sm",children:"Today's Transactions"}),a.jsx("p",{className:"text-2xl font-bold",children:m.totalTransactionsToday})]}),a.jsx(ko,{size:24,className:"text-blue-200"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-green-100 text-sm",children:"Total Tokens Released"}),a.jsxs("p",{className:"text-2xl font-bold",children:[m.totalTokensReleased.toFixed(6)," TBNB"]})]}),a.jsx(ko,{size:24,className:"text-green-200"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-purple-100 text-sm",children:"Admin Wallet (1.8%)"}),a.jsxs("p",{className:"text-2xl font-bold",children:[m.totalTokensToAdmin.toFixed(6)," TBNB"]}),a.jsxs("p",{className:"text-purple-200 text-xs",children:["",m.totalAdminFees.toFixed(2)]})]}),a.jsx(ko,{size:24,className:"text-purple-200"})]})}),a.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-orange-100 text-sm",children:"Released to Sellers"}),a.jsxs("p",{className:"text-2xl font-bold",children:[m.totalTokensToSellers.toFixed(6)," TBNB"]}),a.jsxs("p",{className:"text-orange-200 text-xs",children:["",m.totalReleasedAmount.toFixed(2)]})]}),a.jsx(ko,{size:24,className:"text-orange-200"})]})})]}),a.jsx("div",{className:"flex justify-end mb-6",children:a.jsxs("button",{onClick:w,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",value:o,onChange:S=>c(S.target.value),placeholder:"Search by ID, address, or agent...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status Filter"}),a.jsxs("select",{value:l,onChange:S=>d(S.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"CREATED",children:"Created"}),a.jsx("option",{value:"ACCEPTED",children:"Accepted"}),a.jsx("option",{value:"LOCKED",children:"Locked"}),a.jsx("option",{value:"RELEASED",children:"Released"}),a.jsx("option",{value:"CANCELLED",children:"Cancelled"}),a.jsx("option",{value:"EXPIRED",children:"Expired"}),a.jsx("option",{value:"UNDER_DISPUTE",children:"Under Dispute"}),a.jsx("option",{value:"REFUNDED",children:"Refunded"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",n.length," of ",t.length," orders"]})})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order ID"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Buyer"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Seller"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Agent"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((S,N)=>a.jsxs(X.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.05},className:"hover:bg-white/5 transition-colors",children:[a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",S.id]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S.ad_type==="BUY"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:S.ad_type})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium",children:[S.amount," ",S.token]}),a.jsxs("div",{className:"text-xs text-gray-400",children:["",parseFloat(S.price_inr).toFixed(2)]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:S.buyer_name||"Unknown"}),a.jsx("div",{className:"text-xs text-gray-400",children:S.buyer_mobile||"No mobile"}),a.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[S.buyer_address.slice(0,8),"...",S.buyer_address.slice(-6)]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:S.seller_name||"Unknown"}),a.jsx("div",{className:"text-xs text-gray-400",children:S.seller_mobile||"No mobile"}),a.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[S.seller_address.slice(0,8),"...",S.seller_address.slice(-6)]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${v(S.state)}`,children:[E(S.state),a.jsx("span",{className:"ml-1",children:S.state})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:S.agent_branch}),a.jsx("div",{className:"text-xs text-gray-400",children:S.agent_mobile}),a.jsx("div",{className:"text-xs text-gray-500",children:S.location_city})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(S.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a.jsx("button",{onClick:()=>k(S),className:"text-blue-400 hover:text-blue-300 transition-colors",children:a.jsx(dg,{size:16})})})]},S.id))})]})})}),f&&u&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:a.jsxs(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:"Order Details"}),a.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(xr,{size:24})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order ID"}),a.jsxs("p",{className:"text-white font-mono",children:["#",u.id]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${v(u.state)}`,children:[E(u.state),a.jsx("span",{className:"ml-1",children:u.state})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Amount"}),a.jsxs("p",{className:"text-white",children:[u.amount," ",u.token]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Price (INR)"}),a.jsxs("p",{className:"text-white",children:["",u.price_inr]})]})]}),a.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:[a.jsx("h4",{className:"text-blue-300 font-medium mb-2",children:"Buyer Information"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Name:"})," ",u.buyer_name||"Unknown"]}),a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Mobile:"})," ",u.buyer_mobile||"No mobile"]}),a.jsxs("p",{className:"text-white font-mono text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Address:"})," ",u.buyer_address]})]})]}),a.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-4",children:[a.jsx("h4",{className:"text-green-300 font-medium mb-2",children:"Seller Information"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Name:"})," ",u.seller_name||"Unknown"]}),a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Mobile:"})," ",u.seller_mobile||"No mobile"]}),a.jsxs("p",{className:"text-white font-mono text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Address:"})," ",u.seller_address]})]})]}),a.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-4",children:[a.jsx("h4",{className:"text-purple-300 font-medium mb-2",children:"Agent Information"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Branch:"})," ",u.agent_branch]}),a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Mobile:"})," ",u.agent_mobile]}),a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Address:"})," ",u.agent_address]}),a.jsxs("p",{className:"text-white",children:[a.jsx("span",{className:"text-gray-400",children:"Location:"})," ",u.location_city,", ",u.location_state,", ",u.location_country]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Created At"}),a.jsx("p",{className:"text-white",children:new Date(u.created_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Accepted At"}),a.jsx("p",{className:"text-white",children:u.accepted_at?new Date(u.accepted_at).toLocaleString():"N/A"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Buyer Confirmed"}),a.jsx("p",{className:"text-white",children:u.buyer_confirmed?" Yes":" No"}),u.buyer_confirmed_at&&a.jsx("p",{className:"text-gray-400 text-xs",children:new Date(u.buyer_confirmed_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Seller Confirmed"}),a.jsx("p",{className:"text-white",children:u.seller_confirmed?" Yes":" No"}),u.seller_confirmed_at&&a.jsx("p",{className:"text-gray-400 text-xs",children:new Date(u.seller_confirmed_at).toLocaleString()})]})]}),u.state==="RELEASED"&&a.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/20 rounded-lg p-4",children:[a.jsx("h4",{className:"text-orange-300 font-medium mb-2",children:"Financial Breakdown"}),a.jsx("div",{className:"space-y-3",children:a.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[a.jsx("h5",{className:"text-white font-medium mb-2",children:"Token Distribution"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"Total Tokens:"}),a.jsxs("span",{className:"text-white font-mono",children:[parseFloat(u.amount).toFixed(6)," TBNB"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-400",children:"Admin Wallet (1.8%):"}),a.jsxs("span",{className:"text-orange-400 font-mono",children:[(parseFloat(u.amount)*.018).toFixed(6)," TBNB"]})]}),a.jsxs("div",{className:"flex justify-between border-t border-orange-500/20 pt-2",children:[a.jsx("span",{className:"text-gray-400 font-medium",children:"Released to Seller:"}),a.jsxs("span",{className:"text-green-400 font-medium font-mono",children:[(parseFloat(u.amount)*.982).toFixed(6)," TBNB"]})]})]})]})})]}),u.tx_hash&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Transaction Hash"}),a.jsx("p",{className:"text-white font-mono text-sm break-all",children:u.tx_hash}),u.blockchain_trade_id&&a.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["Trade ID: ",u.blockchain_trade_id]})]}),["LOCKED","UNDER_DISPUTE"].includes(u.state)&&a.jsx("div",{className:"pt-4 border-t border-white/20",children:a.jsx("button",{onClick:()=>C(u.id),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Initiate Manual Refund"})})]})]})})]})},OIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,c]=A.useState(""),[l,d]=A.useState("all"),[u,h]=A.useState("all"),[f,p]=A.useState(null),[m,g]=A.useState(!1),y=ds();A.useEffect(()=>{x()},[]),A.useEffect(()=>{w()},[t,o,l,u]);const x=async()=>{try{const C=localStorage.getItem("adminToken");if(!C){y("/admin/login");return}const S=await fetch("/api/admin/transactions",{headers:{Authorization:`Bearer ${C}`}});if(S.ok){const N=await S.json();e(N.data)}else S.status===401?(localStorage.removeItem("adminToken"),y("/admin/login")):U.error("Failed to load transactions")}catch(C){console.error("Error fetching transactions:",C),U.error("Failed to load transactions")}finally{i(!1)}},w=()=>{let C=t;o&&(C=C.filter(S=>S.id.toLowerCase().includes(o.toLowerCase())||S.order_id.toLowerCase().includes(o.toLowerCase())||S.tx_hash.toLowerCase().includes(o.toLowerCase()))),l!=="all"&&(C=C.filter(S=>S.status===l)),u!=="all"&&(C=C.filter(S=>S.transaction_type===u)),r(C)},b=C=>{switch(C){case"PENDING":return"text-yellow-400 bg-yellow-500/10";case"COMPLETED":return"text-green-400 bg-green-500/10";case"FAILED":return"text-red-400 bg-red-500/10";case"CANCELLED":return"text-gray-400 bg-gray-500/10";default:return"text-gray-400 bg-gray-500/10"}},v=C=>{switch(C){case"PENDING":return a.jsx(Pr,{size:16});case"COMPLETED":return a.jsx(kt,{size:16});case"FAILED":return a.jsx(xr,{size:16});case"CANCELLED":return a.jsx(xr,{size:16});default:return a.jsx(Pr,{size:16})}},E=C=>{switch(C){case"DEPOSIT":return a.jsx(_B,{size:16,className:"text-green-400"});case"WITHDRAWAL":return a.jsx(uJ,{size:16,className:"text-red-400"});case"TRANSFER":return a.jsx(ko,{size:16,className:"text-blue-400"});default:return a.jsx(ko,{size:16,className:"text-gray-400"})}},k=C=>{p(C),g(!0)};return s?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading transactions..."})]})}):a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-end mb-6",children:a.jsxs("button",{onClick:x,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",value:o,onChange:C=>c(C.target.value),placeholder:"Search by ID, order ID, or hash...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status Filter"}),a.jsxs("select",{value:l,onChange:C=>d(C.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"PENDING",children:"Pending"}),a.jsx("option",{value:"COMPLETED",children:"Completed"}),a.jsx("option",{value:"FAILED",children:"Failed"}),a.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Type Filter"}),a.jsxs("select",{value:u,onChange:C=>h(C.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"DEPOSIT",children:"Deposit"}),a.jsx("option",{value:"WITHDRAWAL",children:"Withdrawal"}),a.jsx("option",{value:"TRANSFER",children:"Transfer"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",n.length," of ",t.length," transactions"]})})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Transaction ID"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order ID"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((C,S)=>a.jsxs(X.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:S*.05},className:"hover:bg-white/5 transition-colors",children:[a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",C.id]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",C.order_id]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[E(C.transaction_type),a.jsx("span",{className:"text-white",children:C.transaction_type})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:[C.amount," ",C.token]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b(C.status)}`,children:[v(C.status),a.jsx("span",{className:"ml-1",children:C.status})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(C.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a.jsx("button",{onClick:()=>k(C),className:"text-blue-400 hover:text-blue-300 transition-colors",children:a.jsx(dg,{size:16})})})]},C.id))})]})})}),m&&f&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:a.jsxs(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:"Transaction Details"}),a.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(xr,{size:24})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Transaction ID"}),a.jsxs("p",{className:"text-white font-mono",children:["#",f.id]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order ID"}),a.jsxs("p",{className:"text-white font-mono",children:["#",f.order_id]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Type"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[E(f.transaction_type),a.jsx("span",{className:"text-white",children:f.transaction_type})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b(f.status)}`,children:[v(f.status),a.jsx("span",{className:"ml-1",children:f.status})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Amount"}),a.jsxs("p",{className:"text-white",children:[f.amount," ",f.token]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Price (INR)"}),a.jsxs("p",{className:"text-white",children:["",f.price_inr]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Created At"}),a.jsx("p",{className:"text-white",children:new Date(f.created_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Updated At"}),a.jsx("p",{className:"text-white",children:new Date(f.updated_at).toLocaleString()})]})]}),f.tx_hash&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Transaction Hash"}),a.jsx("p",{className:"text-white font-mono text-sm break-all",children:f.tx_hash})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order State"}),a.jsx("p",{className:"text-white",children:f.order_state})]})]})]})})]})},DIe=()=>{const{address:t,isConnected:e,chainId:n,switchToNetwork:r,connectMetaMask:s,connectTrustWallet:i}=Xt(),[o,c]=A.useState([]),[l,d]=A.useState([]),[u,h]=A.useState(!0),[f,p]=A.useState(""),[m,g]=A.useState("all"),[y,x]=A.useState(null),[w,b]=A.useState(!1),[v,E]=A.useState(!1),[k,C]=A.useState({type:null,appealId:"",reason:""}),[S,N]=A.useState(!1),[I,F]=A.useState(null),[P,H]=A.useState(null),[z,T]=A.useState(!1),_=async(q,ue=3,Ae=1e3)=>{let tt;for(let me=0;me<ue;me++)try{return await Promise.race([q(),new Promise((je,pe)=>setTimeout(()=>pe(new Error("RPC call timeout after 10 seconds")),1e4))])}catch(je){if(tt=je,me<ue-1){const pe=Ae*Math.pow(2,me);await new Promise(ot=>setTimeout(ot,pe));continue}throw je}throw tt},L=ds();A.useEffect(()=>{O()},[]),A.useEffect(()=>{M()},[o,f,m]);const O=async()=>{try{const q=localStorage.getItem("adminToken");if(!q){L("/admin/login");return}const ue=await fetch("/api/admin/appeals",{headers:{Authorization:`Bearer ${q}`}});if(ue.ok){const Ae=await ue.json();c(Ae.data)}else ue.status===401?(localStorage.removeItem("adminToken"),L("/admin/login")):U.error("Failed to load appeals")}catch(q){console.error("Error fetching appeals:",q),U.error("Failed to load appeals")}finally{h(!1)}},M=()=>{let q=o;f&&(q=q.filter(ue=>ue.id.toString().toLowerCase().includes(f.toLowerCase())||ue.order_id.toString().toLowerCase().includes(f.toLowerCase())||ue.appellant_address.toLowerCase().includes(f.toLowerCase())||ue.description.toLowerCase().includes(f.toLowerCase()))),m!=="all"&&(q=q.filter(ue=>ue.dispute_status===m)),d(q)},B=q=>{switch(q){case"PENDING":return"text-yellow-400 bg-yellow-500/10";case"UNDER_REVIEW":return"text-blue-400 bg-blue-500/10";case"RESOLVED":return"text-green-400 bg-green-500/10";case"CLOSED":return"text-gray-400 bg-gray-500/10";default:return"text-gray-400 bg-gray-500/10"}},W=q=>{switch(q){case"PENDING":return a.jsx(Pr,{size:16});case"UNDER_REVIEW":return a.jsx(Xd,{size:16});case"RESOLVED":return a.jsx(kt,{size:16});case"CLOSED":return a.jsx(xr,{size:16});default:return a.jsx(Pr,{size:16})}},Z=async q=>{var ue;if(!window.ethereum)return console.warn("Wallet not available for status check"),null;try{T(!0);const Ae=new Dr(window.ethereum),tt=new rr(On,vi,Ae),me=((ue=q==null?void 0:q.order)==null?void 0:ue.blockchain_trade_id)??(q==null?void 0:q.blockchain_trade_id)??(q==null?void 0:q.order_id),je=Number(me);if(!je||Number.isNaN(je)||je<=0)return console.warn("Invalid trade ID for status check"),null;const pe=await _(()=>tt.trades(je),2,1e3),ot=Number(pe.status);return H({tradeId:je,status:ot}),ot}catch(Ae){return console.error("Error fetching blockchain status:",Ae),null}finally{T(!1)}},ie=async q=>{x(q),b(!0),H(null),window.ethereum&&await Z(q)},ae=async()=>{try{N(!1),await i(),n!==Di&&await r(Di),U.success("Trust Wallet connected successfully!")}catch(q){console.error("Trust Wallet connection error:",q),U.error(q.message||"Failed to connect Trust Wallet")}},oe=async()=>{try{N(!1),await s(),n!==Di&&await r(Di),U.success("MetaMask connected successfully!")}catch(q){console.error("MetaMask connection error:",q),U.error(q.message||"Failed to connect MetaMask")}},Ne=async()=>{try{N(!1);const[{createAppKit:q},{EthersAdapter:ue}]=await Promise.all([$n(()=>Promise.resolve().then(()=>ySe),void 0),$n(()=>Promise.resolve().then(()=>wSe),void 0)]),Ae=window.REOWN_PROJECT_ID||void 0;if(!Ae){U.error("Missing Reown projectId (set VITE_REOWN_PROJECT_ID)");return}const tt=new ue;await q({projectId:Ae,adapters:[tt],features:{analytics:!1},networks:[{id:56,name:"BSC Mainnet"}]}).open(),n!==Di&&await r(Di),U.success("Connected with Reown")}catch(q){console.error("Reown connection error:",q),String((q==null?void 0:q.message)||"").includes("@reown")?U.error("Reown packages not installed. Run: npm i @reown/appkit @reown/appkit-adapter-ethers"):U.error((q==null?void 0:q.message)||"Failed to connect with Reown")}},de=async(q,ue,Ae)=>{var tt,me,je;try{E(!0);const pe={CREATED:0,LOCKED:1,APPEAL_WINDOW_OPEN:2,UNDER_DISPUTE:3,RELEASED:4,REFUNDED:5,COMPLETED:6};if(!e||!t){U.error("Please connect your wallet first"),E(!1);return}n!==Di&&(U.loading("Switching to BSC Mainnet...",{id:"resolve-chain"}),await r(Di),U.success("Switched to BSC Mainnet",{id:"switch-network"}));const ot=o.find(ei=>String(ei.id)===String(q));if(!ot){U.error("Appeal not found"),E(!1);return}const Tn=((tt=ot==null?void 0:ot.order)==null?void 0:tt.blockchain_trade_id)??(ot==null?void 0:ot.blockchain_trade_id)??(ot==null?void 0:ot.order_id),nt=Number(Tn);if(!nt||Number.isNaN(nt)||nt<=0){U.error("Invalid Blockchain Trade ID"),E(!1);return}if(!window.ethereum){U.error("Wallet not available"),E(!1);return}U.loading("Connecting to contract...",{id:"resolve-chain"});const mn=new Dr(window.ethereum),Ve=await mn.getSigner(),rt=await mn.getNetwork();if(Number(rt.chainId)!==Di)throw new Error(`Wrong network! Expected BSC Mainnet (56), got chain ${rt.chainId}`);const ht=new rr(On,vi,Ve),pt=(await Ve.getAddress()).toLowerCase(),jn=(await _(()=>ht.admin(),2,1e3)).toLowerCase();if(pt!==jn)throw new Error("You are not the contract admin");U.loading("Checking trade status...",{id:"resolve-chain"});const so=await _(()=>ht.trades(nt),2,1e3);let Gt=Number(so.status);if(Gt===pe.RELEASED||Gt===pe.COMPLETED){await _e(q,"TRANSFER_TO_BUYER",Ae||"Trade already released"),U.success(" Appeal marked as resolved (funds already released)",{id:"resolve-chain"}),O(),b(!1),C({type:null,appealId:"",reason:""}),E(!1);return}if(Gt===pe.REFUNDED){await _e(q,"REFUND_TO_SELLER",Ae||"Trade already refunded"),U.success(" Appeal marked as resolved (funds already refunded)",{id:"resolve-chain"}),O(),b(!1),C({type:null,appealId:"",reason:""}),E(!1);return}if(Gt!==pe.UNDER_DISPUTE){if(U.loading(`Current status: ${Gt}. Moving to UNDER_DISPUTE...`,{id:"resolve-chain"}),Gt===pe.LOCKED){U.loading("Step 1/2: Opening appeal window...",{id:"resolve-chain"});try{let ei;try{ei=await ht.autoOpenAppealWindow(nt)}catch(qr){if((me=qr.message)!=null&&me.includes("autoOpenAppealWindow"))ei=await ht.openAppealWindow(nt);else throw qr}const Su=await ei.wait();console.log(" Appeal window opened, tx:",Su.hash);const ka=await _(()=>ht.trades(nt),3,1e3);if(Gt=Number(ka.status),Gt===pe.APPEAL_WINDOW_OPEN)U.success("Step 1/2: Appeal window opened",{id:"resolve-chain"});else if(Gt===pe.UNDER_DISPUTE)U.success("Trade is already in UNDER_DISPUTE",{id:"resolve-chain"});else throw new Error(`Unexpected status after opening appeal window: ${Gt}`)}catch(ei){const Su=await _(()=>ht.trades(nt),2,1e3),ka=Number(Su.status);if(ka===pe.APPEAL_WINDOW_OPEN||ka===pe.UNDER_DISPUTE)Gt=ka,console.log("Appeal window already open or in dispute, continuing...");else throw new Error(`Failed to open appeal window: ${ei.message||ei.reason||"Unknown error"}`)}}if(Gt===pe.APPEAL_WINDOW_OPEN)U.loading("Attempting admin resolution from APPEAL_WINDOW_OPEN status...",{id:"resolve-chain"}),console.log(" Trade is in APPEAL_WINDOW_OPEN. Admin will attempt direct resolution.");else if(Gt===pe.LOCKED)throw new Error(`Trade is still LOCKED. Admin cannot file appeals (only participants can). Please wait for appeal window to open automatically, or ask buyer/seller to file an appeal first. Current status: ${Gt}`)}if(Gt===pe.UNDER_DISPUTE)U.loading(" Trade is in UNDER_DISPUTE. Proceeding with resolution...",{id:"resolve-chain"});else if(Gt===pe.APPEAL_WINDOW_OPEN)U.loading(" Trade is in APPEAL_WINDOW_OPEN. Attempting admin resolution...",{id:"resolve-chain"}),console.log(" Admin attempting resolution from APPEAL_WINDOW_OPEN status (contract may or may not allow this)");else throw new Error(`Cannot resolve appeal. Trade status is ${Gt}. Admin can only resolve from UNDER_DISPUTE (3) or APPEAL_WINDOW_OPEN (2). If status is LOCKED (1), please wait for appeal window to open or ask participant to file appeal.`);U.loading("Estimating gas...",{id:"resolve-chain"});let or;try{or=await ht.adminDecision.estimateGas(nt,ue),or=or*BigInt(110)/BigInt(100)}catch{or=BigInt(3e5)}U.loading(ue?"Releasing funds to buyer...":"Refunding to seller...",{id:"resolve-chain"});const jc=await mn.getFeeData(),Rc=jc.gasPrice||jc.maxFeePerGas||am("3","gwei"),Ll=await ht.adminDecision(nt,ue,{gasLimit:or,gasPrice:Rc});U.loading("Waiting for confirmation...",{id:"resolve-chain"}),await Ll.wait();const Xs=ue?" Funds released to buyer":" Funds refunded to seller";U.success(Xs,{id:"resolve-chain",duration:5e3}),await _e(q,ue?"TRANSFER_TO_BUYER":"REFUND_TO_SELLER",Ae),U.success(" Appeal resolved successfully"),y&&await Z(y),O(),b(!1),C({type:null,appealId:"",reason:""})}catch(pe){if(console.error(" Error resolving appeal:",pe),U.dismiss("resolve-chain"),F(null),pe.code==="ACTION_REJECTED"||(je=pe.message)!=null&&je.includes("User rejected"))U.error("Transaction rejected by user");else if(pe.code==="CALL_EXCEPTION"||pe.reason){const ot=pe.reason||pe.message||"Unknown contract error";ot.includes("Not participant")?U.error("Admin cannot file appeals. Please ask buyer or seller to file an appeal first, or wait for the trade to be in UNDER_DISPUTE status.",{duration:8e3}):ot.includes("Invalid state")||ot.includes("status")?U.error(`Contract error: ${ot}. The trade may need to be in UNDER_DISPUTE status. Please ask a participant to file an appeal first.`,{duration:8e3}):U.error(`Contract error: ${ot}`,{duration:6e3})}else U.error(pe.message||"Failed to resolve appeal")}finally{E(!1),setTimeout(()=>{F(null)},1e4)}},_e=async(q,ue,Ae)=>{var pe;const tt=localStorage.getItem("adminToken"),me=await fetch(`/api/admin/appeals/${q}/resolve`,{method:"POST",headers:{Authorization:`Bearer ${tt}`,"Content-Type":"application/json"},body:JSON.stringify({resolution:ue,resolution_reason:Ae})});if(!me.ok){const ot=await me.json();throw new Error(ot.error||"Failed to update backend")}const je=await me.json();if(je.success&&((pe=je.data)!=null&&pe.orderId))try{console.log(" Syncing blockchain status for order:",je.data.orderId);const ot=await fetch(`/api/admin/orders/${je.data.orderId}/sync-blockchain-status`,{method:"POST",headers:{Authorization:`Bearer ${tt}`,"Content-Type":"application/json"}});if(ot.ok){const Tn=await ot.json();console.log(" Blockchain status synced:",Tn)}else console.warn(" Failed to sync blockchain status, but resolution succeeded")}catch(ot){console.warn(" Error syncing blockchain status:",ot)}return me},Ue=async(q,ue)=>{var Ae;if(C({type:ue?"buyer":"seller",appealId:q,reason:""}),F(null),e&&window.ethereum)try{const tt=new Dr(window.ethereum),me=await tt.getNetwork();if(Number(me.chainId)===Di){const je=await tt.getSigner(),pe=new rr(On,vi,je),ot=o.find(Tn=>String(Tn.id)===String(q));if(ot){const Tn=((Ae=ot==null?void 0:ot.order)==null?void 0:Ae.blockchain_trade_id)??(ot==null?void 0:ot.blockchain_trade_id)??(ot==null?void 0:ot.order_id),nt=Number(Tn);if(nt&&!Number.isNaN(nt)&&nt>0)try{const Ve=await pe.adminDecision.estimateGas(nt,ue)*BigInt(110)/BigInt(100),rt=await tt.getFeeData();let ht=rt.gasPrice;!ht&&rt.maxFeePerGas&&(ht=rt.maxFeePerGas),ht||(ht=am("3","gwei"));const pt=Ve*ht,jn=gc(pt);F(jn),console.log(" Pre-estimated gas fee:",jn,"BNB")}catch(mn){console.warn("Could not pre-estimate gas fee:",mn),F(null)}}}}catch(tt){console.warn("Could not estimate gas fee:",tt),F(null)}},ee=()=>{if(!k.reason.trim()){U.error("Please provide a reason for this resolution");return}de(k.appealId,k.type==="buyer",k.reason)};return u?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading appeals..."})]})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("div",{children:e?a.jsxs("div",{className:"flex items-center space-x-2 text-white",children:[a.jsx(kt,{size:16,className:"text-green-400"}),a.jsxs("span",{className:"text-sm font-mono",children:[t==null?void 0:t.slice(0,6),"...",t==null?void 0:t.slice(-4)]}),n!==Di&&a.jsx("button",{onClick:()=>r(Di),className:"text-xs bg-yellow-600 hover:bg-yellow-700 px-2 py-1 rounded",children:"Switch to BSC Mainnet"})]}):a.jsxs(X.button,{onClick:()=>N(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white px-6 py-3 rounded-lg transition-all flex items-center space-x-2 shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white text-sm font-bold",children:""})}),a.jsx("span",{className:"font-medium",children:"Connect Wallet"})]})}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsxs("button",{onClick:O,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]})})]}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",value:f,onChange:q=>p(q.target.value),placeholder:"Search by appeal ID, order ID, address, or description...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status Filter"}),a.jsxs("select",{value:m,onChange:q=>g(q.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"PENDING",children:"Pending"}),a.jsx("option",{value:"UNDER_REVIEW",children:"Under Review"}),a.jsx("option",{value:"RESOLVED",children:"Resolved"}),a.jsx("option",{value:"CLOSED",children:"Closed"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",l.length," of ",o.length," appeals"]})})]})}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Appeal ID"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order ID"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Appellant"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:l.map((q,ue)=>a.jsxs(X.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ue*.05},className:"hover:bg-white/5 transition-colors",children:[a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",q.id]}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",q.order_id]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:q.dispute_type}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(q.dispute_status)}`,children:[W(q.dispute_status),a.jsx("span",{className:"ml-1",children:q.dispute_status})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:[q.appellant_address.slice(0,10),"..."]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(q.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a.jsx("button",{onClick:()=>ie(q),className:"text-blue-400 hover:text-blue-300 transition-colors",children:a.jsx(dg,{size:16})})})]},q.id))})]})}),a.jsx("div",{className:"md:hidden p-4 space-y-4",children:l.map((q,ue)=>a.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ue*.05},className:"bg-white/5 rounded-lg p-4 border border-white/10 hover:bg-white/10 transition-colors",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Appeal ID"}),a.jsxs("div",{className:"text-white font-mono font-semibold",children:["#",q.id]})]}),a.jsx("button",{onClick:()=>ie(q),className:"text-blue-400 hover:text-blue-300 transition-colors p-2",children:a.jsx(dg,{size:20})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Order ID"}),a.jsxs("div",{className:"text-white font-mono text-sm",children:["#",q.order_id]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Type"}),a.jsx("div",{className:"text-white text-sm",children:q.dispute_type})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Status"}),a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(q.dispute_status)}`,children:[W(q.dispute_status),a.jsx("span",{className:"ml-1",children:q.dispute_status})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Appellant"}),a.jsx("div",{className:"text-white font-mono text-sm break-all",children:q.appellant_address})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Created"}),a.jsx("div",{className:"text-gray-300 text-sm",children:new Date(q.created_at).toLocaleDateString()})]})]},q.id))})]}),w&&y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 overflow-y-auto",onClick:q=>{q.target===q.currentTarget&&b(!1)},children:a.jsx(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},onClick:q=>q.stopPropagation(),className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-5xl my-8",style:{maxHeight:"calc(100vh - 4rem)"},children:a.jsxs("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 8rem)"},children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:"Appeal Details"}),a.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(xr,{size:24})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Appeal Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appeal ID"}),a.jsxs("p",{className:"text-white font-mono",children:["#",y.id]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Dispute ID"}),a.jsxs("p",{className:"text-white font-mono",children:["#",y.dispute_id]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Dispute Type"}),a.jsx("p",{className:"text-white",children:y.dispute_type})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Status"}),a.jsx("div",{className:"mt-1",children:a.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(y.dispute_status)}`,children:[W(y.dispute_status),a.jsx("span",{className:"ml-1",children:y.dispute_status})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appellant Address"}),a.jsx("p",{className:"text-white font-mono text-sm break-all",children:y.appellant_address})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appellant Type"}),a.jsx("p",{className:"text-white",children:y.appellant_type})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Description"}),a.jsx("p",{className:"text-white bg-white/5 p-3 rounded-lg mt-1",children:y.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appeal Created At"}),a.jsx("p",{className:"text-white",children:new Date(y.created_at).toLocaleString()})]})]})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Order Details"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order ID"}),a.jsxs("p",{className:"text-white font-mono",children:["#",y.order_id]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Amount"}),a.jsxs("p",{className:"text-white font-semibold",children:[y.amount," ",y.token]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Token"}),a.jsx("p",{className:"text-white",children:y.token})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order Created At"}),a.jsx("p",{className:"text-white",children:new Date(y.order_created_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Lock Expires At"}),a.jsx("p",{className:"text-white",children:new Date(y.lock_expires_at).toLocaleString()})]})]})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Buyer Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Buyer Name"}),a.jsx("p",{className:"text-white",children:y.buyer_name||"Not Available"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Buyer Address"}),a.jsx("p",{className:"text-white font-mono text-sm break-all",children:y.buyer_address})]})]})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Seller Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Seller Name"}),a.jsx("p",{className:"text-white",children:y.seller_name||"Not Available"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Seller Address"}),a.jsx("p",{className:"text-white font-mono text-sm break-all",children:y.seller_address})]})]})]}),y.evidence_video_url&&a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Video Evidence"}),a.jsx("div",{className:"mt-2",children:a.jsxs("video",{controls:!0,className:"w-full rounded-lg bg-black",preload:"metadata",playsInline:!0,style:{maxHeight:"400px"},children:[a.jsx("source",{src:`/uploads/${y.evidence_video_url}`,type:"video/webm"}),a.jsx("source",{src:`/uploads/${y.evidence_video_url}`,type:"video/mp4"}),"Your browser does not support the video tag."]})})]}),(y.evidence_screenshots||y.evidence_documents)&&a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Additional Evidence"}),y.evidence_screenshots&&y.evidence_screenshots.length>0&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"text-sm font-medium text-gray-300 mb-2 block",children:"Screenshots"}),a.jsxs("div",{className:"text-gray-400 text-sm",children:[y.evidence_screenshots.length," screenshot(s) uploaded"]})]}),y.evidence_documents&&y.evidence_documents.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-gray-300 mb-2 block",children:"Documents"}),a.jsxs("div",{className:"text-gray-400 text-sm",children:[y.evidence_documents.length," document(s) uploaded"]})]})]}),z&&!P&&a.jsx("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-blue-300 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-blue-300 text-sm",children:"Checking blockchain status..."})]})}),P&&a.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-blue-300 mb-1 block",children:" Blockchain Status"}),a.jsxs("p",{className:"text-white font-semibold",children:[P.status===0&&"CREATED",P.status===1&&"LOCKED",P.status===2&&"APPEAL_WINDOW_OPEN",P.status===3&&"UNDER_DISPUTE ",P.status===4&&"RELEASED",P.status===5&&"REFUNDED",P.status===6&&"COMPLETED",P.status>6&&`Unknown (${P.status})`]})]}),a.jsx("button",{onClick:()=>y&&Z(y),disabled:z,className:"text-blue-300 hover:text-blue-200 text-sm disabled:opacity-50 flex items-center space-x-1",children:z?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-3 h-3 border-2 border-blue-300 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{children:"Checking..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Refresh"})]})})]}),a.jsxs("p",{className:"text-xs text-blue-400 mt-2",children:["Trade ID: ",P.tradeId," | Status Code: ",P.status]})]}),!z&&!P&&window.ethereum&&a.jsxs("div",{className:"bg-gray-500/20 border border-gray-500/30 rounded-lg p-3 mb-4",children:[a.jsx("p",{className:"text-gray-300 text-sm",children:" Could not fetch blockchain status. Click refresh to try again."}),a.jsx("button",{onClick:()=>y&&Z(y),className:"text-blue-300 hover:text-blue-200 text-xs mt-2",children:" Retry"})]}),P&&P.status!==4&&P.status!==5&&P.status!==6||!P?a.jsxs("div",{className:"pt-4 border-t border-white/20",children:[a.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Resolve Dispute"}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 mb-4 border border-white/10",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-400",children:"Amount"}),a.jsxs("p",{className:"text-white font-semibold",children:[y.amount," ",y.token]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-400",children:"Trade ID"}),a.jsx("p",{className:"text-white font-mono text-sm",children:y.blockchain_trade_id||y.order_id||"N/A"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-400",children:"Buyer Address"}),a.jsx("p",{className:"text-white font-mono text-xs break-all",children:y.buyer_address})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-400",children:"Seller Address"}),a.jsx("p",{className:"text-white font-mono text-xs break-all",children:y.seller_address})]})]})]}),P&&P.status!==3&&a.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4",children:[a.jsxs("p",{className:"text-yellow-200 text-sm",children:[" Current blockchain status: ",P.status===1?"LOCKED":P.status===2?"APPEAL_WINDOW_OPEN":`Status ${P.status}`]}),a.jsx("p",{className:"text-yellow-300 text-xs mt-1",children:P.status===1?a.jsx(a.Fragment,{children:"Admin cannot file appeals. Please wait for appeal window to open automatically, or ask buyer/seller to file an appeal first."}):P.status===2?a.jsx(a.Fragment,{children:"Admin will attempt resolution from APPEAL_WINDOW_OPEN. If this fails, a participant must file an appeal first to move to UNDER_DISPUTE."}):a.jsx(a.Fragment,{children:"Admin will attempt to resolve. If status is not UNDER_DISPUTE, a participant may need to file an appeal first."})})]}),!e&&a.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4",children:a.jsx("p",{className:"text-yellow-200 text-sm",children:" Please connect your wallet to resolve disputes on-chain"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(X.button,{onClick:()=>Ue(y.id,!0),disabled:v||!e,className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-4 rounded-lg transition-all flex items-center justify-center space-x-3 font-medium",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsx(kt,{size:20}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-semibold",children:"Release Full Amount"}),a.jsx("div",{className:"text-xs text-green-100",children:"Transfer to Buyer"})]})]}),a.jsxs(X.button,{onClick:()=>Ue(y.id,!1),disabled:v||!e,className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-4 rounded-lg transition-all flex items-center justify-center space-x-3 font-medium",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsx(xr,{size:20}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-semibold",children:"Refund Full Amount"}),a.jsx("div",{className:"text-xs text-orange-100",children:"Return to Seller"})]})]})]})]}):null]})]})})}),k.type&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 overflow-y-auto",onClick:q=>{q.target===q.currentTarget&&!v&&C({type:null,appealId:"",reason:""})},children:a.jsx(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},onClick:q=>q.stopPropagation(),className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-md my-8",style:{maxHeight:"calc(100vh - 4rem)"},children:a.jsxs("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 8rem)"},children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:k.type==="buyer"?"Release Funds to Buyer":"Refund Funds to Seller"}),a.jsx("button",{onClick:()=>C({type:null,appealId:"",reason:""}),className:"text-gray-400 hover:text-white transition-colors",disabled:v,children:a.jsx(xr,{size:24})})]}),a.jsxs("div",{className:"space-y-4",children:[y&&a.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs text-gray-400",children:["Amount to ",k.type==="buyer"?"Release":"Refund"]}),a.jsxs("p",{className:"text-white font-semibold text-lg",children:[y.amount," ",y.token]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs text-gray-400",children:[k.type==="buyer"?"Buyer":"Seller"," Address"]}),a.jsx("p",{className:"text-white font-mono text-sm break-all",children:k.type==="buyer"?y.buyer_address:y.seller_address})]})]})}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Resolution Reason ",a.jsx("span",{className:"text-red-400",children:"*"})]}),a.jsx("textarea",{value:k.reason,onChange:q=>C({...k,reason:q.target.value}),rows:4,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the reason for this resolution...",disabled:v})]}),I&&a.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-blue-300 mb-1",children:"Estimated Network Fee"}),a.jsxs("p",{className:"text-lg font-bold text-blue-100",children:[I," BNB"]})]}),a.jsx("div",{className:"text-2xl",children:""})]}),a.jsx("p",{className:"text-xs text-blue-400 mt-2",children:"This fee will be deducted from your wallet balance"})]}),a.jsxs("div",{className:`rounded-lg p-3 ${k.type==="buyer"?"bg-green-500/20 border border-green-500/30":"bg-orange-500/20 border border-orange-500/30"}`,children:[a.jsxs("p",{className:`text-sm ${k.type==="buyer"?"text-green-200":"text-orange-200"}`,children:[" This action will transfer ",a.jsxs("strong",{children:[y==null?void 0:y.amount," ",y==null?void 0:y.token]})," on-chain. This cannot be undone."]}),a.jsxs("p",{className:`text-xs mt-1 ${k.type==="buyer"?"text-green-300":"text-orange-300"}`,children:["Note: 1% seller extra (",y?(parseFloat(y.amount)*.01).toFixed(6):"0"," ",y==null?void 0:y.token,") will remain in contract due to contract limitation."]})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>C({type:null,appealId:"",reason:""}),disabled:v,className:"flex-1 bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),a.jsx(X.button,{onClick:ee,disabled:v||!k.reason.trim(),className:`flex-1 px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium ${k.type==="buyer"?"bg-green-600 hover:bg-green-700 text-white":"bg-orange-600 hover:bg-orange-700 text-white"}`,whileTap:{scale:.98},children:v?"Processing...":"Confirm & Execute"})]})]})]})})}),S&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>N(!1),children:a.jsxs(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},onClick:q=>q.stopPropagation(),className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 max-w-md w-full",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:"Choose Wallet"}),a.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(xr,{size:24})})]}),a.jsx("p",{className:"text-gray-300 mb-6 text-sm",children:"Select a wallet to connect and resolve appeals on-chain"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(X.button,{onClick:Ne,className:"w-full bg-purple-600 hover:bg-purple-700 text-white px-6 py-4 rounded-lg transition-all flex items-center justify-between shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-purple-600 text-lg font-bold",children:"R"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-semibold text-lg",children:"Reown"}),a.jsx("div",{className:"text-sm text-purple-100",children:"Connect via Reown (WalletConnect)"})]})]}),a.jsx("div",{className:"text-purple-200",children:""})]}),a.jsxs(X.button,{onClick:ae,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-4 rounded-lg transition-all flex items-center justify-between shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-blue-600 text-lg font-bold",children:"T"})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-semibold text-lg",children:"Trust Wallet"}),a.jsx("div",{className:"text-sm text-blue-100",children:"Connect via Trust Wallet"})]})]}),a.jsx("div",{className:"text-blue-200",children:""})]}),a.jsxs(X.button,{onClick:oe,className:"w-full bg-orange-600 hover:bg-orange-700 text-white px-6 py-4 rounded-lg transition-all flex items-center justify-between shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-orange-600 text-lg font-bold",children:""})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-semibold text-lg",children:"MetaMask"}),a.jsx("div",{className:"text-sm text-orange-100",children:"Connect via MetaMask"})]})]}),a.jsx("div",{className:"text-orange-200",children:""})]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:a.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Make sure you have the wallet extension installed and unlocked"})})]})})]})},UIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState([]),[o,c]=A.useState(!0),[l,d]=A.useState(""),[u,h]=A.useState(!1),[f,p]=A.useState(null),[m,g]=A.useState(""),[y,x]=A.useState(!1),[w,b]=A.useState({branch_name:"",mobile:"",address:"",location_id:"",verified:!1}),v=ds();A.useEffect(()=>{E(),k()},[]),A.useEffect(()=>{C()},[t,l]),A.useEffect(()=>{const z=T=>{const _=T.target;y&&!_.closest(".location-search-container")&&x(!1)};return document.addEventListener("mousedown",z),()=>document.removeEventListener("mousedown",z)},[y]);const E=async()=>{try{const z=localStorage.getItem("adminToken");if(!z){v("/admin/login");return}const T=await fetch("/api/admin/agents",{headers:{Authorization:`Bearer ${z}`}});if(T.ok){const _=await T.json();e(_.data)}else T.status===401?(localStorage.removeItem("adminToken"),v("/admin/login")):U.error("Failed to load agents")}catch(z){console.error("Error fetching agents:",z),U.error("Failed to load agents")}finally{c(!1)}},k=async()=>{try{const z=localStorage.getItem("adminToken");if(!z)return;const T=await fetch("/api/admin/locations",{headers:{Authorization:`Bearer ${z}`}});if(T.ok){const _=await T.json();r(_.data)}}catch(z){console.error("Error fetching locations:",z)}},C=()=>{let z=t;l&&(z=z.filter(T=>T.branch_name.toLowerCase().includes(l.toLowerCase())||T.mobile.toLowerCase().includes(l.toLowerCase())||T.city.toLowerCase().includes(l.toLowerCase())||T.location_name.toLowerCase().includes(l.toLowerCase()))),i(z)},S=()=>{p(null),b({branch_name:"",mobile:"",address:"",location_id:"",verified:!1}),g(""),h(!0)},N=z=>{p(z),b({branch_name:z.branch_name,mobile:z.mobile,address:z.address,location_id:z.location_id.toString(),verified:z.verified});const T=n.find(_=>_.id===z.location_id);g((T==null?void 0:T.name)||""),h(!0)},I=n.filter(z=>{var T,_,L;return((T=z.name)==null?void 0:T.toLowerCase().includes(m.toLowerCase()))||((_=z.city)==null?void 0:_.toLowerCase().includes(m.toLowerCase()))||((L=z.state)==null?void 0:L.toLowerCase().includes(m.toLowerCase()))}),F=(z,T)=>{b({...w,location_id:z.toString()}),g(T),x(!1)},P=async z=>{z.preventDefault();try{const T=localStorage.getItem("adminToken"),_=f?`/api/admin/agents/${f.id}`:"/api/admin/agents",O=await fetch(_,{method:f?"PUT":"POST",headers:{Authorization:`Bearer ${T}`,"Content-Type":"application/json"},body:JSON.stringify(w)});if(O.ok)U.success(f?"Agent updated successfully":"Agent added successfully"),E(),h(!1);else{const M=await O.json();U.error(M.error||"Failed to save agent")}}catch(T){console.error("Error saving agent:",T),U.error("Failed to save agent")}},H=async z=>{if(confirm("Are you sure you want to delete this agent?"))try{const T=localStorage.getItem("adminToken"),_=await fetch(`/api/admin/agents/${z}`,{method:"DELETE",headers:{Authorization:`Bearer ${T}`}});if(_.ok)U.success("Agent deleted successfully"),E();else{const L=await _.json();U.error(L.error||"Failed to delete agent")}}catch(T){console.error("Error deleting agent:",T),U.error("Failed to delete agent")}};return o?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading agents..."})]})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-end space-x-3 mb-6",children:[a.jsxs("button",{onClick:E,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]}),a.jsxs("button",{onClick:S,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Wx,{size:16}),a.jsx("span",{children:"Add Agent"})]})]}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",value:l,onChange:z=>d(z.target.value),placeholder:"Search agents by branch name, mobile, city, or location...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Agent Details"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Contact"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Location"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:s.map((z,T)=>a.jsxs(X.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:T*.05},className:"hover:bg-white/5 transition-colors duration-200",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:a.jsx(wl,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-white",children:z.branch_name}),a.jsx("div",{className:"text-sm text-gray-400",children:z.city})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-300",children:[a.jsx(dn,{size:14}),a.jsx("span",{children:z.mobile})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm text-gray-300",children:[a.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[a.jsx(df,{size:14}),a.jsx("span",{className:"font-medium",children:z.location_name})]}),a.jsx("div",{className:"text-xs text-gray-400 max-w-xs truncate",title:z.address,children:z.address})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${z.verified?"bg-green-500/10 text-green-400":"bg-yellow-500/10 text-yellow-400"}`,children:z.verified?"Verified":"Pending"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400",children:new Date(z.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsxs("button",{onClick:()=>N(z),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[a.jsx(IC,{size:12}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>H(z.id.toString()),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[a.jsx(jC,{size:12}),a.jsx("span",{children:"Delete"})]})]})})]},z.id))})]})}),s.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(wl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400 text-lg",children:"No agents found"}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:l?"Try adjusting your search terms":"Add your first agent to get started"})]})]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:a.jsxs(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:f?"Edit Agent":"Add New Agent"}),a.jsx("button",{onClick:()=>{h(!1),x(!1),g("")},className:"text-gray-400 hover:text-white transition-colors text-3xl leading-none",children:""})]}),a.jsxs("form",{onSubmit:P,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Branch Name"}),a.jsx("input",{type:"text",value:w.branch_name,onChange:z=>b({...w,branch_name:z.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Branch name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mobile"}),a.jsx("input",{type:"tel",value:w.mobile,onChange:z=>b({...w,mobile:z.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+91 9876543210"})]}),a.jsxs("div",{className:"relative location-search-container",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:m,onChange:z=>{g(z.target.value),x(!0)},onFocus:()=>x(!0),required:!0,className:"w-full px-4 py-2 pr-10 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search location...",autoComplete:"off"}),a.jsx(Ac,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",size:16})]}),y&&I.length>0&&a.jsx("div",{className:"absolute z-50 w-full mt-1 max-h-48 overflow-y-auto bg-slate-800 border border-white/30 rounded-lg shadow-2xl",children:I.map(z=>a.jsxs("button",{type:"button",onClick:()=>F(z.id,z.name),className:`w-full text-left px-4 py-3 hover:bg-white/10 transition-colors border-b border-white/5 last:border-b-0 ${w.location_id===z.id.toString()?"bg-white/10":""}`,children:[a.jsx("p",{className:"text-white font-medium text-sm",children:z.name}),a.jsxs("p",{className:"text-gray-400 text-xs",children:[z.city,z.state?`, ${z.state}`:""]})]},z.id))}),y&&m&&I.length===0&&a.jsx("div",{className:"absolute z-50 w-full mt-1 bg-slate-800 border border-white/30 rounded-lg shadow-2xl p-4",children:a.jsxs("p",{className:"text-gray-400 text-sm text-center",children:['No locations found for "',m,'"']})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Address"}),a.jsx("textarea",{value:w.address,onChange:z=>b({...w,address:z.target.value}),required:!0,rows:3,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Full address"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"verified",checked:w.verified,onChange:z=>b({...w,verified:z.target.checked}),className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500"}),a.jsx("label",{htmlFor:"verified",className:"text-sm text-gray-300",children:"Verified"})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{h(!1),x(!1),g("")},className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[f?"Update":"Add"," Agent"]})]})]})]})})]})},MIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,c]=A.useState(""),[l,d]=A.useState(!1),[u,h]=A.useState(null),[f,p]=A.useState({name:"",city:"",state:"",country:"",active:!0});A.useEffect(()=>{m()},[]),A.useEffect(()=>{g()},[t,o]);const m=async()=>{try{const v=localStorage.getItem("adminToken");if(!v){window.location.href="/admin/login";return}const E=await fetch("/api/admin/locations",{headers:{Authorization:`Bearer ${v}`}});if(E.ok){const k=await E.json();e(k.data)}else E.status===401?(localStorage.removeItem("adminToken"),window.location.href="/admin/login"):U.error("Failed to load locations")}catch(v){console.error("Error fetching locations:",v),U.error("Failed to load locations")}finally{i(!1)}},g=()=>{let v=t;o&&(v=v.filter(E=>E.name.toLowerCase().includes(o.toLowerCase())||E.city.toLowerCase().includes(o.toLowerCase())||E.state.toLowerCase().includes(o.toLowerCase())||E.country.toLowerCase().includes(o.toLowerCase()))),r(v)},y=()=>{h(null),p({name:"",city:"",state:"",country:"",active:!0}),d(!0)},x=v=>{h(v),p({name:v.name,city:v.city,state:v.state,country:v.country,active:v.active}),d(!0)},w=async v=>{v.preventDefault();try{const E=localStorage.getItem("adminToken"),k=u?`/api/admin/locations/${u.id}`:"/api/admin/locations",S=await fetch(k,{method:u?"PUT":"POST",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify(f)});if(S.ok)U.success(u?"Location updated successfully":"Location added successfully"),m(),d(!1);else{const N=await S.json();U.error(N.error||"Failed to save location")}}catch(E){console.error("Error saving location:",E),U.error("Failed to save location")}},b=async v=>{if(confirm("Are you sure you want to delete this location?"))try{const E=localStorage.getItem("adminToken"),k=await fetch(`/api/admin/locations/${v}`,{method:"DELETE",headers:{Authorization:`Bearer ${E}`}});if(k.ok)U.success("Location deleted successfully"),m();else{const C=await k.json();U.error(C.error||"Failed to delete location")}}catch(E){console.error("Error deleting location:",E),U.error("Failed to delete location")}};return s?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading locations..."})]})}):a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:m,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]}),a.jsxs("button",{onClick:y,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Wx,{size:16}),a.jsx("span",{children:"Add Location"})]})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",value:o,onChange:v=>c(v.target.value),placeholder:"Search locations by name, city, state, or country...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Location"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"City"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"State"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Country"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Agents"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((v,E)=>a.jsxs(X.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"hover:bg-white/5 transition-colors",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center mr-3",children:a.jsx(YY,{className:"w-5 h-5 text-white"})}),a.jsx("div",{children:a.jsx("div",{className:"text-sm font-medium text-white",children:v.name})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:v.city}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:v.state}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:v.country}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:"bg-blue-500/10 text-blue-400 px-2 py-1 rounded-full text-xs",children:[v.agent_count," total"]}),a.jsxs("span",{className:"bg-green-500/10 text-green-400 px-2 py-1 rounded-full text-xs",children:[v.verified_agents," verified"]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v.active?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:v.active?"Active":"Inactive"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(v.created_at).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:()=>x(v),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[a.jsx(IC,{size:12}),a.jsx("span",{children:"Edit"})]}),a.jsxs("button",{onClick:()=>b(v.id.toString()),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[a.jsx(jC,{size:12}),a.jsx("span",{children:"Delete"})]})]})})]},v.id))})]})})}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:a.jsxs(X.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:u?"Edit Location":"Add New Location"}),a.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-white transition-colors",children:""})]}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name"}),a.jsx("input",{type:"text",value:f.name,onChange:v=>p({...f,name:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Location name"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"City"}),a.jsx("input",{type:"text",value:f.city,onChange:v=>p({...f,city:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"City"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"State"}),a.jsx("input",{type:"text",value:f.state,onChange:v=>p({...f,state:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"State"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Country"}),a.jsx("input",{type:"text",value:f.country,onChange:v=>p({...f,country:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Country"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"active",checked:f.active,onChange:v=>p({...f,active:v.target.checked}),className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500"}),a.jsx("label",{htmlFor:"active",className:"text-sm text-gray-300",children:"Active"})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Cancel"}),a.jsxs("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[u?"Update":"Add"," Location"]})]})]})]})})]})},LIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState(!0),[s,i]=A.useState(!1),[o,c]=A.useState(""),[l,d]=A.useState({buyEnabled:!0,sellEnabled:!0,startTime:"09:00",endTime:"18:00"}),[u,h]=A.useState(!1),f=ds();A.useEffect(()=>{g(),p()},[]);const p=async()=>{try{const w=localStorage.getItem("adminToken");if(!w)return;const b=await fetch("/api/admin/trading-hours",{headers:{Authorization:`Bearer ${w}`}});if(b.ok){const v=await b.json();v.success&&v.data&&d(v.data)}}catch(w){console.error("Error fetching trading hours:",w)}},m=async()=>{h(!0);try{const w=localStorage.getItem("adminToken");if(!w){f("/admin/login");return}const b=await fetch("/api/admin/trading-hours",{method:"PUT",headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(b.ok)U.success("Trading hours updated successfully"),p();else{const v=await b.json();U.error(v.error||"Failed to update trading hours")}}catch(w){console.error("Error updating trading hours:",w),U.error("Failed to update trading hours")}finally{h(!1)}},g=async()=>{try{const w=localStorage.getItem("adminToken");if(!w){f("/admin/login");return}const b=await fetch("/api/admin/settings",{headers:{Authorization:`Bearer ${w}`}});if(b.ok){const v=await b.json(),E=Array.isArray(v.data)?v.data:Array.isArray(v)?v:[];e(E);const k=E.find(C=>C.key==="admin_fee_wallet");k&&c(k.value||"")}else b.status===401?(localStorage.removeItem("adminToken"),f("/admin/login")):U.error("Failed to load settings")}catch(w){console.error("Error fetching settings:",w),U.error("Failed to load settings")}finally{r(!1)}},y=async()=>{if(!o.trim()){U.error("Please enter a valid wallet address");return}i(!0);try{const w=localStorage.getItem("adminToken"),b=await fetch("/api/admin/set-fee-wallet",{method:"POST",headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"},body:JSON.stringify({address:o})});if(b.ok)U.success("Fee wallet updated successfully"),g();else{const v=await b.json();U.error(v.error||"Failed to update fee wallet")}}catch(w){console.error("Error updating fee wallet:",w),U.error("Failed to update fee wallet")}finally{i(!1)}},x=w=>({admin_fee_wallet:"Wallet address where admin fees are collected",buyer_fee_percent:"Percentage fee charged to buyers (as decimal, e.g., 0.01 for 1%)",seller_fee_percent:"Percentage fee charged to sellers (as decimal, e.g., 0.01 for 1%)",accept_timeout_minutes:"Time in minutes for order acceptance timeout",lock_duration_hours:"Duration in hours for fund lock period"})[w]||"Application setting";return n?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading settings..."})]})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:a.jsx(q2,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-white",children:"App Settings"}),a.jsx("p",{className:"text-gray-400",children:"Manage application configuration"})]})]}),a.jsxs("button",{onClick:g,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]})]}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx(Pr,{className:"w-6 h-6 text-yellow-400"}),a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Trading Hours Configuration"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"text-sm font-medium text-white",children:"BUY Trading"}),a.jsx("button",{onClick:()=>d({...l,buyEnabled:!l.buyEnabled}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${l.buyEnabled?"bg-green-500":"bg-gray-600"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l.buyEnabled?"translate-x-6":"translate-x-1"}`})})]}),a.jsx("p",{className:"text-xs text-gray-400",children:l.buyEnabled?"BUY trading is enabled":"BUY trading is disabled"})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"text-sm font-medium text-white",children:"SELL Trading"}),a.jsx("button",{onClick:()=>d({...l,sellEnabled:!l.sellEnabled}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${l.sellEnabled?"bg-green-500":"bg-gray-600"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l.sellEnabled?"translate-x-6":"translate-x-1"}`})})]}),a.jsx("p",{className:"text-xs text-gray-400",children:l.sellEnabled?"SELL trading is enabled":"SELL trading is disabled"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Time (IST)"}),a.jsx("input",{type:"time",value:l.startTime,onChange:w=>d({...l,startTime:w.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-yellow-500"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Trading start time in 24-hour format"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Time (IST)"}),a.jsx("input",{type:"time",value:l.endTime,onChange:w=>d({...l,endTime:w.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-yellow-500"}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Trading end time in 24-hour format"})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{onClick:m,disabled:u,className:"bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[u?a.jsx(Ji,{size:16,className:"animate-spin"}):a.jsx(c3,{size:16}),a.jsx("span",{children:u?"Saving...":"Save Trading Hours"})]})}),a.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:a.jsxs("p",{className:"text-sm text-blue-300",children:[a.jsx("strong",{children:"Current Status:"})," Trading is ",l.buyEnabled&&l.sellEnabled?"enabled":"partially enabled"," from ",l.startTime," to ",l.endTime," IST"]})})]})]}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx(RC,{className:"w-6 h-6 text-blue-400"}),a.jsx("h2",{className:"text-xl font-semibold text-white",children:"Fee Wallet Configuration"})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Admin Fee Wallet Address"}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("input",{type:"text",value:o,onChange:w=>c(w.target.value),placeholder:"0x...",className:"flex-1 px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsxs("button",{onClick:y,disabled:s,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[s?a.jsx(Ji,{size:16,className:"animate-spin"}):a.jsx(c3,{size:16}),a.jsx("span",{children:s?"Saving...":"Save"})]})]}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:x("admin_fee_wallet")})]})})]}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[a.jsx("div",{className:"px-6 py-4 border-b border-white/10",children:a.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center space-x-2",children:[a.jsx(uf,{className:"w-6 h-6 text-green-400"}),a.jsx("span",{children:"Application Settings"})]})}),a.jsx("div",{className:"divide-y divide-white/10",children:Array.isArray(t)&&t.map((w,b)=>a.jsx(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:b*.05},className:"px-6 py-4 hover:bg-white/5 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("h3",{className:"text-sm font-medium text-white capitalize",children:w.key.replace(/_/g," ")}),w.key==="admin_fee_wallet"&&a.jsx("span",{className:"px-2 py-1 bg-blue-500/10 text-blue-400 text-xs rounded-full",children:"Editable"})]}),a.jsx("p",{className:"text-sm text-gray-400 mb-2",children:x(w.key)}),a.jsx("div",{className:"bg-white/5 rounded-lg p-3",children:a.jsx("code",{className:"text-sm text-gray-300 break-all",children:w.value||"Not set"})})]}),a.jsx("div",{className:"ml-4 flex items-center space-x-2",children:w.key==="admin_fee_wallet"?a.jsxs("div",{className:"flex items-center space-x-1 text-green-400",children:[a.jsx(ko,{size:14}),a.jsx("span",{className:"text-xs",children:"Fee Collection"})]}):w.key.includes("fee")?a.jsxs("div",{className:"flex items-center space-x-1 text-yellow-400",children:[a.jsx(ko,{size:14}),a.jsx("span",{className:"text-xs",children:"Fee Rate"})]}):w.key.includes("timeout")||w.key.includes("duration")?a.jsxs("div",{className:"flex items-center space-x-1 text-blue-400",children:[a.jsx(Pr,{size:14}),a.jsx("span",{className:"text-xs",children:"Timing"})]}):a.jsxs("div",{className:"flex items-center space-x-1 text-gray-400",children:[a.jsx(q2,{size:14}),a.jsx("span",{className:"text-xs",children:"Config"})]})})]})},w.key))}),t.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(qt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400 text-lg",children:"No settings found"}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Settings will appear here once they are configured"})]})]})]})},BIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,c]=A.useState(""),[l,d]=A.useState("all"),[u,h]=A.useState(!1),[f,p]=A.useState(null),[m,g]=A.useState({reviewer_address:"",reviewee_address:"",reviewer_name:"",reviewee_name:"",rating:5,comment:"",is_visible:!0,is_approved:!1,order_id:null}),[y,x]=A.useState(!1),w=ds();A.useEffect(()=>{b()},[]),A.useEffect(()=>{v()},[t,o,l]);const b=async()=>{try{const P=localStorage.getItem("adminToken");if(!P){w("/admin/login");return}const H=await fetch("/api/admin/reviews",{headers:{Authorization:`Bearer ${P}`}});if(H.ok){const z=await H.json();e(z.data)}else H.status===401?(localStorage.removeItem("adminToken"),w("/admin/login")):U.error("Failed to load reviews")}catch(P){console.error("Error fetching reviews:",P),U.error("Failed to load reviews")}finally{i(!1)}},v=()=>{let P=t;l==="pending"?P=P.filter(H=>!H.is_approved):l==="approved"?P=P.filter(H=>H.is_approved):l==="hidden"&&(P=P.filter(H=>!H.is_visible)),o&&(P=P.filter(H=>{var z,T,_;return((z=H.reviewer_name)==null?void 0:z.toLowerCase().includes(o.toLowerCase()))||((T=H.reviewee_name)==null?void 0:T.toLowerCase().includes(o.toLowerCase()))||((_=H.message||H.comment||"")==null?void 0:_.toLowerCase().includes(o.toLowerCase()))||H.reviewer_address.toLowerCase().includes(o.toLowerCase())||H.reviewee_address.toLowerCase().includes(o.toLowerCase())})),r(P)},E=async P=>{try{const H=localStorage.getItem("adminToken"),z=await fetch(`/api/admin/reviews/${P}/approve`,{method:"POST",headers:{Authorization:`Bearer ${H}`}});if(z.ok)U.success("Review approved successfully"),b();else{const T=await z.json();U.error(T.error||"Failed to approve review")}}catch(H){console.error("Error approving review:",H),U.error("Failed to approve review")}},k=async P=>{try{const H=localStorage.getItem("adminToken"),z=await fetch(`/api/admin/reviews/${P}/toggle-visibility`,{method:"POST",headers:{Authorization:`Bearer ${H}`}});if(z.ok){const T=await z.json();U.success(T.message),b()}else{const T=await z.json();U.error(T.error||"Failed to toggle visibility")}}catch(H){console.error("Error toggling visibility:",H),U.error("Failed to toggle visibility")}},C=async P=>{if(confirm("Are you sure you want to delete this review?"))try{const H=localStorage.getItem("adminToken"),z=await fetch(`/api/admin/reviews/${P}`,{method:"DELETE",headers:{Authorization:`Bearer ${H}`}});if(z.ok)U.success("Review deleted successfully"),b();else{const T=await z.json();U.error(T.error||"Failed to delete review")}}catch(H){console.error("Error deleting review:",H),U.error("Failed to delete review")}},S=P=>{p(P),g({reviewer_address:P.reviewer_address,reviewee_address:P.reviewee_address,reviewer_name:P.reviewer_name||"",reviewee_name:P.reviewee_name||"",rating:P.rating,comment:P.comment||P.message||"",is_visible:P.is_visible,is_approved:P.is_approved,order_id:P.order_id}),h(!0)},N=async()=>{if(f){x(!0);try{const P=localStorage.getItem("adminToken"),H=await fetch(`/api/admin/reviews/${f.id}`,{method:"PUT",headers:{Authorization:`Bearer ${P}`,"Content-Type":"application/json"},body:JSON.stringify(m)});if(H.ok){const z=await H.json();U.success(z.message||"Review updated successfully"),h(!1),p(null),b()}else{const z=await H.json();U.error(z.error||"Failed to update review")}}catch(P){console.error("Error updating review:",P),U.error("Failed to update review")}finally{x(!1)}}},I=P=>Array.from({length:5},(H,z)=>a.jsx(xa,{size:16,className:z<P?"text-yellow-400 fill-current":"text-gray-400"},z)),F=P=>P.is_approved?P.is_visible?a.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Approved"}):a.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded-full",children:"Hidden"}):a.jsx("span",{className:"px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full",children:"Pending"});return s?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading reviews..."})]})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:a.jsx(xa,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-white",children:"Reviews Management"}),a.jsx("p",{className:"text-gray-400",children:"Manage user reviews and ratings"})]})]}),a.jsxs("button",{onClick:b,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]})]}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",value:o,onChange:P=>c(P.target.value),placeholder:"Search reviews by user, message, or address...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(bI,{size:16,className:"text-gray-400"}),a.jsxs("select",{value:l,onChange:P=>d(P.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Reviews"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"hidden",children:"Hidden"})]})]})]})}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Review Details"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Rating"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Message"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order Info"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((P,H)=>a.jsxs(X.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:H*.05},className:"hover:bg-white/5 transition-colors duration-200",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:a.jsx(hg,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-white",children:P.reviewer_name||"Unknown User"}),a.jsxs("div",{className:"text-xs text-gray-400",children:[" ",P.reviewee_name||"Unknown User"]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[P.reviewer_address.slice(0,6),"...",P.reviewer_address.slice(-4)]})]})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"flex items-center space-x-1",children:I(P.rating)}),a.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[P.rating,"/5 stars"]})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"text-sm text-gray-300 max-w-xs",children:P.comment||P.message||a.jsx("span",{className:"text-gray-500 italic",children:"No message"})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-300",children:[P.order_id?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"font-medium",children:["Order #",P.order_id]}),P.amount&&P.token&&a.jsxs("div",{className:"text-xs text-gray-400",children:[P.amount," ",P.token]})]}):a.jsx("div",{className:"text-gray-500 italic",children:"No order"}),a.jsx("div",{className:"text-xs text-gray-500",children:new Date(P.created_at).toLocaleDateString()})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:F(P)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsxs("button",{onClick:()=>S(P),className:"bg-purple-600 hover:bg-purple-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",title:"Edit Review",children:[a.jsx(IC,{size:12}),a.jsx("span",{children:"Edit"})]}),!P.is_approved&&a.jsxs("button",{onClick:()=>E(P.id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[a.jsx(X1,{size:12}),a.jsx("span",{children:"Approve"})]}),a.jsxs("button",{onClick:()=>k(P.id),className:`px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1 ${P.is_visible?"bg-orange-600 hover:bg-orange-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[P.is_visible?a.jsx(NB,{size:12}):a.jsx(dg,{size:12}),a.jsx("span",{children:P.is_visible?"Hide":"Show"})]}),a.jsxs("button",{onClick:()=>C(P.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[a.jsx(jC,{size:12}),a.jsx("span",{children:"Delete"})]})]})})]},P.id))})]})}),n.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Zd,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400 text-lg",children:"No reviews found"}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:o||l!=="all"?"Try adjusting your search or filter criteria":"Reviews will appear here once users start leaving feedback"})]})]}),u&&f&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs(X.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-slate-800 rounded-xl border border-white/20 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-white",children:"Edit Review"}),a.jsx("button",{onClick:()=>{h(!1),p(null)},className:"text-gray-400 hover:text-white transition-colors",children:a.jsx(en,{size:24})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reviewer Name"}),a.jsx("input",{type:"text",value:m.reviewer_name,onChange:P=>g({...m,reviewer_name:P.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter reviewer name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reviewer Address"}),a.jsx("input",{type:"text",value:m.reviewer_address,onChange:P=>g({...m,reviewer_address:P.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"0x..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reviewee Name"}),a.jsx("input",{type:"text",value:m.reviewee_name,onChange:P=>g({...m,reviewee_name:P.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter reviewee name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reviewee Address"}),a.jsx("input",{type:"text",value:m.reviewee_address,onChange:P=>g({...m,reviewee_address:P.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"0x..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rating (1-5)"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"number",min:"1",max:"5",value:m.rating,onChange:P=>g({...m,rating:parseInt(P.target.value)||5}),className:"w-20 px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"}),a.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:5},(P,H)=>a.jsx(xa,{size:20,className:H<m.rating?"text-yellow-400 fill-current":"text-gray-400",onClick:()=>g({...m,rating:H+1}),style:{cursor:"pointer"}},H))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Comment"}),a.jsx("textarea",{value:m.comment,onChange:P=>g({...m,comment:P.target.value}),rows:4,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none",placeholder:"Review comment..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Order ID (optional)"}),a.jsx("input",{type:"number",value:m.order_id||"",onChange:P=>g({...m,order_id:P.target.value?parseInt(P.target.value):null}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Order ID"})]}),a.jsxs("div",{className:"flex flex-col space-y-3",children:[a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.is_visible,onChange:P=>g({...m,is_visible:P.target.checked}),className:"w-5 h-5 rounded bg-white/10 border-white/20 text-purple-600 focus:ring-purple-500"}),a.jsx("span",{className:"text-gray-300",children:"Visible"})]}),a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:m.is_approved,onChange:P=>g({...m,is_approved:P.target.checked}),className:"w-5 h-5 rounded bg-white/10 border-white/20 text-purple-600 focus:ring-purple-500"}),a.jsx("span",{className:"text-gray-300",children:"Approved"})]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[a.jsx("button",{onClick:()=>{h(!1),p(null)},className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors",disabled:y,children:"Cancel"}),a.jsx("button",{onClick:N,disabled:y,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:y?a.jsxs(a.Fragment,{children:[a.jsx(Ji,{size:16,className:"animate-spin"}),a.jsx("span",{children:"Updating..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(X1,{size:16}),a.jsx("span",{children:"Update Review"})]})})]})]})})]})},$Ie=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,c]=A.useState(""),[l,d]=A.useState("all"),[u,h]=A.useState("all"),[f,p]=A.useState({total:0,limit:200,offset:0,hasMore:!1}),m=ds();A.useEffect(()=>{g()},[f.offset,l,u]),A.useEffect(()=>{y()},[t,o]);const g=async()=>{try{const E=localStorage.getItem("adminToken");if(!E){m("/admin/login");return}const k=l==="all"?void 0:l==="verified"?"true":"false",C=u==="all"?void 0:u==="blocked"?"true":"false",S=new URLSearchParams({limit:f.limit.toString(),offset:f.offset.toString()});o&&S.append("search",o),k&&S.append("verified",k),C&&S.append("blocked",C);const N=await fetch(`/api/admin/users?${S}`,{headers:{Authorization:`Bearer ${E}`}});if(N.ok){const I=await N.json();e(I.data),p(I.pagination)}else N.status===401?(localStorage.removeItem("adminToken"),m("/admin/login")):U.error("Failed to load users")}catch(E){console.error("Error fetching users:",E),U.error("Failed to load users")}finally{i(!1)}},y=()=>{let E=t;o&&(E=E.filter(k=>{var C,S,N,I;return((C=k.address)==null?void 0:C.toLowerCase().includes(o.toLowerCase()))||((S=k.name)==null?void 0:S.toLowerCase().includes(o.toLowerCase()))||((N=k.phone)==null?void 0:N.toLowerCase().includes(o.toLowerCase()))||((I=k.city)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))})),r(E)},x=async(E,k)=>{try{const C=localStorage.getItem("adminToken"),S=await fetch(`/api/admin/users/${E}/verify`,{method:"PUT",headers:{Authorization:`Bearer ${C}`,"Content-Type":"application/json"},body:JSON.stringify({verified:k})});if(S.ok){const N=await S.json();U.success(N.message||`User ${k?"verified":"unverified"} successfully`),g()}else{const N=await S.json();U.error(N.error||"Failed to update user")}}catch(C){console.error("Error verifying user:",C),U.error("Failed to update user")}},w=async(E,k)=>{if(!(k&&!confirm("Are you sure you want to block this user? They will not be able to use the platform.")))try{const C=localStorage.getItem("adminToken"),S=k?prompt("Enter reason for blocking (optional):"):null,N=await fetch(`/api/admin/users/${E}/block`,{method:"PUT",headers:{Authorization:`Bearer ${C}`,"Content-Type":"application/json"},body:JSON.stringify({is_blocked:k,blocked_reason:S})});if(N.ok){const I=await N.json();U.success(I.message||`User ${k?"blocked":"unblocked"} successfully`),g()}else{const I=await N.json();U.error(I.error||"Failed to update user")}}catch(C){console.error("Error blocking user:",C),U.error("Failed to update user")}},b=E=>E?`${E.slice(0,6)}...${E.slice(-4)}`:"N/A",v=E=>E?new Date(E).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return s?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-white text-lg",children:"Loading users..."})]})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:a.jsx(wl,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-white",children:"Users Management"}),a.jsx("p",{className:"text-gray-400",children:"Manage and verify platform users"})]})]}),a.jsxs("button",{onClick:g,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[a.jsx(Ji,{size:16}),a.jsx("span",{children:"Refresh"})]})]}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",value:o,onChange:E=>c(E.target.value),placeholder:"Search by address, name, phone, or city...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(bI,{size:16,className:"text-gray-400"}),a.jsxs("select",{value:l,onChange:E=>{d(E.target.value),p(k=>({...k,offset:0}))},className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Users"}),a.jsx("option",{value:"verified",children:"Verified"}),a.jsx("option",{value:"unverified",children:"Unverified"})]}),a.jsxs("select",{value:u,onChange:E=>{h(E.target.value),p(k=>({...k,offset:0}))},className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"blocked",children:"Blocked"}),a.jsx("option",{value:"unblocked",children:"Unblocked"})]})]})]})}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"User Details"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Contact Info"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Location"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Orders"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((E,k)=>a.jsxs(X.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.05},className:"hover:bg-white/5 transition-colors duration-200",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:a.jsx(wl,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-white",children:E.name||"Unknown User"}),a.jsx("div",{className:"text-xs text-gray-400 font-mono",children:b(E.address)})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-300",children:[E.phone?a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(dn,{size:14,className:"text-gray-400"}),a.jsx("span",{children:E.phone})]}):a.jsx("span",{className:"text-gray-500 italic",children:"No phone"}),E.city&&a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:E.city})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:E.location_name?a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-300",children:[a.jsx(df,{size:14,className:"text-gray-400"}),a.jsx("span",{children:E.location_name})]}):a.jsx("span",{className:"text-gray-500 italic text-sm",children:"No location"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-300",children:[a.jsxs("div",{className:"font-medium",children:["Total: ",E.total_orders||"0"]}),a.jsxs("div",{className:"text-xs text-gray-400",children:["Completed: ",E.completed_orders||"0"]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex flex-col space-y-1",children:[E.is_blocked?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-500/20 text-red-400",children:[a.jsx(i3,{size:12,className:"mr-1"}),"Blocked"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500/20 text-green-400",children:[a.jsx(o3,{size:12,className:"mr-1"}),"Active"]}),E.verified?a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-500/20 text-blue-400",children:[a.jsx(K2,{size:12,className:"mr-1"}),"Verified"]}):a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-500/20 text-yellow-400",children:[a.jsx(l3,{size:12,className:"mr-1"}),"Unverified"]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"text-sm text-gray-300",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(JY,{size:14,className:"text-gray-400"}),a.jsx("span",{children:v(E.created_at)})]}),E.verified_at&&a.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Verified: ",v(E.verified_at)]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[E.is_blocked?a.jsxs("button",{onClick:()=>w(E.id,!1),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",title:"Unblock User",children:[a.jsx(o3,{size:12}),a.jsx("span",{children:"Unblock"})]}):a.jsxs("button",{onClick:()=>w(E.id,!0),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",title:"Block User",children:[a.jsx(i3,{size:12}),a.jsx("span",{children:"Block"})]}),E.verified?a.jsxs("button",{onClick:()=>x(E.id,!1),className:"bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",title:"Unverify User",children:[a.jsx(l3,{size:12}),a.jsx("span",{children:"Unverify"})]}):a.jsxs("button",{onClick:()=>x(E.id,!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",title:"Verify User",children:[a.jsx(K2,{size:12}),a.jsx("span",{children:"Verify"})]})]})})]},E.id))})]})}),n.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(wl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400 text-lg",children:"No users found"}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:o||l!=="all"||u!=="all"?"Try adjusting your search or filter criteria":"Users will appear here once they register"})]}),f.total>0&&a.jsxs("div",{className:"px-6 py-4 border-t border-white/10 flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",f.offset+1," to ",Math.min(f.offset+f.limit,f.total)," of ",f.total," users"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>p(E=>({...E,offset:Math.max(0,E.offset-E.limit)})),disabled:f.offset===0,className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white/20 transition-colors",children:"Previous"}),a.jsx("button",{onClick:()=>p(E=>({...E,offset:E.offset+E.limit})),disabled:!f.hasMore,className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-white/20 transition-colors",children:"Next"})]})]})]})]})},FIe=()=>{const[t,e]=A.useState(null),[n,r]=A.useState(null),[s,i]=A.useState(!1),[o,c]=A.useState(!1),[l,d]=A.useState(null),[u,h]=A.useState(null),f=A.useRef(null),p=A.useRef(null);Lx.useEffect(()=>{m()},[]);const m=async()=>{try{const[w,b]=await Promise.all([fetch("/api/videos/info/demo"),fetch("/api/videos/info/appeal")]);if(w.ok){const v=await w.json();d(v.exists?v:null)}if(b.ok){const v=await b.json();h(v.exists?v:null)}}catch(w){console.error("Error fetching video info:",w)}},g=async()=>{if(!t){U.error("Please select a demo video file");return}i(!0);const w=new FormData;w.append("video",t);try{const b=RU(),v=await fetch("/api/videos/upload/demo",{method:"POST",headers:{Authorization:`Bearer ${b}`},body:w}),E=await v.json();v.ok&&E.success?(U.success("Demo video uploaded successfully!"),e(null),f.current&&(f.current.value=""),m()):U.error(E.error||"Failed to upload demo video")}catch(b){console.error("Upload error:",b),U.error(b.message||"Failed to upload demo video")}finally{i(!1)}},y=async()=>{if(!n){U.error("Please select an appeal video file");return}c(!0);const w=new FormData;w.append("video",n);try{const b=RU(),v=await fetch("/api/videos/upload/appeal",{method:"POST",headers:{Authorization:`Bearer ${b}`},body:w}),E=await v.json();v.ok&&E.success?(U.success("Appeal video uploaded successfully!"),r(null),p.current&&(p.current.value=""),m()):U.error(E.error||"Failed to upload appeal video")}catch(b){console.error("Upload error:",b),U.error(b.message||"Failed to upload appeal video")}finally{c(!1)}},x=w=>{if(w===0)return"0 Bytes";const b=1024,v=["Bytes","KB","MB","GB"],E=Math.floor(Math.log(w)/Math.log(b));return Math.round(w/Math.pow(b,E)*100)/100+" "+v[E]};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Video Management"}),a.jsx("p",{className:"text-gray-300",children:"Upload and manage demo and appeal videos"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center",children:a.jsx(fl,{className:"w-6 h-6 text-blue-400"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Demo Video"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Upload platform demonstration video"})]})]}),l&&a.jsx("div",{className:"mb-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(kt,{className:"w-5 h-5 text-green-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-green-300 text-sm font-medium",children:"Video Available"}),a.jsxs("p",{className:"text-gray-400 text-xs",children:[l.filename,"  ",x(l.size)]})]})]}),a.jsx("a",{href:l.streamUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-blue-300 transition-colors",children:a.jsx(a3,{className:"w-4 h-4"})})]})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Demo Video (MP4, WebM, MOV, AVI - Max 500MB)"}),a.jsx("input",{ref:f,type:"file",accept:"video/*",onChange:w=>{var v;const b=(v=w.target.files)==null?void 0:v[0];if(b){if(b.size>500*1024*1024){U.error("File size must be less than 500MB");return}e(b)}},className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-violet-500 file:text-white hover:file:bg-violet-600 cursor-pointer"}),t&&a.jsxs("div",{className:"mt-2 p-3 bg-white/5 rounded-lg flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(fl,{className:"w-4 h-4 text-violet-400"}),a.jsx("span",{className:"text-sm text-gray-300",children:t.name}),a.jsxs("span",{className:"text-xs text-gray-400",children:["(",x(t.size),")"]})]}),a.jsx("button",{onClick:()=>{e(null),f.current&&(f.current.value="")},className:"p-1 hover:bg-red-500/20 rounded text-red-400",children:a.jsx(en,{className:"w-4 h-4"})})]})]}),a.jsx("button",{onClick:g,disabled:!t||s,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:s?a.jsxs(a.Fragment,{children:[a.jsx(sr,{className:"w-5 h-5 animate-spin"}),a.jsx("span",{children:"Uploading..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(d3,{className:"w-5 h-5"}),a.jsx("span",{children:"Upload Demo Video"})]})}),a.jsx("p",{className:"mt-3 text-xs text-gray-400",children:"Note: Only one demo video can be stored at a time. Uploading a new video will replace the existing one."})]}),a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:a.jsx(fl,{className:"w-6 h-6 text-purple-400"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Appeal Video"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Upload dispute appeal guide video"})]})]}),u&&a.jsx("div",{className:"mb-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(kt,{className:"w-5 h-5 text-green-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-green-300 text-sm font-medium",children:"Video Available"}),a.jsxs("p",{className:"text-gray-400 text-xs",children:[u.filename,"  ",x(u.size)]})]})]}),a.jsx("a",{href:u.streamUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-purple-500/20 hover:bg-purple-500/30 rounded-lg text-purple-300 transition-colors",children:a.jsx(a3,{className:"w-4 h-4"})})]})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Appeal Video (MP4, WebM, MOV, AVI - Max 500MB)"}),a.jsx("input",{ref:p,type:"file",accept:"video/*",onChange:w=>{var v;const b=(v=w.target.files)==null?void 0:v[0];if(b){if(b.size>500*1024*1024){U.error("File size must be less than 500MB");return}r(b)}},className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-violet-500 file:text-white hover:file:bg-violet-600 cursor-pointer"}),n&&a.jsxs("div",{className:"mt-2 p-3 bg-white/5 rounded-lg flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(fl,{className:"w-4 h-4 text-violet-400"}),a.jsx("span",{className:"text-sm text-gray-300",children:n.name}),a.jsxs("span",{className:"text-xs text-gray-400",children:["(",x(n.size),")"]})]}),a.jsx("button",{onClick:()=>{r(null),p.current&&(p.current.value="")},className:"p-1 hover:bg-red-500/20 rounded text-red-400",children:a.jsx(en,{className:"w-4 h-4"})})]})]}),a.jsx("button",{onClick:y,disabled:!n||o,className:"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white py-3 px-4 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:o?a.jsxs(a.Fragment,{children:[a.jsx(sr,{className:"w-5 h-5 animate-spin"}),a.jsx("span",{children:"Uploading..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(d3,{className:"w-5 h-5"}),a.jsx("span",{children:"Upload Appeal Video"})]})}),a.jsx("p",{className:"mt-3 text-xs text-gray-400",children:"Note: Only one appeal video can be stored at a time. Uploading a new video will replace the existing one."})]})]}),a.jsxs(X.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Streaming URLs"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Demo Video Stream URL:"}),a.jsx("code",{className:"block p-3 bg-black/30 rounded-lg text-violet-300 text-sm break-all",children:typeof window<"u"?`${window.location.origin}/api/videos/stream/demo`:"/api/videos/stream/demo"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Appeal Video Stream URL:"}),a.jsx("code",{className:"block p-3 bg-black/30 rounded-lg text-violet-300 text-sm break-all",children:typeof window<"u"?`${window.location.origin}/api/videos/stream/appeal`:"/api/videos/stream/appeal"})]})]})]})]})},zIe=()=>{const[t,e]=A.useState(null),[n,r]=A.useState(!1),[s,i]=A.useState([]),[o,c]=A.useState(null),[l,d]=A.useState(null),u=A.useRef(null);A.useEffect(()=>((()=>{console.log(" AdminSupportCalls: Connecting to socket...");const y=Po(Na,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,timeout:2e4});return y.on("connect",()=>{console.log(" AdminSupportCalls: Connected to socket"),r(!0),y.emit("register","ADMIN_SUPPORT",!0),console.log(" AdminSupportCalls: Registered as admin for support calls")}),y.on("disconnect",()=>{console.log(" AdminSupportCalls: Disconnected from socket"),r(!1)}),y.on("connect_error",x=>{console.error(" AdminSupportCalls: Connection error:",x),r(!1)}),y.on("incoming-call",x=>{if(console.log(" AdminSupportCalls: Incoming support call:",x),!x.callerAddress){console.error(" AdminSupportCalls: Missing callerAddress in incoming call data"),U.error("Invalid call data: missing caller address");return}h(x.callerAddress).then(w=>{const b={id:x.callId||`call-${Date.now()}`,callerAddress:x.callerAddress,callerName:w,timestamp:x.timestamp||Date.now(),status:"incoming"};i(v=>[...v,b]),d({...x,callerAddress:x.callerAddress,callerName:w,isAdminSupportCall:!0}),U(" New support call incoming!",{duration:5e3,position:"top-center"})})}),y.on("call-ended",x=>{console.log(" AdminSupportCalls: Call ended:",x),c(null),i(w=>w.map(b=>b.id===x.callId?{...b,status:"ended"}:b)),U("Call ended",{icon:""})}),y.on("offer",async x=>{console.log(" AdminSupportCalls: Received offer:",x),x.isAdminSupportCall&&o&&(console.log(" AdminSupportCalls: Offer received for active call - will be handled by CallModal"),l&&d(w=>({...w,offer:x.offer})))}),y.on("answer",async x=>{console.log(" AdminSupportCalls: Received answer:",x)}),y.on("ice-candidate",async x=>{console.log(" AdminSupportCalls: Received ICE candidate")}),e(y),u.current=y,()=>{y.disconnect()}})(),()=>{u.current&&u.current.disconnect()}),[]);const h=async g=>{try{const y=await fetch(`/api/auth/user-by-address?address=${g}`);if(y.ok){const x=await y.json();if(x.success&&x.data.name)return x.data.name}}catch(y){console.error("Error fetching caller info:",y)}},f=async()=>{if(l){if(!l.callerAddress){console.error(" AdminSupportCalls: Cannot accept call - missing callerAddress"),U.error("Invalid call data"),d(null);return}try{console.log(" AdminSupportCalls: Accepting call from",l.callerAddress),t&&(t.emit("call-accepted",{callId:l.callId,callerAddress:l.callerAddress}),console.log(" AdminSupportCalls: Call acceptance event sent to backend")),c({id:l.callId||`call-${Date.now()}`,callerAddress:l.callerAddress,callerName:l.callerName,timestamp:l.timestamp||Date.now(),status:"active"}),i(g=>g.map(y=>y.id===l.callId?{...y,status:"active"}:y)),d(null),U.success("Call accepted! Connecting...")}catch(g){console.error("Error accepting call:",g),U.error("Failed to accept call")}}},p=async()=>{if(l)try{t&&t.emit("call-rejected",{callId:l.callId,receiverAddress:"ADMIN_SUPPORT",callerAddress:l.callerAddress}),i(g=>g.map(y=>y.id===l.callId?{...y,status:"ended"}:y)),d(null),U("Call rejected",{icon:""})}catch(g){console.error("Error rejecting call:",g)}},m=()=>{o&&t&&t.emit("end-call",{callId:o.id,to:o.callerAddress}),c(null),U("Call ended",{icon:""})};return a.jsxs("div",{children:[a.jsx("div",{className:"mb-6",children:a.jsxs(X.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`p-4 rounded-lg border flex items-center justify-between ${n?"bg-green-500/20 border-green-500/30":"bg-red-500/20 border-red-500/30"}`,children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${n?"bg-green-400":"bg-red-400"}`}),a.jsxs("div",{children:[a.jsxs("p",{className:`font-medium text-sm ${n?"text-green-300":"text-red-300"}`,children:["Support Call Service: ",n?"Online":"Offline"]}),a.jsx("p",{className:`text-xs ${n?"text-green-400":"text-red-400"}`,children:n?"Ready to receive support calls":"Not connected to call service"})]})]}),!n&&a.jsx(sr,{className:"w-4 h-4 animate-spin text-red-400"})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(dn,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Support Calls"}),a.jsx("p",{className:"text-gray-300 text-sm mb-3",children:"Users can call you for support through the Dashboard. Incoming calls will appear here."}),a.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-400",children:[a.jsx(kt,{size:14,className:"text-green-400"}),a.jsx("span",{children:"Make sure to keep this page open to receive calls"})]})]})]})}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[a.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Recent Support Calls"}),s.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(dn,{size:48,className:"text-gray-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400",children:"No support calls yet"}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Waiting for incoming support calls..."})]}):a.jsx("div",{className:"space-y-3",children:s.map(g=>a.jsx(X.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`p-4 rounded-lg border ${g.status==="active"?"bg-green-500/20 border-green-500/30":g.status==="incoming"?"bg-blue-500/20 border-blue-500/30":"bg-gray-500/20 border-gray-500/30"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsx(dn,{size:16,className:g.status==="active"?"text-green-400":g.status==="incoming"?"text-blue-400":"text-gray-400"}),a.jsx("p",{className:"font-medium text-white",children:g.callerName||"Unknown User"})]}),a.jsx("p",{className:"text-xs text-gray-400 font-mono",children:g.callerAddress?`${g.callerAddress.slice(0,6)}...${g.callerAddress.slice(-4)}`:"Unknown Address"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(g.timestamp).toLocaleString()})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[g.status==="active"&&a.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Active"}),g.status==="incoming"&&a.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full animate-pulse",children:"Incoming"}),g.status==="ended"&&a.jsx("span",{className:"px-2 py-1 bg-gray-500/20 text-gray-400 text-xs rounded-full",children:"Ended"})]})]})},g.id))})]}),l&&a.jsx(bR,{isOpen:!!l,callerAddress:l.callerAddress,callerName:l.callerName,callId:l.callId,onAccept:f,onReject:p,onClose:()=>d(null)}),o&&a.jsx(AN,{isOpen:!!o,ad:null,onClose:m})]})},HIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState(null),[s,i]=A.useState([]),[o,c]=A.useState(""),[l,d]=A.useState(!0),[u,h]=A.useState(!1),[f,p]=A.useState(""),[m,g]=A.useState(0),y=A.useRef(null),x=A.useRef(null),w=A.useRef(null),b=()=>{var N;(N=y.current)==null||N.scrollIntoView({behavior:"smooth"})};A.useEffect(()=>{b()},[s]);const v=async()=>{try{const N=localStorage.getItem("adminToken")||"",I=await fetch("/api/admin/chat/users",{headers:{Authorization:`Bearer ${N}`}});if(I.ok){const P=(await I.json()).data||[];e(P);const H=P.reduce((z,T)=>z+(T.unread_from_user||0),0);g(H)}}catch(N){console.error("Error fetching users:",N)}finally{d(!1)}},E=async N=>{try{const I=localStorage.getItem("adminToken")||"",F=await fetch(`/api/admin/chat/messages/${N}`,{headers:{Authorization:`Bearer ${I}`}});if(F.ok){const P=await F.json();i(P.data||[]),b()}}catch(I){console.error("Error fetching messages:",I)}};A.useEffect(()=>{try{const N=localStorage.getItem("adminToken")||"";if(N){const F=N.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),P=decodeURIComponent(atob(F).split("").map(z=>"%"+("00"+z.charCodeAt(0).toString(16)).slice(-2)).join("")),H=JSON.parse(P);w.current=H.adminId||H.id||1,console.log(" AdminChat: Admin ID from token:",w.current)}}catch(N){console.error("Error decoding admin token:",N),w.current=1}},[]),A.useEffect(()=>{const N=Po(Na,{transports:["websocket","polling"],reconnection:!0});return N.on("connect",()=>{console.log(" AdminChat: Connected to socket")}),N.on("new-chat-message",I=>{console.log(" AdminChat: New message from user:",I),n===I.userAddress&&(i(H=>H.some(T=>T.id===I.message.id)?(console.log(" AdminChat: Message already exists, skipping duplicate"),H):[...H,I.message]),b()),e(H=>{const z=H.map(_=>_.user_address===I.userAddress?{..._,unread_from_user:(_.unread_from_user||0)+1,last_message:I.message.message,last_message_at:I.message.created_at}:_),T=z.reduce((_,L)=>_+(L.unread_from_user||0),0);return g(T),z});const F=t.find(H=>H.user_address===I.userAddress),P=(F==null?void 0:F.user_name)||I.userAddress.slice(0,6)+"..."+I.userAddress.slice(-4);if(n!==I.userAddress){U(H=>a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-white",children:" New Message"}),a.jsxs("p",{className:"text-sm text-gray-200",children:["From: ",a.jsx("span",{className:"font-medium",children:P})]}),a.jsx("p",{className:"text-xs text-gray-300 mt-1 truncate max-w-xs",children:I.message.message.length>50?I.message.message.substring(0,50)+"...":I.message.message})]}),a.jsx("button",{onClick:()=>{r(I.userAddress),U.dismiss(H.id)},className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition-colors",children:"View"})]}),{duration:5e3,icon:"",position:"top-right",style:{background:"#1e293b",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.1)",minWidth:"300px"}});try{const H=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2LwUZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2LwUZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2LwU=");H.volume=.3,H.play().catch(()=>{})}catch{}}}),N.on("admin-chat-message-sent",I=>{console.log(" AdminChat: Admin message sent confirmation:",I),n===I.message.user_address.toLowerCase()&&(i(F=>F.some(H=>H.id===I.message.id)?(console.log(" AdminChat: Message already exists, skipping duplicate"),F):[...F,I.message]),b(),e(F=>{const P=F.map(z=>z.user_address===n?{...z,last_message:I.message.message,last_message_at:I.message.created_at}:z),H=P.reduce((z,T)=>z+(T.unread_from_user||0),0);return g(H),P}))}),N.on("chat-error",I=>{console.error(" AdminChat error:",I),U.error(I.error||"Chat error occurred")}),x.current=N,()=>{N.disconnect()}},[n]),A.useEffect(()=>{v()},[]),A.useEffect(()=>{n&&x.current&&(E(n),x.current.emit("admin-join-chat",n),console.log(" AdminChat: Joined chat room for user:",n))},[n]);const k=async()=>{if(!o.trim()||!n||u)return;if(!w.current){U.error("Admin ID not found. Please refresh the page.");return}h(!0);const N=o.trim();c("");try{if(x.current&&x.current.connected)x.current.emit("admin-chat-message",{message:N,userAddress:n,adminId:w.current});else{const I=localStorage.getItem("adminToken")||"",F=await fetch("/api/admin/chat/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I}`},body:JSON.stringify({user_address:n,message:N})});if(!F.ok){const P=await F.json();U.error(P.error||"Failed to send message"),c(N)}}}catch(I){console.error("Error sending message:",I),U.error("Failed to send message"),c(N)}finally{h(!1)}};A.useEffect(()=>{if(n){const N=localStorage.getItem("adminToken")||"";fetch(`/api/admin/chat/mark-read/${n}`,{method:"POST",headers:{Authorization:`Bearer ${N}`}}).catch(I=>console.error("Error marking as read:",I)),e(I=>I.map(F=>F.user_address===n?{...F,unread_from_user:0}:F))}},[n,s]);const C=t.filter(N=>{var I;return((I=N.user_name)==null?void 0:I.toLowerCase().includes(f.toLowerCase()))||N.user_address.toLowerCase().includes(f.toLowerCase())}),S=t.find(N=>N.user_address===n);return a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-white mb-2 flex items-center space-x-2",children:[a.jsx(Zd,{className:"w-6 h-6"}),a.jsx("span",{children:"Chat Support"}),m>0&&a.jsxs("span",{className:"bg-red-500 text-white text-xs font-bold px-2.5 py-1 rounded-full animate-pulse",children:[m," new"]})]}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Manage user support chats in real-time"})]}),m>0&&a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-3xl font-bold text-red-400",children:m}),a.jsx("p",{className:"text-xs text-gray-400",children:"Unread Messages"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-[calc(100vh-250px)]",children:[a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 flex flex-col",children:[a.jsx("div",{className:"p-4 border-b border-white/20",children:a.jsxs("div",{className:"relative",children:[a.jsx(Ac,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",placeholder:"Search users...",value:f,onChange:N=>p(N.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:l?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx(sr,{className:"w-6 h-6 animate-spin text-white"})}):C.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-400",children:[a.jsx(Zd,{size:32,className:"mx-auto mb-2"}),a.jsx("p",{children:"No users found"})]}):C.map(N=>a.jsxs(X.button,{onClick:()=>r(N.user_address),className:`w-full p-4 text-left border-b border-white/10 hover:bg-white/10 transition-colors ${n===N.user_address?"bg-white/20":""}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[a.jsx("div",{className:"flex items-center justify-between mb-1",children:a.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(hg,{size:18,className:"text-white"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("p",{className:"text-white font-medium text-sm truncate",children:N.user_name||"Anonymous User"}),N.unread_from_user>0&&a.jsxs("span",{className:"bg-green-500 text-white text-xs font-bold px-2 py-0.5 rounded-full whitespace-nowrap flex-shrink-0",children:[N.unread_from_user," ",N.unread_from_user===1?"new message":"new messages"]})]}),a.jsxs("p",{className:"text-gray-400 text-xs font-mono truncate",children:[N.user_address.slice(0,6),"...",N.user_address.slice(-4)]})]})]})}),N.last_message&&a.jsx("p",{className:"text-gray-400 text-xs truncate mt-1",children:N.last_message})]},N.user_address))})]}),a.jsx("div",{className:"lg:col-span-2 bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 flex flex-col",children:n?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-4 rounded-t-xl",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(hg,{size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:(S==null?void 0:S.user_name)||"Anonymous User"}),a.jsxs("p",{className:"text-xs text-blue-100 font-mono",children:[n.slice(0,6),"...",n.slice(-4)]})]})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 max-h-[300px]",children:[s.map(N=>{const I=N.sender_type==="admin";return a.jsx(X.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${I?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-[75%] rounded-lg p-3 ${I?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"}`,children:[!I&&a.jsx("p",{className:"text-xs font-semibold mb-1 text-gray-600",children:N.user_name||"User"}),a.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:N.message}),a.jsx("p",{className:`text-xs mt-1 ${I?"text-blue-100":"text-gray-500"}`,children:new Date(N.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})},N.id)}),a.jsx("div",{ref:y})]}),a.jsx("div",{className:"p-4 border-t border-white/20 bg-white/5",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"text",value:o,onChange:N=>c(N.target.value),onKeyPress:N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),k())},placeholder:"Type your message...",className:"flex-1 px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:u}),a.jsx("button",{onClick:k,disabled:!o.trim()||u,className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?a.jsx(sr,{className:"w-5 h-5 animate-spin"}):a.jsx(SB,{size:20})})]})})]}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Zd,{size:48,className:"mx-auto mb-4"}),a.jsx("p",{children:"Select a user to start chatting"})]})})})]})]})},VIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState(""),[s,i]=A.useState(!0),[o,c]=A.useState(!1),[l,d]=A.useState(0),u=A.useRef(null),h=A.useRef(null),{address:f,isConnected:p}=Xt(),{user:m}=ss(),g=ds(),y=()=>{var v;(v=u.current)==null||v.scrollIntoView({behavior:"smooth"})};A.useEffect(()=>{y()},[t]);const x=async()=>{if(!(!p||!f))try{const v=localStorage.getItem("authToken")||"",E=await fetch("/api/chat/messages",{headers:{Authorization:`Bearer ${v}`}});if(E.ok){const k=await E.json();e(k.data||[])}}catch(v){console.error("Error fetching messages:",v)}finally{i(!1)}},w=async()=>{if(!(!p||!f))try{const v=localStorage.getItem("authToken")||"",E=await fetch("/api/chat/unread-count",{headers:{Authorization:`Bearer ${v}`}});if(E.ok){const k=await E.json();d(k.data.unread_count||0)}}catch(v){console.error("Error fetching unread count:",v)}};A.useEffect(()=>{if(!p||!f){g("/");return}x(),w();const v=Po(Na,{transports:["websocket","polling"],reconnection:!0});return v.on("connect",()=>{console.log(" Chat: Connected to socket"),v.emit("join-chat",f.toLowerCase())}),v.on("new-chat-message",E=>{console.log(" Chat: New message received:",E),e(k=>k.some(S=>S.id===E.message.id)?(console.log(" Chat: Message already exists, skipping duplicate"),k):[...k,E.message]),E.message.sender_type==="admin"&&d(k=>k+1),y()}),v.on("chat-message-sent",E=>{console.log(" Chat: Message sent confirmation:",E),e(k=>k.some(S=>S.id===E.message.id)?(console.log(" Chat: Message already exists, skipping duplicate"),k):[...k,E.message]),y()}),v.on("chat-error",E=>{console.error(" Chat error:",E),U.error(E.error||"Chat error occurred")}),h.current=v,()=>{v.disconnect()}},[p,f,g]);const b=async()=>{if(!n.trim()||!p||!f||o)return;c(!0);const v=n.trim();r("");try{if(h.current&&h.current.connected)h.current.emit("chat-message",{message:v,userAddress:f.toLowerCase()});else{const E=localStorage.getItem("authToken")||"",k=await fetch("/api/chat/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify({message:v})});if(!k.ok){const C=await k.json();U.error(C.error||"Failed to send message"),r(v)}}}catch(E){console.error("Error sending message:",E),U.error("Failed to send message"),r(v)}finally{c(!1)}};return A.useEffect(()=>{if(t.length>0&&p&&f){const v=localStorage.getItem("authToken")||"";fetch("/api/chat/mark-read",{method:"POST",headers:{Authorization:`Bearer ${v}`}}).catch(E=>console.error("Error marking as read:",E)),d(0)}},[t,p,f]),!p||!f?a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-white text-lg mb-4",children:"Please connect your wallet to use chat support"}),a.jsx("button",{onClick:()=>g("/"),className:"bg-violet-600 hover:bg-violet-700 text-white px-6 py-2 rounded-lg",children:"Go to Dashboard"})]})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:a.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-2xl flex flex-col h-[calc(100vh-2rem)]",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-4 rounded-t-xl flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("button",{onClick:()=>g("/"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:a.jsx(HY,{size:20})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-lg font-bold",children:"Chat Support"}),a.jsxs("p",{className:"text-xs text-blue-100",children:[(m==null?void 0:m.name)||"User","  ",f.slice(0,6),"...",f.slice(-4)]})]})]}),l>0&&a.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:[l," new"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:[s?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx(sr,{className:"w-6 h-6 animate-spin text-blue-600"})}):t.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[a.jsx(Zd,{size:48,className:"mb-4"}),a.jsx("p",{className:"text-center",children:"No messages yet. Start a conversation!"})]}):t.map(v=>{const E=v.sender_type==="user";return a.jsx(X.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${E?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-[75%] rounded-lg p-3 ${E?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"}`,children:[!E&&a.jsx("p",{className:"text-xs font-semibold mb-1 text-gray-600",children:v.admin_username||"Admin"}),a.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:v.message}),a.jsx("p",{className:`text-xs mt-1 ${E?"text-blue-100":"text-gray-500"}`,children:new Date(v.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})},v.id)}),a.jsx("div",{ref:u})]}),a.jsx("div",{className:"p-4 border-t border-gray-200 bg-white rounded-b-xl",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"text",value:n,onChange:v=>r(v.target.value),onKeyPress:v=>{v.key==="Enter"&&!v.shiftKey&&(v.preventDefault(),b())},placeholder:"Type your message...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:o}),a.jsx("button",{onClick:b,disabled:!n.trim()||o,className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?a.jsx(sr,{className:"w-5 h-5 animate-spin"}):a.jsx(SB,{size:20})})]})})]})})},WIe=async()=>{console.log(" ===== SMART CONTRACT DEBUGGER ====="),console.log(` Starting comprehensive contract check...
`);try{if(!window.ethereum)return console.error(" Wallet not detected"),console.log(" Please install MetaMask or connect a wallet"),!1;console.log(" Wallet detected");const t=new Dr(window.ethereum),e=await t.getNetwork();console.log(` Network connected: ${e.name} (ChainID: ${e.chainId})`),e.chainId!==56n?(console.warn("  Not on BSC Mainnet! Current chain:",e.chainId),console.log(" Please switch to BSC Mainnet (ChainID: 56)")):console.log(" Connected to BSC Mainnet"),console.log(` Contract Address: ${On}`),On==="0x02ADD84281025BeeB807f5b94Ea947599146ca00"&&console.log(" Using provided contract address"),console.log(` ABI Functions: ${vi.length} functions/events`),console.log(" Available functions:"),vi.forEach((s,i)=>{var o;s.type==="function"&&console.log(`   ${i+1}. ${s.name}(${((o=s.inputs)==null?void 0:o.map(c=>c.type).join(", "))||""})`)}),console.log(`
 Testing contract connection...`);const n=new Eg(Cw),r=new rr(On,vi,n);try{console.log(" Testing contract calls...");try{const s=await r.admin();console.log(` Admin address: ${s}`)}catch(s){console.warn("  Could not fetch admin address:",s)}try{const s=await r.tradeCounter();console.log(` Trade counter: ${s.toString()}`)}catch(s){console.warn("  Could not fetch trade counter:",s)}try{const s=await r.allowedTokens(ph.USDT.address);console.log(` USDT allowed: ${s}`)}catch(s){console.warn("  Could not check USDT allowance:",s)}}catch(s){return console.error(" Contract connection failed:",s),console.log(" Check if contract is deployed and address is correct"),!1}console.log(`
 Checking token addresses...`),Object.entries(ph).forEach(([s,i])=>{console.log(` ${s}: ${i.address}`),i.isNative?console.log(`    ${s} is native token`):console.log(`    ${s} is ERC20 token`)}),console.log(`
 Testing wallet connection...`);try{const i=await(await t.getSigner()).getAddress();console.log(` Wallet address: ${i}`);const o=await t.getBalance(i),c=gc(o);console.log(` BNB balance: ${c} BNB`),parseFloat(c)<.01&&console.warn("  Low BNB balance! Please add more BNB to your wallet")}catch(s){return console.error(" Wallet connection failed:",s),!1}console.log(`
  Testing contract write functions...`);try{const s=await t.getSigner(),i=new rr(On,vi,s);console.log(" Testing createTrade function..."),console.log("    createTrade function available"),console.log("    lockFunds function available"),console.log("    releaseFunds function available"),console.log("    cancelTrade function available")}catch(s){console.error(" Contract write functions test failed:",s)}return console.log(`
 ===== DEBUG SUMMARY =====`),console.log(" Wallet: Connected"),console.log(" Network: BSC Mainnet"),console.log(" Contract: Address configured"),console.log(" ABI: Functions loaded"),console.log(" Tokens: Addresses configured"),console.log(" Connection: Ready for production"),console.log(`
 Ready to use your Zotrust P2P platform!`),console.log(" Next steps:"),console.log("   1. Create an ad"),console.log("   2. Place an order"),console.log("   3. Complete the trade flow"),!0}catch(t){return console.error(" Debug failed:",t),console.log(" Check your wallet connection and network settings"),!1}},qIe=async()=>{console.log(" Quick Contract Check...");try{if(!window.ethereum)return console.error(" No wallet detected"),!1;const e=await new Dr(window.ethereum).getNetwork();return console.log(` Network: ${e.name} (${e.chainId})`),console.log(` Contract: ${On}`),console.log(` ABI Functions: ${vi.length}`),e.chainId===56n?(console.log(" Ready for BSC Mainnet"),!0):(console.log("  Switch to BSC Mainnet (ChainID: 56)"),!1)}catch(t){return console.error(" Quick check failed:",t),!1}},GS=async(t,...e)=>{console.log(` Testing function: ${t}`);try{const r=await new Dr(window.ethereum).getSigner(),i=await new rr(On,vi,r)[t](...e);return console.log(` ${t} result:`,i),i}catch(n){throw console.error(` ${t} failed:`,n),n}},KIe=async()=>{console.log(" ===== CONTRACT VERIFICATION ====="),console.log(` Contract Address: ${On}`);try{if(!window.ethereum)throw new Error("Wallet not connected");const t=new Dr(window.ethereum);console.log(" Checking contract code...");const e=await t.getCode(On);if(e==="0x")return console.error(" No contract code found at this address!"),console.log(" The contract may not be deployed or the address is wrong"),!1;console.log(" Contract code found"),console.log(` Code length: ${e.length} characters`),console.log(" Testing basic contract interaction...");const n=["function admin() view returns (address)","function tradeCounter() view returns (uint256)"],r=new rr(On,n,t);try{const s=await r.admin();console.log(` Admin address: ${s}`)}catch(s){console.warn(" Admin function failed:",s)}try{const s=await r.tradeCounter();console.log(` Trade counter: ${s.toString()}`)}catch(s){console.warn(" Trade counter function failed:",s),console.log(" This suggests the contract ABI may not match the deployed contract")}console.log(" Checking for proxy patterns...");try{const s=await t.getStorage(On,"0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc");s!=="0x0000000000000000000000000000000000000000000000000000000000000000"&&(console.log(" Possible proxy contract detected"),console.log(` Implementation: ${s}`))}catch{}return console.log(" Contract verification complete"),!0}catch(t){return console.error(" Contract verification failed:",t),!1}};typeof window<"u"&&(window.debugContract=WIe,window.quickCheck=qIe,window.testAdmin=()=>GS("admin"),window.testTradeCounter=()=>GS("tradeCounter"),window.testAllowedTokens=t=>GS("allowedTokens",t),window.verifyContract=KIe,window.switchToMainnet=async()=>{const{useZotrustContract:t}=await $n(async()=>{const{useZotrustContract:n}=await import("./useZotrustContract-8-3TCFBj.js");return{useZotrustContract:n}},[]),{switchToMainnet:e}=t();return e()},console.log(" Contract Debugger loaded!"),console.log(" Available commands:"),console.log("   window.debugContract() - Full contract debug"),console.log("   window.quickCheck() - Quick status check"),console.log("   window.verifyContract() - Verify contract deployment"),console.log("   window.testAdmin() - Test admin function"),console.log("   window.testTradeCounter() - Test trade counter"),console.log('   window.testAllowedTokens("0x...") - Test token allowance'),console.log("   window.switchToMainnet() - Switch wallet to BSC Mainnet"));const GIe=()=>a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:a.jsx(hIe,{children:a.jsx(wI,{})})}),YIe=()=>a.jsx(mIe,{children:a.jsx(wI,{})}),QIe=()=>a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:a.jsx(wI,{})}),JIe=IG([{path:"/",element:a.jsx(GIe,{}),children:[{index:!0,element:a.jsx(wIe,{})},{path:"p2p",element:a.jsx(vIe,{})},{path:"orders",element:a.jsx(NIe,{})},{path:"transactions",element:a.jsx(SIe,{})},{path:"profile",element:a.jsx(AIe,{})},{path:"guide",element:a.jsx(OU,{})},{path:"how-to-use",element:a.jsx(OU,{})},{path:"benefits",element:a.jsx(TIe,{})},{path:"chat",element:a.jsx(VIe,{})}]},{path:"/",element:a.jsx(QIe,{}),children:[{path:"orders/appeal/:walletAddress/:orderId",element:a.jsx(Iv,{})},{path:"orders/:orderId/appeal",element:a.jsx(Iv,{})},{path:"appeal/:walletAddress/:orderId",element:a.jsx(Iv,{})},{path:"orders/orders/appeal/:walletAddress/:orderId",element:a.jsx(Iv,{})}]},{path:"support-call/:walletAddress",element:a.jsx(DU,{})},{path:"support-call",element:a.jsx(DU,{})},{path:"call/:orderId/:walletAddress",element:a.jsx(IIe,{})},{path:"/admin",children:[{path:"login",element:a.jsx(jIe,{})},{element:a.jsx(YIe,{}),children:[{index:!0,element:a.jsx(RIe,{})},{path:"orders",element:a.jsx(PIe,{})},{path:"transactions",element:a.jsx(OIe,{})},{path:"disputes",element:a.jsx(DIe,{})},{path:"support-calls",element:a.jsx(zIe,{})},{path:"agents",element:a.jsx(UIe,{})},{path:"locations",element:a.jsx(MIe,{})},{path:"reviews",element:a.jsx(BIe,{})},{path:"users",element:a.jsx($Ie,{})},{path:"videos",element:a.jsx(FIe,{})},{path:"settings",element:a.jsx(LIe,{})},{path:"chat",element:a.jsx(HIe,{})}]}]},{path:"*",element:a.jsx(EG,{to:"/",replace:!0})}]);function ZIe(){return a.jsxs(dIe,{children:[a.jsx(BG,{router:JIe}),a.jsx(RY,{position:"top-center",toastOptions:{duration:3e3,style:{background:"#1e293b",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.1)"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})}const XIe="/assets/logo-BZD251q-.jpeg",eje=({className:t=""})=>a.jsx("img",{src:XIe,alt:"Zotrust Logo",className:`mx-auto w-32 h-32 object-contain ${t}`}),tje=({onComplete:t})=>{const[e,n]=A.useState(!0);return A.useEffect(()=>{const r=setTimeout(()=>{n(!1),setTimeout(()=>{t()},300)},2e3);return()=>clearTimeout(r)},[t]),e?a.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 transition-opacity duration-300 ${e?"opacity-100":"opacity-0"}`,children:a.jsx("div",{className:"flex flex-col items-center space-y-6 animate-pulse",children:a.jsx(eje,{})})}):null};window.addEventListener("error",t=>{if(t.error&&t.error.message&&(t.error.message.includes("IndexedDB")||t.error.message.includes("backing store"))){console.warn("IndexedDB error ignored:",t.error.message),t.preventDefault();return}if(t.error&&t.error.message&&t.error.message.includes("Unexpected end of attribute")){console.warn("SVG attribute error ignored:",t.error.message),t.preventDefault();return}});window.addEventListener("unhandledrejection",t=>{if(t.reason&&t.reason.message&&(t.reason.message.includes("IndexedDB")||t.reason.message.includes("backing store"))){console.warn("IndexedDB promise rejection ignored:",t.reason.message),t.preventDefault();return}if(t.reason&&t.reason.message&&t.reason.message.includes("Unexpected end of attribute")){console.warn("SVG attribute promise rejection ignored:",t.reason.message),t.preventDefault();return}});"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(e=>{e.unregister(),console.log("Service worker unregistered")})});function nje(){const[t,e]=A.useState(!0),n=()=>{e(!1)};return t?a.jsx(tje,{onComplete:n}):a.jsx(ZIe,{})}ZL(document.getElementById("root")).render(a.jsx(nje,{}));export{PAe as $,LRe as A,Di as B,rr as C,BRe as D,Lt as E,x1 as F,PRe as G,oSe as H,bd as I,Eg as J,$o as K,De as L,ne as M,Jre as N,fe as O,Ws as P,yie as Q,ut as R,lc as S,ph as T,_s as U,QI as V,fr as W,Ie as X,Dt as Y,On as Z,DRe as _,_re as a,wE as a$,dF as a0,fi as a1,Cg as a2,ye as a3,ORe as a4,Ki as a5,st as a6,lt as a7,BU as a8,Fo as a9,Sw as aA,Ny as aB,HT as aC,No as aD,Pt as aE,yf as aF,ml as aG,Mg as aH,tc as aI,o1 as aJ,qi as aK,dt as aL,MRe as aM,$O as aN,dje as aO,ise as aP,hse as aQ,ase as aR,sF as aS,rF as aT,Yh as aU,Bz as aV,W_ as aW,$n as aX,Rg as aY,yje as aZ,y1 as a_,Wt as aa,RAe as ab,ks as ac,sse as ad,fse as ae,ZC as af,qI as ag,Mn as ah,FO as ai,mse as aj,zue as ak,fRe as al,z4 as am,m9 as an,Jw as ao,Uue as ap,p9 as aq,Hue as ar,pRe as as,hRe as at,NE as au,gRe as av,mRe as aw,jr as ax,Jt as ay,tse as az,Cw as b,mh as b$,nr as b0,V_ as b1,Cp as b2,xie as b3,jA as b4,pje as b5,dse as b6,KI as b7,xje as b8,yE as b9,GI as bA,Ey as bB,_je as bC,kje as bD,gje as bE,kse as bF,jse as bG,cF as bH,VO as bI,$se as bJ,tv as bK,Jb as bL,gse as bM,nF as bN,cse as bO,lse as bP,zO as bQ,qw as bR,Ww as bS,Vw as bT,Lw as bU,zw as bV,Iw as bW,_w as bX,Ow as bY,Sg as bZ,kw as b_,bje as ba,Ng as bb,iF as bc,YI as bd,xse as be,bse as bf,vse as bg,Ese as bh,Cse as bi,Nse as bj,Ase as bk,Sse as bl,Tse as bm,_se as bn,vje as bo,hje as bp,Ise as bq,Eje as br,aF as bs,jw as bt,Rse as bu,Cje as bv,Tje as bw,Nje as bx,Sje as by,Aje as bz,vi as c,Tw as c0,Mw as c1,ro as c2,Rw as c3,Pw as c4,Ii as c5,Bw as c6,Ag as c7,Dw as c8,Hw as c9,wse as ca,Fw as cb,$w as cc,Uw as cd,Qh as ce,zse as cf,Use as cg,ose as ch,Mse as ci,Y8 as cj,oy as ck,WIe as d,Dr as e,fa as f,Un as g,Rje as h,$ as i,Be as j,jje as k,Pje as l,Ije as m,Vt as n,hF as o,am as p,qIe as q,yt as r,Oje as s,GS as t,Xt as u,ls as v,cs as w,zr as x,URe as y,U as z};
