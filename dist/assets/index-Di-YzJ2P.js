const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-FFVutECM.js","assets/hashTypedData-BS8U9Zwv.js","assets/isAddress-DRfvXvQY.js","assets/isAddressEqual-BLgeRd9U.js","assets/embedded-wallet-CfMbZ0AZ.js","assets/index-6ntcS0td.js","assets/index-CMFwAk7L.js","assets/if-defined-C-fmOZLn.js","assets/ref-CbBMxGT-.js","assets/index-ZZUjrBAb.js","assets/HelpersUtil-CtMuPYyN.js","assets/index-DnCYQYzh.js","assets/index-7Xx8w6vL.js","assets/index-Io-vbr86.js","assets/index-rAjOphCy.js","assets/index-P_PsCxJF.js","assets/NavigationUtil-DmfK5sOV.js","assets/email-CgVU0I2B.js","assets/index-D1VLQqan.js","assets/index-DKSJecXw.js","assets/socials-sd0HdVgU.js","assets/index-BTw1DPsV.js","assets/index-DHfQrtYE.js","assets/index-CUMH5aZO.js","assets/index-DJpsvQoB.js","assets/index-DHfZRBqQ.js","assets/swaps-k-IslVI4.js","assets/index-Hq0H5JjX.js","assets/index-wVGZ0dyd.js","assets/SwapController-DbOLzKVS.js","assets/index-BkBDkHzA.js","assets/send-CTdyFvs8.js","assets/index-JXREXgGg.js","assets/index-CTKT4Bea.js","assets/index-ANtQDAr7.js","assets/index-C177E6sd.js","assets/receive-C-R_bSaO.js","assets/onramp-D8B83kPY.js","assets/index-BtqB0Gsp.js","assets/index-ecMCO-eb.js","assets/index-Cx1j6xMg.js","assets/ExchangeController-CwpYSETL.js","assets/pay-with-exchange-UxwdD9kI.js","assets/transactions-pDRveUta.js","assets/index-CHgkhlaJ.js","assets/index-BJvp_40v.js","assets/index-C6Rg7GXp.js","assets/index-uSuoaIrX.js","assets/index-DTT6VUaG.js","assets/data-capture-C827PCWs.js","assets/features-FtV0ohcQ.js","assets/index-DVnqGUTL.js","assets/index-H2JdSweG.js","assets/w3m-modal-CF38VRb8.js","assets/SafeProvider-IQGJWtuE.js","assets/index-B5g2Fl0J.js","assets/index-CboEqQpE.js"])))=>i.map(i=>d[i]);
var kV=Object.defineProperty;var Cj=t=>{throw TypeError(t)};var IV=(t,e,n)=>e in t?kV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var q=(t,e,n)=>IV(t,typeof e!="symbol"?e+"":e,n),_N=(t,e,n)=>e.has(t)||Cj("Cannot "+n);var k=(t,e,n)=>(_N(t,e,"read from private field"),n?n.call(t):e.get(t)),se=(t,e,n)=>e.has(t)?Cj("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),z=(t,e,n,r)=>(_N(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ne=(t,e,n)=>(_N(t,e,"access private method"),n);var d0=(t,e,n,r)=>({set _(s){z(t,e,s,n)},get _(){return k(t,e,r)}});function PM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var ec=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ug(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function OM(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var DM={exports:{}},oC={},MM={exports:{}},Ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ux=Symbol.for("react.element"),RV=Symbol.for("react.portal"),jV=Symbol.for("react.fragment"),PV=Symbol.for("react.strict_mode"),OV=Symbol.for("react.profiler"),DV=Symbol.for("react.provider"),MV=Symbol.for("react.context"),UV=Symbol.for("react.forward_ref"),LV=Symbol.for("react.suspense"),BV=Symbol.for("react.memo"),$V=Symbol.for("react.lazy"),Nj=Symbol.iterator;function FV(t){return t===null||typeof t!="object"?null:(t=Nj&&t[Nj]||t["@@iterator"],typeof t=="function"?t:null)}var UM={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},LM=Object.assign,BM={};function Lg(t,e,n){this.props=t,this.context=e,this.refs=BM,this.updater=n||UM}Lg.prototype.isReactComponent={};Lg.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Lg.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $M(){}$M.prototype=Lg.prototype;function gk(t,e,n){this.props=t,this.context=e,this.refs=BM,this.updater=n||UM}var yk=gk.prototype=new $M;yk.constructor=gk;LM(yk,Lg.prototype);yk.isPureReactComponent=!0;var Aj=Array.isArray,FM=Object.prototype.hasOwnProperty,wk={current:null},zM={key:!0,ref:!0,__self:!0,__source:!0};function HM(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)FM.call(e,r)&&!zM.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),d=0;d<a;d++)l[d]=arguments[d+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Ux,type:t,key:i,ref:o,props:s,_owner:wk.current}}function zV(t,e){return{$$typeof:Ux,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function xk(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ux}function HV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Sj=/\/+/g;function kN(t,e){return typeof t=="object"&&t!==null&&t.key!=null?HV(""+t.key):e.toString(36)}function Rv(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ux:case RV:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+kN(o,0):r,Aj(s)?(n="",t!=null&&(n=t.replace(Sj,"$&/")+"/"),Rv(s,e,n,"",function(d){return d})):s!=null&&(xk(s)&&(s=zV(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Sj,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Aj(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+kN(i,a);o+=Rv(i,e,n,l,s)}else if(l=FV(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+kN(i,a++),o+=Rv(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function xb(t,e,n){if(t==null)return t;var r=[],s=0;return Rv(t,r,"","",function(i){return e.call(n,i,s++)}),r}function VV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Js={current:null},jv={transition:null},WV={ReactCurrentDispatcher:Js,ReactCurrentBatchConfig:jv,ReactCurrentOwner:wk};function VM(){throw Error("act(...) is not supported in production builds of React.")}Ut.Children={map:xb,forEach:function(t,e,n){xb(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xb(t,function(){e++}),e},toArray:function(t){return xb(t,function(e){return e})||[]},only:function(t){if(!xk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ut.Component=Lg;Ut.Fragment=jV;Ut.Profiler=OV;Ut.PureComponent=gk;Ut.StrictMode=PV;Ut.Suspense=LV;Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WV;Ut.act=VM;Ut.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=LM({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=wk.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)FM.call(e,l)&&!zM.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var d=0;d<l;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Ux,type:t.type,key:s,ref:i,props:r,_owner:o}};Ut.createContext=function(t){return t={$$typeof:MV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:DV,_context:t},t.Consumer=t};Ut.createElement=HM;Ut.createFactory=function(t){var e=HM.bind(null,t);return e.type=t,e};Ut.createRef=function(){return{current:null}};Ut.forwardRef=function(t){return{$$typeof:UV,render:t}};Ut.isValidElement=xk;Ut.lazy=function(t){return{$$typeof:$V,_payload:{_status:-1,_result:t},_init:VV}};Ut.memo=function(t,e){return{$$typeof:BV,type:t,compare:e===void 0?null:e}};Ut.startTransition=function(t){var e=jv.transition;jv.transition={};try{t()}finally{jv.transition=e}};Ut.unstable_act=VM;Ut.useCallback=function(t,e){return Js.current.useCallback(t,e)};Ut.useContext=function(t){return Js.current.useContext(t)};Ut.useDebugValue=function(){};Ut.useDeferredValue=function(t){return Js.current.useDeferredValue(t)};Ut.useEffect=function(t,e){return Js.current.useEffect(t,e)};Ut.useId=function(){return Js.current.useId()};Ut.useImperativeHandle=function(t,e,n){return Js.current.useImperativeHandle(t,e,n)};Ut.useInsertionEffect=function(t,e){return Js.current.useInsertionEffect(t,e)};Ut.useLayoutEffect=function(t,e){return Js.current.useLayoutEffect(t,e)};Ut.useMemo=function(t,e){return Js.current.useMemo(t,e)};Ut.useReducer=function(t,e,n){return Js.current.useReducer(t,e,n)};Ut.useRef=function(t){return Js.current.useRef(t)};Ut.useState=function(t){return Js.current.useState(t)};Ut.useSyncExternalStore=function(t,e,n){return Js.current.useSyncExternalStore(t,e,n)};Ut.useTransition=function(){return Js.current.useTransition()};Ut.version="18.3.1";MM.exports=Ut;var A=MM.exports;const Lx=Ug(A),qV=PM({__proto__:null,default:Lx},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KV=A,GV=Symbol.for("react.element"),YV=Symbol.for("react.fragment"),QV=Object.prototype.hasOwnProperty,JV=KV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZV={key:!0,ref:!0,__self:!0,__source:!0};function WM(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)QV.call(e,r)&&!ZV.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:GV,type:t,key:i,ref:o,props:s,_owner:JV.current}}oC.Fragment=YV;oC.jsx=WM;oC.jsxs=WM;DM.exports=oC;var c=DM.exports,qM={exports:{}},eo={},KM={exports:{}},GM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(P,L){var B=P.length;P.push(L);e:for(;0<B;){var V=B-1>>>1,X=P[V];if(0<s(X,L))P[V]=L,P[B]=X,B=V;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var L=P[0],B=P.pop();if(B!==L){P[0]=B;e:for(var V=0,X=P.length,ae=X>>>1;V<ae;){var ce=2*(V+1)-1,ie=P[ce],Te=ce+1,ue=P[Te];if(0>s(ie,B))Te<X&&0>s(ue,ie)?(P[V]=ue,P[Te]=B,V=Te):(P[V]=ie,P[ce]=B,V=ce);else if(Te<X&&0>s(ue,B))P[V]=ue,P[Te]=B,V=Te;else break e}}return L}function s(P,L){var B=P.sortIndex-L.sortIndex;return B!==0?B:P.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],d=[],u=1,h=null,f=3,p=!1,m=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(P){for(var L=n(d);L!==null;){if(L.callback===null)r(d);else if(L.startTime<=P)r(d),L.sortIndex=L.expirationTime,e(l,L);else break;L=n(d)}}function v(P){if(g=!1,x(P),!m)if(n(l)!==null)m=!0,j(E);else{var L=n(d);L!==null&&F(v,L.startTime-P)}}function E(P,L){m=!1,g&&(g=!1,b(C),C=-1),p=!0;var B=f;try{for(x(L),h=n(l);h!==null&&(!(h.expirationTime>L)||P&&!$());){var V=h.callback;if(typeof V=="function"){h.callback=null,f=h.priorityLevel;var X=V(h.expirationTime<=L);L=t.unstable_now(),typeof X=="function"?h.callback=X:h===n(l)&&r(l),x(L)}else r(l);h=n(l)}if(h!==null)var ae=!0;else{var ce=n(d);ce!==null&&F(v,ce.startTime-L),ae=!1}return ae}finally{h=null,f=B,p=!1}}var R=!1,S=null,C=-1,N=5,T=-1;function $(){return!(t.unstable_now()-T<N)}function U(){if(S!==null){var P=t.unstable_now();T=P;var L=!0;try{L=S(!0,P)}finally{L?H():(R=!1,S=null)}}else R=!1}var H;if(typeof y=="function")H=function(){y(U)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,I=K.port2;K.port1.onmessage=U,H=function(){I.postMessage(null)}}else H=function(){w(U,0)};function j(P){S=P,R||(R=!0,H())}function F(P,L){C=w(function(){P(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,j(E))},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(P){switch(f){case 1:case 2:case 3:var L=3;break;default:L=f}var B=f;f=L;try{return P()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(P,L){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var B=f;f=P;try{return L()}finally{f=B}},t.unstable_scheduleCallback=function(P,L,B){var V=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?V+B:V):B=V,P){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=B+X,P={id:u++,callback:L,priorityLevel:P,startTime:B,expirationTime:X,sortIndex:-1},B>V?(P.sortIndex=B,e(d,P),n(l)===null&&P===n(d)&&(g?(b(C),C=-1):g=!0,F(v,B-V))):(P.sortIndex=X,e(l,P),m||p||(m=!0,j(E))),P},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(P){var L=f;return function(){var B=f;f=L;try{return P.apply(this,arguments)}finally{f=B}}}})(GM);KM.exports=GM;var XV=KM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eW=A,Zi=XV;function Se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YM=new Set,Vy={};function Af(t,e){eg(t,e),eg(t+"Capture",e)}function eg(t,e){for(Vy[t]=e,t=0;t<e.length;t++)YM.add(e[t])}var vl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),KS=Object.prototype.hasOwnProperty,tW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tj={},_j={};function nW(t){return KS.call(_j,t)?!0:KS.call(Tj,t)?!1:tW.test(t)?_j[t]=!0:(Tj[t]=!0,!1)}function rW(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sW(t,e,n,r){if(e===null||typeof e>"u"||rW(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zs(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var as={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){as[t]=new Zs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];as[e]=new Zs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){as[t]=new Zs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){as[t]=new Zs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){as[t]=new Zs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){as[t]=new Zs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){as[t]=new Zs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){as[t]=new Zs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){as[t]=new Zs(t,5,!1,t.toLowerCase(),null,!1,!1)});var bk=/[\-:]([a-z])/g;function vk(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(bk,vk);as[e]=new Zs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(bk,vk);as[e]=new Zs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(bk,vk);as[e]=new Zs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){as[t]=new Zs(t,1,!1,t.toLowerCase(),null,!1,!1)});as.xlinkHref=new Zs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){as[t]=new Zs(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ek(t,e,n,r){var s=as.hasOwnProperty(e)?as[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sW(e,n,s,r)&&(n=null),r||s===null?nW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ol=eW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bb=Symbol.for("react.element"),Np=Symbol.for("react.portal"),Ap=Symbol.for("react.fragment"),Ck=Symbol.for("react.strict_mode"),GS=Symbol.for("react.profiler"),QM=Symbol.for("react.provider"),JM=Symbol.for("react.context"),Nk=Symbol.for("react.forward_ref"),YS=Symbol.for("react.suspense"),QS=Symbol.for("react.suspense_list"),Ak=Symbol.for("react.memo"),od=Symbol.for("react.lazy"),ZM=Symbol.for("react.offscreen"),kj=Symbol.iterator;function u0(t){return t===null||typeof t!="object"?null:(t=kj&&t[kj]||t["@@iterator"],typeof t=="function"?t:null)}var Qn=Object.assign,IN;function G0(t){if(IN===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);IN=e&&e[1]||""}return`
`+IN+t}var RN=!1;function jN(t,e){if(!t||RN)return"";RN=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{RN=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?G0(t):""}function iW(t){switch(t.tag){case 5:return G0(t.type);case 16:return G0("Lazy");case 13:return G0("Suspense");case 19:return G0("SuspenseList");case 0:case 2:case 15:return t=jN(t.type,!1),t;case 11:return t=jN(t.type.render,!1),t;case 1:return t=jN(t.type,!0),t;default:return""}}function JS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ap:return"Fragment";case Np:return"Portal";case GS:return"Profiler";case Ck:return"StrictMode";case YS:return"Suspense";case QS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case JM:return(t.displayName||"Context")+".Consumer";case QM:return(t._context.displayName||"Context")+".Provider";case Nk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ak:return e=t.displayName||null,e!==null?e:JS(t.type)||"Memo";case od:e=t._payload,t=t._init;try{return JS(t(e))}catch{}}return null}function oW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return JS(e);case 8:return e===Ck?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function nu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function XM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function aW(t){var e=XM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vb(t){t._valueTracker||(t._valueTracker=aW(t))}function eU(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=XM(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function A1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ZS(t,e){var n=e.checked;return Qn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ij(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=nu(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tU(t,e){e=e.checked,e!=null&&Ek(t,"checked",e,!1)}function XS(t,e){tU(t,e);var n=nu(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?e2(t,e.type,n):e.hasOwnProperty("defaultValue")&&e2(t,e.type,nu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Rj(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function e2(t,e,n){(e!=="number"||A1(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Y0=Array.isArray;function Qp(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+nu(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function t2(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Se(91));return Qn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function jj(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Se(92));if(Y0(n)){if(1<n.length)throw Error(Se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:nu(n)}}function nU(t,e){var n=nu(e.value),r=nu(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Pj(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rU(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function n2(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rU(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Eb,sU=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Eb=Eb||document.createElement("div"),Eb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Eb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Wy(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cW=["Webkit","ms","Moz","O"];Object.keys(hy).forEach(function(t){cW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hy[e]=hy[t]})});function iU(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hy.hasOwnProperty(t)&&hy[t]?(""+e).trim():e+"px"}function oU(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=iU(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var lW=Qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function r2(t,e){if(e){if(lW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Se(62))}}function s2(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var i2=null;function Sk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var o2=null,Jp=null,Zp=null;function Oj(t){if(t=Fx(t)){if(typeof o2!="function")throw Error(Se(280));var e=t.stateNode;e&&(e=uC(e),o2(t.stateNode,t.type,e))}}function aU(t){Jp?Zp?Zp.push(t):Zp=[t]:Jp=t}function cU(){if(Jp){var t=Jp,e=Zp;if(Zp=Jp=null,Oj(t),e)for(t=0;t<e.length;t++)Oj(e[t])}}function lU(t,e){return t(e)}function dU(){}var PN=!1;function uU(t,e,n){if(PN)return t(e,n);PN=!0;try{return lU(t,e,n)}finally{PN=!1,(Jp!==null||Zp!==null)&&(dU(),cU())}}function qy(t,e){var n=t.stateNode;if(n===null)return null;var r=uC(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Se(231,e,typeof n));return n}var a2=!1;if(vl)try{var h0={};Object.defineProperty(h0,"passive",{get:function(){a2=!0}}),window.addEventListener("test",h0,h0),window.removeEventListener("test",h0,h0)}catch{a2=!1}function dW(t,e,n,r,s,i,o,a,l){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(u){this.onError(u)}}var fy=!1,S1=null,T1=!1,c2=null,uW={onError:function(t){fy=!0,S1=t}};function hW(t,e,n,r,s,i,o,a,l){fy=!1,S1=null,dW.apply(uW,arguments)}function fW(t,e,n,r,s,i,o,a,l){if(hW.apply(this,arguments),fy){if(fy){var d=S1;fy=!1,S1=null}else throw Error(Se(198));T1||(T1=!0,c2=d)}}function Sf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function hU(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Dj(t){if(Sf(t)!==t)throw Error(Se(188))}function pW(t){var e=t.alternate;if(!e){if(e=Sf(t),e===null)throw Error(Se(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Dj(s),t;if(i===r)return Dj(s),e;i=i.sibling}throw Error(Se(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(Se(189))}}if(n.alternate!==r)throw Error(Se(190))}if(n.tag!==3)throw Error(Se(188));return n.stateNode.current===n?t:e}function fU(t){return t=pW(t),t!==null?pU(t):null}function pU(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pU(t);if(e!==null)return e;t=t.sibling}return null}var mU=Zi.unstable_scheduleCallback,Mj=Zi.unstable_cancelCallback,mW=Zi.unstable_shouldYield,gW=Zi.unstable_requestPaint,dr=Zi.unstable_now,yW=Zi.unstable_getCurrentPriorityLevel,Tk=Zi.unstable_ImmediatePriority,gU=Zi.unstable_UserBlockingPriority,_1=Zi.unstable_NormalPriority,wW=Zi.unstable_LowPriority,yU=Zi.unstable_IdlePriority,aC=null,hc=null;function xW(t){if(hc&&typeof hc.onCommitFiberRoot=="function")try{hc.onCommitFiberRoot(aC,t,void 0,(t.current.flags&128)===128)}catch{}}var ga=Math.clz32?Math.clz32:EW,bW=Math.log,vW=Math.LN2;function EW(t){return t>>>=0,t===0?32:31-(bW(t)/vW|0)|0}var Cb=64,Nb=4194304;function Q0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function k1(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Q0(a):(i&=o,i!==0&&(r=Q0(i)))}else o=n&~s,o!==0?r=Q0(o):i!==0&&(r=Q0(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ga(e),s=1<<n,r|=t[n],e&=~s;return r}function CW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function NW(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ga(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=CW(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function l2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wU(){var t=Cb;return Cb<<=1,!(Cb&4194240)&&(Cb=64),t}function ON(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bx(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ga(e),t[e]=n}function AW(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-ga(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function _k(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ga(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var wn=0;function xU(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var bU,kk,vU,EU,CU,d2=!1,Ab=[],zd=null,Hd=null,Vd=null,Ky=new Map,Gy=new Map,fd=[],SW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uj(t,e){switch(t){case"focusin":case"focusout":zd=null;break;case"dragenter":case"dragleave":Hd=null;break;case"mouseover":case"mouseout":Vd=null;break;case"pointerover":case"pointerout":Ky.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gy.delete(e.pointerId)}}function f0(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Fx(e),e!==null&&kk(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function TW(t,e,n,r,s){switch(e){case"focusin":return zd=f0(zd,t,e,n,r,s),!0;case"dragenter":return Hd=f0(Hd,t,e,n,r,s),!0;case"mouseover":return Vd=f0(Vd,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ky.set(i,f0(Ky.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Gy.set(i,f0(Gy.get(i)||null,t,e,n,r,s)),!0}return!1}function NU(t){var e=sh(t.target);if(e!==null){var n=Sf(e);if(n!==null){if(e=n.tag,e===13){if(e=hU(n),e!==null){t.blockedOn=e,CU(t.priority,function(){vU(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Pv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=u2(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);i2=r,n.target.dispatchEvent(r),i2=null}else return e=Fx(n),e!==null&&kk(e),t.blockedOn=n,!1;e.shift()}return!0}function Lj(t,e,n){Pv(t)&&n.delete(e)}function _W(){d2=!1,zd!==null&&Pv(zd)&&(zd=null),Hd!==null&&Pv(Hd)&&(Hd=null),Vd!==null&&Pv(Vd)&&(Vd=null),Ky.forEach(Lj),Gy.forEach(Lj)}function p0(t,e){t.blockedOn===e&&(t.blockedOn=null,d2||(d2=!0,Zi.unstable_scheduleCallback(Zi.unstable_NormalPriority,_W)))}function Yy(t){function e(s){return p0(s,t)}if(0<Ab.length){p0(Ab[0],t);for(var n=1;n<Ab.length;n++){var r=Ab[n];r.blockedOn===t&&(r.blockedOn=null)}}for(zd!==null&&p0(zd,t),Hd!==null&&p0(Hd,t),Vd!==null&&p0(Vd,t),Ky.forEach(e),Gy.forEach(e),n=0;n<fd.length;n++)r=fd[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<fd.length&&(n=fd[0],n.blockedOn===null);)NU(n),n.blockedOn===null&&fd.shift()}var Xp=Ol.ReactCurrentBatchConfig,I1=!0;function kW(t,e,n,r){var s=wn,i=Xp.transition;Xp.transition=null;try{wn=1,Ik(t,e,n,r)}finally{wn=s,Xp.transition=i}}function IW(t,e,n,r){var s=wn,i=Xp.transition;Xp.transition=null;try{wn=4,Ik(t,e,n,r)}finally{wn=s,Xp.transition=i}}function Ik(t,e,n,r){if(I1){var s=u2(t,e,n,r);if(s===null)VN(t,e,r,R1,n),Uj(t,r);else if(TW(s,t,e,n,r))r.stopPropagation();else if(Uj(t,r),e&4&&-1<SW.indexOf(t)){for(;s!==null;){var i=Fx(s);if(i!==null&&bU(i),i=u2(t,e,n,r),i===null&&VN(t,e,r,R1,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else VN(t,e,r,null,n)}}var R1=null;function u2(t,e,n,r){if(R1=null,t=Sk(r),t=sh(t),t!==null)if(e=Sf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=hU(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return R1=t,null}function AU(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yW()){case Tk:return 1;case gU:return 4;case _1:case wW:return 16;case yU:return 536870912;default:return 16}default:return 16}}var Ud=null,Rk=null,Ov=null;function SU(){if(Ov)return Ov;var t,e=Rk,n=e.length,r,s="value"in Ud?Ud.value:Ud.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ov=s.slice(t,1<r?1-r:void 0)}function Dv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sb(){return!0}function Bj(){return!1}function to(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sb:Bj,this.isPropagationStopped=Bj,this}return Qn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sb)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sb)},persist:function(){},isPersistent:Sb}),e}var Bg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jk=to(Bg),$x=Qn({},Bg,{view:0,detail:0}),RW=to($x),DN,MN,m0,cC=Qn({},$x,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pk,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==m0&&(m0&&t.type==="mousemove"?(DN=t.screenX-m0.screenX,MN=t.screenY-m0.screenY):MN=DN=0,m0=t),DN)},movementY:function(t){return"movementY"in t?t.movementY:MN}}),$j=to(cC),jW=Qn({},cC,{dataTransfer:0}),PW=to(jW),OW=Qn({},$x,{relatedTarget:0}),UN=to(OW),DW=Qn({},Bg,{animationName:0,elapsedTime:0,pseudoElement:0}),MW=to(DW),UW=Qn({},Bg,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),LW=to(UW),BW=Qn({},Bg,{data:0}),Fj=to(BW),$W={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=zW[t])?!!e[t]:!1}function Pk(){return HW}var VW=Qn({},$x,{key:function(t){if(t.key){var e=$W[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?FW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pk,charCode:function(t){return t.type==="keypress"?Dv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WW=to(VW),qW=Qn({},cC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zj=to(qW),KW=Qn({},$x,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pk}),GW=to(KW),YW=Qn({},Bg,{propertyName:0,elapsedTime:0,pseudoElement:0}),QW=to(YW),JW=Qn({},cC,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ZW=to(JW),XW=[9,13,27,32],Ok=vl&&"CompositionEvent"in window,py=null;vl&&"documentMode"in document&&(py=document.documentMode);var eq=vl&&"TextEvent"in window&&!py,TU=vl&&(!Ok||py&&8<py&&11>=py),Hj=" ",Vj=!1;function _U(t,e){switch(t){case"keyup":return XW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kU(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sp=!1;function tq(t,e){switch(t){case"compositionend":return kU(e);case"keypress":return e.which!==32?null:(Vj=!0,Hj);case"textInput":return t=e.data,t===Hj&&Vj?null:t;default:return null}}function nq(t,e){if(Sp)return t==="compositionend"||!Ok&&_U(t,e)?(t=SU(),Ov=Rk=Ud=null,Sp=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return TU&&e.locale!=="ko"?null:e.data;default:return null}}var rq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wj(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rq[t.type]:e==="textarea"}function IU(t,e,n,r){aU(r),e=j1(e,"onChange"),0<e.length&&(n=new jk("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var my=null,Qy=null;function sq(t){FU(t,0)}function lC(t){var e=kp(t);if(eU(e))return t}function iq(t,e){if(t==="change")return e}var RU=!1;if(vl){var LN;if(vl){var BN="oninput"in document;if(!BN){var qj=document.createElement("div");qj.setAttribute("oninput","return;"),BN=typeof qj.oninput=="function"}LN=BN}else LN=!1;RU=LN&&(!document.documentMode||9<document.documentMode)}function Kj(){my&&(my.detachEvent("onpropertychange",jU),Qy=my=null)}function jU(t){if(t.propertyName==="value"&&lC(Qy)){var e=[];IU(e,Qy,t,Sk(t)),uU(sq,e)}}function oq(t,e,n){t==="focusin"?(Kj(),my=e,Qy=n,my.attachEvent("onpropertychange",jU)):t==="focusout"&&Kj()}function aq(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lC(Qy)}function cq(t,e){if(t==="click")return lC(e)}function lq(t,e){if(t==="input"||t==="change")return lC(e)}function dq(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ea=typeof Object.is=="function"?Object.is:dq;function Jy(t,e){if(Ea(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!KS.call(e,s)||!Ea(t[s],e[s]))return!1}return!0}function Gj(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yj(t,e){var n=Gj(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Gj(n)}}function PU(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?PU(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function OU(){for(var t=window,e=A1();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=A1(t.document)}return e}function Dk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uq(t){var e=OU(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&PU(n.ownerDocument.documentElement,n)){if(r!==null&&Dk(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Yj(n,i);var o=Yj(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var hq=vl&&"documentMode"in document&&11>=document.documentMode,Tp=null,h2=null,gy=null,f2=!1;function Qj(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;f2||Tp==null||Tp!==A1(r)||(r=Tp,"selectionStart"in r&&Dk(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),gy&&Jy(gy,r)||(gy=r,r=j1(h2,"onSelect"),0<r.length&&(e=new jk("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Tp)))}function Tb(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _p={animationend:Tb("Animation","AnimationEnd"),animationiteration:Tb("Animation","AnimationIteration"),animationstart:Tb("Animation","AnimationStart"),transitionend:Tb("Transition","TransitionEnd")},$N={},DU={};vl&&(DU=document.createElement("div").style,"AnimationEvent"in window||(delete _p.animationend.animation,delete _p.animationiteration.animation,delete _p.animationstart.animation),"TransitionEvent"in window||delete _p.transitionend.transition);function dC(t){if($N[t])return $N[t];if(!_p[t])return t;var e=_p[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in DU)return $N[t]=e[n];return t}var MU=dC("animationend"),UU=dC("animationiteration"),LU=dC("animationstart"),BU=dC("transitionend"),$U=new Map,Jj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pu(t,e){$U.set(t,e),Af(e,[t])}for(var FN=0;FN<Jj.length;FN++){var zN=Jj[FN],fq=zN.toLowerCase(),pq=zN[0].toUpperCase()+zN.slice(1);pu(fq,"on"+pq)}pu(MU,"onAnimationEnd");pu(UU,"onAnimationIteration");pu(LU,"onAnimationStart");pu("dblclick","onDoubleClick");pu("focusin","onFocus");pu("focusout","onBlur");pu(BU,"onTransitionEnd");eg("onMouseEnter",["mouseout","mouseover"]);eg("onMouseLeave",["mouseout","mouseover"]);eg("onPointerEnter",["pointerout","pointerover"]);eg("onPointerLeave",["pointerout","pointerover"]);Af("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Af("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Af("onBeforeInput",["compositionend","keypress","textInput","paste"]);Af("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Af("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Af("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var J0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mq=new Set("cancel close invalid load scroll toggle".split(" ").concat(J0));function Zj(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,fW(r,e,void 0,t),t.currentTarget=null}function FU(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,d=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Zj(s,a,d),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,d=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Zj(s,a,d),i=l}}}if(T1)throw t=c2,T1=!1,c2=null,t}function jn(t,e){var n=e[w2];n===void 0&&(n=e[w2]=new Set);var r=t+"__bubble";n.has(r)||(zU(e,t,2,!1),n.add(r))}function HN(t,e,n){var r=0;e&&(r|=4),zU(n,t,r,e)}var _b="_reactListening"+Math.random().toString(36).slice(2);function Zy(t){if(!t[_b]){t[_b]=!0,YM.forEach(function(n){n!=="selectionchange"&&(mq.has(n)||HN(n,!1,t),HN(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_b]||(e[_b]=!0,HN("selectionchange",!1,e))}}function zU(t,e,n,r){switch(AU(e)){case 1:var s=kW;break;case 4:s=IW;break;default:s=Ik}n=s.bind(null,e,n,t),s=void 0,!a2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function VN(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=sh(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}uU(function(){var d=i,u=Sk(n),h=[];e:{var f=$U.get(t);if(f!==void 0){var p=jk,m=t;switch(t){case"keypress":if(Dv(n)===0)break e;case"keydown":case"keyup":p=WW;break;case"focusin":m="focus",p=UN;break;case"focusout":m="blur",p=UN;break;case"beforeblur":case"afterblur":p=UN;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$j;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=PW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=GW;break;case MU:case UU:case LU:p=MW;break;case BU:p=QW;break;case"scroll":p=RW;break;case"wheel":p=ZW;break;case"copy":case"cut":case"paste":p=LW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=zj}var g=(e&4)!==0,w=!g&&t==="scroll",b=g?f!==null?f+"Capture":null:f;g=[];for(var y=d,x;y!==null;){x=y;var v=x.stateNode;if(x.tag===5&&v!==null&&(x=v,b!==null&&(v=qy(y,b),v!=null&&g.push(Xy(y,v,x)))),w)break;y=y.return}0<g.length&&(f=new p(f,m,null,n,u),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==i2&&(m=n.relatedTarget||n.fromElement)&&(sh(m)||m[El]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=d,m=m?sh(m):null,m!==null&&(w=Sf(m),m!==w||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=d),p!==m)){if(g=$j,v="onMouseLeave",b="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(g=zj,v="onPointerLeave",b="onPointerEnter",y="pointer"),w=p==null?f:kp(p),x=m==null?f:kp(m),f=new g(v,y+"leave",p,n,u),f.target=w,f.relatedTarget=x,v=null,sh(u)===d&&(g=new g(b,y+"enter",m,n,u),g.target=x,g.relatedTarget=w,v=g),w=v,p&&m)t:{for(g=p,b=m,y=0,x=g;x;x=zf(x))y++;for(x=0,v=b;v;v=zf(v))x++;for(;0<y-x;)g=zf(g),y--;for(;0<x-y;)b=zf(b),x--;for(;y--;){if(g===b||b!==null&&g===b.alternate)break t;g=zf(g),b=zf(b)}g=null}else g=null;p!==null&&Xj(h,f,p,g,!1),m!==null&&w!==null&&Xj(h,w,m,g,!0)}}e:{if(f=d?kp(d):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var E=iq;else if(Wj(f))if(RU)E=lq;else{E=aq;var R=oq}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=cq);if(E&&(E=E(t,d))){IU(h,E,n,u);break e}R&&R(t,f,d),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&e2(f,"number",f.value)}switch(R=d?kp(d):window,t){case"focusin":(Wj(R)||R.contentEditable==="true")&&(Tp=R,h2=d,gy=null);break;case"focusout":gy=h2=Tp=null;break;case"mousedown":f2=!0;break;case"contextmenu":case"mouseup":case"dragend":f2=!1,Qj(h,n,u);break;case"selectionchange":if(hq)break;case"keydown":case"keyup":Qj(h,n,u)}var S;if(Ok)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Sp?_U(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(TU&&n.locale!=="ko"&&(Sp||C!=="onCompositionStart"?C==="onCompositionEnd"&&Sp&&(S=SU()):(Ud=u,Rk="value"in Ud?Ud.value:Ud.textContent,Sp=!0)),R=j1(d,C),0<R.length&&(C=new Fj(C,t,null,n,u),h.push({event:C,listeners:R}),S?C.data=S:(S=kU(n),S!==null&&(C.data=S)))),(S=eq?tq(t,n):nq(t,n))&&(d=j1(d,"onBeforeInput"),0<d.length&&(u=new Fj("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:d}),u.data=S))}FU(h,e)})}function Xy(t,e,n){return{instance:t,listener:e,currentTarget:n}}function j1(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=qy(t,n),i!=null&&r.unshift(Xy(t,i,s)),i=qy(t,e),i!=null&&r.push(Xy(t,i,s))),t=t.return}return r}function zf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xj(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,d=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&d!==null&&(a=d,s?(l=qy(n,i),l!=null&&o.unshift(Xy(n,l,a))):s||(l=qy(n,i),l!=null&&o.push(Xy(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var gq=/\r\n?/g,yq=/\u0000|\uFFFD/g;function eP(t){return(typeof t=="string"?t:""+t).replace(gq,`
`).replace(yq,"")}function kb(t,e,n){if(e=eP(e),eP(t)!==e&&n)throw Error(Se(425))}function P1(){}var p2=null,m2=null;function g2(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var y2=typeof setTimeout=="function"?setTimeout:void 0,wq=typeof clearTimeout=="function"?clearTimeout:void 0,tP=typeof Promise=="function"?Promise:void 0,xq=typeof queueMicrotask=="function"?queueMicrotask:typeof tP<"u"?function(t){return tP.resolve(null).then(t).catch(bq)}:y2;function bq(t){setTimeout(function(){throw t})}function WN(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Yy(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Yy(e)}function Wd(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var $g=Math.random().toString(36).slice(2),nc="__reactFiber$"+$g,ew="__reactProps$"+$g,El="__reactContainer$"+$g,w2="__reactEvents$"+$g,vq="__reactListeners$"+$g,Eq="__reactHandles$"+$g;function sh(t){var e=t[nc];if(e)return e;for(var n=t.parentNode;n;){if(e=n[El]||n[nc]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nP(t);t!==null;){if(n=t[nc])return n;t=nP(t)}return e}t=n,n=t.parentNode}return null}function Fx(t){return t=t[nc]||t[El],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function kp(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Se(33))}function uC(t){return t[ew]||null}var x2=[],Ip=-1;function mu(t){return{current:t}}function Dn(t){0>Ip||(t.current=x2[Ip],x2[Ip]=null,Ip--)}function In(t,e){Ip++,x2[Ip]=t.current,t.current=e}var ru={},js=mu(ru),Ni=mu(!1),tf=ru;function tg(t,e){var n=t.type.contextTypes;if(!n)return ru;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ai(t){return t=t.childContextTypes,t!=null}function O1(){Dn(Ni),Dn(js)}function rP(t,e,n){if(js.current!==ru)throw Error(Se(168));In(js,e),In(Ni,n)}function HU(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Se(108,oW(t)||"Unknown",s));return Qn({},n,r)}function D1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ru,tf=js.current,In(js,t),In(Ni,Ni.current),!0}function sP(t,e,n){var r=t.stateNode;if(!r)throw Error(Se(169));n?(t=HU(t,e,tf),r.__reactInternalMemoizedMergedChildContext=t,Dn(Ni),Dn(js),In(js,t)):Dn(Ni),In(Ni,n)}var Gc=null,hC=!1,qN=!1;function VU(t){Gc===null?Gc=[t]:Gc.push(t)}function Cq(t){hC=!0,VU(t)}function gu(){if(!qN&&Gc!==null){qN=!0;var t=0,e=wn;try{var n=Gc;for(wn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gc=null,hC=!1}catch(s){throw Gc!==null&&(Gc=Gc.slice(t+1)),mU(Tk,gu),s}finally{wn=e,qN=!1}}return null}var Rp=[],jp=0,M1=null,U1=0,Ao=[],So=0,nf=null,dl=1,ul="";function Uu(t,e){Rp[jp++]=U1,Rp[jp++]=M1,M1=t,U1=e}function WU(t,e,n){Ao[So++]=dl,Ao[So++]=ul,Ao[So++]=nf,nf=t;var r=dl;t=ul;var s=32-ga(r)-1;r&=~(1<<s),n+=1;var i=32-ga(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,dl=1<<32-ga(e)+s|n<<s|r,ul=i+t}else dl=1<<i|n<<s|r,ul=t}function Mk(t){t.return!==null&&(Uu(t,1),WU(t,1,0))}function Uk(t){for(;t===M1;)M1=Rp[--jp],Rp[jp]=null,U1=Rp[--jp],Rp[jp]=null;for(;t===nf;)nf=Ao[--So],Ao[So]=null,ul=Ao[--So],Ao[So]=null,dl=Ao[--So],Ao[So]=null}var Qi=null,Gi=null,Hn=!1,da=null;function qU(t,e){var n=ko(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function iP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qi=t,Gi=Wd(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qi=t,Gi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=nf!==null?{id:dl,overflow:ul}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ko(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qi=t,Gi=null,!0):!1;default:return!1}}function b2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function v2(t){if(Hn){var e=Gi;if(e){var n=e;if(!iP(t,e)){if(b2(t))throw Error(Se(418));e=Wd(n.nextSibling);var r=Qi;e&&iP(t,e)?qU(r,n):(t.flags=t.flags&-4097|2,Hn=!1,Qi=t)}}else{if(b2(t))throw Error(Se(418));t.flags=t.flags&-4097|2,Hn=!1,Qi=t}}}function oP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qi=t}function Ib(t){if(t!==Qi)return!1;if(!Hn)return oP(t),Hn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!g2(t.type,t.memoizedProps)),e&&(e=Gi)){if(b2(t))throw KU(),Error(Se(418));for(;e;)qU(t,e),e=Wd(e.nextSibling)}if(oP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Gi=Wd(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Gi=null}}else Gi=Qi?Wd(t.stateNode.nextSibling):null;return!0}function KU(){for(var t=Gi;t;)t=Wd(t.nextSibling)}function ng(){Gi=Qi=null,Hn=!1}function Lk(t){da===null?da=[t]:da.push(t)}var Nq=Ol.ReactCurrentBatchConfig;function g0(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Se(309));var r=n.stateNode}if(!r)throw Error(Se(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Se(284));if(!n._owner)throw Error(Se(290,t))}return t}function Rb(t,e){throw t=Object.prototype.toString.call(e),Error(Se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function aP(t){var e=t._init;return e(t._payload)}function GU(t){function e(b,y){if(t){var x=b.deletions;x===null?(b.deletions=[y],b.flags|=16):x.push(y)}}function n(b,y){if(!t)return null;for(;y!==null;)e(b,y),y=y.sibling;return null}function r(b,y){for(b=new Map;y!==null;)y.key!==null?b.set(y.key,y):b.set(y.index,y),y=y.sibling;return b}function s(b,y){return b=Yd(b,y),b.index=0,b.sibling=null,b}function i(b,y,x){return b.index=x,t?(x=b.alternate,x!==null?(x=x.index,x<y?(b.flags|=2,y):x):(b.flags|=2,y)):(b.flags|=1048576,y)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function a(b,y,x,v){return y===null||y.tag!==6?(y=XN(x,b.mode,v),y.return=b,y):(y=s(y,x),y.return=b,y)}function l(b,y,x,v){var E=x.type;return E===Ap?u(b,y,x.props.children,v,x.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===od&&aP(E)===y.type)?(v=s(y,x.props),v.ref=g0(b,y,x),v.return=b,v):(v=zv(x.type,x.key,x.props,null,b.mode,v),v.ref=g0(b,y,x),v.return=b,v)}function d(b,y,x,v){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=eA(x,b.mode,v),y.return=b,y):(y=s(y,x.children||[]),y.return=b,y)}function u(b,y,x,v,E){return y===null||y.tag!==7?(y=Vh(x,b.mode,v,E),y.return=b,y):(y=s(y,x),y.return=b,y)}function h(b,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=XN(""+y,b.mode,x),y.return=b,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case bb:return x=zv(y.type,y.key,y.props,null,b.mode,x),x.ref=g0(b,null,y),x.return=b,x;case Np:return y=eA(y,b.mode,x),y.return=b,y;case od:var v=y._init;return h(b,v(y._payload),x)}if(Y0(y)||u0(y))return y=Vh(y,b.mode,x,null),y.return=b,y;Rb(b,y)}return null}function f(b,y,x,v){var E=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return E!==null?null:a(b,y,""+x,v);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case bb:return x.key===E?l(b,y,x,v):null;case Np:return x.key===E?d(b,y,x,v):null;case od:return E=x._init,f(b,y,E(x._payload),v)}if(Y0(x)||u0(x))return E!==null?null:u(b,y,x,v,null);Rb(b,x)}return null}function p(b,y,x,v,E){if(typeof v=="string"&&v!==""||typeof v=="number")return b=b.get(x)||null,a(y,b,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case bb:return b=b.get(v.key===null?x:v.key)||null,l(y,b,v,E);case Np:return b=b.get(v.key===null?x:v.key)||null,d(y,b,v,E);case od:var R=v._init;return p(b,y,x,R(v._payload),E)}if(Y0(v)||u0(v))return b=b.get(x)||null,u(y,b,v,E,null);Rb(y,v)}return null}function m(b,y,x,v){for(var E=null,R=null,S=y,C=y=0,N=null;S!==null&&C<x.length;C++){S.index>C?(N=S,S=null):N=S.sibling;var T=f(b,S,x[C],v);if(T===null){S===null&&(S=N);break}t&&S&&T.alternate===null&&e(b,S),y=i(T,y,C),R===null?E=T:R.sibling=T,R=T,S=N}if(C===x.length)return n(b,S),Hn&&Uu(b,C),E;if(S===null){for(;C<x.length;C++)S=h(b,x[C],v),S!==null&&(y=i(S,y,C),R===null?E=S:R.sibling=S,R=S);return Hn&&Uu(b,C),E}for(S=r(b,S);C<x.length;C++)N=p(S,b,C,x[C],v),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?C:N.key),y=i(N,y,C),R===null?E=N:R.sibling=N,R=N);return t&&S.forEach(function($){return e(b,$)}),Hn&&Uu(b,C),E}function g(b,y,x,v){var E=u0(x);if(typeof E!="function")throw Error(Se(150));if(x=E.call(x),x==null)throw Error(Se(151));for(var R=E=null,S=y,C=y=0,N=null,T=x.next();S!==null&&!T.done;C++,T=x.next()){S.index>C?(N=S,S=null):N=S.sibling;var $=f(b,S,T.value,v);if($===null){S===null&&(S=N);break}t&&S&&$.alternate===null&&e(b,S),y=i($,y,C),R===null?E=$:R.sibling=$,R=$,S=N}if(T.done)return n(b,S),Hn&&Uu(b,C),E;if(S===null){for(;!T.done;C++,T=x.next())T=h(b,T.value,v),T!==null&&(y=i(T,y,C),R===null?E=T:R.sibling=T,R=T);return Hn&&Uu(b,C),E}for(S=r(b,S);!T.done;C++,T=x.next())T=p(S,b,C,T.value,v),T!==null&&(t&&T.alternate!==null&&S.delete(T.key===null?C:T.key),y=i(T,y,C),R===null?E=T:R.sibling=T,R=T);return t&&S.forEach(function(U){return e(b,U)}),Hn&&Uu(b,C),E}function w(b,y,x,v){if(typeof x=="object"&&x!==null&&x.type===Ap&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case bb:e:{for(var E=x.key,R=y;R!==null;){if(R.key===E){if(E=x.type,E===Ap){if(R.tag===7){n(b,R.sibling),y=s(R,x.props.children),y.return=b,b=y;break e}}else if(R.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===od&&aP(E)===R.type){n(b,R.sibling),y=s(R,x.props),y.ref=g0(b,R,x),y.return=b,b=y;break e}n(b,R);break}else e(b,R);R=R.sibling}x.type===Ap?(y=Vh(x.props.children,b.mode,v,x.key),y.return=b,b=y):(v=zv(x.type,x.key,x.props,null,b.mode,v),v.ref=g0(b,y,x),v.return=b,b=v)}return o(b);case Np:e:{for(R=x.key;y!==null;){if(y.key===R)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(b,y.sibling),y=s(y,x.children||[]),y.return=b,b=y;break e}else{n(b,y);break}else e(b,y);y=y.sibling}y=eA(x,b.mode,v),y.return=b,b=y}return o(b);case od:return R=x._init,w(b,y,R(x._payload),v)}if(Y0(x))return m(b,y,x,v);if(u0(x))return g(b,y,x,v);Rb(b,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(b,y.sibling),y=s(y,x),y.return=b,b=y):(n(b,y),y=XN(x,b.mode,v),y.return=b,b=y),o(b)):n(b,y)}return w}var rg=GU(!0),YU=GU(!1),L1=mu(null),B1=null,Pp=null,Bk=null;function $k(){Bk=Pp=B1=null}function Fk(t){var e=L1.current;Dn(L1),t._currentValue=e}function E2(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function em(t,e){B1=t,Bk=Pp=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(bi=!0),t.firstContext=null)}function Do(t){var e=t._currentValue;if(Bk!==t)if(t={context:t,memoizedValue:e,next:null},Pp===null){if(B1===null)throw Error(Se(308));Pp=t,B1.dependencies={lanes:0,firstContext:t}}else Pp=Pp.next=t;return e}var ih=null;function zk(t){ih===null?ih=[t]:ih.push(t)}function QU(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,zk(e)):(n.next=s.next,s.next=n),e.interleaved=n,Cl(t,r)}function Cl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ad=!1;function Hk(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JU(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ml(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qd(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,en&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Cl(t,n)}return s=r.interleaved,s===null?(e.next=e,zk(r)):(e.next=s.next,s.next=e),r.interleaved=e,Cl(t,n)}function Mv(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_k(t,n)}}function cP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function $1(t,e,n,r){var s=t.updateQueue;ad=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,d=l.next;l.next=null,o===null?i=d:o.next=d,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=d:a.next=d,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=d=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=t,g=a;switch(f=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,f=typeof m=="function"?m.call(p,h,f):m,f==null)break e;h=Qn({},h,f);break e;case 2:ad=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(d=u=p,l=h):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=d,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);sf|=o,t.lanes=o,t.memoizedState=h}}function lP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Se(191,s));s.call(r)}}}var zx={},fc=mu(zx),tw=mu(zx),nw=mu(zx);function oh(t){if(t===zx)throw Error(Se(174));return t}function Vk(t,e){switch(In(nw,e),In(tw,t),In(fc,zx),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:n2(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=n2(e,t)}Dn(fc),In(fc,e)}function sg(){Dn(fc),Dn(tw),Dn(nw)}function ZU(t){oh(nw.current);var e=oh(fc.current),n=n2(e,t.type);e!==n&&(In(tw,t),In(fc,n))}function Wk(t){tw.current===t&&(Dn(fc),Dn(tw))}var qn=mu(0);function F1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var KN=[];function qk(){for(var t=0;t<KN.length;t++)KN[t]._workInProgressVersionPrimary=null;KN.length=0}var Uv=Ol.ReactCurrentDispatcher,GN=Ol.ReactCurrentBatchConfig,rf=0,Yn=null,Tr=null,$r=null,z1=!1,yy=!1,rw=0,Aq=0;function ps(){throw Error(Se(321))}function Kk(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ea(t[n],e[n]))return!1;return!0}function Gk(t,e,n,r,s,i){if(rf=i,Yn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Uv.current=t===null||t.memoizedState===null?kq:Iq,t=n(r,s),yy){i=0;do{if(yy=!1,rw=0,25<=i)throw Error(Se(301));i+=1,$r=Tr=null,e.updateQueue=null,Uv.current=Rq,t=n(r,s)}while(yy)}if(Uv.current=H1,e=Tr!==null&&Tr.next!==null,rf=0,$r=Tr=Yn=null,z1=!1,e)throw Error(Se(300));return t}function Yk(){var t=rw!==0;return rw=0,t}function $a(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $r===null?Yn.memoizedState=$r=t:$r=$r.next=t,$r}function Mo(){if(Tr===null){var t=Yn.alternate;t=t!==null?t.memoizedState:null}else t=Tr.next;var e=$r===null?Yn.memoizedState:$r.next;if(e!==null)$r=e,Tr=t;else{if(t===null)throw Error(Se(310));Tr=t,t={memoizedState:Tr.memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},$r===null?Yn.memoizedState=$r=t:$r=$r.next=t}return $r}function sw(t,e){return typeof e=="function"?e(t):e}function YN(t){var e=Mo(),n=e.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=t;var r=Tr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,d=i;do{var u=d.lane;if((rf&u)===u)l!==null&&(l=l.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Yn.lanes|=u,sf|=u}d=d.next}while(d!==null&&d!==i);l===null?o=r:l.next=a,Ea(r,e.memoizedState)||(bi=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Yn.lanes|=i,sf|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function QN(t){var e=Mo(),n=e.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ea(i,e.memoizedState)||(bi=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function XU(){}function eL(t,e){var n=Yn,r=Mo(),s=e(),i=!Ea(r.memoizedState,s);if(i&&(r.memoizedState=s,bi=!0),r=r.queue,Qk(rL.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||$r!==null&&$r.memoizedState.tag&1){if(n.flags|=2048,iw(9,nL.bind(null,n,r,s,e),void 0,null),Wr===null)throw Error(Se(349));rf&30||tL(n,e,s)}return s}function tL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Yn.updateQueue,e===null?(e={lastEffect:null,stores:null},Yn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function nL(t,e,n,r){e.value=n,e.getSnapshot=r,sL(e)&&iL(t)}function rL(t,e,n){return n(function(){sL(e)&&iL(t)})}function sL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ea(t,n)}catch{return!0}}function iL(t){var e=Cl(t,1);e!==null&&ya(e,t,1,-1)}function dP(t){var e=$a();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sw,lastRenderedState:t},e.queue=t,t=t.dispatch=_q.bind(null,Yn,t),[e.memoizedState,t]}function iw(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Yn.updateQueue,e===null?(e={lastEffect:null,stores:null},Yn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function oL(){return Mo().memoizedState}function Lv(t,e,n,r){var s=$a();Yn.flags|=t,s.memoizedState=iw(1|e,n,void 0,r===void 0?null:r)}function fC(t,e,n,r){var s=Mo();r=r===void 0?null:r;var i=void 0;if(Tr!==null){var o=Tr.memoizedState;if(i=o.destroy,r!==null&&Kk(r,o.deps)){s.memoizedState=iw(e,n,i,r);return}}Yn.flags|=t,s.memoizedState=iw(1|e,n,i,r)}function uP(t,e){return Lv(8390656,8,t,e)}function Qk(t,e){return fC(2048,8,t,e)}function aL(t,e){return fC(4,2,t,e)}function cL(t,e){return fC(4,4,t,e)}function lL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function dL(t,e,n){return n=n!=null?n.concat([t]):null,fC(4,4,lL.bind(null,e,t),n)}function Jk(){}function uL(t,e){var n=Mo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kk(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function hL(t,e){var n=Mo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kk(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function fL(t,e,n){return rf&21?(Ea(n,e)||(n=wU(),Yn.lanes|=n,sf|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,bi=!0),t.memoizedState=n)}function Sq(t,e){var n=wn;wn=n!==0&&4>n?n:4,t(!0);var r=GN.transition;GN.transition={};try{t(!1),e()}finally{wn=n,GN.transition=r}}function pL(){return Mo().memoizedState}function Tq(t,e,n){var r=Gd(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},mL(t))gL(e,n);else if(n=QU(t,e,n,r),n!==null){var s=Ks();ya(n,t,r,s),yL(n,e,r)}}function _q(t,e,n){var r=Gd(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(mL(t))gL(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Ea(a,o)){var l=e.interleaved;l===null?(s.next=s,zk(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=QU(t,e,s,r),n!==null&&(s=Ks(),ya(n,t,r,s),yL(n,e,r))}}function mL(t){var e=t.alternate;return t===Yn||e!==null&&e===Yn}function gL(t,e){yy=z1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function yL(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,_k(t,n)}}var H1={readContext:Do,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},kq={readContext:Do,useCallback:function(t,e){return $a().memoizedState=[t,e===void 0?null:e],t},useContext:Do,useEffect:uP,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Lv(4194308,4,lL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Lv(4194308,4,t,e)},useInsertionEffect:function(t,e){return Lv(4,2,t,e)},useMemo:function(t,e){var n=$a();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=$a();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Tq.bind(null,Yn,t),[r.memoizedState,t]},useRef:function(t){var e=$a();return t={current:t},e.memoizedState=t},useState:dP,useDebugValue:Jk,useDeferredValue:function(t){return $a().memoizedState=t},useTransition:function(){var t=dP(!1),e=t[0];return t=Sq.bind(null,t[1]),$a().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Yn,s=$a();if(Hn){if(n===void 0)throw Error(Se(407));n=n()}else{if(n=e(),Wr===null)throw Error(Se(349));rf&30||tL(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,uP(rL.bind(null,r,i,t),[t]),r.flags|=2048,iw(9,nL.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=$a(),e=Wr.identifierPrefix;if(Hn){var n=ul,r=dl;n=(r&~(1<<32-ga(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=rw++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Aq++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Iq={readContext:Do,useCallback:uL,useContext:Do,useEffect:Qk,useImperativeHandle:dL,useInsertionEffect:aL,useLayoutEffect:cL,useMemo:hL,useReducer:YN,useRef:oL,useState:function(){return YN(sw)},useDebugValue:Jk,useDeferredValue:function(t){var e=Mo();return fL(e,Tr.memoizedState,t)},useTransition:function(){var t=YN(sw)[0],e=Mo().memoizedState;return[t,e]},useMutableSource:XU,useSyncExternalStore:eL,useId:pL,unstable_isNewReconciler:!1},Rq={readContext:Do,useCallback:uL,useContext:Do,useEffect:Qk,useImperativeHandle:dL,useInsertionEffect:aL,useLayoutEffect:cL,useMemo:hL,useReducer:QN,useRef:oL,useState:function(){return QN(sw)},useDebugValue:Jk,useDeferredValue:function(t){var e=Mo();return Tr===null?e.memoizedState=t:fL(e,Tr.memoizedState,t)},useTransition:function(){var t=QN(sw)[0],e=Mo().memoizedState;return[t,e]},useMutableSource:XU,useSyncExternalStore:eL,useId:pL,unstable_isNewReconciler:!1};function Zo(t,e){if(t&&t.defaultProps){e=Qn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function C2(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Qn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var pC={isMounted:function(t){return(t=t._reactInternals)?Sf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ks(),s=Gd(t),i=ml(r,s);i.payload=e,n!=null&&(i.callback=n),e=qd(t,i,s),e!==null&&(ya(e,t,s,r),Mv(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ks(),s=Gd(t),i=ml(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=qd(t,i,s),e!==null&&(ya(e,t,s,r),Mv(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ks(),r=Gd(t),s=ml(n,r);s.tag=2,e!=null&&(s.callback=e),e=qd(t,s,r),e!==null&&(ya(e,t,r,n),Mv(e,t,r))}};function hP(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Jy(n,r)||!Jy(s,i):!0}function wL(t,e,n){var r=!1,s=ru,i=e.contextType;return typeof i=="object"&&i!==null?i=Do(i):(s=Ai(e)?tf:js.current,r=e.contextTypes,i=(r=r!=null)?tg(t,s):ru),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pC,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function fP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&pC.enqueueReplaceState(e,e.state,null)}function N2(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Hk(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Do(i):(i=Ai(e)?tf:js.current,s.context=tg(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(C2(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&pC.enqueueReplaceState(s,s.state,null),$1(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ig(t,e){try{var n="",r=e;do n+=iW(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function JN(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function A2(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var jq=typeof WeakMap=="function"?WeakMap:Map;function xL(t,e,n){n=ml(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){W1||(W1=!0,D2=r),A2(t,e)},n}function bL(t,e,n){n=ml(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){A2(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){A2(t,e),typeof r!="function"&&(Kd===null?Kd=new Set([this]):Kd.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function pP(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new jq;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=qq.bind(null,t,e,n),e.then(t,t))}function mP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gP(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ml(-1,1),e.tag=2,qd(n,e,1))),n.lanes|=1),t)}var Pq=Ol.ReactCurrentOwner,bi=!1;function Bs(t,e,n,r){e.child=t===null?YU(e,null,n,r):rg(e,t.child,n,r)}function yP(t,e,n,r,s){n=n.render;var i=e.ref;return em(e,s),r=Gk(t,e,n,r,i,s),n=Yk(),t!==null&&!bi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Nl(t,e,s)):(Hn&&n&&Mk(e),e.flags|=1,Bs(t,e,r,s),e.child)}function wP(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!iI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,vL(t,e,i,r,s)):(t=zv(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Jy,n(o,r)&&t.ref===e.ref)return Nl(t,e,s)}return e.flags|=1,t=Yd(i,r),t.ref=e.ref,t.return=e,e.child=t}function vL(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Jy(i,r)&&t.ref===e.ref)if(bi=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(bi=!0);else return e.lanes=t.lanes,Nl(t,e,s)}return S2(t,e,n,r,s)}function EL(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},In(Dp,zi),zi|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,In(Dp,zi),zi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,In(Dp,zi),zi|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,In(Dp,zi),zi|=r;return Bs(t,e,s,n),e.child}function CL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function S2(t,e,n,r,s){var i=Ai(n)?tf:js.current;return i=tg(e,i),em(e,s),n=Gk(t,e,n,r,i,s),r=Yk(),t!==null&&!bi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Nl(t,e,s)):(Hn&&r&&Mk(e),e.flags|=1,Bs(t,e,n,s),e.child)}function xP(t,e,n,r,s){if(Ai(n)){var i=!0;D1(e)}else i=!1;if(em(e,s),e.stateNode===null)Bv(t,e),wL(e,n,r),N2(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Do(d):(d=Ai(n)?tf:js.current,d=tg(e,d));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==d)&&fP(e,o,r,d),ad=!1;var f=e.memoizedState;o.state=f,$1(e,r,o,s),l=e.memoizedState,a!==r||f!==l||Ni.current||ad?(typeof u=="function"&&(C2(e,n,u,r),l=e.memoizedState),(a=ad||hP(e,n,a,r,f,l,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,JU(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Zo(e.type,a),o.props=d,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Do(l):(l=Ai(n)?tf:js.current,l=tg(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&fP(e,o,r,l),ad=!1,f=e.memoizedState,o.state=f,$1(e,r,o,s);var m=e.memoizedState;a!==h||f!==m||Ni.current||ad?(typeof p=="function"&&(C2(e,n,p,r),m=e.memoizedState),(d=ad||hP(e,n,d,r,f,m,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return T2(t,e,n,r,i,s)}function T2(t,e,n,r,s,i){CL(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&sP(e,n,!1),Nl(t,e,i);r=e.stateNode,Pq.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=rg(e,t.child,null,i),e.child=rg(e,null,a,i)):Bs(t,e,a,i),e.memoizedState=r.state,s&&sP(e,n,!0),e.child}function NL(t){var e=t.stateNode;e.pendingContext?rP(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rP(t,e.context,!1),Vk(t,e.containerInfo)}function bP(t,e,n,r,s){return ng(),Lk(s),e.flags|=256,Bs(t,e,n,r),e.child}var _2={dehydrated:null,treeContext:null,retryLane:0};function k2(t){return{baseLanes:t,cachePool:null,transitions:null}}function AL(t,e,n){var r=e.pendingProps,s=qn.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),In(qn,s&1),t===null)return v2(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=yC(o,r,0,null),t=Vh(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=k2(n),e.memoizedState=_2,t):Zk(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Oq(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Yd(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Yd(a,i):(i=Vh(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?k2(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=_2,r}return i=t.child,t=i.sibling,r=Yd(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Zk(t,e){return e=yC({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jb(t,e,n,r){return r!==null&&Lk(r),rg(e,t.child,null,n),t=Zk(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Oq(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=JN(Error(Se(422))),jb(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=yC({mode:"visible",children:r.children},s,0,null),i=Vh(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&rg(e,t.child,null,o),e.child.memoizedState=k2(o),e.memoizedState=_2,i);if(!(e.mode&1))return jb(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(Se(419)),r=JN(i,r,void 0),jb(t,e,o,r)}if(a=(o&t.childLanes)!==0,bi||a){if(r=Wr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Cl(t,s),ya(r,t,s,-1))}return sI(),r=JN(Error(Se(421))),jb(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Kq.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Gi=Wd(s.nextSibling),Qi=e,Hn=!0,da=null,t!==null&&(Ao[So++]=dl,Ao[So++]=ul,Ao[So++]=nf,dl=t.id,ul=t.overflow,nf=e),e=Zk(e,r.children),e.flags|=4096,e)}function vP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),E2(t.return,e,n)}function ZN(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function SL(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Bs(t,e,r.children,n),r=qn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vP(t,n,e);else if(t.tag===19)vP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(In(qn,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&F1(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),ZN(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&F1(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}ZN(e,!0,n,null,i);break;case"together":ZN(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Nl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),sf|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Se(153));if(e.child!==null){for(t=e.child,n=Yd(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Yd(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Dq(t,e,n){switch(e.tag){case 3:NL(e),ng();break;case 5:ZU(e);break;case 1:Ai(e.type)&&D1(e);break;case 4:Vk(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;In(L1,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(In(qn,qn.current&1),e.flags|=128,null):n&e.child.childLanes?AL(t,e,n):(In(qn,qn.current&1),t=Nl(t,e,n),t!==null?t.sibling:null);In(qn,qn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return SL(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),In(qn,qn.current),r)break;return null;case 22:case 23:return e.lanes=0,EL(t,e,n)}return Nl(t,e,n)}var TL,I2,_L,kL;TL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};I2=function(){};_L=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,oh(fc.current);var i=null;switch(n){case"input":s=ZS(t,s),r=ZS(t,r),i=[];break;case"select":s=Qn({},s,{value:void 0}),r=Qn({},r,{value:void 0}),i=[];break;case"textarea":s=t2(t,s),r=t2(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=P1)}r2(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Vy.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var l=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&l!==a&&(l!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(d,n)),n=l;else d==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(d,l)):d==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(d,""+l):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Vy.hasOwnProperty(d)?(l!=null&&d==="onScroll"&&jn("scroll",t),i||a===l||(i=[])):(i=i||[]).push(d,l))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};kL=function(t,e,n,r){n!==r&&(e.flags|=4)};function y0(t,e){if(!Hn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ms(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Mq(t,e,n){var r=e.pendingProps;switch(Uk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ms(e),null;case 1:return Ai(e.type)&&O1(),ms(e),null;case 3:return r=e.stateNode,sg(),Dn(Ni),Dn(js),qk(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ib(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,da!==null&&(L2(da),da=null))),I2(t,e),ms(e),null;case 5:Wk(e);var s=oh(nw.current);if(n=e.type,t!==null&&e.stateNode!=null)_L(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Se(166));return ms(e),null}if(t=oh(fc.current),Ib(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[nc]=e,r[ew]=i,t=(e.mode&1)!==0,n){case"dialog":jn("cancel",r),jn("close",r);break;case"iframe":case"object":case"embed":jn("load",r);break;case"video":case"audio":for(s=0;s<J0.length;s++)jn(J0[s],r);break;case"source":jn("error",r);break;case"img":case"image":case"link":jn("error",r),jn("load",r);break;case"details":jn("toggle",r);break;case"input":Ij(r,i),jn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},jn("invalid",r);break;case"textarea":jj(r,i),jn("invalid",r)}r2(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&kb(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&kb(r.textContent,a,t),s=["children",""+a]):Vy.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&jn("scroll",r)}switch(n){case"input":vb(r),Rj(r,i,!0);break;case"textarea":vb(r),Pj(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=P1)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rU(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[nc]=e,t[ew]=r,TL(t,e,!1,!1),e.stateNode=t;e:{switch(o=s2(n,r),n){case"dialog":jn("cancel",t),jn("close",t),s=r;break;case"iframe":case"object":case"embed":jn("load",t),s=r;break;case"video":case"audio":for(s=0;s<J0.length;s++)jn(J0[s],t);s=r;break;case"source":jn("error",t),s=r;break;case"img":case"image":case"link":jn("error",t),jn("load",t),s=r;break;case"details":jn("toggle",t),s=r;break;case"input":Ij(t,r),s=ZS(t,r),jn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Qn({},r,{value:void 0}),jn("invalid",t);break;case"textarea":jj(t,r),s=t2(t,r),jn("invalid",t);break;default:s=r}r2(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?oU(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&sU(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Wy(t,l):typeof l=="number"&&Wy(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Vy.hasOwnProperty(i)?l!=null&&i==="onScroll"&&jn("scroll",t):l!=null&&Ek(t,i,l,o))}switch(n){case"input":vb(t),Rj(t,r,!1);break;case"textarea":vb(t),Pj(t);break;case"option":r.value!=null&&t.setAttribute("value",""+nu(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Qp(t,!!r.multiple,i,!1):r.defaultValue!=null&&Qp(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=P1)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ms(e),null;case 6:if(t&&e.stateNode!=null)kL(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Se(166));if(n=oh(nw.current),oh(fc.current),Ib(e)){if(r=e.stateNode,n=e.memoizedProps,r[nc]=e,(i=r.nodeValue!==n)&&(t=Qi,t!==null))switch(t.tag){case 3:kb(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&kb(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[nc]=e,e.stateNode=r}return ms(e),null;case 13:if(Dn(qn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Hn&&Gi!==null&&e.mode&1&&!(e.flags&128))KU(),ng(),e.flags|=98560,i=!1;else if(i=Ib(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Se(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Se(317));i[nc]=e}else ng(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ms(e),i=!1}else da!==null&&(L2(da),da=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||qn.current&1?jr===0&&(jr=3):sI())),e.updateQueue!==null&&(e.flags|=4),ms(e),null);case 4:return sg(),I2(t,e),t===null&&Zy(e.stateNode.containerInfo),ms(e),null;case 10:return Fk(e.type._context),ms(e),null;case 17:return Ai(e.type)&&O1(),ms(e),null;case 19:if(Dn(qn),i=e.memoizedState,i===null)return ms(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)y0(i,!1);else{if(jr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=F1(t),o!==null){for(e.flags|=128,y0(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return In(qn,qn.current&1|2),e.child}t=t.sibling}i.tail!==null&&dr()>og&&(e.flags|=128,r=!0,y0(i,!1),e.lanes=4194304)}else{if(!r)if(t=F1(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),y0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Hn)return ms(e),null}else 2*dr()-i.renderingStartTime>og&&n!==1073741824&&(e.flags|=128,r=!0,y0(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=dr(),e.sibling=null,n=qn.current,In(qn,r?n&1|2:n&1),e):(ms(e),null);case 22:case 23:return rI(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?zi&1073741824&&(ms(e),e.subtreeFlags&6&&(e.flags|=8192)):ms(e),null;case 24:return null;case 25:return null}throw Error(Se(156,e.tag))}function Uq(t,e){switch(Uk(e),e.tag){case 1:return Ai(e.type)&&O1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return sg(),Dn(Ni),Dn(js),qk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Wk(e),null;case 13:if(Dn(qn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Se(340));ng()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Dn(qn),null;case 4:return sg(),null;case 10:return Fk(e.type._context),null;case 22:case 23:return rI(),null;case 24:return null;default:return null}}var Pb=!1,ks=!1,Lq=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function Op(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tr(t,e,r)}else n.current=null}function R2(t,e,n){try{n()}catch(r){tr(t,e,r)}}var EP=!1;function Bq(t,e){if(p2=I1,t=OU(),Dk(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,d=0,u=0,h=t,f=null;t:for(;;){for(var p;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++d===s&&(a=o),f===i&&++u===r&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(m2={focusedElem:t,selectionRange:n},I1=!1,Qe=e;Qe!==null;)if(e=Qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Qe=t;else for(;Qe!==null;){e=Qe;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,w=m.memoizedState,b=e.stateNode,y=b.getSnapshotBeforeUpdate(e.elementType===e.type?g:Zo(e.type,g),w);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(v){tr(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,Qe=t;break}Qe=e.return}return m=EP,EP=!1,m}function wy(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&R2(e,n,i)}s=s.next}while(s!==r)}}function mC(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function j2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function IL(t){var e=t.alternate;e!==null&&(t.alternate=null,IL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nc],delete e[ew],delete e[w2],delete e[vq],delete e[Eq])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function RL(t){return t.tag===5||t.tag===3||t.tag===4}function CP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||RL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function P2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=P1));else if(r!==4&&(t=t.child,t!==null))for(P2(t,e,n),t=t.sibling;t!==null;)P2(t,e,n),t=t.sibling}function O2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(O2(t,e,n),t=t.sibling;t!==null;)O2(t,e,n),t=t.sibling}var es=null,aa=!1;function Ul(t,e,n){for(n=n.child;n!==null;)jL(t,e,n),n=n.sibling}function jL(t,e,n){if(hc&&typeof hc.onCommitFiberUnmount=="function")try{hc.onCommitFiberUnmount(aC,n)}catch{}switch(n.tag){case 5:ks||Op(n,e);case 6:var r=es,s=aa;es=null,Ul(t,e,n),es=r,aa=s,es!==null&&(aa?(t=es,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):es.removeChild(n.stateNode));break;case 18:es!==null&&(aa?(t=es,n=n.stateNode,t.nodeType===8?WN(t.parentNode,n):t.nodeType===1&&WN(t,n),Yy(t)):WN(es,n.stateNode));break;case 4:r=es,s=aa,es=n.stateNode.containerInfo,aa=!0,Ul(t,e,n),es=r,aa=s;break;case 0:case 11:case 14:case 15:if(!ks&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&R2(n,e,o),s=s.next}while(s!==r)}Ul(t,e,n);break;case 1:if(!ks&&(Op(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){tr(n,e,a)}Ul(t,e,n);break;case 21:Ul(t,e,n);break;case 22:n.mode&1?(ks=(r=ks)||n.memoizedState!==null,Ul(t,e,n),ks=r):Ul(t,e,n);break;default:Ul(t,e,n)}}function NP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Lq),e.forEach(function(r){var s=Gq.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ho(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:es=a.stateNode,aa=!1;break e;case 3:es=a.stateNode.containerInfo,aa=!0;break e;case 4:es=a.stateNode.containerInfo,aa=!0;break e}a=a.return}if(es===null)throw Error(Se(160));jL(i,o,s),es=null,aa=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(d){tr(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)PL(e,t),e=e.sibling}function PL(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ho(e,t),ja(t),r&4){try{wy(3,t,t.return),mC(3,t)}catch(g){tr(t,t.return,g)}try{wy(5,t,t.return)}catch(g){tr(t,t.return,g)}}break;case 1:Ho(e,t),ja(t),r&512&&n!==null&&Op(n,n.return);break;case 5:if(Ho(e,t),ja(t),r&512&&n!==null&&Op(n,n.return),t.flags&32){var s=t.stateNode;try{Wy(s,"")}catch(g){tr(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&tU(s,i),s2(a,o);var d=s2(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?oU(s,h):u==="dangerouslySetInnerHTML"?sU(s,h):u==="children"?Wy(s,h):Ek(s,u,h,d)}switch(a){case"input":XS(s,i);break;case"textarea":nU(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Qp(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Qp(s,!!i.multiple,i.defaultValue,!0):Qp(s,!!i.multiple,i.multiple?[]:"",!1))}s[ew]=i}catch(g){tr(t,t.return,g)}}break;case 6:if(Ho(e,t),ja(t),r&4){if(t.stateNode===null)throw Error(Se(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){tr(t,t.return,g)}}break;case 3:if(Ho(e,t),ja(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Yy(e.containerInfo)}catch(g){tr(t,t.return,g)}break;case 4:Ho(e,t),ja(t);break;case 13:Ho(e,t),ja(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(tI=dr())),r&4&&NP(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(ks=(d=ks)||u,Ho(e,t),ks=d):Ho(e,t),ja(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(Qe=t,u=t.child;u!==null;){for(h=Qe=u;Qe!==null;){switch(f=Qe,p=f.child,f.tag){case 0:case 11:case 14:case 15:wy(4,f,f.return);break;case 1:Op(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){tr(r,n,g)}}break;case 5:Op(f,f.return);break;case 22:if(f.memoizedState!==null){SP(h);continue}}p!==null?(p.return=f,Qe=p):SP(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=iU("display",o))}catch(g){tr(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){tr(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ho(e,t),ja(t),r&4&&NP(t);break;case 21:break;default:Ho(e,t),ja(t)}}function ja(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(RL(n)){var r=n;break e}n=n.return}throw Error(Se(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Wy(s,""),r.flags&=-33);var i=CP(t);O2(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=CP(t);P2(t,a,o);break;default:throw Error(Se(161))}}catch(l){tr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function $q(t,e,n){Qe=t,OL(t)}function OL(t,e,n){for(var r=(t.mode&1)!==0;Qe!==null;){var s=Qe,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Pb;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||ks;a=Pb;var d=ks;if(Pb=o,(ks=l)&&!d)for(Qe=s;Qe!==null;)o=Qe,l=o.child,o.tag===22&&o.memoizedState!==null?TP(s):l!==null?(l.return=o,Qe=l):TP(s);for(;i!==null;)Qe=i,OL(i),i=i.sibling;Qe=s,Pb=a,ks=d}AP(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Qe=i):AP(t)}}function AP(t){for(;Qe!==null;){var e=Qe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ks||mC(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ks)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Zo(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&lP(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lP(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Yy(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}ks||e.flags&512&&j2(e)}catch(f){tr(e,e.return,f)}}if(e===t){Qe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Qe=n;break}Qe=e.return}}function SP(t){for(;Qe!==null;){var e=Qe;if(e===t){Qe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Qe=n;break}Qe=e.return}}function TP(t){for(;Qe!==null;){var e=Qe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{mC(4,e)}catch(l){tr(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){tr(e,s,l)}}var i=e.return;try{j2(e)}catch(l){tr(e,i,l)}break;case 5:var o=e.return;try{j2(e)}catch(l){tr(e,o,l)}}}catch(l){tr(e,e.return,l)}if(e===t){Qe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Qe=a;break}Qe=e.return}}var Fq=Math.ceil,V1=Ol.ReactCurrentDispatcher,Xk=Ol.ReactCurrentOwner,Ro=Ol.ReactCurrentBatchConfig,en=0,Wr=null,br=null,is=0,zi=0,Dp=mu(0),jr=0,ow=null,sf=0,gC=0,eI=0,xy=null,wi=null,tI=0,og=1/0,Vc=null,W1=!1,D2=null,Kd=null,Ob=!1,Ld=null,q1=0,by=0,M2=null,$v=-1,Fv=0;function Ks(){return en&6?dr():$v!==-1?$v:$v=dr()}function Gd(t){return t.mode&1?en&2&&is!==0?is&-is:Nq.transition!==null?(Fv===0&&(Fv=wU()),Fv):(t=wn,t!==0||(t=window.event,t=t===void 0?16:AU(t.type)),t):1}function ya(t,e,n,r){if(50<by)throw by=0,M2=null,Error(Se(185));Bx(t,n,r),(!(en&2)||t!==Wr)&&(t===Wr&&(!(en&2)&&(gC|=n),jr===4&&pd(t,is)),Si(t,r),n===1&&en===0&&!(e.mode&1)&&(og=dr()+500,hC&&gu()))}function Si(t,e){var n=t.callbackNode;NW(t,e);var r=k1(t,t===Wr?is:0);if(r===0)n!==null&&Mj(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Mj(n),e===1)t.tag===0?Cq(_P.bind(null,t)):VU(_P.bind(null,t)),xq(function(){!(en&6)&&gu()}),n=null;else{switch(xU(r)){case 1:n=Tk;break;case 4:n=gU;break;case 16:n=_1;break;case 536870912:n=yU;break;default:n=_1}n=zL(n,DL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function DL(t,e){if($v=-1,Fv=0,en&6)throw Error(Se(327));var n=t.callbackNode;if(tm()&&t.callbackNode!==n)return null;var r=k1(t,t===Wr?is:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=K1(t,r);else{e=r;var s=en;en|=2;var i=UL();(Wr!==t||is!==e)&&(Vc=null,og=dr()+500,Hh(t,e));do try{Vq();break}catch(a){ML(t,a)}while(!0);$k(),V1.current=i,en=s,br!==null?e=0:(Wr=null,is=0,e=jr)}if(e!==0){if(e===2&&(s=l2(t),s!==0&&(r=s,e=U2(t,s))),e===1)throw n=ow,Hh(t,0),pd(t,r),Si(t,dr()),n;if(e===6)pd(t,r);else{if(s=t.current.alternate,!(r&30)&&!zq(s)&&(e=K1(t,r),e===2&&(i=l2(t),i!==0&&(r=i,e=U2(t,i))),e===1))throw n=ow,Hh(t,0),pd(t,r),Si(t,dr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Se(345));case 2:Lu(t,wi,Vc);break;case 3:if(pd(t,r),(r&130023424)===r&&(e=tI+500-dr(),10<e)){if(k1(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ks(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=y2(Lu.bind(null,t,wi,Vc),e);break}Lu(t,wi,Vc);break;case 4:if(pd(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-ga(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=dr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Fq(r/1960))-r,10<r){t.timeoutHandle=y2(Lu.bind(null,t,wi,Vc),r);break}Lu(t,wi,Vc);break;case 5:Lu(t,wi,Vc);break;default:throw Error(Se(329))}}}return Si(t,dr()),t.callbackNode===n?DL.bind(null,t):null}function U2(t,e){var n=xy;return t.current.memoizedState.isDehydrated&&(Hh(t,e).flags|=256),t=K1(t,e),t!==2&&(e=wi,wi=n,e!==null&&L2(e)),t}function L2(t){wi===null?wi=t:wi.push.apply(wi,t)}function zq(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ea(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function pd(t,e){for(e&=~eI,e&=~gC,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ga(e),r=1<<n;t[n]=-1,e&=~r}}function _P(t){if(en&6)throw Error(Se(327));tm();var e=k1(t,0);if(!(e&1))return Si(t,dr()),null;var n=K1(t,e);if(t.tag!==0&&n===2){var r=l2(t);r!==0&&(e=r,n=U2(t,r))}if(n===1)throw n=ow,Hh(t,0),pd(t,e),Si(t,dr()),n;if(n===6)throw Error(Se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Lu(t,wi,Vc),Si(t,dr()),null}function nI(t,e){var n=en;en|=1;try{return t(e)}finally{en=n,en===0&&(og=dr()+500,hC&&gu())}}function of(t){Ld!==null&&Ld.tag===0&&!(en&6)&&tm();var e=en;en|=1;var n=Ro.transition,r=wn;try{if(Ro.transition=null,wn=1,t)return t()}finally{wn=r,Ro.transition=n,en=e,!(en&6)&&gu()}}function rI(){zi=Dp.current,Dn(Dp)}function Hh(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,wq(n)),br!==null)for(n=br.return;n!==null;){var r=n;switch(Uk(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&O1();break;case 3:sg(),Dn(Ni),Dn(js),qk();break;case 5:Wk(r);break;case 4:sg();break;case 13:Dn(qn);break;case 19:Dn(qn);break;case 10:Fk(r.type._context);break;case 22:case 23:rI()}n=n.return}if(Wr=t,br=t=Yd(t.current,null),is=zi=e,jr=0,ow=null,eI=gC=sf=0,wi=xy=null,ih!==null){for(e=0;e<ih.length;e++)if(n=ih[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ih=null}return t}function ML(t,e){do{var n=br;try{if($k(),Uv.current=H1,z1){for(var r=Yn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}z1=!1}if(rf=0,$r=Tr=Yn=null,yy=!1,rw=0,Xk.current=null,n===null||n.return===null){jr=1,ow=e,br=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=is,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=mP(o);if(p!==null){p.flags&=-257,gP(p,o,a,i,e),p.mode&1&&pP(i,d,e),e=p,l=d;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){pP(i,d,e),sI();break e}l=Error(Se(426))}}else if(Hn&&a.mode&1){var w=mP(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),gP(w,o,a,i,e),Lk(ig(l,a));break e}}i=l=ig(l,a),jr!==4&&(jr=2),xy===null?xy=[i]:xy.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=xL(i,l,e);cP(i,b);break e;case 1:a=l;var y=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Kd===null||!Kd.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var v=bL(i,a,e);cP(i,v);break e}}i=i.return}while(i!==null)}BL(n)}catch(E){e=E,br===n&&n!==null&&(br=n=n.return);continue}break}while(!0)}function UL(){var t=V1.current;return V1.current=H1,t===null?H1:t}function sI(){(jr===0||jr===3||jr===2)&&(jr=4),Wr===null||!(sf&268435455)&&!(gC&268435455)||pd(Wr,is)}function K1(t,e){var n=en;en|=2;var r=UL();(Wr!==t||is!==e)&&(Vc=null,Hh(t,e));do try{Hq();break}catch(s){ML(t,s)}while(!0);if($k(),en=n,V1.current=r,br!==null)throw Error(Se(261));return Wr=null,is=0,jr}function Hq(){for(;br!==null;)LL(br)}function Vq(){for(;br!==null&&!mW();)LL(br)}function LL(t){var e=FL(t.alternate,t,zi);t.memoizedProps=t.pendingProps,e===null?BL(t):br=e,Xk.current=null}function BL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Uq(n,e),n!==null){n.flags&=32767,br=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jr=6,br=null;return}}else if(n=Mq(n,e,zi),n!==null){br=n;return}if(e=e.sibling,e!==null){br=e;return}br=e=t}while(e!==null);jr===0&&(jr=5)}function Lu(t,e,n){var r=wn,s=Ro.transition;try{Ro.transition=null,wn=1,Wq(t,e,n,r)}finally{Ro.transition=s,wn=r}return null}function Wq(t,e,n,r){do tm();while(Ld!==null);if(en&6)throw Error(Se(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Se(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(AW(t,i),t===Wr&&(br=Wr=null,is=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ob||(Ob=!0,zL(_1,function(){return tm(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ro.transition,Ro.transition=null;var o=wn;wn=1;var a=en;en|=4,Xk.current=null,Bq(t,n),PL(n,t),uq(m2),I1=!!p2,m2=p2=null,t.current=n,$q(n),gW(),en=a,wn=o,Ro.transition=i}else t.current=n;if(Ob&&(Ob=!1,Ld=t,q1=s),i=t.pendingLanes,i===0&&(Kd=null),xW(n.stateNode),Si(t,dr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(W1)throw W1=!1,t=D2,D2=null,t;return q1&1&&t.tag!==0&&tm(),i=t.pendingLanes,i&1?t===M2?by++:(by=0,M2=t):by=0,gu(),null}function tm(){if(Ld!==null){var t=xU(q1),e=Ro.transition,n=wn;try{if(Ro.transition=null,wn=16>t?16:t,Ld===null)var r=!1;else{if(t=Ld,Ld=null,q1=0,en&6)throw Error(Se(331));var s=en;for(en|=4,Qe=t.current;Qe!==null;){var i=Qe,o=i.child;if(Qe.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var d=a[l];for(Qe=d;Qe!==null;){var u=Qe;switch(u.tag){case 0:case 11:case 15:wy(8,u,i)}var h=u.child;if(h!==null)h.return=u,Qe=h;else for(;Qe!==null;){u=Qe;var f=u.sibling,p=u.return;if(IL(u),u===d){Qe=null;break}if(f!==null){f.return=p,Qe=f;break}Qe=p}}}var m=i.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}Qe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Qe=o;else e:for(;Qe!==null;){if(i=Qe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wy(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,Qe=b;break e}Qe=i.return}}var y=t.current;for(Qe=y;Qe!==null;){o=Qe;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,Qe=x;else e:for(o=y;Qe!==null;){if(a=Qe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:mC(9,a)}}catch(E){tr(a,a.return,E)}if(a===o){Qe=null;break e}var v=a.sibling;if(v!==null){v.return=a.return,Qe=v;break e}Qe=a.return}}if(en=s,gu(),hc&&typeof hc.onPostCommitFiberRoot=="function")try{hc.onPostCommitFiberRoot(aC,t)}catch{}r=!0}return r}finally{wn=n,Ro.transition=e}}return!1}function kP(t,e,n){e=ig(n,e),e=xL(t,e,1),t=qd(t,e,1),e=Ks(),t!==null&&(Bx(t,1,e),Si(t,e))}function tr(t,e,n){if(t.tag===3)kP(t,t,n);else for(;e!==null;){if(e.tag===3){kP(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Kd===null||!Kd.has(r))){t=ig(n,t),t=bL(e,t,1),e=qd(e,t,1),t=Ks(),e!==null&&(Bx(e,1,t),Si(e,t));break}}e=e.return}}function qq(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ks(),t.pingedLanes|=t.suspendedLanes&n,Wr===t&&(is&n)===n&&(jr===4||jr===3&&(is&130023424)===is&&500>dr()-tI?Hh(t,0):eI|=n),Si(t,e)}function $L(t,e){e===0&&(t.mode&1?(e=Nb,Nb<<=1,!(Nb&130023424)&&(Nb=4194304)):e=1);var n=Ks();t=Cl(t,e),t!==null&&(Bx(t,e,n),Si(t,n))}function Kq(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$L(t,n)}function Gq(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Se(314))}r!==null&&r.delete(e),$L(t,n)}var FL;FL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ni.current)bi=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return bi=!1,Dq(t,e,n);bi=!!(t.flags&131072)}else bi=!1,Hn&&e.flags&1048576&&WU(e,U1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bv(t,e),t=e.pendingProps;var s=tg(e,js.current);em(e,n),s=Gk(null,e,r,t,s,n);var i=Yk();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ai(r)?(i=!0,D1(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hk(e),s.updater=pC,e.stateNode=s,s._reactInternals=e,N2(e,r,t,n),e=T2(null,e,r,!0,i,n)):(e.tag=0,Hn&&i&&Mk(e),Bs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bv(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Qq(r),t=Zo(r,t),s){case 0:e=S2(null,e,r,t,n);break e;case 1:e=xP(null,e,r,t,n);break e;case 11:e=yP(null,e,r,t,n);break e;case 14:e=wP(null,e,r,Zo(r.type,t),n);break e}throw Error(Se(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zo(r,s),S2(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zo(r,s),xP(t,e,r,s,n);case 3:e:{if(NL(e),t===null)throw Error(Se(387));r=e.pendingProps,i=e.memoizedState,s=i.element,JU(t,e),$1(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ig(Error(Se(423)),e),e=bP(t,e,r,n,s);break e}else if(r!==s){s=ig(Error(Se(424)),e),e=bP(t,e,r,n,s);break e}else for(Gi=Wd(e.stateNode.containerInfo.firstChild),Qi=e,Hn=!0,da=null,n=YU(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ng(),r===s){e=Nl(t,e,n);break e}Bs(t,e,r,n)}e=e.child}return e;case 5:return ZU(e),t===null&&v2(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,g2(r,s)?o=null:i!==null&&g2(r,i)&&(e.flags|=32),CL(t,e),Bs(t,e,o,n),e.child;case 6:return t===null&&v2(e),null;case 13:return AL(t,e,n);case 4:return Vk(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=rg(e,null,r,n):Bs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zo(r,s),yP(t,e,r,s,n);case 7:return Bs(t,e,e.pendingProps,n),e.child;case 8:return Bs(t,e,e.pendingProps.children,n),e.child;case 12:return Bs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,In(L1,r._currentValue),r._currentValue=o,i!==null)if(Ea(i.value,o)){if(i.children===s.children&&!Ni.current){e=Nl(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=ml(-1,n&-n),l.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?l.next=l:(l.next=u.next,u.next=l),d.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),E2(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Se(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),E2(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Bs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,em(e,n),s=Do(s),r=r(s),e.flags|=1,Bs(t,e,r,n),e.child;case 14:return r=e.type,s=Zo(r,e.pendingProps),s=Zo(r.type,s),wP(t,e,r,s,n);case 15:return vL(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zo(r,s),Bv(t,e),e.tag=1,Ai(r)?(t=!0,D1(e)):t=!1,em(e,n),wL(e,r,s),N2(e,r,s,n),T2(null,e,r,!0,t,n);case 19:return SL(t,e,n);case 22:return EL(t,e,n)}throw Error(Se(156,e.tag))};function zL(t,e){return mU(t,e)}function Yq(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ko(t,e,n,r){return new Yq(t,e,n,r)}function iI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Qq(t){if(typeof t=="function")return iI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Nk)return 11;if(t===Ak)return 14}return 2}function Yd(t,e){var n=t.alternate;return n===null?(n=ko(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function zv(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")iI(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ap:return Vh(n.children,s,i,e);case Ck:o=8,s|=8;break;case GS:return t=ko(12,n,e,s|2),t.elementType=GS,t.lanes=i,t;case YS:return t=ko(13,n,e,s),t.elementType=YS,t.lanes=i,t;case QS:return t=ko(19,n,e,s),t.elementType=QS,t.lanes=i,t;case ZM:return yC(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case QM:o=10;break e;case JM:o=9;break e;case Nk:o=11;break e;case Ak:o=14;break e;case od:o=16,r=null;break e}throw Error(Se(130,t==null?t:typeof t,""))}return e=ko(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Vh(t,e,n,r){return t=ko(7,t,r,e),t.lanes=n,t}function yC(t,e,n,r){return t=ko(22,t,r,e),t.elementType=ZM,t.lanes=n,t.stateNode={isHidden:!1},t}function XN(t,e,n){return t=ko(6,t,null,e),t.lanes=n,t}function eA(t,e,n){return e=ko(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Jq(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ON(0),this.expirationTimes=ON(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ON(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function oI(t,e,n,r,s,i,o,a,l){return t=new Jq(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ko(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hk(i),t}function Zq(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Np,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function HL(t){if(!t)return ru;t=t._reactInternals;e:{if(Sf(t)!==t||t.tag!==1)throw Error(Se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ai(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Se(171))}if(t.tag===1){var n=t.type;if(Ai(n))return HU(t,n,e)}return e}function VL(t,e,n,r,s,i,o,a,l){return t=oI(n,r,!0,t,s,i,o,a,l),t.context=HL(null),n=t.current,r=Ks(),s=Gd(n),i=ml(r,s),i.callback=e??null,qd(n,i,s),t.current.lanes=s,Bx(t,s,r),Si(t,r),t}function wC(t,e,n,r){var s=e.current,i=Ks(),o=Gd(s);return n=HL(n),e.context===null?e.context=n:e.pendingContext=n,e=ml(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=qd(s,e,o),t!==null&&(ya(t,s,o,i),Mv(t,s,o)),o}function G1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function IP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function aI(t,e){IP(t,e),(t=t.alternate)&&IP(t,e)}function Xq(){return null}var WL=typeof reportError=="function"?reportError:function(t){console.error(t)};function cI(t){this._internalRoot=t}xC.prototype.render=cI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Se(409));wC(t,e,null,null)};xC.prototype.unmount=cI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;of(function(){wC(null,t,null,null)}),e[El]=null}};function xC(t){this._internalRoot=t}xC.prototype.unstable_scheduleHydration=function(t){if(t){var e=EU();t={blockedOn:null,target:t,priority:e};for(var n=0;n<fd.length&&e!==0&&e<fd[n].priority;n++);fd.splice(n,0,t),n===0&&NU(t)}};function lI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function bC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function RP(){}function eK(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=G1(o);i.call(d)}}var o=VL(e,r,t,0,null,!1,!1,"",RP);return t._reactRootContainer=o,t[El]=o.current,Zy(t.nodeType===8?t.parentNode:t),of(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=G1(l);a.call(d)}}var l=oI(t,0,!1,null,null,!1,!1,"",RP);return t._reactRootContainer=l,t[El]=l.current,Zy(t.nodeType===8?t.parentNode:t),of(function(){wC(e,l,n,r)}),l}function vC(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=G1(o);a.call(l)}}wC(e,o,t,s)}else o=eK(n,e,t,s,r);return G1(o)}bU=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Q0(e.pendingLanes);n!==0&&(_k(e,n|1),Si(e,dr()),!(en&6)&&(og=dr()+500,gu()))}break;case 13:of(function(){var r=Cl(t,1);if(r!==null){var s=Ks();ya(r,t,1,s)}}),aI(t,1)}};kk=function(t){if(t.tag===13){var e=Cl(t,134217728);if(e!==null){var n=Ks();ya(e,t,134217728,n)}aI(t,134217728)}};vU=function(t){if(t.tag===13){var e=Gd(t),n=Cl(t,e);if(n!==null){var r=Ks();ya(n,t,e,r)}aI(t,e)}};EU=function(){return wn};CU=function(t,e){var n=wn;try{return wn=t,e()}finally{wn=n}};o2=function(t,e,n){switch(e){case"input":if(XS(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=uC(r);if(!s)throw Error(Se(90));eU(r),XS(r,s)}}}break;case"textarea":nU(t,n);break;case"select":e=n.value,e!=null&&Qp(t,!!n.multiple,e,!1)}};lU=nI;dU=of;var tK={usingClientEntryPoint:!1,Events:[Fx,kp,uC,aU,cU,nI]},w0={findFiberByHostInstance:sh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nK={bundleType:w0.bundleType,version:w0.version,rendererPackageName:w0.rendererPackageName,rendererConfig:w0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ol.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=fU(t),t===null?null:t.stateNode},findFiberByHostInstance:w0.findFiberByHostInstance||Xq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Db=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Db.isDisabled&&Db.supportsFiber)try{aC=Db.inject(nK),hc=Db}catch{}}eo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tK;eo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lI(e))throw Error(Se(200));return Zq(t,e,null,n)};eo.createRoot=function(t,e){if(!lI(t))throw Error(Se(299));var n=!1,r="",s=WL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=oI(t,1,!1,null,null,n,!1,r,s),t[El]=e.current,Zy(t.nodeType===8?t.parentNode:t),new cI(e)};eo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Se(188)):(t=Object.keys(t).join(","),Error(Se(268,t)));return t=fU(e),t=t===null?null:t.stateNode,t};eo.flushSync=function(t){return of(t)};eo.hydrate=function(t,e,n){if(!bC(e))throw Error(Se(200));return vC(null,t,e,!0,n)};eo.hydrateRoot=function(t,e,n){if(!lI(t))throw Error(Se(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=WL;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=VL(e,null,t,1,n??null,s,!1,i,o),t[El]=e.current,Zy(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new xC(e)};eo.render=function(t,e,n){if(!bC(e))throw Error(Se(200));return vC(null,t,e,!1,n)};eo.unmountComponentAtNode=function(t){if(!bC(t))throw Error(Se(40));return t._reactRootContainer?(of(function(){vC(null,null,t,!1,function(){t._reactRootContainer=null,t[El]=null})}),!0):!1};eo.unstable_batchedUpdates=nI;eo.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!bC(n))throw Error(Se(200));if(t==null||t._reactInternals===void 0)throw Error(Se(38));return vC(t,e,n,!1,r)};eo.version="18.3.1-next-f1338f8080-20240426";function qL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qL)}catch(t){console.error(t)}}qL(),qM.exports=eo;var dI=qM.exports;const rK=Ug(dI),sK=PM({__proto__:null,default:rK},[dI]);var KL,jP=dI;KL=jP.createRoot,jP.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zn(){return zn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zn.apply(this,arguments)}var gr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gr||(gr={}));const PP="popstate";function iK(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return aw("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:af(s)}return aK(e,n,null,t)}function Mt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ag(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oK(){return Math.random().toString(36).substr(2,8)}function OP(t,e){return{usr:t.state,key:t.key,idx:e}}function aw(t,e,n,r){return n===void 0&&(n=null),zn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?yu(e):e,{state:n,key:e&&e.key||r||oK()})}function af(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function yu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function aK(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=gr.Pop,l=null,d=u();d==null&&(d=0,o.replaceState(zn({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=gr.Pop;let w=u(),b=w==null?null:w-d;d=w,l&&l({action:a,location:g.location,delta:b})}function f(w,b){a=gr.Push;let y=aw(g.location,w,b);d=u()+1;let x=OP(y,d),v=g.createHref(y);try{o.pushState(x,"",v)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(v)}i&&l&&l({action:a,location:g.location,delta:1})}function p(w,b){a=gr.Replace;let y=aw(g.location,w,b);d=u();let x=OP(y,d),v=g.createHref(y);o.replaceState(x,"",v),i&&l&&l({action:a,location:g.location,delta:0})}function m(w){let b=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof w=="string"?w:af(w);return y=y.replace(/ $/,"%20"),Mt(b,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,b)}let g={get action(){return a},get location(){return t(s,o)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(PP,h),l=w,()=>{s.removeEventListener(PP,h),l=null}},createHref(w){return e(s,w)},createURL:m,encodeLocation(w){let b=m(w);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:p,go(w){return o.go(w)}};return g}var yn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(yn||(yn={}));const cK=new Set(["lazy","caseSensitive","path","id","index","children"]);function lK(t){return t.index===!0}function Y1(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],a=typeof s.id=="string"?s.id:o.join("-");if(Mt(s.index!==!0||!s.children,"Cannot specify children on an index route"),Mt(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),lK(s)){let l=zn({},s,e(s),{id:a});return r[a]=l,l}else{let l=zn({},s,e(s),{id:a,children:void 0});return r[a]=l,s.children&&(l.children=Y1(s.children,e,o,r)),l}})}function Vu(t,e,n){return n===void 0&&(n="/"),Hv(t,e,n,!1)}function Hv(t,e,n,r){let s=typeof e=="string"?yu(e):e,i=Fg(s.pathname||"/",n);if(i==null)return null;let o=GL(t);uK(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let d=EK(i);a=bK(o[l],d,r)}return a}function dK(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function GL(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Mt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let d=gl([r,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(Mt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),GL(i.children,e,u,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:wK(d,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of YL(i.path))s(i,o,l)}),e}function YL(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=YL(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function uK(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:xK(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const hK=/^:[\w-]+$/,fK=3,pK=2,mK=1,gK=10,yK=-2,DP=t=>t==="*";function wK(t,e){let n=t.split("/"),r=n.length;return n.some(DP)&&(r+=yK),e&&(r+=pK),n.filter(s=>!DP(s)).reduce((s,i)=>s+(hK.test(i)?fK:i===""?mK:gK),r)}function xK(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function bK(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],d=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=MP({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},u),f=l.route;if(!h&&d&&n&&!r[r.length-1].route.index&&(h=MP({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:gl([i,h.pathname]),pathnameBase:AK(gl([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=gl([i,h.pathnameBase]))}return o}function MP(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=vK(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,u,h)=>{let{paramName:f,isOptional:p}=u;if(f==="*"){let g=a[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const m=a[h];return p&&!m?d[f]=void 0:d[f]=(m||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function vK(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),ag(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function EK(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ag(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Fg(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function CK(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?yu(t):t;return{pathname:n?n.startsWith("/")?n:NK(n,e):e,search:SK(r),hash:TK(s)}}function NK(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function tA(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QL(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function EC(t,e){let n=QL(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function CC(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=yu(t):(s=zn({},t),Mt(!s.pathname||!s.pathname.includes("?"),tA("?","pathname","search",s)),Mt(!s.pathname||!s.pathname.includes("#"),tA("#","pathname","hash",s)),Mt(!s.search||!s.search.includes("#"),tA("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=CK(s,a),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(d||u)&&(l.pathname+="/"),l}const gl=t=>t.join("/").replace(/\/\/+/g,"/"),AK=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),SK=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,TK=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Q1{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function cw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const JL=["post","put","patch","delete"],_K=new Set(JL),kK=["get",...JL],IK=new Set(kK),RK=new Set([301,302,303,307,308]),jK=new Set([307,308]),nA={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},PK={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},x0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},uI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,OK=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),ZL="remix-router-transitions";function DK(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Mt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let W=t.detectErrorBoundary;s=te=>({hasErrorBoundary:W(te)})}else s=OK;let i={},o=Y1(t.routes,s,void 0,i),a,l=t.basename||"/",d=t.dataStrategy||BK,u=t.patchRoutesOnNavigation,h=zn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,p=new Set,m=null,g=null,w=null,b=t.hydrationData!=null,y=Vu(o,t.history.location,l),x=!1,v=null;if(y==null&&!u){let W=hi(404,{pathname:t.history.location.pathname}),{matches:te,route:re}=KP(o);y=te,v={[re.id]:W}}y&&!t.hydrationData&&ka(y,o,t.history.location.pathname).active&&(y=null);let E;if(y)if(y.some(W=>W.route.lazy))E=!1;else if(!y.some(W=>W.route.loader))E=!0;else if(h.v7_partialHydration){let W=t.hydrationData?t.hydrationData.loaderData:null,te=t.hydrationData?t.hydrationData.errors:null;if(te){let re=y.findIndex(ve=>te[ve.route.id]!==void 0);E=y.slice(0,re+1).every(ve=>!$2(ve.route,W,te))}else E=y.every(re=>!$2(re.route,W,te))}else E=t.hydrationData!=null;else if(E=!1,y=[],h.v7_partialHydration){let W=ka(null,o,t.history.location.pathname);W.active&&W.matches&&(x=!0,y=W.matches)}let R,S={historyAction:t.history.action,location:t.history.location,matches:y,initialized:E,navigation:nA,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||v,fetchers:new Map,blockers:new Map},C=gr.Pop,N=!1,T,$=!1,U=new Map,H=null,K=!1,I=!1,j=[],F=new Set,P=new Map,L=0,B=-1,V=new Map,X=new Set,ae=new Map,ce=new Map,ie=new Set,Te=new Map,ue=new Map,Q;function xe(){if(f=t.history.listen(W=>{let{action:te,location:re,delta:ve}=W;if(Q){Q(),Q=void 0;return}ag(ue.size===0||ve!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let De=gb({currentLocation:S.location,nextLocation:re,historyAction:te});if(De&&ve!=null){let ot=new Promise(pt=>{Q=pt});t.history.go(ve*-1),$f(De,{state:"blocked",location:re,proceed(){$f(De,{state:"proceeding",proceed:void 0,reset:void 0,location:re}),ot.then(()=>t.history.go(ve))},reset(){let pt=new Map(S.blockers);pt.set(De,x0),me({blockers:pt})}});return}return Ue(te,re)}),n){XK(e,U);let W=()=>eG(e,U);e.addEventListener("pagehide",W),H=()=>e.removeEventListener("pagehide",W)}return S.initialized||Ue(gr.Pop,S.location,{initialHydration:!0}),R}function Pe(){f&&f(),H&&H(),p.clear(),T&&T.abort(),S.fetchers.forEach((W,te)=>Rc(te)),S.blockers.forEach((W,te)=>Bf(te))}function Y(W){return p.add(W),()=>p.delete(W)}function me(W,te){te===void 0&&(te={}),S=zn({},S,W);let re=[],ve=[];h.v7_fetcherPersist&&S.fetchers.forEach((De,ot)=>{De.state==="idle"&&(ie.has(ot)?ve.push(ot):re.push(ot))}),ie.forEach(De=>{!S.fetchers.has(De)&&!P.has(De)&&ve.push(De)}),[...p].forEach(De=>De(S,{deletedFetchers:ve,viewTransitionOpts:te.viewTransitionOpts,flushSync:te.flushSync===!0})),h.v7_fetcherPersist?(re.forEach(De=>S.fetchers.delete(De)),ve.forEach(De=>Rc(De))):ve.forEach(De=>ie.delete(De))}function le(W,te,re){var ve,De;let{flushSync:ot}=re===void 0?{}:re,pt=S.actionData!=null&&S.navigation.formMethod!=null&&ca(S.navigation.formMethod)&&S.navigation.state==="loading"&&((ve=W.state)==null?void 0:ve._isRedirect)!==!0,Xe;te.actionData?Object.keys(te.actionData).length>0?Xe=te.actionData:Xe=null:pt?Xe=S.actionData:Xe=null;let et=te.loaderData?WP(S.loaderData,te.loaderData,te.matches||[],te.errors):S.loaderData,ze=S.blockers;ze.size>0&&(ze=new Map(ze),ze.forEach((jt,pr)=>ze.set(pr,x0)));let st=N===!0||S.navigation.formMethod!=null&&ca(S.navigation.formMethod)&&((De=W.state)==null?void 0:De._isRedirect)!==!0;a&&(o=a,a=void 0),K||C===gr.Pop||(C===gr.Push?t.history.push(W,W.state):C===gr.Replace&&t.history.replace(W,W.state));let Et;if(C===gr.Pop){let jt=U.get(S.location.pathname);jt&&jt.has(W.pathname)?Et={currentLocation:S.location,nextLocation:W}:U.has(W.pathname)&&(Et={currentLocation:W,nextLocation:S.location})}else if($){let jt=U.get(S.location.pathname);jt?jt.add(W.pathname):(jt=new Set([W.pathname]),U.set(S.location.pathname,jt)),Et={currentLocation:S.location,nextLocation:W}}me(zn({},te,{actionData:Xe,loaderData:et,historyAction:C,location:W,initialized:!0,navigation:nA,revalidation:"idle",restoreScrollPosition:Au(W,te.matches||S.matches),preventScrollReset:st,blockers:ze}),{viewTransitionOpts:Et,flushSync:ot===!0}),C=gr.Pop,N=!1,$=!1,K=!1,I=!1,j=[]}async function tt(W,te){if(typeof W=="number"){t.history.go(W);return}let re=B2(S.location,S.matches,l,h.v7_prependBasename,W,h.v7_relativeSplatPath,te==null?void 0:te.fromRouteId,te==null?void 0:te.relative),{path:ve,submission:De,error:ot}=UP(h.v7_normalizeFormMethod,!1,re,te),pt=S.location,Xe=aw(S.location,ve,te&&te.state);Xe=zn({},Xe,t.history.encodeLocation(Xe));let et=te&&te.replace!=null?te.replace:void 0,ze=gr.Push;et===!0?ze=gr.Replace:et===!1||De!=null&&ca(De.formMethod)&&De.formAction===S.location.pathname+S.location.search&&(ze=gr.Replace);let st=te&&"preventScrollReset"in te?te.preventScrollReset===!0:void 0,Et=(te&&te.flushSync)===!0,jt=gb({currentLocation:pt,nextLocation:Xe,historyAction:ze});if(jt){$f(jt,{state:"blocked",location:Xe,proceed(){$f(jt,{state:"proceeding",proceed:void 0,reset:void 0,location:Xe}),tt(W,te)},reset(){let pr=new Map(S.blockers);pr.set(jt,x0),me({blockers:pr})}});return}return await Ue(ze,Xe,{submission:De,pendingError:ot,preventScrollReset:st,replace:te&&te.replace,enableViewTransition:te&&te.viewTransition,flushSync:Et})}function Ve(){if(ro(),me({revalidation:"loading"}),S.navigation.state!=="submitting"){if(S.navigation.state==="idle"){Ue(S.historyAction,S.location,{startUninterruptedRevalidation:!0});return}Ue(C||S.historyAction,S.navigation.location,{overrideNavigation:S.navigation,enableViewTransition:$===!0})}}async function Ue(W,te,re){T&&T.abort(),T=null,C=W,K=(re&&re.startUninterruptedRevalidation)===!0,AN(S.location,S.matches),N=(re&&re.preventScrollReset)===!0,$=(re&&re.enableViewTransition)===!0;let ve=a||o,De=re&&re.overrideNavigation,ot=re!=null&&re.initialHydration&&S.matches&&S.matches.length>0&&!x?S.matches:Vu(ve,te,l),pt=(re&&re.flushSync)===!0;if(ot&&S.initialized&&!I&&WK(S.location,te)&&!(re&&re.submission&&ca(re.submission.formMethod))){le(te,{matches:ot},{flushSync:pt});return}let Xe=ka(ot,ve,te.pathname);if(Xe.active&&Xe.matches&&(ot=Xe.matches),!ot){let{error:mn,notFoundMatches:Bt,route:_}=a0(te.pathname);le(te,{matches:Bt,loaderData:{},errors:{[_.id]:mn}},{flushSync:pt});return}T=new AbortController;let et=Hf(t.history,te,T.signal,re&&re.submission),ze;if(re&&re.pendingError)ze=[Wu(ot).route.id,{type:yn.error,error:re.pendingError}];else if(re&&re.submission&&ca(re.submission.formMethod)){let mn=await pe(et,te,re.submission,ot,Xe.active,{replace:re.replace,flushSync:pt});if(mn.shortCircuited)return;if(mn.pendingActionResult){let[Bt,_]=mn.pendingActionResult;if(Vi(_)&&cw(_.error)&&_.error.status===404){T=null,le(te,{matches:mn.matches,loaderData:{},errors:{[Bt]:_.error}});return}}ot=mn.matches||ot,ze=mn.pendingActionResult,De=rA(te,re.submission),pt=!1,Xe.active=!1,et=Hf(t.history,et.url,et.signal)}let{shortCircuited:st,matches:Et,loaderData:jt,errors:pr}=await it(et,te,ot,Xe.active,De,re&&re.submission,re&&re.fetcherSubmission,re&&re.replace,re&&re.initialHydration===!0,pt,ze);st||(T=null,le(te,zn({matches:Et||ot},qP(ze),{loaderData:jt,errors:pr})))}async function pe(W,te,re,ve,De,ot){ot===void 0&&(ot={}),ro();let pt=JK(te,re);if(me({navigation:pt},{flushSync:ot.flushSync===!0}),De){let ze=await Ff(ve,te.pathname,W.signal);if(ze.type==="aborted")return{shortCircuited:!0};if(ze.type==="error"){let st=Wu(ze.partialMatches).route.id;return{matches:ze.partialMatches,pendingActionResult:[st,{type:yn.error,error:ze.error}]}}else if(ze.matches)ve=ze.matches;else{let{notFoundMatches:st,error:Et,route:jt}=a0(te.pathname);return{matches:st,pendingActionResult:[jt.id,{type:yn.error,error:Et}]}}}let Xe,et=Z0(ve,te);if(!et.route.action&&!et.route.lazy)Xe={type:yn.error,error:hi(405,{method:W.method,pathname:te.pathname,routeId:et.route.id})};else if(Xe=(await ft("action",S,W,[et],ve,null))[et.route.id],W.signal.aborted)return{shortCircuited:!0};if(ah(Xe)){let ze;return ot&&ot.replace!=null?ze=ot.replace:ze=zP(Xe.response.headers.get("Location"),new URL(W.url),l)===S.location.pathname+S.location.search,await wt(W,Xe,!0,{submission:re,replace:ze}),{shortCircuited:!0}}if(Bd(Xe))throw hi(400,{type:"defer-action"});if(Vi(Xe)){let ze=Wu(ve,et.route.id);return(ot&&ot.replace)!==!0&&(C=gr.Push),{matches:ve,pendingActionResult:[ze.route.id,Xe]}}return{matches:ve,pendingActionResult:[et.route.id,Xe]}}async function it(W,te,re,ve,De,ot,pt,Xe,et,ze,st){let Et=De||rA(te,ot),jt=ot||pt||YP(Et),pr=!K&&(!h.v7_partialHydration||!et);if(ve){if(pr){let mt=An(st);me(zn({navigation:Et},mt!==void 0?{actionData:mt}:{}),{flushSync:ze})}let Ae=await Ff(re,te.pathname,W.signal);if(Ae.type==="aborted")return{shortCircuited:!0};if(Ae.type==="error"){let mt=Wu(Ae.partialMatches).route.id;return{matches:Ae.partialMatches,loaderData:{},errors:{[mt]:Ae.error}}}else if(Ae.matches)re=Ae.matches;else{let{error:mt,notFoundMatches:fs,route:Ia}=a0(te.pathname);return{matches:fs,loaderData:{},errors:{[Ia.id]:mt}}}}let mn=a||o,[Bt,_]=BP(t.history,S,re,jt,te,h.v7_partialHydration&&et===!0,h.v7_skipActionErrorRevalidation,I,j,F,ie,ae,X,mn,l,st);if(c0(Ae=>!(re&&re.some(mt=>mt.route.id===Ae))||Bt&&Bt.some(mt=>mt.route.id===Ae)),B=++L,Bt.length===0&&_.length===0){let Ae=Nu();return le(te,zn({matches:re,loaderData:{},errors:st&&Vi(st[1])?{[st[0]]:st[1].error}:null},qP(st),Ae?{fetchers:new Map(S.fetchers)}:{}),{flushSync:ze}),{shortCircuited:!0}}if(pr){let Ae={};if(!ve){Ae.navigation=Et;let mt=An(st);mt!==void 0&&(Ae.actionData=mt)}_.length>0&&(Ae.fetchers=nt(_)),me(Ae,{flushSync:ze})}_.forEach(Ae=>{Xs(Ae.key),Ae.controller&&P.set(Ae.key,Ae.controller)});let G=()=>_.forEach(Ae=>Xs(Ae.key));T&&T.signal.addEventListener("abort",G);let{loaderResults:J,fetcherResults:de}=await Rn(S,re,Bt,_,W);if(W.signal.aborted)return{shortCircuited:!0};T&&T.signal.removeEventListener("abort",G),_.forEach(Ae=>P.delete(Ae.key));let oe=Mb(J);if(oe)return await wt(W,oe.result,!0,{replace:Xe}),{shortCircuited:!0};if(oe=Mb(de),oe)return X.add(oe.key),await wt(W,oe.result,!0,{replace:Xe}),{shortCircuited:!0};let{loaderData:he,errors:Ee}=VP(S,re,J,st,_,de,Te);Te.forEach((Ae,mt)=>{Ae.subscribe(fs=>{(fs||Ae.done)&&Te.delete(mt)})}),h.v7_partialHydration&&et&&S.errors&&(Ee=zn({},S.errors,Ee));let je=Nu(),be=_a(B),we=je||be||_.length>0;return zn({matches:re,loaderData:he,errors:Ee},we?{fetchers:new Map(S.fetchers)}:{})}function An(W){if(W&&!Vi(W[1]))return{[W[0]]:W[1].data};if(S.actionData)return Object.keys(S.actionData).length===0?null:S.actionData}function nt(W){return W.forEach(te=>{let re=S.fetchers.get(te.key),ve=b0(void 0,re?re.data:void 0);S.fetchers.set(te.key,ve)}),new Map(S.fetchers)}function bn(W,te,re,ve){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Xs(W);let De=(ve&&ve.flushSync)===!0,ot=a||o,pt=B2(S.location,S.matches,l,h.v7_prependBasename,re,h.v7_relativeSplatPath,te,ve==null?void 0:ve.relative),Xe=Vu(ot,pt,l),et=ka(Xe,ot,pt);if(et.active&&et.matches&&(Xe=et.matches),!Xe){or(W,te,hi(404,{pathname:pt}),{flushSync:De});return}let{path:ze,submission:st,error:Et}=UP(h.v7_normalizeFormMethod,!0,pt,ve);if(Et){or(W,te,Et,{flushSync:De});return}let jt=Z0(Xe,ze),pr=(ve&&ve.preventScrollReset)===!0;if(st&&ca(st.formMethod)){Fe(W,te,ze,jt,Xe,et.active,De,pr,st);return}ae.set(W,{routeId:te,path:ze}),ct(W,te,ze,jt,Xe,et.active,De,pr,st)}async function Fe(W,te,re,ve,De,ot,pt,Xe,et){ro(),ae.delete(W);function ze(vn){if(!vn.route.action&&!vn.route.lazy){let Mr=hi(405,{method:et.formMethod,pathname:re,routeId:te});return or(W,te,Mr,{flushSync:pt}),!0}return!1}if(!ot&&ze(ve))return;let st=S.fetchers.get(W);Gt(W,ZK(et,st),{flushSync:pt});let Et=new AbortController,jt=Hf(t.history,re,Et.signal,et);if(ot){let vn=await Ff(De,new URL(jt.url).pathname,jt.signal,W);if(vn.type==="aborted")return;if(vn.type==="error"){or(W,te,vn.error,{flushSync:pt});return}else if(vn.matches){if(De=vn.matches,ve=Z0(De,re),ze(ve))return}else{or(W,te,hi(404,{pathname:re}),{flushSync:pt});return}}P.set(W,Et);let pr=L,Bt=(await ft("action",S,jt,[ve],De,W))[ve.route.id];if(jt.signal.aborted){P.get(W)===Et&&P.delete(W);return}if(h.v7_fetcherPersist&&ie.has(W)){if(ah(Bt)||Vi(Bt)){Gt(W,nd(void 0));return}}else{if(ah(Bt))if(P.delete(W),B>pr){Gt(W,nd(void 0));return}else return X.add(W),Gt(W,b0(et)),wt(jt,Bt,!1,{fetcherSubmission:et,preventScrollReset:Xe});if(Vi(Bt)){or(W,te,Bt.error);return}}if(Bd(Bt))throw hi(400,{type:"defer-action"});let _=S.navigation.location||S.location,G=Hf(t.history,_,Et.signal),J=a||o,de=S.navigation.state!=="idle"?Vu(J,S.navigation.location,l):S.matches;Mt(de,"Didn't find any matches after fetcher action");let oe=++L;V.set(W,oe);let he=b0(et,Bt.data);S.fetchers.set(W,he);let[Ee,je]=BP(t.history,S,de,et,_,!1,h.v7_skipActionErrorRevalidation,I,j,F,ie,ae,X,J,l,[ve.route.id,Bt]);je.filter(vn=>vn.key!==W).forEach(vn=>{let Mr=vn.key,Su=S.fetchers.get(Mr),Tu=b0(void 0,Su?Su.data:void 0);S.fetchers.set(Mr,Tu),Xs(Mr),vn.controller&&P.set(Mr,vn.controller)}),me({fetchers:new Map(S.fetchers)});let be=()=>je.forEach(vn=>Xs(vn.key));Et.signal.addEventListener("abort",be);let{loaderResults:we,fetcherResults:Ae}=await Rn(S,de,Ee,je,G);if(Et.signal.aborted)return;Et.signal.removeEventListener("abort",be),V.delete(W),P.delete(W),je.forEach(vn=>P.delete(vn.key));let mt=Mb(we);if(mt)return wt(G,mt.result,!1,{preventScrollReset:Xe});if(mt=Mb(Ae),mt)return X.add(mt.key),wt(G,mt.result,!1,{preventScrollReset:Xe});let{loaderData:fs,errors:Ia}=VP(S,de,we,void 0,je,Ae,Te);if(S.fetchers.has(W)){let vn=nd(Bt.data);S.fetchers.set(W,vn)}_a(oe),S.navigation.state==="loading"&&oe>B?(Mt(C,"Expected pending action"),T&&T.abort(),le(S.navigation.location,{matches:de,loaderData:fs,errors:Ia,fetchers:new Map(S.fetchers)})):(me({errors:Ia,loaderData:WP(S.loaderData,fs,de,Ia),fetchers:new Map(S.fetchers)}),I=!1)}async function ct(W,te,re,ve,De,ot,pt,Xe,et){let ze=S.fetchers.get(W);Gt(W,b0(et,ze?ze.data:void 0),{flushSync:pt});let st=new AbortController,Et=Hf(t.history,re,st.signal);if(ot){let Bt=await Ff(De,new URL(Et.url).pathname,Et.signal,W);if(Bt.type==="aborted")return;if(Bt.type==="error"){or(W,te,Bt.error,{flushSync:pt});return}else if(Bt.matches)De=Bt.matches,ve=Z0(De,re);else{or(W,te,hi(404,{pathname:re}),{flushSync:pt});return}}P.set(W,st);let jt=L,mn=(await ft("loader",S,Et,[ve],De,W))[ve.route.id];if(Bd(mn)&&(mn=await hI(mn,Et.signal,!0)||mn),P.get(W)===st&&P.delete(W),!Et.signal.aborted){if(ie.has(W)){Gt(W,nd(void 0));return}if(ah(mn))if(B>jt){Gt(W,nd(void 0));return}else{X.add(W),await wt(Et,mn,!1,{preventScrollReset:Xe});return}if(Vi(mn)){or(W,te,mn.error);return}Mt(!Bd(mn),"Unhandled fetcher deferred data"),Gt(W,nd(mn.data))}}async function wt(W,te,re,ve){let{submission:De,fetcherSubmission:ot,preventScrollReset:pt,replace:Xe}=ve===void 0?{}:ve;te.response.headers.has("X-Remix-Revalidate")&&(I=!0);let et=te.response.headers.get("Location");Mt(et,"Expected a Location header on the redirect Response"),et=zP(et,new URL(W.url),l);let ze=aw(S.location,et,{_isRedirect:!0});if(n){let Bt=!1;if(te.response.headers.has("X-Remix-Reload-Document"))Bt=!0;else if(uI.test(et)){const _=t.history.createURL(et);Bt=_.origin!==e.location.origin||Fg(_.pathname,l)==null}if(Bt){Xe?e.location.replace(et):e.location.assign(et);return}}T=null;let st=Xe===!0||te.response.headers.has("X-Remix-Replace")?gr.Replace:gr.Push,{formMethod:Et,formAction:jt,formEncType:pr}=S.navigation;!De&&!ot&&Et&&jt&&pr&&(De=YP(S.navigation));let mn=De||ot;if(jK.has(te.response.status)&&mn&&ca(mn.formMethod))await Ue(st,ze,{submission:zn({},mn,{formAction:et}),preventScrollReset:pt||N,enableViewTransition:re?$:void 0});else{let Bt=rA(ze,De);await Ue(st,ze,{overrideNavigation:Bt,fetcherSubmission:ot,preventScrollReset:pt||N,enableViewTransition:re?$:void 0})}}async function ft(W,te,re,ve,De,ot){let pt,Xe={};try{pt=await $K(d,W,te,re,ve,De,ot,i,s)}catch(et){return ve.forEach(ze=>{Xe[ze.route.id]={type:yn.error,error:et}}),Xe}for(let[et,ze]of Object.entries(pt))if(qK(ze)){let st=ze.result;Xe[et]={type:yn.redirect,response:HK(st,re,et,De,l,h.v7_relativeSplatPath)}}else Xe[et]=await zK(ze);return Xe}async function Rn(W,te,re,ve,De){let ot=W.matches,pt=ft("loader",W,De,re,te,null),Xe=Promise.all(ve.map(async st=>{if(st.matches&&st.match&&st.controller){let jt=(await ft("loader",W,Hf(t.history,st.path,st.controller.signal),[st.match],st.matches,st.key))[st.match.route.id];return{[st.key]:jt}}else return Promise.resolve({[st.key]:{type:yn.error,error:hi(404,{pathname:st.path})}})})),et=await pt,ze=(await Xe).reduce((st,Et)=>Object.assign(st,Et),{});return await Promise.all([YK(te,et,De.signal,ot,W.loaderData),QK(te,ze,ve)]),{loaderResults:et,fetcherResults:ze}}function ro(){I=!0,j.push(...c0()),ae.forEach((W,te)=>{P.has(te)&&F.add(te),Xs(te)})}function Gt(W,te,re){re===void 0&&(re={}),S.fetchers.set(W,te),me({fetchers:new Map(S.fetchers)},{flushSync:(re&&re.flushSync)===!0})}function or(W,te,re,ve){ve===void 0&&(ve={});let De=Wu(S.matches,te);Rc(W),me({errors:{[De.route.id]:re},fetchers:new Map(S.fetchers)},{flushSync:(ve&&ve.flushSync)===!0})}function Ic(W){return ce.set(W,(ce.get(W)||0)+1),ie.has(W)&&ie.delete(W),S.fetchers.get(W)||PK}function Rc(W){let te=S.fetchers.get(W);P.has(W)&&!(te&&te.state==="loading"&&V.has(W))&&Xs(W),ae.delete(W),V.delete(W),X.delete(W),h.v7_fetcherPersist&&ie.delete(W),F.delete(W),S.fetchers.delete(W)}function Ml(W){let te=(ce.get(W)||0)-1;te<=0?(ce.delete(W),ie.add(W),h.v7_fetcherPersist||Rc(W)):ce.set(W,te),me({fetchers:new Map(S.fetchers)})}function Xs(W){let te=P.get(W);te&&(te.abort(),P.delete(W))}function ei(W){for(let te of W){let re=Ic(te),ve=nd(re.data);S.fetchers.set(te,ve)}}function Nu(){let W=[],te=!1;for(let re of X){let ve=S.fetchers.get(re);Mt(ve,"Expected fetcher: "+re),ve.state==="loading"&&(X.delete(re),W.push(re),te=!0)}return ei(W),te}function _a(W){let te=[];for(let[re,ve]of V)if(ve<W){let De=S.fetchers.get(re);Mt(De,"Expected fetcher: "+re),De.state==="loading"&&(Xs(re),V.delete(re),te.push(re))}return ei(te),te.length>0}function qr(W,te){let re=S.blockers.get(W)||x0;return ue.get(W)!==te&&ue.set(W,te),re}function Bf(W){S.blockers.delete(W),ue.delete(W)}function $f(W,te){let re=S.blockers.get(W)||x0;Mt(re.state==="unblocked"&&te.state==="blocked"||re.state==="blocked"&&te.state==="blocked"||re.state==="blocked"&&te.state==="proceeding"||re.state==="blocked"&&te.state==="unblocked"||re.state==="proceeding"&&te.state==="unblocked","Invalid blocker state transition: "+re.state+" -> "+te.state);let ve=new Map(S.blockers);ve.set(W,te),me({blockers:ve})}function gb(W){let{currentLocation:te,nextLocation:re,historyAction:ve}=W;if(ue.size===0)return;ue.size>1&&ag(!1,"A router only supports one blocker at a time");let De=Array.from(ue.entries()),[ot,pt]=De[De.length-1],Xe=S.blockers.get(ot);if(!(Xe&&Xe.state==="proceeding")&&pt({currentLocation:te,nextLocation:re,historyAction:ve}))return ot}function a0(W){let te=hi(404,{pathname:W}),re=a||o,{matches:ve,route:De}=KP(re);return c0(),{notFoundMatches:ve,route:De,error:te}}function c0(W){let te=[];return Te.forEach((re,ve)=>{(!W||W(ve))&&(re.cancel(),te.push(ve),Te.delete(ve))}),te}function NN(W,te,re){if(m=W,w=te,g=re||null,!b&&S.navigation===nA){b=!0;let ve=Au(S.location,S.matches);ve!=null&&me({restoreScrollPosition:ve})}return()=>{m=null,w=null,g=null}}function yb(W,te){return g&&g(W,te.map(ve=>dK(ve,S.loaderData)))||W.key}function AN(W,te){if(m&&w){let re=yb(W,te);m[re]=w()}}function Au(W,te){if(m){let re=yb(W,te),ve=m[re];if(typeof ve=="number")return ve}return null}function ka(W,te,re){if(u)if(W){if(Object.keys(W[0].params).length>0)return{active:!0,matches:Hv(te,re,l,!0)}}else return{active:!0,matches:Hv(te,re,l,!0)||[]};return{active:!1,matches:null}}async function Ff(W,te,re,ve){if(!u)return{type:"success",matches:W};let De=W;for(;;){let ot=a==null,pt=a||o,Xe=i;try{await u({signal:re,path:te,matches:De,fetcherKey:ve,patch:(st,Et)=>{re.aborted||FP(st,Et,pt,Xe,s)}})}catch(st){return{type:"error",error:st,partialMatches:De}}finally{ot&&!re.aborted&&(o=[...o])}if(re.aborted)return{type:"aborted"};let et=Vu(pt,te,l);if(et)return{type:"success",matches:et};let ze=Hv(pt,te,l,!0);if(!ze||De.length===ze.length&&De.every((st,Et)=>st.route.id===ze[Et].route.id))return{type:"success",matches:null};De=ze}}function SN(W){i={},a=Y1(W,s,void 0,i)}function TN(W,te){let re=a==null;FP(W,te,a||o,i,s),re&&(o=[...o],me({}))}return R={get basename(){return l},get future(){return h},get state(){return S},get routes(){return o},get window(){return e},initialize:xe,subscribe:Y,enableScrollRestoration:NN,navigate:tt,fetch:bn,revalidate:Ve,createHref:W=>t.history.createHref(W),encodeLocation:W=>t.history.encodeLocation(W),getFetcher:Ic,deleteFetcher:Ml,dispose:Pe,getBlocker:qr,deleteBlocker:Bf,patchRoutes:TN,_internalFetchControllers:P,_internalActiveDeferreds:Te,_internalSetRoutes:SN},R}function MK(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function B2(t,e,n,r,s,i,o,a){let l,d;if(o){l=[];for(let h of e)if(l.push(h),h.route.id===o){d=h;break}}else l=e,d=e[e.length-1];let u=CC(s||".",EC(l,i),Fg(t.pathname,n)||t.pathname,a==="path");if(s==null&&(u.search=t.search,u.hash=t.hash),(s==null||s===""||s===".")&&d){let h=fI(u.search);if(d.route.index&&!h)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!d.route.index&&h){let f=new URLSearchParams(u.search),p=f.getAll("index");f.delete("index"),p.filter(g=>g).forEach(g=>f.append("index",g));let m=f.toString();u.search=m?"?"+m:""}}return r&&n!=="/"&&(u.pathname=u.pathname==="/"?n:gl([n,u.pathname])),af(u)}function UP(t,e,n,r){if(!r||!MK(r))return{path:n};if(r.formMethod&&!GK(r.formMethod))return{path:n,error:hi(405,{method:r.formMethod})};let s=()=>({path:n,error:hi(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),a=tB(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!ca(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((p,m)=>{let[g,w]=m;return""+p+g+"="+w+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!ca(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}Mt(typeof FormData=="function","FormData is not available in this environment");let l,d;if(r.formData)l=F2(r.formData),d=r.formData;else if(r.body instanceof FormData)l=F2(r.body),d=r.body;else if(r.body instanceof URLSearchParams)l=r.body,d=HP(l);else if(r.body==null)l=new URLSearchParams,d=new FormData;else try{l=new URLSearchParams(r.body),d=HP(l)}catch{return s()}let u={formMethod:o,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:d,json:void 0,text:void 0};if(ca(u.formMethod))return{path:n,submission:u};let h=yu(n);return e&&h.search&&fI(h.search)&&l.append("index",""),h.search="?"+l,{path:af(h),submission:u}}function LP(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function BP(t,e,n,r,s,i,o,a,l,d,u,h,f,p,m,g){let w=g?Vi(g[1])?g[1].error:g[1].data:void 0,b=t.createURL(e.location),y=t.createURL(s),x=n;i&&e.errors?x=LP(n,Object.keys(e.errors)[0],!0):g&&Vi(g[1])&&(x=LP(n,g[0]));let v=g?g[1].statusCode:void 0,E=o&&v&&v>=400,R=x.filter((C,N)=>{let{route:T}=C;if(T.lazy)return!0;if(T.loader==null)return!1;if(i)return $2(T,e.loaderData,e.errors);if(UK(e.loaderData,e.matches[N],C)||l.some(H=>H===C.route.id))return!0;let $=e.matches[N],U=C;return $P(C,zn({currentUrl:b,currentParams:$.params,nextUrl:y,nextParams:U.params},r,{actionResult:w,actionStatus:v,defaultShouldRevalidate:E?!1:a||b.pathname+b.search===y.pathname+y.search||b.search!==y.search||XL($,U)}))}),S=[];return h.forEach((C,N)=>{if(i||!n.some(K=>K.route.id===C.routeId)||u.has(N))return;let T=Vu(p,C.path,m);if(!T){S.push({key:N,routeId:C.routeId,path:C.path,matches:null,match:null,controller:null});return}let $=e.fetchers.get(N),U=Z0(T,C.path),H=!1;f.has(N)?H=!1:d.has(N)?(d.delete(N),H=!0):$&&$.state!=="idle"&&$.data===void 0?H=a:H=$P(U,zn({currentUrl:b,currentParams:e.matches[e.matches.length-1].params,nextUrl:y,nextParams:n[n.length-1].params},r,{actionResult:w,actionStatus:v,defaultShouldRevalidate:E?!1:a})),H&&S.push({key:N,routeId:C.routeId,path:C.path,matches:T,match:U,controller:new AbortController})}),[R,S]}function $2(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function UK(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function XL(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function $P(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function FP(t,e,n,r,s){var i;let o;if(t){let d=r[t];Mt(d,"No route found to patch children into: routeId = "+t),d.children||(d.children=[]),o=d.children}else o=n;let a=e.filter(d=>!o.some(u=>eB(d,u))),l=Y1(a,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...l)}function eB(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>eB(n,i))}):!1}async function LK(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];Mt(s,"No route found in manifest");let i={};for(let o in r){let l=s[o]!==void 0&&o!=="hasErrorBoundary";ag(!l,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!l&&!cK.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,zn({},e(s),{lazy:void 0}))}async function BK(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function $K(t,e,n,r,s,i,o,a,l,d){let u=i.map(p=>p.route.lazy?LK(p.route,l,a):void 0),h=i.map((p,m)=>{let g=u[m],w=s.some(y=>y.route.id===p.route.id);return zn({},p,{shouldLoad:w,resolve:async y=>(y&&r.method==="GET"&&(p.route.lazy||p.route.loader)&&(w=!0),w?FK(e,r,p,g,y,d):Promise.resolve({type:yn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:d});try{await Promise.all(u)}catch{}return f}async function FK(t,e,n,r,s,i){let o,a,l=d=>{let u,h=new Promise((m,g)=>u=g);a=()=>u(),e.signal.addEventListener("abort",a);let f=m=>typeof d!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):d({request:e,params:n.params,context:i},...m!==void 0?[m]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(g=>f(g)):f())}}catch(m){return{type:"error",result:m}}})();return Promise.race([p,h])};try{let d=n.route[t];if(r)if(d){let u,[h]=await Promise.all([l(d).catch(f=>{u=f}),r]);if(u!==void 0)throw u;o=h}else if(await r,d=n.route[t],d)o=await l(d);else if(t==="action"){let u=new URL(e.url),h=u.pathname+u.search;throw hi(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:yn.data,result:void 0};else if(d)o=await l(d);else{let u=new URL(e.url),h=u.pathname+u.search;throw hi(404,{pathname:h})}Mt(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(d){return{type:yn.error,result:d}}finally{a&&e.signal.removeEventListener("abort",a)}return o}async function zK(t){let{result:e,type:n}=t;if(nB(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:yn.error,error:f}}return n===yn.error?{type:yn.error,error:new Q1(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:yn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===yn.error){if(GP(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:yn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:yn.error,error:new Q1(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:cw(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:yn.error,error:e,statusCode:cw(e)?e.status:void 0}}if(KK(e)){var a,l;return{type:yn.deferred,deferredData:e,statusCode:(a=e.init)==null?void 0:a.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(GP(e)){var d,u;return{type:yn.data,data:e.data,statusCode:(d=e.init)==null?void 0:d.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:yn.data,data:e}}function HK(t,e,n,r,s,i){let o=t.headers.get("Location");if(Mt(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!uI.test(o)){let a=r.slice(0,r.findIndex(l=>l.route.id===n)+1);o=B2(new URL(e.url),a,s,!0,o,i),t.headers.set("Location",o)}return t}function zP(t,e,n){if(uI.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=Fg(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Hf(t,e,n,r){let s=t.createURL(tB(e)).toString(),i={signal:n};if(r&&ca(r.formMethod)){let{formMethod:o,formEncType:a}=r;i.method=o.toUpperCase(),a==="application/json"?(i.headers=new Headers({"Content-Type":a}),i.body=JSON.stringify(r.json)):a==="text/plain"?i.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?i.body=F2(r.formData):i.body=r.formData}return new Request(s,i)}function F2(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function HP(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function VK(t,e,n,r,s){let i={},o=null,a,l=!1,d={},u=n&&Vi(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,p=e[f];if(Mt(!ah(p),"Cannot handle redirect results in processLoaderData"),Vi(p)){let m=p.error;u!==void 0&&(m=u,u=void 0),o=o||{};{let g=Wu(t,f);o[g.route.id]==null&&(o[g.route.id]=m)}i[f]=void 0,l||(l=!0,a=cw(p.error)?p.error.status:500),p.headers&&(d[f]=p.headers)}else Bd(p)?(r.set(f,p.deferredData),i[f]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(a=p.statusCode),p.headers&&(d[f]=p.headers)):(i[f]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(a=p.statusCode),p.headers&&(d[f]=p.headers))}),u!==void 0&&n&&(o={[n[0]]:u},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:a||200,loaderHeaders:d}}function VP(t,e,n,r,s,i,o){let{loaderData:a,errors:l}=VK(e,n,r,o);return s.forEach(d=>{let{key:u,match:h,controller:f}=d,p=i[u];if(Mt(p,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(Vi(p)){let m=Wu(t.matches,h==null?void 0:h.route.id);l&&l[m.route.id]||(l=zn({},l,{[m.route.id]:p.error})),t.fetchers.delete(u)}else if(ah(p))Mt(!1,"Unhandled fetcher revalidation redirect");else if(Bd(p))Mt(!1,"Unhandled fetcher deferred data");else{let m=nd(p.data);t.fetchers.set(u,m)}}),{loaderData:a,errors:l}}function WP(t,e,n,r){let s=zn({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function qP(t){return t?Vi(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Wu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function KP(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function hi(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,a="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(a="Bad Request",s&&n&&r?l="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?l="defer() is not supported in actions":i==="invalid-body"&&(l="Unable to encode submission body")):t===403?(a="Forbidden",l='Route "'+r+'" does not match URL "'+n+'"'):t===404?(a="Not Found",l='No route matches URL "'+n+'"'):t===405&&(a="Method Not Allowed",s&&n&&r?l="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Q1(t||500,a,new Error(l),!0)}function Mb(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(ah(s))return{key:r,result:s}}}function tB(t){let e=typeof t=="string"?yu(t):t;return af(zn({},e,{hash:""}))}function WK(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function qK(t){return nB(t.result)&&RK.has(t.result.status)}function Bd(t){return t.type===yn.deferred}function Vi(t){return t.type===yn.error}function ah(t){return(t&&t.type)===yn.redirect}function GP(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function KK(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function nB(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function GK(t){return IK.has(t.toLowerCase())}function ca(t){return _K.has(t.toLowerCase())}async function YK(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[a,l]=i[o],d=t.find(f=>(f==null?void 0:f.route.id)===a);if(!d)continue;let u=r.find(f=>f.route.id===d.route.id),h=u!=null&&!XL(u,d)&&(s&&s[d.route.id])!==void 0;Bd(l)&&h&&await hI(l,n,!1).then(f=>{f&&(e[a]=f)})}}async function QK(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],a=e[s];t.find(d=>(d==null?void 0:d.route.id)===i)&&Bd(a)&&(Mt(o,"Expected an AbortController for revalidating fetcher deferred result"),await hI(a,o.signal,!0).then(d=>{d&&(e[s]=d)}))}}async function hI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:yn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:yn.error,error:s}}return{type:yn.data,data:t.deferredData.data}}}function fI(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Z0(t,e){let n=typeof e=="string"?yu(e).search:e.search;if(t[t.length-1].route.index&&fI(n||""))return t[t.length-1];let r=QL(t);return r[r.length-1]}function YP(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function rA(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function JK(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function b0(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function ZK(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function nd(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function XK(t,e){try{let n=t.sessionStorage.getItem(ZL);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function eG(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(ZL,JSON.stringify(n))}catch(r){ag(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function J1(){return J1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},J1.apply(this,arguments)}const NC=A.createContext(null),rB=A.createContext(null),wu=A.createContext(null),pI=A.createContext(null),kc=A.createContext({outlet:null,matches:[],isDataRoute:!1}),sB=A.createContext(null);function tG(t,e){let{relative:n}=e===void 0?{}:e;zg()||Mt(!1);let{basename:r,navigator:s}=A.useContext(wu),{hash:i,pathname:o,search:a}=oB(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:gl([r,o])),s.createHref({pathname:l,search:a,hash:i})}function zg(){return A.useContext(pI)!=null}function xu(){return zg()||Mt(!1),A.useContext(pI).location}function iB(t){A.useContext(wu).static||A.useLayoutEffect(t)}function Os(){let{isDataRoute:t}=A.useContext(kc);return t?mG():nG()}function nG(){zg()||Mt(!1);let t=A.useContext(NC),{basename:e,future:n,navigator:r}=A.useContext(wu),{matches:s}=A.useContext(kc),{pathname:i}=xu(),o=JSON.stringify(EC(s,n.v7_relativeSplatPath)),a=A.useRef(!1);return iB(()=>{a.current=!0}),A.useCallback(function(d,u){if(u===void 0&&(u={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let h=CC(d,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:gl([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,t])}const rG=A.createContext(null);function sG(t){let e=A.useContext(kc).outlet;return e&&A.createElement(rG.Provider,{value:t},e)}function AC(){let{matches:t}=A.useContext(kc),e=t[t.length-1];return e?e.params:{}}function oB(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=A.useContext(wu),{matches:s}=A.useContext(kc),{pathname:i}=xu(),o=JSON.stringify(EC(s,r.v7_relativeSplatPath));return A.useMemo(()=>CC(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function iG(t,e,n,r){zg()||Mt(!1);let{navigator:s}=A.useContext(wu),{matches:i}=A.useContext(kc),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let d=xu(),u;u=d;let h=u.pathname||"/",f=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=Vu(t,{pathname:f});return dG(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:gl([l,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:gl([l,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,r)}function oG(){let t=pG(),e=cw(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:s},n):null,null)}const aG=A.createElement(oG,null);class cG extends A.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?A.createElement(kc.Provider,{value:this.props.routeContext},A.createElement(sB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lG(t){let{routeContext:e,match:n,children:r}=t,s=A.useContext(NC);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),A.createElement(kc.Provider,{value:e},r)}function dG(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Mt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:p}=n,m=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||m){l=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let p,m=!1,g=null,w=null;n&&(p=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||aG,l&&(d<0&&f===0?(gG("route-fallback"),m=!0,w=null):d===f&&(m=!0,w=h.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,f+1)),y=()=>{let x;return p?x=g:m?x=w:h.route.Component?x=A.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=u,A.createElement(lG,{match:h,routeContext:{outlet:u,matches:b,isDataRoute:n!=null},children:x})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?A.createElement(cG,{location:n.location,revalidation:n.revalidation,component:g,error:p,children:y(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):y()},null)}var aB=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(aB||{}),cB=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(cB||{});function uG(t){let e=A.useContext(NC);return e||Mt(!1),e}function hG(t){let e=A.useContext(rB);return e||Mt(!1),e}function fG(t){let e=A.useContext(kc);return e||Mt(!1),e}function lB(t){let e=fG(),n=e.matches[e.matches.length-1];return n.route.id||Mt(!1),n.route.id}function pG(){var t;let e=A.useContext(sB),n=hG(cB.UseRouteError),r=lB();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function mG(){let{router:t}=uG(aB.UseNavigateStable),e=lB(),n=A.useRef(!1);return iB(()=>{n.current=!0}),A.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,J1({fromRouteId:e},i)))},[t,e])}const QP={};function gG(t,e,n){QP[t]||(QP[t]=!0)}function yG(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function wG(t){let{to:e,replace:n,state:r,relative:s}=t;zg()||Mt(!1);let{future:i,static:o}=A.useContext(wu),{matches:a}=A.useContext(kc),{pathname:l}=xu(),d=Os(),u=CC(e,EC(a,i.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return A.useEffect(()=>d(JSON.parse(h),{replace:n,state:r,relative:s}),[d,h,s,n,r]),null}function mI(t){return sG(t.context)}function xG(t){let{basename:e="/",children:n=null,location:r,navigationType:s=gr.Pop,navigator:i,static:o=!1,future:a}=t;zg()&&Mt(!1);let l=e.replace(/^\/*/,"/"),d=A.useMemo(()=>({basename:l,navigator:i,static:o,future:J1({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=yu(r));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:m="default"}=r,g=A.useMemo(()=>{let w=Fg(u,l);return w==null?null:{location:{pathname:w,search:h,hash:f,state:p,key:m},navigationType:s}},[l,u,h,f,p,m,s]);return g==null?null:A.createElement(wu.Provider,{value:d},A.createElement(pI.Provider,{children:n,value:g}))}new Promise(()=>{});function bG(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:A.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:A.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:A.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lw(){return lw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lw.apply(this,arguments)}function vG(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function EG(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function CG(t,e){return t.button===0&&(!e||e==="_self")&&!EG(t)}const NG=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],AG="6";try{window.__reactRouterVersion=AG}catch{}function SG(t,e){return DK({basename:void 0,future:lw({},void 0,{v7_prependBasename:!0}),history:iK({window:void 0}),hydrationData:TG(),routes:t,mapRouteProperties:bG,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function TG(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=lw({},e,{errors:_G(e.errors)})),e}function _G(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new Q1(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const kG=A.createContext({isTransitioning:!1}),IG=A.createContext(new Map),RG="startTransition",JP=qV[RG],jG="flushSync",ZP=sK[jG];function PG(t){JP?JP(t):t()}function v0(t){ZP?ZP(t):t()}class OG{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function DG(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=A.useState(n.state),[o,a]=A.useState(),[l,d]=A.useState({isTransitioning:!1}),[u,h]=A.useState(),[f,p]=A.useState(),[m,g]=A.useState(),w=A.useRef(new Map),{v7_startTransition:b}=r||{},y=A.useCallback(C=>{b?PG(C):C()},[b]),x=A.useCallback((C,N)=>{let{deletedFetchers:T,flushSync:$,viewTransitionOpts:U}=N;C.fetchers.forEach((K,I)=>{K.data!==void 0&&w.current.set(I,K.data)}),T.forEach(K=>w.current.delete(K));let H=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!U||H){$?v0(()=>i(C)):y(()=>i(C));return}if($){v0(()=>{f&&(u&&u.resolve(),f.skipTransition()),d({isTransitioning:!0,flushSync:!0,currentLocation:U.currentLocation,nextLocation:U.nextLocation})});let K=n.window.document.startViewTransition(()=>{v0(()=>i(C))});K.finished.finally(()=>{v0(()=>{h(void 0),p(void 0),a(void 0),d({isTransitioning:!1})})}),v0(()=>p(K));return}f?(u&&u.resolve(),f.skipTransition(),g({state:C,currentLocation:U.currentLocation,nextLocation:U.nextLocation})):(a(C),d({isTransitioning:!0,flushSync:!1,currentLocation:U.currentLocation,nextLocation:U.nextLocation}))},[n.window,f,u,w,y]);A.useLayoutEffect(()=>n.subscribe(x),[n,x]),A.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new OG)},[l]),A.useEffect(()=>{if(u&&o&&n.window){let C=o,N=u.promise,T=n.window.document.startViewTransition(async()=>{y(()=>i(C)),await N});T.finished.finally(()=>{h(void 0),p(void 0),a(void 0),d({isTransitioning:!1})}),p(T)}},[y,o,u,n.window]),A.useEffect(()=>{u&&o&&s.location.key===o.location.key&&u.resolve()},[u,f,s.location,o]),A.useEffect(()=>{!l.isTransitioning&&m&&(a(m.state),d({isTransitioning:!0,flushSync:!1,currentLocation:m.currentLocation,nextLocation:m.nextLocation}),g(void 0))},[l.isTransitioning,m]),A.useEffect(()=>{},[]);let v=A.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:C=>n.navigate(C),push:(C,N,T)=>n.navigate(C,{state:N,preventScrollReset:T==null?void 0:T.preventScrollReset}),replace:(C,N,T)=>n.navigate(C,{replace:!0,state:N,preventScrollReset:T==null?void 0:T.preventScrollReset})}),[n]),E=n.basename||"/",R=A.useMemo(()=>({router:n,navigator:v,static:!1,basename:E}),[n,v,E]),S=A.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return A.useEffect(()=>yG(r,n.future),[r,n.future]),A.createElement(A.Fragment,null,A.createElement(NC.Provider,{value:R},A.createElement(rB.Provider,{value:s},A.createElement(IG.Provider,{value:w.current},A.createElement(kG.Provider,{value:l},A.createElement(xG,{basename:E,location:s.location,navigationType:s.historyAction,navigator:v,future:S},s.initialized||n.future.v7_partialHydration?A.createElement(MG,{routes:n.routes,future:n.future,state:s}):e))))),null)}const MG=A.memo(UG);function UG(t){let{routes:e,future:n,state:r}=t;return iG(e,void 0,r,n)}const LG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$d=A.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:d,preventScrollReset:u,viewTransition:h}=e,f=vG(e,NG),{basename:p}=A.useContext(wu),m,g=!1;if(typeof d=="string"&&BG.test(d)&&(m=d,LG))try{let x=new URL(window.location.href),v=d.startsWith("//")?new URL(x.protocol+d):new URL(d),E=Fg(v.pathname,p);v.origin===x.origin&&E!=null?d=E+v.search+v.hash:g=!0}catch{}let w=tG(d,{relative:s}),b=$G(d,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function y(x){r&&r(x),x.defaultPrevented||b(x)}return A.createElement("a",lw({},f,{href:m||w,onClick:g||i?r:y,ref:n,target:l}))});var XP;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(XP||(XP={}));var e3;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(e3||(e3={}));function $G(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=Os(),d=xu(),u=oB(t,{relative:o});return A.useCallback(h=>{if(CG(h,n)){h.preventDefault();let f=r!==void 0?r:af(d)===af(u);l(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[d,l,u,r,s,n,t,i,o,a])}let FG={data:""},zG=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||FG,HG=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,VG=/\/\*[^]*?\*\/|  +/g,t3=/\n+/g,md=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?md(o,i):i+"{"+md(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=md(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=md.p?md.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},jc={},dB=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+dB(t[n]);return e}return t},WG=(t,e,n,r,s)=>{let i=dB(t),o=jc[i]||(jc[i]=(l=>{let d=0,u=11;for(;d<l.length;)u=101*u+l.charCodeAt(d++)>>>0;return"go"+u})(i));if(!jc[o]){let l=i!==t?t:(d=>{let u,h,f=[{}];for(;u=HG.exec(d.replace(VG,""));)u[4]?f.shift():u[3]?(h=u[3].replace(t3," ").trim(),f.unshift(f[0][h]=f[0][h]||{})):f[0][u[1]]=u[2].replace(t3," ").trim();return f[0]})(t);jc[o]=md(s?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&jc.g?jc.g:null;return n&&(jc.g=jc[o]),((l,d,u,h)=>{h?d.data=d.data.replace(h,l):d.data.indexOf(l)===-1&&(d.data=u?l+d.data:d.data+l)})(jc[o],e,r,a),o},qG=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":md(a,""):a===!1?"":a}return r+s+(o??"")},"");function SC(t){let e=this||{},n=t.call?t(e.p):t;return WG(n.unshift?n.raw?qG(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,zG(e.target),e.g,e.o,e.k)}let uB,z2,H2;SC.bind({g:1});let Al=SC.bind({k:1});function KG(t,e,n,r){md.p=e,uB=t,z2=n,H2=r}function bu(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),l=a.className||s.className;n.p=Object.assign({theme:z2&&z2()},a),n.o=/ *go\d+/.test(l),a.className=SC.apply(n,r)+(l?" "+l:"");let d=t;return t[0]&&(d=a.as||t,delete a.as),H2&&d[0]&&H2(a),uB(d,a)}return s}}var GG=t=>typeof t=="function",Z1=(t,e)=>GG(t)?t(e):t,YG=(()=>{let t=0;return()=>(++t).toString()})(),hB=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),QG=20,gI="default",fB=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return fB(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Vv=[],pB={toasts:[],pausedAt:void 0,settings:{toastLimit:QG}},oc={},mB=(t,e=gI)=>{oc[e]=fB(oc[e]||pB,t),Vv.forEach(([n,r])=>{n===e&&r(oc[e])})},gB=t=>Object.keys(oc).forEach(e=>mB(t,e)),JG=t=>Object.keys(oc).find(e=>oc[e].toasts.some(n=>n.id===t)),TC=(t=gI)=>e=>{mB(e,t)},ZG={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},XG=(t={},e=gI)=>{let[n,r]=A.useState(oc[e]||pB),s=A.useRef(oc[e]);A.useEffect(()=>(s.current!==oc[e]&&r(oc[e]),Vv.push([e,r]),()=>{let o=Vv.findIndex(([a])=>a===e);o>-1&&Vv.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var a,l,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((a=t[o.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((l=t[o.type])==null?void 0:l.duration)||(t==null?void 0:t.duration)||ZG[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},eY=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||YG()}),Hx=t=>(e,n)=>{let r=eY(e,t,n);return TC(r.toasterId||JG(r.id))({type:2,toast:r}),r.id},Ir=(t,e)=>Hx("blank")(t,e);Ir.error=Hx("error");Ir.success=Hx("success");Ir.loading=Hx("loading");Ir.custom=Hx("custom");Ir.dismiss=(t,e)=>{let n={type:3,toastId:t};e?TC(e)(n):gB(n)};Ir.dismissAll=t=>Ir.dismiss(void 0,t);Ir.remove=(t,e)=>{let n={type:4,toastId:t};e?TC(e)(n):gB(n)};Ir.removeAll=t=>Ir.remove(void 0,t);Ir.promise=(t,e,n)=>{let r=Ir.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Z1(e.success,s):void 0;return i?Ir.success(i,{id:r,...n,...n==null?void 0:n.success}):Ir.dismiss(r),s}).catch(s=>{let i=e.error?Z1(e.error,s):void 0;i?Ir.error(i,{id:r,...n,...n==null?void 0:n.error}):Ir.dismiss(r)}),t};var tY=1e3,nY=(t,e="default")=>{let{toasts:n,pausedAt:r}=XG(t,e),s=A.useRef(new Map).current,i=A.useCallback((h,f=tY)=>{if(s.has(h))return;let p=setTimeout(()=>{s.delete(h),o({type:4,toastId:h})},f);s.set(h,p)},[]);A.useEffect(()=>{if(r)return;let h=Date.now(),f=n.map(p=>{if(p.duration===1/0)return;let m=(p.duration||0)+p.pauseDuration-(h-p.createdAt);if(m<0){p.visible&&Ir.dismiss(p.id);return}return setTimeout(()=>Ir.dismiss(p.id,e),m)});return()=>{f.forEach(p=>p&&clearTimeout(p))}},[n,r,e]);let o=A.useCallback(TC(e),[e]),a=A.useCallback(()=>{o({type:5,time:Date.now()})},[o]),l=A.useCallback((h,f)=>{o({type:1,toast:{id:h,height:f}})},[o]),d=A.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=A.useCallback((h,f)=>{let{reverseOrder:p=!1,gutter:m=8,defaultPosition:g}=f||{},w=n.filter(x=>(x.position||g)===(h.position||g)&&x.height),b=w.findIndex(x=>x.id===h.id),y=w.filter((x,v)=>v<b&&x.visible).length;return w.filter(x=>x.visible).slice(...p?[y+1]:[0,y]).reduce((x,v)=>x+(v.height||0)+m,0)},[n]);return A.useEffect(()=>{n.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let f=s.get(h.id);f&&(clearTimeout(f),s.delete(h.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:l,startPause:a,endPause:d,calculateOffset:u}}},rY=Al`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,sY=Al`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iY=Al`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,oY=bu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${rY} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${sY} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${iY} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,aY=Al`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,cY=bu("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${aY} 1s linear infinite;
`,lY=Al`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,dY=Al`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,uY=bu("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${lY} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${dY} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,hY=bu("div")`
  position: absolute;
`,fY=bu("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,pY=Al`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,mY=bu("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${pY} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gY=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?A.createElement(mY,null,e):e:n==="blank"?null:A.createElement(fY,null,A.createElement(cY,{...r}),n!=="loading"&&A.createElement(hY,null,n==="error"?A.createElement(oY,{...r}):A.createElement(uY,{...r})))},yY=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,wY=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,xY="0%{opacity:0;} 100%{opacity:1;}",bY="0%{opacity:1;} 100%{opacity:0;}",vY=bu("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,EY=bu("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,CY=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=hB()?[xY,bY]:[yY(n),wY(n)];return{animation:e?`${Al(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Al(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},NY=A.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?CY(t.position||e||"top-center",t.visible):{opacity:0},i=A.createElement(gY,{toast:t}),o=A.createElement(EY,{...t.ariaProps},Z1(t.message,t));return A.createElement(vY,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):A.createElement(A.Fragment,null,i,o))});KG(A.createElement);var AY=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=A.useCallback(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;r(t,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return A.createElement("div",{ref:i,className:e,style:n},s)},SY=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hB()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},TY=SC`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ub=16,_Y=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:l,handlers:d}=nY(n,i);return A.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Ub,left:Ub,right:Ub,bottom:Ub,pointerEvents:"none",...o},className:a,onMouseEnter:d.startPause,onMouseLeave:d.endPause},l.map(u=>{let h=u.position||e,f=d.calculateOffset(u,{reverseOrder:t,gutter:r,defaultPosition:e}),p=SY(h,f);return A.createElement(AY,{id:u.id,key:u.id,onHeightUpdate:d.updateHeight,className:u.visible?TY:"",style:p},u.type==="custom"?Z1(u.message,u):s?s(u):A.createElement(NY,{toast:u,position:h}))}))},D=Ir;/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kY=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),IY=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),n3=t=>{const e=IY(t);return e.charAt(0).toUpperCase()+e.slice(1)},yB=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),RY=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PY=A.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>A.createElement("svg",{ref:l,...jY,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:yB("lucide",s),...!i&&!RY(a)&&{"aria-hidden":"true"},...a},[...o.map(([d,u])=>A.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=(t,e)=>{const n=A.forwardRef(({className:r,...s},i)=>A.createElement(PY,{ref:i,iconNode:e,className:yB(`lucide-${kY(n3(t))}`,`lucide-${t}`,r),...s}));return n.displayName=n3(t),n};/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OY=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],DY=Ge("arrow-down-left",OY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MY=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],UY=Ge("arrow-left-right",MY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LY=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],BY=Ge("arrow-left",LY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Y=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Lb=Ge("arrow-up-right",$Y);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FY=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],zY=Ge("award",FY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HY=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],VY=Ge("building",HY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WY=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],qY=Ge("camera",WY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KY=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],yI=Ge("check",KY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],qt=Ge("circle-alert",GY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YY=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],kt=Ge("circle-check-big",YY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QY=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],xr=Ge("circle-x",QY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JY=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pr=Ge("clock",JY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZY=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],wB=Ge("copy",ZY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XY=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],dw=Ge("credit-card",XY);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eQ=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],_o=Ge("dollar-sign",eQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tQ=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],nQ=Ge("external-link",tQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rQ=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],xB=Ge("eye-off",rQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sQ=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],cg=Ge("eye",sQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iQ=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],cl=Ge("file-text",iQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oQ=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],bB=Ge("funnel",oQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aQ=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]],X1=Ge("gavel",aQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cQ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],vB=Ge("globe",cQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lQ=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],dQ=Ge("house",lQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uQ=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],hQ=Ge("layout-dashboard",uQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fQ=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],sr=Ge("loader-circle",fQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pQ=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Va=Ge("lock",pQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mQ=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],gQ=Ge("log-out",mQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yQ=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],wQ=Ge("mail",yQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xQ=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],lg=Ge("map-pin",xQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bQ=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],vQ=Ge("menu",bQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EQ=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.72a10 10 0 0 1 2.69 2.7",key:"jiglxs"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.28 17.61a10 10 0 0 1-2.7 2.69",key:"elg7ff"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"m6.163 21.117-2.906.85a1 1 0 0 1-1.236-1.169l.965-2.98",key:"1qsu07"}]],CQ=Ge("message-circle-dashed",EQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NQ=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Qd=Ge("message-square",NQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AQ=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],uw=Ge("mic-off",AQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SQ=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],dg=Ge("mic",SQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TQ=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],_Q=Ge("monitor",TQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kQ=[["path",{d:"M13 2a9 9 0 0 1 9 9",key:"1itnx2"}],["path",{d:"M13 6a5 5 0 0 1 5 5",key:"11nki7"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],_C=Ge("phone-call",kQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IQ=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],Vx=Ge("phone-off",IQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RQ=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],fn=Ge("phone",RQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jQ=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],r3=Ge("play",jQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PQ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wx=Ge("plus",PQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OQ=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],sA=Ge("qr-code",OQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DQ=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],wa=Ge("refresh-cw",DQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MQ=[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]],UQ=Ge("scale",MQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LQ=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],s3=Ge("save",LQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BQ=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Tf=Ge("search",BQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Q=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],EB=Ge("send",$Q);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FQ=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],V2=Ge("settings",FQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zQ=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],cf=Ge("shield",zQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HQ=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],W2=Ge("shopping-cart",HQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VQ=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],CB=Ge("smartphone",VQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WQ=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],wI=Ge("square-pen",WQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qQ=[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]],KQ=Ge("square-play",qQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GQ=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],YQ=Ge("square",GQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QQ=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],pc=Ge("star",QQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JQ=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],kC=Ge("trash-2",JQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZQ=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],XQ=Ge("trending-down",ZQ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eJ=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],NB=Ge("trending-up",eJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tJ=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Jd=Ge("triangle-alert",tJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nJ=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],i3=Ge("upload",nJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rJ=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ug=Ge("user",rJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sJ=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],hg=Ge("users",sJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iJ=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],hl=Ge("video",iJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oJ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],AB=Ge("volume-2",oJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aJ=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],SB=Ge("volume-x",aJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cJ=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],IC=Ge("wallet",cJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lJ=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],an=Ge("x",lJ);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dJ=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],uJ=Ge("zap",dJ),Ac=Object.create(null);Ac.open="0";Ac.close="1";Ac.ping="2";Ac.pong="3";Ac.message="4";Ac.upgrade="5";Ac.noop="6";const Wv=Object.create(null);Object.keys(Ac).forEach(t=>{Wv[Ac[t]]=t});const q2={type:"error",data:"parser error"},TB=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",_B=typeof ArrayBuffer=="function",kB=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,xI=({type:t,data:e},n,r)=>TB&&e instanceof Blob?n?r(e):o3(e,r):_B&&(e instanceof ArrayBuffer||kB(e))?n?r(e):o3(new Blob([e]),r):r(Ac[t]+(e||"")),o3=(t,e)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];e("b"+(r||""))},n.readAsDataURL(t)};function a3(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let iA;function hJ(t,e){if(TB&&t.data instanceof Blob)return t.data.arrayBuffer().then(a3).then(e);if(_B&&(t.data instanceof ArrayBuffer||kB(t.data)))return e(a3(t.data));xI(t,!1,n=>{iA||(iA=new TextEncoder),e(iA.encode(n))})}const c3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X0=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<c3.length;t++)X0[c3.charCodeAt(t)]=t;const fJ=t=>{let e=t.length*.75,n=t.length,r,s=0,i,o,a,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const d=new ArrayBuffer(e),u=new Uint8Array(d);for(r=0;r<n;r+=4)i=X0[t.charCodeAt(r)],o=X0[t.charCodeAt(r+1)],a=X0[t.charCodeAt(r+2)],l=X0[t.charCodeAt(r+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|a>>2,u[s++]=(a&3)<<6|l&63;return d},pJ=typeof ArrayBuffer=="function",bI=(t,e)=>{if(typeof t!="string")return{type:"message",data:IB(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:mJ(t.substring(1),e)}:Wv[n]?t.length>1?{type:Wv[n],data:t.substring(1)}:{type:Wv[n]}:q2},mJ=(t,e)=>{if(pJ){const n=fJ(t);return IB(n,e)}else return{base64:!0,data:t}},IB=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},RB="",gJ=(t,e)=>{const n=t.length,r=new Array(n);let s=0;t.forEach((i,o)=>{xI(i,!1,a=>{r[o]=a,++s===n&&e(r.join(RB))})})},yJ=(t,e)=>{const n=t.split(RB),r=[];for(let s=0;s<n.length;s++){const i=bI(n[s],e);if(r.push(i),i.type==="error")break}return r};function wJ(){return new TransformStream({transform(t,e){hJ(t,n=>{const r=n.length;let s;if(r<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,r);else if(r<65536){s=new Uint8Array(3);const i=new DataView(s.buffer);i.setUint8(0,126),i.setUint16(1,r)}else{s=new Uint8Array(9);const i=new DataView(s.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(s[0]|=128),e.enqueue(s),e.enqueue(n)})}})}let oA;function Bb(t){return t.reduce((e,n)=>e+n.length,0)}function $b(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let r=0;for(let s=0;s<e;s++)n[s]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),n}function xJ(t,e){oA||(oA=new TextDecoder);const n=[];let r=0,s=-1,i=!1;return new TransformStream({transform(o,a){for(n.push(o);;){if(r===0){if(Bb(n)<1)break;const l=$b(n,1);i=(l[0]&128)===128,s=l[0]&127,s<126?r=3:s===126?r=1:r=2}else if(r===1){if(Bb(n)<2)break;const l=$b(n,2);s=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),r=3}else if(r===2){if(Bb(n)<8)break;const l=$b(n,8),d=new DataView(l.buffer,l.byteOffset,l.length),u=d.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(q2);break}s=u*Math.pow(2,32)+d.getUint32(4),r=3}else{if(Bb(n)<s)break;const l=$b(n,s);a.enqueue(bI(i?l:oA.decode(l),e)),r=0}if(s===0||s>t){a.enqueue(q2);break}}}})}const jB=4;function Er(t){if(t)return bJ(t)}function bJ(t){for(var e in Er.prototype)t[e]=Er.prototype[e];return t}Er.prototype.on=Er.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Er.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};Er.prototype.off=Er.prototype.removeListener=Er.prototype.removeAllListeners=Er.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,s=0;s<n.length;s++)if(r=n[s],r===e||r.fn===e){n.splice(s,1);break}return n.length===0&&delete this._callbacks["$"+t],this};Er.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,s=n.length;r<s;++r)n[r].apply(this,e)}return this};Er.prototype.emitReserved=Er.prototype.emit;Er.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Er.prototype.hasListeners=function(t){return!!this.listeners(t).length};const RC=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),To=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),vJ="arraybuffer";function PB(t,...e){return e.reduce((n,r)=>(t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}const EJ=To.setTimeout,CJ=To.clearTimeout;function jC(t,e){e.useNativeTimers?(t.setTimeoutFn=EJ.bind(To),t.clearTimeoutFn=CJ.bind(To)):(t.setTimeoutFn=To.setTimeout.bind(To),t.clearTimeoutFn=To.clearTimeout.bind(To))}const NJ=1.33;function AJ(t){return typeof t=="string"?SJ(t):Math.ceil((t.byteLength||t.size)*NJ)}function SJ(t){let e=0,n=0;for(let r=0,s=t.length;r<s;r++)e=t.charCodeAt(r),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}function OB(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function TJ(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function _J(t){let e={},n=t.split("&");for(let r=0,s=n.length;r<s;r++){let i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class kJ extends Error{constructor(e,n,r){super(e),this.description=n,this.context=r,this.type="TransportError"}}class vI extends Er{constructor(e){super(),this.writable=!1,jC(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,r){return super.emitReserved("error",new kJ(e,n,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=bI(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=TJ(e);return n.length?"?"+n:""}}class IJ extends vI{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};yJ(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,gJ(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=OB()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let DB=!1;try{DB=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const RJ=DB;function jJ(){}class PJ extends IJ{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,n){const r=this.request({method:"POST",data:e});r.on("success",n),r.on("error",(s,i)=>{this.onError("xhr post error",s,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,r)=>{this.onError("xhr poll error",n,r)}),this.pollXhr=e}}let nm=class qv extends Er{constructor(e,n,r){super(),this.createRequest=e,jC(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const n=PB(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&r.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var s;r.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=qv.requestsCount++,qv.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=jJ,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete qv.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};nm.requestsCount=0;nm.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",l3);else if(typeof addEventListener=="function"){const t="onpagehide"in To?"pagehide":"unload";addEventListener(t,l3,!1)}}function l3(){for(let t in nm.requests)nm.requests.hasOwnProperty(t)&&nm.requests[t].abort()}const OJ=function(){const t=MB({xdomain:!1});return t&&t.responseType!==null}();class DJ extends PJ{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=OJ&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new nm(MB,this.uri(),e)}}function MB(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||RJ))return new XMLHttpRequest}catch{}if(!e)try{return new To[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const UB=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class MJ extends vI{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,r=UB?{}:PB(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,r)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],s=n===e.length-1;xI(r,this.supportsBinary,i=>{try{this.doWrite(r,i)}catch{}s&&RC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=OB()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const aA=To.WebSocket||To.MozWebSocket;class UJ extends MJ{createSocket(e,n,r){return UB?new aA(e,n,r):n?new aA(e,n):new aA(e)}doWrite(e,n){this.ws.send(n)}}class LJ extends vI{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=xJ(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(n).getReader(),s=wJ();s.readable.pipeTo(e.writable),this._writer=s.writable.getWriter();const i=()=>{r.read().then(({done:a,value:l})=>{a||(this.onPacket(l),i())}).catch(a=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],s=n===e.length-1;this._writer.write(r).then(()=>{s&&RC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const BJ={websocket:UJ,webtransport:LJ,polling:DJ},$J=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,FJ=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function K2(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),r=t.indexOf("]");n!=-1&&r!=-1&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));let s=$J.exec(t||""),i={},o=14;for(;o--;)i[FJ[o]]=s[o]||"";return n!=-1&&r!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=zJ(i,i.path),i.queryKey=HJ(i,i.query),i}function zJ(t,e){const n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function HJ(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,s,i){s&&(n[s]=i)}),n}const G2=typeof addEventListener=="function"&&typeof removeEventListener=="function",Kv=[];G2&&addEventListener("offline",()=>{Kv.forEach(t=>t())},!1);class Zd extends Er{constructor(e,n){if(super(),this.binaryType=vJ,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const r=K2(e);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=K2(n.host).host);jC(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{const s=r.prototype.name;this.transports.push(s),this._transportsByName[s]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=_J(this.opts.query)),G2&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Kv.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=jB,n.transport=e,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Zd.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Zd.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){const s=this.writeBuffer[r].data;if(s&&(n+=AJ(s)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,RC(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,r){return this._sendPacket("message",e,n,r),this}send(e,n,r){return this._sendPacket("message",e,n,r),this}_sendPacket(e,n,r,s){if(typeof n=="function"&&(s=n,n=void 0),typeof r=="function"&&(s=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:e,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(Zd.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),G2&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=Kv.indexOf(this._offlineEventListener);r!==-1&&Kv.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}Zd.protocol=jB;class VJ extends Zd{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),r=!1;Zd.priorWebsocketSuccess=!1;const s=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Zd.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=n.name,this.emitReserved("upgradeError",f)}}))};function i(){r||(r=!0,u(),n.close(),n=null)}const o=h=>{const f=new Error("probe error: "+h);f.transport=n.name,i(),this.emitReserved("upgradeError",f)};function a(){o("transport closed")}function l(){o("socket closed")}function d(h){n&&h.name!==n.name&&i()}const u=()=>{n.removeListener("open",s),n.removeListener("error",o),n.removeListener("close",a),this.off("close",l),this.off("upgrading",d)};n.once("open",s),n.once("error",o),n.once("close",a),this.once("close",l),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&n.push(e[r]);return n}}let WJ=class extends VJ{constructor(e,n={}){const r=typeof e=="object"?e:n;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(s=>BJ[s]).filter(s=>!!s)),super(e,r)}};function qJ(t,e="",n){let r=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),r=K2(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+e,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const KJ=typeof ArrayBuffer=="function",GJ=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,LB=Object.prototype.toString,YJ=typeof Blob=="function"||typeof Blob<"u"&&LB.call(Blob)==="[object BlobConstructor]",QJ=typeof File=="function"||typeof File<"u"&&LB.call(File)==="[object FileConstructor]";function EI(t){return KJ&&(t instanceof ArrayBuffer||GJ(t))||YJ&&t instanceof Blob||QJ&&t instanceof File}function Gv(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(Gv(t[n]))return!0;return!1}if(EI(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Gv(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Gv(t[n]))return!0;return!1}function JJ(t){const e=[],n=t.data,r=t;return r.data=Y2(n,e),r.attachments=e.length,{packet:r,buffers:e}}function Y2(t,e){if(!t)return t;if(EI(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=Y2(t[r],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=Y2(t[r],e));return n}return t}function ZJ(t,e){return t.data=Q2(t.data,e),delete t.attachments,t}function Q2(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=Q2(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=Q2(t[n],e));return t}const XJ=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],eZ=5;var zt;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(zt||(zt={}));let tZ=class{constructor(e){this.replacer=e}encode(e){return(e.type===zt.EVENT||e.type===zt.ACK)&&Gv(e)?this.encodeAsBinary({type:e.type===zt.EVENT?zt.BINARY_EVENT:zt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===zt.BINARY_EVENT||e.type===zt.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=JJ(e),r=this.encodeAsString(n.packet),s=n.buffers;return s.unshift(r),s}};function d3(t){return Object.prototype.toString.call(t)==="[object Object]"}let nZ=class BB extends Er{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const r=n.type===zt.BINARY_EVENT;r||n.type===zt.BINARY_ACK?(n.type=r?zt.EVENT:zt.ACK,this.reconstructor=new rZ(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(EI(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const r={type:Number(e.charAt(0))};if(zt[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===zt.BINARY_EVENT||r.type===zt.BINARY_ACK){const i=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const o=e.substring(i,n);if(o!=Number(o)||e.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););r.nsp=e.substring(i,n)}else r.nsp="/";const s=e.charAt(n+1);if(s!==""&&Number(s)==s){const i=n+1;for(;++n;){const o=e.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===e.length)break}r.id=Number(e.substring(i,n+1))}if(e.charAt(++n)){const i=this.tryParse(e.substr(n));if(BB.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case zt.CONNECT:return d3(n);case zt.DISCONNECT:return n===void 0;case zt.CONNECT_ERROR:return typeof n=="string"||d3(n);case zt.EVENT:case zt.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&XJ.indexOf(n[0])===-1);case zt.ACK:case zt.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};class rZ{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=ZJ(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const sZ=Object.freeze(Object.defineProperty({__proto__:null,Decoder:nZ,Encoder:tZ,get PacketType(){return zt},protocol:eZ},Symbol.toStringTag,{value:"Module"}));function la(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const iZ=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class $B extends Er{constructor(e,n,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[la(e,"open",this.onopen.bind(this)),la(e,"packet",this.onpacket.bind(this)),la(e,"error",this.onerror.bind(this)),la(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var r,s,i;if(iZ.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:zt.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const u=this.ids++,h=n.pop();this._registerAckCallback(u,h),o.id=u}const a=(s=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||s===void 0?void 0:s.writable,l=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,n){var r;const s=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(s===void 0){this.acks[e]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);n.call(this,new Error("operation has timed out"))},s),o=(...a)=>{this.io.clearTimeoutFn(i),n.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...n){return new Promise((r,s)=>{const i=(o,a)=>o?s(o):r(a);i.withError=!0,n.push(i),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((s,...i)=>r!==this._queue[0]?void 0:(s!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(s)):(this._queue.shift(),n&&n(null,...i)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:zt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case zt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case zt.EVENT:case zt.BINARY_EVENT:this.onevent(e);break;case zt.ACK:case zt.BINARY_ACK:this.onack(e);break;case zt.DISCONNECT:this.ondisconnect();break;case zt.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let r=!1;return function(...s){r||(r=!0,n.packet({type:zt.ACK,id:e,data:s}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:zt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const r of n)r.apply(this,e.data)}}}function Hg(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Hg.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+n:t-n}return Math.min(t,this.max)|0};Hg.prototype.reset=function(){this.attempts=0};Hg.prototype.setMin=function(t){this.ms=t};Hg.prototype.setMax=function(t){this.max=t};Hg.prototype.setJitter=function(t){this.jitter=t};class J2 extends Er{constructor(e,n){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,jC(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Hg({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const s=n.parser||sZ;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new WJ(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const s=la(n,"open",function(){r.onopen(),e&&e()}),i=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=la(n,"error",i);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{s(),i(new Error("timeout")),n.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(s),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(la(e,"ping",this.onping.bind(this)),la(e,"data",this.ondata.bind(this)),la(e,"error",this.onerror.bind(this)),la(e,"close",this.onclose.bind(this)),la(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){RC(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new $B(this,e,n),this.nsps[e]=r),r}_destroy(e){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let r=0;r<n.length;r++)this.engine.write(n[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(s=>{s?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",s)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const E0={};function jo(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=qJ(t,e.path||"/socket.io"),r=n.source,s=n.id,i=n.path,o=E0[s]&&i in E0[s].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new J2(r,e):(E0[s]||(E0[s]=new J2(r,e)),l=E0[s]),n.query&&!e.query&&(e.query=n.queryKey),l.socket(n.path,e)}Object.assign(jo,{Manager:J2,Socket:$B,io:jo,connect:jo});const cA={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"/api",VITE_NODE_ENV:"development",VITE_USER_NODE_ENV:"production",VITE_WS_URL:""},FB=(t,e)=>{const n=cA==null?void 0:cA[t];if(n&&n.length>0)return n;if(e!==void 0)return e;throw new Error(`Missing required env var: ${t}`)};FB("VITE_API_BASE_URL","/api");const oZ=()=>{const t=FB("VITE_WS_URL","");if(t)return t;if(typeof window<"u"){const e=window.location.hostname,n=window.location.protocol==="https:"?"wss:":"ws:",r=e.includes("ngrok")||e.includes("ngrok-free.dev")||e.includes("ngrok.io");if(e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.")||e==="localhost"||e==="127.0.0.1"||/^\d+\.\d+\.\d+\.\d+$/.test(e))return`${window.location.protocol==="https:"?"wss:":"ws:"}//${e}:5000`;if(r)return`wss://${window.location.host}`;const s=window.location.host;return`${n}//${s}`}return window.location.protocol==="https:"?"wss://localhost:5000":"ws://localhost:5000"},Ca=oZ(),aZ="modulepreload",cZ=function(t){return"/"+t},u3={},$n=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(l=>{if(l=cZ(l),l in u3)return;u3[l]=!0;const d=l.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":aZ,d||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),d)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},lZ={},h3=t=>{let e;const n=new Set,r=(u,h)=>{const f=typeof u=="function"?u(e):u;if(!Object.is(f,e)){const p=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(m=>m(e,p))}},s=()=>e,l={setState:r,getState:s,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(lZ?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=e=t(r,s,l);return l},dZ=t=>t?h3(t):h3;var zB={exports:{}},HB={},VB={exports:{}},WB={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fg=A;function uZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hZ=typeof Object.is=="function"?Object.is:uZ,fZ=fg.useState,pZ=fg.useEffect,mZ=fg.useLayoutEffect,gZ=fg.useDebugValue;function yZ(t,e){var n=e(),r=fZ({inst:{value:n,getSnapshot:e}}),s=r[0].inst,i=r[1];return mZ(function(){s.value=n,s.getSnapshot=e,lA(s)&&i({inst:s})},[t,n,e]),pZ(function(){return lA(s)&&i({inst:s}),t(function(){lA(s)&&i({inst:s})})},[t]),gZ(n),n}function lA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hZ(t,n)}catch{return!0}}function wZ(t,e){return e()}var xZ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?wZ:yZ;WB.useSyncExternalStore=fg.useSyncExternalStore!==void 0?fg.useSyncExternalStore:xZ;VB.exports=WB;var bZ=VB.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PC=A,vZ=bZ;function EZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var CZ=typeof Object.is=="function"?Object.is:EZ,NZ=vZ.useSyncExternalStore,AZ=PC.useRef,SZ=PC.useEffect,TZ=PC.useMemo,_Z=PC.useDebugValue;HB.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var i=AZ(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=TZ(function(){function l(p){if(!d){if(d=!0,u=p,p=r(p),s!==void 0&&o.hasValue){var m=o.value;if(s(m,p))return h=m}return h=p}if(m=h,CZ(u,p))return m;var g=r(p);return s!==void 0&&s(m,g)?(u=p,m):(u=p,h=g)}var d=!1,u,h,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,s]);var a=NZ(t,i[0],i[1]);return SZ(function(){o.hasValue=!0,o.value=a},[a]),_Z(a),a};zB.exports=HB;var kZ=zB.exports;const IZ=Ug(kZ),qB={},{useDebugValue:RZ}=Lx,{useSyncExternalStoreWithSelector:jZ}=IZ;let f3=!1;const PZ=t=>t;function OZ(t,e=PZ,n){(qB?"production":void 0)!=="production"&&n&&!f3&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),f3=!0);const r=jZ(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return RZ(r),r}const p3=t=>{(qB?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?dZ(t):t,n=(r,s)=>OZ(e,r,s);return Object.assign(n,e),n},CI=t=>t?p3(t):p3,DZ="6.15.0";function MZ(t,e,n){const r=e.split("|").map(i=>i.trim());for(let i=0;i<r.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${n}`,s.value=t,s}async function $s(t){const e=Object.keys(t);return(await Promise.all(e.map(r=>Promise.resolve(t[r])))).reduce((r,s,i)=>(r[e[i]]=s,r),{})}function yt(t,e,n){for(let r in e){let s=e[r];const i=n?n[r]:null;i&&MZ(s,i,r),Object.defineProperty(t,r,{enumerable:!0,value:s,writable:!1})}}function Mp(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(n=>Mp(n,e)).join(", ")+" ]";if(t instanceof Uint8Array){const n="0123456789abcdef";let r="0x";for(let s=0;s<t.length;s++)r+=n[t[s]>>4],r+=n[t[s]&15];return r}if(typeof t=="object"&&typeof t.toJSON=="function")return Mp(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const n=Object.keys(t);return n.sort(),"{ "+n.map(r=>`${Mp(r,e)}: ${Mp(t[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function rs(t,e){return t&&t.code===e}function NI(t){return rs(t,"CALL_EXCEPTION")}function Bn(t,e,n){let r=t;{const i=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${Mp(n)}`);for(const o in n){if(o==="shortMessage")continue;const a=n[o];i.push(o+"="+Mp(a))}}i.push(`code=${e}`),i.push(`version=${DZ}`),i.length&&(t+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(t);break;default:s=new Error(t)}return yt(s,{code:e}),n&&Object.assign(s,n),s.shortMessage==null&&yt(s,{shortMessage:r}),s}function ge(t,e,n,r){if(!t)throw Bn(e,n,r)}function Z(t,e,n,r){ge(t,e,"INVALID_ARGUMENT",{argument:n,value:r})}function KB(t,e,n){n==null&&(n=""),n&&(n=": "+n),ge(t>=e,"missing argument"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),ge(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");t.push(e)}catch{}return t},[]);function qx(t,e,n){if(n==null&&(n=""),t!==e){let r=n,s="new";n&&(r+=".",s+=" "+n),ge(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function GB(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if(typeof t=="string"&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const r=new Uint8Array((t.length-2)/2);let s=2;for(let i=0;i<r.length;i++)r[i]=parseInt(t.substring(s,s+2),16),s+=2;return r}Z(!1,"invalid BytesLike value",e||"value",t)}function Rt(t,e){return GB(t,e,!1)}function Fs(t,e){return GB(t,e,!0)}function Tn(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function AI(t){return Tn(t,!0)||t instanceof Uint8Array}const m3="0123456789abcdef";function Be(t){const e=Rt(t);let n="0x";for(let r=0;r<e.length;r++){const s=e[r];n+=m3[(s&240)>>4]+m3[s&15]}return n}function ir(t){return"0x"+t.map(e=>Be(e).substring(2)).join("")}function rm(t){return Tn(t,!0)?(t.length-2)/2:Rt(t).length}function Xn(t,e,n){const r=Rt(t);return n!=null&&n>r.length&&ge(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),Be(r.slice(e??0,n??r.length))}function YB(t,e,n){const r=Rt(t);ge(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),n?s.set(r,e-r.length):s.set(r,0),Be(s)}function Sl(t,e){return YB(t,e,!0)}function UZ(t,e){return YB(t,e,!1)}const OC=BigInt(0),fa=BigInt(1),Up=9007199254740991;function eE(t,e){const n=DC(t,"value"),r=BigInt(St(e,"width"));if(ge(n>>r===OC,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>r-fa){const s=(fa<<r)-fa;return-((~n&s)+fa)}return n}function QB(t,e){let n=Je(t,"value");const r=BigInt(St(e,"width")),s=fa<<r-fa;if(n<OC){n=-n,ge(n<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});const i=(fa<<r)-fa;return(~n&i)+fa}else ge(n<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return n}function ch(t,e){const n=DC(t,"value"),r=BigInt(St(e,"bits"));return n&(fa<<r)-fa}function Je(t,e){switch(typeof t){case"bigint":return t;case"number":return Z(Number.isInteger(t),"underflow",e||"value",t),Z(t>=-Up&&t<=Up,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(n){Z(!1,`invalid BigNumberish string: ${n.message}`,e||"value",t)}}Z(!1,"invalid BigNumberish value",e||"value",t)}function DC(t,e){const n=Je(t,e);return ge(n>=OC,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const g3="0123456789abcdef";function MC(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=g3[n>>4],e+=g3[n&15];return BigInt(e)}return Je(t)}function St(t,e){switch(typeof t){case"bigint":return Z(t>=-Up&&t<=Up,"overflow",e||"value",t),Number(t);case"number":return Z(Number.isInteger(t),"underflow",e||"value",t),Z(t>=-Up&&t<=Up,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return St(BigInt(t),e)}catch(n){Z(!1,`invalid numeric string: ${n.message}`,e||"value",t)}}Z(!1,"invalid numeric value",e||"value",t)}function LZ(t){return St(MC(t))}function su(t,e){let r=DC(t,"value").toString(16);if(e==null)r.length%2&&(r="0"+r);else{const s=St(e,"width");for(ge(s*2>=r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});r.length<s*2;)r="0"+r}return"0x"+r}function Or(t){const e=DC(t,"value");if(e===OC)return new Uint8Array([]);let n=e.toString(16);n.length%2&&(n="0"+n);const r=new Uint8Array(n.length/2);for(let s=0;s<r.length;s++){const i=s*2;r[s]=parseInt(n.substring(i,i+2),16)}return r}function ua(t){let e=Be(AI(t)?t:Or(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const y3="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const w3=BigInt(58);function BZ(t){const e=Rt(t);let n=MC(e),r="";for(;n;)r=y3[Number(n%w3)]+r,n/=w3;for(let s=0;s<e.length&&!e[s];s++)r=y3[0]+r;return r}function $Z(t){t=atob(t);const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return Rt(e)}function FZ(t){const e=Rt(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}var fm;class JB{constructor(e,n,r){q(this,"filter");q(this,"emitter");se(this,fm);z(this,fm,n),yt(this,{emitter:e,filter:r})}async removeListener(){k(this,fm)!=null&&await this.emitter.off(this.filter,k(this,fm))}}fm=new WeakMap;function zZ(t,e,n,r,s){Z(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)}function ZB(t,e,n,r,s){if(t==="BAD_PREFIX"||t==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<n.length&&n[o]>>6===2;o++)i++;return i}return t==="OVERRUN"?n.length-e-1:0}function HZ(t,e,n,r,s){return t==="OVERLONG"?(Z(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),r.push(s),0):(r.push(65533),ZB(t,e,n))}const VZ=Object.freeze({error:zZ,ignore:ZB,replace:HZ});function WZ(t,e){e==null&&(e=VZ.error);const n=Rt(t,"bytes"),r=[];let s=0;for(;s<n.length;){const i=n[s++];if(!(i>>7)){r.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,n,r):s+=e("BAD_PREFIX",s-1,n,r);continue}if(s-1+o>=n.length){s+=e("OVERRUN",s-1,n,r);continue}let l=i&(1<<8-o-1)-1;for(let d=0;d<o;d++){let u=n[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,n,r),l=null;break}l=l<<6|u&63,s++}if(l!==null){if(l>1114111){s+=e("OUT_OF_RANGE",s-1-o,n,r,l);continue}if(l>=55296&&l<=57343){s+=e("UTF16_SURROGATE",s-1-o,n,r,l);continue}if(l<=a){s+=e("OVERLONG",s-1-o,n,r,l);continue}r.push(l)}}return r}function mc(t,e){Z(typeof t=="string","invalid string value","str",t);let n=[];for(let r=0;r<t.length;r++){const s=t.charCodeAt(r);if(s<128)n.push(s);else if(s<2048)n.push(s>>6|192),n.push(s&63|128);else if((s&64512)==55296){r++;const i=t.charCodeAt(r);Z(r<t.length&&(i&64512)===56320,"invalid surrogate pair","str",t);const o=65536+((s&1023)<<10)+(i&1023);n.push(o>>18|240),n.push(o>>12&63|128),n.push(o>>6&63|128),n.push(o&63|128)}else n.push(s>>12|224),n.push(s>>6&63|128),n.push(s&63|128)}return new Uint8Array(n)}function qZ(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function tE(t,e){return qZ(WZ(t,e))}function XB(t){async function e(n,r){ge(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const s=n.url.split(":")[0].toLowerCase();ge(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),ge(s==="https"||!n.credentials||n.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=Bn("request timeout","TIMEOUT"),o.abort()},n.timeout);r&&r.addListener(()=>{i=Bn("request cancelled","CANCELLED"),o.abort()});const l=Object.assign({},t,{method:n.method,headers:new Headers(Array.from(n)),body:n.body||void 0,signal:o.signal});let d;try{d=await fetch(n.url,l)}catch(p){throw clearTimeout(a),i||p}clearTimeout(a);const u={};d.headers.forEach((p,m)=>{u[m.toLowerCase()]=p});const h=await d.arrayBuffer(),f=h==null?null:new Uint8Array(h);return{statusCode:d.status,statusMessage:d.statusText,headers:u,body:f}}return e}const KZ=12,GZ=250;let x3=XB();const YZ=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),QZ=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let dA=!1;async function e$(t,e){try{const n=t.match(YZ);if(!n)throw new Error("invalid data");return new Xd(200,"OK",{"content-type":n[1]||"text/plain"},n[2]?$Z(n[3]):ZZ(n[3]))}catch{return new Xd(599,"BAD REQUEST (invalid data: URI)",{},null,new Tl(t))}}function t$(t){async function e(n,r){try{const s=n.match(QZ);if(!s)throw new Error("invalid link");return new Tl(`${t}${s[2]}`)}catch{return new Xd(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Tl(n))}}return e}const Fb={data:e$,ipfs:t$("https://gateway.ipfs.io/ipfs/")},n$=new WeakMap;var Ch,bd;class JZ{constructor(e){se(this,Ch);se(this,bd);z(this,Ch,[]),z(this,bd,!1),n$.set(e,()=>{if(!k(this,bd)){z(this,bd,!0);for(const n of k(this,Ch))setTimeout(()=>{n()},0);z(this,Ch,[])}})}addListener(e){ge(!k(this,bd),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),k(this,Ch).push(e)}get cancelled(){return k(this,bd)}checkSignal(){ge(!this.cancelled,"cancelled","CANCELLED",{})}}Ch=new WeakMap,bd=new WeakMap;function zb(t){if(t==null)throw new Error("missing signal; should not happen");return t.checkSignal(),t}var pm,mm,ta,Jc,gm,ym,Br,Li,Zc,Nh,Ah,Sh,Wa,na,vd,Th,ey;const XE=class XE{constructor(e){se(this,Th);se(this,pm);se(this,mm);se(this,ta);se(this,Jc);se(this,gm);se(this,ym);se(this,Br);se(this,Li);se(this,Zc);se(this,Nh);se(this,Ah);se(this,Sh);se(this,Wa);se(this,na);se(this,vd);z(this,ym,String(e)),z(this,pm,!1),z(this,mm,!0),z(this,ta,{}),z(this,Jc,""),z(this,gm,3e5),z(this,na,{slotInterval:GZ,maxAttempts:KZ}),z(this,vd,null)}get url(){return k(this,ym)}set url(e){z(this,ym,String(e))}get body(){return k(this,Br)==null?null:new Uint8Array(k(this,Br))}set body(e){if(e==null)z(this,Br,void 0),z(this,Li,void 0);else if(typeof e=="string")z(this,Br,mc(e)),z(this,Li,"text/plain");else if(e instanceof Uint8Array)z(this,Br,e),z(this,Li,"application/octet-stream");else if(typeof e=="object")z(this,Br,mc(JSON.stringify(e))),z(this,Li,"application/json");else throw new Error("invalid body")}hasBody(){return k(this,Br)!=null}get method(){return k(this,Jc)?k(this,Jc):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),z(this,Jc,String(e).toUpperCase())}get headers(){const e=Object.assign({},k(this,ta));return k(this,Zc)&&(e.authorization=`Basic ${FZ(mc(k(this,Zc)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&k(this,Li)&&(e["content-type"]=k(this,Li)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,n){k(this,ta)[String(e).toLowerCase()]=String(n)}clearHeaders(){z(this,ta,{})}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return k(this,Zc)||null}setCredentials(e,n){Z(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),z(this,Zc,`${e}:${n}`)}get allowGzip(){return k(this,mm)}set allowGzip(e){z(this,mm,!!e)}get allowInsecureAuthentication(){return!!k(this,pm)}set allowInsecureAuthentication(e){z(this,pm,!!e)}get timeout(){return k(this,gm)}set timeout(e){Z(e>=0,"timeout must be non-zero","timeout",e),z(this,gm,e)}get preflightFunc(){return k(this,Nh)||null}set preflightFunc(e){z(this,Nh,e)}get processFunc(){return k(this,Ah)||null}set processFunc(e){z(this,Ah,e)}get retryFunc(){return k(this,Sh)||null}set retryFunc(e){z(this,Sh,e)}get getUrlFunc(){return k(this,vd)||x3}set getUrlFunc(e){z(this,vd,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${k(this,Br)?Be(k(this,Br)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(k(this,na).slotInterval=e.slotInterval),e.maxAttempts!=null&&(k(this,na).maxAttempts=e.maxAttempts)}send(){return ge(k(this,Wa)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),z(this,Wa,new JZ(this)),Ne(this,Th,ey).call(this,0,b3()+this.timeout,0,this,new Xd(0,"",{},null,this))}cancel(){ge(k(this,Wa)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=n$.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const n=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();ge(this.method==="GET"&&(n!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new XE(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,z(s,ta,Object.assign({},k(this,ta))),k(this,Br)&&z(s,Br,new Uint8Array(k(this,Br))),z(s,Li,k(this,Li)),s}clone(){const e=new XE(this.url);return z(e,Jc,k(this,Jc)),k(this,Br)&&z(e,Br,k(this,Br)),z(e,Li,k(this,Li)),z(e,ta,Object.assign({},k(this,ta))),z(e,Zc,k(this,Zc)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),z(e,Nh,k(this,Nh)),z(e,Ah,k(this,Ah)),z(e,Sh,k(this,Sh)),z(e,na,Object.assign({},k(this,na))),z(e,vd,k(this,vd)),e}static lockConfig(){dA=!0}static getGateway(e){return Fb[e.toLowerCase()]||null}static registerGateway(e,n){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(dA)throw new Error("gateways locked");Fb[e]=n}static registerGetUrl(e){if(dA)throw new Error("gateways locked");x3=e}static createGetUrlFunc(e){return XB(e)}static createDataGateway(){return e$}static createIpfsGatewayFunc(e){return t$(e)}};pm=new WeakMap,mm=new WeakMap,ta=new WeakMap,Jc=new WeakMap,gm=new WeakMap,ym=new WeakMap,Br=new WeakMap,Li=new WeakMap,Zc=new WeakMap,Nh=new WeakMap,Ah=new WeakMap,Sh=new WeakMap,Wa=new WeakMap,na=new WeakMap,vd=new WeakMap,Th=new WeakSet,ey=async function(e,n,r,s,i){var u,h,f;if(e>=k(this,na).maxAttempts)return i.makeServerError("exceeded maximum retry limit");ge(b3()<=n,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),r>0&&await XZ(r);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in Fb){const p=await Fb[a](o.url,zb(k(s,Wa)));if(p instanceof Xd){let m=p;if(this.processFunc){zb(k(s,Wa));try{m=await this.processFunc(o,m)}catch(g){(g.throttle==null||typeof g.stall!="number")&&m.makeServerError("error in post-processing function",g).assertOk()}}return m}o=p}this.preflightFunc&&(o=await this.preflightFunc(o));const l=await this.getUrlFunc(o,zb(k(s,Wa)));let d=new Xd(l.statusCode,l.statusMessage,l.headers,l.body,s);if(d.statusCode===301||d.statusCode===302){try{const p=d.headers.location||"";return Ne(u=o.redirect(p),Th,ey).call(u,e+1,n,0,s,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,d,e))){const p=d.headers["retry-after"];let m=k(this,na).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof p=="string"&&p.match(/^[1-9][0-9]*$/)&&(m=parseInt(p)),Ne(h=o.clone(),Th,ey).call(h,e+1,n,m,s,d)}if(this.processFunc){zb(k(s,Wa));try{d=await this.processFunc(o,d)}catch(p){(p.throttle==null||typeof p.stall!="number")&&d.makeServerError("error in post-processing function",p).assertOk();let m=k(this,na).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return p.stall>=0&&(m=p.stall),Ne(f=o.clone(),Th,ey).call(f,e+1,n,m,s,d)}}return d};let Tl=XE;var Ax,Sx,Tx,Bi,wm,_h;const xj=class xj{constructor(e,n,r,s,i){se(this,Ax);se(this,Sx);se(this,Tx);se(this,Bi);se(this,wm);se(this,_h);z(this,Ax,e),z(this,Sx,n),z(this,Tx,Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{})),z(this,Bi,s==null?null:new Uint8Array(s)),z(this,wm,i||null),z(this,_h,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${k(this,Bi)?Be(k(this,Bi)):"null"}>`}get statusCode(){return k(this,Ax)}get statusMessage(){return k(this,Sx)}get headers(){return Object.assign({},k(this,Tx))}get body(){return k(this,Bi)==null?null:new Uint8Array(k(this,Bi))}get bodyText(){try{return k(this,Bi)==null?"":tE(k(this,Bi))}catch{ge(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{ge(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,n=Object.keys(e);let r=0;return{next:()=>{if(r<n.length){const s=n[r++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,n){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new xj(599,r,this.headers,this.body,k(this,wm)||void 0);return z(s,_h,{message:e,error:n}),s}throwThrottleError(e,n){n==null?n=-1:Z(Number.isInteger(n)&&n>=0,"invalid stall timeout","stall",n);const r=new Error(e||"throttling requests");throw yt(r,{stall:n,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return k(this,Bi)!=null}get request(){return k(this,wm)}ok(){return k(this,_h).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:n}=k(this,_h);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let s=null;try{k(this,Bi)&&(s=tE(k(this,Bi)))}catch{}ge(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:n,info:{requestUrl:r,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Ax=new WeakMap,Sx=new WeakMap,Tx=new WeakMap,Bi=new WeakMap,wm=new WeakMap,_h=new WeakMap;let Xd=xj;function b3(){return new Date().getTime()}function ZZ(t){return mc(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,n)=>String.fromCharCode(parseInt(n,16))))}function XZ(t){return new Promise(e=>setTimeout(e,t))}const eX=BigInt(-1),Go=BigInt(0),Lp=BigInt(1),tX=BigInt(5),Vf={};let sm="0000";for(;sm.length<80;)sm+=sm;function _u(t){let e=sm;for(;e.length<t;)e+=e;return BigInt("1"+e.substring(0,t))}function C0(t,e,n){const r=BigInt(e.width);if(e.signed){const s=Lp<<r-Lp;ge(n==null||t>=-s&&t<s,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t>Go?t=eE(ch(t,r),r):t=-eE(ch(-t,r),r)}else{const s=Lp<<r;ge(n==null||t>=0&&t<s,"overflow","NUMERIC_FAULT",{operation:n,fault:"overflow",value:t}),t=(t%s+s)%s&s-Lp}return t}function uA(t){typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,n=128,r=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const i=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);Z(i,"invalid fixed format","format",t),e=i[1]!=="u",n=parseInt(i[2]),r=parseInt(i[3])}}else if(t){const i=t,o=(a,l,d)=>i[a]==null?d:(Z(typeof i[a]===l,"invalid fixed format ("+a+" not "+l+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),n=o("width","number",n),r=o("decimals","number",r)}Z(n%8===0,"invalid FixedNumber width (not byte aligned)","format.width",n),Z(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const s=(e?"":"u")+"fixed"+String(n)+"x"+String(r);return{signed:e,width:n,decimals:r,name:s}}function nX(t,e){let n="";t<Go&&(n="-",t*=eX);let r=t.toString();if(e===0)return n+r;for(;r.length<=e;)r=sm+r;const s=r.length-e;for(r=r.substring(0,s)+"."+r.substring(s);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return n+r}var ra,En,Us,pn,Bu,$c,Z2,X2,eT,tT;const hd=class hd{constructor(e,n,r){se(this,pn);q(this,"format");se(this,ra);se(this,En);se(this,Us);q(this,"_value");qx(e,Vf,"FixedNumber"),z(this,En,n),z(this,ra,r);const s=nX(n,r.decimals);yt(this,{format:r.name,_value:s}),z(this,Us,_u(r.decimals))}get signed(){return k(this,ra).signed}get width(){return k(this,ra).width}get decimals(){return k(this,ra).decimals}get value(){return k(this,En)}addUnsafe(e){return Ne(this,pn,Z2).call(this,e)}add(e){return Ne(this,pn,Z2).call(this,e,"add")}subUnsafe(e){return Ne(this,pn,X2).call(this,e)}sub(e){return Ne(this,pn,X2).call(this,e,"sub")}mulUnsafe(e){return Ne(this,pn,eT).call(this,e)}mul(e){return Ne(this,pn,eT).call(this,e,"mul")}mulSignal(e){Ne(this,pn,Bu).call(this,e);const n=k(this,En)*k(e,En);return ge(n%k(this,Us)===Go,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),Ne(this,pn,$c).call(this,n/k(this,Us),"mulSignal")}divUnsafe(e){return Ne(this,pn,tT).call(this,e)}div(e){return Ne(this,pn,tT).call(this,e,"div")}divSignal(e){ge(k(e,En)!==Go,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),Ne(this,pn,Bu).call(this,e);const n=k(this,En)*k(this,Us);return ge(n%k(e,En)===Go,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),Ne(this,pn,$c).call(this,n/k(e,En),"divSignal")}cmp(e){let n=this.value,r=e.value;const s=this.decimals-e.decimals;return s>0?r*=_u(s):s<0&&(n*=_u(-s)),n<r?-1:n>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=k(this,En);return k(this,En)<Go&&(e-=k(this,Us)-Lp),e=k(this,En)/k(this,Us)*k(this,Us),Ne(this,pn,$c).call(this,e,"floor")}ceiling(){let e=k(this,En);return k(this,En)>Go&&(e+=k(this,Us)-Lp),e=k(this,En)/k(this,Us)*k(this,Us),Ne(this,pn,$c).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const n=this.decimals-e,r=tX*_u(n-1);let s=this.value+r;const i=_u(n);return s=s/i*i,C0(s,k(this,ra),"round"),new hd(Vf,s,k(this,ra))}isZero(){return k(this,En)===Go}isNegative(){return k(this,En)<Go}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return hd.fromString(this.toString(),e)}static fromValue(e,n,r){const s=n==null?0:St(n),i=uA(r);let o=Je(e,"value");const a=s-i.decimals;if(a>0){const l=_u(a);ge(o%l===Go,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=l}else a<0&&(o*=_u(-a));return C0(o,i,"fromValue"),new hd(Vf,o,i)}static fromString(e,n){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);Z(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const s=uA(n);let i=r[2]||"0",o=r[3]||"";for(;o.length<s.decimals;)o+=sm;ge(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(r[1]+i+o);return C0(a,s,"fromString"),new hd(Vf,a,s)}static fromBytes(e,n){let r=MC(Rt(e,"value"));const s=uA(n);return s.signed&&(r=eE(r,s.width)),C0(r,s,"fromBytes"),new hd(Vf,r,s)}};ra=new WeakMap,En=new WeakMap,Us=new WeakMap,pn=new WeakSet,Bu=function(e){Z(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},$c=function(e,n){return e=C0(e,k(this,ra),n),new hd(Vf,e,k(this,ra))},Z2=function(e,n){return Ne(this,pn,Bu).call(this,e),Ne(this,pn,$c).call(this,k(this,En)+k(e,En),n)},X2=function(e,n){return Ne(this,pn,Bu).call(this,e),Ne(this,pn,$c).call(this,k(this,En)-k(e,En),n)},eT=function(e,n){return Ne(this,pn,Bu).call(this,e),Ne(this,pn,$c).call(this,k(this,En)*k(e,En)/k(this,Us),n)},tT=function(e,n){return ge(k(e,En)!==Go,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),Ne(this,pn,Bu).call(this,e),Ne(this,pn,$c).call(this,k(this,En)*k(this,Us)/k(e,En),n)};let nE=hd;function rX(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function v3(t,e,n){let r=0;for(let s=0;s<n;s++)r=r*256+t[e+s];return r}function E3(t,e,n,r){const s=[];for(;n<e+1+r;){const i=r$(t,n);s.push(i.result),n+=i.consumed,ge(n<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:t,length:r,offset:e})}return{consumed:1+r,result:s}}function r$(t,e){ge(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const n=r=>{ge(r<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:r})};if(t[e]>=248){const r=t[e]-247;n(e+1+r);const s=v3(t,e+1,r);return n(e+1+r+s),E3(t,e,e+1+r,r+s)}else if(t[e]>=192){const r=t[e]-192;return n(e+1+r),E3(t,e,e+1,r)}else if(t[e]>=184){const r=t[e]-183;n(e+1+r);const s=v3(t,e+1,r);n(e+1+r+s);const i=Be(t.slice(e+1+r,e+1+r+s));return{consumed:1+r+s,result:i}}else if(t[e]>=128){const r=t[e]-128;n(e+1+r);const s=Be(t.slice(e+1,e+1+r));return{consumed:1+r,result:s}}return{consumed:1,result:rX(t[e])}}function Kx(t){const e=Rt(t,"data"),n=r$(e,0);return Z(n.consumed===e.length,"unexpected junk after rlp payload","data",t),n.result}function C3(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function s$(t){if(Array.isArray(t)){let r=[];if(t.forEach(function(i){r=r.concat(s$(i))}),r.length<=55)return r.unshift(192+r.length),r;const s=C3(r.length);return s.unshift(247+s.length),s.concat(r)}const e=Array.prototype.slice.call(Rt(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=C3(e.length);return n.unshift(183+n.length),n.concat(e)}const N3="0123456789abcdef";function iu(t){let e="0x";for(const n of s$(t))e+=N3[n>>4],e+=N3[n&15];return e}const i$=["wei","kwei","mwei","gwei","szabo","finney","ether"];function ha(t,e){let n=18;if(typeof e=="string"){const r=i$.indexOf(e);Z(r>=0,"invalid unit","unit",e),n=3*r}else e!=null&&(n=St(e,"unit"));return nE.fromValue(t,n,{decimals:n,width:512}).toString()}function im(t,e){Z(typeof t=="string","value must be a string","value",t);let n=18;if(typeof e=="string"){const r=i$.indexOf(e);Z(r>=0,"invalid unit","unit",e),n=3*r}else e!=null&&(n=St(e,"unit"));return nE.fromString(t,{decimals:n,width:512}).value}function gc(t){return ha(t,18)}const zs=32,nT=new Uint8Array(zs),sX=["then"],Hb={},o$=new WeakMap;function qu(t){return o$.get(t)}function A3(t,e){o$.set(t,e)}function N0(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function rT(t,e,n){return t.indexOf(null)>=0?e.map((r,s)=>r instanceof pg?rT(qu(r),r,n):r):t.reduce((r,s,i)=>{let o=e.getValue(s);return s in r||(n&&o instanceof pg&&(o=rT(qu(o),o,n)),r[s]=o),r},{})}var xm;const Kp=class Kp extends Array{constructor(...n){const r=n[0];let s=n[1],i=(n[2]||[]).slice(),o=!0;r!==Hb&&(s=n,i=[],o=!1);super(s.length);se(this,xm);s.forEach((d,u)=>{this[u]=d});const a=i.reduce((d,u)=>(typeof u=="string"&&d.set(u,(d.get(u)||0)+1),d),new Map);if(A3(this,Object.freeze(s.map((d,u)=>{const h=i[u];return h!=null&&a.get(h)===1?h:null}))),z(this,xm,[]),k(this,xm)==null&&k(this,xm),!o)return;Object.freeze(this);const l=new Proxy(this,{get:(d,u,h)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const p=St(u,"%index");if(p<0||p>=this.length)throw new RangeError("out of result range");const m=d[p];return m instanceof Error&&N0(`index ${p}`,m),m}if(sX.indexOf(u)>=0)return Reflect.get(d,u,h);const f=d[u];if(f instanceof Function)return function(...p){return f.apply(this===h?d:this,p)};if(!(u in d))return d.getValue.apply(this===h?d:this,[u])}return Reflect.get(d,u,h)}});return A3(l,qu(this)),l}toArray(n){const r=[];return this.forEach((s,i)=>{s instanceof Error&&N0(`index ${i}`,s),n&&s instanceof Kp&&(s=s.toArray(n)),r.push(s)}),r}toObject(n){const r=qu(this);return r.reduce((s,i,o)=>(ge(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),rT(r,this,n)),{})}slice(n,r){n==null&&(n=0),n<0&&(n+=this.length,n<0&&(n=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const s=qu(this),i=[],o=[];for(let a=n;a<r;a++)i.push(this[a]),o.push(s[a]);return new Kp(Hb,i,o)}filter(n,r){const s=qu(this),i=[],o=[];for(let a=0;a<this.length;a++){const l=this[a];l instanceof Error&&N0(`index ${a}`,l),n.call(r,l,a,this)&&(i.push(l),o.push(s[a]))}return new Kp(Hb,i,o)}map(n,r){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&N0(`index ${i}`,o),s.push(n.call(r,o,i,this))}return s}getValue(n){const r=qu(this).indexOf(n);if(r===-1)return;const s=this[r];return s instanceof Error&&N0(`property ${JSON.stringify(n)}`,s.error),s}static fromItems(n,r){return new Kp(Hb,n,r)}};xm=new WeakMap;let pg=Kp;function S3(t){let e=Or(t);return ge(e.length<=zs,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:zs,offset:e.length}),e.length!==zs&&(e=Fs(ir([nT.slice(e.length%zs),e]))),e}class Dl{constructor(e,n,r,s){q(this,"name");q(this,"type");q(this,"localName");q(this,"dynamic");yt(this,{name:e,type:n,localName:r,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,n){Z(!1,e,this.localName,n)}}var Xc,kh,bm,Yv;class sT{constructor(){se(this,bm);se(this,Xc);se(this,kh);z(this,Xc,[]),z(this,kh,0)}get data(){return ir(k(this,Xc))}get length(){return k(this,kh)}appendWriter(e){return Ne(this,bm,Yv).call(this,Fs(e.data))}writeBytes(e){let n=Fs(e);const r=n.length%zs;return r&&(n=Fs(ir([n,nT.slice(r)]))),Ne(this,bm,Yv).call(this,n)}writeValue(e){return Ne(this,bm,Yv).call(this,S3(e))}writeUpdatableValue(){const e=k(this,Xc).length;return k(this,Xc).push(nT),z(this,kh,k(this,kh)+zs),n=>{k(this,Xc)[e]=S3(n)}}}Xc=new WeakMap,kh=new WeakMap,bm=new WeakSet,Yv=function(e){return k(this,Xc).push(e),z(this,kh,k(this,kh)+e.length),e.length};var di,$i,Ih,Rh,Ed,Nf,oT,a$;const bj=class bj{constructor(e,n,r){se(this,Nf);q(this,"allowLoose");se(this,di);se(this,$i);se(this,Ih);se(this,Rh);se(this,Ed);yt(this,{allowLoose:!!n}),z(this,di,Fs(e)),z(this,Ih,0),z(this,Rh,null),z(this,Ed,r??1024),z(this,$i,0)}get data(){return Be(k(this,di))}get dataLength(){return k(this,di).length}get consumed(){return k(this,$i)}get bytes(){return new Uint8Array(k(this,di))}subReader(e){const n=new bj(k(this,di).slice(k(this,$i)+e),this.allowLoose,k(this,Ed));return z(n,Rh,this),n}readBytes(e,n){let r=Ne(this,Nf,a$).call(this,0,e,!!n);return Ne(this,Nf,oT).call(this,e),z(this,$i,k(this,$i)+r.length),r.slice(0,e)}readValue(){return MC(this.readBytes(zs))}readIndex(){return LZ(this.readBytes(zs))}};di=new WeakMap,$i=new WeakMap,Ih=new WeakMap,Rh=new WeakMap,Ed=new WeakMap,Nf=new WeakSet,oT=function(e){var n;if(k(this,Rh))return Ne(n=k(this,Rh),Nf,oT).call(n,e);z(this,Ih,k(this,Ih)+e),ge(k(this,Ed)<1||k(this,Ih)<=k(this,Ed)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${k(this,Ed)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Fs(k(this,di)),offset:k(this,$i),length:e,info:{bytesRead:k(this,Ih),dataLength:this.dataLength}})},a$=function(e,n,r){let s=Math.ceil(n/zs)*zs;return k(this,$i)+s>k(this,di).length&&(this.allowLoose&&r&&k(this,$i)+n<=k(this,di).length?s=n:ge(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Fs(k(this,di)),length:k(this,di).length,offset:k(this,$i)+s})),k(this,di).slice(k(this,$i),k(this,$i)+s)};let iT=bj;function rE(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function SI(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function iX(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");rE(t.outputLen),rE(t.blockLen)}function mg(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function c$(t,e){SI(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const hA=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const l$=t=>t instanceof Uint8Array,oX=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),fA=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Pa=(t,e)=>t<<32-e|t>>>e,aX=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!aX)throw new Error("Non little-endian hardware is not supported");function cX(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function UC(t){if(typeof t=="string"&&(t=cX(t)),!l$(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function lX(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!l$(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}let TI=class{clone(){return this._cloneInto()}};function _I(t){const e=r=>t().update(UC(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function dX(t=32){if(hA&&typeof hA.getRandomValues=="function")return hA.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class d$ extends TI{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,iX(e);const r=UC(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return mg(this),this.iHash.update(e),this}digestInto(e){mg(this),SI(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const u$=(t,e,n)=>new d$(t,e).update(n).digest();u$.create=(t,e)=>new d$(t,e);function uX(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),l=r?4:0,d=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+d,a,r)}class h$ extends TI{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=fA(this.buffer)}update(e){mg(this);const{view:n,buffer:r,blockLen:s}=this;e=UC(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const l=fA(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){mg(this),c$(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;uX(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=fA(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}}const hX=(t,e,n)=>t&e^~t&n,fX=(t,e,n)=>t&e^t&n^e&n,pX=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ll=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Bl=new Uint32Array(64);class mX extends h${constructor(){super(64,32,8,!1),this.A=Ll[0]|0,this.B=Ll[1]|0,this.C=Ll[2]|0,this.D=Ll[3]|0,this.E=Ll[4]|0,this.F=Ll[5]|0,this.G=Ll[6]|0,this.H=Ll[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:l}=this;return[e,n,r,s,i,o,a,l]}set(e,n,r,s,i,o,a,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(e,n){for(let h=0;h<16;h++,n+=4)Bl[h]=e.getUint32(n,!1);for(let h=16;h<64;h++){const f=Bl[h-15],p=Bl[h-2],m=Pa(f,7)^Pa(f,18)^f>>>3,g=Pa(p,17)^Pa(p,19)^p>>>10;Bl[h]=g+Bl[h-7]+m+Bl[h-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:l,G:d,H:u}=this;for(let h=0;h<64;h++){const f=Pa(a,6)^Pa(a,11)^Pa(a,25),p=u+f+hX(a,l,d)+pX[h]+Bl[h]|0,g=(Pa(r,2)^Pa(r,13)^Pa(r,22))+fX(r,s,i)|0;u=d,d=l,l=a,a=o+p|0,o=i,i=s,s=r,r=p+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,l,d,u)}roundClean(){Bl.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const f$=_I(()=>new mX),Vb=BigInt(2**32-1),aT=BigInt(32);function p$(t,e=!1){return e?{h:Number(t&Vb),l:Number(t>>aT&Vb)}:{h:Number(t>>aT&Vb)|0,l:Number(t&Vb)|0}}function m$(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=p$(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const gX=(t,e)=>BigInt(t>>>0)<<aT|BigInt(e>>>0),yX=(t,e,n)=>t>>>n,wX=(t,e,n)=>t<<32-n|e>>>n,xX=(t,e,n)=>t>>>n|e<<32-n,bX=(t,e,n)=>t<<32-n|e>>>n,vX=(t,e,n)=>t<<64-n|e>>>n-32,EX=(t,e,n)=>t>>>n-32|e<<64-n,CX=(t,e)=>e,NX=(t,e)=>t,g$=(t,e,n)=>t<<n|e>>>32-n,y$=(t,e,n)=>e<<n|t>>>32-n,w$=(t,e,n)=>e<<n-32|t>>>64-n,x$=(t,e,n)=>t<<n-32|e>>>64-n;function AX(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const SX=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),TX=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,_X=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),kX=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,IX=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),RX=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Tt={fromBig:p$,split:m$,toBig:gX,shrSH:yX,shrSL:wX,rotrSH:xX,rotrSL:bX,rotrBH:vX,rotrBL:EX,rotr32H:CX,rotr32L:NX,rotlSH:g$,rotlSL:y$,rotlBH:w$,rotlBL:x$,add:AX,add3L:SX,add3H:TX,add4L:_X,add4H:kX,add5H:RX,add5L:IX},[jX,PX]=Tt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),$l=new Uint32Array(80),Fl=new Uint32Array(80);class OX extends h${constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:l,Eh:d,El:u,Fh:h,Fl:f,Gh:p,Gl:m,Hh:g,Hl:w}=this;return[e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w]}set(e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=l|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=p|0,this.Gl=m|0,this.Hh=g|0,this.Hl=w|0}process(e,n){for(let x=0;x<16;x++,n+=4)$l[x]=e.getUint32(n),Fl[x]=e.getUint32(n+=4);for(let x=16;x<80;x++){const v=$l[x-15]|0,E=Fl[x-15]|0,R=Tt.rotrSH(v,E,1)^Tt.rotrSH(v,E,8)^Tt.shrSH(v,E,7),S=Tt.rotrSL(v,E,1)^Tt.rotrSL(v,E,8)^Tt.shrSL(v,E,7),C=$l[x-2]|0,N=Fl[x-2]|0,T=Tt.rotrSH(C,N,19)^Tt.rotrBH(C,N,61)^Tt.shrSH(C,N,6),$=Tt.rotrSL(C,N,19)^Tt.rotrBL(C,N,61)^Tt.shrSL(C,N,6),U=Tt.add4L(S,$,Fl[x-7],Fl[x-16]),H=Tt.add4H(U,R,T,$l[x-7],$l[x-16]);$l[x]=H|0,Fl[x]=U|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:l,Dh:d,Dl:u,Eh:h,El:f,Fh:p,Fl:m,Gh:g,Gl:w,Hh:b,Hl:y}=this;for(let x=0;x<80;x++){const v=Tt.rotrSH(h,f,14)^Tt.rotrSH(h,f,18)^Tt.rotrBH(h,f,41),E=Tt.rotrSL(h,f,14)^Tt.rotrSL(h,f,18)^Tt.rotrBL(h,f,41),R=h&p^~h&g,S=f&m^~f&w,C=Tt.add5L(y,E,S,PX[x],Fl[x]),N=Tt.add5H(C,b,v,R,jX[x],$l[x]),T=C|0,$=Tt.rotrSH(r,s,28)^Tt.rotrBH(r,s,34)^Tt.rotrBH(r,s,39),U=Tt.rotrSL(r,s,28)^Tt.rotrBL(r,s,34)^Tt.rotrBL(r,s,39),H=r&i^r&a^i&a,K=s&o^s&l^o&l;b=g|0,y=w|0,g=p|0,w=m|0,p=h|0,m=f|0,{h,l:f}=Tt.add(d|0,u|0,N|0,T|0),d=a|0,u=l|0,a=i|0,l=o|0,i=r|0,o=s|0;const I=Tt.add3L(T,U,K);r=Tt.add3H(I,N,$,H),s=I|0}({h:r,l:s}=Tt.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Tt.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l}=Tt.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:d,l:u}=Tt.add(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:f}=Tt.add(this.Eh|0,this.El|0,h|0,f|0),{h:p,l:m}=Tt.add(this.Fh|0,this.Fl|0,p|0,m|0),{h:g,l:w}=Tt.add(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:y}=Tt.add(this.Hh|0,this.Hl|0,b|0,y|0),this.set(r,s,i,o,a,l,d,u,h,f,p,m,g,w,b,y)}roundClean(){$l.fill(0),Fl.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const DX=_I(()=>new OX);function MX(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const T3=MX();T3.crypto||T3.msCrypto;function UX(t){switch(t){case"sha256":return f$.create();case"sha512":return DX.create()}Z(!1,"invalid hashing algorithm name","algorithm",t)}const[b$,v$,E$]=[[],[],[]],LX=BigInt(0),A0=BigInt(1),BX=BigInt(2),$X=BigInt(7),FX=BigInt(256),zX=BigInt(113);for(let t=0,e=A0,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],b$.push(2*(5*r+n)),v$.push((t+1)*(t+2)/2%64);let s=LX;for(let i=0;i<7;i++)e=(e<<A0^(e>>$X)*zX)%FX,e&BX&&(s^=A0<<(A0<<BigInt(i))-A0);E$.push(s)}const[HX,VX]=m$(E$,!0),_3=(t,e,n)=>n>32?w$(t,e,n):g$(t,e,n),k3=(t,e,n)=>n>32?x$(t,e,n):y$(t,e,n);function WX(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,l=(o+2)%10,d=n[l],u=n[l+1],h=_3(d,u,1)^n[a],f=k3(d,u,1)^n[a+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=v$[o],l=_3(s,i,a),d=k3(s,i,a),u=b$[o];s=t[u],i=t[u+1],t[u]=l,t[u+1]=d}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=HX[r],t[1]^=VX[r]}n.fill(0)}let qX=class C$ extends TI{constructor(e,n,r,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,rE(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=oX(this.state)}keccak(){WX(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){mg(this);const{blockLen:n,state:r}=this;e=UC(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){mg(this,!1),SI(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return rE(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(c$(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new C$(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const KX=(t,e,n)=>_I(()=>new qX(e,t,n)),GX=KX(1,136,256/8);let N$=!1;const A$=function(t){return GX(t)};let S$=A$;function vr(t){const e=Rt(t,"data");return Be(S$(e))}vr._=A$;vr.lock=function(){N$=!0};vr.register=function(t){if(N$)throw new TypeError("keccak256 is locked");S$=t};Object.freeze(vr);const T$=function(t){return UX("sha256").update(t).digest()};let _$=T$,k$=!1;function Vg(t){const e=Rt(t,"data");return Be(_$(e))}Vg._=T$;Vg.lock=function(){k$=!0};Vg.register=function(t){if(k$)throw new Error("sha256 is locked");_$=t};Object.freeze(Vg);Object.freeze(Vg);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const I$=BigInt(0),LC=BigInt(1),YX=BigInt(2),BC=t=>t instanceof Uint8Array,QX=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function gg(t){if(!BC(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=QX[t[n]];return e}function R$(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function kI(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function yg(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const s=r*2,i=t.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function Wh(t){return kI(gg(t))}function II(t){if(!BC(t))throw new Error("Uint8Array expected");return kI(gg(Uint8Array.from(t).reverse()))}function wg(t,e){return yg(t.toString(16).padStart(e*2,"0"))}function RI(t,e){return wg(t,e).reverse()}function JX(t){return yg(R$(t))}function Xo(t,e,n){let r;if(typeof e=="string")try{r=yg(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(BC(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(`${t} expected ${n} bytes, got ${s}`);return r}function hw(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;return t.forEach(r=>{if(!BC(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function ZX(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function XX(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function eee(t){let e;for(e=0;t>I$;t>>=LC,e+=1);return e}function tee(t,e){return t>>BigInt(e)&LC}const nee=(t,e,n)=>t|(n?LC:I$)<<BigInt(e),jI=t=>(YX<<BigInt(t-1))-LC,pA=t=>new Uint8Array(t),I3=t=>Uint8Array.from(t);function j$(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=pA(t),s=pA(t),i=0;const o=()=>{r.fill(1),s.fill(0),i=0},a=(...h)=>n(s,r,...h),l=(h=pA())=>{s=a(I3([0]),h),r=a(),h.length!==0&&(s=a(I3([1]),h),r=a())},d=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){r=a();const p=r.slice();f.push(p),h+=r.length}return hw(...f)};return(h,f)=>{o(),l(h);let p;for(;!(p=f(d()));)l();return o(),p}}const ree={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Gx(t,e,n={}){const r=(s,i,o)=>{const a=ree[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const l=t[s];if(!(o&&l===void 0)&&!a(l,t))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${i}`)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}const see=Object.freeze(Object.defineProperty({__proto__:null,bitGet:tee,bitLen:eee,bitMask:jI,bitSet:nee,bytesToHex:gg,bytesToNumberBE:Wh,bytesToNumberLE:II,concatBytes:hw,createHmacDrbg:j$,ensureBytes:Xo,equalBytes:ZX,hexToBytes:yg,hexToNumber:kI,numberToBytesBE:wg,numberToBytesLE:RI,numberToHexUnpadded:R$,numberToVarBytesBE:JX,utf8ToBytes:XX,validateObject:Gx},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Hr=BigInt(0),ur=BigInt(1),Ku=BigInt(2),iee=BigInt(3),cT=BigInt(4),R3=BigInt(5),j3=BigInt(8);BigInt(9);BigInt(16);function mi(t,e){const n=t%e;return n>=Hr?n:e+n}function oee(t,e,n){if(n<=Hr||e<Hr)throw new Error("Expected power/modulo > 0");if(n===ur)return Hr;let r=ur;for(;e>Hr;)e&ur&&(r=r*t%n),t=t*t%n,e>>=ur;return r}function so(t,e,n){let r=t;for(;e-- >Hr;)r*=r,r%=n;return r}function lT(t,e){if(t===Hr||e<=Hr)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=mi(t,e),r=e,s=Hr,i=ur;for(;n!==Hr;){const a=r/n,l=r%n,d=s-i*a;r=n,n=l,s=i,i=d}if(r!==ur)throw new Error("invert: does not exist");return mi(s,e)}function aee(t){const e=(t-ur)/Ku;let n,r,s;for(n=t-ur,r=0;n%Ku===Hr;n/=Ku,r++);for(s=Ku;s<t&&oee(s,e,t)!==t-ur;s++);if(r===1){const o=(t+ur)/cT;return function(l,d){const u=l.pow(d,o);if(!l.eql(l.sqr(u),d))throw new Error("Cannot find square root");return u}}const i=(n+ur)/Ku;return function(a,l){if(a.pow(l,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let d=r,u=a.pow(a.mul(a.ONE,s),n),h=a.pow(l,i),f=a.pow(l,n);for(;!a.eql(f,a.ONE);){if(a.eql(f,a.ZERO))return a.ZERO;let p=1;for(let g=a.sqr(f);p<d&&!a.eql(g,a.ONE);p++)g=a.sqr(g);const m=a.pow(u,ur<<BigInt(d-p-1));u=a.sqr(m),h=a.mul(h,m),f=a.mul(f,u),d=p}return h}}function cee(t){if(t%cT===iee){const e=(t+ur)/cT;return function(r,s){const i=r.pow(s,e);if(!r.eql(r.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%j3===R3){const e=(t-R3)/j3;return function(r,s){const i=r.mul(s,Ku),o=r.pow(i,e),a=r.mul(s,o),l=r.mul(r.mul(a,Ku),o),d=r.mul(a,r.sub(l,r.ONE));if(!r.eql(r.sqr(d),s))throw new Error("Cannot find square root");return d}}return aee(t)}const lee=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function dee(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=lee.reduce((r,s)=>(r[s]="function",r),e);return Gx(t,n)}function uee(t,e,n){if(n<Hr)throw new Error("Expected power > 0");if(n===Hr)return t.ONE;if(n===ur)return e;let r=t.ONE,s=e;for(;n>Hr;)n&ur&&(r=t.mul(r,s)),s=t.sqr(s),n>>=ur;return r}function hee(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function P$(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function fee(t,e,n=!1,r={}){if(t<=Hr)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=P$(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=cee(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:jI(s),ZERO:Hr,ONE:ur,create:l=>mi(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return Hr<=l&&l<t},is0:l=>l===Hr,isOdd:l=>(l&ur)===ur,neg:l=>mi(-l,t),eql:(l,d)=>l===d,sqr:l=>mi(l*l,t),add:(l,d)=>mi(l+d,t),sub:(l,d)=>mi(l-d,t),mul:(l,d)=>mi(l*d,t),pow:(l,d)=>uee(a,l,d),div:(l,d)=>mi(l*lT(d,t),t),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>lT(l,t),sqrt:r.sqrt||(l=>o(a,l)),invertBatch:l=>hee(a,l),cmov:(l,d,u)=>u?d:l,toBytes:l=>n?RI(l,i):wg(l,i),fromBytes:l=>{if(l.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${l.length}`);return n?II(l):Wh(l)}});return Object.freeze(a)}function O$(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function D$(t){const e=O$(t);return e+Math.ceil(e/2)}function pee(t,e,n=!1){const r=t.length,s=O$(e),i=D$(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const o=n?Wh(t):II(t),a=mi(o,e-ur)+ur;return n?RI(a,s):wg(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mee=BigInt(0),mA=BigInt(1);function gee(t,e){const n=(s,i)=>{const o=i.negate();return s?o:i},r=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:n,unsafeLadder(s,i){let o=t.ZERO,a=s;for(;i>mee;)i&mA&&(o=o.add(a)),a=a.double(),i>>=mA;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=r(i),l=[];let d=s,u=d;for(let h=0;h<o;h++){u=d,l.push(u);for(let f=1;f<a;f++)u=u.add(d),l.push(u);d=u.double()}return l},wNAF(s,i,o){const{windows:a,windowSize:l}=r(s);let d=t.ZERO,u=t.BASE;const h=BigInt(2**s-1),f=2**s,p=BigInt(s);for(let m=0;m<a;m++){const g=m*l;let w=Number(o&h);o>>=p,w>l&&(w-=f,o+=mA);const b=g,y=g+Math.abs(w)-1,x=m%2!==0,v=w<0;w===0?u=u.add(n(x,i[b])):d=d.add(n(v,i[y]))}return{p:d,f:u}},wNAFCached(s,i,o,a){const l=s._WINDOW_SIZE||1;let d=i.get(s);return d||(d=this.precomputeWindow(s,l),l!==1&&i.set(s,a(d))),this.wNAF(l,d,o)}}}function M$(t){return dee(t.Fp),Gx(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...P$(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function yee(t){const e=M$(t);Gx(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:wee,hexToBytes:xee}=see,lh={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=lh;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:wee(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=lh,n=typeof t=="string"?xee(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=lh._parseInt(n.subarray(2)),{d:o,l:a}=lh._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,n=d=>{const u=d.toString(16);return u.length&1?`0${u}`:u},r=e(n(t.s)),s=e(n(t.r)),i=r.length/2,o=s.length/2,a=n(i),l=n(o);return`30${n(o+i+4)}02${l}${s}02${a}${r}`}},ll=BigInt(0),bo=BigInt(1);BigInt(2);const P3=BigInt(3);BigInt(4);function bee(t){const e=yee(t),{Fp:n}=e,r=e.toBytes||((m,g,w)=>{const b=g.toAffine();return hw(Uint8Array.from([4]),n.toBytes(b.x),n.toBytes(b.y))}),s=e.fromBytes||(m=>{const g=m.subarray(1),w=n.fromBytes(g.subarray(0,n.BYTES)),b=n.fromBytes(g.subarray(n.BYTES,2*n.BYTES));return{x:w,y:b}});function i(m){const{a:g,b:w}=e,b=n.sqr(m),y=n.mul(b,m);return n.add(n.add(y,n.mul(m,g)),w)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(m){return typeof m=="bigint"&&ll<m&&m<e.n}function a(m){if(!o(m))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(m){const{allowedPrivateKeyLengths:g,nByteLength:w,wrapPrivateKey:b,n:y}=e;if(g&&typeof m!="bigint"){if(m instanceof Uint8Array&&(m=gg(m)),typeof m!="string"||!g.includes(m.length))throw new Error("Invalid key");m=m.padStart(w*2,"0")}let x;try{x=typeof m=="bigint"?m:Wh(Xo("private key",m,w))}catch{throw new Error(`private key must be ${w} bytes, hex or bigint, not ${typeof m}`)}return b&&(x=mi(x,y)),a(x),x}const d=new Map;function u(m){if(!(m instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(g,w,b){if(this.px=g,this.py=w,this.pz=b,g==null||!n.isValid(g))throw new Error("x required");if(w==null||!n.isValid(w))throw new Error("y required");if(b==null||!n.isValid(b))throw new Error("z required")}static fromAffine(g){const{x:w,y:b}=g||{};if(!g||!n.isValid(w)||!n.isValid(b))throw new Error("invalid affine point");if(g instanceof h)throw new Error("projective point not allowed");const y=x=>n.eql(x,n.ZERO);return y(w)&&y(b)?h.ZERO:new h(w,b,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const w=n.invertBatch(g.map(b=>b.pz));return g.map((b,y)=>b.toAffine(w[y])).map(h.fromAffine)}static fromHex(g){const w=h.fromAffine(s(Xo("pointHex",g)));return w.assertValidity(),w}static fromPrivateKey(g){return h.BASE.multiply(l(g))}_setWindowSize(g){this._WINDOW_SIZE=g,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y:w}=this.toAffine();if(!n.isValid(g)||!n.isValid(w))throw new Error("bad point: x or y not FE");const b=n.sqr(w),y=i(g);if(!n.eql(b,y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(n.isOdd)return!n.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){u(g);const{px:w,py:b,pz:y}=this,{px:x,py:v,pz:E}=g,R=n.eql(n.mul(w,E),n.mul(x,y)),S=n.eql(n.mul(b,E),n.mul(v,y));return R&&S}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:g,b:w}=e,b=n.mul(w,P3),{px:y,py:x,pz:v}=this;let E=n.ZERO,R=n.ZERO,S=n.ZERO,C=n.mul(y,y),N=n.mul(x,x),T=n.mul(v,v),$=n.mul(y,x);return $=n.add($,$),S=n.mul(y,v),S=n.add(S,S),E=n.mul(g,S),R=n.mul(b,T),R=n.add(E,R),E=n.sub(N,R),R=n.add(N,R),R=n.mul(E,R),E=n.mul($,E),S=n.mul(b,S),T=n.mul(g,T),$=n.sub(C,T),$=n.mul(g,$),$=n.add($,S),S=n.add(C,C),C=n.add(S,C),C=n.add(C,T),C=n.mul(C,$),R=n.add(R,C),T=n.mul(x,v),T=n.add(T,T),C=n.mul(T,$),E=n.sub(E,C),S=n.mul(T,N),S=n.add(S,S),S=n.add(S,S),new h(E,R,S)}add(g){u(g);const{px:w,py:b,pz:y}=this,{px:x,py:v,pz:E}=g;let R=n.ZERO,S=n.ZERO,C=n.ZERO;const N=e.a,T=n.mul(e.b,P3);let $=n.mul(w,x),U=n.mul(b,v),H=n.mul(y,E),K=n.add(w,b),I=n.add(x,v);K=n.mul(K,I),I=n.add($,U),K=n.sub(K,I),I=n.add(w,y);let j=n.add(x,E);return I=n.mul(I,j),j=n.add($,H),I=n.sub(I,j),j=n.add(b,y),R=n.add(v,E),j=n.mul(j,R),R=n.add(U,H),j=n.sub(j,R),C=n.mul(N,I),R=n.mul(T,H),C=n.add(R,C),R=n.sub(U,C),C=n.add(U,C),S=n.mul(R,C),U=n.add($,$),U=n.add(U,$),H=n.mul(N,H),I=n.mul(T,I),U=n.add(U,H),H=n.sub($,H),H=n.mul(N,H),I=n.add(I,H),$=n.mul(U,I),S=n.add(S,$),$=n.mul(j,I),R=n.mul(K,R),R=n.sub(R,$),$=n.mul(K,U),C=n.mul(j,C),C=n.add(C,$),new h(R,S,C)}subtract(g){return this.add(g.negate())}is0(){return this.equals(h.ZERO)}wNAF(g){return p.wNAFCached(this,d,g,w=>{const b=n.invertBatch(w.map(y=>y.pz));return w.map((y,x)=>y.toAffine(b[x])).map(h.fromAffine)})}multiplyUnsafe(g){const w=h.ZERO;if(g===ll)return w;if(a(g),g===bo)return this;const{endo:b}=e;if(!b)return p.unsafeLadder(this,g);let{k1neg:y,k1:x,k2neg:v,k2:E}=b.splitScalar(g),R=w,S=w,C=this;for(;x>ll||E>ll;)x&bo&&(R=R.add(C)),E&bo&&(S=S.add(C)),C=C.double(),x>>=bo,E>>=bo;return y&&(R=R.negate()),v&&(S=S.negate()),S=new h(n.mul(S.px,b.beta),S.py,S.pz),R.add(S)}multiply(g){a(g);let w=g,b,y;const{endo:x}=e;if(x){const{k1neg:v,k1:E,k2neg:R,k2:S}=x.splitScalar(w);let{p:C,f:N}=this.wNAF(E),{p:T,f:$}=this.wNAF(S);C=p.constTimeNegate(v,C),T=p.constTimeNegate(R,T),T=new h(n.mul(T.px,x.beta),T.py,T.pz),b=C.add(T),y=N.add($)}else{const{p:v,f:E}=this.wNAF(w);b=v,y=E}return h.normalizeZ([b,y])[0]}multiplyAndAddUnsafe(g,w,b){const y=h.BASE,x=(E,R)=>R===ll||R===bo||!E.equals(y)?E.multiplyUnsafe(R):E.multiply(R),v=x(this,w).add(x(g,b));return v.is0()?void 0:v}toAffine(g){const{px:w,py:b,pz:y}=this,x=this.is0();g==null&&(g=x?n.ONE:n.inv(y));const v=n.mul(w,g),E=n.mul(b,g),R=n.mul(y,g);if(x)return{x:n.ZERO,y:n.ZERO};if(!n.eql(R,n.ONE))throw new Error("invZ was invalid");return{x:v,y:E}}isTorsionFree(){const{h:g,isTorsionFree:w}=e;if(g===bo)return!0;if(w)return w(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:w}=e;return g===bo?this:w?w(h,this):this.multiplyUnsafe(e.h)}toRawBytes(g=!0){return this.assertValidity(),r(h,this,g)}toHex(g=!0){return gg(this.toRawBytes(g))}}h.BASE=new h(e.Gx,e.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=e.nBitLength,p=gee(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:i,isWithinCurveOrder:o}}function vee(t){const e=M$(t);return Gx(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Eee(t){const e=vee(t),{Fp:n,n:r}=e,s=n.BYTES+1,i=2*n.BYTES+1;function o(I){return ll<I&&I<n.ORDER}function a(I){return mi(I,r)}function l(I){return lT(I,r)}const{ProjectivePoint:d,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:f}=bee({...e,toBytes(I,j,F){const P=j.toAffine(),L=n.toBytes(P.x),B=hw;return F?B(Uint8Array.from([j.hasEvenY()?2:3]),L):B(Uint8Array.from([4]),L,n.toBytes(P.y))},fromBytes(I){const j=I.length,F=I[0],P=I.subarray(1);if(j===s&&(F===2||F===3)){const L=Wh(P);if(!o(L))throw new Error("Point is not on curve");const B=h(L);let V=n.sqrt(B);const X=(V&bo)===bo;return(F&1)===1!==X&&(V=n.neg(V)),{x:L,y:V}}else if(j===i&&F===4){const L=n.fromBytes(P.subarray(0,n.BYTES)),B=n.fromBytes(P.subarray(n.BYTES,2*n.BYTES));return{x:L,y:B}}else throw new Error(`Point of length ${j} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),p=I=>gg(wg(I,e.nByteLength));function m(I){const j=r>>bo;return I>j}function g(I){return m(I)?a(-I):I}const w=(I,j,F)=>Wh(I.slice(j,F));class b{constructor(j,F,P){this.r=j,this.s=F,this.recovery=P,this.assertValidity()}static fromCompact(j){const F=e.nByteLength;return j=Xo("compactSignature",j,F*2),new b(w(j,0,F),w(j,F,2*F))}static fromDER(j){const{r:F,s:P}=lh.toSig(Xo("DER",j));return new b(F,P)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(j){return new b(this.r,this.s,j)}recoverPublicKey(j){const{r:F,s:P,recovery:L}=this,B=S(Xo("msgHash",j));if(L==null||![0,1,2,3].includes(L))throw new Error("recovery id invalid");const V=L===2||L===3?F+e.n:F;if(V>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const X=L&1?"03":"02",ae=d.fromHex(X+p(V)),ce=l(V),ie=a(-B*ce),Te=a(P*ce),ue=d.BASE.multiplyAndAddUnsafe(ae,ie,Te);if(!ue)throw new Error("point at infinify");return ue.assertValidity(),ue}hasHighS(){return m(this.s)}normalizeS(){return this.hasHighS()?new b(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return yg(this.toDERHex())}toDERHex(){return lh.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return yg(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}const y={isValidPrivateKey(I){try{return u(I),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const I=D$(e.n);return pee(e.randomBytes(I),e.n)},precompute(I=8,j=d.BASE){return j._setWindowSize(I),j.multiply(BigInt(3)),j}};function x(I,j=!0){return d.fromPrivateKey(I).toRawBytes(j)}function v(I){const j=I instanceof Uint8Array,F=typeof I=="string",P=(j||F)&&I.length;return j?P===s||P===i:F?P===2*s||P===2*i:I instanceof d}function E(I,j,F=!0){if(v(I))throw new Error("first arg must be private key");if(!v(j))throw new Error("second arg must be public key");return d.fromHex(j).multiply(u(I)).toRawBytes(F)}const R=e.bits2int||function(I){const j=Wh(I),F=I.length*8-e.nBitLength;return F>0?j>>BigInt(F):j},S=e.bits2int_modN||function(I){return a(R(I))},C=jI(e.nBitLength);function N(I){if(typeof I!="bigint")throw new Error("bigint expected");if(!(ll<=I&&I<C))throw new Error(`bigint expected < 2^${e.nBitLength}`);return wg(I,e.nByteLength)}function T(I,j,F=$){if(["recovered","canonical"].some(xe=>xe in F))throw new Error("sign() legacy options not supported");const{hash:P,randomBytes:L}=e;let{lowS:B,prehash:V,extraEntropy:X}=F;B==null&&(B=!0),I=Xo("msgHash",I),V&&(I=Xo("prehashed msgHash",P(I)));const ae=S(I),ce=u(j),ie=[N(ce),N(ae)];if(X!=null){const xe=X===!0?L(n.BYTES):X;ie.push(Xo("extraEntropy",xe))}const Te=hw(...ie),ue=ae;function Q(xe){const Pe=R(xe);if(!f(Pe))return;const Y=l(Pe),me=d.BASE.multiply(Pe).toAffine(),le=a(me.x);if(le===ll)return;const tt=a(Y*a(ue+le*ce));if(tt===ll)return;let Ve=(me.x===le?0:2)|Number(me.y&bo),Ue=tt;return B&&m(tt)&&(Ue=g(tt),Ve^=1),new b(le,Ue,Ve)}return{seed:Te,k2sig:Q}}const $={lowS:e.lowS,prehash:!1},U={lowS:e.lowS,prehash:!1};function H(I,j,F=$){const{seed:P,k2sig:L}=T(I,j,F),B=e;return j$(B.hash.outputLen,B.nByteLength,B.hmac)(P,L)}d.BASE._setWindowSize(8);function K(I,j,F,P=U){var me;const L=I;if(j=Xo("msgHash",j),F=Xo("publicKey",F),"strict"in P)throw new Error("options.strict was renamed to lowS");const{lowS:B,prehash:V}=P;let X,ae;try{if(typeof L=="string"||L instanceof Uint8Array)try{X=b.fromDER(L)}catch(le){if(!(le instanceof lh.Err))throw le;X=b.fromCompact(L)}else if(typeof L=="object"&&typeof L.r=="bigint"&&typeof L.s=="bigint"){const{r:le,s:tt}=L;X=new b(le,tt)}else throw new Error("PARSE");ae=d.fromHex(F)}catch(le){if(le.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(B&&X.hasHighS())return!1;V&&(j=e.hash(j));const{r:ce,s:ie}=X,Te=S(j),ue=l(ie),Q=a(Te*ue),xe=a(ce*ue),Pe=(me=d.BASE.multiplyAndAddUnsafe(ae,Q,xe))==null?void 0:me.toAffine();return Pe?a(Pe.x)===ce:!1}return{CURVE:e,getPublicKey:x,getSharedSecret:E,sign:H,verify:K,ProjectivePoint:d,Signature:b,utils:y}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Cee(t){return{hash:t,hmac:(e,...n)=>u$(t,e,lX(...n)),randomBytes:dX}}function Nee(t,e){const n=r=>Eee({...t,...Cee(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const U$=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),O3=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Aee=BigInt(1),dT=BigInt(2),D3=(t,e)=>(t+e/dT)/e;function See(t){const e=U$,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),l=BigInt(88),d=t*t*t%e,u=d*d*t%e,h=so(u,n,e)*u%e,f=so(h,n,e)*u%e,p=so(f,dT,e)*d%e,m=so(p,s,e)*p%e,g=so(m,i,e)*m%e,w=so(g,a,e)*g%e,b=so(w,l,e)*w%e,y=so(b,a,e)*g%e,x=so(y,n,e)*u%e,v=so(x,o,e)*m%e,E=so(v,r,e)*d%e,R=so(E,dT,e);if(!uT.eql(uT.sqr(R),t))throw new Error("Cannot find square root");return R}const uT=fee(U$,void 0,void 0,{sqrt:See}),rd=Nee({a:BigInt(0),b:BigInt(7),Fp:uT,n:O3,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=O3,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Aee*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=D3(i*t,e),l=D3(-r*t,e);let d=mi(t-a*n-l*s,e),u=mi(-a*r-l*i,e);const h=d>o,f=u>o;if(h&&(d=e-d),f&&(u=e-u),d>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:d,k2neg:f,k2:u}}}},f$);BigInt(0);rd.ProjectivePoint;const fw="0x0000000000000000000000000000000000000000",M3="0x0000000000000000000000000000000000000000000000000000000000000000",U3=BigInt(0),L3=BigInt(1),B3=BigInt(2),$3=BigInt(27),F3=BigInt(28),Wb=BigInt(35),Wf={};function z3(t){return Sl(Or(t),32)}var vm,qa,Em,jh;const Jo=class Jo{constructor(e,n,r,s){se(this,vm);se(this,qa);se(this,Em);se(this,jh);qx(e,Wf,"Signature"),z(this,vm,n),z(this,qa,r),z(this,Em,s),z(this,jh,null)}get r(){return k(this,vm)}set r(e){Z(rm(e)===32,"invalid r","value",e),z(this,vm,Be(e))}get s(){return Z(parseInt(k(this,qa).substring(0,3))<8,"non-canonical s; use ._s","s",k(this,qa)),k(this,qa)}set s(e){Z(rm(e)===32,"invalid s","value",e),z(this,qa,Be(e))}get _s(){return k(this,qa)}isValid(){return parseInt(k(this,qa).substring(0,3))<8}get v(){return k(this,Em)}set v(e){const n=St(e,"value");Z(n===27||n===28,"invalid v","v",e),z(this,Em,n)}get networkV(){return k(this,jh)}get legacyChainId(){const e=this.networkV;return e==null?null:Jo.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=Rt(this.s);return this.yParity&&(e[0]|=128),Be(e)}get compactSerialized(){return ir([this.r,this.yParityAndS])}get serialized(){return ir([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Jo(Wf,this.r,this._s,this.v);return this.networkV&&z(e,jh,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const n=Je(e,"v");return n==$3||n==F3?U3:(Z(n>=Wb,"invalid EIP-155 v","v",e),(n-Wb)/B3)}static getChainIdV(e,n){return Je(e)*B3+BigInt(35+n-27)}static getNormalizedV(e){const n=Je(e);return n===U3||n===$3?27:n===L3||n===F3?28:(Z(n>=Wb,"invalid v","v",e),n&L3?27:28)}static from(e){function n(d,u){Z(d,u,"signature",e)}if(e==null)return new Jo(Wf,M3,M3,27);if(typeof e=="string"){const d=Rt(e,"signature");if(d.length===64){const u=Be(d.slice(0,32)),h=d.slice(32,64),f=h[0]&128?28:27;return h[0]&=127,new Jo(Wf,u,Be(h),f)}if(d.length===65){const u=Be(d.slice(0,32)),h=Be(d.slice(32,64)),f=Jo.getNormalizedV(d[64]);return new Jo(Wf,u,h,f)}n(!1,"invalid raw signature length")}if(e instanceof Jo)return e.clone();const r=e.r;n(r!=null,"missing r");const s=z3(r),i=function(d,u){if(d!=null)return z3(d);if(u!=null){n(Tn(u,32),"invalid yParityAndS");const h=Rt(u);return h[0]&=127,Be(h)}n(!1,"missing s")}(e.s,e.yParityAndS),{networkV:o,v:a}=function(d,u,h){if(d!=null){const f=Je(d);return{networkV:f>=Wb?f:void 0,v:Jo.getNormalizedV(f)}}if(u!=null)return n(Tn(u,32),"invalid yParityAndS"),{v:Rt(u)[0]&128?28:27};if(h!=null){switch(St(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}n(!1,"invalid yParity")}n(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),l=new Jo(Wf,s,i,a);return o&&z(l,jh,o),n(e.yParity==null||St(e.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),n(e.yParityAndS==null||e.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};vm=new WeakMap,qa=new WeakMap,Em=new WeakMap,jh=new WeakMap;let Ti=Jo;var el;const Zu=class Zu{constructor(e){se(this,el);Z(rm(e)===32,"invalid private key","privateKey","[REDACTED]"),z(this,el,Be(e))}get privateKey(){return k(this,el)}get publicKey(){return Zu.computePublicKey(k(this,el))}get compressedPublicKey(){return Zu.computePublicKey(k(this,el),!0)}sign(e){Z(rm(e)===32,"invalid digest length","digest",e);const n=rd.sign(Fs(e),Fs(k(this,el)),{lowS:!0});return Ti.from({r:su(n.r,32),s:su(n.s,32),v:n.recovery?28:27})}computeSharedSecret(e){const n=Zu.computePublicKey(e);return Be(rd.getSharedSecret(Fs(k(this,el)),Rt(n),!1))}static computePublicKey(e,n){let r=Rt(e,"key");if(r.length===32){const i=rd.getPublicKey(r,!!n);return Be(i)}if(r.length===64){const i=new Uint8Array(65);i[0]=4,i.set(r,1),r=i}const s=rd.ProjectivePoint.fromHex(r);return Be(s.toRawBytes(n))}static recoverPublicKey(e,n){Z(rm(e)===32,"invalid digest length","digest",e);const r=Ti.from(n);let s=rd.Signature.fromCompact(Fs(ir([r.r,r.s])));s=s.addRecoveryBit(r.yParity);const i=s.recoverPublicKey(Fs(e));return Z(i!=null,"invalid signature for digest","signature",n),"0x"+i.toHex(!1)}static addPoints(e,n,r){const s=rd.ProjectivePoint.fromHex(Zu.computePublicKey(e).substring(2)),i=rd.ProjectivePoint.fromHex(Zu.computePublicKey(n).substring(2));return"0x"+s.add(i).toHex(!!r)}};el=new WeakMap;let pw=Zu;const Tee=BigInt(0),_ee=BigInt(36);function H3(t){t=t.toLowerCase();const e=t.substring(2).split(""),n=new Uint8Array(40);for(let s=0;s<40;s++)n[s]=e[s].charCodeAt(0);const r=Rt(vr(n));for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(r[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const PI={};for(let t=0;t<10;t++)PI[String(t)]=String(t);for(let t=0;t<26;t++)PI[String.fromCharCode(65+t)]=String(10+t);const V3=15;function kee(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(r=>PI[r]).join("");for(;e.length>=V3;){let r=e.substring(0,V3);e=parseInt(r,10)%97+e.substring(r.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}const Iee=function(){const t={};for(let e=0;e<36;e++){const n="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[n]=BigInt(e)}return t}();function Ree(t){t=t.toLowerCase();let e=Tee;for(let n=0;n<t.length;n++)e=e*_ee+Iee[t[n]];return e}function dn(t){if(Z(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=H3(t);return Z(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){Z(t.substring(2,4)===kee(t),"bad icap checksum","address",t);let e=Ree(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return H3("0x"+e)}Z(!1,"invalid address","address",t)}function jee(t){const e=dn(t.from);let r=Je(t.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,dn(Xn(vr(iu([e,r])),12))}function L$(t){return t&&typeof t.getAddress=="function"}async function gA(t,e){const n=await e;return(n==null||n==="0x0000000000000000000000000000000000000000")&&(ge(typeof t!="string","unconfigured name","UNCONFIGURED_NAME",{value:t}),Z(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),dn(n)}function Hs(t,e){if(typeof t=="string")return t.match(/^0x[0-9a-f]{40}$/i)?dn(t):(ge(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),gA(t,e.resolveName(t)));if(L$(t))return gA(t,t.getAddress());if(t&&typeof t.then=="function")return gA(t,t);Z(!1,"unsupported addressable value","target",t)}const Wc={};function Ye(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new Rs(Wc,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function tn(t,e){return new Rs(Wc,`bytes${e||""}`,t,{size:e})}const W3=Symbol.for("_ethers_typed");var Ph;const Kc=class Kc{constructor(e,n,r,s){q(this,"type");q(this,"value");se(this,Ph);q(this,"_typedSymbol");s==null&&(s=null),qx(Wc,e,"Typed"),yt(this,{_typedSymbol:W3,type:n,value:r}),z(this,Ph,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return k(this,Ph)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return k(this,Ph)===!0?-1:k(this,Ph)===!1?this.value.length:null}static from(e,n){return new Kc(Wc,e,n)}static uint8(e){return Ye(e,8)}static uint16(e){return Ye(e,16)}static uint24(e){return Ye(e,24)}static uint32(e){return Ye(e,32)}static uint40(e){return Ye(e,40)}static uint48(e){return Ye(e,48)}static uint56(e){return Ye(e,56)}static uint64(e){return Ye(e,64)}static uint72(e){return Ye(e,72)}static uint80(e){return Ye(e,80)}static uint88(e){return Ye(e,88)}static uint96(e){return Ye(e,96)}static uint104(e){return Ye(e,104)}static uint112(e){return Ye(e,112)}static uint120(e){return Ye(e,120)}static uint128(e){return Ye(e,128)}static uint136(e){return Ye(e,136)}static uint144(e){return Ye(e,144)}static uint152(e){return Ye(e,152)}static uint160(e){return Ye(e,160)}static uint168(e){return Ye(e,168)}static uint176(e){return Ye(e,176)}static uint184(e){return Ye(e,184)}static uint192(e){return Ye(e,192)}static uint200(e){return Ye(e,200)}static uint208(e){return Ye(e,208)}static uint216(e){return Ye(e,216)}static uint224(e){return Ye(e,224)}static uint232(e){return Ye(e,232)}static uint240(e){return Ye(e,240)}static uint248(e){return Ye(e,248)}static uint256(e){return Ye(e,256)}static uint(e){return Ye(e,256)}static int8(e){return Ye(e,-8)}static int16(e){return Ye(e,-16)}static int24(e){return Ye(e,-24)}static int32(e){return Ye(e,-32)}static int40(e){return Ye(e,-40)}static int48(e){return Ye(e,-48)}static int56(e){return Ye(e,-56)}static int64(e){return Ye(e,-64)}static int72(e){return Ye(e,-72)}static int80(e){return Ye(e,-80)}static int88(e){return Ye(e,-88)}static int96(e){return Ye(e,-96)}static int104(e){return Ye(e,-104)}static int112(e){return Ye(e,-112)}static int120(e){return Ye(e,-120)}static int128(e){return Ye(e,-128)}static int136(e){return Ye(e,-136)}static int144(e){return Ye(e,-144)}static int152(e){return Ye(e,-152)}static int160(e){return Ye(e,-160)}static int168(e){return Ye(e,-168)}static int176(e){return Ye(e,-176)}static int184(e){return Ye(e,-184)}static int192(e){return Ye(e,-192)}static int200(e){return Ye(e,-200)}static int208(e){return Ye(e,-208)}static int216(e){return Ye(e,-216)}static int224(e){return Ye(e,-224)}static int232(e){return Ye(e,-232)}static int240(e){return Ye(e,-240)}static int248(e){return Ye(e,-248)}static int256(e){return Ye(e,-256)}static int(e){return Ye(e,-256)}static bytes1(e){return tn(e,1)}static bytes2(e){return tn(e,2)}static bytes3(e){return tn(e,3)}static bytes4(e){return tn(e,4)}static bytes5(e){return tn(e,5)}static bytes6(e){return tn(e,6)}static bytes7(e){return tn(e,7)}static bytes8(e){return tn(e,8)}static bytes9(e){return tn(e,9)}static bytes10(e){return tn(e,10)}static bytes11(e){return tn(e,11)}static bytes12(e){return tn(e,12)}static bytes13(e){return tn(e,13)}static bytes14(e){return tn(e,14)}static bytes15(e){return tn(e,15)}static bytes16(e){return tn(e,16)}static bytes17(e){return tn(e,17)}static bytes18(e){return tn(e,18)}static bytes19(e){return tn(e,19)}static bytes20(e){return tn(e,20)}static bytes21(e){return tn(e,21)}static bytes22(e){return tn(e,22)}static bytes23(e){return tn(e,23)}static bytes24(e){return tn(e,24)}static bytes25(e){return tn(e,25)}static bytes26(e){return tn(e,26)}static bytes27(e){return tn(e,27)}static bytes28(e){return tn(e,28)}static bytes29(e){return tn(e,29)}static bytes30(e){return tn(e,30)}static bytes31(e){return tn(e,31)}static bytes32(e){return tn(e,32)}static address(e){return new Kc(Wc,"address",e)}static bool(e){return new Kc(Wc,"bool",!!e)}static bytes(e){return new Kc(Wc,"bytes",e)}static string(e){return new Kc(Wc,"string",e)}static array(e,n){throw new Error("not implemented yet")}static tuple(e,n){throw new Error("not implemented yet")}static overrides(e){return new Kc(Wc,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===W3}static dereference(e,n){if(Kc.isTyped(e)){if(e.type!==n)throw new Error(`invalid type: expecetd ${n}, got ${e.type}`);return e.value}return e}};Ph=new WeakMap;let Rs=Kc;class Pee extends Dl{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,n){let r=Rs.dereference(n,"string");try{r=dn(r)}catch(s){return this._throwError(s.message,n)}return e.writeValue(r)}decode(e){return dn(su(e.readValue(),20))}}class Oee extends Dl{constructor(n){super(n.name,n.type,"_",n.dynamic);q(this,"coder");this.coder=n}defaultValue(){return this.coder.defaultValue()}encode(n,r){return this.coder.encode(n,r)}decode(n){return this.coder.decode(n)}}function B$(t,e,n){let r=[];if(Array.isArray(n))r=n;else if(n&&typeof n=="object"){let l={};r=e.map(d=>{const u=d.localName;return ge(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:n}),ge(!l[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:n}),l[u]=!0,n[u]})}else Z(!1,"invalid tuple value","tuple",n);Z(e.length===r.length,"types/value length mismatch","tuple",n);let s=new sT,i=new sT,o=[];e.forEach((l,d)=>{let u=r[d];if(l.dynamic){let h=i.length;l.encode(i,u);let f=s.writeUpdatableValue();o.push(p=>{f(p+h)})}else l.encode(s,u)}),o.forEach(l=>{l(s.length)});let a=t.appendWriter(s);return a+=t.appendWriter(i),a}function $$(t,e){let n=[],r=[],s=t.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=t.readIndex(),l=s.subReader(a);try{o=i.decode(l)}catch(d){if(rs(d,"BUFFER_OVERRUN"))throw d;o=d,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(t)}catch(a){if(rs(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");n.push(o),r.push(i.localName||null)}),pg.fromItems(n,r)}class Dee extends Dl{constructor(n,r,s){const i=n.type+"["+(r>=0?r:"")+"]",o=r===-1||n.dynamic;super("array",i,s,o);q(this,"coder");q(this,"length");yt(this,{coder:n,length:r})}defaultValue(){const n=this.coder.defaultValue(),r=[];for(let s=0;s<this.length;s++)r.push(n);return r}encode(n,r){const s=Rs.dereference(r,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,n.writeValue(s.length)),KB(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return B$(n,o,s)}decode(n){let r=this.length;r===-1&&(r=n.readIndex(),ge(r*zs<=n.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:n.bytes,offset:r*zs,length:n.dataLength}));let s=[];for(let i=0;i<r;i++)s.push(new Oee(this.coder));return $$(n,s)}}class Mee extends Dl{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,n){const r=Rs.dereference(n,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class F$ extends Dl{constructor(e,n){super(e,e,n,!0)}defaultValue(){return"0x"}encode(e,n){n=Fs(n);let r=e.writeValue(n.length);return r+=e.writeBytes(n),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class Uee extends F${constructor(e){super("bytes",e)}decode(e){return Be(super.decode(e))}}class Lee extends Dl{constructor(n,r){let s="bytes"+String(n);super(s,s,r,!1);q(this,"size");yt(this,{size:n},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(n,r){let s=Fs(Rs.dereference(r,this.type));return s.length!==this.size&&this._throwError("incorrect data length",r),n.writeBytes(s)}decode(n){return Be(n.readBytes(this.size))}}const Bee=new Uint8Array([]);class $ee extends Dl{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,n){return n!=null&&this._throwError("not null",n),e.writeBytes(Bee)}decode(e){return e.readBytes(0),null}}const Fee=BigInt(0),zee=BigInt(1),Hee=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Vee extends Dl{constructor(n,r,s){const i=(r?"int":"uint")+n*8;super(i,i,s,!1);q(this,"size");q(this,"signed");yt(this,{size:n,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(n,r){let s=Je(Rs.dereference(r,this.type)),i=ch(Hee,zs*8);if(this.signed){let o=ch(i,this.size*8-1);(s>o||s<-(o+zee))&&this._throwError("value out-of-bounds",r),s=QB(s,8*zs)}else(s<Fee||s>ch(i,this.size*8))&&this._throwError("value out-of-bounds",r);return n.writeValue(s)}decode(n){let r=ch(n.readValue(),this.size*8);return this.signed&&(r=eE(r,this.size*8)),r}}class Wee extends F${constructor(e){super("string",e)}defaultValue(){return""}encode(e,n){return super.encode(e,mc(Rs.dereference(n,"string")))}decode(e){return tE(super.decode(e))}}class qb extends Dl{constructor(n,r){let s=!1;const i=[];n.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,r,s);q(this,"coders");yt(this,{coders:Object.freeze(n.slice())})}defaultValue(){const n=[];this.coders.forEach(s=>{n.push(s.defaultValue())});const r=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||r[o]!==1||(o==="length"&&(o="_length"),n[o]==null&&(n[o]=n[i]))}),Object.freeze(n)}encode(n,r){const s=Rs.dereference(r,"tuple");return B$(n,this.coders,s)}decode(n){return $$(n,this.coders)}}function yA(t,e){return{address:dn(t),storageKeys:e.map((n,r)=>(Z(Tn(n,32),"invalid slot",`storageKeys[${r}]`,n),n.toLowerCase()))}}function _f(t){if(Array.isArray(t))return t.map((n,r)=>Array.isArray(n)?(Z(n.length===2,"invalid slot set",`value[${r}]`,n),yA(n[0],n[1])):(Z(n!=null&&typeof n=="object","invalid address-slot set","value",t),yA(n.address,n.storageKeys)));Z(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(n=>{const r=t[n].reduce((s,i)=>(s[i]=!0,s),{});return yA(n,Object.keys(r).sort())});return e.sort((n,r)=>n.address.localeCompare(r.address)),e}function z$(t){return{address:dn(t.address),nonce:Je(t.nonce!=null?t.nonce:0),chainId:Je(t.chainId!=null?t.chainId:0),signature:Ti.from(t.signature)}}function qee(t){let e;return typeof t=="string"?e=pw.computePublicKey(t,!1):e=t.publicKey,dn(vr("0x"+e.substring(4)).substring(26))}function Kee(t,e){return qee(pw.recoverPublicKey(t,e))}const Fr=BigInt(0),Gee=BigInt(2),Yee=BigInt(27),Qee=BigInt(28),Jee=BigInt(35),Zee=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),wA=4096*32;function Xee(t){return{blobToKzgCommitment:r=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return Rt(t.blobToKzgCommitment(Be(r)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return Rt(t.blobToKzgCommitment(r));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return Rt(t.blobToKZGCommitment(Be(r)));Z(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(r,s)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return Rt(t.computeBlobProof(Be(r),Be(s)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(r,s);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return Rt(t.computeBlobKZGProof(Be(r),Be(s)));Z(!1,"unsupported KZG library","kzg",t)}}}function q3(t,e){let n=t.toString(16);for(;n.length<2;)n="0"+n;return n+=Vg(e).substring(4),"0x"+n}function Wg(t){return t==="0x"?null:dn(t)}function $C(t,e){try{return _f(t)}catch(n){Z(!1,n.message,e,t)}}function ete(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const n=[];for(let r=0;r<t.length;r++){const s=t[r];if(!Array.isArray(s))throw new Error(`authorization[${r}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!s[1])throw new Error(`authorization[${r}]: null address`);n.push({address:Wg(s[1]),nonce:Cn(s[2],"nonce"),chainId:Cn(s[0],"chainId"),signature:Ti.from({yParity:kf(s[3],"yParity"),r:Sl(s[4],32),s:Sl(s[5],32)})})}return n}catch(n){Z(!1,n.message,e,t)}}function kf(t,e){return t==="0x"?0:St(t,e)}function Cn(t,e){if(t==="0x")return Fr;const n=Je(t,e);return Z(n<=Zee,"value exceeds uint size",e,n),n}function Kt(t,e){const n=Je(t,"value"),r=Or(n);return Z(r.length<=32,"value too large",`tx.${e}`,n),r}function FC(t){return _f(t).map(e=>[e.address,e.storageKeys])}function tte(t){return t.map(e=>[Kt(e.chainId,"chainId"),e.address,Kt(e.nonce,"nonce"),Kt(e.signature.yParity,"yParity"),Or(e.signature.r),Or(e.signature.s)])}function nte(t,e){Z(Array.isArray(t),`invalid ${e}`,"value",t);for(let n=0;n<t.length;n++)Z(Tn(t[n],32),"invalid ${ param } hash",`value[${n}]`,t[n]);return t}function rte(t){const e=Kx(t);Z(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const n={type:0,nonce:kf(e[0],"nonce"),gasPrice:Cn(e[1],"gasPrice"),gasLimit:Cn(e[2],"gasLimit"),to:Wg(e[3]),value:Cn(e[4],"value"),data:Be(e[5]),chainId:Fr};if(e.length===6)return n;const r=Cn(e[6],"v"),s=Cn(e[7],"r"),i=Cn(e[8],"s");if(s===Fr&&i===Fr)n.chainId=r;else{let o=(r-Jee)/Gee;o<Fr&&(o=Fr),n.chainId=o,Z(o!==Fr||r===Yee||r===Qee,"non-canonical legacy v","v",e[6]),n.signature=Ti.from({r:Sl(e[7],32),s:Sl(e[8],32),v:r})}return n}function ste(t,e){const n=[Kt(t.nonce,"nonce"),Kt(t.gasPrice||0,"gasPrice"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data];let r=Fr;if(t.chainId!=Fr)r=Je(t.chainId,"tx.chainId"),Z(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const i=t.signature.legacyChainId;i!=null&&(r=i)}if(!e)return r!==Fr&&(n.push(Or(r)),n.push("0x"),n.push("0x")),iu(n);let s=BigInt(27+e.yParity);return r!==Fr?s=Ti.getChainIdV(r,e.v):BigInt(e.v)!==s&&Z(!1,"tx.chainId/sig.v mismatch","sig",e),n.push(Or(s)),n.push(Or(e.r)),n.push(Or(e.s)),iu(n)}function zC(t,e){let n;try{if(n=kf(e[0],"yParity"),n!==0&&n!==1)throw new Error("bad yParity")}catch{Z(!1,"invalid yParity","yParity",e[0])}const r=Sl(e[1],32),s=Sl(e[2],32),i=Ti.from({r,s,yParity:n});t.signature=i}function ite(t){const e=Kx(Rt(t).slice(1));Z(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",Be(t));const n={type:2,chainId:Cn(e[0],"chainId"),nonce:kf(e[1],"nonce"),maxPriorityFeePerGas:Cn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Cn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Cn(e[4],"gasLimit"),to:Wg(e[5]),value:Cn(e[6],"value"),data:Be(e[7]),accessList:$C(e[8],"accessList")};return e.length===9||zC(n,e.slice(9)),n}function ote(t,e){const n=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Kt(t.maxFeePerGas||0,"maxFeePerGas"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data,FC(t.accessList||[])];return e&&(n.push(Kt(e.yParity,"yParity")),n.push(Or(e.r)),n.push(Or(e.s))),ir(["0x02",iu(n)])}function ate(t){const e=Kx(Rt(t).slice(1));Z(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",Be(t));const n={type:1,chainId:Cn(e[0],"chainId"),nonce:kf(e[1],"nonce"),gasPrice:Cn(e[2],"gasPrice"),gasLimit:Cn(e[3],"gasLimit"),to:Wg(e[4]),value:Cn(e[5],"value"),data:Be(e[6]),accessList:$C(e[7],"accessList")};return e.length===8||zC(n,e.slice(8)),n}function cte(t,e){const n=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.gasPrice||0,"gasPrice"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data,FC(t.accessList||[])];return e&&(n.push(Kt(e.yParity,"recoveryParam")),n.push(Or(e.r)),n.push(Or(e.s))),ir(["0x01",iu(n)])}function lte(t){let e=Kx(Rt(t).slice(1)),n="3",r=null;if(e.length===4&&Array.isArray(e[0])){n="3 (network format)";const i=e[1],o=e[2],a=e[3];Z(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),Z(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),Z(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),Z(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),Z(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let l=0;l<e[1].length;l++)r.push({data:i[l],commitment:o[l],proof:a[l]});e=e[0]}Z(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${n}`,"data",Be(t));const s={type:3,chainId:Cn(e[0],"chainId"),nonce:kf(e[1],"nonce"),maxPriorityFeePerGas:Cn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Cn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Cn(e[4],"gasLimit"),to:Wg(e[5]),value:Cn(e[6],"value"),data:Be(e[7]),accessList:$C(e[8],"accessList"),maxFeePerBlobGas:Cn(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(s.blobs=r),Z(s.to!=null,`invalid address for transaction type: ${n}`,"data",t),Z(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let i=0;i<s.blobVersionedHashes.length;i++)Z(Tn(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",t);return e.length===11||zC(s,e.slice(11)),s}function dte(t,e,n){const r=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Kt(t.maxFeePerGas||0,"maxFeePerGas"),Kt(t.gasLimit,"gasLimit"),t.to||fw,Kt(t.value,"value"),t.data,FC(t.accessList||[]),Kt(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),nte(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Kt(e.yParity,"yParity")),r.push(Or(e.r)),r.push(Or(e.s)),n)?ir(["0x03",iu([r,n.map(s=>s.data),n.map(s=>s.commitment),n.map(s=>s.proof)])]):ir(["0x03",iu(r)])}function ute(t){const e=Kx(Rt(t).slice(1));Z(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",Be(t));const n={type:4,chainId:Cn(e[0],"chainId"),nonce:kf(e[1],"nonce"),maxPriorityFeePerGas:Cn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Cn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Cn(e[4],"gasLimit"),to:Wg(e[5]),value:Cn(e[6],"value"),data:Be(e[7]),accessList:$C(e[8],"accessList"),authorizationList:ete(e[9],"authorizationList")};return e.length===10||zC(n,e.slice(10)),n}function hte(t,e){const n=[Kt(t.chainId,"chainId"),Kt(t.nonce,"nonce"),Kt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Kt(t.maxFeePerGas||0,"maxFeePerGas"),Kt(t.gasLimit,"gasLimit"),t.to||"0x",Kt(t.value,"value"),t.data,FC(t.accessList||[]),tte(t.authorizationList||[])];return e&&(n.push(Kt(e.yParity,"yParity")),n.push(Or(e.r)),n.push(Or(e.s))),ir(["0x04",iu(n)])}var sa,Cm,Nm,Am,Sm,Tm,_m,km,Im,Rm,jm,Pm,Oh,Cd,Ka,Nd,Om,Dm,Qv;const Ha=class Ha{constructor(){se(this,Dm);se(this,sa);se(this,Cm);se(this,Nm);se(this,Am);se(this,Sm);se(this,Tm);se(this,_m);se(this,km);se(this,Im);se(this,Rm);se(this,jm);se(this,Pm);se(this,Oh);se(this,Cd);se(this,Ka);se(this,Nd);se(this,Om);z(this,sa,null),z(this,Cm,null),z(this,Am,0),z(this,Sm,Fr),z(this,Tm,null),z(this,_m,null),z(this,km,null),z(this,Nm,"0x"),z(this,Im,Fr),z(this,Rm,Fr),z(this,jm,null),z(this,Pm,null),z(this,Oh,null),z(this,Cd,null),z(this,Ka,null),z(this,Nd,null),z(this,Om,null)}get type(){return k(this,sa)}set type(e){switch(e){case null:z(this,sa,null);break;case 0:case"legacy":z(this,sa,0);break;case 1:case"berlin":case"eip-2930":z(this,sa,1);break;case 2:case"london":case"eip-1559":z(this,sa,2);break;case 3:case"cancun":case"eip-4844":z(this,sa,3);break;case 4:case"pectra":case"eip-7702":z(this,sa,4);break;default:Z(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=k(this,Cm);return e==null&&this.type===3?fw:e}set to(e){z(this,Cm,e==null?null:dn(e))}get nonce(){return k(this,Am)}set nonce(e){z(this,Am,St(e,"value"))}get gasLimit(){return k(this,Sm)}set gasLimit(e){z(this,Sm,Je(e))}get gasPrice(){const e=k(this,Tm);return e==null&&(this.type===0||this.type===1)?Fr:e}set gasPrice(e){z(this,Tm,e==null?null:Je(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=k(this,_m);return e??(this.type===2||this.type===3?Fr:null)}set maxPriorityFeePerGas(e){z(this,_m,e==null?null:Je(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=k(this,km);return e??(this.type===2||this.type===3?Fr:null)}set maxFeePerGas(e){z(this,km,e==null?null:Je(e,"maxFeePerGas"))}get data(){return k(this,Nm)}set data(e){z(this,Nm,Be(e))}get value(){return k(this,Im)}set value(e){z(this,Im,Je(e,"value"))}get chainId(){return k(this,Rm)}set chainId(e){z(this,Rm,Je(e))}get signature(){return k(this,jm)||null}set signature(e){z(this,jm,e==null?null:Ti.from(e))}get accessList(){const e=k(this,Pm)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){z(this,Pm,e==null?null:_f(e))}get authorizationList(){const e=k(this,Om)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){z(this,Om,e==null?null:e.map(n=>z$(n)))}get maxFeePerBlobGas(){const e=k(this,Oh);return e==null&&this.type===3?Fr:e}set maxFeePerBlobGas(e){z(this,Oh,e==null?null:Je(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=k(this,Cd);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){Z(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let n=0;n<e.length;n++)Z(Tn(e[n],32),"invalid blobVersionedHash",`value[${n}]`,e[n])}z(this,Cd,e)}get blobs(){return k(this,Nd)==null?null:k(this,Nd).map(e=>Object.assign({},e))}set blobs(e){if(e==null){z(this,Nd,null);return}const n=[],r=[];for(let s=0;s<e.length;s++){const i=e[s];if(AI(i)){ge(k(this,Ka),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=Rt(i);if(Z(o.length<=wA,"blob is too large",`blobs[${s}]`,i),o.length!==wA){const d=new Uint8Array(wA);d.set(o),o=d}const a=k(this,Ka).blobToKzgCommitment(o),l=Be(k(this,Ka).computeBlobKzgProof(o,a));n.push({data:Be(o),commitment:Be(a),proof:l}),r.push(q3(1,a))}else{const o=Be(i.commitment);n.push({data:Be(i.data),commitment:o,proof:Be(i.proof)}),r.push(q3(1,o))}}z(this,Nd,n),z(this,Cd,r)}get kzg(){return k(this,Ka)}set kzg(e){e==null?z(this,Ka,null):z(this,Ka,Xee(e))}get hash(){return this.signature==null?null:vr(Ne(this,Dm,Qv).call(this,!0,!1))}get unsignedHash(){return vr(this.unsignedSerialized)}get from(){return this.signature==null?null:Kee(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:pw.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return Ne(this,Dm,Qv).call(this,!0,!0)}get unsignedSerialized(){return Ne(this,Dm,Qv).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,n=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,s=k(this,Oh)!=null||k(this,Cd);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&ge(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),ge(!n||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),ge(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):n?i.push(2):e?(i.push(1),r||i.push(0)):r?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Ha.from(this)}toJSON(){const e=n=>n==null?null:n.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new Ha;if(typeof e=="string"){const r=Rt(e);if(r[0]>=127)return Ha.from(rte(r));switch(r[0]){case 1:return Ha.from(ate(r));case 2:return Ha.from(ite(r));case 3:return Ha.from(lte(r));case 4:return Ha.from(ute(r))}ge(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const n=new Ha;return e.type!=null&&(n.type=e.type),e.to!=null&&(n.to=e.to),e.nonce!=null&&(n.nonce=e.nonce),e.gasLimit!=null&&(n.gasLimit=e.gasLimit),e.gasPrice!=null&&(n.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(n.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(n.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(n.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(n.data=e.data),e.value!=null&&(n.value=e.value),e.chainId!=null&&(n.chainId=e.chainId),e.signature!=null&&(n.signature=Ti.from(e.signature)),e.accessList!=null&&(n.accessList=e.accessList),e.authorizationList!=null&&(n.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(n.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(n.kzg=e.kzg),e.blobs!=null&&(n.blobs=e.blobs),e.hash!=null&&(Z(n.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),Z(n.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(Z(n.isSigned(),"unsigned transaction cannot define '.from'","tx",e),Z(n.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),n}};sa=new WeakMap,Cm=new WeakMap,Nm=new WeakMap,Am=new WeakMap,Sm=new WeakMap,Tm=new WeakMap,_m=new WeakMap,km=new WeakMap,Im=new WeakMap,Rm=new WeakMap,jm=new WeakMap,Pm=new WeakMap,Oh=new WeakMap,Cd=new WeakMap,Ka=new WeakMap,Nd=new WeakMap,Om=new WeakMap,Dm=new WeakSet,Qv=function(e,n){ge(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return ste(this,r);case 1:return cte(this,r);case 2:return ote(this,r);case 3:return dte(this,r,n?this.blobs:null);case 4:return hte(this,r)}ge(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let sE=Ha;function lf(t){return vr(mc(t))}var fte="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const K3=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),G3=4;function pte(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),s=1,i=[0,1];for(let E=1;E<r;E++)i.push(s+=n());let o=n(),a=e;e+=o;let l=0,d=0;function u(){return l==0&&(d=d<<8|t[e++],l=8),d>>--l&1}const h=31,f=2**h,p=f>>>1,m=p>>1,g=f-1;let w=0;for(let E=0;E<h;E++)w=w<<1|u();let b=[],y=0,x=f;for(;;){let E=Math.floor(((w-y+1)*s-1)/x),R=0,S=r;for(;S-R>1;){let T=R+S>>>1;E<i[T]?S=T:R=T}if(R==0)break;b.push(R);let C=y+Math.floor(x*i[R]/s),N=y+Math.floor(x*i[R+1]/s)-1;for(;!((C^N)&p);)w=w<<1&g|u(),C=C<<1&g,N=N<<1&g|1;for(;C&~N&m;)w=w&p|w<<1&g>>>1|u(),C=C<<1^p,N=(N^p)<<1|p|1;y=C,x=1+N-C}let v=r-4;return b.map(E=>{switch(E-v){case 3:return v+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return v+256+(t[a++]<<8|t[a++]);case 1:return v+t[a++];default:return E-1}})}function mte(t){let e=0;return()=>t[e++]}function H$(t){return mte(pte(gte(t)))}function gte(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let n=t.length,r=new Uint8Array(6*n>>3);for(let s=0,i=0,o=0,a=0;s<n;s++)a=a<<6|e[t.charCodeAt(s)],o+=6,o>=8&&(r[i++]=a>>(o-=8));return r}function yte(t){return t&1?~t>>1:t>>1}function wte(t,e){let n=Array(t);for(let r=0,s=0;r<t;r++)n[r]=s+=yte(e());return n}function mw(t,e=0){let n=[];for(;;){let r=t(),s=t();if(!s)break;e+=r;for(let i=0;i<s;i++)n.push(e+i);e+=s+1}return n}function V$(t){return gw(()=>{let e=mw(t);if(e.length)return e})}function W$(t){let e=[];for(;;){let n=t();if(n==0)break;e.push(xte(n,t))}for(;;){let n=t()-1;if(n<0)break;e.push(bte(n,t))}return e.flat()}function gw(t){let e=[];for(;;){let n=t(e.length);if(!n)break;e.push(n)}return e}function q$(t,e,n){let r=Array(t).fill().map(()=>[]);for(let s=0;s<e;s++)wte(t,n).forEach((i,o)=>r[o].push(i));return r}function xte(t,e){let n=1+e(),r=e(),s=gw(e);return q$(s.length,1+t,e).flatMap((o,a)=>{let[l,...d]=o;return Array(s[a]).fill().map((u,h)=>{let f=h*r;return[l+h*n,d.map(p=>p+f)]})})}function bte(t,e){let n=1+e();return q$(n,1+t,e).map(s=>[s[0],s.slice(1)])}function vte(t){let e=[],n=mw(t);return s(r([]),[]),e;function r(i){let o=t(),a=gw(()=>{let l=mw(t).map(d=>n[d]);if(l.length)return r(l)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,l){if(!(i&4&&l===a[a.length-1])){i&2&&(l=a[a.length-1]),i&1&&e.push(a);for(let d of o)for(let u of d.Q)s(d,[...a,u],l)}}}function Ete(t){return t.toString(16).toUpperCase().padStart(2,"0")}function K$(t){return`{${Ete(t)}}`}function Cte(t){let e=[];for(let n=0,r=t.length;n<r;){let s=t.codePointAt(n);n+=s<65536?1:2,e.push(s)}return e}function xg(t){let n=t.length;if(n<4096)return String.fromCodePoint(...t);let r=[];for(let s=0;s<n;)r.push(String.fromCodePoint(...t.slice(s,s+=4096)));return r.join("")}function Nte(t,e){let n=t.length,r=n-e.length;for(let s=0;r==0&&s<n;s++)r=t[s]-e[s];return r}var Ate="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const yw=44032,iE=4352,oE=4449,aE=4519,G$=19,Y$=21,bg=28,cE=Y$*bg,Ste=G$*cE,Tte=yw+Ste,_te=iE+G$,kte=oE+Y$,Ite=aE+bg;function ty(t){return t>>24&255}function Q$(t){return t&16777215}let hT,Y3,fT,Jv;function Rte(){let t=H$(Ate);hT=new Map(V$(t).flatMap((e,n)=>e.map(r=>[r,n+1<<24]))),Y3=new Set(mw(t)),fT=new Map,Jv=new Map;for(let[e,n]of W$(t)){if(!Y3.has(e)&&n.length==2){let[r,s]=n,i=Jv.get(r);i||(i=new Map,Jv.set(r,i)),i.set(s,e)}fT.set(e,n.reverse())}}function J$(t){return t>=yw&&t<Tte}function jte(t,e){if(t>=iE&&t<_te&&e>=oE&&e<kte)return yw+(t-iE)*cE+(e-oE)*bg;if(J$(t)&&e>aE&&e<Ite&&(t-yw)%bg==0)return t+(e-aE);{let n=Jv.get(t);return n&&(n=n.get(e),n)?n:-1}}function Z$(t){hT||Rte();let e=[],n=[],r=!1;function s(i){let o=hT.get(i);o&&(r=!0,i|=o),e.push(i)}for(let i of t)for(;;){if(i<128)e.push(i);else if(J$(i)){let o=i-yw,a=o/cE|0,l=o%cE/bg|0,d=o%bg;s(iE+a),s(oE+l),d>0&&s(aE+d)}else{let o=fT.get(i);o?n.push(...o):s(i)}if(!n.length)break;i=n.pop()}if(r&&e.length>1){let i=ty(e[0]);for(let o=1;o<e.length;o++){let a=ty(e[o]);if(a==0||i<=a){i=a;continue}let l=o-1;for(;;){let d=e[l+1];if(e[l+1]=e[l],e[l]=d,!l||(i=ty(e[--l]),i<=a))break}i=ty(e[o])}}return e}function Pte(t){let e=[],n=[],r=-1,s=0;for(let i of t){let o=ty(i),a=Q$(i);if(r==-1)o==0?r=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(r,...n),n.length=0,r=a):n.push(a),s=o;else{let l=jte(r,a);l>=0?r=l:s==0&&o==0?(e.push(r),r=a):(n.push(a),s=o)}}return r>=0&&e.push(r,...n),e}function X$(t){return Z$(t).map(Q$)}function Ote(t){return Pte(Z$(t))}const Q3=45,e8=".",t8=65039,n8=1,lE=t=>Array.from(t);function ww(t,e){return t.P.has(e)||t.Q.has(e)}class Dte extends Array{get is_emoji(){return!0}}let pT,r8,dh,mT,s8,om,xA,yp,$u,J3,gT;function OI(){if(pT)return;let t=H$(fte);const e=()=>mw(t),n=()=>new Set(e()),r=(u,h)=>h.forEach(f=>u.add(f));pT=new Map(W$(t)),r8=n(),dh=e(),mT=new Set(e().map(u=>dh[u])),dh=new Set(dh),s8=n(),n();let s=V$(t),i=t();const o=()=>{let u=new Set;return e().forEach(h=>r(u,s[h])),r(u,e()),u};om=gw(u=>{let h=gw(t).map(f=>f+96);if(h.length){let f=u>=i;h[0]-=32,h=xg(h),f&&(h=`Restricted[${h}]`);let p=o(),m=o(),g=!t();return{N:h,P:p,Q:m,M:g,R:f}}}),xA=n(),yp=new Map;let a=e().concat(lE(xA)).sort((u,h)=>u-h);a.forEach((u,h)=>{let f=t(),p=a[h]=f?a[h-f]:{V:[],M:new Map};p.V.push(u),xA.has(u)||yp.set(u,p)});for(let{V:u,M:h}of new Set(yp.values())){let f=[];for(let m of u){let g=om.filter(b=>ww(b,m)),w=f.find(({G:b})=>g.some(y=>b.has(y)));w||(w={G:new Set,V:[]},f.push(w)),w.V.push(m),r(w.G,g)}let p=f.flatMap(m=>lE(m.G));for(let{G:m,V:g}of f){let w=new Set(p.filter(b=>!m.has(b)));for(let b of g)h.set(b,w)}}$u=new Set;let l=new Set;const d=u=>$u.has(u)?l.add(u):$u.add(u);for(let u of om){for(let h of u.P)d(h);for(let h of u.Q)d(h)}for(let u of $u)!yp.has(u)&&!l.has(u)&&yp.set(u,n8);r($u,X$($u)),J3=vte(t).map(u=>Dte.from(u)).sort(Nte),gT=new Map;for(let u of J3){let h=[gT];for(let f of u){let p=h.map(m=>{let g=m.get(f);return g||(g=new Map,m.set(f,g)),g});f===t8?h.push(...p):h=p}for(let f of h)f.V=u}}function DI(t){return(i8(t)?"":`${MI(HC([t]))} `)+K$(t)}function MI(t){return`"${t}"`}function Mte(t){if(t.length>=4&&t[2]==Q3&&t[3]==Q3)throw new Error(`invalid label extension: "${xg(t.slice(0,4))}"`)}function Ute(t){for(let n=t.lastIndexOf(95);n>0;)if(t[--n]!==95)throw new Error("underscore allowed only at start")}function Lte(t){let e=t[0],n=K3.get(e);if(n)throw vy(`leading ${n}`);let r=t.length,s=-1;for(let i=1;i<r;i++){e=t[i];let o=K3.get(e);if(o){if(s==i)throw vy(`${n} + ${o}`);s=i+1,n=o}}if(s==r)throw vy(`trailing ${n}`)}function HC(t,e=1/0,n=K$){let r=[];Bte(t[0])&&r.push(""),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let s=0,i=t.length;for(let o=0;o<i;o++){let a=t[o];i8(a)&&(r.push(xg(t.slice(s,o))),r.push(n(a)),s=o+1)}return r.push(xg(t.slice(s,i))),r.join("")}function Bte(t){return OI(),dh.has(t)}function i8(t){return OI(),s8.has(t)}function $te(t){return Vte(Fte(t,Ote,Kte))}function Fte(t,e,n){if(!t)return[];OI();let r=0;return t.split(e8).map(s=>{let i=Cte(s),o={input:i,offset:r};r+=i.length+1;try{let a=o.tokens=qte(i,e,n),l=a.length,d;if(!l)throw new Error("empty label");let u=o.output=a.flat();if(Ute(u),!(o.emoji=l>1||a[0].is_emoji)&&u.every(f=>f<128))Mte(u),d="ASCII";else{let f=a.flatMap(p=>p.is_emoji?[]:p);if(!f.length)d="Emoji";else{if(dh.has(u[0]))throw vy("leading combining mark");for(let g=1;g<l;g++){let w=a[g];if(!w.is_emoji&&dh.has(w[0]))throw vy(`emoji + combining mark: "${xg(a[g-1])} + ${HC([w[0]])}"`)}Lte(u);let p=lE(new Set(f)),[m]=Hte(p);Wte(m,f),zte(m,p),d=m.N}}o.type=d}catch(a){o.error=a}return o})}function zte(t,e){let n,r=[];for(let s of e){let i=yp.get(s);if(i===n8)return;if(i){let o=i.M.get(s);if(n=n?n.filter(a=>o.has(a)):lE(o),!n.length)return}else r.push(s)}if(n){for(let s of n)if(r.every(i=>ww(s,i)))throw new Error(`whole-script confusable: ${t.N}/${s.N}`)}}function Hte(t){let e=om;for(let n of t){let r=e.filter(s=>ww(s,n));if(!r.length)throw om.some(s=>ww(s,n))?a8(e[0],n):o8(n);if(e=r,r.length==1)break}return e}function Vte(t){return t.map(({input:e,error:n,output:r})=>{if(n){let s=n.message;throw new Error(t.length==1?s:`Invalid label ${MI(HC(e,63))}: ${s}`)}return xg(r)}).join(e8)}function o8(t){return new Error(`disallowed character: ${DI(t)}`)}function a8(t,e){let n=DI(e),r=om.find(s=>s.P.has(e));return r&&(n=`${r.N} ${n}`),new Error(`illegal mixture: ${t.N} + ${n}`)}function vy(t){return new Error(`illegal placement: ${t}`)}function Wte(t,e){for(let n of e)if(!ww(t,n))throw a8(t,n);if(t.M){let n=X$(e);for(let r=1,s=n.length;r<s;r++)if(mT.has(n[r])){let i=r+1;for(let o;i<s&&mT.has(o=n[i]);i++)for(let a=r;a<i;a++)if(n[a]==o)throw new Error(`duplicate non-spacing marks: ${DI(o)}`);if(i-r>G3)throw new Error(`excessive non-spacing marks: ${MI(HC(n.slice(r-1,i)))} (${i-r}/${G3})`);r=i}}}function qte(t,e,n){let r=[],s=[];for(t=t.slice().reverse();t.length;){let i=Gte(t);if(i)s.length&&(r.push(e(s)),s=[]),r.push(n(i));else{let o=t.pop();if($u.has(o))s.push(o);else{let a=pT.get(o);if(a)s.push(...a);else if(!r8.has(o))throw o8(o)}}}return s.length&&r.push(e(s)),r}function Kte(t){return t.filter(e=>e!=t8)}function Gte(t,e){let n=gT,r,s=t.length;for(;s&&(n=n.get(t[--s]),!!n);){let{V:i}=n;i&&(r=i,t.length=s)}return r}const c8=new Uint8Array(32);c8.fill(0);function Z3(t){return Z(t.length!==0,"invalid ENS name; empty component","comp",t),t}function l8(t){const e=mc(Yte(t)),n=[];if(t.length===0)return n;let r=0;for(let s=0;s<e.length;s++)e[s]===46&&(n.push(Z3(e.slice(r,s))),r=s+1);return Z(r<e.length,"invalid ENS name; empty component","name",t),n.push(Z3(e.slice(r))),n}function Yte(t){try{if(t.length===0)throw new Error("empty label");return $te(t)}catch(e){Z(!1,`invalid ENS name (${e.message})`,"name",t)}}function yT(t){Z(typeof t=="string","invalid ENS name; not a string","name",t),Z(t.length,"invalid ENS name (empty label)","name",t);let e=c8;const n=l8(t);for(;n.length;)e=vr(ir([e,vr(n.pop())]));return Be(e)}function Qte(t,e){const n=e;return Z(n<=255,"DNS encoded label cannot exceed 255","length",n),Be(ir(l8(t).map(r=>{Z(r.length<=n,`label ${JSON.stringify(t)} exceeds ${n} bytes`,"name",t);const s=new Uint8Array(r.length+1);return s.set(r,1),s[0]=s.length-1,s})))+"00"}const d8=new Uint8Array(32);d8.fill(0);const Jte=BigInt(-1),u8=BigInt(0),h8=BigInt(1),Zte=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Xte(t){const e=Rt(t),n=e.length%32;return n?ir([e,d8.slice(n)]):Be(e)}const ene=su(h8,32),tne=su(u8,32),X3={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},bA=["name","version","chainId","verifyingContract","salt"];function eO(t){return function(e){return Z(typeof e=="string",`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const nne={name:eO("name"),version:eO("version"),chainId:function(t){const e=Je(t,"domain.chainId");return Z(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):ua(e)},verifyingContract:function(t){try{return dn(t).toLowerCase()}catch{}Z(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=Rt(t,"domain.salt");return Z(e.length===32,'invalid domain value "salt"',"domain.salt",t),Be(e)}};function vA(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const n=e[1]==="",r=parseInt(e[2]);Z(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",t);const s=ch(Zte,n?r-1:r),i=n?(s+h8)*Jte:u8;return function(o){const a=Je(o,"value");return Z(a>=i&&a<=s,`value out-of-bounds for ${t}`,"value",a),su(n?QB(a,256):a,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return Z(n!==0&&n<=32&&e[1]===String(n),"invalid bytes width","type",t),function(r){const s=Rt(r);return Z(s.length===n,`invalid length for ${t}`,"value",r),Xte(r)}}}switch(t){case"address":return function(e){return Sl(dn(e),32)};case"bool":return function(e){return e?ene:tne};case"bytes":return function(e){return vr(e)};case"string":return function(e){return lf(e)}}return null}function tO(t,e){return`${t}(${e.map(({name:n,type:r})=>r+" "+n).join(",")})`}function Kb(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}var _x,tl,Mm,eC,f8;const po=class po{constructor(e){se(this,eC);q(this,"primaryType");se(this,_x);se(this,tl);se(this,Mm);z(this,tl,new Map),z(this,Mm,new Map);const n=new Map,r=new Map,s=new Map,i={};Object.keys(e).forEach(l=>{i[l]=e[l].map(({name:d,type:u})=>{let{base:h,index:f}=Kb(u);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:d,type:h+(f||"")}}),n.set(l,new Set),r.set(l,[]),s.set(l,new Set)}),z(this,_x,JSON.stringify(i));for(const l in i){const d=new Set;for(const u of i[l]){Z(!d.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(l)}`,"types",e),d.add(u.name);const h=Kb(u.type).base;Z(h!==l,`circular type reference to ${JSON.stringify(h)}`,"types",e),!vA(h)&&(Z(r.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),r.get(h).push(l),n.get(l).add(h))}}const o=Array.from(r.keys()).filter(l=>r.get(l).length===0);Z(o.length!==0,"missing primary type","types",e),Z(o.length===1,`ambiguous primary types or unused types: ${o.map(l=>JSON.stringify(l)).join(", ")}`,"types",e),yt(this,{primaryType:o[0]});function a(l,d){Z(!d.has(l),`circular type reference to ${JSON.stringify(l)}`,"types",e),d.add(l);for(const u of n.get(l))if(r.has(u)){a(u,d);for(const h of d)s.get(h).add(u)}d.delete(l)}a(this.primaryType,new Set);for(const[l,d]of s){const u=Array.from(d);u.sort(),k(this,tl).set(l,tO(l,i[l])+u.map(h=>tO(h,i[h])).join(""))}}get types(){return JSON.parse(k(this,_x))}getEncoder(e){let n=k(this,Mm).get(e);return n||(n=Ne(this,eC,f8).call(this,e),k(this,Mm).set(e,n)),n}encodeType(e){const n=k(this,tl).get(e);return Z(n,`unknown type: ${JSON.stringify(e)}`,"name",e),n}encodeData(e,n){return this.getEncoder(e)(n)}hashStruct(e,n){return vr(this.encodeData(e,n))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,n,r){if(vA(e))return r(e,n);const s=Kb(e).array;if(s)return Z(s.count===-1||s.count===n.length,`array length mismatch; expected length ${s.count}`,"value",n),n.map(o=>this._visit(s.prefix,o,r));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:l})=>(o[a]=this._visit(l,n[a],r),o),{});Z(!1,`unknown type: ${e}`,"type",e)}visit(e,n){return this._visit(this.primaryType,e,n)}static from(e){return new po(e)}static getPrimaryType(e){return po.from(e).primaryType}static hashStruct(e,n,r){return po.from(n).hashStruct(e,r)}static hashDomain(e){const n=[];for(const r in e){if(e[r]==null)continue;const s=X3[r];Z(s,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),n.push({name:r,type:s})}return n.sort((r,s)=>bA.indexOf(r.name)-bA.indexOf(s.name)),po.hashStruct("EIP712Domain",{EIP712Domain:n},e)}static encode(e,n,r){return ir(["0x1901",po.hashDomain(e),po.from(n).hash(r)])}static hash(e,n,r){return vr(po.encode(e,n,r))}static async resolveNames(e,n,r,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!Tn(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=po.from(n);o.visit(r,(a,l)=>(a==="address"&&!Tn(l,20)&&(i[l]="0x"),l));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),r=o.visit(r,(a,l)=>a==="address"&&i[l]?i[l]:l),{domain:e,value:r}}static getPayload(e,n,r){po.hashDomain(e);const s={},i=[];bA.forEach(l=>{const d=e[l];d!=null&&(s[l]=nne[l](d),i.push({name:l,type:X3[l]}))});const o=po.from(n);n=o.types;const a=Object.assign({},n);return Z(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",n),a.EIP712Domain=i,o.encode(r),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(r,(l,d)=>{if(l.match(/^bytes(\d*)/))return Be(Rt(d));if(l.match(/^u?int/))return Je(d).toString();switch(l){case"address":return d.toLowerCase();case"bool":return!!d;case"string":return Z(typeof d=="string","invalid string","value",d),d}Z(!1,"unsupported type","type",l)})}}};_x=new WeakMap,tl=new WeakMap,Mm=new WeakMap,eC=new WeakSet,f8=function(e){{const s=vA(e);if(s)return s}const n=Kb(e).array;if(n){const s=n.prefix,i=this.getEncoder(s);return o=>{Z(n.count===-1||n.count===o.length,`array length mismatch; expected length ${n.count}`,"value",o);let a=o.map(i);return k(this,tl).has(s)&&(a=a.map(vr)),vr(ir(a))}}const r=this.types[e];if(r){const s=lf(k(this,tl).get(e));return i=>{const o=r.map(({name:a,type:l})=>{const d=this.getEncoder(l)(i[a]);return k(this,tl).has(l)?vr(d):d});return o.unshift(s),ir(o)}}Z(!1,`unknown type: ${e}`,"type",e)};let dE=po;function Vs(t){const e=new Set;return t.forEach(n=>e.add(n)),Object.freeze(e)}const rne="external public payable override",sne=Vs(rne.split(" ")),p8="constant external internal payable private public pure view override",ine=Vs(p8.split(" ")),m8="constructor error event fallback function receive struct",g8=Vs(m8.split(" ")),y8="calldata memory storage payable indexed",one=Vs(y8.split(" ")),ane="tuple returns",cne=[m8,y8,ane,p8].join(" "),lne=Vs(cne.split(" ")),dne={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},une=new RegExp("^(\\s*)"),hne=new RegExp("^([0-9]+)"),fne=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),w8=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),x8=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var Xr,ia,kx,wT;const tC=class tC{constructor(e){se(this,kx);se(this,Xr);se(this,ia);z(this,Xr,0),z(this,ia,e.slice())}get offset(){return k(this,Xr)}get length(){return k(this,ia).length-k(this,Xr)}clone(){return new tC(k(this,ia))}reset(){z(this,Xr,0)}popKeyword(e){const n=this.peek();if(n.type!=="KEYWORD"||!e.has(n.text))throw new Error(`expected keyword ${n.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const n=this.peek();throw new Error(`expected ${e}; got ${n.type} ${JSON.stringify(n.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=Ne(this,kx,wT).call(this,k(this,Xr)+1,e.match+1);return z(this,Xr,e.match+1),n}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const n=[];for(;k(this,Xr)<e.match-1;){const r=this.peek().linkNext;n.push(Ne(this,kx,wT).call(this,k(this,Xr)+1,r)),z(this,Xr,r)}return z(this,Xr,e.match+1),n}peek(){if(k(this,Xr)>=k(this,ia).length)throw new Error("out-of-bounds");return k(this,ia)[k(this,Xr)]}peekKeyword(e){const n=this.peekType("KEYWORD");return n!=null&&e.has(n)?n:null}peekType(e){if(this.length===0)return null;const n=this.peek();return n.type===e?n.text:null}pop(){const e=this.peek();return d0(this,Xr)._++,e}toString(){const e=[];for(let n=k(this,Xr);n<k(this,ia).length;n++){const r=k(this,ia)[n];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};Xr=new WeakMap,ia=new WeakMap,kx=new WeakSet,wT=function(e=0,n=0){return new tC(k(this,ia).slice(e,n).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let Na=tC;function vu(t){const e=[],n=o=>{const a=i<t.length?JSON.stringify(t[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let r=[],s=[],i=0;for(;i<t.length;){let o=t.substring(i),a=o.match(une);a&&(i+=a[1].length,o=t.substring(i));const l={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(l);let d=dne[o[0]]||"";if(d){if(l.type=d,l.text=o[0],i++,d==="OPEN_PAREN")r.push(e.length-1),s.push(e.length-1);else if(d=="CLOSE_PAREN")r.length===0&&n("no matching open bracket"),l.match=r.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1;else if(d==="COMMA")l.linkBack=s.pop(),e[l.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(d==="OPEN_BRACKET")l.type="BRACKET";else if(d==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;u=h+u,e[e.length-1].value=St(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(fne),a){if(l.text=a[1],i+=l.text.length,lne.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(x8)){l.type="TYPE";continue}l.type="ID";continue}if(a=o.match(hne),a){l.text=a[1],l.type="NUMBER",i+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Na(e.map(o=>Object.freeze(o)))}function nO(t,e){let n=[];for(const r in e.keys())t.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function VC(t,e){if(e.peekKeyword(g8)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function _l(t,e){const n=new Set;for(;;){const r=t.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(t.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function b8(t){let e=_l(t,ine);return nO(e,Vs("constant payable nonpayable".split(" "))),nO(e,Vs("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function yl(t,e){return t.popParams().map(n=>os.from(n,e))}function v8(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return Je(t.pop().text);throw new Error("invalid gas")}return null}function df(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const pne=new RegExp(/^(.*)\[([0-9]*)\]$/);function rO(t){const e=t.match(x8);if(Z(e,"invalid type","type",t),t==="uint")return"uint256";if(t==="int")return"int256";if(e[2]){const n=parseInt(e[2]);Z(n!==0&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);Z(n!==0&&n<=256&&n%8===0,"invalid numeric width","type",t)}return t}const Kn={},ki=Symbol.for("_ethers_internal"),sO="_ParamTypeInternal",iO="_ErrorInternal",oO="_EventInternal",aO="_ConstructorInternal",cO="_FallbackInternal",lO="_FunctionInternal",dO="_StructInternal";var Um,Zv;const mo=class mo{constructor(e,n,r,s,i,o,a,l){se(this,Um);q(this,"name");q(this,"type");q(this,"baseType");q(this,"indexed");q(this,"components");q(this,"arrayLength");q(this,"arrayChildren");if(qx(e,Kn,"ParamType"),Object.defineProperty(this,ki,{value:sO}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||l==null)throw new Error("")}else if(a!=null||l!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");yt(this,{name:n,type:r,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:l})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=r,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let n="";return this.isArray()?(n+=this.arrayChildren.format(e),n+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?n+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":n+=this.type,e!=="sighash"&&(this.indexed===!0&&(n+=" indexed"),e==="full"&&this.name&&(n+=" "+this.name)),n}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,n){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(s=>r.arrayChildren.walk(s,n))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((s,i)=>r.components[i].walk(s,n))}return n(this.type,e)}async walkAsync(e,n){const r=[],s=[e];return Ne(this,Um,Zv).call(this,r,e,n,i=>{s[0]=i}),r.length&&await Promise.all(r),s[0]}static from(e,n){if(mo.isParamType(e))return e;if(typeof e=="string")try{return mo.from(vu(e),n)}catch{Z(!1,"invalid param type","obj",e)}else if(e instanceof Na){let a="",l="",d=null;_l(e,Vs(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(l="tuple",d=e.popParams().map(g=>mo.from(g)),a=`tuple(${d.map(g=>g.format()).join(",")})`):(a=rO(e.popType("TYPE")),l=a);let u=null,h=null;for(;e.length&&e.peekType("BRACKET");){const g=e.pop();u=new mo(Kn,"",a,l,null,d,h,u),h=g.value,a+=g.text,l="array",d=null}let f=null;if(_l(e,one).has("indexed")){if(!n)throw new Error("");f=!0}const m=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new mo(Kn,m,a,l,f,d,h,u)}const r=e.name;Z(!r||typeof r=="string"&&r.match(w8),"invalid name","obj.name",r);let s=e.indexed;s!=null&&(Z(n,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(pne);if(o){const a=parseInt(o[2]||"-1"),l=mo.from({type:o[1],components:e.components});return new mo(Kn,r||"",i,"array",s,null,a,l)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(d=>mo.from(d)):null;return new mo(Kn,r||"",i,"tuple",s,a,null,null)}return i=rO(e.type),new mo(Kn,r||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[ki]===sO}};Um=new WeakSet,Zv=function(e,n,r,s){if(this.isArray()){if(!Array.isArray(n))throw new Error("invalid array value");if(this.arrayLength!==-1&&n.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=n.slice();a.forEach((l,d)=>{var u;Ne(u=o,Um,Zv).call(u,e,l,r,h=>{a[d]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(n))a=n.slice();else{if(n==null||typeof n!="object")throw new Error("invalid tuple value");a=o.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in n))throw new Error(`missing value for component ${l.name}`);return n[l.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((l,d)=>{var u;Ne(u=o[d],Um,Zv).call(u,e,l,r,h=>{a[d]=h})}),s(a);return}const i=r(this.type,n);i.then?e.push(async function(){s(await i)}()):s(i)};let os=mo;class uf{constructor(e,n,r){q(this,"type");q(this,"inputs");qx(e,Kn,"Fragment"),r=Object.freeze(r.slice()),yt(this,{type:n,inputs:r})}static from(e){if(typeof e=="string"){try{uf.from(JSON.parse(e))}catch{}return uf.from(vu(e))}if(e instanceof Na)switch(e.peekKeyword(g8)){case"constructor":return fl.from(e);case"error":return xi.from(e);case"event":return rc.from(e);case"fallback":case"receive":return Yc.from(e);case"function":return sc.from(e);case"struct":return qh.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return fl.from(e);case"error":return xi.from(e);case"event":return rc.from(e);case"fallback":case"receive":return Yc.from(e);case"function":return sc.from(e);case"struct":return qh.from(e)}ge(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}Z(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return fl.isFragment(e)}static isError(e){return xi.isFragment(e)}static isEvent(e){return rc.isFragment(e)}static isFunction(e){return sc.isFragment(e)}static isStruct(e){return qh.isFragment(e)}}class WC extends uf{constructor(n,r,s,i){super(n,r,i);q(this,"name");Z(typeof s=="string"&&s.match(w8),"invalid identifier","name",s),i=Object.freeze(i.slice()),yt(this,{name:s})}}function xw(t,e){return"("+e.map(n=>n.format(t)).join(t==="full"?", ":",")+")"}class xi extends WC{constructor(e,n,r){super(e,"error",n,r),Object.defineProperty(this,ki,{value:iO})}get selector(){return lf(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const n=[];return e!=="sighash"&&n.push("error"),n.push(this.name+xw(e,this.inputs)),n.join(" ")}static from(e){if(xi.isFragment(e))return e;if(typeof e=="string")return xi.from(vu(e));if(e instanceof Na){const n=VC("error",e),r=yl(e);return df(e),new xi(Kn,n,r)}return new xi(Kn,e.name,e.inputs?e.inputs.map(os.from):[])}static isFragment(e){return e&&e[ki]===iO}}class rc extends WC{constructor(n,r,s,i){super(n,"event",r,s);q(this,"anonymous");Object.defineProperty(this,ki,{value:oO}),yt(this,{anonymous:i})}get topicHash(){return lf(this.format("sighash"))}format(n){if(n==null&&(n="sighash"),n==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(n)))});const r=[];return n!=="sighash"&&r.push("event"),r.push(this.name+xw(n,this.inputs)),n!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(n,r){return r=(r||[]).map(i=>os.from(i)),new rc(Kn,n,r,!1).topicHash}static from(n){if(rc.isFragment(n))return n;if(typeof n=="string")try{return rc.from(vu(n))}catch{Z(!1,"invalid event fragment","obj",n)}else if(n instanceof Na){const r=VC("event",n),s=yl(n,!0),i=!!_l(n,Vs(["anonymous"])).has("anonymous");return df(n),new rc(Kn,r,s,i)}return new rc(Kn,n.name,n.inputs?n.inputs.map(r=>os.from(r,!0)):[],!!n.anonymous)}static isFragment(n){return n&&n[ki]===oO}}class fl extends uf{constructor(n,r,s,i,o){super(n,r,s);q(this,"payable");q(this,"gas");Object.defineProperty(this,ki,{value:aO}),yt(this,{payable:i,gas:o})}format(n){if(ge(n!=null&&n!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),n==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(n)))});const r=[`constructor${xw(n,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(n){if(fl.isFragment(n))return n;if(typeof n=="string")try{return fl.from(vu(n))}catch{Z(!1,"invalid constuctor fragment","obj",n)}else if(n instanceof Na){_l(n,Vs(["constructor"]));const r=yl(n),s=!!_l(n,sne).has("payable"),i=v8(n);return df(n),new fl(Kn,"constructor",r,s,i)}return new fl(Kn,"constructor",n.inputs?n.inputs.map(os.from):[],!!n.payable,n.gas!=null?n.gas:null)}static isFragment(n){return n&&n[ki]===aO}}class Yc extends uf{constructor(n,r,s){super(n,"fallback",r);q(this,"payable");Object.defineProperty(this,ki,{value:cO}),yt(this,{payable:s})}format(n){const r=this.inputs.length===0?"receive":"fallback";if(n==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:s})}return`${r}()${this.payable?" payable":""}`}static from(n){if(Yc.isFragment(n))return n;if(typeof n=="string")try{return Yc.from(vu(n))}catch{Z(!1,"invalid fallback fragment","obj",n)}else if(n instanceof Na){const r=n.toString(),s=n.peekKeyword(Vs(["fallback","receive"]));if(Z(s,"type must be fallback or receive","obj",r),n.popKeyword(Vs(["fallback","receive"]))==="receive"){const l=yl(n);return Z(l.length===0,"receive cannot have arguments","obj.inputs",l),_l(n,Vs(["payable"])),df(n),new Yc(Kn,[],!0)}let o=yl(n);o.length?Z(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(l=>l.format("minimal")).join(", ")):o=[os.from("bytes")];const a=b8(n);if(Z(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),_l(n,Vs(["returns"])).has("returns")){const l=yl(n);Z(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(d=>d.format("minimal")).join(", "))}return df(n),new Yc(Kn,o,a==="payable")}if(n.type==="receive")return new Yc(Kn,[],!0);if(n.type==="fallback"){const r=[os.from("bytes")],s=n.stateMutability==="payable";return new Yc(Kn,r,s)}Z(!1,"invalid fallback description","obj",n)}static isFragment(n){return n&&n[ki]===cO}}class sc extends WC{constructor(n,r,s,i,o,a){super(n,"function",r,i);q(this,"constant");q(this,"outputs");q(this,"stateMutability");q(this,"payable");q(this,"gas");Object.defineProperty(this,ki,{value:lO}),o=Object.freeze(o.slice()),yt(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return lf(this.format("sighash")).substring(0,10)}format(n){if(n==null&&(n="sighash"),n==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(n))),outputs:this.outputs.map(s=>JSON.parse(s.format(n)))});const r=[];return n!=="sighash"&&r.push("function"),r.push(this.name+xw(n,this.inputs)),n!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(xw(n,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(n,r){return r=(r||[]).map(i=>os.from(i)),new sc(Kn,n,"view",r,[],null).selector}static from(n){if(sc.isFragment(n))return n;if(typeof n=="string")try{return sc.from(vu(n))}catch{Z(!1,"invalid function fragment","obj",n)}else if(n instanceof Na){const s=VC("function",n),i=yl(n),o=b8(n);let a=[];_l(n,Vs(["returns"])).has("returns")&&(a=yl(n));const l=v8(n);return df(n),new sc(Kn,s,o,i,a,l)}let r=n.stateMutability;return r==null&&(r="payable",typeof n.constant=="boolean"?(r="view",n.constant||(r="payable",typeof n.payable=="boolean"&&!n.payable&&(r="nonpayable"))):typeof n.payable=="boolean"&&!n.payable&&(r="nonpayable")),new sc(Kn,n.name,r,n.inputs?n.inputs.map(os.from):[],n.outputs?n.outputs.map(os.from):[],n.gas!=null?n.gas:null)}static isFragment(n){return n&&n[ki]===lO}}class qh extends WC{constructor(e,n,r){super(e,"struct",n,r),Object.defineProperty(this,ki,{value:dO})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return qh.from(vu(e))}catch{Z(!1,"invalid struct fragment","obj",e)}else if(e instanceof Na){const n=VC("struct",e),r=yl(e);return df(e),new qh(Kn,n,r)}return new qh(Kn,e.name,e.inputs?e.inputs.map(os.from):[])}static isFragment(e){return e&&e[ki]===dO}}const Sa=new Map;Sa.set(0,"GENERIC_PANIC");Sa.set(1,"ASSERT_FALSE");Sa.set(17,"OVERFLOW");Sa.set(18,"DIVIDE_BY_ZERO");Sa.set(33,"ENUM_RANGE_ERROR");Sa.set(34,"BAD_STORAGE_DATA");Sa.set(49,"STACK_UNDERFLOW");Sa.set(50,"ARRAY_RANGE_ERROR");Sa.set(65,"OUT_OF_MEMORY");Sa.set(81,"UNINITIALIZED_FUNCTION_CALL");const mne=new RegExp(/^bytes([0-9]*)$/),gne=new RegExp(/^(u?int)([0-9]*)$/);let EA=null,uO=1024;function yne(t,e,n,r){let s="missing revert data",i=null;const o=null;let a=null;if(n){s="execution reverted";const d=Rt(n);if(n=Be(n),d.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(d.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(Be(d.slice(0,4))==="0x08c379a0")try{i=r.decode(["string"],d.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(Be(d.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],d.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${Sa.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const l={to:e.to?dn(e.to):null,data:e.data||"0x"};return e.from&&(l.from=dn(e.from)),Bn(s,"CALL_EXCEPTION",{action:t,data:n,reason:i,transaction:l,invocation:o,revert:a})}var Ad,wp;const nC=class nC{constructor(){se(this,Ad)}getDefaultValue(e){const n=e.map(s=>Ne(this,Ad,wp).call(this,os.from(s)));return new qb(n,"_").defaultValue()}encode(e,n){KB(n.length,e.length,"types/values length mismatch");const r=e.map(o=>Ne(this,Ad,wp).call(this,os.from(o))),s=new qb(r,"_"),i=new sT;return s.encode(i,n),i.data}decode(e,n,r){const s=e.map(o=>Ne(this,Ad,wp).call(this,os.from(o)));return new qb(s,"_").decode(new iT(n,r,uO))}static _setDefaultMaxInflation(e){Z(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),uO=e}static defaultAbiCoder(){return EA==null&&(EA=new nC),EA}static getBuiltinCallException(e,n,r){return yne(e,n,r,nC.defaultAbiCoder())}};Ad=new WeakSet,wp=function(e){if(e.isArray())return new Dee(Ne(this,Ad,wp).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new qb(e.components.map(r=>Ne(this,Ad,wp).call(this,r)),e.name);switch(e.baseType){case"address":return new Pee(e.name);case"bool":return new Mee(e.name);case"string":return new Wee(e.name);case"bytes":return new Uee(e.name);case"":return new $ee(e.name)}let n=e.type.match(gne);if(n){let r=parseInt(n[2]||"256");return Z(r!==0&&r<=256&&r%8===0,"invalid "+n[1]+" bit length","param",e),new Vee(r/8,n[1]==="int",e.name)}if(n=e.type.match(mne),n){let r=parseInt(n[1]);return Z(r!==0&&r<=32,"invalid bytes length","param",e),new Lee(r,e.name)}Z(!1,"invalid type","type",e.type)};let bw=nC;class wne{constructor(e,n,r){q(this,"fragment");q(this,"name");q(this,"signature");q(this,"topic");q(this,"args");const s=e.name,i=e.format();yt(this,{fragment:e,name:s,signature:i,topic:n,args:r})}}class xne{constructor(e,n,r,s){q(this,"fragment");q(this,"name");q(this,"args");q(this,"signature");q(this,"selector");q(this,"value");const i=e.name,o=e.format();yt(this,{fragment:e,name:i,args:r,signature:o,selector:n,value:s})}}class bne{constructor(e,n,r){q(this,"fragment");q(this,"name");q(this,"args");q(this,"signature");q(this,"selector");const s=e.name,i=e.format();yt(this,{fragment:e,name:s,args:r,signature:i,selector:n})}}class hO{constructor(e){q(this,"hash");q(this,"_isIndexed");yt(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const fO={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},pO={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&fO[t.toString()]&&(e=fO[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};var Ga,Ya,Qa,Ns,Nc,Xv,e1;const Xu=class Xu{constructor(e){se(this,Nc);q(this,"fragments");q(this,"deploy");q(this,"fallback");q(this,"receive");se(this,Ga);se(this,Ya);se(this,Qa);se(this,Ns);let n=[];typeof e=="string"?n=JSON.parse(e):n=e,z(this,Qa,new Map),z(this,Ga,new Map),z(this,Ya,new Map);const r=[];for(const o of n)try{r.push(uf.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}yt(this,{fragments:Object.freeze(r)});let s=null,i=!1;z(this,Ns,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let l;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}yt(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(Z(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":l=k(this,Qa);break;case"event":l=k(this,Ya);break;case"error":l=k(this,Ga);break;default:return}const d=o.format();l.has(d)||l.set(d,o)}),this.deploy||yt(this,{deploy:fl.from("constructor()")}),yt(this,{fallback:s,receive:i})}format(e){const n=e?"minimal":"full";return this.fragments.map(s=>s.format(n))}formatJson(){const e=this.fragments.map(n=>n.format("json"));return JSON.stringify(e.map(n=>JSON.parse(n)))}getAbiCoder(){return bw.defaultAbiCoder()}getFunctionName(e){const n=Ne(this,Nc,Xv).call(this,e,null,!1);return Z(n,"no matching function","key",e),n.name}hasFunction(e){return!!Ne(this,Nc,Xv).call(this,e,null,!1)}getFunction(e,n){return Ne(this,Nc,Xv).call(this,e,n||null,!0)}forEachFunction(e){const n=Array.from(k(this,Qa).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(k(this,Qa).get(s),r)}}getEventName(e){const n=Ne(this,Nc,e1).call(this,e,null,!1);return Z(n,"no matching event","key",e),n.name}hasEvent(e){return!!Ne(this,Nc,e1).call(this,e,null,!1)}getEvent(e,n){return Ne(this,Nc,e1).call(this,e,n||null,!0)}forEachEvent(e){const n=Array.from(k(this,Ya).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(k(this,Ya).get(s),r)}}getError(e,n){if(Tn(e)){const s=e.toLowerCase();if(pO[s])return xi.from(pO[s].signature);for(const i of k(this,Ga).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of k(this,Ga))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?xi.from("error Error(string)"):e==="Panic"?xi.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");Z(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=xi.from(e).format(),e==="Error(string)")return xi.from("error Error(string)");if(e==="Panic(uint256)")return xi.from("error Panic(uint256)");const r=k(this,Ga).get(e);return r||null}forEachError(e){const n=Array.from(k(this,Ga).keys());n.sort((r,s)=>r.localeCompare(s));for(let r=0;r<n.length;r++){const s=n[r];e(k(this,Ga).get(s),r)}}_decodeParams(e,n){return k(this,Ns).decode(e,n)}_encodeParams(e,n){return k(this,Ns).encode(e,n)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);Z(r,"unknown error","fragment",e),e=r}return Z(Xn(n,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",n),this._decodeParams(e.inputs,Xn(n,4))}encodeErrorResult(e,n){if(typeof e=="string"){const r=this.getError(e);Z(r,"unknown error","fragment",e),e=r}return ir([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);Z(r,"unknown function","fragment",e),e=r}return Z(Xn(n,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",n),this._decodeParams(e.inputs,Xn(n,4))}encodeFunctionData(e,n){if(typeof e=="string"){const r=this.getFunction(e);Z(r,"unknown function","fragment",e),e=r}return ir([e.selector,this._encodeParams(e.inputs,n||[])])}decodeFunctionResult(e,n){if(typeof e=="string"){const i=this.getFunction(e);Z(i,"unknown function","fragment",e),e=i}let r="invalid length for result data";const s=Fs(n);if(s.length%32===0)try{return k(this,Ns).decode(e.outputs,s)}catch{r="could not decode result data"}ge(!1,r,"BAD_DATA",{value:Be(s),info:{method:e.name,signature:e.format()}})}makeError(e,n){const r=Rt(e,"data"),s=bw.getBuiltinCallException("call",n,r);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=Be(r.slice(0,4)),l=this.getError(a);if(l)try{const d=k(this,Ns).decode(l.inputs,r.slice(4));s.revert={name:l.name,signature:l.format(),args:d},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(n);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,n){if(typeof e=="string"){const r=this.getFunction(e);Z(r,"unknown function","fragment",e),e=r}return Be(k(this,Ns).encode(e.outputs,n||[]))}encodeFilterTopics(e,n){if(typeof e=="string"){const i=this.getEvent(e);Z(i,"unknown event","eventFragment",e),e=i}ge(n.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:n.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const s=(i,o)=>i.type==="string"?lf(o):i.type==="bytes"?vr(Be(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=su(o):i.type.match(/^bytes/)?o=UZ(o,32):i.type==="address"&&k(this,Ns).encode(["address"],[o]),Sl(Be(o),32));for(n.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){Z(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?Z(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?r.push(i.map(l=>s(a,l))):r.push(s(a,i))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,n){if(typeof e=="string"){const o=this.getEvent(e);Z(o,"unknown event","eventFragment",e),e=o}const r=[],s=[],i=[];return e.anonymous||r.push(e.topicHash),Z(n.length===e.inputs.length,"event arguments/values mismatch","values",n),e.inputs.forEach((o,a)=>{const l=n[a];if(o.indexed)if(o.type==="string")r.push(lf(l));else if(o.type==="bytes")r.push(vr(l));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(k(this,Ns).encode([o.type],[l]))}else s.push(o),i.push(l)}),{data:k(this,Ns).encode(s,i),topics:r}}decodeEventLog(e,n,r){if(typeof e=="string"){const p=this.getEvent(e);Z(p,"unknown event","eventFragment",e),e=p}if(r!=null&&!e.anonymous){const p=e.topicHash;Z(Tn(r[0],32)&&r[0].toLowerCase()===p,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((p,m)=>{p.indexed?p.type==="string"||p.type==="bytes"||p.baseType==="tuple"||p.baseType==="array"?(s.push(os.from({type:"bytes32",name:p.name})),o.push(!0)):(s.push(p),o.push(!1)):(i.push(p),o.push(!1))});const a=r!=null?k(this,Ns).decode(s,ir(r)):null,l=k(this,Ns).decode(i,n,!0),d=[],u=[];let h=0,f=0;return e.inputs.forEach((p,m)=>{let g=null;if(p.indexed)if(a==null)g=new hO(null);else if(o[m])g=new hO(a[f++]);else try{g=a[f++]}catch(w){g=w}else try{g=l[h++]}catch(w){g=w}d.push(g),u.push(p.name||null)}),pg.fromItems(d,u)}parseTransaction(e){const n=Rt(e.data,"tx.data"),r=Je(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(Be(n.slice(0,4)));if(!s)return null;const i=k(this,Ns).decode(s.inputs,n.slice(4));return new xne(s,s.selector,i,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const n=this.getEvent(e.topics[0]);return!n||n.anonymous?null:new wne(n,n.topicHash,this.decodeEventLog(n,e.data,e.topics))}parseError(e){const n=Be(e),r=this.getError(Xn(n,0,4));if(!r)return null;const s=k(this,Ns).decode(r.inputs,Xn(n,4));return new bne(r,r.selector,s)}static from(e){return e instanceof Xu?e:typeof e=="string"?new Xu(JSON.parse(e)):typeof e.formatJson=="function"?new Xu(e.formatJson()):typeof e.format=="function"?new Xu(e.format("json")):new Xu(e)}};Ga=new WeakMap,Ya=new WeakMap,Qa=new WeakMap,Ns=new WeakMap,Nc=new WeakSet,Xv=function(e,n,r){if(Tn(e)){const i=e.toLowerCase();for(const o of k(this,Qa).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of k(this,Qa))o.split("(")[0]===e&&i.push(a);if(n){const o=n.length>0?n[n.length-1]:null;let a=n.length,l=!0;Rs.isTyped(o)&&o.type==="overrides"&&(l=!1,a--);for(let d=i.length-1;d>=0;d--){const u=i[d].inputs.length;u!==a&&(!l||u!==a-1)&&i.splice(d,1)}for(let d=i.length-1;d>=0;d--){const u=i[d].inputs;for(let h=0;h<n.length;h++)if(Rs.isTyped(n[h])){if(h>=u.length){if(n[h].type==="overrides")continue;i.splice(d,1);break}if(n[h].type!==u[h].baseType){i.splice(d,1);break}}}}if(i.length===1&&n&&n.length!==i[0].inputs.length){const o=n[n.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");Z(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=k(this,Qa).get(sc.from(e).format());return s||null},e1=function(e,n,r){if(Tn(e)){const i=e.toLowerCase();for(const o of k(this,Ya).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of k(this,Ya))o.split("(")[0]===e&&i.push(a);if(n){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<n.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let l=0;l<n.length;l++)if(Rs.isTyped(n[l])&&n[l].type!==a[l].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&r){const o=i.map(a=>JSON.stringify(a.format())).join(", ");Z(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=k(this,Ya).get(rc.from(e).format());return s||null};let uE=Xu;const E8=BigInt(0);function am(t){return t??null}function lr(t){return t==null?null:t.toString()}class mO{constructor(e,n,r){q(this,"gasPrice");q(this,"maxFeePerGas");q(this,"maxPriorityFeePerGas");yt(this,{gasPrice:am(e),maxFeePerGas:am(n),maxPriorityFeePerGas:am(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:n,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:lr(e),maxFeePerGas:lr(n),maxPriorityFeePerGas:lr(r)}}}function hE(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=Be(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of n)!(s in t)||t[s]==null||(e[s]=Je(t[s],`request.${s}`));const r="type,nonce".split(/,/);for(const s of r)!(s in t)||t[s]==null||(e[s]=St(t[s],`request.${s}`));return t.accessList&&(e.accessList=_f(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(s=>AI(s)?Be(s):Object.assign({},s))),e}var nl;class vne{constructor(e,n){q(this,"provider");q(this,"number");q(this,"hash");q(this,"timestamp");q(this,"parentHash");q(this,"parentBeaconBlockRoot");q(this,"nonce");q(this,"difficulty");q(this,"gasLimit");q(this,"gasUsed");q(this,"stateRoot");q(this,"receiptsRoot");q(this,"blobGasUsed");q(this,"excessBlobGas");q(this,"miner");q(this,"prevRandao");q(this,"extraData");q(this,"baseFeePerGas");se(this,nl);z(this,nl,e.transactions.map(r=>typeof r!="string"?new vw(r,n):r)),yt(this,{provider:n,hash:am(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:am(e.prevRandao),extraData:e.extraData,baseFeePerGas:am(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return k(this,nl).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=k(this,nl).slice();return e.length===0?[]:(ge(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:n,extraData:r,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:l,nonce:d,number:u,parentHash:h,parentBeaconBlockRoot:f,stateRoot:p,receiptsRoot:m,timestamp:g,transactions:w}=this;return{_type:"Block",baseFeePerGas:lr(e),difficulty:lr(n),extraData:r,gasLimit:lr(s),gasUsed:lr(i),blobGasUsed:lr(this.blobGasUsed),excessBlobGas:lr(this.excessBlobGas),hash:o,miner:a,prevRandao:l,nonce:d,number:u,parentHash:h,timestamp:g,parentBeaconBlockRoot:f,stateRoot:p,receiptsRoot:m,transactions:w}}[Symbol.iterator](){let e=0;const n=this.transactions;return{next:()=>e<this.length?{value:n[e++],done:!1}:{value:void 0,done:!0}}}get length(){return k(this,nl).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let n;if(typeof e=="number")n=k(this,nl)[e];else{const r=e.toLowerCase();for(const s of k(this,nl))if(typeof s=="string"){if(s!==r)continue;n=s;break}else{if(s.hash!==r)continue;n=s;break}}if(n==null)throw new Error("no such tx");return typeof n=="string"?await this.provider.getTransaction(n):n}getPrefetchedTransaction(e){const n=this.prefetchedTransactions;if(typeof e=="number")return n[e];e=e.toLowerCase();for(const r of n)if(r.hash===e)return r;Z(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return Ene(this)}}nl=new WeakMap;class Yx{constructor(e,n){q(this,"provider");q(this,"transactionHash");q(this,"blockHash");q(this,"blockNumber");q(this,"removed");q(this,"address");q(this,"data");q(this,"topics");q(this,"index");q(this,"transactionIndex");this.provider=n;const r=Object.freeze(e.topics.slice());yt(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:n,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:l,transactionIndex:d}=this;return{_type:"log",address:e,blockHash:n,blockNumber:r,data:s,index:i,removed:o,topics:a,transactionHash:l,transactionIndex:d}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return ge(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return ge(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return ge(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return Cne(this)}}var Ix;class C8{constructor(e,n){q(this,"provider");q(this,"to");q(this,"from");q(this,"contractAddress");q(this,"hash");q(this,"index");q(this,"blockHash");q(this,"blockNumber");q(this,"logsBloom");q(this,"gasUsed");q(this,"blobGasUsed");q(this,"cumulativeGasUsed");q(this,"gasPrice");q(this,"blobGasPrice");q(this,"type");q(this,"status");q(this,"root");se(this,Ix);z(this,Ix,Object.freeze(e.logs.map(s=>new Yx(s,n))));let r=E8;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),yt(this,{provider:n,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return k(this,Ix)}toJSON(){const{to:e,from:n,contractAddress:r,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:l,logs:d,status:u,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:lr(this.cumulativeGasUsed),from:n,gasPrice:lr(this.gasPrice),blobGasUsed:lr(this.blobGasUsed),blobGasPrice:lr(this.blobGasPrice),gasUsed:lr(this.gasUsed),hash:s,index:i,logs:d,logsBloom:l,root:h,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return A8(this)}reorderedEvent(e){return ge(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),N8(this,e)}}Ix=new WeakMap;var Sd;const vj=class vj{constructor(e,n){q(this,"provider");q(this,"blockNumber");q(this,"blockHash");q(this,"index");q(this,"hash");q(this,"type");q(this,"to");q(this,"from");q(this,"nonce");q(this,"gasLimit");q(this,"gasPrice");q(this,"maxPriorityFeePerGas");q(this,"maxFeePerGas");q(this,"maxFeePerBlobGas");q(this,"data");q(this,"value");q(this,"chainId");q(this,"signature");q(this,"accessList");q(this,"blobVersionedHashes");q(this,"authorizationList");se(this,Sd);this.provider=n,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,z(this,Sd,-1)}toJSON(){const{blockNumber:e,blockHash:n,index:r,hash:s,type:i,to:o,from:a,nonce:l,data:d,signature:u,accessList:h,blobVersionedHashes:f}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:n,blobVersionedHashes:f,chainId:lr(this.chainId),data:d,from:a,gasLimit:lr(this.gasLimit),gasPrice:lr(this.gasPrice),hash:s,maxFeePerGas:lr(this.maxFeePerGas),maxPriorityFeePerGas:lr(this.maxPriorityFeePerGas),maxFeePerBlobGas:lr(this.maxFeePerBlobGas),nonce:l,signature:u,to:o,index:r,type:i,value:lr(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const n=this.provider.getBlock(e);if(n==null)throw new Error("TODO");return n}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:n,blockNumber:r}=await $s({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return n==null||n.blockNumber==null?0:r-n.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,n){const r=e??1,s=n??0;let i=k(this,Sd),o=-1,a=i===-1;const l=async()=>{if(a)return null;const{blockNumber:f,nonce:p}=await $s({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(p<this.nonce){i=f;return}if(a)return null;const m=await this.getTransaction();if(!(m&&m.blockNumber!=null))for(o===-1&&(o=i-3,o<k(this,Sd)&&(o=k(this,Sd)));o<=f;){if(a)return null;const g=await this.provider.getBlock(o,!0);if(g==null)return;for(const w of g)if(w===this.hash)return;for(let w=0;w<g.length;w++){const b=await g.getTransaction(w);if(b.from===this.from&&b.nonce===this.nonce){if(a)return null;const y=await this.provider.getTransactionReceipt(b.hash);if(y==null||f-y.blockNumber+1<r)return;let x="replaced";b.data===this.data&&b.to===this.to&&b.value===this.value?x="repriced":b.data==="0x"&&b.from===b.to&&b.value===E8&&(x="cancelled"),ge(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:x==="replaced"||x==="cancelled",reason:x,replacement:b.replaceableTransaction(i),hash:b.hash,receipt:y})}}o++}},d=f=>{if(f==null||f.status!==0)return f;ge(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:f.to,from:f.from,data:""},receipt:f})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return d(u);if(u){if(r===1||await u.confirmations()>=r)return d(u)}else if(await l(),r===0)return null;return await new Promise((f,p)=>{const m=[],g=()=>{m.forEach(b=>b())};if(m.push(()=>{a=!0}),s>0){const b=setTimeout(()=>{g(),p(Bn("wait for transaction timeout","TIMEOUT"))},s);m.push(()=>{clearTimeout(b)})}const w=async b=>{if(await b.confirmations()>=r){g();try{f(d(b))}catch(y){p(y)}}};if(m.push(()=>{this.provider.off(this.hash,w)}),this.provider.on(this.hash,w),i>=0){const b=async()=>{try{await l()}catch(y){if(rs(y,"TRANSACTION_REPLACED")){g(),p(y);return}}a||this.provider.once("block",b)};m.push(()=>{this.provider.off("block",b)}),this.provider.once("block",b)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return ge(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),A8(this)}reorderedEvent(e){return ge(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),ge(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),N8(this,e)}replaceableTransaction(e){Z(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const n=new vj(this,this.provider);return z(n,Sd,e),n}};Sd=new WeakMap;let vw=vj;function Ene(t){return{orphan:"drop-block",hash:t.hash,number:t.number}}function N8(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function A8(t){return{orphan:"drop-transaction",tx:t}}function Cne(t){return{orphan:"drop-log",log:{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}}}class UI extends Yx{constructor(n,r,s){super(n,n.provider);q(this,"interface");q(this,"fragment");q(this,"args");const i=r.decodeEventLog(s,n.data,n.topics);yt(this,{args:i,fragment:s,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class S8 extends Yx{constructor(n,r){super(n,n.provider);q(this,"error");yt(this,{error:r})}}var Lm;class Nne extends C8{constructor(n,r,s){super(s,r);se(this,Lm);z(this,Lm,n)}get logs(){return super.logs.map(n=>{const r=n.topics.length?k(this,Lm).getEvent(n.topics[0]):null;if(r)try{return new UI(n,k(this,Lm),r)}catch(s){return new S8(n,s)}return n})}}Lm=new WeakMap;var Rx;class LI extends vw{constructor(n,r,s){super(s,r);se(this,Rx);z(this,Rx,n)}async wait(n,r){const s=await super.wait(n,r);return s==null?null:new Nne(k(this,Rx),this.provider,s)}}Rx=new WeakMap;class T8 extends JB{constructor(n,r,s,i){super(n,r,s);q(this,"log");yt(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Ane extends T8{constructor(e,n,r,s,i){super(e,n,r,new UI(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);yt(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const gO=BigInt(0);function _8(t){return t&&typeof t.call=="function"}function k8(t){return t&&typeof t.estimateGas=="function"}function qC(t){return t&&typeof t.resolveName=="function"}function I8(t){return t&&typeof t.sendTransaction=="function"}function R8(t){if(t!=null){if(qC(t))return t;if(t.provider)return t.provider}}var jx;class Sne{constructor(e,n,r){se(this,jx);q(this,"fragment");if(yt(this,{fragment:n}),n.inputs.length<r.length)throw new Error("too many arguments");const s=hf(e.runner,"resolveName"),i=qC(s)?s:null;z(this,jx,async function(){const o=await Promise.all(n.inputs.map((a,l)=>r[l]==null?null:a.walkAsync(r[l],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(f=>Hs(f,i))):Hs(h,i):h)));return e.interface.encodeFilterTopics(n,o)}())}getTopicFilter(){return k(this,jx)}}jx=new WeakMap;function hf(t,e){return t==null?null:typeof t[e]=="function"?t:t.provider&&typeof t.provider[e]=="function"?t.provider:null}function uh(t){return t==null?null:t.provider||null}async function j8(t,e){const n=Rs.dereference(t,"overrides");Z(typeof n=="object","invalid overrides parameter","overrides",t);const r=hE(n);return Z(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),Z(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function Tne(t,e,n){const r=hf(t,"resolveName"),s=qC(r)?r:null;return await Promise.all(e.map((i,o)=>i.walkAsync(n[o],(a,l)=>(l=Rs.dereference(l,a),a==="address"?Hs(l,s):l))))}function _ne(t){const e=async function(o){const a=await j8(o,["data"]);a.to=await t.getAddress(),a.from&&(a.from=await Hs(a.from,R8(t.runner)));const l=t.interface,d=Je(a.value||gO,"overrides.value")===gO,u=(a.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!u&&!d&&Z(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),Z(l.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const h=l.receive||l.fallback&&l.fallback.payable;return Z(h||d,"cannot send value to non-payable fallback","overrides.value",a.value),Z(l.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},n=async function(o){const a=hf(t.runner,"call");ge(_8(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await e(o);try{return await a.call(l)}catch(d){throw NI(d)&&d.data?t.interface.makeError(d.data,l):d}},r=async function(o){const a=t.runner;ge(I8(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await a.sendTransaction(await e(o)),d=uh(t.runner);return new LI(t.interface,d,l)},s=async function(o){const a=hf(t.runner,"estimateGas");return ge(k8(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await r(o);return yt(i,{_contract:t,estimateGas:s,populateTransaction:e,send:r,staticCall:n}),i}function kne(t,e){const n=function(...d){const u=t.interface.getFunction(e,d);return ge(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:d}}),u},r=async function(...d){const u=n(...d);let h={};if(u.inputs.length+1===d.length&&(h=await j8(d.pop()),h.from&&(h.from=await Hs(h.from,R8(t.runner)))),u.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const f=await Tne(t.runner,u.inputs,d);return Object.assign({},h,await $s({to:t.getAddress(),data:t.interface.encodeFunctionData(u,f)}))},s=async function(...d){const u=await a(...d);return u.length===1?u[0]:u},i=async function(...d){const u=t.runner;ge(I8(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await r(...d)),f=uh(t.runner);return new LI(t.interface,f,h)},o=async function(...d){const u=hf(t.runner,"estimateGas");return ge(k8(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...d))},a=async function(...d){const u=hf(t.runner,"call");ge(_8(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await r(...d);let f="0x";try{f=await u.call(h)}catch(m){throw NI(m)&&m.data?t.interface.makeError(m.data,h):m}const p=n(...d);return t.interface.decodeFunctionResult(p,f)},l=async(...d)=>n(...d).constant?await s(...d):await i(...d);return yt(l,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:o,populateTransaction:r,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=t.interface.getFunction(e);return ge(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),d}}),l}function Ine(t,e){const n=function(...s){const i=t.interface.getEvent(e,s);return ge(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},r=function(...s){return new Sne(t,n(...s),s)};return yt(r,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=t.interface.getEvent(e);return ge(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),r}const fE=Symbol.for("_ethersInternal_contract"),P8=new WeakMap;function Rne(t,e){P8.set(t[fE],e)}function Ui(t){return P8.get(t[fE])}function jne(t){return t&&typeof t=="object"&&"getTopicFilter"in t&&typeof t.getTopicFilter=="function"&&t.fragment}async function BI(t,e){let n,r=null;if(Array.isArray(e)){const i=function(o){if(Tn(o,32))return o;const a=t.interface.getEvent(o);return Z(a,"unknown fragment","name",o),a.topicHash};n=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?n=[null]:typeof e=="string"?Tn(e,32)?n=[e]:(r=t.interface.getEvent(e),Z(r,"unknown fragment","event",e),n=[r.topicHash]):jne(e)?n=await e.getTopicFilter():"fragment"in e?(r=e.fragment,n=[r.topicHash]):Z(!1,"unknown event name","event",e);n=n.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=n.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:r,tag:s,topics:n}}async function ny(t,e){const{subs:n}=Ui(t);return n.get((await BI(t,e)).tag)||null}async function yO(t,e,n){const r=uh(t.runner);ge(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await BI(t,n),{addr:a,subs:l}=Ui(t);let d=l.get(i);if(!d){const h={address:a||t,topics:o},f=w=>{let b=s;if(b==null)try{b=t.interface.getEvent(w.topics[0])}catch{}if(b){const y=b,x=s?t.interface.decodeEventLog(s,w.data,w.topics):[];bT(t,n,x,v=>new Ane(t,v,n,y,w))}else bT(t,n,[],y=>new T8(t,y,n,w))};let p=[];d={tag:i,listeners:[],start:()=>{p.length||p.push(r.on(h,f))},stop:async()=>{if(p.length==0)return;let w=p;p=[],await Promise.all(w),r.off(h,f)}},l.set(i,d)}return d}let xT=Promise.resolve();async function Pne(t,e,n,r){await xT;const s=await ny(t,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const l=Array.from(n);r&&l.push(r(a?null:o));try{o.call(t,...l)}catch{}return!a}),s.listeners.length===0&&(s.stop(),Ui(t).subs.delete(s.tag)),i>0}async function bT(t,e,n,r){try{await xT}catch{}const s=Pne(t,e,n,r);return xT=s,await s}const Gb=["then"];var RM;RM=fE;const Hy=class Hy{constructor(e,n,r,s){q(this,"target");q(this,"interface");q(this,"runner");q(this,"filters");q(this,RM);q(this,"fallback");Z(typeof e=="string"||L$(e),"invalid value for Contract target","target",e),r==null&&(r=null);const i=uE.from(n);yt(this,{target:e,runner:r,interface:i}),Object.defineProperty(this,fE,{value:{}});let o,a=null,l=null;if(s){const h=uh(r);l=new LI(this.interface,h,s)}let d=new Map;if(typeof e=="string")if(Tn(e))a=e,o=Promise.resolve(e);else{const h=hf(r,"resolveName");if(!qC(h))throw Bn("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(f=>{if(f==null)throw Bn("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Ui(this).addr=f,f})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Ui(this).addr=h,h});Rne(this,{addrPromise:o,addr:a,deployTx:l,subs:d});const u=new Proxy({},{get:(h,f,p)=>{if(typeof f=="symbol"||Gb.indexOf(f)>=0)return Reflect.get(h,f,p);try{return this.getEvent(f)}catch(m){if(!rs(m,"INVALID_ARGUMENT")||m.argument!=="key")throw m}},has:(h,f)=>Gb.indexOf(f)>=0?Reflect.has(h,f):Reflect.has(h,f)||this.interface.hasEvent(String(f))});return yt(this,{filters:u}),yt(this,{fallback:i.receive||i.fallback?_ne(this):null}),new Proxy(this,{get:(h,f,p)=>{if(typeof f=="symbol"||f in h||Gb.indexOf(f)>=0)return Reflect.get(h,f,p);try{return h.getFunction(f)}catch(m){if(!rs(m,"INVALID_ARGUMENT")||m.argument!=="key")throw m}},has:(h,f)=>typeof f=="symbol"||f in h||Gb.indexOf(f)>=0?Reflect.has(h,f):h.interface.hasFunction(f)})}connect(e){return new Hy(this.target,this.interface,e)}attach(e){return new Hy(e,this.interface,this.runner)}async getAddress(){return await Ui(this).addrPromise}async getDeployedCode(){const e=uh(this.runner);ge(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const n=await e.getCode(await this.getAddress());return n==="0x"?null:n}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=uh(this.runner);return ge(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);r.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return Ui(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),kne(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),Ine(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,n,r){n==null&&(n=0),r==null&&(r="latest");const{addr:s,addrPromise:i}=Ui(this),o=s||await i,{fragment:a,topics:l}=await BI(this,e),d={address:o,topics:l,fromBlock:n,toBlock:r},u=uh(this.runner);return ge(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(d)).map(h=>{let f=a;if(f==null)try{f=this.interface.getEvent(h.topics[0])}catch{}if(f)try{return new UI(h,this.interface,f)}catch(p){return new S8(h,p)}return new Yx(h,u)})}async on(e,n){const r=await yO(this,"on",e);return r.listeners.push({listener:n,once:!1}),r.start(),this}async once(e,n){const r=await yO(this,"once",e);return r.listeners.push({listener:n,once:!0}),r.start(),this}async emit(e,...n){return await bT(this,e,n,null)}async listenerCount(e){if(e){const s=await ny(this,e);return s?s.listeners.length:0}const{subs:n}=Ui(this);let r=0;for(const{listeners:s}of n.values())r+=s.length;return r}async listeners(e){if(e){const s=await ny(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:n}=Ui(this);let r=[];for(const{listeners:s}of n.values())r=r.concat(s.map(({listener:i})=>i));return r}async off(e,n){const r=await ny(this,e);if(!r)return this;if(n){const s=r.listeners.map(({listener:i})=>i).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(n==null||r.listeners.length===0)&&(r.stop(),Ui(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const n=await ny(this,e);if(!n)return this;n.stop(),Ui(this).subs.delete(n.tag)}else{const{subs:n}=Ui(this);for(const{tag:r,stop:s}of n.values())s(),n.delete(r)}return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return await this.off(e,n)}static buildClass(e){class n extends Hy{constructor(s,i=null){super(s,e,i)}}return n}static from(e,n,r){return r==null&&(r=null),new this(e,n,r)}};let vT=Hy;function One(){return vT}class rr extends One(){}function CA(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):Z(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class Dne{constructor(e){q(this,"name");yt(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,n){throw new Error("unsupported coin")}async decodeAddress(e,n){throw new Error("unsupported coin")}}const O8=new RegExp("^(ipfs)://(.*)$","i"),wO=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),O8,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var Td,Dh,_d,xp,rC,D8;const Gp=class Gp{constructor(e,n,r){se(this,_d);q(this,"provider");q(this,"address");q(this,"name");se(this,Td);se(this,Dh);yt(this,{provider:e,address:n,name:r}),z(this,Td,null),z(this,Dh,new rr(n,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return k(this,Td)==null&&z(this,Td,(async()=>{try{return await k(this,Dh).supportsInterface("0x9061b923")}catch(e){if(rs(e,"CALL_EXCEPTION"))return!1;throw z(this,Td,null),e}})()),await k(this,Td)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await Ne(this,_d,xp).call(this,"addr(bytes32)");return i==null||i===fw?null:i}catch(i){if(rs(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await Ne(this,_d,xp).call(this,"addr(bytes32,uint)",[i]);if(Tn(o,20))return dn(o)}let n=null;for(const i of this.provider.plugins)if(i instanceof Dne&&i.supportsCoinType(e)){n=i;break}if(n==null)return null;const r=await Ne(this,_d,xp).call(this,"addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const s=await n.decodeAddress(e,r);if(s!=null)return s;ge(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const n=await Ne(this,_d,xp).call(this,"text(bytes32,string)",[e]);return n==null||n==="0x"?null:n}async getContentHash(){const e=await Ne(this,_d,xp).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const n=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(n){const s=n[1]==="e3010170"?"ipfs":"ipns",i=parseInt(n[4],16);if(n[5].length===i*2)return`${s}://${BZ("0x"+n[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;ge(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const n=await this.getText("avatar");if(n==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:n});for(let r=0;r<wO.length;r++){const s=n.match(wO[r]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:n}),{linkage:e,url:n};case"ipfs":{const o=CA(n);return e.push({type:"ipfs",value:n}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:n});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const l=(s[2]||"").split("/");if(l.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const d=l[1],u=new rr(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const g=await u.ownerOf(d);if(a!==g)return e.push({type:"!owner",value:g}),{url:null,linkage:e};e.push({type:"owner",value:g})}else if(i==="erc1155"){const g=await u.balanceOf(a,d);if(!g)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:g.toString()})}let h=await u[o](d);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",su(d,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=CA(h)),e.push({type:"metadata-url",value:h});let f={};const p=await new Tl(h).send();p.assertOk();try{f=p.bodyJson}catch{try{e.push({type:"!metadata",value:p.bodyText})}catch{const b=p.body;return b&&e.push({type:"!metadata",value:Be(b)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!f)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(f)});let m=f.image;if(typeof m!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!m.match(/^(https:\/\/|data:)/i)){if(m.match(O8)==null)return e.push({type:"!imageUrl-ipfs",value:m}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:m}),m=CA(m)}return e.push({type:"url",value:m}),{linkage:e,url:m}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const n=await e.getNetwork(),r=n.getPlugin("org.ethers.plugins.network.Ens");return ge(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:n}}),r.address}static async fromName(e,n){var s;let r=n;for(;;){if(r===""||r==="."||n!=="eth"&&r==="eth")return null;const i=await Ne(s=Gp,rC,D8).call(s,e,r);if(i!=null){const o=new Gp(e,i,n);return r!==n&&!await o.supportsWildcard()?null:o}r=r.split(".").slice(1).join(".")}}};Td=new WeakMap,Dh=new WeakMap,_d=new WeakSet,xp=async function(e,n){n=(n||[]).slice();const r=k(this,Dh).interface;n.unshift(yT(this.name));let s=null;await this.supportsWildcard()&&(s=r.getFunction(e),ge(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),n=[Qte(this.name,255),r.encodeFunctionData(s,n)],e="resolve(bytes,bytes)"),n.push({enableCcipRead:!0});try{const i=await k(this,Dh)[e](...n);return s?r.decodeFunctionResult(s,i)[0]:i}catch(i){if(!rs(i,"CALL_EXCEPTION"))throw i}return null},rC=new WeakSet,D8=async function(e,n){const r=await Gp.getEnsAddress(e);try{const i=await new rr(r,["function resolver(bytes32) view returns (address)"],e).resolver(yT(n),{enableCcipRead:!0});return i===fw?null:i}catch(s){throw s}return null},se(Gp,rC);let pE=Gp;const xO=BigInt(0);function Ht(t,e){return function(n){return n==null?e:t(n)}}function Ew(t,e){return n=>{if(e&&n==null)return null;if(!Array.isArray(n))throw new Error("not an array");return n.map(r=>t(r))}}function Qx(t,e){return n=>{const r={};for(const s in t){let i=s;if(e&&s in e&&!(i in n)){for(const o of e[s])if(o in n){i=o;break}}try{const o=t[s](n[i]);o!==void 0&&(r[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";ge(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:n})}}return r}}function Mne(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}Z(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}function vg(t){return Z(Tn(t,!0),"invalid data","value",t),t}function ns(t){return Z(Tn(t,32),"invalid hash","value",t),t}const Une=Qx({address:dn,blockHash:ns,blockNumber:St,data:vg,index:St,removed:Ht(Mne,!1),topics:Ew(ns),transactionHash:ns,transactionIndex:St},{index:["logIndex"]});function Lne(t){return Une(t)}const Bne=Qx({hash:Ht(ns),parentHash:ns,parentBeaconBlockRoot:Ht(ns,null),number:St,timestamp:St,nonce:Ht(vg),difficulty:Je,gasLimit:Je,gasUsed:Je,stateRoot:Ht(ns,null),receiptsRoot:Ht(ns,null),blobGasUsed:Ht(Je,null),excessBlobGas:Ht(Je,null),miner:Ht(dn),prevRandao:Ht(ns,null),extraData:vg,baseFeePerGas:Ht(Je)},{prevRandao:["mixHash"]});function $ne(t){const e=Bne(t);return e.transactions=t.transactions.map(n=>typeof n=="string"?n:M8(n)),e}const Fne=Qx({transactionIndex:St,blockNumber:St,transactionHash:ns,address:dn,topics:Ew(ns),data:vg,index:St,blockHash:ns},{index:["logIndex"]});function zne(t){return Fne(t)}const Hne=Qx({to:Ht(dn,null),from:Ht(dn,null),contractAddress:Ht(dn,null),index:St,root:Ht(Be),gasUsed:Je,blobGasUsed:Ht(Je,null),logsBloom:Ht(vg),blockHash:ns,hash:ns,logs:Ew(zne),blockNumber:St,cumulativeGasUsed:Je,effectiveGasPrice:Ht(Je),blobGasPrice:Ht(Je,null),status:Ht(St),type:Ht(St,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Vne(t){return Hne(t)}function M8(t){t.to&&Je(t.to)===xO&&(t.to="0x0000000000000000000000000000000000000000");const e=Qx({hash:ns,index:Ht(St,void 0),type:n=>n==="0x"||n==null?0:St(n),accessList:Ht(_f,null),blobVersionedHashes:Ht(Ew(ns,!0),null),authorizationList:Ht(Ew(n=>{let r;if(n.signature)r=n.signature;else{let s=n.yParity;s==="0x1b"?s=0:s==="0x1c"&&(s=1),r=Object.assign({},n,{yParity:s})}return{address:dn(n.address),chainId:Je(n.chainId),nonce:Je(n.nonce),signature:Ti.from(r)}},!1),null),blockHash:Ht(ns,null),blockNumber:Ht(St,null),transactionIndex:Ht(St,null),from:dn,gasPrice:Ht(Je),maxPriorityFeePerGas:Ht(Je),maxFeePerGas:Ht(Je),maxFeePerBlobGas:Ht(Je,null),gasLimit:Je,to:Ht(dn,null),value:Je,nonce:St,data:vg,creates:Ht(dn,null),chainId:Ht(Je,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(e.to==null&&e.creates==null&&(e.creates=jee(e)),(t.type===1||t.type===2)&&t.accessList==null&&(e.accessList=[]),t.signature?e.signature=Ti.from(t.signature):e.signature=Ti.from(t),e.chainId==null){const n=e.signature.legacyChainId;n!=null&&(e.chainId=n)}return e.blockHash&&Je(e.blockHash)===xO&&(e.blockHash=null),e}const Wne="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Jx{constructor(e){q(this,"name");yt(this,{name:e})}clone(){return new Jx(this.name)}}class KC extends Jx{constructor(n,r){n==null&&(n=0);super(`org.ethers.network.plugins.GasCost#${n||0}`);q(this,"effectiveBlock");q(this,"txBase");q(this,"txCreate");q(this,"txDataZero");q(this,"txDataNonzero");q(this,"txAccessListStorageKey");q(this,"txAccessListAddress");const s={effectiveBlock:n};function i(o,a){let l=(r||{})[o];l==null&&(l=a),Z(typeof l=="number",`invalud value for ${o}`,"costs",r),s[o]=l}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),yt(this,s)}clone(){return new KC(this.effectiveBlock,this)}}class GC extends Jx{constructor(n,r){super("org.ethers.plugins.network.Ens");q(this,"address");q(this,"targetNetwork");yt(this,{address:n||Wne,targetNetwork:r??1})}clone(){return new GC(this.address,this.targetNetwork)}}var Px,Ox;class qne extends Jx{constructor(n,r){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");se(this,Px);se(this,Ox);z(this,Px,n),z(this,Ox,r)}get url(){return k(this,Px)}get processFunc(){return k(this,Ox)}clone(){return this}}Px=new WeakMap,Ox=new WeakMap;const NA=new Map;var Bm,$m,kd;const Yp=class Yp{constructor(e,n){se(this,Bm);se(this,$m);se(this,kd);z(this,Bm,e),z(this,$m,Je(n)),z(this,kd,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return k(this,Bm)}set name(e){z(this,Bm,e)}get chainId(){return k(this,$m)}set chainId(e){z(this,$m,Je(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===Je(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===Je(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===Je(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(k(this,kd).values())}attachPlugin(e){if(k(this,kd).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return k(this,kd).set(e.name,e.clone()),this}getPlugin(e){return k(this,kd).get(e)||null}getPlugins(e){return this.plugins.filter(n=>n.name.split("#")[0]===e)}clone(){const e=new Yp(this.name,this.chainId);return this.plugins.forEach(n=>{e.attachPlugin(n.clone())}),e}computeIntrinsicGas(e){const n=this.getPlugin("org.ethers.plugins.network.GasCost")||new KC;let r=n.txBase;if(e.to==null&&(r+=n.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?r+=n.txDataZero:r+=n.txDataNonzero;if(e.accessList){const s=_f(e.accessList);for(const i in s)r+=n.txAccessListAddress+n.txAccessListStorageKey*s[i].storageKeys.length}return r}static from(e){if(Kne(),e==null)return Yp.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const n=NA.get(e);if(n)return n();if(typeof e=="bigint")return new Yp("unknown",e);Z(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){Z(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const n=new Yp(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&n.attachPlugin(new GC(e.ensAddress,e.ensNetwork)),n}Z(!1,"invalid network","network",e)}static register(e,n){typeof e=="number"&&(e=BigInt(e));const r=NA.get(e);r&&Z(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),NA.set(e,n)}};Bm=new WeakMap,$m=new WeakMap,kd=new WeakMap;let ac=Yp;function bO(t,e){const n=String(t);if(!n.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const r=n.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${t}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let s=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||s++,r[1]=s.toString()}return BigInt(r[0]+r[1])}function vO(t){return new qne(t,async(e,n,r)=>{r.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([r.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:bO(a.maxFee,9),maxPriorityFeePerGas:bO(a.maxPriorityFee,9)}}catch(i){ge(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:s,error:i})}})}let EO=!1;function Kne(){if(EO)return;EO=!0;function t(e,n,r){const s=function(){const i=new ac(e,n);return r.ensNetwork!=null&&i.attachPlugin(new GC(null,r.ensNetwork)),i.attachPlugin(new KC),(r.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};ac.register(e,s),ac.register(n,s),r.altNames&&r.altNames.forEach(i=>{ac.register(i,s)})}t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[vO("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[vO("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}function ET(t){return JSON.parse(JSON.stringify(t))}var rl,go,Id,Ja,Fm,t1;class Gne{constructor(e){se(this,Fm);se(this,rl);se(this,go);se(this,Id);se(this,Ja);z(this,rl,e),z(this,go,null),z(this,Id,4e3),z(this,Ja,-2)}get pollingInterval(){return k(this,Id)}set pollingInterval(e){z(this,Id,e)}start(){k(this,go)||(z(this,go,k(this,rl)._setTimeout(Ne(this,Fm,t1).bind(this),k(this,Id))),Ne(this,Fm,t1).call(this))}stop(){k(this,go)&&(k(this,rl)._clearTimeout(k(this,go)),z(this,go,null))}pause(e){this.stop(),e&&z(this,Ja,-2)}resume(){this.start()}}rl=new WeakMap,go=new WeakMap,Id=new WeakMap,Ja=new WeakMap,Fm=new WeakSet,t1=async function(){try{const e=await k(this,rl).getBlockNumber();if(k(this,Ja)===-2){z(this,Ja,e);return}if(e!==k(this,Ja)){for(let n=k(this,Ja)+1;n<=e;n++){if(k(this,go)==null)return;await k(this,rl).emit("block",n)}z(this,Ja,e)}}catch{}k(this,go)!=null&&z(this,go,k(this,rl)._setTimeout(Ne(this,Fm,t1).bind(this),k(this,Id)))};var Mh,Uh,Rd;class $I{constructor(e){se(this,Mh);se(this,Uh);se(this,Rd);z(this,Mh,e),z(this,Rd,!1),z(this,Uh,n=>{this._poll(n,k(this,Mh))})}async _poll(e,n){throw new Error("sub-classes must override this")}start(){k(this,Rd)||(z(this,Rd,!0),k(this,Uh).call(this,-2),k(this,Mh).on("block",k(this,Uh)))}stop(){k(this,Rd)&&(z(this,Rd,!1),k(this,Mh).off("block",k(this,Uh)))}pause(e){this.stop()}resume(){this.start()}}Mh=new WeakMap,Uh=new WeakMap,Rd=new WeakMap;var zm,sl;class Yne extends $I{constructor(n,r){super(n);se(this,zm);se(this,sl);z(this,zm,r),z(this,sl,-2)}pause(n){n&&z(this,sl,-2),super.pause(n)}async _poll(n,r){const s=await r.getBlock(k(this,zm));s!=null&&(k(this,sl)===-2?z(this,sl,s.number):s.number>k(this,sl)&&(r.emit(k(this,zm),s.number),z(this,sl,s.number)))}}zm=new WeakMap,sl=new WeakMap;var sC;class Qne extends $I{constructor(n,r){super(n);se(this,sC);z(this,sC,ET(r))}async _poll(n,r){throw new Error("@TODO")}}sC=new WeakMap;var Hm;class Jne extends $I{constructor(n,r){super(n);se(this,Hm);z(this,Hm,r)}async _poll(n,r){const s=await r.getTransactionReceipt(k(this,Hm));s&&r.emit(k(this,Hm),s)}}Hm=new WeakMap;var il,Vm,Wm,jd,yo,iC,U8;class FI{constructor(e,n){se(this,iC);se(this,il);se(this,Vm);se(this,Wm);se(this,jd);se(this,yo);z(this,il,e),z(this,Vm,ET(n)),z(this,Wm,Ne(this,iC,U8).bind(this)),z(this,jd,!1),z(this,yo,-2)}start(){k(this,jd)||(z(this,jd,!0),k(this,yo)===-2&&k(this,il).getBlockNumber().then(e=>{z(this,yo,e)}),k(this,il).on("block",k(this,Wm)))}stop(){k(this,jd)&&(z(this,jd,!1),k(this,il).off("block",k(this,Wm)))}pause(e){this.stop(),e&&z(this,yo,-2)}resume(){this.start()}}il=new WeakMap,Vm=new WeakMap,Wm=new WeakMap,jd=new WeakMap,yo=new WeakMap,iC=new WeakSet,U8=async function(e){if(k(this,yo)===-2)return;const n=ET(k(this,Vm));n.fromBlock=k(this,yo)+1,n.toBlock=e;const r=await k(this,il).getLogs(n);if(r.length===0){k(this,yo)<e-60&&z(this,yo,e-60);return}for(const s of r)k(this,il).emit(k(this,Vm),s),z(this,yo,s.blockNumber)};const Zne=BigInt(2),Xne=10;function Yb(t){return t&&typeof t.then=="function"}function n1(t,e){return t+":"+JSON.stringify(e,(n,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const s=Object.keys(r);return s.sort(),s.reduce((i,o)=>(i[o]=r[o],i),{})}return r})}class L8{constructor(e){q(this,"name");yt(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function ere(t){return JSON.parse(JSON.stringify(t))}function CT(t){return t=Array.from(new Set(t).values()),t.sort(),t}async function AA(t,e){if(t==null)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),typeof t=="string")switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(Tn(t,32)){const n=t.toLowerCase();return{type:"transaction",tag:n1("tx",{hash:n}),hash:n}}if(t.orphan){const n=t;return{type:"orphan",tag:n1("orphan",n),filter:ere(n)}}if(t.address||t.topics){const n=t,r={topics:(n.topics||[]).map(s=>s==null?null:Array.isArray(s)?CT(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(n.address){const s=[],i=[],o=a=>{Tn(a)?s.push(a):i.push((async()=>{s.push(await Hs(a,e))})())};Array.isArray(n.address)?n.address.forEach(o):o(n.address),i.length&&await Promise.all(i),r.address=CT(s.map(a=>a.toLowerCase()))}return{filter:r,tag:n1("event",r),type:"event"}}Z(!1,"unknown ProviderEvent","event",t)}function SA(){return new Date().getTime()}const tre={cacheTimeout:250,pollingInterval:4e3};var As,Pd,Ss,qm,Fi,Lh,Od,ol,Dx,wo,Km,Gm,Ot,Oi,NT,AT,ry,ST,sy,r1;class nre{constructor(e,n){se(this,Ot);se(this,As);se(this,Pd);se(this,Ss);se(this,qm);se(this,Fi);se(this,Lh);se(this,Od);se(this,ol);se(this,Dx);se(this,wo);se(this,Km);se(this,Gm);if(z(this,Gm,Object.assign({},tre,n||{})),e==="any")z(this,Lh,!0),z(this,Fi,null);else if(e){const r=ac.from(e);z(this,Lh,!1),z(this,Fi,Promise.resolve(r)),setTimeout(()=>{this.emit("network",r,null)},0)}else z(this,Lh,!1),z(this,Fi,null);z(this,ol,-1),z(this,Od,new Map),z(this,As,new Map),z(this,Pd,new Map),z(this,Ss,null),z(this,qm,!1),z(this,Dx,1),z(this,wo,new Map),z(this,Km,!1)}get pollingInterval(){return k(this,Gm).pollingInterval}get provider(){return this}get plugins(){return Array.from(k(this,Pd).values())}attachPlugin(e){if(k(this,Pd).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return k(this,Pd).set(e.name,e.connect(this)),this}getPlugin(e){return k(this,Pd).get(e)||null}get disableCcipRead(){return k(this,Km)}set disableCcipRead(e){z(this,Km,!!e)}async ccipReadFetch(e,n,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=n.toLowerCase(),o=[];for(let a=0;a<r.length;a++){const l=r[a],d=l.replace("{sender}",s).replace("{data}",i),u=new Tl(d);l.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:r});let h="unknown error",f;try{f=await u.send()}catch(p){o.push(p.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:p}});continue}try{const p=f.bodyJson;if(p.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:p}),p.data;p.message&&(h=p.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:p})}catch{}ge(f.statusCode<400||f.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:l,errorMessage:h}}),o.push(h)}ge(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,n){return new vne($ne(e),this)}_wrapLog(e,n){return new Yx(Lne(e),this)}_wrapTransactionReceipt(e,n){return new C8(Vne(e),this)}_wrapTransactionResponse(e,n){return new vw(M8(e),this)}_detectNetwork(){ge(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){ge(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=St(await Ne(this,Ot,Oi).call(this,{method:"getBlockNumber"}),"%response");return k(this,ol)>=0&&z(this,ol,e),e}_getAddress(e){return Hs(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Tn(e))return Tn(e,32)?e:ua(e);if(typeof e=="bigint"&&(e=St(e,"blockTag")),typeof e=="number")return e>=0?ua(e):k(this,ol)>=0?ua(k(this,ol)+e):this.getBlockNumber().then(n=>ua(n+e));Z(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const n=(e.topics||[]).map(l=>l==null?null:Array.isArray(l)?CT(l.map(d=>d.toLowerCase())):l.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,s=(l,d,u)=>{let h;switch(l.length){case 0:break;case 1:h=l[0];break;default:l.sort(),h=l}if(r&&(d!=null||u!=null))throw new Error("invalid filter");const f={};return h&&(f.address=h),n.length&&(f.topics=n),d&&(f.fromBlock=d),u&&(f.toBlock=u),r&&(f.blockHash=r),f};let i=[];if(e.address)if(Array.isArray(e.address))for(const l of e.address)i.push(this._getAddress(l));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(l=>typeof l!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(l=>s(l[0],l[1],l[2])):s(i,o,a)}_getTransactionRequest(e){const n=hE(e),r=[];if(["to","from"].forEach(s=>{if(n[s]==null)return;const i=Hs(n[s],this);Yb(i)?r.push(async function(){n[s]=await i}()):n[s]=i}),n.blockTag!=null){const s=this._getBlockTag(n.blockTag);Yb(s)?r.push(async function(){n.blockTag=await s}()):n.blockTag=s}return r.length?async function(){return await Promise.all(r),n}():n}async getNetwork(){if(k(this,Fi)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw k(this,Fi)===s&&z(this,Fi,null),i}})();return z(this,Fi,s),(await s).clone()}const e=k(this,Fi),[n,r]=await Promise.all([e,this._detectNetwork()]);return n.chainId!==r.chainId&&(k(this,Lh)?(this.emit("network",r,n),k(this,Fi)===e&&z(this,Fi,Promise.resolve(r))):ge(!1,`network changed: ${n.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),n.clone()}async getFeeData(){const e=await this.getNetwork(),n=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await $s({_block:Ne(this,Ot,ST).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await Ne(this,Ot,Oi).call(this,{method:"getGasPrice"});return Je(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await Ne(this,Ot,Oi).call(this,{method:"getPriorityFee"});return Je(u,"%response")}catch{}return null})()});let a=null,l=null;const d=this._wrapBlock(s,e);return d&&d.baseFeePerGas&&(l=o??BigInt("1000000000"),a=d.baseFeePerGas*Zne+l),new mO(i,a,l)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const s=new Tl(r.url),i=await r.processFunc(n,this,s);return new mO(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await n()}async estimateGas(e){let n=this._getTransactionRequest(e);return Yb(n)&&(n=await n),Je(await Ne(this,Ot,Oi).call(this,{method:"estimateGas",transaction:n}),"%response")}async call(e){const{tx:n,blockTag:r}=await $s({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await Ne(this,Ot,AT).call(this,Ne(this,Ot,NT).call(this,n,r,e.enableCcipRead?0:-1))}async getBalance(e,n){return Je(await Ne(this,Ot,ry).call(this,{method:"getBalance"},e,n),"%response")}async getTransactionCount(e,n){return St(await Ne(this,Ot,ry).call(this,{method:"getTransactionCount"},e,n),"%response")}async getCode(e,n){return Be(await Ne(this,Ot,ry).call(this,{method:"getCode"},e,n))}async getStorage(e,n,r){const s=Je(n,"position");return Be(await Ne(this,Ot,ry).call(this,{method:"getStorage",position:s},e,r))}async broadcastTransaction(e){const{blockNumber:n,hash:r,network:s}=await $s({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=sE.from(e);if(i.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(n)}async getBlock(e,n){const{network:r,params:s}=await $s({network:this.getNetwork(),params:Ne(this,Ot,ST).call(this,e,!!n)});return s==null?null:this._wrapBlock(s,r)}async getTransaction(e){const{network:n,params:r}=await $s({network:this.getNetwork(),params:Ne(this,Ot,Oi).call(this,{method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,n)}async getTransactionReceipt(e){const{network:n,params:r}=await $s({network:this.getNetwork(),params:Ne(this,Ot,Oi).call(this,{method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const s=await Ne(this,Ot,Oi).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(r,n)}async getTransactionResult(e){const{result:n}=await $s({network:this.getNetwork(),result:Ne(this,Ot,Oi).call(this,{method:"getTransactionResult",hash:e})});return n==null?null:Be(n)}async getLogs(e){let n=this._getFilter(e);Yb(n)&&(n=await n);const{network:r,params:s}=await $s({network:this.getNetwork(),params:Ne(this,Ot,Oi).call(this,{method:"getLogs",filter:n})});return s.map(i=>this._wrapLog(i,r))}_getProvider(e){ge(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await pE.fromName(this,e)}async getAvatar(e){const n=await this.getResolver(e);return n?await n.getAvatar():null}async resolveName(e){const n=await this.getResolver(e);return n?await n.getAddress():null}async lookupAddress(e){e=dn(e);const n=yT(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await pE.getEnsAddress(this),i=await new rr(r,["function resolver(bytes32) view returns (address)"],this).resolver(n);if(i==null||i===fw)return null;const a=await new rr(i,["function name(bytes32) view returns (string)"],this).name(n);return await this.resolveName(a)!==e?null:a}catch(r){if(rs(r,"BAD_DATA")&&r.value==="0x"||rs(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,n,r){const s=n??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const l=async d=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&d-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",l)};r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",l),o(Bn("timeout","TIMEOUT",{reason:"timeout"})))},r)),l(await this.getBlockNumber())})}async waitForBlock(e){ge(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const n=k(this,wo).get(e);n&&(n.timer&&clearTimeout(n.timer),k(this,wo).delete(e))}_setTimeout(e,n){n==null&&(n=0);const r=d0(this,Dx)._++,s=()=>{k(this,wo).delete(r),e()};if(this.paused)k(this,wo).set(r,{timer:null,func:s,time:n});else{const i=setTimeout(s,n);k(this,wo).set(r,{timer:i,func:s,time:SA()})}return r}_forEachSubscriber(e){for(const n of k(this,As).values())e(n.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new L8(e.type);case"block":{const n=new Gne(this);return n.pollingInterval=this.pollingInterval,n}case"safe":case"finalized":return new Yne(this,e.type);case"event":return new FI(this,e.filter);case"transaction":return new Jne(this,e.hash);case"orphan":return new Qne(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,n){for(const r of k(this,As).values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=n,r.started&&n.start(),k(this,Ss)!=null&&n.pause(k(this,Ss));break}}async on(e,n){const r=await Ne(this,Ot,r1).call(this,e);return r.listeners.push({listener:n,once:!1}),r.started||(r.subscriber.start(),r.started=!0,k(this,Ss)!=null&&r.subscriber.pause(k(this,Ss))),this}async once(e,n){const r=await Ne(this,Ot,r1).call(this,e);return r.listeners.push({listener:n,once:!0}),r.started||(r.subscriber.start(),r.started=!0,k(this,Ss)!=null&&r.subscriber.pause(k(this,Ss))),this}async emit(e,...n){const r=await Ne(this,Ot,sy).call(this,e,n);if(!r||r.listeners.length===0)return!1;const s=r.listeners.length;return r.listeners=r.listeners.filter(({listener:i,once:o})=>{const a=new JB(this,o?null:i,e);try{i.call(this,...n,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),k(this,As).delete(r.tag)),s>0}async listenerCount(e){if(e){const r=await Ne(this,Ot,sy).call(this,e);return r?r.listeners.length:0}let n=0;for(const{listeners:r}of k(this,As).values())n+=r.length;return n}async listeners(e){if(e){const r=await Ne(this,Ot,sy).call(this,e);return r?r.listeners.map(({listener:s})=>s):[]}let n=[];for(const{listeners:r}of k(this,As).values())n=n.concat(r.map(({listener:s})=>s));return n}async off(e,n){const r=await Ne(this,Ot,sy).call(this,e);if(!r)return this;if(n){const s=r.listeners.map(({listener:i})=>i).indexOf(n);s>=0&&r.listeners.splice(s,1)}return(!n||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),k(this,As).delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:n,started:r,subscriber:s}=await Ne(this,Ot,r1).call(this,e);r&&s.stop(),k(this,As).delete(n)}else for(const[n,{started:r,subscriber:s}]of k(this,As))r&&s.stop(),k(this,As).delete(n);return this}async addListener(e,n){return await this.on(e,n)}async removeListener(e,n){return this.off(e,n)}get destroyed(){return k(this,qm)}destroy(){this.removeAllListeners();for(const e of k(this,wo).keys())this._clearTimeout(e);z(this,qm,!0)}get paused(){return k(this,Ss)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(z(this,ol,-1),k(this,Ss)!=null){if(k(this,Ss)==!!e)return;ge(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(n=>n.pause(e)),z(this,Ss,!!e);for(const n of k(this,wo).values())n.timer&&clearTimeout(n.timer),n.time=SA()-n.time}resume(){if(k(this,Ss)!=null){this._forEachSubscriber(e=>e.resume()),z(this,Ss,null);for(const e of k(this,wo).values()){let n=e.time;n<0&&(n=0),e.time=SA(),setTimeout(e.func,n)}}}}As=new WeakMap,Pd=new WeakMap,Ss=new WeakMap,qm=new WeakMap,Fi=new WeakMap,Lh=new WeakMap,Od=new WeakMap,ol=new WeakMap,Dx=new WeakMap,wo=new WeakMap,Km=new WeakMap,Gm=new WeakMap,Ot=new WeakSet,Oi=async function(e){const n=k(this,Gm).cacheTimeout;if(n<0)return await this._perform(e);const r=n1(e.method,e);let s=k(this,Od).get(r);return s||(s=this._perform(e),k(this,Od).set(r,s),setTimeout(()=>{k(this,Od).get(r)===s&&k(this,Od).delete(r)},n)),await s},NT=async function(e,n,r){ge(r<Xne,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:n,enableCcipRead:!0})});const s=hE(e);try{return Be(await this._perform({method:"call",transaction:s,blockTag:n}))}catch(i){if(!this.disableCcipRead&&NI(i)&&i.data&&r>=0&&n==="latest"&&s.to!=null&&Xn(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Hs(s.to,this);let l;try{l=are(Xn(i.data,4))}catch(h){ge(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}ge(l.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const d=await this.ccipReadFetch(s,l.calldata,l.urls);ge(d!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:l.errorArgs}});const u={to:a,data:ir([l.selector,ore([d,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await Ne(this,Ot,NT).call(this,u,n,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw i}},AT=async function(e){const{value:n}=await $s({network:this.getNetwork(),value:e});return n},ry=async function(e,n,r){let s=this._getAddress(n),i=this._getBlockTag(r);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await Ne(this,Ot,AT).call(this,Ne(this,Ot,Oi).call(this,Object.assign(e,{address:s,blockTag:i})))},ST=async function(e,n){if(Tn(e,32))return await Ne(this,Ot,Oi).call(this,{method:"getBlock",blockHash:e,includeTransactions:n});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await Ne(this,Ot,Oi).call(this,{method:"getBlock",blockTag:r,includeTransactions:n})},sy=async function(e,n){let r=await AA(e,this);return r.type==="event"&&n&&n.length>0&&n[0].removed===!0&&(r=await AA({orphan:"drop-log",log:n[0]},this)),k(this,As).get(r.tag)||null},r1=async function(e){const n=await AA(e,this),r=n.tag;let s=k(this,As).get(r);return s||(s={subscriber:this._getSubscriber(n),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},k(this,As).set(r,s)),s};function rre(t,e){try{const n=TT(t,e);if(n)return tE(n)}catch{}return null}function TT(t,e){if(t==="0x")return null;try{const n=St(Xn(t,e,e+32)),r=St(Xn(t,n,n+32));return Xn(t,n+32,n+32+r)}catch{}return null}function CO(t){const e=Or(t);if(e.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(e,32-e.length),n}function sre(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}const ire=new Uint8Array([]);function ore(t){const e=[];let n=0;for(let r=0;r<t.length;r++)e.push(ire),n+=32;for(let r=0;r<t.length;r++){const s=Rt(t[r]);e[r]=CO(n),e.push(CO(s.length)),e.push(sre(s)),n+=32+Math.ceil(s.length/32)*32}return ir(e)}const NO="0x0000000000000000000000000000000000000000000000000000000000000000";function are(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};ge(rm(t)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const n=Xn(t,0,32);ge(Xn(n,0,12)===Xn(NO,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Xn(n,12);try{const r=[],s=St(Xn(t,32,64)),i=St(Xn(t,s,s+32)),o=Xn(t,s+32);for(let a=0;a<i;a++){const l=rre(o,a*32);if(l==null)throw new Error("abort");r.push(l)}e.urls=r}catch{ge(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=TT(t,64);if(r==null)throw new Error("abort");e.calldata=r}catch{ge(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}ge(Xn(t,100,128)===Xn(NO,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Xn(t,96,100);try{const r=TT(t,128);if(r==null)throw new Error("abort");e.extraData=r}catch{ge(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function ku(t,e){if(t.provider)return t.provider;ge(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function AO(t,e){let n=hE(e);if(n.to!=null&&(n.to=Hs(n.to,t)),n.from!=null){const r=n.from;n.from=Promise.all([t.getAddress(),Hs(r,t)]).then(([s,i])=>(Z(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else n.from=t.getAddress();return await $s(n)}class cre{constructor(e){q(this,"provider");yt(this,{provider:e||null})}async getNonce(e){return ku(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await AO(this,e)}async populateTransaction(e){const n=ku(this,"populateTransaction"),r=await AO(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const s=await this.provider.getNetwork();if(r.chainId!=null){const o=Je(r.chainId);Z(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=s.chainId;const i=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||i)?Z(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&i&&Z(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await n.getFeeData();ge(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await n.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(ge(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):ge(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await $s(r)}async populateAuthorization(e){const n=Object.assign({},e);return n.chainId==null&&(n.chainId=(await ku(this,"getNetwork").getNetwork()).chainId),n.nonce==null&&(n.nonce=await this.getNonce()),n}async estimateGas(e){return ku(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return ku(this,"call").call(await this.populateCall(e))}async resolveName(e){return await ku(this,"resolveName").resolveName(e)}async sendTransaction(e){const n=ku(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const s=sE.from(r);return await n.broadcastTransaction(await this.signTransaction(s))}authorize(e){ge(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function lre(t){return JSON.parse(JSON.stringify(t))}var Ls,Za,Bh,Dd,$h,Ym,fu,_T,kT;class B8{constructor(e){se(this,fu);se(this,Ls);se(this,Za);se(this,Bh);se(this,Dd);se(this,$h);se(this,Ym);z(this,Ls,e),z(this,Za,null),z(this,Bh,Ne(this,fu,_T).bind(this)),z(this,Dd,!1),z(this,$h,null),z(this,Ym,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,n){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){k(this,Dd)||(z(this,Dd,!0),Ne(this,fu,_T).call(this,-2))}stop(){k(this,Dd)&&(z(this,Dd,!1),z(this,Ym,!0),Ne(this,fu,kT).call(this),k(this,Ls).off("block",k(this,Bh)))}pause(e){e&&Ne(this,fu,kT).call(this),k(this,Ls).off("block",k(this,Bh))}resume(){this.start()}}Ls=new WeakMap,Za=new WeakMap,Bh=new WeakMap,Dd=new WeakMap,$h=new WeakMap,Ym=new WeakMap,fu=new WeakSet,_T=async function(e){try{k(this,Za)==null&&z(this,Za,this._subscribe(k(this,Ls)));let n=null;try{n=await k(this,Za)}catch(i){if(!rs(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(n==null){z(this,Za,null),k(this,Ls)._recoverSubscriber(this,this._recover(k(this,Ls)));return}const r=await k(this,Ls).getNetwork();if(k(this,$h)||z(this,$h,r),k(this,$h).chainId!==r.chainId)throw new Error("chaid changed");if(k(this,Ym))return;const s=await k(this,Ls).send("eth_getFilterChanges",[n]);await this._emitResults(k(this,Ls),s)}catch(n){console.log("@TODO",n)}k(this,Ls).once("block",k(this,Bh))},kT=function(){const e=k(this,Za);e&&(z(this,Za,null),e.then(n=>{k(this,Ls).destroyed||k(this,Ls).send("eth_uninstallFilter",[n])}))};var Fh;class dre extends B8{constructor(n,r){super(n);se(this,Fh);z(this,Fh,lre(r))}_recover(n){return new FI(n,k(this,Fh))}async _subscribe(n){return await n.send("eth_newFilter",[k(this,Fh)])}async _emitResults(n,r){for(const s of r)n.emit(k(this,Fh),n._wrapLog(s,n._network))}}Fh=new WeakMap;class ure extends B8{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,n){for(const r of n)e.emit("pending",r)}}const hre="bigint,boolean,function,number,string,symbol".split(/,/g);function s1(t){if(t==null||hre.indexOf(typeof t)>=0||typeof t.getAddress=="function")return t;if(Array.isArray(t))return t.map(s1);if(typeof t=="object")return Object.keys(t).reduce((e,n)=>(e[n]=t[n],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function fre(t){return new Promise(e=>{setTimeout(e,t)})}function qf(t){return t&&t.toLowerCase()}function SO(t){return t&&typeof t.pollingInterval=="number"}const $8={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class cm extends cre{constructor(n,r){super(n);q(this,"address");r=dn(r),yt(this,{address:r})}connect(n){ge(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(n){return await this.populateCall(n)}async sendUncheckedTransaction(n){const r=s1(n),s=[];if(r.from){const o=r.from;s.push((async()=>{const a=await Hs(o,this.provider);Z(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",n),r.from=a})())}else r.from=this.address;if(r.gasLimit==null&&s.push((async()=>{r.gasLimit=await this.provider.estimateGas({...r,from:this.address})})()),r.to!=null){const o=r.to;s.push((async()=>{r.to=await Hs(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(r);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(n){const r=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(n);return await new Promise((i,o)=>{const a=[1e3,100];let l=0;const d=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(r));return}}catch(u){if(rs(u,"CANCELLED")||rs(u,"BAD_DATA")||rs(u,"NETWORK_ERROR")||rs(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(rs(u,"INVALID_ARGUMENT")&&(l++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,l>10)){o(u);return}this.provider.emit("error",Bn("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{d()},a.pop()||4e3)};d()})}async signTransaction(n){const r=s1(n);if(r.from){const i=await Hs(r.from,this.provider);Z(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",n),r.from=i}else r.from=this.address;const s=this.provider.getRpcTransaction(r);return await this.provider.send("eth_signTransaction",[s])}async signMessage(n){const r=typeof n=="string"?mc(n):n;return await this.provider.send("personal_sign",[Be(r),this.address.toLowerCase()])}async signTypedData(n,r,s){const i=s1(s),o=await dE.resolveNames(n,r,i,async a=>{const l=await Hs(a);return Z(l!=null,"TypedData does not support null address","value",a),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(dE.getPayload(o.domain,r,o.value))])}async unlock(n){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),n,null])}async _legacySignMessage(n){const r=typeof n=="string"?mc(n):n;return await this.provider.send("eth_sign",[this.address.toLowerCase(),Be(r)])}}var zh,Qm,al,Xa,oa,xo,ui,Mx,IT;class pre extends nre{constructor(n,r){super(n,r);se(this,Mx);se(this,zh);se(this,Qm);se(this,al);se(this,Xa);se(this,oa);se(this,xo);se(this,ui);z(this,Qm,1),z(this,zh,Object.assign({},$8,r||{})),z(this,al,[]),z(this,Xa,null),z(this,xo,null),z(this,ui,null);{let i=null;const o=new Promise(a=>{i=a});z(this,oa,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(Z(!s||n!=="any","staticNetwork cannot be used on special network 'any'","options",r),s&&n!=null&&z(this,xo,ac.from(n))):s&&(Z(n==null||s.matches(n),"staticNetwork MUST match network object","options",r),z(this,xo,s))}_getOption(n){return k(this,zh)[n]}get _network(){return ge(k(this,xo),"network is not available yet","NETWORK_ERROR"),k(this,xo)}async _perform(n){if(n.method==="call"||n.method==="estimateGas"){let s=n.transaction;if(s&&s.type!=null&&Je(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(n=Object.assign({},n,{transaction:Object.assign({},s,{type:void 0})}))}}const r=this.getRpcRequest(n);return r!=null?await this.send(r.method,r.args):super._perform(n)}async _detectNetwork(){const n=this._getOption("staticNetwork");if(n)if(n===!0){if(k(this,xo))return k(this,xo)}else return n;return k(this,ui)?await k(this,ui):this.ready?(z(this,ui,(async()=>{try{const r=ac.from(Je(await this.send("eth_chainId",[])));return z(this,ui,null),r}catch(r){throw z(this,ui,null),r}})()),await k(this,ui)):(z(this,ui,(async()=>{const r={id:d0(this,Qm)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:r});let s;try{s=(await this._send(r))[0],z(this,ui,null)}catch(i){throw z(this,ui,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return ac.from(Je(s.result));throw this.getRpcError(r,s)})()),await k(this,ui))}_start(){k(this,oa)==null||k(this,oa).resolve==null||(k(this,oa).resolve(),z(this,oa,null),(async()=>{for(;k(this,xo)==null&&!this.destroyed;)try{z(this,xo,await this._detectNetwork())}catch(n){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Bn("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:n}})),await fre(1e3)}Ne(this,Mx,IT).call(this)})())}async _waitUntilReady(){if(k(this,oa)!=null)return await k(this,oa).promise}_getSubscriber(n){return n.type==="pending"?new ure(this):n.type==="event"?this._getOption("polling")?new FI(this,n.filter):new dre(this,n.filter):n.type==="orphan"&&n.filter.orphan==="drop-log"?new L8("orphan"):super._getSubscriber(n)}get ready(){return k(this,oa)==null}getRpcTransaction(n){const r={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(n[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),r[i]=ua(Je(n[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{n[s]!=null&&(r[s]=Be(n[s]))}),n.accessList&&(r.accessList=_f(n.accessList)),n.blobVersionedHashes&&(r.blobVersionedHashes=n.blobVersionedHashes.map(s=>s.toLowerCase())),n.authorizationList&&(r.authorizationList=n.authorizationList.map(s=>{const i=z$(s);return{address:i.address,nonce:ua(i.nonce),chainId:ua(i.chainId),yParity:ua(i.signature.yParity),r:ua(i.signature.r),s:ua(i.signature.s)}})),r}getRpcRequest(n){switch(n.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[qf(n.address),n.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[qf(n.address),n.blockTag]};case"getCode":return{method:"eth_getCode",args:[qf(n.address),n.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[qf(n.address),"0x"+n.position.toString(16),n.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[n.signedTransaction]};case"getBlock":if("blockTag"in n)return{method:"eth_getBlockByNumber",args:[n.blockTag,!!n.includeTransactions]};if("blockHash"in n)return{method:"eth_getBlockByHash",args:[n.blockHash,!!n.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[n.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[n.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(n.transaction),n.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(n.transaction)]};case"getLogs":return n.filter&&n.filter.address!=null&&(Array.isArray(n.filter.address)?n.filter.address=n.filter.address.map(qf):n.filter.address=qf(n.filter.address)),{method:"eth_getLogs",args:[n.filter]}}return null}getRpcError(n,r){const{method:s}=n,{error:i}=r;if(s==="eth_estimateGas"&&i.message){const l=i.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return Bn("insufficient funds","INSUFFICIENT_FUNDS",{transaction:n.params[0],info:{payload:n,error:i}});if(l.match(/nonce/i)&&l.match(/too low/i))return Bn("nonce has already been used","NONCE_EXPIRED",{transaction:n.params[0],info:{payload:n,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const l=RT(i),d=bw.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",n.params[0],l?l.data:null);return d.info={error:i,payload:n},d}const o=JSON.stringify(mre(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Bn("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:n,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const l=n.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Bn("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Bn("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Bn("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:i}});if(o.match(/only replay-protected/i))return Bn("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:l,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?Bn("unsupported operation","UNSUPPORTED_OPERATION",{operation:n.method,info:{error:i,payload:n}}):Bn("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:n})}send(n,r){if(this.destroyed)return Promise.reject(Bn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:n}));const s=d0(this,Qm)._++,i=new Promise((o,a)=>{k(this,al).push({resolve:o,reject:a,payload:{method:n,params:r,id:s,jsonrpc:"2.0"}})});return Ne(this,Mx,IT).call(this),i}async getSigner(n){n==null&&(n=0);const r=this.send("eth_accounts",[]);if(typeof n=="number"){const i=await r;if(n>=i.length)throw new Error("no such account");return new cm(this,i[n])}const{accounts:s}=await $s({network:this.getNetwork(),accounts:r});n=dn(n);for(const i of s)if(dn(i)===n)return new cm(this,n);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(r=>new cm(this,r))}destroy(){k(this,Xa)&&(clearTimeout(k(this,Xa)),z(this,Xa,null));for(const{payload:n,reject:r}of k(this,al))r(Bn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:n.method}));z(this,al,[]),super.destroy()}}zh=new WeakMap,Qm=new WeakMap,al=new WeakMap,Xa=new WeakMap,oa=new WeakMap,xo=new WeakMap,ui=new WeakMap,Mx=new WeakSet,IT=function(){if(k(this,Xa))return;const n=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");z(this,Xa,setTimeout(()=>{z(this,Xa,null);const r=k(this,al);for(z(this,al,[]);r.length;){const s=[r.shift()];for(;r.length&&s.length!==k(this,zh).batchMaxCount;)if(s.push(r.shift()),JSON.stringify(s.map(o=>o.payload)).length>k(this,zh).batchMaxSize){r.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:l,payload:d}of s){if(this.destroyed){l(Bn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:d.method}));continue}const u=o.filter(h=>h.id===d.id)[0];if(u==null){const h=Bn("missing response for request","BAD_DATA",{value:o,info:{payload:d}});this.emit("error",h),l(h);continue}if("error"in u){l(this.getRpcError(d,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},n))};var Md;class F8 extends pre{constructor(n,r){super(n,r);se(this,Md);let s=this._getOption("pollingInterval");s==null&&(s=$8.pollingInterval),z(this,Md,s)}_getSubscriber(n){const r=super._getSubscriber(n);return SO(r)&&(r.pollingInterval=k(this,Md)),r}get pollingInterval(){return k(this,Md)}set pollingInterval(n){if(!Number.isInteger(n)||n<0)throw new Error("invalid interval");z(this,Md,n),this._forEachSubscriber(r=>{SO(r)&&(r.pollingInterval=k(this,Md))})}}Md=new WeakMap;var Jm;class Eg extends F8{constructor(n,r,s){n==null&&(n="http://localhost:8545");super(r,s);se(this,Jm);typeof n=="string"?z(this,Jm,new Tl(n)):z(this,Jm,n.clone())}_getConnection(){return k(this,Jm).clone()}async send(n,r){return await this._start(),await super.send(n,r)}async _send(n){const r=this._getConnection();r.body=JSON.stringify(n),r.setHeader("content-type","application/json");const s=await r.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}Jm=new WeakMap;function RT(t){if(t==null)return null;if(typeof t.message=="string"&&t.message.match(/revert/i)&&Tn(t.data))return{message:t.message,data:t.data};if(typeof t=="object"){for(const e in t){const n=RT(t[e]);if(n)return n}return null}if(typeof t=="string")try{return RT(JSON.parse(t))}catch{}return null}function jT(t,e){if(t!=null){if(typeof t.message=="string"&&e.push(t.message),typeof t=="object")for(const n in t)jT(t[n],e);if(typeof t=="string")try{return jT(JSON.parse(t),e)}catch{}}}function mre(t){const e=[];return jT(t,e),e}var Zm,Xm;const eh=class eh extends F8{constructor(n,r,s){const i=Object.assign({},s??{},{batchMaxCount:1});Z(n&&n.request,"invalid EIP-1193 provider","ethereum",n);super(r,i);se(this,Zm);se(this,Xm);z(this,Xm,null),s&&s.providerInfo&&z(this,Xm,s.providerInfo),z(this,Zm,async(o,a)=>{const l={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:l});try{const d=await n.request(l);return this.emit("debug",{action:"receiveEip1193Result",result:d}),d}catch(d){const u=new Error(d.message);throw u.code=d.code,u.data=d.data,u.payload=l,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return k(this,Xm)}async send(n,r){return await this._start(),await super.send(n,r)}async _send(n){Z(!Array.isArray(n),"EIP-1193 does not support batch request","payload",n);try{const r=await k(this,Zm).call(this,n.method,n.params||[]);return[{id:n.id,result:r}]}catch(r){return[{id:n.id,error:{code:r.code,data:r.data,message:r.message}}]}}getRpcError(n,r){switch(r=JSON.parse(JSON.stringify(r)),r.error.code||-1){case 4001:r.error.message=`ethers-user-denied: ${r.error.message}`;break;case 4200:r.error.message=`ethers-unsupported: ${r.error.message}`;break}return super.getRpcError(n,r)}async hasSigner(n){n==null&&(n=0);const r=await this.send("eth_accounts",[]);return typeof n=="number"?r.length>n:(n=n.toLowerCase(),r.filter(s=>s.toLowerCase()===n).length!==0)}async getSigner(n){if(n==null&&(n=0),!await this.hasSigner(n))try{await k(this,Zm).call(this,"eth_requestAccounts",[])}catch(r){const s=r.payload;throw this.getRpcError(s,{id:s.id,error:r})}return await super.getSigner(n)}static async discover(n){if(n==null&&(n={}),n.provider)return new eh(n.provider);const r=n.window?n.window:typeof window<"u"?window:null;if(r==null)return null;const s=n.anyProvider;if(s&&r.ethereum)return new eh(r.ethereum);if(!("addEventListener"in r&&"dispatchEvent"in r&&"removeEventListener"in r))return null;const i=n.timeout?n.timeout:300;return i===0?null:await new Promise((o,a)=>{let l=[];const d=f=>{l.push(f.detail),s&&u()},u=()=>{if(clearTimeout(h),l.length)if(n&&n.filter){const f=n.filter(l.map(p=>Object.assign({},p.info)));if(f==null)o(null);else if(f instanceof eh)o(f);else{let p=null;if(f.uuid&&(p=l.filter(g=>f.uuid===g.info.uuid)[0]),p){const{provider:m,info:g}=p;o(new eh(m,void 0,{providerInfo:g}))}else a(Bn("filter returned unknown info","UNSUPPORTED_OPERATION",{value:f}))}}else{const{provider:f,info:p}=l[0];o(new eh(f,void 0,{providerInfo:p}))}else o(null);r.removeEventListener("eip6963:announceProvider",d)},h=setTimeout(()=>{u()},i);r.addEventListener("eip6963:announceProvider",d),r.dispatchEvent(new Event("eip6963:requestProvider"))})}};Zm=new WeakMap,Xm=new WeakMap;let Dr=eh;const vi=[{inputs:[{internalType:"address",name:"_admin",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"oldAdmin",type:"address"},{indexed:!1,internalType:"address",name:"newAdmin",type:"address"}],name:"AdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"receiver",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"AdminDecision",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"by",type:"address"},{indexed:!1,internalType:"string",name:"evidenceCid",type:"string"}],name:"AppealFiled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"appealStartAt",type:"uint256"},{indexed:!1,internalType:"uint256",name:"appealDeadline",type:"uint256"}],name:"AppealWindowOpened",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"locker",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"totalLocked",type:"uint256"},{indexed:!1,internalType:"bool",name:"isNative",type:"bool"}],name:"FundsLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bool",name:"allowed",type:"bool"}],name:"NativeAllowed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Redeemed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"seller",type:"address"}],name:"SellerConfirmed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"bool",name:"allowed",type:"bool"}],name:"TokenAllowed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"}],name:"TradeCompleted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tradeId",type:"uint256"},{indexed:!0,internalType:"address",name:"seller",type:"address"},{indexed:!0,internalType:"address",name:"buyer",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"TradeCreated",type:"event"},{stateMutability:"payable",type:"fallback"},{inputs:[],name:"APPEAL_DEADLINE_WINDOW",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"APPEAL_OPEN_DELAY",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"BPS_DENOM",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"BUYER_FEE_BPS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SELLER_EXTRA_BPS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"TOTAL_ADMIN_BPS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"admin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"},{internalType:"bool",name:"releaseToBuyer",type:"bool"}],name:"adminDecision",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"allowedNative",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"allowedTokens",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"autoOpenAppealWindow",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"confirmReceived",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"},{internalType:"address",name:"_buyer",type:"address"}],name:"createTrade",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"evidenceCIDs",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"},{internalType:"string",name:"_evidenceCid",type:"string"}],name:"fileAppeal",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"},{internalType:"uint256",name:"index",type:"uint256"}],name:"getEvidenceAt",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"getEvidenceCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"lockFunds",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"lockFundsNative",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"},{internalType:"address",name:"_to",type:"address"}],name:"recoverTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tradeId",type:"uint256"}],name:"redeemAfterAppealWindow",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_newAdmin",type:"address"}],name:"setAdmin",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_allowed",type:"bool"}],name:"setAllowedNative",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_token",type:"address"},{internalType:"bool",name:"_allowed",type:"bool"}],name:"setAllowedToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"tradeCounter",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"trades",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"address",name:"buyer",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"enum P2PEscrowV2.Status",name:"status",type:"uint8"},{internalType:"uint256",name:"lockedAt",type:"uint256"},{internalType:"uint256",name:"appealStartAt",type:"uint256"},{internalType:"bool",name:"sellerConfirmed",type:"bool"},{internalType:"bool",name:"appealFiled",type:"bool"},{internalType:"bool",name:"isNativeLocked",type:"bool"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],Di=56,On="0x02ADD84281025BeeB807f5b94Ea947599146ca00",hh={BNB:{symbol:"BNB",address:"0x0000000000000000000000000000000000000000",decimals:18,isNative:!0},WBNB:{symbol:"WBNB",address:"0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c",decimals:18,isNative:!1},USDT:{symbol:"USDT",address:"0x55d398326f99059fF775485246999027B3197955",decimals:18,isNative:!1},USDC:{symbol:"USDC",address:"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d",decimals:18,isNative:!1},BUSD:{symbol:"BUSD",address:"0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56",decimals:18,isNative:!1},CAKE:{symbol:"CAKE",address:"0x0E09FaBB73Bd3Ade0a17ECC321fD13a19e81cE82",decimals:18,isNative:!1}},Cw="https://bsc-dataseed.binance.org/",gre={chainId:"0x38",chainName:"BSC Mainnet",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:[Cw],blockExplorerUrls:["https://bscscan.com"]},z8=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],type:"function"}],H8={56:{name:"BSC Mainnet",rpcUrl:"https://bsc-dataseed.binance.org/",blockExplorerUrl:"https://bscscan.com"}},TO=Object.freeze(Object.defineProperty({__proto__:null,BSC_MAINNET_CHAIN_ID:Di,BSC_MAINNET_PARAMS:gre,BSC_MAINNET_RPC:Cw,ERC20_ABI:z8,NETWORKS:H8,TOKENS:hh,ZOTRUST_CONTRACT_ABI:vi,ZOTRUST_CONTRACT_ADDRESS:On},Symbol.toStringTag,{value:"Module"})),_O=()=>localStorage.getItem("authToken"),yre=t=>{localStorage.setItem("authToken",t)},ss=CI((t,e)=>({user:null,agents:[],locations:[],isLoading:!1,setUser:n=>{t({user:n})},updateProfile:async n=>{try{const r=_O();if(!r)return console.warn("No auth token found - user needs to login first"),alert("Please connect your wallet and login first before updating your profile."),!1;const s=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({name:n.name,phone:n.phone,location_id:n.locationId,selected_agent_ids:n.selectedAgentIds})});if(s.ok){if((await s.json()).success){const o=e().user;return o&&t({user:{...o,name:n.name,phone:n.phone,locationId:n.locationId,selectedAgentIds:n.selectedAgentIds}}),!0}}else{const i=await s.json();console.error("Profile update failed:",i.error),alert(`Failed to update profile: ${i.error||"Unknown error"}`)}return!1}catch(r){return console.error("Profile update error:",r),alert("Failed to update profile. Please try again."),!1}},fetchAgents:async n=>{try{const r=n?`/api/agents?location_id=${encodeURIComponent(n)}`:"/api/agents",s=await fetch(r);if(s.ok){const i=await s.json();if(i.success){const o=i.data.map(a=>({id:a.id,branchName:a.branch_name,mobile:a.mobile,address:a.address||"",locationId:a.location_id,locationName:a.location_name||"Unknown Location",verified:a.verified,createdByAdmin:a.created_by_admin,createdAt:a.created_at}));t({agents:o})}else console.error("Failed to fetch agents:",i.error),t({agents:[]})}else console.error("Failed to fetch agents"),t({agents:[]})}catch(r){console.error("Failed to fetch agents:",r),t({agents:[]})}},fetchLocations:async()=>{try{const n=await fetch("/api/locations");if(n.ok){const r=await n.json();r.success?t({locations:r.data}):(console.error("Failed to fetch locations:",r.error),t({locations:[]}))}else console.error("Failed to fetch locations"),t({locations:[]})}catch(n){console.error("Failed to fetch locations:",n),t({locations:[]})}},fetchUserProfile:async n=>{t({isLoading:!0});try{const r=_O(),s=await fetch(`/api/auth/user-by-address?address=${encodeURIComponent(n)}`,{method:"GET",headers:r?{Authorization:`Bearer ${r}`}:{}});if(s.ok){const i=await s.json();if(i.success&&i.data){const o=i.data,a={id:String(o.id??""),address:o.address,name:o.name??void 0,phone:o.phone??void 0,locationId:o.location_id??void 0,selectedAgentIds:o.selected_agent_ids?o.selected_agent_ids.map(String):[],verified:!!o.verified,verifiedAt:o.verified_at??void 0,createdAt:o.created_at??new Date().toISOString()};t({user:a});return}}if(!r){const i={id:Date.now().toString(),address:n,verified:!1,createdAt:new Date().toISOString()};t({user:i})}}catch(r){console.error("Failed to fetch user profile:",r)}finally{t({isLoading:!1})}},loginWithWallet:async(n,r,s)=>{try{const i=await fetch("/api/auth/wallet-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:n,signature:r,message:s})});if(i.ok){const o=await i.json();if(o.success&&o.data.token)return yre(o.data.token),await e().fetchUserProfile(n),!0}return!1}catch(i){return console.error("Login error:",i),!1}},refreshUserProfile:async()=>{const n=e().user;n!=null&&n.address&&(console.log(" Refreshing user profile after verification..."),await e().fetchUserProfile(n.address))}})),wre=Symbol(),kO=Object.getPrototypeOf,PT=new WeakMap,xre=t=>t&&(PT.has(t)?PT.get(t):kO(t)===Object.prototype||kO(t)===Array.prototype),bre=t=>xre(t)&&t[wre]||null,IO=(t,e=!0)=>{PT.set(t,e)},mE={},zI=t=>typeof t=="object"&&t!==null,vre=t=>zI(t)&&!Zx.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),V8=(t,e)=>{const n=OT.get(t);if((n==null?void 0:n[0])===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return IO(r,!0),OT.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(Zx.has(i))IO(i,!1);else if(ou.has(i)){const[l,d]=ou.get(i);a.value=V8(l,d())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},Ere=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const l=!t()&&Reflect.has(s,i),d=Reflect.get(s,i,a);if(l&&(RO(d,o)||Nw.has(o)&&RO(d,Nw.get(o))))return!0;n(i),zI(o)&&(o=bre(o)||o);const u=!ou.has(o)&&Nre(o)?Mn(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,d]),!0}}),ou=new WeakMap,Zx=new WeakSet,OT=new WeakMap,i1=[1],Nw=new WeakMap;let RO=Object.is,Cre=(t,e)=>new Proxy(t,e),Nre=vre,Are=V8,Sre=Ere;function Mn(t={}){if(!zI(t))throw new Error("object required");const e=Nw.get(t);if(e)return e;let n=i1[0];const r=new Set,s=(w,b=++i1[0])=>{n!==b&&(i=n=b,r.forEach(y=>y(w,b)))};let i=n;const o=(w=i1[0])=>(i!==w&&(i=w,l.forEach(([b])=>{const y=b[1](w);y>n&&(n=y)})),n),a=w=>(b,y)=>{const x=[...b];x[1]=[w,...x[1]],s(x,y)},l=new Map,d=(w,b)=>{const y=!Zx.has(b)&&ou.get(b);if(y){if((mE?"production":void 0)!=="production"&&l.has(w))throw new Error("prop listener already exists");if(r.size){const x=y[2](a(w));l.set(w,[y,x])}else l.set(w,[y])}},u=w=>{var b;const y=l.get(w);y&&(l.delete(w),(b=y[1])==null||b.call(y))},h=w=>(r.add(w),r.size===1&&l.forEach(([y,x],v)=>{if((mE?"production":void 0)!=="production"&&x)throw new Error("remove already exists");const E=y[2](a(v));l.set(v,[y,E])}),()=>{r.delete(w),r.size===0&&l.forEach(([y,x],v)=>{x&&(x(),l.set(v,[y]))})});let f=!0;const p=Sre(()=>f,d,u,s),m=Cre(t,p);Nw.set(t,m);const g=[t,o,h];return ou.set(m,g),Reflect.ownKeys(t).forEach(w=>{const b=Object.getOwnPropertyDescriptor(t,w);"value"in b&&b.writable&&(m[w]=t[w])}),f=!1,m}function cs(t,e,n){const r=ou.get(t);(mE?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const d=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,d()}}function Aw(t){const e=ou.get(t);(mE?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return Are(n,r())}function Cg(t){return Zx.add(t),t}function Tre(){return{proxyStateMap:ou,refSet:Zx,snapCache:OT,versionHolder:i1,proxyCache:Nw}}function ls(t,e,n,r){let s=t[e];return cs(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:_re,snapCache:kre}=Tre(),Qb=t=>_re.has(t);function Ire(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const d=kre.get(a),u=d==null?void 0:d[1];if(u&&!s.has(u)){const h=new Map(r);s.set(u,h)}},o=d=>s.get(d)||r,a={data:e,index:n,epoch:0,get size(){return Qb(this)||i(),o(this).size},get(d){const h=o(this).get(d);if(h===void 0){this.epoch;return}return this.data[h]},has(d){const u=o(this);return this.epoch,u.has(d)},set(d,u){if(!Qb(this))throw new Error("Cannot perform mutations on a snapshot");const h=r.get(d);return h===void 0?(r.set(d,this.index),this.data[this.index++]=u):this.data[h]=u,this.epoch++,this},delete(d){if(!Qb(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(d);return u===void 0?!1:(delete this.data[u],r.delete(d),this.epoch++,!0)},clear(){if(!Qb(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(d){this.epoch,o(this).forEach((h,f)=>{d(this.data[h],f,this)})},*entries(){this.epoch;const d=o(this);for(const[u,h]of d)yield[u,this.data[h]]},*keys(){this.epoch;const d=o(this);for(const u of d.keys())yield u},*values(){this.epoch;const d=o(this);for(const u of d.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},l=Mn(a);return Object.defineProperties(l,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(l),l}var jO={};const ne={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof jO<"u"?jO.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}},IS_DEVELOPMENT:typeof process<"u"&&!1},W8={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return(t==null?void 0:t.filter(n=>n.chainNamespace===e))||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){var s;if(!e)return;const n=t.find(i=>i.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return((s=ne.CHAIN_NAME_MAP)==null?void 0:s[r])||void 0}},q8=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var Rre=20,jre=1,ff=1e6,PO=1e6,Pre=-7,Ore=21,Dre=!1,Xx="[big.js] ",If=Xx+"Invalid ",YC=If+"decimal places",Mre=If+"rounding mode",K8=Xx+"Division by zero",xn={},yc=void 0,Ure=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function G8(){function t(e){var n=this;if(!(n instanceof t))return e===yc?G8():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(If+"value");e=e===0&&1/e<0?"-0":String(e)}Lre(n,e)}n.constructor=t}return t.prototype=xn,t.DP=Rre,t.RM=jre,t.NE=Pre,t.PE=Ore,t.strict=Dre,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function Lre(t,e){var n,r,s;if(!Ure.test(e))throw Error(If+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function Rf(t,e,n,r){var s=t.c;if(n===yc&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(Mre);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==yc))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==yc||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function jf(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}xn.abs=function(){var t=new this.constructor(this);return t.s=1,t};xn.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,l=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=l)return a>l^e?1:-1;for(o=(a=r.length)<(l=s.length)?a:l,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==l?0:a>l^e?1:-1};xn.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>ff)throw Error(YC);if(!s[0])throw Error(K8);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,l,d,u,h,f=s.slice(),p=a=s.length,m=r.length,g=r.slice(0,a),w=g.length,b=t,y=b.c=[],x=0,v=o+(b.e=e.e-t.e)+1;for(b.s=i,i=v<0?0:v,f.unshift(0);w++<a;)g.push(0);do{for(d=0;d<10;d++){if(a!=(w=g.length))u=a>w?1:-1;else for(h=-1,u=0;++h<a;)if(s[h]!=g[h]){u=s[h]>g[h]?1:-1;break}if(u<0){for(l=w==a?s:f;w;){if(g[--w]<l[w]){for(h=w;h&&!g[--h];)g[h]=9;--g[h],g[w]+=10}g[w]-=l[w]}for(;!g[0];)g.shift()}else break}y[x++]=u?d:++d,g[0]&&u?g[w]=r[p]||0:g=[r[p]]}while((p++<m||g[0]!==yc)&&i--);return!y[0]&&x!=1&&(y.shift(),b.e--,v--),x>v&&Rf(b,v,n.RM,g[0]!==yc),b};xn.eq=function(t){return this.cmp(t)===0};xn.gt=function(t){return this.cmp(t)>0};xn.gte=function(t){return this.cmp(t)>-1};xn.lt=function(t){return this.cmp(t)<0};xn.lte=function(t){return this.cmp(t)<1};xn.minus=xn.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,l=(t=new o(t)).s;if(a!=l)return t.s=-l,i.plus(t);var d=i.c.slice(),u=i.e,h=t.c,f=t.e;if(!d[0]||!h[0])return h[0]?t.s=-l:d[0]?t=new o(i):t.s=1,t;if(a=u-f){for((s=a<0)?(a=-a,r=d):(f=u,r=h),r.reverse(),l=a;l--;)r.push(0);r.reverse()}else for(n=((s=d.length<h.length)?d:h).length,a=l=0;l<n;l++)if(d[l]!=h[l]){s=d[l]<h[l];break}if(s&&(r=d,d=h,h=r,t.s=-t.s),(l=(n=h.length)-(e=d.length))>0)for(;l--;)d[e++]=0;for(l=e;n>a;){if(d[--n]<h[n]){for(e=n;e&&!d[--e];)d[e]=9;--d[e],d[n]+=10}d[n]-=h[n]}for(;d[--l]===0;)d.pop();for(;d[0]===0;)d.shift(),--f;return d[0]||(t.s=1,d=[f=0]),t.c=d,t.e=f,t};xn.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(K8);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};xn.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};xn.plus=xn.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,l=t.e,d=t.c;if(!a[0]||!d[0])return d[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-l){for(e>0?(l=o,r=d):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-d.length<0&&(r=d,d=a,a=r),e=d.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+d[e]+n)/10|0;for(n&&(a.unshift(n),++l),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=l,t};xn.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-PO||t>PO)throw Error(If+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};xn.prec=function(t,e){if(t!==~~t||t<1||t>ff)throw Error(If+"precision");return Rf(new this.constructor(this),t,e)};xn.round=function(t,e){if(t===yc)t=0;else if(t!==~~t||t<-ff||t>ff)throw Error(YC);return Rf(new this.constructor(this),t+this.e+1,e)};xn.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(Xx+"No square root");i=Math.sqrt(+jf(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return Rf(t,(s.DP-=4)+t.e+1,s.RM)};xn.times=xn.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,l=n.e,d=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=l+d,o<a&&(e=s,s=i,i=e,d=o,o=a,a=d),e=new Array(d=o+a);d--;)e[d]=0;for(l=a;l--;){for(a=0,d=o+l;d>l;)a=e[d]+i[l]*s[d-l-1]+a,e[d--]=a%10,a=a/10|0;e[d]=a}for(a?++t.e:e.shift(),l=e.length;!e[--l];)e.pop();return t.c=e,t};xn.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==yc){if(t!==~~t||t<0||t>ff)throw Error(YC);for(n=Rf(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return jf(n,!0,!!r)};xn.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==yc){if(t!==~~t||t<0||t>ff)throw Error(YC);for(n=Rf(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return jf(n,!1,!!r)};xn[Symbol.for("nodejs.util.inspect.custom")]=xn.toJSON=xn.toString=function(){var t=this,e=t.constructor;return jf(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};xn.toNumber=function(){var t=+jf(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Xx+"Imprecise conversion");return t};xn.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==yc){if(t!==~~t||t<1||t>ff)throw Error(If+"precision");for(n=Rf(new r(n),t,e);n.c.length<t;)n.c.push(0)}return jf(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};xn.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Xx+"valueOf disallowed");return jf(t,t.e<=e.NE||t.e>=e.PE,!0)};var zl=G8();const Bre={bigNumber(t){return t?new zl(t):new zl(0)},multiply(t,e){if(t===void 0||e===void 0)return new zl(0);const n=new zl(t),r=new zl(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new zl(0).toFixed(e):new zl(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new zl(e).toNumber()}},$re=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],Fre=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],zre=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],Hre={getERC20Abi:t=>ne.USDT_CONTRACT_ADDRESSES.includes(t)?zre:$re,getSwapAbi:()=>Fre},Rr={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},pl={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.message=="string",r=typeof e.code=="number";return n&&r}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){return pl.isRpcProviderError(t)?t.code===pl.RPC_ERROR_CODE.USER_REJECTED_REQUEST||pl.isUserRejectedMessage(t.message):t instanceof Error?pl.isUserRejectedMessage(t.message):!1}};let Vre=class extends Error{constructor(e,n){super(n.message,{cause:e}),this.name=pl.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=n.code}},HI=class extends Vre{constructor(e){super(e,{code:pl.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=pl.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}};const lt={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version"};function TA(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const rt={setItem(t,e){iy()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(iy())return localStorage.getItem(t)||void 0},removeItem(t){iy()&&localStorage.removeItem(t)},clear(){iy()&&localStorage.clear()}};function iy(){return typeof window<"u"&&typeof localStorage<"u"}function Sw(t,e){return e==="light"?{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var OO={};const _A=(typeof process<"u"&&typeof OO<"u"?OO.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",Y8=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],Wre="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Vt={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:_A,SECURE_SITE_DASHBOARD:`${_A}/dashboard`,SECURE_SITE_FAVICON:`${_A}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[ne.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[ne.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[ne.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[ne.CHAIN.EVM,ne.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},ye={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=ye.getActiveNamespace(),e=ye.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{rt.setItem(lt.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=rt.getItem(lt.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{rt.removeItem(lt.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{rt.setItem(lt.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{rt.setItem(lt.ACTIVE_CAIP_NETWORK_ID,t),ye.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return rt.getItem(lt.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{rt.removeItem(lt.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=TA(t);rt.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=ye.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),rt.setItem(lt.RECENT_WALLETS,JSON.stringify(e)),rt.setItem(lt.RECENT_WALLET,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=rt.getItem(lt.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},getRecentWallet(){try{const t=rt.getItem(lt.RECENT_WALLET);return t?JSON.parse(t):null}catch{console.info("Unable to get AppKit recent")}return null},deleteRecentWallet(){try{rt.removeItem(lt.RECENT_WALLET)}catch{console.info("Unable to delete AppKit recent")}},setConnectedConnectorId(t,e){try{const n=TA(t);rt.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return rt.getItem(lt.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=TA(t);return rt.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{rt.setItem(lt.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return rt.getItem(lt.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{rt.removeItem(lt.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return rt.getItem(lt.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var n;const t=rt.getItem(lt.ACTIVE_CAIP_NETWORK_ID);return(n=t==null?void 0:t.split(":"))==null?void 0:n[1]},setConnectionStatus(t){try{rt.setItem(lt.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return rt.getItem(lt.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=rt.getItem(lt.CONNECTED_NAMESPACES);return t!=null&&t.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));rt.setItem(lt.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=ye.getConnectedNamespaces();e.includes(t)||(e.push(t),ye.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=ye.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),ye.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return rt.getItem(lt.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{rt.setItem(lt.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{rt.removeItem(lt.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=rt.getItem(lt.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=ye.getBalanceCache();rt.setItem(lt.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=ye.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;ye.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=ye.getBalanceCache();e[t.caipAddress]=t,rt.setItem(lt.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=rt.getItem(lt.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=ye.getBalanceCache();rt.setItem(lt.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=ye.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),ye.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=ye.getNativeBalanceCache();e[t.caipAddress]=t,rt.setItem(lt.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=rt.getItem(lt.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=ye.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;ye.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=ye.getEnsCache();e[t.address]=t,rt.setItem(lt.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=ye.getEnsCache();rt.setItem(lt.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=rt.getItem(lt.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=ye.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;ye.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=ye.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},rt.setItem(lt.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=ye.getIdentityCache();rt.setItem(lt.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{rt.removeItem(lt.PORTFOLIO_CACHE),rt.removeItem(lt.NATIVE_BALANCE_CACHE),rt.removeItem(lt.ENS_CACHE),rt.removeItem(lt.IDENTITY_CACHE),rt.removeItem(lt.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{rt.setItem(lt.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=rt.getItem(lt.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=ye.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),l=o.connectorId===ne.CONNECTOR_ID.AUTH;if(a&&!l){const d=new Set(a.accounts.map(h=>h.address.toLowerCase())),u=o.accounts.filter(h=>!d.has(h.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};rt.setItem(lt.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=rt.getItem(lt.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=ye.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(l=>l.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(l=>l.address.toLowerCase()!==e.toLowerCase())})),rt.setItem(lt.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=rt.getItem(lt.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=ye.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),rt.setItem(lt.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=ye.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),rt.setItem(lt.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(ye.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=rt.getItem(lt.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){var n;try{const s=(n=ye.getTransactionsCache()[t])==null?void 0:n[e];if(s&&!this.isCacheExpired(s.timestamp,this.cacheExpiry.transactionsHistory))return s.transactions;ye.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=ye.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},rt.setItem(lt.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:n,transactions:r})}},removeTransactionsCache({address:t,chainId:e}){try{const n=ye.getTransactionsCache(),r=(n==null?void 0:n[t])||{},{[e]:s,...i}=r;rt.setItem(lt.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=rt.getItem(lt.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const n=ye.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;ye.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=ye.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},rt.setItem(lt.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=ye.getTokenPriceCache();rt.setItem(lt.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t==null?void 0:t.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{console.info("Unable to get latest AppKit version")}},getLatestAppKitVersionCache(){try{const t=rt.getItem(lt.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{console.info("Unable to get latest AppKit version cache")}return{}},updateLatestAppKitVersion(t){try{const e=ye.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,rt.setItem(lt.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{console.info("Unable to update latest AppKit version on local storage",t)}}},Le={isMobile(){var t;return this.isClient()?!!(window!=null&&window.matchMedia&&typeof window.matchMedia=="function"&&((t=window.matchMedia("(pointer:coarse)"))!=null&&t.matches)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t==null?void 0:t.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return Le.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Vt.TEN_SEC_MS:!0},isAllowedRetry(t,e=Vt.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},isSafeApp(){var t,e;if(Le.isClient()&&window.self!==window.top)try{const n=(e=(t=window==null?void 0:window.location)==null?void 0:t.ancestorOrigins)==null?void 0:e[0],r="https://app.safe.global";if(n){const s=new URL(n),i=new URL(r);return s.hostname===i.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Vt.FOUR_MINUTES_MS},getNetworkId(t){return t==null?void 0:t.split(":")[1]},getPlainAddress(t){return t==null?void 0:t.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(Le.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r&&(r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`)),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!Le.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?ye.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window==null||window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window==null?void 0:window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var n,r;if(typeof window>"u")return!1;const t=window!=null&&window.matchMedia&&typeof window.matchMedia=="function"?(n=window.matchMedia("(display-mode: standalone)"))==null?void 0:n.matches:!1,e=(r=window==null?void 0:window.navigator)==null?void 0:r.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,Le.wait(2e3)])},parseBalance(t,e){let n="0.000";if(typeof t=="string"){const l=Number(t);if(!isNaN(l)){const d=(Math.floor(l*1e3)/1e3).toFixed(3);d&&(n=d)}}const[r,s]=n.split("."),i=r||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return ne.W3M_API_URL},getBlockchainApiUrl(){return ne.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return ne.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){var e,n;return typeof t=="string"?t:typeof((n=(e=t==null?void 0:t.issues)==null?void 0:e[0])==null?void 0:n.message)=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?Vt.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in ne.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),l=t.substring(r+i,o),d=t.substring(s),u=l+n;return a+u+d}};function qre(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function DO(t){return qre(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const Q8="2.37.12";let S0={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${Q8}`},Un=class DT extends Error{constructor(e,n={}){var a;const r=(()=>{var l;return n.cause instanceof DT?n.cause.details:(l=n.cause)!=null&&l.message?n.cause.message:n.details})(),s=n.cause instanceof DT&&n.cause.docsPath||n.docsPath,i=(a=S0.getDocsUrl)==null?void 0:a.call(S0,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...S0.version?[`Version: ${S0.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=Q8}walk(e){return J8(this,e)}};function J8(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?J8(t.cause,e):e?null:t}class JIe extends Un{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}}let Z8=class extends Un{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class XIe extends Un{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function VI(t,{dir:e,size:n=32}={}){return typeof t=="string"?Kre(t,{dir:e,size:n}):Gre(t,{dir:e,size:n})}function Kre(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new Z8({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function Gre(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new Z8({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let Yre=class extends Un{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}};class tRe extends Un{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class Qre extends Un{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let Jre=class extends Un{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function kA(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function QC(t,{size:e}){if(DO(t)>e)throw new Jre({givenSize:DO(t),maxSize:e})}function Zre(t,e={}){const{signed:n}=e;e.size&&QC(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function rRe(t,e={}){let n=t;if(e.size&&(QC(n,{size:e.size}),n=kA(n)),kA(n)==="0x00")return!1;if(kA(n)==="0x01")return!0;throw new Qre(n)}function sRe(t,e={}){return Number(Zre(t,e))}const Xre=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function MO(t,e={}){return typeof t=="number"||typeof t=="bigint"?tse(t,e):typeof t=="string"?eF(t,e):typeof t=="boolean"?ese(t,e):X8(t,e)}function ese(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(QC(n,{size:e.size}),VI(n,{size:e.size})):n}function X8(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=Xre[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(QC(r,{size:e.size}),VI(r,{dir:"right",size:e.size})):r}function tse(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new Yre({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?VI(a,{size:r}):a}const nse=new TextEncoder;function eF(t,e={}){const n=nse.encode(t);return X8(n,e)}let rse=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const Kh=(t,e,n)=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString():s,n),oRe={gwei:9,wei:18},sse={ether:-9,wei:9};function WI(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function gE(t,e="wei"){return WI(t,sse[e])}const aRe=t=>t,qI=t=>t;class Ey extends Un{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${qI(o)}`,e&&`Request body: ${Kh(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class tF extends Un{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${qI(r)}`,`Request body: ${Kh(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}class UO extends Un{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${qI(n)}`,`Request body: ${Kh(e)}`],name:"TimeoutError"})}}const ise=-1;class Ii extends Un{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof tF?e.code:n??ise}}class no extends Ii{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class Tw extends Ii{constructor(e){super(e,{code:Tw.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Tw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class _w extends Ii{constructor(e){super(e,{code:_w.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(_w,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class kw extends Ii{constructor(e,{method:n}={}){super(e,{code:kw.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(kw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Iw extends Ii{constructor(e){super(e,{code:Iw.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Iw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Ng extends Ii{constructor(e){super(e,{code:Ng.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(Ng,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Rw extends Ii{constructor(e){super(e,{code:Rw.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Rw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class jw extends Ii{constructor(e){super(e,{code:jw.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(jw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Pw extends Ii{constructor(e){super(e,{code:Pw.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Pw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Ag extends Ii{constructor(e){super(e,{code:Ag.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Ag,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class fh extends Ii{constructor(e,{method:n}={}){super(e,{code:fh.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(fh,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Sg extends Ii{constructor(e){super(e,{code:Sg.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Sg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Ow extends Ii{constructor(e){super(e,{code:Ow.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Ow,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Gh extends no{constructor(e){super(e,{code:Gh.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Gh,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class Dw extends no{constructor(e){super(e,{code:Dw.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(Dw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Mw extends no{constructor(e,{method:n}={}){super(e,{code:Mw.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(Mw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Uw extends no{constructor(e){super(e,{code:Uw.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Uw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Lw extends no{constructor(e){super(e,{code:Lw.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Lw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Bw extends no{constructor(e){super(e,{code:Bw.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Bw,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class $w extends no{constructor(e){super(e,{code:$w.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty($w,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Fw extends no{constructor(e){super(e,{code:Fw.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Fw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class zw extends no{constructor(e){super(e,{code:zw.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(zw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Hw extends no{constructor(e){super(e,{code:Hw.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(Hw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Vw extends no{constructor(e){super(e,{code:Vw.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Vw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Ww extends no{constructor(e){super(e,{code:Ww.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(Ww,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class qw extends no{constructor(e){super(e,{code:qw.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(qw,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class ose extends Ii{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class KI extends Un{constructor({cause:e,message:n}={}){var s;const r=(s=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(KI,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(KI,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class ase extends Un{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${gE(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(ase,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class cse extends Un{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${gE(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(cse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class lse extends Un{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(lse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class dse extends Un{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(dse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class use extends Un{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(use,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class hse extends Un{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(hse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class fse extends Un{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(fse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class pse extends Un{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(pse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class mse extends Un{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(mse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class gse extends Un{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${gE(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${gE(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(gse,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class cRe extends Un{constructor({cause:e}){super(`An error occurred while executing: ${e==null?void 0:e.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}const lRe=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockTimestamp",outputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],stateMutability:"view",type:"function"}],dRe=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],nF=[{inputs:[{name:"dns",type:"bytes"}],name:"DNSDecodingFailed",type:"error"},{inputs:[{name:"ens",type:"string"}],name:"DNSEncodingFailed",type:"error"},{inputs:[],name:"EmptyAddress",type:"error"},{inputs:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"HttpError",type:"error"},{inputs:[],name:"InvalidBatchGatewayResponse",type:"error"},{inputs:[{name:"errorData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{name:"name",type:"bytes"},{name:"resolver",type:"address"}],name:"ResolverNotContract",type:"error"},{inputs:[{name:"name",type:"bytes"}],name:"ResolverNotFound",type:"error"},{inputs:[{name:"primary",type:"string"},{name:"primaryAddress",type:"bytes"}],name:"ReverseAddressMismatch",type:"error"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"UnsupportedResolverProfile",type:"error"}],uRe=[...nF,{name:"resolveWithGateways",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],hRe=[...nF,{name:"reverseWithGateways",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"uint256",name:"coinType"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolver"},{type:"address",name:"reverseResolver"}]}],fRe=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],pRe=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],mRe=[{name:"isValidSignature",type:"function",stateMutability:"view",inputs:[{name:"hash",type:"bytes32"},{name:"signature",type:"bytes"}],outputs:[{name:"",type:"bytes4"}]}],gRe=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],Jb=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}];function yse(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const IA=new Map;function wse({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=l();o();const h=u.map(({args:f})=>f);h.length!==0&&t(h).then(f=>{s&&Array.isArray(f)&&f.sort(s);for(let p=0;p<u.length;p++){const{resolve:m}=u[p];m==null||m([f[p],f])}}).catch(f=>{for(let p=0;p<u.length;p++){const{reject:m}=u[p];m==null||m(f)}})},o=()=>IA.delete(e),a=()=>l().map(({args:u})=>u),l=()=>IA.get(e)||[],d=u=>IA.set(e,[...l(),u]);return{flush:o,async schedule(u){const{promise:h,resolve:f,reject:p}=yse();return(n==null?void 0:n([...a(),u]))&&i(),l().length>0?(d({args:u,resolve:f,reject:p}),h):(d({args:u,resolve:f,reject:p}),setTimeout(i,r),h)}}}async function rF(t){return new Promise(e=>setTimeout(e,t))}function xse(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const l=async({error:d})=>{const u=typeof e=="function"?e({count:a,error:d}):e;u&&await rF(u),o({count:a+1})};try{const d=await t();s(d)}catch(d){if(a<n&&await r({count:a,error:d}))return l({error:d});i(d)}};o()})}const MT=256;let Zb=MT,Xb;function bse(t=11){if(!Xb||Zb+t>MT*2){Xb="",Zb=0;for(let e=0;e<MT;e++)Xb+=(256+Math.random()*256|0).toString(16).substring(1)}return Xb.substring(Zb,Zb+++t)}const ev=new rse(8192);function vse(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(ev.get(n))return ev.get(n);const r=t().finally(()=>ev.delete(n));return ev.set(n,r),r}function Ese(t,e={}){return async(n,r={})=>{var h;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:l}={...e,...r},{method:d}=n;if((h=i==null?void 0:i.exclude)!=null&&h.includes(d))throw new fh(new Error("method not supported"),{method:d});if(i!=null&&i.include&&!i.include.includes(d))throw new fh(new Error("method not supported"),{method:d});const u=s?eF(`${l}.${Kh(n)}`):void 0;return vse(()=>xse(async()=>{try{return await t(n)}catch(f){const p=f;switch(p.code){case Tw.code:throw new Tw(p);case _w.code:throw new _w(p);case kw.code:throw new kw(p,{method:n.method});case Iw.code:throw new Iw(p);case Ng.code:throw new Ng(p);case Rw.code:throw new Rw(p);case jw.code:throw new jw(p);case Pw.code:throw new Pw(p);case Ag.code:throw new Ag(p);case fh.code:throw new fh(p,{method:n.method});case Sg.code:throw new Sg(p);case Ow.code:throw new Ow(p);case Gh.code:throw new Gh(p);case Dw.code:throw new Dw(p);case Mw.code:throw new Mw(p);case Uw.code:throw new Uw(p);case Lw.code:throw new Lw(p);case Bw.code:throw new Bw(p);case $w.code:throw new $w(p);case Fw.code:throw new Fw(p);case zw.code:throw new zw(p);case Hw.code:throw new Hw(p);case Vw.code:throw new Vw(p);case Ww.code:throw new Ww(p);case qw.code:throw new qw(p);case 5e3:throw new Gh(p);default:throw f instanceof Un?f:new ose(p)}}},{delay:({count:f,error:p})=>{var m;if(p&&p instanceof Ey){const g=(m=p==null?void 0:p.headers)==null?void 0:m.get("Retry-After");if(g!=null&&g.match(/\d/))return Number.parseInt(g,10)*1e3}return~~(1<<f)*o},retryCount:a,shouldRetry:({error:f})=>Cse(f)}),{enabled:s,id:u})}}function Cse(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===Sg.code||t.code===Ng.code:t instanceof Ey&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function Nse(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}function Ase(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r&&a.abort()},n)),s(await t({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function Sse(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const LO=Sse();function Tse(t,e={}){return{async request(n){var f;const{body:r,fetchFn:s=e.fetchFn??fetch,onRequest:i=e.onRequest,onResponse:o=e.onResponse,timeout:a=e.timeout??1e4}=n,l={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:d,method:u,signal:h}=l;try{const p=await Ase(async({signal:g})=>{const w={...l,body:Array.isArray(r)?Kh(r.map(v=>({jsonrpc:"2.0",id:v.id??LO.take(),...v}))):Kh({jsonrpc:"2.0",id:r.id??LO.take(),...r}),headers:{"Content-Type":"application/json",...d},method:u||"POST",signal:h||(a>0?g:null)},b=new Request(t,w),y=await(i==null?void 0:i(b,w))??{...w,url:t};return await s(y.url??t,y)},{errorInstance:new UO({body:r,url:t}),timeout:a,signal:!0});o&&await o(p);let m;if((f=p.headers.get("Content-Type"))!=null&&f.startsWith("application/json"))m=await p.json();else{m=await p.text();try{m=JSON.parse(m||"{}")}catch(g){if(p.ok)throw g;m={error:m}}}if(!p.ok)throw new Ey({body:r,details:Kh(m.error)||p.statusText,headers:p.headers,status:p.status,url:t});return m}catch(p){throw p instanceof Ey||p instanceof UO?p:new Ey({body:r,cause:p,url:t})}}}}function sF({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},l){const d=bse();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:Ese(r,{methods:e,retryCount:s,retryDelay:i,uid:d}),value:l}}function BO(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=_se,retryCount:o,retryDelay:a}=e;return({chain:l,pollingInterval:d=4e3,timeout:u,...h})=>{let f=t,p=()=>{};const m=sF({key:n,name:r,async request({method:g,params:w}){let b;const y=async(x=0)=>{const v=f[x]({...h,chain:l,retryCount:0,timeout:u});try{const E=await v.request({method:g,params:w});return p({method:g,params:w,response:E,transport:v,status:"success"}),E}catch(E){if(p({error:E,method:g,params:w,transport:v,status:"error"}),i(E)||x===f.length-1||(b??(b=f.slice(x+1).some(R=>{const{include:S,exclude:C}=R({chain:l}).config.methods||{};return S?S.includes(g):C?!C.includes(g):!0})),!b))throw E;return y(x+1)}};return y()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>p=g,transports:f.map(g=>g({chain:l,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};kse({chain:l,interval:g.interval??d,onTransports:w=>f=w,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:f,weights:g.weights})}return m}}function _se(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===Ag.code||t.code===Gh.code||KI.nodeMessage.test(t.message)||t.code===5e3))}function kse({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:l=.7,latency:d=.3}=a,u=[],h=async()=>{const f=await Promise.all(o.map(async g=>{const w=g({chain:t,retryCount:0,timeout:i}),b=Date.now();let y,x;try{await(r?r({transport:w}):w.request({method:"net_listening"})),x=1}catch{x=0}finally{y=Date.now()}return{latency:y-b,success:x}}));u.push(f),u.length>s&&u.shift();const p=Math.max(...u.map(g=>Math.max(...g.map(({latency:w})=>w)))),m=o.map((g,w)=>{const b=u.map(R=>R[w].latency),x=1-b.reduce((R,S)=>R+S,0)/b.length/p,v=u.map(R=>R[w].success),E=v.reduce((R,S)=>R+S,0)/v.length;return E===0?[0,w]:[d*x+l*E,w]}).sort((g,w)=>w[0]-g[0]);n(m.map(([,g])=>o[g])),await rF(e),h()};h()}class Ise extends Un{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function tv(t,e={}){const{batch:n,fetchFn:r,fetchOptions:s,key:i="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:l,onFetchResponse:d,retryDelay:u,raw:h}=e;return({chain:f,retryCount:p,timeout:m})=>{const{batchSize:g=1e3,wait:w=0}=typeof n=="object"?n:{},b=e.retryCount??p,y=m??e.timeout??1e4,x=t||(f==null?void 0:f.rpcUrls.default.http[0]);if(!x)throw new Ise;const v=Tse(x,{fetchFn:r,fetchOptions:s,onRequest:l,onResponse:d,timeout:y});return sF({key:i,methods:o,name:a,async request({method:E,params:R}){const S={method:E,params:R},{schedule:C}=wse({id:x,wait:w,shouldSplitBatch(U){return U.length>g},fn:U=>v.request({body:U}),sort:(U,H)=>U.id-H.id}),N=async U=>n?C(U):[await v.request({body:U})],[{error:T,result:$}]=await N(S);if(h)return{error:T,result:$};if(T)throw new tF({body:S,error:T,url:x});return $},retryCount:b,retryDelay:u,timeout:y,type:"http"},{fetchOptions:s,url:x})}}async function T0(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class eb{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await T0(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await T0(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}sendBeacon({body:e,...n}){const r=this.createUrl(n);return navigator.sendBeacon(r.toString(),e?JSON.stringify(e):void 0)}}const Rse={getFeatureValue(t,e){const n=e==null?void 0:e[t];return n===void 0?Vt.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(Le.isTelegram()){if(Le.isIos())return t.filter(e=>e!=="google");if(Le.isMac())return t.filter(e=>e!=="x");if(Le.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},at=Mn({features:Vt.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Vt.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1}),fe={state:at,subscribeKey(t,e){return ls(at,t,e)},setOptions(t){Object.assign(at,t)},setRemoteFeatures(t){var n,r;if(!t)return;const e={...at.remoteFeatures,...t};at.remoteFeatures=e,(n=at.remoteFeatures)!=null&&n.socials&&(at.remoteFeatures.socials=Rse.filterSocialsByPlatform(at.remoteFeatures.socials)),(r=at.features)!=null&&r.pay&&(at.remoteFeatures.email=!1,at.remoteFeatures.socials=!1)},setFeatures(t){var n;if(!t)return;at.features||(at.features=Vt.DEFAULT_FEATURES);const e={...at.features,...t};at.features=e,(n=at.features)!=null&&n.pay&&at.remoteFeatures&&(at.remoteFeatures.email=!1,at.remoteFeatures.socials=!1)},setProjectId(t){at.projectId=t},setCustomRpcUrls(t){at.customRpcUrls=t},setAllWallets(t){at.allWallets=t},setIncludeWalletIds(t){at.includeWalletIds=t},setExcludeWalletIds(t){at.excludeWalletIds=t},setFeaturedWalletIds(t){at.featuredWalletIds=t},setTokens(t){at.tokens=t},setTermsConditionsUrl(t){at.termsConditionsUrl=t},setPrivacyPolicyUrl(t){at.privacyPolicyUrl=t},setCustomWallets(t){at.customWallets=t},setIsSiweEnabled(t){at.isSiweEnabled=t},setIsUniversalProvider(t){at.isUniversalProvider=t},setSdkVersion(t){at.sdkVersion=t},setMetadata(t){at.metadata=t},setDisableAppend(t){at.disableAppend=t},setEIP6963Enabled(t){at.enableEIP6963=t},setDebug(t){at.debug=t},setEnableWalletGuide(t){at.enableWalletGuide=t},setEnableAuthLogger(t){at.enableAuthLogger=t},setEnableWallets(t){at.enableWallets=t},setPreferUniversalLinks(t){at.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(Vt.SIWX_DEFAULTS))t[e]??(t[e]=n);at.siwx=t},setConnectMethodsOrder(t){at.features={...at.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){at.features={...at.features,walletFeaturesOrder:t}},setSocialsOrder(t){at.remoteFeatures={...at.remoteFeatures,socials:t}},setCollapseWallets(t){at.features={...at.features,collapseWallets:t}},setEnableEmbedded(t){at.enableEmbedded=t},setAllowUnsupportedChain(t){at.allowUnsupportedChain=t},setManualWCControl(t){at.manualWCControl=t},setEnableNetworkSwitch(t){at.enableNetworkSwitch=t},setEnableMobileFullScreen(t){at.enableMobileFullScreen=Le.isMobile()&&t},setEnableReconnect(t){at.enableReconnect=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(at.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){at.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return at.universalProviderConfigOverride},getSnapshot(){return Aw(at)}},Fu=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),Cr=Mn({...Fu}),jse={state:Cr,subscribeKey(t,e){return ls(Cr,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=Le.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){Cr.message=Fu.message,Cr.variant=Fu.variant,Cr.svg=Fu.svg,Cr.open=Fu.open,Cr.autoClose=Fu.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=Fu.autoClose}){Cr.open?(Cr.open=!1,setTimeout(()=>{Cr.message=t,Cr.variant=n,Cr.svg=e,Cr.open=!0,Cr.autoClose=r},150)):(Cr.message=t,Cr.variant=n,Cr.svg=e,Cr.open=!0,Cr.autoClose=r)}},cc=jse,Pse={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},iF=Le.getBlockchainApiUrl(),ti=Mn({clientId:null,api:new eb({baseUrl:iF,clientId:null}),supportedChains:{http:[],ws:[]}}),gt={state:ti,async get(t){const{st:e,sv:n}=gt.getSdkProperties(),r=fe.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return ti.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=fe.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{ti.supportedChains.http.length||await gt.getSupportedNetworks()}catch{return!1}return ti.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await gt.get({path:"v1/supported-chains"});return ti.supportedChains=t,t}catch{return ti.supportedChains}},async fetchIdentity({address:t}){const e=ye.getIdentityFromCacheForAddress(t);if(e)return e;const n=await gt.get({path:`/v1/identity/${t}`,params:{sender:M.state.activeCaipAddress?Le.getPlainAddress(M.state.activeCaipAddress):void 0}});return ye.updateIdentityCache({address:t,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){var l;if(!await gt.isNetworkSupported((l=M.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return{data:[],next:void 0};const o=ye.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await gt.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return ye.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){var o;return await gt.isNetworkSupported((o=M.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?gt.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){var n;return await gt.isNetworkSupported((n=M.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?gt.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){var s;if(!await gt.isNetworkSupported((s=M.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))return{fungibles:[]};const n=ye.getTokenPriceCacheForAddresses(t);if(n)return n;const r=await ti.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:fe.state.projectId},headers:{"Content-Type":"application/json"}});return ye.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){var r;return await gt.isNetworkSupported((r=M.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?gt.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){var s;const{st:e,sv:n}=gt.getSdkProperties();if(!await gt.isNetworkSupported((s=M.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return gt.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){var o;if(!await gt.isNetworkSupported((o=M.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return ti.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Vt.CONVERT_SLIPPAGE_TOLERANCE},projectId:fe.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){var o;const{st:r,sv:s}=gt.getSdkProperties();if(!await gt.isNetworkSupported((o=M.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return gt.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){var d;const{st:r,sv:s}=gt.getSdkProperties();if(!await gt.isNetworkSupported((d=M.state.activeCaipNetwork)==null?void 0:d.caipNetworkId))return cc.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=ye.getBalanceCacheForCaipAddress(o);if(a)return a;const l=await gt.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return ye.updateBalanceCache({caipAddress:o,balance:l,timestamp:Date.now()}),l},async lookupEnsName(t){var n;return await gt.isNetworkSupported((n=M.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?gt.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){var r,s;if(!await gt.isNetworkSupported((r=M.state.activeCaipNetwork)==null?void 0:r.caipNetworkId))return[];const n=(s=M.getAccountData())==null?void 0:s.address;return gt.get({path:`/v1/profile/reverse/${t}`,params:{sender:n,apiVersion:"2"}})},async getEnsNameSuggestions(t){var n;return await gt.isNetworkSupported((n=M.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?gt.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){var i;return await gt.isNetworkSupported((i=M.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?ti.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){var a;return await gt.isNetworkSupported((a=M.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await ti.api.post({path:"/v1/generators/onrampurl",params:{projectId:fe.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await gt.isNetworkSupported((e=M.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await gt.get({path:"/v1/onramp/options"})}catch{return Pse}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){var s;try{return await gt.isNetworkSupported((s=M.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await ti.api.post({path:"/v1/onramp/quote",params:{projectId:fe.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){var n;return await gt.isNetworkSupported((n=M.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?gt.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){var s;return await gt.isNetworkSupported((s=M.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?ti.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:fe.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){ti.clientId=t,ti.api=new eb({baseUrl:iF,clientId:t})}};var Tg={};const Ose="https://secure.walletconnect.org/sdk",Dse=(typeof process<"u"&&typeof Tg<"u"?Tg.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||Ose,Mse=(typeof process<"u"&&typeof Tg<"u"?Tg.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",Use=(typeof process<"u"&&typeof Tg<"u"?Tg.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",Ze={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},fr={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},uo={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},Lse={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===uo.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${uo.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===uo.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${uo.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===ne.CHAIN.SOLANA&&t===uo.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${uo.COINBASE.url}/dapp?cb_url=${r}`),e===ne.CHAIN.BITCOIN&&t===uo.BINANCE.id&&!("binancew3w"in window)){const s=M.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${(s==null?void 0:s.id)??1}`),a=new URL(uo.BINANCE.deeplink);a.searchParams.set("appId",uo.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const l=new URL(uo.BINANCE.url);l.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=l.toString()}}},Bse=Object.freeze({enabled:!0,events:[]}),$se=new eb({baseUrl:Le.getAnalyticsUrl(),clientId:null}),Fse=5,zse=60*1e3,Hl=Mn({...Bse}),Hse={state:Hl,subscribeKey(t,e){return ls(Hl,t,e)},async sendError(t,e){if(!Hl.enabled)return;const n=Date.now();if(Hl.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<zse}).length>=Fse)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};Hl.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=fe.state;await $se.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:Le.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){Hl.enabled=!0},disable(){Hl.enabled=!1},clearEvents(){Hl.events=[]}};class pf extends Error{constructor(e,n,r){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=n,this.originalError=r,r&&r instanceof Error&&(this.originalName=r.name),Object.setPrototypeOf(this,pf.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,pf):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function $O(t,e){let n="";try{t instanceof Error?n=t.message:typeof t=="string"?n=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?n="Unknown error":n=(t==null?void 0:t.message)||JSON.stringify(t):n=String(t)}catch(s){n="Unknown error",console.error("Error parsing error message",s)}const r=t instanceof pf?t:new pf(n,e,t);throw Hse.sendError(r,r.category),r}function Bo(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return $O(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return $O(a,e)}},n[r]=i}else n[r]=s}),n}const ji=Mn({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),Vse={state:ji,subscribeNetworkImages(t){return cs(ji.networkImages,()=>t(ji.networkImages))},subscribeKey(t,e){return ls(ji,t,e)},subscribe(t){return cs(ji,()=>t(ji))},setWalletImage(t,e){ji.walletImages[t]=e},setNetworkImage(t,e){ji.networkImages[t]=e},setChainImage(t,e){ji.chainImages[t]=e},setConnectorImage(t,e){ji.connectorImages={...ji.connectorImages,[t]:e}},setTokenImage(t,e){ji.tokenImages[t]=e},setCurrencyImage(t,e){ji.currencyImages[t]=e}},Co=Bo(Vse),Wse={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},RA=Mn({networkImagePromises:{}}),oF={async fetchWalletImage(t){if(t)return await dt._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(RA.networkImagePromises[t]||(RA.networkImagePromises[t]=dt._fetchNetworkImage(t)),await RA.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return Co.state.walletImages[t]},getWalletImage(t){if(t!=null&&t.image_url)return t==null?void 0:t.image_url;if(t!=null&&t.image_id)return Co.state.walletImages[t.image_id]},getNetworkImage(t){var e,n,r;if((e=t==null?void 0:t.assets)!=null&&e.imageUrl)return(n=t==null?void 0:t.assets)==null?void 0:n.imageUrl;if((r=t==null?void 0:t.assets)!=null&&r.imageId)return Co.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return Co.state.networkImages[t]},getConnectorImage(t){var e;if(t!=null&&t.imageUrl)return t.imageUrl;if((e=t==null?void 0:t.info)!=null&&e.icon)return t.info.icon;if(t!=null&&t.imageId)return Co.state.connectorImages[t.imageId]},getChainImage(t){return Co.state.networkImages[Wse[t]]},getTokenImage(t){if(t)return Co.state.tokenImages[t]}},qse=Le.getAnalyticsUrl(),Kse=new eb({baseUrl:qse,clientId:null}),Gse=["MODAL_CREATED"],Yse=45,Ms=Mn({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1}),Lt={state:Ms,subscribe(t){return cs(Ms,()=>t(Ms))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=fe.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},_setPendingEvent(t){var e,n;try{let r=(e=M.getAccountData())==null?void 0:e.address;if("address"in t.data&&t.data.address&&(r=t.data.address),Gse.includes(t.data.event)||typeof window>"u")return;const s=(n=M.getActiveCaipNetwork())==null?void 0:n.caipNetworkId;this.state.pendingEvents.push({eventId:Le.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:r,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:s}}}),Ms.reportedErrors.FORBIDDEN=!1,JSON.stringify(Ms.pendingEvents).length/1024>Yse&&Lt._submitPendingEvents()}catch(r){console.warn("_setPendingEvent",r)}},sendEvent(t){var n;Ms.timestamp=Date.now(),Ms.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];((n=fe.state.features)!=null&&n.analytics||e.includes(t.event))&&Lt._setPendingEvent(Ms),this._subscribeToVisibilityChange()},_submitPendingEvents(){if(Ms.pendingEvents.length!==0)try{Kse.sendBeacon({path:"/batch",params:Lt.getSdkProperties(),body:Ms.pendingEvents}),Ms.reportedErrors.FORBIDDEN=!1,Ms.pendingEvents=[]}catch{Ms.reportedErrors.FORBIDDEN=!0}},_subscribeToVisibilityChange(){var t;Ms.subscribedToVisibilityChange||typeof document>"u"||(Ms.subscribedToVisibilityChange=!0,(t=document==null?void 0:document.addEventListener)==null||t.call(document,"visibilitychange",()=>{document.visibilityState==="hidden"&&Lt._submitPendingEvents()}))}},Qse=Le.getApiUrl(),ni=new eb({baseUrl:Qse,clientId:null}),Jse=40,FO=4,Zse=20,vt=Mn({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[]}),dt={state:vt,subscribeKey(t,e){return ls(vt,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=fe.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return fe.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${ni.baseUrl}/getWalletImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});Co.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${ni.baseUrl}/public/getAssetImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});Co.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${ni.baseUrl}/public/getAssetImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});Co.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${ni.baseUrl}/public/getCurrencyImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});Co.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${ni.baseUrl}/public/getTokenImage/${t}`,n=await ni.getBlob({path:e,params:dt._getSdkProperties()});Co.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){const e=t.length,n=Le.isMobile()?t==null?void 0:t.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(uo).map(o=>o.id).includes(s.id)):t,r=e-n.length;return{filteredWallets:n,mobileFilteredOutWalletsLength:r}},async fetchProjectConfig(){return(await ni.get({path:"/appkit/v1/config",params:dt._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await ni.get({path:"/projects/v1/origins",params:dt._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===ne.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=ne.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const t=M.getAllRequestedCaipNetworks(),e=t==null?void 0:t.map(({assets:n})=>n==null?void 0:n.imageId).filter(Boolean).filter(n=>!oF.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>dt._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=ke.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>dt._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>dt._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>dt._fetchTokenImage(e)))},async fetchWallets(t){var o;const e=t.exclude??[];dt._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(uo).map(a=>a.id));const r=await ni.get({path:"/getWallets",params:{...dt._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:(o=t.include)==null?void 0:o.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=dt._filterWalletsByPlatform(r==null?void 0:r.data);return{data:s||[],count:r==null?void 0:r.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=ke.state.connectors;if(!(t!=null&&t.length))return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),M.state.activeChain===ne.CHAIN.EVM){const s=[...t.flatMap(i=>{var o;return((o=i.connectors)==null?void 0:o.map(a=>{var l;return(l=a.info)==null?void 0:l.rdns}))||[]}),...t.map(i=>{var o;return(o=i.info)==null?void 0:o.rdns})].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:n}=await dt.fetchWallets(e);vt.explorerWallets=n;const r=M.getRequestedCaipNetworkIds().join(",");vt.explorerFilteredWallets=n.filter(s=>{var i;return(i=s.chains)==null?void 0:i.some(o=>r.includes(o))})},async fetchFeaturedWallets(){const{featuredWalletIds:t}=fe.state;if(t!=null&&t.length){const e={...dt._getSdkProperties(),page:1,entries:(t==null?void 0:t.length)??FO,include:t},{data:n}=await dt.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>dt._fetchWalletImage(i))),vt.featured=r,vt.allFeatured=r}},async fetchRecommendedWallets(){try{vt.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=fe.state,r=[...e??[],...n??[]].filter(Boolean),s=M.getRequestedCaipNetworkIds().join(","),i={page:1,entries:FO,include:t,exclude:r,chains:s},{data:o,count:a}=await dt.fetchWallets(i),l=ye.getRecentWallets(),d=o.map(h=>h.image_id).filter(Boolean),u=l.map(h=>h.image_id).filter(Boolean);await Promise.allSettled([...d,...u].map(h=>dt._fetchWalletImage(h))),vt.recommended=o,vt.allRecommended=o,vt.count=a??0}catch{}finally{vt.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=fe.state,s=M.getRequestedCaipNetworkIds().join(","),i=[...vt.recommended.map(({id:h})=>h),...n??[],...r??[]].filter(Boolean),o={page:t,entries:Jse,include:e,exclude:i,chains:s},{data:a,count:l,mobileFilteredOutWalletsLength:d}=await dt.fetchWallets(o);vt.mobileFilteredOutWalletsLength=d+(vt.mobileFilteredOutWalletsLength??0);const u=a.slice(0,Zse).map(h=>h.image_id).filter(Boolean);await Promise.allSettled(u.map(h=>dt._fetchWalletImage(h))),vt.wallets=Le.uniqueBy([...vt.wallets,...dt._filterOutExtensions(a)],"id").filter(h=>{var f;return(f=h.chains)==null?void 0:f.some(p=>s.includes(p))}),vt.count=l>vt.count?l:vt.count,vt.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await dt.fetchWallets(e);n&&n.forEach(r=>{vt.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=fe.state,s=M.getRequestedCaipNetworkIds().join(",");vt.search=[];const i={page:1,entries:100,search:t==null?void 0:t.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await dt.fetchWallets(i);Lt.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(l=>l.image_id).filter(Boolean);await Promise.allSettled([...a.map(l=>dt._fetchWalletImage(l)),Le.wait(300)]),vt.search=dt._filterOutExtensions(o)},initPromise(t,e){const n=vt.promises[t];return n||(vt.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0,fetchWalletRanks:s=!0}={}){const i=[t&&dt.initPromise("connectorImages",dt.fetchConnectorImages),e&&dt.initPromise("featuredWallets",dt.fetchFeaturedWallets),n&&dt.initPromise("recommendedWallets",dt.fetchRecommendedWallets),r&&dt.initPromise("networkImages",dt.fetchNetworkImages),s&&dt.initPromise("walletRanks",dt.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){var t;(t=fe.state.features)!=null&&t.analytics&&dt.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await ni.get({path:"/getAnalyticsConfig",params:dt._getSdkProperties()});fe.setFeatures({analytics:t})}catch{fe.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!(t!=null&&t.length)){vt.featured=vt.allFeatured,vt.recommended=vt.allRecommended;return}const e=M.getRequestedCaipNetworkIds().join(",");vt.featured=vt.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.recommended=vt.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.filteredWallets=vt.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})},clearFilterByNamespaces(){vt.filteredWallets=[]},setFilterByNamespace(t){if(!t){vt.featured=vt.allFeatured,vt.recommended=vt.allRecommended;return}const e=M.getRequestedCaipNetworkIds().join(",");vt.featured=vt.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.recommended=vt.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),vt.filteredWallets=vt.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})}},un=Mn({view:"Connect",history:["Connect"],transactionStack:[]}),Xse={state:un,subscribeKey(t,e){return ls(un,t,e)},pushTransactionStack(t){un.transactionStack.push(t)},popTransactionStack(t){const e=un.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n==null||n();break;case"error":r==null||r(),ut.goBack();break;case"cancel":s==null||s(),ut.goBack();break}},push(t,e){t!==un.view&&(un.view=t,un.history.push(t),un.data=e)},reset(t,e){un.view=t,un.history=[t],un.data=e},replace(t,e){un.history.at(-1)===t||(un.view=t,un.history[un.history.length-1]=t,un.data=e)},goBack(){var r,s;const t=M.state.activeCaipAddress,e=ut.state.view==="ConnectingFarcaster",n=!t&&e;if(un.history.length>1){un.history.pop();const[i]=un.history.slice(-1);i&&(t&&i==="Connect"?un.view="Account":un.view=i)}else Dt.close();(r=un.data)!=null&&r.wallet&&(un.data.wallet=void 0),(s=un.data)!=null&&s.redirectView&&(un.data.redirectView=void 0),setTimeout(()=>{var i,o,a;if(n){M.setAccountProp("farcasterUrl",void 0,M.state.activeChain);const l=ke.getAuthConnector();(i=l==null?void 0:l.provider)==null||i.reload();const d=Aw(fe.state);(a=(o=l==null?void 0:l.provider)==null?void 0:o.syncDappData)==null||a.call(o,{metadata:d.metadata,sdkVersion:d.sdkVersion,projectId:d.projectId,sdkType:d.sdkType})}},100)},goBackToIndex(t){if(un.history.length>1){un.history=un.history.slice(0,t+1);const[e]=un.history.slice(-1);e&&(un.view=e)}},goBackOrCloseModal(){ut.state.history.length>1?ut.goBack():Dt.close()}},ut=Bo(Xse),Pc=Mn({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),UT={state:Pc,subscribe(t){return cs(Pc,()=>t(Pc))},setThemeMode(t){Pc.themeMode=t;try{const e=ke.getAuthConnector();if(e){const n=UT.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:Sw(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){Pc.themeVariables={...Pc.themeVariables,...t};try{const e=ke.getAuthConnector();if(e){const n=UT.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:Sw(Pc.themeVariables,Pc.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Aw(Pc)}},fi=Bo(UT),aF=Object.fromEntries(q8.map(t=>[t,void 0])),eie=Object.fromEntries(q8.map(t=>[t,!0])),nn=Mn({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:aF,filterByNamespaceMap:eie}),tie={state:nn,subscribe(t){return cs(nn,()=>{t(nn)})},subscribeKey(t,e){return ls(nn,t,e)},initialize(t){t.forEach(e=>{const n=ye.getConnectedConnectorId(e);n&&ke.setConnectorId(n,e)})},setActiveConnector(t){t&&(nn.activeConnector=Cg(t))},setConnectors(t){t.filter(s=>!nn.allConnectors.some(i=>i.id===s.id&&ke.getConnectorName(i.name)===ke.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&nn.allConnectors.push(Cg(s))});const n=ke.getEnabledNamespaces(),r=ke.getEnabledConnectors(n);nn.connectors=ke.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(nn.filterByNamespaceMap).forEach(e=>{nn.filterByNamespaceMap[e]=!1}),t.forEach(e=>{nn.filterByNamespaceMap[e]=!0}),ke.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){nn.filterByNamespaceMap[t]=e,ke.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=ke.getEnabledNamespaces(),e=ke.getEnabledConnectors(t),n=ke.areAllNamespacesEnabled();nn.connectors=ke.mergeMultiChainConnectors(e),n?dt.clearFilterByNamespaces():dt.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(nn.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return nn.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(nn.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=ke.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=(s==null?void 0:s.id)===ne.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=ke.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){var e,n,r;if(t.id===ne.CONNECTOR_ID.AUTH){const s=t,i=Aw(fe.state),o=fi.getSnapshot().themeMode,a=fi.getSnapshot().themeVariables;(n=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||n.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(r=s==null?void 0:s.provider)==null||r.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:Sw(a,o)}),ke.setConnectors([t])}else ke.setConnectors([t])},getAuthConnector(t){var r;const e=t||M.state.activeChain,n=nn.connectors.find(s=>s.id===ne.CONNECTOR_ID.AUTH);if(n)return(r=n==null?void 0:n.connectors)!=null&&r.length?n.connectors.find(i=>i.chain===e):n},getAnnouncedConnectorRdns(){return nn.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>{var e;return(e=t.info)==null?void 0:e.rdns})},getConnectorById(t){return nn.allConnectors.find(e=>e.id===t)},getConnector({id:t,rdns:e,namespace:n}){const r=n||M.state.activeChain;return nn.allConnectors.filter(i=>i.chain===r).find(i=>{var o;return i.explorerId===t||((o=i.info)==null?void 0:o.rdns)===e})},syncIfAuthConnector(t){var i,o;if(t.id!=="ID_AUTH")return;const e=t,n=Aw(fe.state),r=fi.getSnapshot().themeMode,s=fi.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Sw(s,r)})},getConnectorsByNamespace(t){const e=nn.allConnectors.filter(n=>n.chain===t);return ke.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return M.checkIfSmartAccountEnabled()&&Ws(t)===fr.ACCOUNT_TYPES.EOA},selectWalletConnector(t){var r;const e=(r=ut.state.data)==null?void 0:r.redirectView,n=ke.getConnector({id:t.id,rdns:t.rdns});Lse.handleMobileDeeplinkRedirect((n==null?void 0:n.explorerId)||t.id,M.state.activeChain),n?ut.push("ConnectingExternal",{connector:n,wallet:t,redirectView:e}):ut.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?ke.getConnectorsByNamespace(t):ke.mergeMultiChainConnectors(nn.allConnectors)},setFilterByNamespace(t){nn.filterByNamespace=t,nn.connectors=ke.getConnectors(t),dt.setFilterByNamespace(t)},setConnectorId(t,e){t&&(nn.activeConnectorIds={...nn.activeConnectorIds,[e]:t},ye.setConnectedConnectorId(e,t))},removeConnectorId(t){nn.activeConnectorIds={...nn.activeConnectorIds,[t]:void 0},ye.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return nn.activeConnectorIds[t]},isConnected(t){return t?!!nn.activeConnectorIds[t]:Object.values(nn.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){nn.activeConnectorIds={...aF}}},ke=Bo(tie),nie=1e3,_0={checkNamespaceConnectorId(t,e){return ke.getConnectorId(t)===e},isSocialProvider(t){return Vt.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&ke.setActiveConnector(e),s==null||s(Le.isMobile()&&t),r){const d=Dt.subscribeKey("open",u=>{u||(ut.state.view!==r&&ut.replace(r),d(),a(new Error("Modal closed")))})}const l=M.subscribeKey("activeCaipAddress",d=>{d&&(i==null||i(),n&&Dt.close(),l(),o(Rr.parseCaipAddress(d)))})})},connectExternal(t){return new Promise((e,n)=>{const r=M.subscribeKey("activeCaipAddress",s=>{s&&(Dt.close(),r(),e(Rr.parseCaipAddress(s)))});Oe.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){const i=M.getAccountData(e);let o=i==null?void 0:i.socialWindow,a=i==null?void 0:i.socialProvider,l=!1,d=null;const u=e||M.state.activeChain,h=M.subscribeKey("activeCaipAddress",f=>{f&&(n&&Dt.close(),h())});return new Promise((f,p)=>{async function m(w){var b;if((b=w.data)!=null&&b.resultUri)if(w.origin===ne.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",m,!1);try{const y=ke.getAuthConnector(u);if(y&&!l){const x=M.getAccountData(u);o&&(o.close(),M.setAccountProp("socialWindow",void 0,u),o=x==null?void 0:x.socialWindow),l=!0;const v=w.data.resultUri;if(a&&Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:a}}),a){ye.setConnectedSocialProvider(a),await Oe.connectExternal({id:y.id,type:y.type,socialUri:v},y.chain);const E=M.state.activeCaipAddress;if(!E){p(new Error("Failed to connect"));return}f(Rr.parseCaipAddress(E)),Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:a}})}}}catch(y){a&&Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:a,message:Le.parseError(y)}}),p(new Error("Failed to connect"))}}else a&&Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:a,message:"Untrusted Origin"}})}async function g(){if(t){const w=M.getAccountData(u);M.setAccountProp("socialProvider",t,u),a=w==null?void 0:w.socialProvider,Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:a}})}if(a==="farcaster"){r==null||r();const w=Dt.subscribeKey("open",y=>{!y&&t==="farcaster"&&(p(new Error("Popup closed")),s==null||s(),w())}),b=ke.getAuthConnector();if(b){const y=M.getAccountData(u);if(!(y!=null&&y.farcasterUrl))try{const{url:x}=await b.provider.getFarcasterUri();M.setAccountProp("farcasterUrl",x,u)}catch{p(new Error("Failed to connect to farcaster"))}}}else{const w=ke.getAuthConnector();d=Le.returnOpenHref(`${ne.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(w&&a){const{uri:b}=await w.provider.getSocialRedirectUri({provider:a});if(d&&b){M.setAccountProp("socialWindow",Cg(d),u),o=i==null?void 0:i.socialWindow,d.location.href=b;const y=setInterval(()=>{o!=null&&o.closed&&!l&&(p(new Error("Popup closed")),clearInterval(y))},1e3);window.addEventListener("message",m,!1)}else d==null||d.close(),p(new Error("Failed to initiate social connection"))}}catch{p(new Error("Failed to initiate social connection")),d==null||d.close()}}}g()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n==null||n(),e){const a=Dt.subscribeKey("open",l=>{l||(ut.state.view!==e&&ut.replace(e),a(),i(new Error("Modal closed")))})}const o=M.subscribeKey("activeCaipAddress",a=>{a&&(r==null||r(),t&&Dt.close(),o(),s(Rr.parseCaipAddress(a)))})})},async updateEmail(){const t=ye.getConnectedConnectorId(M.state.activeChain),e=ke.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==ne.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await Dt.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&(Dt.close(),clearInterval(i),o(),r({email:a}))},nie),o=Dt.subscribeKey("open",a=>{a||(ut.state.view!=="Connect"&&ut.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return M.checkIfSmartAccountEnabled()&&Ws(t)===fr.ACCOUNT_TYPES.EOA}};function cF(){var r,s;const t=((r=M.state.activeCaipNetwork)==null?void 0:r.chainNamespace)||"eip155",e=((s=M.state.activeCaipNetwork)==null?void 0:s.id)||1,n=Vt.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function Ws(t){var n;return(n=M.getAccountData(t))==null?void 0:n.preferredAccountType}function oy(t){var e,n;return t?(n=(e=M.state.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:M.state.activeCaipNetwork}const yE={getConnectionStatus(t,e){const n=ke.state.activeConnectorIds[e],r=Oe.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(l=>l.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){var a;const e=!!((a=fe.state.remoteFeatures)!=null&&a.multiWallet),n=ke.state.activeConnectorIds[t],r=Oe.getConnections(t),i=(Oe.state.recentConnections.get(t)??[]).filter(l=>ke.getConnectorById(l.connectorId)),o=yE.excludeExistingConnections([...r.map(l=>l.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(l=>l.connectorId.toLowerCase()===(n==null?void 0:n.toLowerCase())),recentConnections:[]}}},Ln=Mn({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),rie={state:Ln,subscribe(t){return cs(Ln,()=>t(Ln))},setLastNetworkInView(t){Ln.lastNetworkInView=t},async fetchTransactions(t){var e;if(!t)throw new Error("Transactions can't be fetched without an accountAddress");Ln.loading=!0;try{const n=await gt.fetchTransactions({account:t,cursor:Ln.next,chainId:(e=M.state.activeCaipNetwork)==null?void 0:e.caipNetworkId}),r=o1.filterSpamTransactions(n.data),s=o1.filterByConnectedChain(r),i=[...Ln.transactions,...s];Ln.loading=!1,Ln.transactions=i,Ln.transactionsByYear=o1.groupTransactionsByYearAndMonth(Ln.transactionsByYear,s),Ln.empty=i.length===0,Ln.next=n.next?n.next:void 0}catch{const r=M.state.activeChain;Lt.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:fe.state.projectId,cursor:Ln.next,isSmartAccount:Ws(r)===fr.ACCOUNT_TYPES.SMART_ACCOUNT}}),cc.showError("Failed to fetch transactions"),Ln.loading=!1,Ln.empty=!0,Ln.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},l=(o[i]??[]).filter(d=>d.id!==r.id);n[s]={...o,[i]:[...l,r].sort((d,u)=>new Date(u.metadata.minedAt).getTime()-new Date(d.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(r=>{var s;return((s=r.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(t){var r;const e=(r=M.state.activeCaipNetwork)==null?void 0:r.caipNetworkId;return t.filter(s=>s.metadata.chain===e)},clearCursor(){Ln.next=void 0},resetTransactions(){Ln.transactions=[],Ln.transactionsByYear={},Ln.lastNetworkInView=void 0,Ln.loading=!1,Ln.empty=!1,Ln.next=void 0}},o1=Bo(rie,"API_ERROR"),Yt=Mn({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let Iu;const sie={state:Yt,subscribe(t){return cs(Yt,()=>t(Yt))},subscribeKey(t,e){return ls(Yt,t,e)},_getClient(){return Yt._client},setClient(t){Yt._client=Cg(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);Oe.syncStorageConnections(e)},syncStorageConnections(t){const e=ye.getConnections(),n=t??Array.from(M.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(Yt.recentConnections);i.set(r,s),Yt.recentConnections=i}},getConnections(t){return t?Yt.connections.get(t)??[]:[]},hasAnyConnection(t){const e=Oe.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect({cache:t="auto"}={}){var n,r,s,i;const e=Le.isTelegram()||Le.isSafari()&&Le.isIos();if(t==="always"||t==="auto"&&e){if(Iu){await Iu,Iu=void 0;return}if(!Le.isPairingExpired(Yt==null?void 0:Yt.wcPairingExpiry)){const o=Yt.wcUri;Yt.wcUri=o;return}Iu=(r=(n=Oe._getClient())==null?void 0:n.connectWalletConnect)==null?void 0:r.call(n).catch(()=>{}),Oe.state.status="connecting",await Iu,Iu=void 0,Yt.wcPairingExpiry=void 0,Oe.state.status="connected"}else await((i=(s=Oe._getClient())==null?void 0:s.connectWalletConnect)==null?void 0:i.call(s))},async connectExternal(t,e,n=!0){var s,i;const r=await((i=(s=Oe._getClient())==null?void 0:s.connectExternal)==null?void 0:i.call(s,t));return n&&M.setActiveNamespace(e),r},async reconnectExternal(t){var n,r;await((r=(n=Oe._getClient())==null?void 0:n.reconnectExternal)==null?void 0:r.call(n,t));const e=t.chain||M.state.activeChain;e&&ke.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){var r;if(!e)return;Dt.setLoading(!0,M.state.activeChain);const n=ke.getAuthConnector();n&&(M.setAccountProp("preferredAccountType",t,e),await n.provider.setPreferredAccount(t),ye.setPreferredAccountTypes(Object.entries(M.state.chains).reduce((s,[i,o])=>{const a=i,l=Ws(a);return l!==void 0&&(s[a]=l),s},{})),await Oe.reconnectExternal(n),Dt.setLoading(!1,M.state.activeChain),Lt.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:((r=M.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}))},async signMessage(t){var e;return(e=Oe._getClient())==null?void 0:e.signMessage(t)},parseUnits(t,e){var n;return(n=Oe._getClient())==null?void 0:n.parseUnits(t,e)},formatUnits(t,e){var n;return(n=Oe._getClient())==null?void 0:n.formatUnits(t,e)},updateBalance(t){var e;return(e=Oe._getClient())==null?void 0:e.updateBalance(t)},async sendTransaction(t){var e;return(e=Oe._getClient())==null?void 0:e.sendTransaction(t)},async getCapabilities(t){var e;return(e=Oe._getClient())==null?void 0:e.getCapabilities(t)},async grantPermissions(t){var e;return(e=Oe._getClient())==null?void 0:e.grantPermissions(t)},async walletGetAssets(t){var e;return((e=Oe._getClient())==null?void 0:e.walletGetAssets(t))??{}},async estimateGas(t){var e;return(e=Oe._getClient())==null?void 0:e.estimateGas(t)},async writeContract(t){var e;return(e=Oe._getClient())==null?void 0:e.writeContract(t)},async getEnsAddress(t){var e;return(e=Oe._getClient())==null?void 0:e.getEnsAddress(t)},async getEnsAvatar(t){var e;return(e=Oe._getClient())==null?void 0:e.getEnsAvatar(t)},checkInstalled(t){var e,n;return((n=(e=Oe._getClient())==null?void 0:e.checkInstalled)==null?void 0:n.call(e,t))||!1},resetWcConnection(){Yt.wcUri=void 0,Yt.wcPairingExpiry=void 0,Yt.wcLinking=void 0,Yt.recentWallet=void 0,Yt.status="disconnected",o1.resetTransactions(),ye.deleteWalletConnectDeepLink(),ye.deleteRecentWallet()},resetUri(){Yt.wcUri=void 0,Yt.wcPairingExpiry=void 0,Iu=void 0},finalizeWcConnection(t){var r,s;const{wcLinking:e,recentWallet:n}=Oe.state;e&&ye.setWalletConnectDeepLink(e),n&&ye.setAppKitRecent(n),t&&Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:((s=(r=ut.state.data)==null?void 0:r.wallet)==null?void 0:s.name)||"Unknown",view:ut.state.view,walletRank:n==null?void 0:n.order}})},setWcBasic(t){Yt.wcBasic=t},setUri(t){Yt.wcUri=t,Yt.wcPairingExpiry=Le.getPairingExpiry()},setWcLinking(t){Yt.wcLinking=t},setWcError(t){Yt.wcError=t,Yt.buffering=!1},setRecentWallet(t){Yt.recentWallet=t},setBuffering(t){Yt.buffering=t},setStatus(t){Yt.status=t},setIsSwitchingConnection(t){Yt.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){var r;try{await((r=Oe._getClient())==null?void 0:r.disconnect({id:t,chainNamespace:e,initialDisconnect:n}))}catch(s){throw new pf("Failed to disconnect","INTERNAL_SDK_ERROR",s)}},async disconnectConnector({id:t,namespace:e}){var n;try{await((n=Oe._getClient())==null?void 0:n.disconnectConnector({id:t,namespace:e}))}catch(r){throw new pf("Failed to disconnect connector","INTERNAL_SDK_ERROR",r)}},setConnections(t,e){const n=new Map(Yt.connections);n.set(e,t),Yt.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){var i,o;const n=M.getAccountData(e),r=(o=(i=n==null?void 0:n.user)==null?void 0:i.accounts)==null?void 0:o.find(a=>a.type==="smartAccount"),s=r&&r.address.toLowerCase()===t.toLowerCase()&&_0.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await Oe.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=ke.getConnectorById(t.connectorId),s=t.connectorId===ne.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)s&&n&&await Oe.handleAuthAccountSwitch({address:n,namespace:e});else{const i=await Oe.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e);return i==null?void 0:i.address}return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){var d,u;const s=ke.getConnectorById(t.connectorId),i=(u=(d=t.auth)==null?void 0:d.name)==null?void 0:u.toLowerCase(),o=t.connectorId===ne.CONNECTOR_ID.AUTH,a=t.connectorId===ne.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let l;if(o)if(i&&_0.isSocialProvider(i)){const{address:h}=await _0.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Dt.open({view:"ConnectingFarcaster"})},onConnect(){ut.replace("ProfileWallets")}});l=h}else{const{address:h}=await _0.connectEmail({closeModalOnConnect:r,onOpen(){Dt.open({view:"EmailLogin"})},onConnect(){ut.replace("ProfileWallets")}});l=h}else if(a){const{address:h}=await _0.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(f){const p=f?"AllWallets":"ConnectingWalletConnect";Dt.state.open?ut.push(p):Dt.open({view:p})},onConnect(){ut.replace("ProfileWallets")}});l=h}else{const h=await Oe.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);h&&(l=h.address)}return o&&n&&await Oe.handleAuthAccountSwitch({address:n,namespace:e}),l},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){var l;let i;const o=(l=M.getAccountData(n))==null?void 0:l.caipAddress;if(o){const{address:d}=Rr.parseCaipAddress(o);i=d}const a=yE.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const d=await Oe.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&d){const u=d.toLowerCase()!==i.toLowerCase();s==null||s({address:d,namespace:n,hasSwitchedAccount:u,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const d=await Oe.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});d&&(s==null||s({address:d,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0}));break}default:throw new Error(`Invalid connection status: ${a}`)}}},Oe=Bo(sie),jA={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return WI(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let PA;async function zO(){if(!PA){const{createPublicClient:t,http:e,defineChain:n}=await $n(async()=>{const{createPublicClient:r,http:s,defineChain:i}=await import("./index-FFVutECM.js");return{createPublicClient:r,http:s,defineChain:i}},__vite__mapDeps([0,1,2,3]));PA={createPublicClient:t,http:e,defineChain:n}}return PA}const LT={getBlockchainApiRpcUrl(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()},async getViemChain(t){const{defineChain:e}=await zO(),{chainId:n}=Rr.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(n)})},async createViemPublicClient(t){const{createPublicClient:e,http:n}=await zO(),r=fe.state.projectId,s=await LT.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:n(LT.getBlockchainApiRpcUrl(t.caipNetworkId,r))})}},GI={async getMyTokensWithBalance(t){var a;const e=(a=M.getAccountData())==null?void 0:a.address,n=M.state.activeCaipNetwork,r=ke.getConnectorId("eip155")===ne.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=ye.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===ne.CHAIN.EVM&&r){const l=await this.getEIP155Balances(e,n);if(l)return this.filterLowQualityTokens(l)}const o=await gt.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){var n,r;try{const s=jA.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await Oe.getCapabilities(t);if(!((r=(n=i==null?void 0:i[s])==null?void 0:n.assetDiscovery)!=null&&r.supported))return null;const o=await Oe.walletGetAssets({account:t,chainFilter:[s]});if(!jA.isWalletGetAssetsResponse(o))return null;const l=(o[s]||[]).map(d=>jA.createBalance(d,e.caipNetworkId));return ye.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:l},timestamp:Date.now()}),l}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:n}){const r=await LT.createViemPublicClient(n),{address:s}=Rr.parseCaipAddress(t),[{result:i},{result:o},{result:a},{result:l}]=await r.multicall({contracts:[{address:e,functionName:"name",args:[],abi:Jb},{address:e,functionName:"symbol",args:[],abi:Jb},{address:e,functionName:"balanceOf",args:[s],abi:Jb},{address:e,functionName:"decimals",args:[],abi:Jb}]});return{name:i,symbol:o,decimals:l,balance:a&&l?WI(a,l):"0"}}},Kf=Mn({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),pa={state:Kf,subscribe(t){return cs(Kf,()=>t(Kf))},subscribeOpen(t){return ls(Kf,"open",t)},set(t){Object.assign(Kf,{...Kf,...t})}},iie={async getTokenList(t){var r;const e=await gt.fetchSwapTokens({chainId:t});return((r=e==null?void 0:e.tokens)==null?void 0:r.map(s=>({...s,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0})))||[]},async fetchGasPrice(){var e;const t=M.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const n=(e=await(Oe==null?void 0:Oe.estimateGas({chainNamespace:"solana"})))==null?void 0:e.toString();return{standard:n,fast:n,instant:n};case"eip155":default:return await gt.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await gt.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s!=null&&s.allowance&&n&&r){const i=Oe.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await GI.getMyTokensWithBalance(t);return M.setAccountProp("tokenBalance",e,M.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return(t==null?void 0:t.map(e=>({...e,address:e!=null&&e.address?e.address:cF(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]},async handleSwapError(t){var e,n;try{const r=t==null?void 0:t.cause;if(!(r!=null&&r.json))return;const s=await r.json(),i=(n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description;return i!=null&&i.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},Qt=Mn({tokenBalances:[],loading:!1}),oie={state:Qt,subscribe(t){return cs(Qt,()=>t(Qt))},subscribeKey(t,e){return ls(Qt,t,e)},setToken(t){t&&(Qt.token=Cg(t))},setTokenAmount(t){Qt.sendTokenAmount=t},setReceiverAddress(t){Qt.receiverAddress=t},setReceiverProfileImageUrl(t){Qt.receiverProfileImageUrl=t},setReceiverProfileName(t){Qt.receiverProfileName=t},setNetworkBalanceInUsd(t){Qt.networkBalanceInUSD=t},setLoading(t){Qt.loading=t},getSdkEventProperties(t){var e,n;return{message:Le.parseError(t),isSmartAccount:Ws(M.state.activeChain)===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((e=Qt.token)==null?void 0:e.symbol)||"",amount:Qt.sendTokenAmount??0,network:((n=M.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}},async sendToken(){var t;try{switch(Pt.setLoading(!0),(t=M.state.activeCaipNetwork)==null?void 0:t.chainNamespace){case"eip155":await Pt.sendEvmToken();return;case"solana":await Pt.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(e){throw pl.isUserRejectedRequestError(e)?new HI(e):e}finally{Pt.setLoading(!1)}},async sendEvmToken(){var n,r,s;const t=M.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=Ws(t);if(!Pt.state.sendTokenAmount||!Pt.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Pt.state.token)throw new Error("A token is required");if((n=Pt.state.token)!=null&&n.address){Lt.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:Pt.state.token.address,amount:Pt.state.sendTokenAmount,network:((r=M.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}});const{hash:i}=await Pt.sendERC20Token({receiverAddress:Pt.state.receiverAddress,tokenAddress:Pt.state.token.address,sendTokenAmount:Pt.state.sendTokenAmount,decimals:Pt.state.token.quantity.decimals});i&&(Qt.hash=i)}else{Lt.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:Pt.state.token.symbol||"",amount:Pt.state.sendTokenAmount,network:((s=M.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}});const{hash:i}=await Pt.sendNativeToken({receiverAddress:Pt.state.receiverAddress,sendTokenAmount:Pt.state.sendTokenAmount,decimals:Pt.state.token.quantity.decimals});i&&(Qt.hash=i)}},async fetchTokenBalance(t){var o,a,l;Qt.loading=!0;const e=M.state.activeChain,n=(o=M.state.activeCaipNetwork)==null?void 0:o.caipNetworkId,r=(a=M.state.activeCaipNetwork)==null?void 0:a.chainNamespace,s=((l=M.getAccountData(e))==null?void 0:l.caipAddress)??M.state.activeCaipAddress,i=s?Le.getPlainAddress(s):void 0;if(Qt.lastRetry&&!Le.isAllowedRetry(Qt.lastRetry,30*Vt.ONE_SEC_MS))return Qt.loading=!1,[];try{if(i&&n&&r){const d=await GI.getMyTokensWithBalance();return Qt.tokenBalances=d,Qt.lastRetry=void 0,d}}catch(d){Qt.lastRetry=Date.now(),t==null||t(d),cc.showError("Token Balance Unavailable")}finally{Qt.loading=!1}return[]},fetchNetworkBalance(){if(Qt.tokenBalances.length===0)return;const t=iie.mapBalancesToSwapTokens(Qt.tokenBalances);if(!t)return;const e=t.find(n=>n.address===cF());e&&(Qt.networkBalanceInUSD=e?Bre.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){var o,a,l,d;ut.pushTransactionStack({});const e=t.receiverAddress,n=(o=M.getAccountData())==null?void 0:o.address,r=Oe.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await Oe.sendTransaction({chainNamespace:ne.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)});return Lt.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Ws("eip155")===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((a=Pt.state.token)==null?void 0:a.symbol)||"",amount:t.sendTokenAmount,network:((l=M.state.activeCaipNetwork)==null?void 0:l.caipNetworkId)||"",hash:i||""}}),(d=Oe._getClient())==null||d.updateBalance("eip155"),Pt.resetSend(),{hash:i}},async sendERC20Token(t){var r,s,i;ut.pushTransactionStack({onSuccess(){ut.replace("Account")}});const e=Oe.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),n=(r=M.getAccountData())==null?void 0:r.address;if(n&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const o=Le.getPlainAddress(t.tokenAddress);if(!o)throw new Error("SendController:sendERC20Token - tokenAddress is required");const a=await Oe.writeContract({fromAddress:n,tokenAddress:o,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:Hre.getERC20Abi(o),chainNamespace:ne.CHAIN.EVM});return Lt.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Ws("eip155")===fr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((s=Pt.state.token)==null?void 0:s.symbol)||"",amount:t.sendTokenAmount,network:((i=M.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||"",hash:a||""}}),Pt.resetSend(),{hash:a}}return{hash:void 0}},async sendSolanaToken(){var n;if(!Pt.state.sendTokenAmount||!Pt.state.receiverAddress)throw new Error("An amount and receiver address are required");ut.pushTransactionStack({onSuccess(){ut.replace("Account")}});let t;Pt.state.token&&Pt.state.token.address!==Vt.SOLANA_NATIVE_TOKEN_ADDRESS&&(Le.isCaipAddress(Pt.state.token.address)?t=Le.getPlainAddress(Pt.state.token.address):t=Pt.state.token.address);const e=await Oe.sendTransaction({chainNamespace:"solana",tokenMint:t,to:Pt.state.receiverAddress,value:Pt.state.sendTokenAmount});e&&(Qt.hash=e),(n=Oe._getClient())==null||n.updateBalance("solana"),Pt.resetSend()},resetSend(){Qt.token=void 0,Qt.sendTokenAmount=void 0,Qt.receiverAddress=void 0,Qt.receiverProfileImageUrl=void 0,Qt.receiverProfileName=void 0,Qt.loading=!1,Qt.tokenBalances=[]}},Pt=Bo(oie),OA={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},nv={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},Me=Mn({chains:Ire(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),lF={state:Me,subscribe(t){return cs(Me,()=>{t(Me)})},subscribeKey(t,e){return ls(Me,t,e)},subscribeAccountStateProp(t,e,n){var s;const r=n||Me.activeChain;return r?ls(((s=Me.chains.get(r))==null?void 0:s.accountState)||{},t,e):()=>{}},subscribeChainProp(t,e,n){let r;return cs(Me.chains,()=>{var i;const s=n||Me.activeChain;if(s){const o=(i=Me.chains.get(s))==null?void 0:i[t];r!==o&&(r=o,e(o))}})},initialize(t,e,n){const{chainId:r,namespace:s}=ye.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(r==null?void 0:r.toString())),a=t.find(u=>(u==null?void 0:u.namespace)===s)||(t==null?void 0:t[0]),l=t.map(u=>u.namespace).filter(u=>u!==void 0),d=fe.state.enableEmbedded?new Set([...l]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((t==null?void 0:t.length)===0||!a)&&(Me.noAdapters=!0),Me.noAdapters||(Me.activeChain=a==null?void 0:a.namespace,Me.activeCaipNetwork=i,M.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),Me.activeChain&&pa.set({activeChain:a==null?void 0:a.namespace})),d.forEach(u=>{const h=e==null?void 0:e.filter(m=>m.chainNamespace===u),f=ye.getPreferredAccountTypes()||{},p={...fe.state.defaultAccountTypes,...f};M.state.chains.set(u,{namespace:u,networkState:Mn({...nv,caipNetwork:h==null?void 0:h[0]}),accountState:Mn({...OA,preferredAccountType:p[u]}),caipNetworks:h??[],...n}),M.setRequestedCaipNetworks(h??[],u)})},removeAdapter(t){var e,n;if(Me.activeChain===t){const r=Array.from(Me.chains.entries()).find(([s])=>s!==t);if(r){const s=(n=(e=r[1])==null?void 0:e.caipNetworks)==null?void 0:n[0];s&&M.setActiveCaipNetwork(s)}}Me.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:n},r){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");Me.chains.set(t.namespace,{namespace:t.namespace,networkState:{...nv,caipNetwork:r[0]},accountState:{...OA},caipNetworks:r,connectionControllerClient:n,networkControllerClient:e}),M.setRequestedCaipNetworks((r==null?void 0:r.filter(s=>s.chainNamespace===t.namespace))??[],t.namespace)},addNetwork(t){var n;const e=Me.chains.get(t.chainNamespace);if(e){const r=[...e.caipNetworks||[]];(n=e.caipNetworks)!=null&&n.find(s=>s.id===t.id)||r.push(t),Me.chains.set(t.chainNamespace,{...e,caipNetworks:r}),M.setRequestedCaipNetworks(r,t.chainNamespace),ke.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){var r,s,i;const n=Me.chains.get(t);if(n){const o=((r=Me.activeCaipNetwork)==null?void 0:r.id)===e,a=[...((s=n.caipNetworks)==null?void 0:s.filter(l=>l.id!==e))||[]];o&&((i=n==null?void 0:n.caipNetworks)!=null&&i[0])&&M.setActiveCaipNetwork(n.caipNetworks[0]),Me.chains.set(t,{...n,caipNetworks:a}),M.setRequestedCaipNetworks(a||[],t),a.length===0&&ke.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=Me.chains.get(t);n&&(n.networkState={...n.networkState||nv,...e},Me.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=Me.chains.get(t);if(r){const s={...r.accountState||OA,...e};Me.chains.set(t,{...r,accountState:s}),(Me.chains.size===1||Me.activeChain===t)&&e.caipAddress&&(Me.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const n=Me.chains.get(t);if(n){const r={...n.networkState||nv,...e};Me.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){M.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){var r,s;Me.activeChain=t;const e=t?Me.chains.get(t):void 0,n=(r=e==null?void 0:e.networkState)==null?void 0:r.caipNetwork;n!=null&&n.id&&t&&(Me.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,Me.activeCaipNetwork=n,M.setChainNetworkData(t,{caipNetwork:n}),ye.setActiveCaipNetworkId(n==null?void 0:n.caipNetworkId),pa.set({activeChain:t,selectedNetworkId:n==null?void 0:n.caipNetworkId}))},setActiveCaipNetwork(t){var i,o;if(!t)return;const e=Me.activeChain===t.chainNamespace;e||M.setIsSwitchingNamespace(!0);const n=Me.chains.get(t.chainNamespace);Me.activeChain=t.chainNamespace,Me.activeCaipNetwork=t,M.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let r=(i=n==null?void 0:n.accountState)==null?void 0:i.address;if(r)Me.activeCaipAddress=`${t.chainNamespace}:${t.id}:${r}`;else if(e&&Me.activeCaipAddress){const{address:a}=Rr.parseCaipAddress(Me.activeCaipAddress);r=a,Me.activeCaipAddress=`${t.caipNetworkId}:${r}`}else Me.activeCaipAddress=void 0;M.setChainAccountData(t.chainNamespace,{address:r,caipAddress:Me.activeCaipAddress}),Pt.resetSend(),pa.set({activeChain:Me.activeChain,selectedNetworkId:(o=Me.activeCaipNetwork)==null?void 0:o.caipNetworkId}),ye.setActiveCaipNetworkId(t.caipNetworkId),!M.checkIfSupportedNetwork(t.chainNamespace)&&fe.state.enableNetworkSwitch&&!fe.state.allowUnsupportedChain&&!Oe.state.wcBasic&&M.showUnsupportedChainUI()},addCaipNetwork(t){var n;if(!t)return;const e=Me.chains.get(t.chainNamespace);e&&((n=e==null?void 0:e.caipNetworks)==null||n.push(t))},async switchActiveNamespace(t){var s;if(!t)return;const e=t!==M.state.activeChain,n=(s=M.getNetworkData(t))==null?void 0:s.caipNetwork,r=M.getCaipNetworkByNamespace(t,n==null?void 0:n.id);e&&r&&await M.switchActiveNetwork(r)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){var o;const n=M.state.activeChain;if(!n)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=M.state.chains.get(n),s=!((o=r==null?void 0:r.caipNetworks)!=null&&o.some(a=>{var l;return a.id===((l=Me.activeCaipNetwork)==null?void 0:l.id)})),i=M.getNetworkControllerClient(t.chainNamespace);if(i){try{await i.switchCaipNetwork(t),s&&Dt.close()}catch(a){if(e)throw a;ut.goBack()}Lt.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})}},getNetworkControllerClient(t){const e=t||Me.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=Me.chains.get(e);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(t){const e=t||Me.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=Me.chains.get(e);if(!(n!=null&&n.connectionControllerClient))throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){var r;const n=(r=Me.chains.get(e))==null?void 0:r.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=Me.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=(e==null?void 0:e.networkState)||{};return Le.sortRequestedNetworks(n,r).filter(o=>o==null?void 0:o.id)},getAllRequestedCaipNetworks(){const t=[];return Me.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=M.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){M.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=M.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));ke.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return Me.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=M.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){var e,n;return t?(n=(e=Me.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:Me.activeCaipNetwork},getActiveCaipAddress(){return Me.activeCaipAddress},getApprovedCaipNetworkIds(t){var r;const e=Me.chains.get(t);return((r=e==null?void 0:e.networkState)==null?void 0:r.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(t){const e=M.getNetworkControllerClient(),n=await(e==null?void 0:e.getApprovedCaipNetworksData());M.setAdapterNetworkState(t,{approvedCaipNetworkIds:n==null?void 0:n.approvedCaipNetworkIds,supportsAllNetworks:n==null?void 0:n.supportsAllNetworks})},checkIfSupportedNetwork(t,e){var s;const n=e||((s=Me.activeCaipNetwork)==null?void 0:s.caipNetworkId),r=M.getRequestedCaipNetworks(t);return r.length?r==null?void 0:r.some(i=>i.caipNetworkId===n):!0},checkIfSupportedChainId(t){if(!Me.activeChain)return!0;const e=M.getRequestedCaipNetworks(Me.activeChain);return e==null?void 0:e.some(n=>n.id===t)},setSmartAccountEnabledNetworks(t,e){M.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){var r;const t=W8.caipNetworkIdToNumber((r=Me.activeCaipNetwork)==null?void 0:r.caipNetworkId),e=Me.activeChain;if(!e||!t)return!1;const n=M.getNetworkProp("smartAccountEnabledNetworks",e);return!!(n!=null&&n.includes(Number(t)))},showUnsupportedChainUI(){Dt.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=Me.activeCaipNetwork;return!!(t!=null&&t.chainNamespace&&Vt.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){M.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){var s,i;const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=(i=(s=M.state.chains.get(e))==null?void 0:s.accountState)==null?void 0:i.preferredAccountType,r=fe.state.defaultAccountTypes[e];Me.activeCaipAddress=void 0,M.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),ke.removeConnectorId(e)},setIsSwitchingNamespace(t){Me.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){var n,r;const t=[];let e;if(Me.chains.forEach(s=>{ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&t.push(s.namespace)}),t.length>0){const s=t[0];return e=s?(r=(n=Me.chains.get(s))==null?void 0:n.caipNetworks)==null?void 0:r[0]:void 0,e}},getAccountData(t){var n;const e=t||Me.activeChain;if(e)return(n=M.state.chains.get(e))==null?void 0:n.accountState},getNetworkData(t){var n;const e=t||Me.activeChain;if(e)return(n=M.state.chains.get(e))==null?void 0:n.networkState},getCaipNetworkByNamespace(t,e){var s,i,o;if(!t)return;const n=M.state.chains.get(t),r=(s=n==null?void 0:n.caipNetworks)==null?void 0:s.find(a=>a.id===e);return r||((i=n==null?void 0:n.networkState)==null?void 0:i.caipNetwork)||((o=n==null?void 0:n.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const t=ke.state.filterByNamespace;return(t?[Me.chains.get(t)]:Array.from(Me.chains.values())).flatMap(n=>(n==null?void 0:n.caipNetworks)||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?M.getRequestedCaipNetworks(t):M.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return lF.getCaipNetworks(e).find(n=>n.id.toString()===t.toString()||n.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){Me.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return Me.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){var o,a;const e=M.getAccountData();if(!e)return[];const n=(o=M.state.activeCaipNetwork)==null?void 0:o.caipNetworkId,r=(a=M.state.activeCaipNetwork)==null?void 0:a.chainNamespace,s=M.state.activeCaipAddress,i=s?Le.getPlainAddress(s):void 0;if(M.setAccountProp("balanceLoading",!0,r),e.lastRetry&&!Le.isAllowedRetry(e.lastRetry,30*Vt.ONE_SEC_MS))return M.setAccountProp("balanceLoading",!1,r),[];try{if(i&&n&&r){const l=await GI.getMyTokensWithBalance();return M.setAccountProp("tokenBalance",l,r),M.setAccountProp("lastRetry",void 0,r),M.setAccountProp("balanceLoading",!1,r),l}}catch(l){M.setAccountProp("lastRetry",Date.now(),r),t==null||t(l),cc.showError("Token Balance Unavailable")}finally{M.setAccountProp("balanceLoading",!1,r)}return[]}},M=Bo(lF),aie={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){var f,p;const n=M.state.activeCaipNetwork,r=M.state.activeChain,s=ut.state.data;if(t.id===(n==null?void 0:n.id))return;const o=!!((f=M.getAccountData(r))!=null&&f.address),a=!!((p=M.getAccountData(t.chainNamespace))!=null&&p.address),l=t.chainNamespace!==r,u=ke.getConnectorId(r)===ne.CONNECTOR_ID.AUTH,h=ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(m=>m===t.chainNamespace);e||u&&h?ut.push("SwitchNetwork",{...s,network:t}):o&&l&&!a?ut.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):ut.push("SwitchNetwork",{...s,network:t})}},ri=Mn({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),cie={state:ri,subscribe(t){return cs(ri,()=>t(ri))},subscribeKey(t,e){return ls(ri,t,e)},async open(t){var o,a;const e=t==null?void 0:t.namespace,n=M.state.activeChain,r=e&&e!==n,s=(o=M.getAccountData(t==null?void 0:t.namespace))==null?void 0:o.caipAddress,i=M.state.noAdapters;if(Oe.state.wcBasic?dt.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await dt.prefetch(),ke.setFilterByNamespace(t==null?void 0:t.namespace),Dt.setLoading(!0,e),e&&r){const l=((a=M.getNetworkData(e))==null?void 0:a.caipNetwork)||M.getRequestedCaipNetworks(e)[0];l&&(i?(await M.switchActiveNetwork(l),ut.push("ConnectingWalletConnectBasic")):aie.onSwitchNetwork({network:l,ignoreSwitchConfirmation:!0}))}else fe.state.manualWCControl||i&&!s?Le.isMobile()?ut.reset("AllWallets"):ut.reset("ConnectingWalletConnectBasic"):t!=null&&t.view?ut.reset(t.view,t.data):s?ut.reset("Account"):ut.reset("Connect");ri.open=!0,pa.set({open:!0}),Lt.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=fe.state.enableEmbedded,e=!!M.state.activeCaipAddress;ri.open&&Lt.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),ri.open=!1,ut.reset("Connect"),Dt.clearLoading(),t?e?ut.replace("Account"):ut.push("Connect"):pa.set({open:!1}),Oe.resetUri()},setLoading(t,e){e&&ri.loadingNamespaceMap.set(e,t),ri.loading=t,pa.set({loading:t})},clearLoading(){ri.loadingNamespaceMap.clear(),ri.loading=!1,pa.set({loading:!1})},shake(){ri.shake||(ri.shake=!0,setTimeout(()=>{ri.shake=!1},500))}},Dt=Bo(cie),wE={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},si=Mn({providers:{...wE},providerIds:{...wE}}),Jt={state:si,subscribeKey(t,e){return ls(si,t,e)},subscribe(t){return cs(si,()=>{t(si)})},subscribeProviders(t){return cs(si.providers,()=>t(si.providers))},setProvider(t,e){t&&e&&(si.providers[t]=Cg(e))},getProvider(t){if(t)return si.providers[t]},setProviderId(t,e){e&&(si.providerIds[t]=e)},getProviderId(t){if(t)return si.providerIds[t]},reset(){si.providers={...wE},si.providerIds={...wE}},resetChain(t){si.providers[t]=void 0,si.providerIds[t]=void 0}},Cy={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},BT={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},lie={providers:Y8,selectedProvider:null,error:null,purchaseCurrency:Cy,paymentCurrency:BT,purchaseCurrencies:[Cy],paymentCurrencies:[],quotesLoading:!1},Zt=Mn(lie),die={state:Zt,subscribe(t){return cs(Zt,()=>t(Zt))},subscribeKey(t,e){return ls(Zt,t,e)},setSelectedProvider(t){var e,n;if(t&&t.name==="meld"){const r=M.state.activeChain,s=r===ne.CHAIN.SOLANA?"SOL":"USDC",i=r?((n=(e=M.state.chains.get(r))==null?void 0:e.accountState)==null?void 0:n.address)??"":"",o=new URL(t.url);o.searchParams.append("publicKey",Wre),o.searchParams.append("destinationCurrencyCode",s),o.searchParams.append("walletAddress",i),o.searchParams.append("externalCustomerId",fe.state.projectId),Zt.selectedProvider={...t,url:o.toString()}}else Zt.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=Y8.filter(r=>e.includes(r.name));Zt.providers=n}else Zt.providers=[]},setPurchaseCurrency(t){Zt.purchaseCurrency=t},setPaymentCurrency(t){Zt.paymentCurrency=t},setPurchaseAmount(t){$T.state.purchaseAmount=t},setPaymentAmount(t){$T.state.paymentAmount=t},async getAvailableCurrencies(){const t=await gt.getOnrampOptions();Zt.purchaseCurrencies=t.purchaseCurrencies,Zt.paymentCurrencies=t.paymentCurrencies,Zt.paymentCurrency=t.paymentCurrencies[0]||BT,Zt.purchaseCurrency=t.purchaseCurrencies[0]||Cy,await dt.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await dt.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){var t,e;Zt.quotesLoading=!0;try{const n=await gt.getOnrampQuote({purchaseCurrency:Zt.purchaseCurrency,paymentCurrency:Zt.paymentCurrency,amount:((t=Zt.paymentAmount)==null?void 0:t.toString())||"0",network:(e=Zt.purchaseCurrency)==null?void 0:e.symbol});return Zt.quotesLoading=!1,Zt.purchaseAmount=Number(n==null?void 0:n.purchaseAmount.amount),n}catch(n){return Zt.error=n.message,Zt.quotesLoading=!1,null}finally{Zt.quotesLoading=!1}},resetState(){Zt.selectedProvider=null,Zt.error=null,Zt.purchaseCurrency=Cy,Zt.paymentCurrency=BT,Zt.purchaseCurrencies=[Cy],Zt.paymentCurrencies=[],Zt.paymentAmount=void 0,Zt.purchaseAmount=void 0,Zt.quotesLoading=!1}},$T=Bo(die),Vo=Mn({message:"",variant:"info",open:!1}),uie={state:Vo,subscribeKey(t,e){return ls(Vo,t,e)},open(t,e){const{debug:n}=fe.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(Vo.message=s,Vo.variant=e,Vo.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},warn(t,e,n){Vo.open=!0,Vo.message=t,Vo.variant="warning",e&&console.warn(e,n)},close(){Vo.open=!1,Vo.message="",Vo.variant="info"}},Ts=Bo(uie),HO=2147483648,hie={convertEVMChainIdToCoinType(t){if(t>=HO)throw new Error("Invalid chainId");return(HO|t)>>>0}},io=Mn({suggestions:[],loading:!1}),fie={state:io,subscribe(t){return cs(io,()=>t(io))},subscribeKey(t,e){return ls(io,t,e)},async resolveName(t){var e,n;try{return await gt.lookupEnsName(t)}catch(r){const s=r;throw new Error(((n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description)||"Error resolving name")}},async isNameRegistered(t){try{return await gt.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{io.loading=!0,io.suggestions=[];const e=await gt.getEnsNameSuggestions(t);return io.suggestions=e.suggestions||[],io.suggestions}catch(e){const n=Ny.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{io.loading=!1}},async getNamesForAddress(t){try{if(!M.state.activeCaipNetwork)return[];const n=ye.getEnsFromCacheForAddress(t);if(n)return n;const r=await gt.reverseLookupEnsName({address:t});return ye.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=Ny.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){var s;const e=M.state.activeCaipNetwork,n=(s=M.getAccountData(e==null?void 0:e.chainNamespace))==null?void 0:s.address,r=ke.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");io.loading=!0;try{const i=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});ut.pushTransactionStack({onCancel(){ut.replace("RegisterAccountName")}});const o=await Oe.signMessage(i);io.loading=!1;const a=e.id;if(!a)throw new Error("Network not found");const l=hie.convertEVMChainIdToCoinType(Number(a));await gt.registerEnsName({coinType:l,address:n,signature:o,message:i}),M.setAccountProp("profileName",t,e.chainNamespace),ye.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),ut.replace("RegisterAccountNameSuccess")}catch(i){const o=Ny.parseEnsApiError(i,`Error registering name ${t}`);throw ut.replace("RegisterAccountName"),new Error(o)}finally{io.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){var r,s;const n=t;return((s=(r=n==null?void 0:n.reasons)==null?void 0:r[0])==null?void 0:s.description)||e}},Ny=Bo(fie),pie={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}};class mie extends Error{}function gie(){const{sdkType:t,sdkVersion:e,projectId:n}=fe.getSnapshot(),r=new URL("https://rpc.walletconnect.org/v1/json-rpc");return r.searchParams.set("projectId",n),r.searchParams.set("st",t),r.searchParams.set("sv",e),r.searchParams.set("source","fund-wallet"),r.toString()}async function YI(t,e){const n=gie(),{projectId:r}=fe.getSnapshot(),s={jsonrpc:"2.0",id:1,method:t,params:{...e||{},projectId:r}},o=await(await fetch(n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new mie(o.error.message);return o}async function yRe(t){return(await YI("reown_getExchanges",t)).result}async function wRe(t){return(await YI("reown_getExchangePayUrl",t)).result}async function xRe(t){return(await YI("reown_getExchangeBuyStatus",t)).result}function bRe(t,e){const{chainNamespace:n,chainId:r}=Rr.parseCaipNetworkId(t),s=pie[n];if(!s)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${n}`);let i=s.native.assetNamespace,o=s.native.assetReference;return e!=="native"&&(i=s.defaultTokenNamespace,o=e),`${`${n}:${r}`}/${i}:${o}`}const yie={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},wie={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},dF={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},xie={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},bie={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},vie={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Eie={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Cie={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Nie={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},Aie={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},Sie={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},Tie={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},_ie={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},kie={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},Iie={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},Rie={ethereumETH:yie,baseETH:wie,baseUSDC:dF,baseSepoliaETH:bie,ethereumUSDC:vie,arbitrumUSDC:Eie,polygonUSDC:Cie,solanaUSDC:Nie,ethereumUSDT:Aie,optimismUSDT:Sie,arbitrumUSDT:Tie,polygonUSDT:_ie,solanaUSDT:kie,solanaSOL:Iie};function vRe(t){return Object.values(Rie).filter(e=>e.network===t)}var QI={exports:{}},lm=typeof Reflect=="object"?Reflect:null,VO=lm&&typeof lm.apply=="function"?lm.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},a1;lm&&typeof lm.ownKeys=="function"?a1=lm.ownKeys:Object.getOwnPropertySymbols?a1=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:a1=function(e){return Object.getOwnPropertyNames(e)};function jie(t){console&&console.warn&&console.warn(t)}var uF=Number.isNaN||function(e){return e!==e};function Nn(){Nn.init.call(this)}QI.exports=Nn;QI.exports.once=Mie;Nn.EventEmitter=Nn;Nn.prototype._events=void 0;Nn.prototype._eventsCount=0;Nn.prototype._maxListeners=void 0;var WO=10;function JC(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Nn,"defaultMaxListeners",{enumerable:!0,get:function(){return WO},set:function(t){if(typeof t!="number"||t<0||uF(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");WO=t}});Nn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Nn.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||uF(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function hF(t){return t._maxListeners===void 0?Nn.defaultMaxListeners:t._maxListeners}Nn.prototype.getMaxListeners=function(){return hF(this)};Nn.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=i[e];if(l===void 0)return!1;if(typeof l=="function")VO(l,this,n);else for(var d=l.length,u=yF(l,d),r=0;r<d;++r)VO(u[r],this,n);return!0};function fF(t,e,n,r){var s,i,o;if(JC(n),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),o=i[e]),o===void 0)o=i[e]=n,++t._eventsCount;else if(typeof o=="function"?o=i[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),s=hF(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,jie(a)}return t}Nn.prototype.addListener=function(e,n){return fF(this,e,n,!1)};Nn.prototype.on=Nn.prototype.addListener;Nn.prototype.prependListener=function(e,n){return fF(this,e,n,!0)};function Pie(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pF(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=Pie.bind(r);return s.listener=n,r.wrapFn=s,s}Nn.prototype.once=function(e,n){return JC(n),this.on(e,pF(this,e,n)),this};Nn.prototype.prependOnceListener=function(e,n){return JC(n),this.prependListener(e,pF(this,e,n)),this};Nn.prototype.removeListener=function(e,n){var r,s,i,o,a;if(JC(n),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():Oie(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};Nn.prototype.off=Nn.prototype.removeListener;Nn.prototype.removeAllListeners=function(e){var n,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function mF(t,e,n){var r=t._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?Die(s):yF(s,s.length)}Nn.prototype.listeners=function(e){return mF(this,e,!0)};Nn.prototype.rawListeners=function(e){return mF(this,e,!1)};Nn.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):gF.call(t,e)};Nn.prototype.listenerCount=gF;function gF(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Nn.prototype.eventNames=function(){return this._eventsCount>0?a1(this._events):[]};function yF(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function Oie(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Die(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function Mie(t,e){return new Promise(function(n,r){function s(o){t.removeListener(e,i),r(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}wF(t,e,i,{once:!0}),e!=="error"&&Uie(t,s,{once:!0})})}function Uie(t,e,n){typeof t.on=="function"&&wF(t,"error",e,n)}function wF(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){r.once&&t.removeEventListener(e,s),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var $o=QI.exports;const JI=Ug($o);var Ie={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var FT=function(t,e){return FT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},FT(t,e)};function Lie(t,e){FT(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var zT=function(){return zT=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},zT.apply(this,arguments)};function Bie(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function $ie(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function Fie(t,e){return function(n,r){e(n,r,t)}}function zie(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Hie(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{d(r.next(u))}catch(h){o(h)}}function l(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):s(u.value).then(a,l)}d((r=r.apply(t,e||[])).next())})}function Vie(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(d){return function(u){return l([d,u])}}function l(d){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,s=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){n.label=d[1];break}if(d[0]===6&&n.label<i[1]){n.label=i[1],i=d;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(d);break}i[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(u){d=[6,u],s=0}finally{r=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Wie(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function qie(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function HT(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xF(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function Kie(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(xF(arguments[e]));return t}function Gie(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function Kw(t){return this instanceof Kw?(this.v=t,this):new Kw(t)}function Yie(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(p){return new Promise(function(m,g){i.push([f,p,m,g])>1||a(f,p)})})}function a(f,p){try{l(r[f](p))}catch(m){h(i[0][3],m)}}function l(f){f.value instanceof Kw?Promise.resolve(f.value.v).then(d,u):h(i[0][2],f)}function d(f){a("next",f)}function u(f){a("throw",f)}function h(f,p){f(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Qie(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:Kw(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function Jie(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof HT=="function"?HT(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,l){o=t[i](o),s(a,l,o.done,o.value)})}}function s(i,o,a,l){Promise.resolve(l).then(function(d){i({value:d,done:a})},o)}}function Zie(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Xie(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function eoe(t){return t&&t.__esModule?t:{default:t}}function toe(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function noe(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const roe=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return zT},__asyncDelegator:Qie,__asyncGenerator:Yie,__asyncValues:Jie,__await:Kw,__awaiter:Hie,__classPrivateFieldGet:toe,__classPrivateFieldSet:noe,__createBinding:Wie,__decorate:$ie,__exportStar:qie,__extends:Lie,__generator:Vie,__importDefault:eoe,__importStar:Xie,__makeTemplateObject:Zie,__metadata:zie,__param:Fie,__read:xF,__rest:Bie,__spread:Kie,__spreadArrays:Gie,__values:HT},Symbol.toStringTag,{value:"Module"})),ZC=OM(roe);var DA={},k0={},qO;function soe(){if(qO)return k0;qO=1,Object.defineProperty(k0,"__esModule",{value:!0}),k0.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return k0.delay=t,k0}var Ru={},MA={},ju={},KO;function ioe(){return KO||(KO=1,Object.defineProperty(ju,"__esModule",{value:!0}),ju.ONE_THOUSAND=ju.ONE_HUNDRED=void 0,ju.ONE_HUNDRED=100,ju.ONE_THOUSAND=1e3),ju}var UA={},GO;function ooe(){return GO||(GO=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(UA)),UA}var YO;function bF(){return YO||(YO=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ZC;e.__exportStar(ioe(),t),e.__exportStar(ooe(),t)}(MA)),MA}var QO;function aoe(){if(QO)return Ru;QO=1,Object.defineProperty(Ru,"__esModule",{value:!0}),Ru.fromMiliseconds=Ru.toMiliseconds=void 0;const t=bF();function e(r){return r*t.ONE_THOUSAND}Ru.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return Ru.fromMiliseconds=n,Ru}var JO;function coe(){return JO||(JO=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ZC;e.__exportStar(soe(),t),e.__exportStar(aoe(),t)}(DA)),DA}var Gf={},ZO;function loe(){if(ZO)return Gf;ZO=1,Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Gf.Watch=t,Gf.default=t,Gf}var LA={},I0={},XO;function doe(){if(XO)return I0;XO=1,Object.defineProperty(I0,"__esModule",{value:!0}),I0.IWatch=void 0;class t{}return I0.IWatch=t,I0}var eD;function uoe(){return eD||(eD=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ZC.__exportStar(doe(),t)}(LA)),LA}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ZC;e.__exportStar(coe(),t),e.__exportStar(loe(),t),e.__exportStar(uoe(),t),e.__exportStar(bF(),t)})(Ie);class Pf{}let hoe=class extends Pf{constructor(e){super()}};const tD=Ie.FIVE_SECONDS,Of={pulse:"heartbeat_pulse"};let foe=class vF extends hoe{constructor(e){super(e),this.events=new $o.EventEmitter,this.interval=tD,this.interval=(e==null?void 0:e.interval)||tD}static async init(e){const n=new vF(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Ie.toMiliseconds(this.interval))}pulse(){this.events.emit(Of.pulse)}};const poe=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,moe=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,goe=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function yoe(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){woe(t);return}return e}function woe(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function rv(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!goe.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(poe.test(t)||moe.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,yoe)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function xoe(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Lr(t,...e){try{return xoe(t(...e))}catch(n){return Promise.reject(n)}}function boe(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function voe(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function c1(t){if(boe(t))return String(t);if(voe(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return c1(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const VT="base64:";function Eoe(t){return typeof t=="string"?t:VT+Aoe(t)}function Coe(t){return typeof t!="string"||!t.startsWith(VT)?t:Noe(t.slice(VT.length))}function Noe(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function Aoe(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function ci(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function Soe(...t){return ci(t.join(":"))}function sv(t){return t=ci(t),t?t+":":""}function Toe(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function _oe(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const koe="memory",Ioe=()=>{const t=new Map;return{name:koe,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function Roe(t={}){const e={mounts:{"":t.driver||Ioe()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=d=>{for(const u of e.mountpoints)if(d.startsWith(u))return{base:u,relativeKey:d.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:d,driver:e.mounts[""]}},r=(d,u)=>e.mountpoints.filter(h=>h.startsWith(d)||u&&d.startsWith(h)).map(h=>({relativeBase:d.length>h.length?d.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(d,u)=>{if(e.watching){u=ci(u);for(const h of e.watchListeners)h(d,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const d in e.mounts)e.unwatch[d]=await nD(e.mounts[d],s,d)}},o=async()=>{if(e.watching){for(const d in e.unwatch)await e.unwatch[d]();e.unwatch={},e.watching=!1}},a=(d,u,h)=>{const f=new Map,p=m=>{let g=f.get(m.base);return g||(g={driver:m.driver,base:m.base,items:[]},f.set(m.base,g)),g};for(const m of d){const g=typeof m=="string",w=ci(g?m:m.key),b=g?void 0:m.value,y=g||!m.options?u:{...u,...m.options},x=n(w);p(x).items.push({key:w,value:b,relativeKey:x.relativeKey,options:y})}return Promise.all([...f.values()].map(m=>h(m))).then(m=>m.flat())},l={hasItem(d,u={}){d=ci(d);const{relativeKey:h,driver:f}=n(d);return Lr(f.hasItem,h,u)},getItem(d,u={}){d=ci(d);const{relativeKey:h,driver:f}=n(d);return Lr(f.getItem,h,u).then(p=>rv(p))},getItems(d,u={}){return a(d,u,h=>h.driver.getItems?Lr(h.driver.getItems,h.items.map(f=>({key:f.relativeKey,options:f.options})),u).then(f=>f.map(p=>({key:Soe(h.base,p.key),value:rv(p.value)}))):Promise.all(h.items.map(f=>Lr(h.driver.getItem,f.relativeKey,f.options).then(p=>({key:f.key,value:rv(p)})))))},getItemRaw(d,u={}){d=ci(d);const{relativeKey:h,driver:f}=n(d);return f.getItemRaw?Lr(f.getItemRaw,h,u):Lr(f.getItem,h,u).then(p=>Coe(p))},async setItem(d,u,h={}){if(u===void 0)return l.removeItem(d);d=ci(d);const{relativeKey:f,driver:p}=n(d);p.setItem&&(await Lr(p.setItem,f,c1(u),h),p.watch||s("update",d))},async setItems(d,u){await a(d,u,async h=>{if(h.driver.setItems)return Lr(h.driver.setItems,h.items.map(f=>({key:f.relativeKey,value:c1(f.value),options:f.options})),u);h.driver.setItem&&await Promise.all(h.items.map(f=>Lr(h.driver.setItem,f.relativeKey,c1(f.value),f.options)))})},async setItemRaw(d,u,h={}){if(u===void 0)return l.removeItem(d,h);d=ci(d);const{relativeKey:f,driver:p}=n(d);if(p.setItemRaw)await Lr(p.setItemRaw,f,u,h);else if(p.setItem)await Lr(p.setItem,f,Eoe(u),h);else return;p.watch||s("update",d)},async removeItem(d,u={}){typeof u=="boolean"&&(u={removeMeta:u}),d=ci(d);const{relativeKey:h,driver:f}=n(d);f.removeItem&&(await Lr(f.removeItem,h,u),(u.removeMeta||u.removeMata)&&await Lr(f.removeItem,h+"$",u),f.watch||s("remove",d))},async getMeta(d,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),d=ci(d);const{relativeKey:h,driver:f}=n(d),p=Object.create(null);if(f.getMeta&&Object.assign(p,await Lr(f.getMeta,h,u)),!u.nativeOnly){const m=await Lr(f.getItem,h+"$",u).then(g=>rv(g));m&&typeof m=="object"&&(typeof m.atime=="string"&&(m.atime=new Date(m.atime)),typeof m.mtime=="string"&&(m.mtime=new Date(m.mtime)),Object.assign(p,m))}return p},setMeta(d,u,h={}){return this.setItem(d+"$",u,h)},removeMeta(d,u={}){return this.removeItem(d+"$",u)},async getKeys(d,u={}){var w;d=sv(d);const h=r(d,!0);let f=[];const p=[];let m=!0;for(const b of h){(w=b.driver.flags)!=null&&w.maxDepth||(m=!1);const y=await Lr(b.driver.getKeys,b.relativeBase,u);for(const x of y){const v=b.mountpoint+ci(x);f.some(E=>v.startsWith(E))||p.push(v)}f=[b.mountpoint,...f.filter(x=>!x.startsWith(b.mountpoint))]}const g=u.maxDepth!==void 0&&!m;return p.filter(b=>(!g||Toe(b,u.maxDepth))&&_oe(b,d))},async clear(d,u={}){d=sv(d),await Promise.all(r(d,!1).map(async h=>{if(h.driver.clear)return Lr(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const f=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(f.map(p=>h.driver.removeItem(p,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(d=>rD(d)))},async watch(d){return await i(),e.watchListeners.push(d),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==d),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(d,u){if(d=sv(d),d&&e.mounts[d])throw new Error(`already mounted at ${d}`);return d&&(e.mountpoints.push(d),e.mountpoints.sort((h,f)=>f.length-h.length)),e.mounts[d]=u,e.watching&&Promise.resolve(nD(u,s,d)).then(h=>{e.unwatch[d]=h}).catch(console.error),l},async unmount(d,u=!0){var h,f;d=sv(d),!(!d||!e.mounts[d])&&(e.watching&&d in e.unwatch&&((f=(h=e.unwatch)[d])==null||f.call(h),delete e.unwatch[d]),u&&await rD(e.mounts[d]),e.mountpoints=e.mountpoints.filter(p=>p!==d),delete e.mounts[d])},getMount(d=""){d=ci(d)+":";const u=n(d);return{driver:u.driver,base:u.base}},getMounts(d="",u={}){return d=ci(d),r(d,u.parents).map(f=>({driver:f.driver,base:f.mountpoint}))},keys:(d,u={})=>l.getKeys(d,u),get:(d,u={})=>l.getItem(d,u),set:(d,u,h={})=>l.setItem(d,u,h),has:(d,u={})=>l.hasItem(d,u),del:(d,u={})=>l.removeItem(d,u),remove:(d,u={})=>l.removeItem(d,u)};return l}function nD(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function rD(t){typeof t.dispose=="function"&&await Lr(t.dispose)}function Df(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function EF(t,e){let n;const r=()=>{if(n)return n;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),n=Df(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(e,s).objectStore(e)))}let BA;function tb(){return BA||(BA=EF("keyval-store","keyval")),BA}function sD(t,e=tb()){return e("readonly",n=>Df(n.get(t)))}function joe(t,e,n=tb()){return n("readwrite",r=>(r.put(e,t),Df(r.transaction)))}function Poe(t,e=tb()){return e("readwrite",n=>(n.delete(t),Df(n.transaction)))}function Ooe(t=tb()){return t("readwrite",e=>(e.clear(),Df(e.transaction)))}function Doe(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Df(t.transaction)}function Moe(t=tb()){return t("readonly",e=>{if(e.getAllKeys)return Df(e.getAllKeys());const n=[];return Doe(e,r=>n.push(r.key)).then(()=>n)})}const Uoe=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),Loe=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function mf(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Loe(t)}catch{return t}}function kl(t){return typeof t=="string"?t:Uoe(t)||""}const Boe="idb-keyval";var $oe=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=EF(t.dbName,t.storeName)),{name:Boe,options:t,async hasItem(s){return!(typeof await sD(n(s),r)>"u")},async getItem(s){return await sD(n(s),r)??null},setItem(s,i){return joe(n(s),i,r)},removeItem(s){return Poe(n(s),r)},getKeys(){return Moe(r)},clear(){return Ooe(r)}}};const Foe="WALLET_CONNECT_V2_INDEXED_DB",zoe="keyvaluestorage";let Hoe=class{constructor(){this.indexedDb=Roe({driver:$oe({dbName:Foe,storeName:zoe})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,kl(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var $A=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l1={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof $A<"u"&&$A.localStorage?l1.exports=$A.localStorage:typeof window<"u"&&window.localStorage?l1.exports=window.localStorage:l1.exports=new e})();function Voe(t){var e;return[t[0],mf((e=t[1])!=null?e:"")]}let Woe=class{constructor(){this.localStorage=l1.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Voe)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return mf(n)}async setItem(e,n){this.localStorage.setItem(e,kl(n))}async removeItem(e){this.localStorage.removeItem(e)}};const qoe="wc_storage_version",iD=1,Koe=async(t,e,n)=>{const r=qoe,s=await e.getItem(r);if(s&&s>=iD){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const l=a.toLowerCase();if(l.includes("wc@")||l.includes("walletconnect")||l.includes("wc_")||l.includes("wallet_connect")){const d=await t.getItem(a);await e.setItem(a,d),o.push(a)}}await e.setItem(r,iD),n(e),Goe(t,o)},Goe=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let Yoe=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new Woe;this.storage=e;try{const n=new Hoe;Koe(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};function Qoe(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Joe=Zoe;function Zoe(t,e,n){var r=n&&n.stringify||Qoe,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=r(t);for(var a=1;a<i;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof t!="string")return t;var l=e.length;if(l===0)return t;for(var d="",u=1-s,h=-1,f=t&&t.length||0,p=0;p<f;){if(t.charCodeAt(p)===37&&p+1<f){switch(h=h>-1?h:0,t.charCodeAt(p+1)){case 100:case 102:if(u>=l||e[u]==null)break;h<p&&(d+=t.slice(h,p)),d+=Number(e[u]),h=p+2,p++;break;case 105:if(u>=l||e[u]==null)break;h<p&&(d+=t.slice(h,p)),d+=Math.floor(Number(e[u])),h=p+2,p++;break;case 79:case 111:case 106:if(u>=l||e[u]===void 0)break;h<p&&(d+=t.slice(h,p));var m=typeof e[u];if(m==="string"){d+="'"+e[u]+"'",h=p+2,p++;break}if(m==="function"){d+=e[u].name||"<anonymous>",h=p+2,p++;break}d+=r(e[u]),h=p+2,p++;break;case 115:if(u>=l)break;h<p&&(d+=t.slice(h,p)),d+=String(e[u]),h=p+2,p++;break;case 37:h<p&&(d+=t.slice(h,p)),d+="%",h=p+2,p++,u--;break}++u}++p}return h===-1?t:(h<f&&(d+=t.slice(h)),d)}const oD=Joe;var bp=wc;const Gw=cae().console||{},Xoe={mapHttpRequest:iv,mapHttpResponse:iv,wrapRequestSerializer:FA,wrapResponseSerializer:FA,wrapErrorSerializer:FA,req:iv,res:iv,err:sae};function eae(t,e){return Array.isArray(t)?t.filter(function(r){return r!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function wc(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const n=t.browser.write||Gw;t.browser.write&&(t.browser.asObject=!0);const r=t.serializers||{},s=eae(t.browser.serialize,r);let i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof n=="function"&&(n.error=n.fatal=n.warn=n.info=n.debug=n.trace=n),t.enabled===!1&&(t.level="silent");const a=t.level||"info",l=Object.create(n);l.log||(l.log=Yw),Object.defineProperty(l,"levelVal",{get:u}),Object.defineProperty(l,"level",{get:h,set:f});const d={transmit:e,serialize:s,asObject:t.browser.asObject,levels:o,timestamp:iae(t)};l.levels=wc.levels,l.level=a,l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=Yw,l.serializers=r,l._serialize=s,l._stdErrSerialize=i,l.child=p,e&&(l._logEvent=WT());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function h(){return this._level}function f(m){if(m!=="silent"&&!this.levels.values[m])throw Error("unknown level "+m);this._level=m,Yf(d,l,"error","log"),Yf(d,l,"fatal","error"),Yf(d,l,"warn","error"),Yf(d,l,"info","log"),Yf(d,l,"debug","log"),Yf(d,l,"trace","log")}function p(m,g){if(!m)throw new Error("missing bindings for child Pino");g=g||{},s&&m.serializers&&(g.serializers=m.serializers);const w=g.serializers;if(s&&w){var b=Object.assign({},r,w),y=t.browser.serialize===!0?Object.keys(b):s;delete m.serializers,XC([m],y,b,this._stdErrSerialize)}function x(v){this._childLevel=(v._childLevel|0)+1,this.error=Qf(v,m,"error"),this.fatal=Qf(v,m,"fatal"),this.warn=Qf(v,m,"warn"),this.info=Qf(v,m,"info"),this.debug=Qf(v,m,"debug"),this.trace=Qf(v,m,"trace"),b&&(this.serializers=b,this._serialize=y),e&&(this._logEvent=WT([].concat(v._logEvent.bindings,m)))}return x.prototype=this,new x(this)}return l}wc.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};wc.stdSerializers=Xoe;wc.stdTimeFunctions=Object.assign({},{nullTime:CF,epochTime:NF,unixTime:oae,isoTime:aae});function Yf(t,e,n,r){const s=Object.getPrototypeOf(e);e[n]=e.levelVal>e.levels.values[n]?Yw:s[n]?s[n]:Gw[n]||Gw[r]||Yw,tae(t,e,n)}function tae(t,e,n){!t.transmit&&e[n]===Yw||(e[n]=function(r){return function(){const i=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Gw?Gw:this;for(var l=0;l<o.length;l++)o[l]=arguments[l];if(t.serialize&&!t.asObject&&XC(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?r.call(a,nae(this,n,o,i)):r.apply(a,o),t.transmit){const d=t.transmit.level||e.level,u=wc.levels.values[d],h=wc.levels.values[n];if(h<u)return;rae(this,{ts:i,methodLevel:n,methodValue:h,transmitValue:wc.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[n]))}function nae(t,e,n,r){t._serialize&&XC(n,t._serialize,t.serializers,t._stdErrSerialize);const s=n.slice();let i=s[0];const o={};r&&(o.time=r),o.level=wc.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),i!==null&&typeof i=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?oD(s.shift(),s):void 0}else typeof i=="string"&&(i=oD(s.shift(),s));return i!==void 0&&(o.msg=i),o}function XC(t,e,n,r){for(const s in t)if(r&&t[s]instanceof Error)t[s]=wc.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s]))for(const i in t[s])e&&e.indexOf(i)>-1&&i in n&&(t[s][i]=n[i](t[s][i]))}function Qf(t,e,n){return function(){const r=new Array(1+arguments.length);r[0]=e;for(var s=1;s<r.length;s++)r[s]=arguments[s-1];return t[n].apply(this,r)}}function rae(t,e,n){const r=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,a=e.val,l=t._logEvent.bindings;XC(n,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=s,t._logEvent.messages=n.filter(function(d){return l.indexOf(d)===-1}),t._logEvent.level.label=i,t._logEvent.level.value=o,r(i,t._logEvent,a),t._logEvent=WT(l)}function WT(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function sae(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const n in t)e[n]===void 0&&(e[n]=t[n]);return e}function iae(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?CF:NF}function iv(){return{}}function FA(t){return t}function Yw(){}function CF(){return!1}function NF(){return Date.now()}function oae(){return Math.round(Date.now()/1e3)}function aae(){return new Date(Date.now()).toISOString()}function cae(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const nb=Ug(bp),lae={level:"info"},rb="custom_context",ZI=1e3*1024;let dae=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},aD=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new dae(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}},AF=class{constructor(e,n=ZI){this.level=e??"error",this.levelValue=bp.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new aD(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===bp.levels.values.error?console.error(e):n===bp.levels.values.warn?console.warn(e):n===bp.levels.values.debug?console.debug(e):n===bp.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(kl({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new aD(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(kl({extraMetadata:e})),new Blob(n,{type:"application/json"})}},uae=class{constructor(e,n=ZI){this.baseChunkLogger=new AF(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},hae=class{constructor(e,n=ZI){this.baseChunkLogger=new AF(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var fae=Object.defineProperty,pae=Object.defineProperties,mae=Object.getOwnPropertyDescriptors,cD=Object.getOwnPropertySymbols,gae=Object.prototype.hasOwnProperty,yae=Object.prototype.propertyIsEnumerable,lD=(t,e,n)=>e in t?fae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xE=(t,e)=>{for(var n in e||(e={}))gae.call(e,n)&&lD(t,n,e[n]);if(cD)for(var n of cD(e))yae.call(e,n)&&lD(t,n,e[n]);return t},bE=(t,e)=>pae(t,mae(e));function qg(t){return bE(xE({},t),{level:(t==null?void 0:t.level)||lae.level})}function wae(t,e=rb){return t[e]||""}function xae(t,e,n=rb){return t[n]=e,t}function Ri(t,e=rb){let n="";return typeof t.bindings>"u"?n=wae(t,e):n=t.bindings().context||"",n}function bae(t,e,n=rb){const r=Ri(t,n);return r.trim()?`${r}/${e}`:e}function Ds(t,e,n=rb){const r=bae(t,e,n),s=t.child({context:r});return xae(s,r,n)}function vae(t){var e,n;const r=new uae((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:nb(bE(xE({},t.opts),{level:"trace",browser:bE(xE({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function Eae(t){var e;const n=new hae((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:nb(bE(xE({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function XI(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?vae(t):Eae(t)}var Cae=Object.defineProperty,Nae=(t,e,n)=>e in t?Cae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dD=(t,e,n)=>Nae(t,typeof e!="symbol"?e+"":e,n);let Aae=class extends Pf{constructor(e){super(),this.opts=e,dD(this,"protocol","wc"),dD(this,"version",2)}};var Sae=Object.defineProperty,Tae=(t,e,n)=>e in t?Sae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_ae=(t,e,n)=>Tae(t,e+"",n);let kae=class extends Pf{constructor(e,n){super(),this.core=e,this.logger=n,_ae(this,"records",new Map)}},Iae=class{constructor(e,n){this.logger=e,this.core=n}},Rae=class extends Pf{constructor(e,n){super(),this.relayer=e,this.logger=n}},jae=class extends Pf{constructor(e){super()}},Pae=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},Oae=class extends Pf{constructor(e,n){super(),this.relayer=e,this.logger=n}},Dae=class extends Pf{constructor(e,n){super(),this.core=e,this.logger=n}},Mae=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},Uae=class{constructor(e,n){this.projectId=e,this.logger=n}},Lae=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var Bae=Object.defineProperty,$ae=(t,e,n)=>e in t?Bae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,uD=(t,e,n)=>$ae(t,typeof e!="symbol"?e+"":e,n);let Fae=class{constructor(e){this.opts=e,uD(this,"protocol","wc"),uD(this,"version",2)}},zae=class{constructor(e){this.client=e}};function Hae(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function SF(t,...e){if(!Hae(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function hD(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Vae(t,e){SF(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Jf=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zA=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function Wae(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function TF(t){return typeof t=="string"&&(t=Wae(t)),SF(t),t}let qae=class{clone(){return this._cloneInto()}};function Kae(t){const e=r=>t().update(TF(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function _F(t=32){if(Jf&&typeof Jf.getRandomValues=="function")return Jf.getRandomValues(new Uint8Array(t));if(Jf&&typeof Jf.randomBytes=="function")return Jf.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function Gae(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),l=r?4:0,d=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+d,a,r)}let Yae=class extends qae{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=zA(this.buffer)}update(e){hD(this);const{view:n,buffer:r,blockLen:s}=this;e=TF(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const l=zA(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){hD(this),Vae(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;Gae(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=zA(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const ov=BigInt(2**32-1),qT=BigInt(32);function kF(t,e=!1){return e?{h:Number(t&ov),l:Number(t>>qT&ov)}:{h:Number(t>>qT&ov)|0,l:Number(t&ov)|0}}function Qae(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=kF(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const Jae=(t,e)=>BigInt(t>>>0)<<qT|BigInt(e>>>0),Zae=(t,e,n)=>t>>>n,Xae=(t,e,n)=>t<<32-n|e>>>n,ece=(t,e,n)=>t>>>n|e<<32-n,tce=(t,e,n)=>t<<32-n|e>>>n,nce=(t,e,n)=>t<<64-n|e>>>n-32,rce=(t,e,n)=>t>>>n-32|e<<64-n,sce=(t,e)=>e,ice=(t,e)=>t,oce=(t,e,n)=>t<<n|e>>>32-n,ace=(t,e,n)=>e<<n|t>>>32-n,cce=(t,e,n)=>e<<n-32|t>>>64-n,lce=(t,e,n)=>t<<n-32|e>>>64-n;function dce(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const uce=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),hce=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,fce=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),pce=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,mce=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),gce=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,_t={fromBig:kF,split:Qae,toBig:Jae,shrSH:Zae,shrSL:Xae,rotrSH:ece,rotrSL:tce,rotrBH:nce,rotrBL:rce,rotr32H:sce,rotr32L:ice,rotlSH:oce,rotlSL:ace,rotlBH:cce,rotlBL:lce,add:dce,add3L:uce,add3H:hce,add4L:fce,add4H:pce,add5H:gce,add5L:mce},[yce,wce]=_t.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Vl=new Uint32Array(80),Wl=new Uint32Array(80);let xce=class extends Yae{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:l,Eh:d,El:u,Fh:h,Fl:f,Gh:p,Gl:m,Hh:g,Hl:w}=this;return[e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w]}set(e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=l|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=p|0,this.Gl=m|0,this.Hh=g|0,this.Hl=w|0}process(e,n){for(let x=0;x<16;x++,n+=4)Vl[x]=e.getUint32(n),Wl[x]=e.getUint32(n+=4);for(let x=16;x<80;x++){const v=Vl[x-15]|0,E=Wl[x-15]|0,R=_t.rotrSH(v,E,1)^_t.rotrSH(v,E,8)^_t.shrSH(v,E,7),S=_t.rotrSL(v,E,1)^_t.rotrSL(v,E,8)^_t.shrSL(v,E,7),C=Vl[x-2]|0,N=Wl[x-2]|0,T=_t.rotrSH(C,N,19)^_t.rotrBH(C,N,61)^_t.shrSH(C,N,6),$=_t.rotrSL(C,N,19)^_t.rotrBL(C,N,61)^_t.shrSL(C,N,6),U=_t.add4L(S,$,Wl[x-7],Wl[x-16]),H=_t.add4H(U,R,T,Vl[x-7],Vl[x-16]);Vl[x]=H|0,Wl[x]=U|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:l,Dh:d,Dl:u,Eh:h,El:f,Fh:p,Fl:m,Gh:g,Gl:w,Hh:b,Hl:y}=this;for(let x=0;x<80;x++){const v=_t.rotrSH(h,f,14)^_t.rotrSH(h,f,18)^_t.rotrBH(h,f,41),E=_t.rotrSL(h,f,14)^_t.rotrSL(h,f,18)^_t.rotrBL(h,f,41),R=h&p^~h&g,S=f&m^~f&w,C=_t.add5L(y,E,S,wce[x],Wl[x]),N=_t.add5H(C,b,v,R,yce[x],Vl[x]),T=C|0,$=_t.rotrSH(r,s,28)^_t.rotrBH(r,s,34)^_t.rotrBH(r,s,39),U=_t.rotrSL(r,s,28)^_t.rotrBL(r,s,34)^_t.rotrBL(r,s,39),H=r&i^r&a^i&a,K=s&o^s&l^o&l;b=g|0,y=w|0,g=p|0,w=m|0,p=h|0,m=f|0,{h,l:f}=_t.add(d|0,u|0,N|0,T|0),d=a|0,u=l|0,a=i|0,l=o|0,i=r|0,o=s|0;const I=_t.add3L(T,U,K);r=_t.add3H(I,N,$,H),s=I|0}({h:r,l:s}=_t.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=_t.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l}=_t.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:d,l:u}=_t.add(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:f}=_t.add(this.Eh|0,this.El|0,h|0,f|0),{h:p,l:m}=_t.add(this.Fh|0,this.Fl|0,p|0,m|0),{h:g,l:w}=_t.add(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:y}=_t.add(this.Hh|0,this.Hl|0,b|0,y|0),this.set(r,s,i,o,a,l,d,u,h,f,p,m,g,w,b,y)}roundClean(){Vl.fill(0),Wl.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const bce=Kae(()=>new xce);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const eR=BigInt(0),IF=BigInt(1),vce=BigInt(2);function tR(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function nR(t){if(!tR(t))throw new Error("Uint8Array expected")}function HA(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Ece=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function rR(t){nR(t);let e="";for(let n=0;n<t.length;n++)e+=Ece[t[n]];return e}function RF(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?eR:BigInt("0x"+t)}const Oc={_0:48,_9:57,A:65,F:70,a:97,f:102};function fD(t){if(t>=Oc._0&&t<=Oc._9)return t-Oc._0;if(t>=Oc.A&&t<=Oc.F)return t-(Oc.A-10);if(t>=Oc.a&&t<=Oc.f)return t-(Oc.a-10)}function jF(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=fD(t.charCodeAt(i)),a=fD(t.charCodeAt(i+1));if(o===void 0||a===void 0){const l=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}r[s]=o*16+a}return r}function Cce(t){return RF(rR(t))}function d1(t){return nR(t),RF(rR(Uint8Array.from(t).reverse()))}function PF(t,e){return jF(t.toString(16).padStart(e*2,"0"))}function KT(t,e){return PF(t,e).reverse()}function Dc(t,e,n){let r;if(typeof e=="string")try{r=jF(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(tR(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function pD(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];nR(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const VA=t=>typeof t=="bigint"&&eR<=t;function Nce(t,e,n){return VA(t)&&VA(e)&&VA(n)&&e<=t&&t<n}function R0(t,e,n,r){if(!Nce(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function Ace(t){let e;for(e=0;t>eR;t>>=IF,e+=1);return e}const Sce=t=>(vce<<BigInt(t-1))-IF,Tce={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||tR(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function sR(t,e,n={}){const r=(s,i,o)=>{const a=Tce[i];if(typeof a!="function")throw new Error("invalid validator function");const l=t[s];if(!(o&&l===void 0)&&!a(l,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+l)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function mD(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Vr=BigInt(0),hr=BigInt(1),Gu=BigInt(2),_ce=BigInt(3),GT=BigInt(4),gD=BigInt(5),yD=BigInt(8);function _r(t,e){const n=t%e;return n>=Vr?n:e+n}function kce(t,e,n){if(e<Vr)throw new Error("invalid exponent, negatives unsupported");if(n<=Vr)throw new Error("invalid modulus");if(n===hr)return Vr;let r=hr;for(;e>Vr;)e&hr&&(r=r*t%n),t=t*t%n,e>>=hr;return r}function Oa(t,e,n){let r=t;for(;e-- >Vr;)r*=r,r%=n;return r}function wD(t,e){if(t===Vr)throw new Error("invert: expected non-zero number");if(e<=Vr)throw new Error("invert: expected positive modulus, got "+e);let n=_r(t,e),r=e,s=Vr,i=hr;for(;n!==Vr;){const o=r/n,a=r%n,l=s-i*o;r=n,n=a,s=i,i=l}if(r!==hr)throw new Error("invert: does not exist");return _r(s,e)}function Ice(t){const e=(t-hr)/Gu;let n,r,s;for(n=t-hr,r=0;n%Gu===Vr;n/=Gu,r++);for(s=Gu;s<t&&kce(s,e,t)!==t-hr;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+hr)/GT;return function(a,l){const d=a.pow(l,o);if(!a.eql(a.sqr(d),l))throw new Error("Cannot find square root");return d}}const i=(n+hr)/Gu;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let l=r,d=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),h=o.pow(a,n);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let f=1;for(let m=o.sqr(h);f<l&&!o.eql(m,o.ONE);f++)m=o.sqr(m);const p=o.pow(d,hr<<BigInt(l-f-1));d=o.sqr(p),u=o.mul(u,p),h=o.mul(h,d),l=f}return u}}function Rce(t){if(t%GT===_ce){const e=(t+hr)/GT;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%yD===gD){const e=(t-gD)/yD;return function(n,r){const s=n.mul(r,Gu),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,Gu),i),l=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(l),r))throw new Error("Cannot find square root");return l}}return Ice(t)}const jce=(t,e)=>(_r(t,e)&hr)===hr,Pce=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Oce(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Pce.reduce((r,s)=>(r[s]="function",r),e);return sR(t,n)}function Dce(t,e,n){if(n<Vr)throw new Error("invalid exponent, negatives unsupported");if(n===Vr)return t.ONE;if(n===hr)return e;let r=t.ONE,s=e;for(;n>Vr;)n&hr&&(r=t.mul(r,s)),s=t.sqr(s),n>>=hr;return r}function Mce(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function OF(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function DF(t,e,n=!1,r={}){if(t<=Vr)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=OF(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:Sce(s),ZERO:Vr,ONE:hr,create:l=>_r(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof l);return Vr<=l&&l<t},is0:l=>l===Vr,isOdd:l=>(l&hr)===hr,neg:l=>_r(-l,t),eql:(l,d)=>l===d,sqr:l=>_r(l*l,t),add:(l,d)=>_r(l+d,t),sub:(l,d)=>_r(l-d,t),mul:(l,d)=>_r(l*d,t),pow:(l,d)=>Dce(a,l,d),div:(l,d)=>_r(l*wD(d,t),t),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>wD(l,t),sqrt:r.sqrt||(l=>(o||(o=Rce(t)),o(a,l))),invertBatch:l=>Mce(a,l),cmov:(l,d,u)=>u?d:l,toBytes:l=>n?KT(l,i):PF(l,i),fromBytes:l=>{if(l.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+l.length);return n?d1(l):Cce(l)}});return Object.freeze(a)}const xD=BigInt(0),av=BigInt(1);function WA(t,e){const n=e.negate();return t?n:e}function MF(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function qA(t,e){MF(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function Uce(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function Lce(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const KA=new WeakMap,UF=new WeakMap;function GA(t){return UF.get(t)||1}function Bce(t,e){return{constTimeNegate:WA,hasPrecomputes(n){return GA(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>xD;)r&av&&(s=s.add(i)),i=i.double(),r>>=av;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=qA(r,e),o=[];let a=n,l=a;for(let d=0;d<s;d++){l=a,o.push(l);for(let u=1;u<i;u++)l=l.add(a),o.push(l);a=l.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=qA(n,e);let a=t.ZERO,l=t.BASE;const d=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let f=0;f<i;f++){const p=f*o;let m=Number(s&d);s>>=h,m>o&&(m-=u,s+=av);const g=p,w=p+Math.abs(m)-1,b=f%2!==0,y=m<0;m===0?l=l.add(WA(b,r[g])):a=a.add(WA(y,r[w]))}return{p:a,f:l}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=qA(n,e),l=BigInt(2**n-1),d=2**n,u=BigInt(n);for(let h=0;h<o;h++){const f=h*a;if(s===xD)break;let p=Number(s&l);if(s>>=u,p>a&&(p-=d,s+=av),p===0)continue;let m=r[f+Math.abs(p)-1];p<0&&(m=m.negate()),i=i.add(m)}return i},getPrecomputes(n,r,s){let i=KA.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&KA.set(r,s(i))),i},wNAFCached(n,r,s){const i=GA(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=GA(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){MF(r,e),UF.set(n,r),KA.delete(n)}}}function $ce(t,e,n,r){if(Uce(n,t),Lce(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=Ace(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,l=new Array(a+1).fill(s),d=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=d;h>=0;h-=o){l.fill(s);for(let p=0;p<r.length;p++){const m=r[p],g=Number(m>>BigInt(h)&BigInt(a));l[g]=l[g].add(n[p])}let f=s;for(let p=l.length-1,m=s;p>0;p--)m=m.add(l[p]),f=f.add(m);if(u=u.add(f),h!==0)for(let p=0;p<o;p++)u=u.double()}return u}function Fce(t){return Oce(t.Fp),sR(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...OF(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Wo=BigInt(0),ii=BigInt(1),cv=BigInt(2),zce=BigInt(8),Hce={zip215:!0};function Vce(t){const e=Fce(t);return sR(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Wce(t){const e=Vce(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:l}=e,d=cv<<BigInt(a*8)-ii,u=n.create,h=DF(e.n,e.nBitLength),f=e.uvRatio||((I,j)=>{try{return{isValid:!0,value:n.sqrt(I*n.inv(j))}}catch{return{isValid:!1,value:Wo}}}),p=e.adjustScalarBytes||(I=>I),m=e.domain||((I,j,F)=>{if(HA("phflag",F),j.length||F)throw new Error("Contexts/pre-hash are not supported");return I});function g(I,j){R0("coordinate "+I,j,Wo,d)}function w(I){if(!(I instanceof x))throw new Error("ExtendedPoint expected")}const b=mD((I,j)=>{const{ex:F,ey:P,ez:L}=I,B=I.is0();j==null&&(j=B?zce:n.inv(L));const V=u(F*j),X=u(P*j),ae=u(L*j);if(B)return{x:Wo,y:ii};if(ae!==ii)throw new Error("invZ was invalid");return{x:V,y:X}}),y=mD(I=>{const{a:j,d:F}=e;if(I.is0())throw new Error("bad point: ZERO");const{ex:P,ey:L,ez:B,et:V}=I,X=u(P*P),ae=u(L*L),ce=u(B*B),ie=u(ce*ce),Te=u(X*j),ue=u(ce*u(Te+ae)),Q=u(ie+u(F*u(X*ae)));if(ue!==Q)throw new Error("bad point: equation left != right (1)");const xe=u(P*L),Pe=u(B*V);if(xe!==Pe)throw new Error("bad point: equation left != right (2)");return!0});class x{constructor(j,F,P,L){this.ex=j,this.ey=F,this.ez=P,this.et=L,g("x",j),g("y",F),g("z",P),g("t",L),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(j){if(j instanceof x)throw new Error("extended point not allowed");const{x:F,y:P}=j||{};return g("x",F),g("y",P),new x(F,P,ii,u(F*P))}static normalizeZ(j){const F=n.invertBatch(j.map(P=>P.ez));return j.map((P,L)=>P.toAffine(F[L])).map(x.fromAffine)}static msm(j,F){return $ce(x,h,j,F)}_setWindowSize(j){R.setWindowSize(this,j)}assertValidity(){y(this)}equals(j){w(j);const{ex:F,ey:P,ez:L}=this,{ex:B,ey:V,ez:X}=j,ae=u(F*X),ce=u(B*L),ie=u(P*X),Te=u(V*L);return ae===ce&&ie===Te}is0(){return this.equals(x.ZERO)}negate(){return new x(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:j}=e,{ex:F,ey:P,ez:L}=this,B=u(F*F),V=u(P*P),X=u(cv*u(L*L)),ae=u(j*B),ce=F+P,ie=u(u(ce*ce)-B-V),Te=ae+V,ue=Te-X,Q=ae-V,xe=u(ie*ue),Pe=u(Te*Q),Y=u(ie*Q),me=u(ue*Te);return new x(xe,Pe,me,Y)}add(j){w(j);const{a:F,d:P}=e,{ex:L,ey:B,ez:V,et:X}=this,{ex:ae,ey:ce,ez:ie,et:Te}=j;if(F===BigInt(-1)){const An=u((B-L)*(ce+ae)),nt=u((B+L)*(ce-ae)),bn=u(nt-An);if(bn===Wo)return this.double();const Fe=u(V*cv*Te),ct=u(X*cv*ie),wt=ct+Fe,ft=nt+An,Rn=ct-Fe,ro=u(wt*bn),Gt=u(ft*Rn),or=u(wt*Rn),Ic=u(bn*ft);return new x(ro,Gt,Ic,or)}const ue=u(L*ae),Q=u(B*ce),xe=u(X*P*Te),Pe=u(V*ie),Y=u((L+B)*(ae+ce)-ue-Q),me=Pe-xe,le=Pe+xe,tt=u(Q-F*ue),Ve=u(Y*me),Ue=u(le*tt),pe=u(Y*tt),it=u(me*le);return new x(Ve,Ue,it,pe)}subtract(j){return this.add(j.negate())}wNAF(j){return R.wNAFCached(this,j,x.normalizeZ)}multiply(j){const F=j;R0("scalar",F,ii,r);const{p:P,f:L}=this.wNAF(F);return x.normalizeZ([P,L])[0]}multiplyUnsafe(j,F=x.ZERO){const P=j;return R0("scalar",P,Wo,r),P===Wo?E:this.is0()||P===ii?this:R.wNAFCachedUnsafe(this,P,x.normalizeZ,F)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return R.unsafeLadder(this,r).is0()}toAffine(j){return b(this,j)}clearCofactor(){const{h:j}=e;return j===ii?this:this.multiplyUnsafe(j)}static fromHex(j,F=!1){const{d:P,a:L}=e,B=n.BYTES;j=Dc("pointHex",j,B),HA("zip215",F);const V=j.slice(),X=j[B-1];V[B-1]=X&-129;const ae=d1(V),ce=F?d:n.ORDER;R0("pointHex.y",ae,Wo,ce);const ie=u(ae*ae),Te=u(ie-ii),ue=u(P*ie-L);let{isValid:Q,value:xe}=f(Te,ue);if(!Q)throw new Error("Point.fromHex: invalid y coordinate");const Pe=(xe&ii)===ii,Y=(X&128)!==0;if(!F&&xe===Wo&&Y)throw new Error("Point.fromHex: x=0 and x_0=1");return Y!==Pe&&(xe=u(-xe)),x.fromAffine({x:xe,y:ae})}static fromPrivateKey(j){return N(j).point}toRawBytes(){const{x:j,y:F}=this.toAffine(),P=KT(F,n.BYTES);return P[P.length-1]|=j&ii?128:0,P}toHex(){return rR(this.toRawBytes())}}x.BASE=new x(e.Gx,e.Gy,ii,u(e.Gx*e.Gy)),x.ZERO=new x(Wo,ii,ii,Wo);const{BASE:v,ZERO:E}=x,R=Bce(x,a*8);function S(I){return _r(I,r)}function C(I){return S(d1(I))}function N(I){const j=n.BYTES;I=Dc("private key",I,j);const F=Dc("hashed private key",i(I),2*j),P=p(F.slice(0,j)),L=F.slice(j,2*j),B=C(P),V=v.multiply(B),X=V.toRawBytes();return{head:P,prefix:L,scalar:B,point:V,pointBytes:X}}function T(I){return N(I).pointBytes}function $(I=new Uint8Array,...j){const F=pD(...j);return C(i(m(F,Dc("context",I),!!s)))}function U(I,j,F={}){I=Dc("message",I),s&&(I=s(I));const{prefix:P,scalar:L,pointBytes:B}=N(j),V=$(F.context,P,I),X=v.multiply(V).toRawBytes(),ae=$(F.context,X,B,I),ce=S(V+ae*L);R0("signature.s",ce,Wo,r);const ie=pD(X,KT(ce,n.BYTES));return Dc("result",ie,n.BYTES*2)}const H=Hce;function K(I,j,F,P=H){const{context:L,zip215:B}=P,V=n.BYTES;I=Dc("signature",I,2*V),j=Dc("message",j),F=Dc("publicKey",F,V),B!==void 0&&HA("zip215",B),s&&(j=s(j));const X=d1(I.slice(V,2*V));let ae,ce,ie;try{ae=x.fromHex(F,B),ce=x.fromHex(I.slice(0,V),B),ie=v.multiplyUnsafe(X)}catch{return!1}if(!B&&ae.isSmallOrder())return!1;const Te=$(L,ce.toRawBytes(),ae.toRawBytes(),j);return ce.add(ae.multiplyUnsafe(Te)).subtract(ie).clearCofactor().equals(x.ZERO)}return v._setWindowSize(8),{CURVE:e,getPublicKey:T,sign:U,verify:K,ExtendedPoint:x,utils:{getExtendedPublicKey:N,randomPrivateKey:()=>o(n.BYTES),precompute(I=8,j=x.BASE){return j._setWindowSize(I),j.multiply(BigInt(3)),j}}}}BigInt(0),BigInt(1);const iR=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),bD=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const qce=BigInt(1),vD=BigInt(2);BigInt(3);const Kce=BigInt(5),Gce=BigInt(8);function Yce(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=iR,o=t*t%i*t%i,a=Oa(o,vD,i)*o%i,l=Oa(a,qce,i)*t%i,d=Oa(l,Kce,i)*l%i,u=Oa(d,e,i)*d%i,h=Oa(u,n,i)*u%i,f=Oa(h,r,i)*h%i,p=Oa(f,s,i)*f%i,m=Oa(p,s,i)*f%i,g=Oa(m,e,i)*d%i;return{pow_p_5_8:Oa(g,vD,i)*t%i,b2:o}}function Qce(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Jce(t,e){const n=iR,r=_r(e*e*e,n),s=_r(r*r*e,n),i=Yce(t*s).pow_p_5_8;let o=_r(t*r*i,n);const a=_r(e*o*o,n),l=o,d=_r(o*bD,n),u=a===t,h=a===_r(-t,n),f=a===_r(-t*bD,n);return u&&(o=l),(h||f)&&(o=d),jce(o,n)&&(o=_r(-o,n)),{isValid:u||h,value:o}}const Zce=DF(iR,void 0,!0),Xce={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Zce,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Gce,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:bce,randomBytes:_F,adjustScalarBytes:Qce,uvRatio:Jce},LF=Wce(Xce),ele="EdDSA",tle="JWT",vE=".",eN="base64url",BF="utf8",$F="utf8",nle=":",rle="did",sle="key",ED="base58btc",ile="z",ole="K36",ale=32;function oR(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function FF(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?oR(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function zF(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=FF(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return oR(n)}function cle(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,l=t.charAt(0),d=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,w=0,b=0,y=m.length;b!==y&&m[b]===0;)b++,g++;for(var x=(y-b)*u+1>>>0,v=new Uint8Array(x);b!==y;){for(var E=m[b],R=0,S=x-1;(E!==0||R<w)&&S!==-1;S--,R++)E+=256*v[S]>>>0,v[S]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");w=R,b++}for(var C=x-w;C!==x&&v[C]===0;)C++;for(var N=l.repeat(g);C<x;++C)N+=t.charAt(v[C]);return N}function f(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var w=0,b=0;m[g]===l;)w++,g++;for(var y=(m.length-g)*d+1>>>0,x=new Uint8Array(y);m[g];){var v=n[m.charCodeAt(g)];if(v===255)return;for(var E=0,R=y-1;(v!==0||E<b)&&R!==-1;R--,E++)v+=a*x[R]>>>0,x[R]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");b=E,g++}if(m[g]!==" "){for(var S=y-b;S!==y&&x[S]===0;)S++;for(var C=new Uint8Array(w+(y-S)),N=w;S!==y;)C[N++]=x[S++];return C}}}function p(m){var g=f(m);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:p}}var lle=cle,dle=lle;const HF=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ule=t=>new TextEncoder().encode(t),hle=t=>new TextDecoder().decode(t);let fle=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ple=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return VF(this,e)}},mle=class{constructor(e){this.decoders=e}or(e){return VF(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const VF=(t,e)=>new mle({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let gle=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new fle(e,n,r),this.decoder=new ple(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const tN=({name:t,prefix:e,encode:n,decode:r})=>new gle(t,e,n,r),sb=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=dle(n,e);return tN({prefix:t,name:e,encode:r,decode:i=>HF(s(i))})},yle=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,l=0,d=0;for(let u=0;u<i;++u){const h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<n|h,a+=n,a>=8&&(a-=8,o[d++]=255&l>>a)}if(a>=n||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return o},wle=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let l=0;l<t.length;++l)for(a=a<<8|t[l],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},ds=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>tN({prefix:e,name:t,encode(s){return wle(s,r,n)},decode(s){return yle(s,r,n,t)}}),xle=tN({prefix:"\0",name:"identity",encode:t=>hle(t),decode:t=>ule(t)});var ble=Object.freeze({__proto__:null,identity:xle});const vle=ds({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ele=Object.freeze({__proto__:null,base2:vle});const Cle=ds({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Nle=Object.freeze({__proto__:null,base8:Cle});const Ale=sb({prefix:"9",name:"base10",alphabet:"0123456789"});var Sle=Object.freeze({__proto__:null,base10:Ale});const Tle=ds({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_le=ds({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var kle=Object.freeze({__proto__:null,base16:Tle,base16upper:_le});const Ile=ds({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rle=ds({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),jle=ds({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ple=ds({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ole=ds({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Dle=ds({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mle=ds({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ule=ds({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Lle=ds({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ble=Object.freeze({__proto__:null,base32:Ile,base32upper:Rle,base32pad:jle,base32padupper:Ple,base32hex:Ole,base32hexupper:Dle,base32hexpad:Mle,base32hexpadupper:Ule,base32z:Lle});const $le=sb({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Fle=sb({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var zle=Object.freeze({__proto__:null,base36:$le,base36upper:Fle});const Hle=sb({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vle=sb({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Wle=Object.freeze({__proto__:null,base58btc:Hle,base58flickr:Vle});const qle=ds({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Kle=ds({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Gle=ds({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Yle=ds({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Qle=Object.freeze({__proto__:null,base64:qle,base64pad:Kle,base64url:Gle,base64urlpad:Yle});const WF=Array.from(""),Jle=WF.reduce((t,e,n)=>(t[n]=e,t),[]),Zle=WF.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Xle(t){return t.reduce((e,n)=>(e+=Jle[n],e),"")}function ede(t){const e=[];for(const n of t){const r=Zle[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const tde=tN({prefix:"",name:"base256emoji",encode:Xle,decode:ede});var nde=Object.freeze({__proto__:null,base256emoji:tde}),rde=qF,CD=128,sde=-128,ide=Math.pow(2,31);function qF(t,e,n){e=e||[],n=n||0;for(var r=n;t>=ide;)e[n++]=t&255|CD,t/=128;for(;t&sde;)e[n++]=t&255|CD,t>>>=7;return e[n]=t|0,qF.bytes=n-r+1,e}var ode=YT,ade=128,ND=127;function YT(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw YT.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&ND)<<s:(o&ND)*Math.pow(2,s),s+=7}while(o>=ade);return YT.bytes=i-r,n}var cde=Math.pow(2,7),lde=Math.pow(2,14),dde=Math.pow(2,21),ude=Math.pow(2,28),hde=Math.pow(2,35),fde=Math.pow(2,42),pde=Math.pow(2,49),mde=Math.pow(2,56),gde=Math.pow(2,63),yde=function(t){return t<cde?1:t<lde?2:t<dde?3:t<ude?4:t<hde?5:t<fde?6:t<pde?7:t<mde?8:t<gde?9:10},wde={encode:rde,decode:ode,encodingLength:yde},KF=wde;const AD=(t,e,n=0)=>(KF.encode(t,e,n),e),SD=t=>KF.encodingLength(t),QT=(t,e)=>{const n=e.byteLength,r=SD(t),s=r+SD(n),i=new Uint8Array(s+n);return AD(t,i,0),AD(n,i,r),i.set(e,s),new xde(t,n,e,i)};let xde=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const GF=({name:t,code:e,encode:n})=>new bde(t,e,n);let bde=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?QT(this.code,n):n.then(r=>QT(this.code,r))}else throw Error("Unknown type, must be binary type")}};const YF=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),vde=GF({name:"sha2-256",code:18,encode:YF("SHA-256")}),Ede=GF({name:"sha2-512",code:19,encode:YF("SHA-512")});var Cde=Object.freeze({__proto__:null,sha256:vde,sha512:Ede});const QF=0,Nde="identity",JF=HF,Ade=t=>QT(QF,JF(t)),Sde={code:QF,name:Nde,encode:JF,digest:Ade};var Tde=Object.freeze({__proto__:null,identity:Sde});new TextEncoder,new TextDecoder;const TD={...ble,...Ele,...Nle,...Sle,...kle,...Ble,...zle,...Wle,...Qle,...nde};({...Cde,...Tde});function ZF(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const _D=ZF("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),YA=ZF("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=FF(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),XF={utf8:_D,"utf-8":_D,hex:TD.base16,latin1:YA,ascii:YA,binary:YA,...TD};function nN(t,e="utf8"){const n=XF[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function Kg(t,e="utf8"){const n=XF[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?oR(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function kD(t){return mf(nN(Kg(t,eN),BF))}function EE(t){return nN(Kg(kl(t),BF),eN)}function e9(t){const e=Kg(ole,ED),n=ile+nN(zF([e,t]),ED);return[rle,sle,n].join(nle)}function _de(t){return nN(t,eN)}function kde(t){return Kg(t,eN)}function Ide(t){return Kg([EE(t.header),EE(t.payload)].join(vE),$F)}function Rde(t){return[EE(t.header),EE(t.payload),_de(t.signature)].join(vE)}function JT(t){const e=t.split(vE),n=kD(e[0]),r=kD(e[1]),s=kde(e[2]),i=Kg(e.slice(0,2).join(vE),$F);return{header:n,payload:r,signature:s,data:i}}function ID(t=_F(ale)){const e=LF.getPublicKey(t);return{secretKey:zF([t,e]),publicKey:e}}async function jde(t,e,n,r,s=Ie.fromMiliseconds(Date.now())){const i={alg:ele,typ:tle},o=e9(r.publicKey),a=s+n,l={iss:o,sub:t,aud:e,iat:s,exp:a},d=Ide({header:i,payload:l}),u=LF.sign(d,r.secretKey.slice(0,32));return Rde({header:i,payload:l,signature:u})}var RD=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},Pde=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),Ode=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Dde=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),Mde=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Ude=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Lde=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Bde=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,jD=3,$de=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Lde]],PD=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Fde(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Ude:typeof navigator<"u"?Hde(navigator.userAgent):Wde()}function zde(t){return t!==""&&$de.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function Hde(t){var e=zde(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new Mde;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<jD&&(s=RD(RD([],s,!0),qde(jD-s.length),!0)):s=[];var i=s.join("."),o=Vde(t),a=Bde.exec(t);return a&&a[1]?new Dde(n,i,o,a[1]):new Pde(n,i,o)}function Vde(t){for(var e=0,n=PD.length;e<n;e++){var r=PD[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function Wde(){var t=typeof process<"u"&&process.version;return t?new Ode(process.version.slice(1)):null}function qde(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var kn={};Object.defineProperty(kn,"__esModule",{value:!0});kn.getLocalStorage=kn.getLocalStorageOrThrow=kn.getCrypto=kn.getCryptoOrThrow=t9=kn.getLocation=kn.getLocationOrThrow=aR=kn.getNavigator=kn.getNavigatorOrThrow=gf=kn.getDocument=kn.getDocumentOrThrow=kn.getFromWindowOrThrow=kn.getFromWindow=void 0;function Mf(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}kn.getFromWindow=Mf;function Gg(t){const e=Mf(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}kn.getFromWindowOrThrow=Gg;function Kde(){return Gg("document")}kn.getDocumentOrThrow=Kde;function Gde(){return Mf("document")}var gf=kn.getDocument=Gde;function Yde(){return Gg("navigator")}kn.getNavigatorOrThrow=Yde;function Qde(){return Mf("navigator")}var aR=kn.getNavigator=Qde;function Jde(){return Gg("location")}kn.getLocationOrThrow=Jde;function Zde(){return Mf("location")}var t9=kn.getLocation=Zde;function Xde(){return Gg("crypto")}kn.getCryptoOrThrow=Xde;function eue(){return Mf("crypto")}kn.getCrypto=eue;function tue(){return Gg("localStorage")}kn.getLocalStorageOrThrow=tue;function nue(){return Mf("localStorage")}kn.getLocalStorage=nue;var cR={};Object.defineProperty(cR,"__esModule",{value:!0});var n9=cR.getWindowMetadata=void 0;const OD=kn;function rue(){let t,e;try{t=OD.getDocumentOrThrow(),e=OD.getLocationOrThrow()}catch{return null}function n(){const h=t.getElementsByTagName("link"),f=[];for(let p=0;p<h.length;p++){const m=h[p],g=m.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const w=m.getAttribute("href");if(w)if(w.toLowerCase().indexOf("https:")===-1&&w.toLowerCase().indexOf("http:")===-1&&w.indexOf("//")!==0){let b=e.protocol+"//"+e.host;if(w.indexOf("/")===0)b+=w;else{const y=e.pathname.split("/");y.pop();const x=y.join("/");b+=x+"/"+w}f.push(b)}else if(w.indexOf("//")===0){const b=e.protocol+w;f.push(b)}else f.push(w)}}return f}function r(...h){const f=t.getElementsByTagName("meta");for(let p=0;p<f.length;p++){const m=f[p],g=["itemprop","property","name"].map(w=>m.getAttribute(w)).filter(w=>w?h.includes(w):!1);if(g.length&&g){const w=m.getAttribute("content");if(w)return w}}return""}function s(){let h=r("name","og:site_name","og:title","twitter:title");return h||(h=t.title),h}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),a=i(),l=e.origin,d=n();return{description:a,url:l,icons:d,name:o}}n9=cR.getWindowMetadata=rue;function Qw(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function ZT(t){return Qw(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const r9="2.31.0";let j0={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${r9}`};class yf extends Error{constructor(e,n={}){var a;const r=(()=>{var l;return n.cause instanceof yf?n.cause.details:(l=n.cause)!=null&&l.message?n.cause.message:n.details})(),s=n.cause instanceof yf&&n.cause.docsPath||n.docsPath,i=(a=j0.getDocsUrl)==null?void 0:a.call(j0,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...j0.version?[`Version: ${j0.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=r9}walk(e){return s9(this,e)}}function s9(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?s9(t.cause,e):e?null:t}class i9 extends yf{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Yg(t,{dir:e,size:n=32}={}){return typeof t=="string"?sue(t,{dir:e,size:n}):iue(t,{dir:e,size:n})}function sue(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new i9({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function iue(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new i9({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}class oue extends yf{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class aue extends yf{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Qg(t,{size:e}){if(ZT(t)>e)throw new aue({givenSize:ZT(t),maxSize:e})}function XT(t,e={}){const{signed:n}=e;e.size&&Qg(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function cue(t,e={}){return Number(XT(t,e))}const lue=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function e_(t,e={}){return typeof t=="number"||typeof t=="bigint"?a9(t,e):typeof t=="string"?hue(t,e):typeof t=="boolean"?due(t,e):o9(t,e)}function due(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Qg(n,{size:e.size}),Yg(n,{size:e.size})):n}function o9(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=lue[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Qg(r,{size:e.size}),Yg(r,{dir:"right",size:e.size})):r}function a9(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new oue({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Yg(a,{size:r}):a}const uue=new TextEncoder;function hue(t,e={}){const n=uue.encode(t);return o9(n,e)}const fue=new TextEncoder;function pue(t,e={}){return typeof t=="number"||typeof t=="bigint"?gue(t,e):typeof t=="boolean"?mue(t,e):Qw(t)?c9(t,e):l9(t,e)}function mue(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Qg(n,{size:e.size}),Yg(n,{size:e.size})):n}const Mc={zero:48,nine:57,A:65,F:70,a:97,f:102};function DD(t){if(t>=Mc.zero&&t<=Mc.nine)return t-Mc.zero;if(t>=Mc.A&&t<=Mc.F)return t-(Mc.A-10);if(t>=Mc.a&&t<=Mc.f)return t-(Mc.a-10)}function c9(t,e={}){let n=t;e.size&&(Qg(n,{size:e.size}),n=Yg(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const l=DD(r.charCodeAt(a++)),d=DD(r.charCodeAt(a++));if(l===void 0||d===void 0)throw new yf(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=l*16+d}return i}function gue(t,e){const n=a9(t,e);return c9(n)}function l9(t,e={}){const n=fue.encode(t);return typeof e.size=="number"?(Qg(n,{size:e.size}),Yg(n,{dir:"right",size:e.size})):n}const lv=BigInt(2**32-1),MD=BigInt(32);function yue(t,e=!1){return e?{h:Number(t&lv),l:Number(t>>MD&lv)}:{h:Number(t>>MD&lv)|0,l:Number(t&lv)|0}}function wue(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=yue(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const xue=(t,e,n)=>t<<n|e>>>32-n,bue=(t,e,n)=>e<<n|t>>>32-n,vue=(t,e,n)=>e<<n-32|t>>>64-n,Eue=(t,e,n)=>t<<n-32|e>>>64-n,Zf=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Cue(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function CE(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Jw(t,...e){if(!Cue(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function XRe(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");CE(t.outputLen),CE(t.blockLen)}function UD(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Nue(t,e){Jw(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Aue(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function d9(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function eje(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function tje(t,e){return t<<32-e|t>>>e}const Sue=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Tue(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function _ue(t){for(let e=0;e<t.length;e++)t[e]=Tue(t[e]);return t}const LD=Sue?t=>t:_ue;function kue(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function u9(t){return typeof t=="string"&&(t=kue(t)),Jw(t),t}function nje(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Jw(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}class Iue{}function Rue(t){const e=r=>t().update(u9(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function rje(t=32){if(Zf&&typeof Zf.getRandomValues=="function")return Zf.getRandomValues(new Uint8Array(t));if(Zf&&typeof Zf.randomBytes=="function")return Uint8Array.from(Zf.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const jue=BigInt(0),P0=BigInt(1),Pue=BigInt(2),Oue=BigInt(7),Due=BigInt(256),Mue=BigInt(113),h9=[],f9=[],p9=[];for(let t=0,e=P0,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],h9.push(2*(5*r+n)),f9.push((t+1)*(t+2)/2%64);let s=jue;for(let i=0;i<7;i++)e=(e<<P0^(e>>Oue)*Mue)%Due,e&Pue&&(s^=P0<<(P0<<BigInt(i))-P0);p9.push(s)}const m9=wue(p9,!0),Uue=m9[0],Lue=m9[1],BD=(t,e,n)=>n>32?vue(t,e,n):xue(t,e,n),$D=(t,e,n)=>n>32?Eue(t,e,n):bue(t,e,n);function Bue(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,l=(o+2)%10,d=n[l],u=n[l+1],h=BD(d,u,1)^n[a],f=$D(d,u,1)^n[a+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=f9[o],l=BD(s,i,a),d=$D(s,i,a),u=h9[o];s=t[u],i=t[u+1],t[u]=l,t[u+1]=d}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Uue[r],t[1]^=Lue[r]}d9(n)}class lR extends Iue{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,CE(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Aue(this.state)}clone(){return this._cloneInto()}keccak(){LD(this.state32),Bue(this.state32,this.rounds),LD(this.state32),this.posOut=0,this.pos=0}update(e){UD(this),e=u9(e),Jw(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){UD(this,!1),Jw(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return CE(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Nue(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,d9(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new lR(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const $ue=(t,e,n)=>Rue(()=>new lR(e,t,n)),Fue=$ue(1,136,256/8);function g9(t,e){const n=e||"hex",r=Fue(Qw(t,{strict:!1})?pue(t):t);return n==="bytes"?r:e_(r)}class zue extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const QA=new zue(8192);function Hue(t,e){if(QA.has(`${t}.${e}`))return QA.get(`${t}.${e}`);const n=t.substring(2).toLowerCase(),r=g9(l9(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return QA.set(`${t}.${e}`,i),i}function Vue(t){const e=g9(`0x${t.substring(4)}`).substring(26);return Hue(`0x${e}`)}async function Wue({hash:t,signature:e}){const n=Qw(t)?t:e_(t),{secp256k1:r}=await $n(async()=>{const{secp256k1:o}=await import("./secp256k1-CPbqNDnI.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:d,s:u,v:h,yParity:f}=e,p=Number(f??h),m=FD(p);return new r.Signature(XT(d),XT(u)).addRecoveryBit(m)}const o=Qw(e)?e:e_(e);if(ZT(o)!==65)throw new Error("invalid signature length");const a=cue(`0x${o.slice(130)}`),l=FD(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(l)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function FD(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function que({hash:t,signature:e}){return Vue(await Wue({hash:t,signature:e}))}function Kue(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let d=0;d<e.length;d++)e[d]=255;for(let d=0;d<t.length;d++){const u=t.charAt(d),h=u.charCodeAt(0);if(e[h]!==255)throw new TypeError(u+" is ambiguous");e[h]=d}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";let u=0,h=0,f=0;const p=d.length;for(;f!==p&&d[f]===0;)f++,u++;const m=(p-f)*i+1>>>0,g=new Uint8Array(m);for(;f!==p;){let y=d[f],x=0;for(let v=m-1;(y!==0||x<h)&&v!==-1;v--,x++)y+=256*g[v]>>>0,g[v]=y%n>>>0,y=y/n>>>0;if(y!==0)throw new Error("Non-zero carry");h=x,f++}let w=m-h;for(;w!==m&&g[w]===0;)w++;let b=r.repeat(u);for(;w<m;++w)b+=t.charAt(g[w]);return b}function a(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;let u=0,h=0,f=0;for(;d[u]===r;)h++,u++;const p=(d.length-u)*s+1>>>0,m=new Uint8Array(p);for(;u<d.length;){const y=d.charCodeAt(u);if(y>255)return;let x=e[y];if(x===255)return;let v=0;for(let E=p-1;(x!==0||v<f)&&E!==-1;E--,v++)x+=n*m[E]>>>0,m[E]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");f=v,u++}let g=p-f;for(;g!==p&&m[g]===0;)g++;const w=new Uint8Array(h+(p-g));let b=h;for(;g!==p;)w[b++]=m[g++];return w}function l(d){const u=a(d);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:l}}var Gue="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Jg=Kue(Gue);function Yue(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?n+=4:n+=3}else{n++;continue}}return n}function Que(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const Jue=new TextEncoder,Zue=50;function Xue(t,e,n){Jue.encodeInto(t,e.subarray(n))}function ehe(t,e,n){t.length>Zue?Xue(t,e,n):Que(t,e,n)}const the=4096;function y9(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if(!(a&128))i.push(a);else if((a&224)===192){const l=t[r++]&63;i.push((a&31)<<6|l)}else if((a&240)===224){const l=t[r++]&63,d=t[r++]&63;i.push((a&31)<<12|l<<6|d)}else if((a&248)===240){const l=t[r++]&63,d=t[r++]&63,u=t[r++]&63;let h=(a&7)<<18|l<<12|d<<6|u;h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|h&1023),i.push(h)}else i.push(a);i.length>=the&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const nhe=new TextDecoder,rhe=200;function she(t,e,n){const r=t.subarray(e,e+n);return nhe.decode(r)}function ihe(t,e,n){return n>rhe?she(t,e,n):y9(t,e,n)}class dv{constructor(e,n){this.type=e,this.data=n}}class Hi extends Error{constructor(e){super(e);const n=Object.create(Hi.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Hi.name})}}const O0=4294967295;function ohe(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function w9(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function x9(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function ahe(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const che=-1,lhe=4294967296-1,dhe=17179869184-1;function uhe({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=dhe)if(e===0&&t<=lhe){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),w9(r,4,t),n}}function hhe(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function fhe(t){if(t instanceof Date){const e=hhe(t);return uhe(e)}else return null}function phe(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=x9(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new Hi(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function mhe(t){const e=phe(t);return new Date(e.sec*1e3+e.nsec/1e6)}const ghe={type:che,encode:fhe,decode:mhe};class NE{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(ghe)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new dv(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new dv(o,i)}}}return e instanceof dv?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new dv(n,e)}}NE.defaultCodec=new NE;function yhe(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function t_(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):yhe(t)?new Uint8Array(t):Uint8Array.from(t)}const whe=100,xhe=2048;let bhe=class b9{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??NE.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??whe,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??xhe,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new b9({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=Yue(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),ehe(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=t_(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),ohe(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),w9(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function vhe(t,e){return new bhe(e).encodeSharedRef(t)}function JA(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const Ehe=16,Che=16;class Nhe{constructor(e=Ehe,n=Che){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=y9(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const n_="array",Ay="map_key",v9="map_value",Ahe=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Hi("The type of key must be string or number but "+typeof t)};class She{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=n_,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Ay,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===n_){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===Ay||e.type===v9){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const D0=-1,dR=new DataView(new ArrayBuffer(0)),The=new Uint8Array(dR.buffer);try{dR.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const zD=new RangeError("Insufficient data"),_he=new Nhe;let khe=class E9{constructor(e){this.totalPos=0,this.pos=0,this.view=dR,this.bytes=The,this.headByte=D0,this.stack=new She,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??NE.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??O0,this.maxBinLength=(e==null?void 0:e.maxBinLength)??O0,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??O0,this.maxMapLength=(e==null?void 0:e.maxMapLength)??O0,this.maxExtLength=(e==null?void 0:e.maxExtLength)??O0,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:_he,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??Ahe}clone(){return new E9({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=D0,this.stack.reset()}setBuffer(e){const n=t_(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===D0&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=t_(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(l){if(!(l instanceof RangeError))throw l}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${JA(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new Hi(`Unrecognized type byte: ${JA(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===n_)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===Ay){if(n==="__proto__")throw new Hi("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=v9;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=Ay;continue e}}return n}}readHeadByte(){return this.headByte===D0&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=D0}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Hi(`Unrecognized array type byte: ${JA(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Hi(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Hi(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){var i;if(e>this.maxStrLength)throw new Hi(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw zD;const r=this.pos+n;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,r,e):s=ihe(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Ay:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new Hi(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw zD;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new Hi(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=ahe(this.view,this.pos);return this.pos+=8,e}readI64(){const e=x9(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function Ihe(t,e){return new khe(e).decode(t)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Rhe(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function C9(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(n=>typeof n=="string"):e.every(n=>Number.isSafeInteger(n)):!1}function AE(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function uR(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function r_(t){if(!Array.isArray(t))throw new Error("array expected")}function SE(t,e){if(!C9(!0,e))throw new Error(`${t}: array of strings expected`)}function jhe(t,e){if(!C9(!1,e))throw new Error(`${t}: array of numbers expected`)}function Phe(...t){const e=i=>i,n=(i,o)=>a=>i(o(a)),r=t.map(i=>i.encode).reduceRight(n,e),s=t.map(i=>i.decode).reduce(n,e);return{encode:r,decode:s}}function Ohe(t){const e=typeof t=="string"?t.split(""):t,n=e.length;SE("alphabet",e);const r=new Map(e.map((s,i)=>[s,i]));return{encode:s=>(r_(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${t}`);return e[i]})),decode:s=>(r_(s),s.map(i=>{AE("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${t}`);return o}))}}function Dhe(t=""){return AE("join",t),{encode:e=>(SE("join.decode",e),e.join(t)),decode:e=>(AE("join.decode",e),e.split(t))}}function Mhe(t,e="="){return uR(t),AE("padding",e),{encode(n){for(SE("padding.encode",n);n.length*t%8;)n.push(e);return n},decode(n){SE("padding.decode",n);let r=n.length;if(r*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if((r-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const N9=(t,e)=>e===0?t:N9(e,t%e),TE=(t,e)=>t+(e-N9(t,e)),ZA=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function HD(t,e,n,r){if(r_(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(TE(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${TE(e,n)}`);let s=0,i=0;const o=ZA[e],a=ZA[n]-1,l=[];for(const d of t){if(uR(d),d>=o)throw new Error(`convertRadix2: invalid data word=${d} from=${e}`);if(s=s<<e|d,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)l.push((s>>i-n&a)>>>0);const u=ZA[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=e)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&l.push(s>>>0),l}function Uhe(t,e=!1){if(uR(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(TE(8,t)>32||TE(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Rhe(n))throw new Error("radix2.encode input should be Uint8Array");return HD(Array.from(n),8,t,!e)},decode:n=>(jhe("radix2.decode",n),Uint8Array.from(HD(n,t,8,e)))}}const Lhe=Phe(Uhe(5),Ohe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Mhe(5),Dhe(""));function hR(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function A9(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?hR(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Sy(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=A9(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return hR(n)}function Bhe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,l=t.charAt(0),d=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,w=0,b=0,y=m.length;b!==y&&m[b]===0;)b++,g++;for(var x=(y-b)*u+1>>>0,v=new Uint8Array(x);b!==y;){for(var E=m[b],R=0,S=x-1;(E!==0||R<w)&&S!==-1;S--,R++)E+=256*v[S]>>>0,v[S]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");w=R,b++}for(var C=x-w;C!==x&&v[C]===0;)C++;for(var N=l.repeat(g);C<x;++C)N+=t.charAt(v[C]);return N}function f(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var w=0,b=0;m[g]===l;)w++,g++;for(var y=(m.length-g)*d+1>>>0,x=new Uint8Array(y);m[g];){var v=n[m.charCodeAt(g)];if(v===255)return;for(var E=0,R=y-1;(v!==0||E<b)&&R!==-1;R--,E++)v+=a*x[R]>>>0,x[R]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");b=E,g++}if(m[g]!==" "){for(var S=y-b;S!==y&&x[S]===0;)S++;for(var C=new Uint8Array(w+(y-S)),N=w;S!==y;)C[N++]=x[S++];return C}}}function p(m){var g=f(m);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:p}}var $he=Bhe,Fhe=$he;const zhe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Hhe=t=>new TextEncoder().encode(t),Vhe=t=>new TextDecoder().decode(t);class Whe{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class qhe{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return S9(this,e)}}class Khe{constructor(e){this.decoders=e}or(e){return S9(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const S9=(t,e)=>new Khe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Ghe{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new Whe(e,n,r),this.decoder=new qhe(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const rN=({name:t,prefix:e,encode:n,decode:r})=>new Ghe(t,e,n,r),ib=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=Fhe(n,e);return rN({prefix:t,name:e,encode:r,decode:i=>zhe(s(i))})},Yhe=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,l=0,d=0;for(let u=0;u<i;++u){const h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<n|h,a+=n,a>=8&&(a-=8,o[d++]=255&l>>a)}if(a>=n||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return o},Qhe=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let l=0;l<t.length;++l)for(a=a<<8|t[l],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},us=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>rN({prefix:e,name:t,encode(s){return Qhe(s,r,n)},decode(s){return Yhe(s,r,n,t)}}),Jhe=rN({prefix:"\0",name:"identity",encode:t=>Vhe(t),decode:t=>Hhe(t)}),Zhe=Object.freeze(Object.defineProperty({__proto__:null,identity:Jhe},Symbol.toStringTag,{value:"Module"})),Xhe=us({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),efe=Object.freeze(Object.defineProperty({__proto__:null,base2:Xhe},Symbol.toStringTag,{value:"Module"})),tfe=us({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),nfe=Object.freeze(Object.defineProperty({__proto__:null,base8:tfe},Symbol.toStringTag,{value:"Module"})),rfe=ib({prefix:"9",name:"base10",alphabet:"0123456789"}),sfe=Object.freeze(Object.defineProperty({__proto__:null,base10:rfe},Symbol.toStringTag,{value:"Module"})),ife=us({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ofe=us({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),afe=Object.freeze(Object.defineProperty({__proto__:null,base16:ife,base16upper:ofe},Symbol.toStringTag,{value:"Module"})),cfe=us({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lfe=us({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),dfe=us({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ufe=us({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hfe=us({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ffe=us({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pfe=us({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),mfe=us({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gfe=us({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),yfe=Object.freeze(Object.defineProperty({__proto__:null,base32:cfe,base32hex:hfe,base32hexpad:pfe,base32hexpadupper:mfe,base32hexupper:ffe,base32pad:dfe,base32padupper:ufe,base32upper:lfe,base32z:gfe},Symbol.toStringTag,{value:"Module"})),wfe=ib({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),xfe=ib({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),bfe=Object.freeze(Object.defineProperty({__proto__:null,base36:wfe,base36upper:xfe},Symbol.toStringTag,{value:"Module"})),vfe=ib({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Efe=ib({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Cfe=Object.freeze(Object.defineProperty({__proto__:null,base58btc:vfe,base58flickr:Efe},Symbol.toStringTag,{value:"Module"})),Nfe=us({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Afe=us({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Sfe=us({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tfe=us({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_fe=Object.freeze(Object.defineProperty({__proto__:null,base64:Nfe,base64pad:Afe,base64url:Sfe,base64urlpad:Tfe},Symbol.toStringTag,{value:"Module"})),T9=Array.from(""),kfe=T9.reduce((t,e,n)=>(t[n]=e,t),[]),Ife=T9.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Rfe(t){return t.reduce((e,n)=>(e+=kfe[n],e),"")}function jfe(t){const e=[];for(const n of t){const r=Ife[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const Pfe=rN({prefix:"",name:"base256emoji",encode:Rfe,decode:jfe}),Ofe=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Pfe},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const VD={...Zhe,...efe,...nfe,...sfe,...afe,...yfe,...bfe,...Cfe,..._fe,...Ofe};function _9(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const WD=_9("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),XA=_9("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=A9(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),k9={utf8:WD,"utf-8":WD,hex:VD.base16,latin1:XA,ascii:XA,binary:XA,...VD};function Io(t,e="utf8"){const n=k9[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?hR(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function _i(t,e="utf8"){const n=k9[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const Dfe={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},Mfe="Input must be an string, Buffer or Uint8Array";function Ufe(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(Mfe);return e}function Lfe(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function uv(t){return(4294967296+t).toString(16).substring(1)}function Bfe(t,e,n){let r=`
`+t+" = ";for(let s=0;s<e.length;s+=2){if(n===32)r+=uv(e[s]).toUpperCase(),r+=" ",r+=uv(e[s+1]).toUpperCase();else if(n===64)r+=uv(e[s+1]).toUpperCase(),r+=uv(e[s]).toUpperCase();else throw new Error("Invalid size "+n);s%6===4?r+=`
`+new Array(t.length+4).join(" "):s<e.length-2&&(r+=" ")}console.log(r)}function $fe(t,e,n){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;const i=new Date().getTime();console.log("Generated random input in "+(i-r)+"ms"),r=i;for(let o=0;o<n;o++){const a=t(s),l=new Date().getTime(),d=l-r;r=l,console.log("Hashed in "+d+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(d/1e3)*100)/100+" MB PER SECOND")}}var I9={normalizeInput:Ufe,toHex:Lfe,debugPrint:Bfe,testSpeed:$fe};const u1=I9;function hv(t,e,n){const r=t[e]+t[n];let s=t[e+1]+t[n+1];r>=4294967296&&s++,t[e]=r,t[e+1]=s}function qD(t,e,n,r){let s=t[e]+n;n<0&&(s+=4294967296);let i=t[e+1]+r;s>=4294967296&&i++,t[e]=s,t[e+1]=i}function R9(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function ql(t,e,n,r,s,i){const o=ay[s],a=ay[s+1],l=ay[i],d=ay[i+1];hv(Nt,t,e),qD(Nt,t,o,a);let u=Nt[r]^Nt[t],h=Nt[r+1]^Nt[t+1];Nt[r]=h,Nt[r+1]=u,hv(Nt,n,r),u=Nt[e]^Nt[n],h=Nt[e+1]^Nt[n+1],Nt[e]=u>>>24^h<<8,Nt[e+1]=h>>>24^u<<8,hv(Nt,t,e),qD(Nt,t,l,d),u=Nt[r]^Nt[t],h=Nt[r+1]^Nt[t+1],Nt[r]=u>>>16^h<<16,Nt[r+1]=h>>>16^u<<16,hv(Nt,n,r),u=Nt[e]^Nt[n],h=Nt[e+1]^Nt[n+1],Nt[e]=h>>>31^u<<1,Nt[e+1]=u>>>31^h<<1}const j9=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Ffe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],gs=new Uint8Array(Ffe.map(function(t){return t*2})),Nt=new Uint32Array(32),ay=new Uint32Array(32);function P9(t,e){let n=0;for(n=0;n<16;n++)Nt[n]=t.h[n],Nt[n+16]=j9[n];for(Nt[24]=Nt[24]^t.t,Nt[25]=Nt[25]^t.t/4294967296,e&&(Nt[28]=~Nt[28],Nt[29]=~Nt[29]),n=0;n<32;n++)ay[n]=R9(t.b,4*n);for(n=0;n<12;n++)ql(0,8,16,24,gs[n*16+0],gs[n*16+1]),ql(2,10,18,26,gs[n*16+2],gs[n*16+3]),ql(4,12,20,28,gs[n*16+4],gs[n*16+5]),ql(6,14,22,30,gs[n*16+6],gs[n*16+7]),ql(0,10,20,30,gs[n*16+8],gs[n*16+9]),ql(2,12,22,24,gs[n*16+10],gs[n*16+11]),ql(4,14,16,26,gs[n*16+12],gs[n*16+13]),ql(6,8,18,28,gs[n*16+14],gs[n*16+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^Nt[n]^Nt[n+16]}const Kl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function O9(t,e,n,r){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(n&&n.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};Kl.fill(0),Kl[0]=t,e&&(Kl[1]=e.length),Kl[2]=1,Kl[3]=1,n&&Kl.set(n,32),r&&Kl.set(r,48);for(let i=0;i<16;i++)s.h[i]=j9[i]^R9(Kl,i*4);return e&&(fR(s,e),s.c=128),s}function fR(t,e){for(let n=0;n<e.length;n++)t.c===128&&(t.t+=t.c,P9(t,!1),t.c=0),t.b[t.c++]=e[n]}function D9(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;P9(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3);return e}function M9(t,e,n,r,s){n=n||64,t=u1.normalizeInput(t),r&&(r=u1.normalizeInput(r)),s&&(s=u1.normalizeInput(s));const i=O9(n,e,r,s);return fR(i,t),D9(i)}function zfe(t,e,n,r,s){const i=M9(t,e,n,r,s);return u1.toHex(i)}var Hfe={blake2b:M9,blake2bHex:zfe,blake2bInit:O9,blake2bUpdate:fR,blake2bFinal:D9};const U9=I9;function Vfe(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Gl(t,e,n,r,s,i){on[t]=on[t]+on[e]+s,on[r]=fv(on[r]^on[t],16),on[n]=on[n]+on[r],on[e]=fv(on[e]^on[n],12),on[t]=on[t]+on[e]+i,on[r]=fv(on[r]^on[t],8),on[n]=on[n]+on[r],on[e]=fv(on[e]^on[n],7)}function fv(t,e){return t>>>e^t<<32-e}const L9=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ys=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),on=new Uint32Array(16),Kr=new Uint32Array(16);function B9(t,e){let n=0;for(n=0;n<8;n++)on[n]=t.h[n],on[n+8]=L9[n];for(on[12]^=t.t,on[13]^=t.t/4294967296,e&&(on[14]=~on[14]),n=0;n<16;n++)Kr[n]=Vfe(t.b,4*n);for(n=0;n<10;n++)Gl(0,4,8,12,Kr[ys[n*16+0]],Kr[ys[n*16+1]]),Gl(1,5,9,13,Kr[ys[n*16+2]],Kr[ys[n*16+3]]),Gl(2,6,10,14,Kr[ys[n*16+4]],Kr[ys[n*16+5]]),Gl(3,7,11,15,Kr[ys[n*16+6]],Kr[ys[n*16+7]]),Gl(0,5,10,15,Kr[ys[n*16+8]],Kr[ys[n*16+9]]),Gl(1,6,11,12,Kr[ys[n*16+10]],Kr[ys[n*16+11]]),Gl(2,7,8,13,Kr[ys[n*16+12]],Kr[ys[n*16+13]]),Gl(3,4,9,14,Kr[ys[n*16+14]],Kr[ys[n*16+15]]);for(n=0;n<8;n++)t.h[n]^=on[n]^on[n+8]}function $9(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array(L9),b:new Uint8Array(64),c:0,t:0,outlen:t};return r.h[0]^=16842752^n<<8^t,n>0&&(pR(r,e),r.c=64),r}function pR(t,e){for(let n=0;n<e.length;n++)t.c===64&&(t.t+=t.c,B9(t,!1),t.c=0),t.b[t.c++]=e[n]}function F9(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;B9(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3)&255;return e}function z9(t,e,n){n=n||32,t=U9.normalizeInput(t);const r=$9(n,e);return pR(r,t),F9(r)}function Wfe(t,e,n){const r=z9(t,e,n);return U9.toHex(r)}var qfe={blake2s:z9,blake2sHex:Wfe,blake2sInit:$9,blake2sUpdate:pR,blake2sFinal:F9};const M0=Hfe,U0=qfe;var Kfe={blake2b:M0.blake2b,blake2bHex:M0.blake2bHex,blake2bInit:M0.blake2bInit,blake2bUpdate:M0.blake2bUpdate,blake2bFinal:M0.blake2bFinal,blake2s:U0.blake2s,blake2sHex:U0.blake2sHex,blake2sInit:U0.blake2sInit,blake2sUpdate:U0.blake2sUpdate,blake2sFinal:U0.blake2sFinal},Gfe={};const Yfe=":";function Yh(t){const[e,n]=t.split(Yfe);return{namespace:e,reference:n}}function H9(t,e){return t.includes(":")?[t]:e.chains||[]}var Qfe=Object.defineProperty,Jfe=Object.defineProperties,Zfe=Object.getOwnPropertyDescriptors,KD=Object.getOwnPropertySymbols,Xfe=Object.prototype.hasOwnProperty,epe=Object.prototype.propertyIsEnumerable,s_=(t,e,n)=>e in t?Qfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,GD=(t,e)=>{for(var n in e||(e={}))Xfe.call(e,n)&&s_(t,n,e[n]);if(KD)for(var n of KD(e))epe.call(e,n)&&s_(t,n,e[n]);return t},tpe=(t,e)=>Jfe(t,Zfe(e)),YD=(t,e,n)=>s_(t,typeof e!="symbol"?e+"":e,n);const npe="ReactNative",Yi={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},rpe="js";function _E(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Eu(){return!gf()&&!!aR()&&navigator.product===npe}function spe(){return Eu()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function ipe(){return Eu()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Zg(){return!_E()&&!!aR()&&!!gf()}function ob(){return Eu()?Yi.reactNative:_E()?Yi.node:Zg()?Yi.browser:Yi.unknown}function QD(){var t;try{return Eu()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function ope(t,e){const n=new URLSearchParams(t);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const s=e[r];s!==void 0&&n.set(r,s)}return n.toString()}function ape(t){var e,n;const r=V9();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),tpe(GD(GD({},r),t),{url:(t==null?void 0:t.url)||r.url,name:(t==null?void 0:t.name)||r.name,description:(t==null?void 0:t.description)||r.description,icons:(n=t==null?void 0:t.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function V9(){return n9()||{name:"",description:"",url:"",icons:[""]}}function cpe(){if(ob()===Yi.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const t=Fde();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function lpe(){var t;const e=ob();return e===Yi.browser?[e,((t=t9())==null?void 0:t.host)||"unknown"].join(":"):e}function W9(t,e,n){const r=cpe(),s=lpe();return[[t,e].join("-"),[rpe,n].join("-"),r,s].join("/")}function dpe({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:l}){const d=n.split("?"),u=W9(t,e,r),h={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:l||void 0,bundleId:a||void 0},f=ope(d[1]||"",h);return d[0]+"?"+f}function ph(t,e){return t.filter(n=>e.includes(n)).length===t.length}function i_(t){return Object.fromEntries(t.entries())}function o_(t){return new Map(Object.entries(t))}function zu(t=Ie.FIVE_MINUTES,e){const n=Ie.toMiliseconds(t||Ie.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,l)=>{if(o)return a(o);i=setTimeout(()=>{const d=new Error(e);o=Promise.reject(d),l(d)},n),r=a,s=l})}}function lc(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function q9(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function upe(t){return q9("topic",t)}function hpe(t){return q9("id",t)}function K9(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function Ar(t,e){return Ie.fromMiliseconds(Date.now()+Ie.toMiliseconds(t))}function cd(t){return Date.now()>=Ie.toMiliseconds(t)}function hn(t,e){return`${t}${e?`:${e}`:""}`}function xc(t=[],e=[]){return[...new Set([...t,...e])]}async function fpe({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=ppe(i,t,e),a=ob();if(a===Yi.browser){if(!((r=gf())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}mpe(o)}else a===Yi.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function ppe(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${xpe(r,!0)}`}else s=`${s}/wc?${r}`;return s}function mpe(t){let e="_self";wpe()?e="_top":(ype()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function gpe(t,e){let n="";try{if(Zg()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function JD(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function ZD(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function mR(){return typeof process<"u"&&Gfe.IS_VITEST==="true"}function ype(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function wpe(){try{return window.self!==window.top}catch{return!1}}function xpe(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function G9(t){return Buffer.from(t,"base64").toString("utf-8")}function bpe(t){return new Promise(e=>setTimeout(e,t))}let vpe=class{constructor({limit:e}){YD(this,"limit"),YD(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const pv=BigInt(2**32-1),XD=BigInt(32);function Y9(t,e=!1){return e?{h:Number(t&pv),l:Number(t>>XD&pv)}:{h:Number(t>>XD&pv)|0,l:Number(t&pv)|0}}function Q9(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=Y9(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const e4=(t,e,n)=>t>>>n,t4=(t,e,n)=>t<<32-n|e>>>n,ld=(t,e,n)=>t>>>n|e<<32-n,dd=(t,e,n)=>t<<32-n|e>>>n,cy=(t,e,n)=>t<<64-n|e>>>n-32,ly=(t,e,n)=>t>>>n-32|e<<64-n,Epe=(t,e)=>e,Cpe=(t,e)=>t,Npe=(t,e,n)=>t<<n|e>>>32-n,Ape=(t,e,n)=>e<<n|t>>>32-n,Spe=(t,e,n)=>e<<n-32|t>>>64-n,Tpe=(t,e,n)=>t<<n-32|e>>>64-n;function Yo(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const gR=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),yR=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,_pe=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),kpe=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,Ipe=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),Rpe=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Xf=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function wR(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Il(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Uo(t,...e){if(!wR(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function xR(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Il(t.outputLen),Il(t.blockLen)}function au(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function bR(t,e){Uo(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Zw(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Lo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function eS(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Da(t,e){return t<<32-e|t>>>e}const J9=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Z9(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Fc=J9?t=>t:t=>Z9(t);function jpe(t){for(let e=0;e<t.length;e++)t[e]=Z9(t[e]);return t}const ud=J9?t=>t:jpe,X9=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ppe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Xw(t){if(Uo(t),X9)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=Ppe[t[n]];return e}const Uc={_0:48,_9:57,A:65,F:70,a:97,f:102};function n4(t){if(t>=Uc._0&&t<=Uc._9)return t-Uc._0;if(t>=Uc.A&&t<=Uc.F)return t-(Uc.A-10);if(t>=Uc.a&&t<=Uc.f)return t-(Uc.a-10)}function vR(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(X9)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=n4(t.charCodeAt(i)),a=n4(t.charCodeAt(i+1));if(o===void 0||a===void 0){const l=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}r[s]=o*16+a}return r}function Ope(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function xa(t){return typeof t=="string"&&(t=Ope(t)),Uo(t),t}function mh(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Uo(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let sN=class{};function ab(t){const e=r=>t().update(xa(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Dpe(t){const e=(r,s)=>t(s).update(xa(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function Xg(t=32){if(Xf&&typeof Xf.getRandomValues=="function")return Xf.getRandomValues(new Uint8Array(t));if(Xf&&typeof Xf.randomBytes=="function")return Uint8Array.from(Xf.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const Mpe=BigInt(0),L0=BigInt(1),Upe=BigInt(2),Lpe=BigInt(7),Bpe=BigInt(256),$pe=BigInt(113),e7=[],t7=[],n7=[];for(let t=0,e=L0,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],e7.push(2*(5*r+n)),t7.push((t+1)*(t+2)/2%64);let s=Mpe;for(let i=0;i<7;i++)e=(e<<L0^(e>>Lpe)*$pe)%Bpe,e&Upe&&(s^=L0<<(L0<<BigInt(i))-L0);n7.push(s)}const r7=Q9(n7,!0),Fpe=r7[0],zpe=r7[1],r4=(t,e,n)=>n>32?Spe(t,e,n):Npe(t,e,n),s4=(t,e,n)=>n>32?Tpe(t,e,n):Ape(t,e,n);function Hpe(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,l=(o+2)%10,d=n[l],u=n[l+1],h=r4(d,u,1)^n[a],f=s4(d,u,1)^n[a+1];for(let p=0;p<50;p+=10)t[o+p]^=h,t[o+p+1]^=f}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=t7[o],l=r4(s,i,a),d=s4(s,i,a),u=e7[o];s=t[u],i=t[u+1],t[u]=l,t[u+1]=d}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Fpe[r],t[1]^=zpe[r]}Lo(n)}let Vpe=class s7 extends sN{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Il(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Zw(this.state)}clone(){return this._cloneInto()}keccak(){ud(this.state32),Hpe(this.state32,this.rounds),ud(this.state32),this.posOut=0,this.pos=0}update(e){au(this),e=xa(e),Uo(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){au(this,!1),Uo(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Il(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(bR(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Lo(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new s7(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const Wpe=(t,e,n)=>ab(()=>new Vpe(e,t,n)),qpe=Wpe(1,136,256/8);function Kpe(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),l=r?4:0,d=r?0:4;t.setUint32(e+l,o,r),t.setUint32(e+d,a,r)}function Gpe(t,e,n){return t&e^~t&n}function Ype(t,e,n){return t&e^t&n^e&n}let i7=class extends sN{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=eS(this.buffer)}update(e){au(this),e=xa(e),Uo(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const l=eS(e);for(;s<=i-o;o+=s)this.process(l,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){au(this),bR(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Lo(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let h=o;h<s;h++)n[h]=0;Kpe(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=eS(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const Yl=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ws=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),xs=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Qpe=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ql=new Uint32Array(64);let Jpe=class extends i7{constructor(e=32){super(64,e,8,!1),this.A=Yl[0]|0,this.B=Yl[1]|0,this.C=Yl[2]|0,this.D=Yl[3]|0,this.E=Yl[4]|0,this.F=Yl[5]|0,this.G=Yl[6]|0,this.H=Yl[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:l}=this;return[e,n,r,s,i,o,a,l]}set(e,n,r,s,i,o,a,l){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(e,n){for(let h=0;h<16;h++,n+=4)Ql[h]=e.getUint32(n,!1);for(let h=16;h<64;h++){const f=Ql[h-15],p=Ql[h-2],m=Da(f,7)^Da(f,18)^f>>>3,g=Da(p,17)^Da(p,19)^p>>>10;Ql[h]=g+Ql[h-7]+m+Ql[h-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:l,G:d,H:u}=this;for(let h=0;h<64;h++){const f=Da(a,6)^Da(a,11)^Da(a,25),p=u+f+Gpe(a,l,d)+Qpe[h]+Ql[h]|0,m=(Da(r,2)^Da(r,13)^Da(r,22))+Ype(r,s,i)|0;u=d,d=l,l=a,a=o+p|0,o=i,i=s,s=r,r=p+m|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,l,d,u)}roundClean(){Lo(Ql)}destroy(){this.set(0,0,0,0,0,0,0,0),Lo(this.buffer)}};const o7=Q9(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Zpe=o7[0],Xpe=o7[1],Jl=new Uint32Array(80),Zl=new Uint32Array(80);let ER=class extends i7{constructor(e=64){super(128,e,16,!1),this.Ah=xs[0]|0,this.Al=xs[1]|0,this.Bh=xs[2]|0,this.Bl=xs[3]|0,this.Ch=xs[4]|0,this.Cl=xs[5]|0,this.Dh=xs[6]|0,this.Dl=xs[7]|0,this.Eh=xs[8]|0,this.El=xs[9]|0,this.Fh=xs[10]|0,this.Fl=xs[11]|0,this.Gh=xs[12]|0,this.Gl=xs[13]|0,this.Hh=xs[14]|0,this.Hl=xs[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:l,Eh:d,El:u,Fh:h,Fl:f,Gh:p,Gl:m,Hh:g,Hl:w}=this;return[e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w]}set(e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=l|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=f|0,this.Gh=p|0,this.Gl=m|0,this.Hh=g|0,this.Hl=w|0}process(e,n){for(let x=0;x<16;x++,n+=4)Jl[x]=e.getUint32(n),Zl[x]=e.getUint32(n+=4);for(let x=16;x<80;x++){const v=Jl[x-15]|0,E=Zl[x-15]|0,R=ld(v,E,1)^ld(v,E,8)^e4(v,E,7),S=dd(v,E,1)^dd(v,E,8)^t4(v,E,7),C=Jl[x-2]|0,N=Zl[x-2]|0,T=ld(C,N,19)^cy(C,N,61)^e4(C,N,6),$=dd(C,N,19)^ly(C,N,61)^t4(C,N,6),U=_pe(S,$,Zl[x-7],Zl[x-16]),H=kpe(U,R,T,Jl[x-7],Jl[x-16]);Jl[x]=H|0,Zl[x]=U|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:l,Dh:d,Dl:u,Eh:h,El:f,Fh:p,Fl:m,Gh:g,Gl:w,Hh:b,Hl:y}=this;for(let x=0;x<80;x++){const v=ld(h,f,14)^ld(h,f,18)^cy(h,f,41),E=dd(h,f,14)^dd(h,f,18)^ly(h,f,41),R=h&p^~h&g,S=f&m^~f&w,C=Ipe(y,E,S,Xpe[x],Zl[x]),N=Rpe(C,b,v,R,Zpe[x],Jl[x]),T=C|0,$=ld(r,s,28)^cy(r,s,34)^cy(r,s,39),U=dd(r,s,28)^ly(r,s,34)^ly(r,s,39),H=r&i^r&a^i&a,K=s&o^s&l^o&l;b=g|0,y=w|0,g=p|0,w=m|0,p=h|0,m=f|0,{h,l:f}=Yo(d|0,u|0,N|0,T|0),d=a|0,u=l|0,a=i|0,l=o|0,i=r|0,o=s|0;const I=gR(T,U,K);r=yR(I,N,$,H),s=I|0}({h:r,l:s}=Yo(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Yo(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l}=Yo(this.Ch|0,this.Cl|0,a|0,l|0),{h:d,l:u}=Yo(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:f}=Yo(this.Eh|0,this.El|0,h|0,f|0),{h:p,l:m}=Yo(this.Fh|0,this.Fl|0,p|0,m|0),{h:g,l:w}=Yo(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:y}=Yo(this.Hh|0,this.Hl|0,b|0,y|0),this.set(r,s,i,o,a,l,d,u,h,f,p,m,g,w,b,y)}roundClean(){Lo(Jl,Zl)}destroy(){Lo(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},eme=class extends ER{constructor(){super(48),this.Ah=ws[0]|0,this.Al=ws[1]|0,this.Bh=ws[2]|0,this.Bl=ws[3]|0,this.Ch=ws[4]|0,this.Cl=ws[5]|0,this.Dh=ws[6]|0,this.Dl=ws[7]|0,this.Eh=ws[8]|0,this.El=ws[9]|0,this.Fh=ws[10]|0,this.Fl=ws[11]|0,this.Gh=ws[12]|0,this.Gl=ws[13]|0,this.Hh=ws[14]|0,this.Hl=ws[15]|0}};const bs=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class tme extends ER{constructor(){super(32),this.Ah=bs[0]|0,this.Al=bs[1]|0,this.Bh=bs[2]|0,this.Bl=bs[3]|0,this.Ch=bs[4]|0,this.Cl=bs[5]|0,this.Dh=bs[6]|0,this.Dl=bs[7]|0,this.Eh=bs[8]|0,this.El=bs[9]|0,this.Fh=bs[10]|0,this.Fl=bs[11]|0,this.Gh=bs[12]|0,this.Gl=bs[13]|0,this.Hh=bs[14]|0,this.Hl=bs[15]|0}}const iN=ab(()=>new Jpe),nme=ab(()=>new ER),rme=ab(()=>new eme),sme=ab(()=>new tme),ime=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Nr=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),$e=new Uint32Array(32);function Xl(t,e,n,r,s,i){const o=s[i],a=s[i+1];let l=$e[2*t],d=$e[2*t+1],u=$e[2*e],h=$e[2*e+1],f=$e[2*n],p=$e[2*n+1],m=$e[2*r],g=$e[2*r+1],w=gR(l,u,o);d=yR(w,d,h,a),l=w|0,{Dh:g,Dl:m}={Dh:g^d,Dl:m^l},{Dh:g,Dl:m}={Dh:Epe(g,m),Dl:Cpe(g)},{h:p,l:f}=Yo(p,f,g,m),{Bh:h,Bl:u}={Bh:h^p,Bl:u^f},{Bh:h,Bl:u}={Bh:ld(h,u,24),Bl:dd(h,u,24)},$e[2*t]=l,$e[2*t+1]=d,$e[2*e]=u,$e[2*e+1]=h,$e[2*n]=f,$e[2*n+1]=p,$e[2*r]=m,$e[2*r+1]=g}function ed(t,e,n,r,s,i){const o=s[i],a=s[i+1];let l=$e[2*t],d=$e[2*t+1],u=$e[2*e],h=$e[2*e+1],f=$e[2*n],p=$e[2*n+1],m=$e[2*r],g=$e[2*r+1],w=gR(l,u,o);d=yR(w,d,h,a),l=w|0,{Dh:g,Dl:m}={Dh:g^d,Dl:m^l},{Dh:g,Dl:m}={Dh:ld(g,m,16),Dl:dd(g,m,16)},{h:p,l:f}=Yo(p,f,g,m),{Bh:h,Bl:u}={Bh:h^p,Bl:u^f},{Bh:h,Bl:u}={Bh:cy(h,u,63),Bl:ly(h,u,63)},$e[2*t]=l,$e[2*t+1]=d,$e[2*e]=u,$e[2*e+1]=h,$e[2*n]=f,$e[2*n+1]=p,$e[2*r]=m,$e[2*r+1]=g}function ome(t,e={},n,r,s){if(Il(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class ame extends sN{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Il(e),Il(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=Zw(this.buffer)}update(e){au(this),e=xa(e),Uo(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let l=0;l<i;){this.pos===n&&(ud(s),this.compress(s,0,!1),ud(s),this.pos=0);const d=Math.min(n-this.pos,i-l),u=o+l;if(d===n&&!(u%4)&&l+d<i){const h=new Uint32Array(a,u,Math.floor((i-l)/4));ud(h);for(let f=0;l+n<i;f+=s.length,l+=n)this.length+=n,this.compress(h,f,!1);ud(h);continue}r.set(e.subarray(l,l+d),this.pos),this.pos+=d,this.length+=d,l+=d}return this}digestInto(e){au(this),bR(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Lo(this.buffer.subarray(n)),ud(r),this.compress(r,0,!0),ud(r);const s=Zw(e);this.get().forEach((i,o)=>s[o]=Fc(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class cme extends ame{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=Nr[0]|0,this.v0h=Nr[1]|0,this.v1l=Nr[2]|0,this.v1h=Nr[3]|0,this.v2l=Nr[4]|0,this.v2h=Nr[5]|0,this.v3l=Nr[6]|0,this.v3h=Nr[7]|0,this.v4l=Nr[8]|0,this.v4h=Nr[9]|0,this.v5l=Nr[10]|0,this.v5h=Nr[11]|0,this.v6l=Nr[12]|0,this.v6h=Nr[13]|0,this.v7l=Nr[14]|0,this.v7h=Nr[15]|0,ome(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=xa(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=xa(i);const a=Zw(i);this.v4l^=Fc(a[0]),this.v4h^=Fc(a[1]),this.v5l^=Fc(a[2]),this.v5h^=Fc(a[3])}if(s!==void 0){s=xa(s);const a=Zw(s);this.v6l^=Fc(a[0]),this.v6h^=Fc(a[1]),this.v7l^=Fc(a[2]),this.v7h^=Fc(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:l,v4l:d,v4h:u,v5l:h,v5h:f,v6l:p,v6h:m,v7l:g,v7h:w}=this;return[e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w]}set(e,n,r,s,i,o,a,l,d,u,h,f,p,m,g,w){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=l|0,this.v4l=d|0,this.v4h=u|0,this.v5l=h|0,this.v5h=f|0,this.v6l=p|0,this.v6h=m|0,this.v7l=g|0,this.v7h=w|0}compress(e,n,r){this.get().forEach((l,d)=>$e[d]=l),$e.set(Nr,16);let{h:s,l:i}=Y9(BigInt(this.length));$e[24]=Nr[8]^i,$e[25]=Nr[9]^s,r&&($e[28]=~$e[28],$e[29]=~$e[29]);let o=0;const a=ime;for(let l=0;l<12;l++)Xl(0,4,8,12,e,n+2*a[o++]),ed(0,4,8,12,e,n+2*a[o++]),Xl(1,5,9,13,e,n+2*a[o++]),ed(1,5,9,13,e,n+2*a[o++]),Xl(2,6,10,14,e,n+2*a[o++]),ed(2,6,10,14,e,n+2*a[o++]),Xl(3,7,11,15,e,n+2*a[o++]),ed(3,7,11,15,e,n+2*a[o++]),Xl(0,5,10,15,e,n+2*a[o++]),ed(0,5,10,15,e,n+2*a[o++]),Xl(1,6,11,12,e,n+2*a[o++]),ed(1,6,11,12,e,n+2*a[o++]),Xl(2,7,8,13,e,n+2*a[o++]),ed(2,7,8,13,e,n+2*a[o++]),Xl(3,4,9,14,e,n+2*a[o++]),ed(3,4,9,14,e,n+2*a[o++]);this.v0l^=$e[0]^$e[16],this.v0h^=$e[1]^$e[17],this.v1l^=$e[2]^$e[18],this.v1h^=$e[3]^$e[19],this.v2l^=$e[4]^$e[20],this.v2h^=$e[5]^$e[21],this.v3l^=$e[6]^$e[22],this.v3h^=$e[7]^$e[23],this.v4l^=$e[8]^$e[24],this.v4h^=$e[9]^$e[25],this.v5l^=$e[10]^$e[26],this.v5h^=$e[11]^$e[27],this.v6l^=$e[12]^$e[28],this.v6h^=$e[13]^$e[29],this.v7l^=$e[14]^$e[30],this.v7h^=$e[15]^$e[31],Lo($e)}destroy(){this.destroyed=!0,Lo(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const lme=Dpe(t=>new cme(t)),dme="https://rpc.walletconnect.org/v1";function a7(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(qpe(n)).toString("hex")}async function ume(t,e,n,r,s,i){switch(n.t){case"eip191":return await hme(t,e,n.s);case"eip1271":return await fme(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function hme(t,e,n){return(await que({hash:a7(e),signature:n})).toLowerCase()===t.toLowerCase()}async function fme(t,e,n,r,s,i){const o=Yh(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",l="0000000000000000000000000000000000000000000000000000000000000040",d=n.substring(2),u=(d.length/2).toString(16).padStart(64,"0"),h=(e.startsWith("0x")?e:a7(e)).substring(2),f=a+h+l+u+d,p=await fetch(`${i||dme}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:pme(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:f},"latest"]})}),{result:m}=await p.json();return m?m.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function pme(){return Date.now()+Math.floor(Math.random()*1e3)}function mme(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Jg.encode(i)}function gme(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=lme(r,{dkLen:32});return Jg.encode(s)}function i4(t){const e=new Uint8Array(iN(yme(t)));return Jg.encode(e)}function yme(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function o4(t){const e=Buffer.from(t,"base64"),n=Ihe(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=vhe(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=sme(i);return Lhe.encode(o).replace(/=+$/,"")}function tS(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function wme(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(tS(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(tS(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(tS(r.length)),s.push(r);const i=Buffer.concat(s),o=iN(i);return Buffer.from(o).toString("hex").toUpperCase()}var xme=Object.defineProperty,bme=Object.defineProperties,vme=Object.getOwnPropertyDescriptors,a4=Object.getOwnPropertySymbols,Eme=Object.prototype.hasOwnProperty,Cme=Object.prototype.propertyIsEnumerable,c4=(t,e,n)=>e in t?xme(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nme=(t,e)=>{for(var n in e||(e={}))Eme.call(e,n)&&c4(t,n,e[n]);if(a4)for(var n of a4(e))Cme.call(e,n)&&c4(t,n,e[n]);return t},Ame=(t,e)=>bme(t,vme(e));const Sme="did:pkh:",CR=t=>t==null?void 0:t.split(":"),Tme=t=>{const e=t&&CR(t);if(e)return t.includes(Sme)?e[3]:e[1]},a_=t=>{const e=t&&CR(t);if(e)return e[2]+":"+e[3]},kE=t=>{const e=t&&CR(t);if(e)return e.pop()};async function l4(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=c7(s,s.iss),o=kE(s.iss);return await ume(o,i,r,a_(s.iss),n)}const c7=(t,e)=>{const n=`${t.domain} wants you to sign in with your Ethereum account:`,r=kE(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${Tme(e)}`,l=`Nonce: ${t.nonce}`,d=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,h=t.nbf?`Not Before: ${t.nbf}`:void 0,f=t.requestId?`Request ID: ${t.requestId}`:void 0,p=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,m=h1(t.resources);if(m){const g=ex(m);s=Mme(s,g)}return[n,r,"",s,"",i,o,a,l,d,u,h,f,p].filter(g=>g!=null).join(`
`)};function _me(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function kme(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function wf(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function Ime(t,e,n,r={}){return n==null||n.sort((s,i)=>s.localeCompare(i)),{att:{[t]:Rme(e,n,r)}}}function Rme(t,e,n={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function l7(t){return wf(t),`urn:recap:${_me(t).replace(/=/g,"")}`}function ex(t){const e=kme(t.replace("urn:recap:",""));return wf(e),e}function jme(t,e,n){const r=Ime(t,e,n);return l7(r)}function Pme(t){return t&&t.includes("urn:recap:")}function Ome(t,e){const n=ex(t),r=ex(e),s=Dme(n,r);return l7(s)}function Dme(t,e){wf(t),wf(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,l)=>a.localeCompare(l)).forEach(a=>{var l,d;r.att[s]=Ame(Nme({},r.att[s]),{[a]:((l=t.att[s])==null?void 0:l[a])||((d=e.att[s])==null?void 0:d[a])})})}),r}function Mme(t="",e){wf(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const l=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));l.sort((h,f)=>h.action.localeCompare(f.action));const d={};l.forEach(h=>{d[h.ability]||(d[h.ability]=[]),d[h.ability].push(h.action)});const u=Object.keys(d).map(h=>(s++,`(${s}) '${h}': '${d[h].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function d4(t){var e;const n=ex(t);wf(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function u4(t){const e=ex(t);wf(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function h1(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return Pme(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function d7(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function c_(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function nS(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function gi(t,...e){if(!d7(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function h4(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ume(t,e){gi(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function eu(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function _g(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Lme(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const Bme=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function $me(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function l_(t){if(typeof t=="string")t=$me(t);else if(d7(t))t=d_(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function Fme(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function zme(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const Hme=(t,e)=>{function n(r,...s){if(gi(r),!Bme)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const d=s[0];if(!d)throw new Error("nonce / iv required");t.varSizeNonce?gi(d):gi(d,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&gi(s[1]);const o=e(r,...s),a=(d,u)=>{if(u!==void 0){if(d!==2)throw new Error("cipher output not supported");gi(u)}};let l=!1;return{encrypt(d,u){if(l)throw new Error("cannot encrypt() twice with same key + nonce");return l=!0,gi(d),a(o.encrypt.length,u),o.encrypt(d,u)},decrypt(d,u){if(gi(d),i&&d.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(d,u)}}}return Object.assign(n,t),n};function f4(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!Wme(e))throw new Error("invalid output, must be aligned");return e}function p4(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function Vme(t,e,n){c_(n);const r=new Uint8Array(16),s=Lme(r);return p4(s,0,BigInt(e),n),p4(s,8,BigInt(t),n),r}function Wme(t){return t.byteOffset%4===0}function d_(t){return Uint8Array.from(t)}const u7=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),qme=u7("expand 16-byte k"),Kme=u7("expand 32-byte k"),Gme=eu(qme),Yme=eu(Kme);function rn(t,e){return t<<e|t>>>32-e}function u_(t){return t.byteOffset%4===0}const mv=64,Qme=16,h7=2**32-1,m4=new Uint32Array;function Jme(t,e,n,r,s,i,o,a){const l=s.length,d=new Uint8Array(mv),u=eu(d),h=u_(s)&&u_(i),f=h?eu(s):m4,p=h?eu(i):m4;for(let m=0;m<l;o++){if(t(e,n,r,u,o,a),o>=h7)throw new Error("arx: counter overflow");const g=Math.min(mv,l-m);if(h&&g===mv){const w=m/4;if(m%4!==0)throw new Error("arx: invalid block position");for(let b=0,y;b<Qme;b++)y=w+b,p[y]=f[y]^u[b];m+=mv;continue}for(let w=0,b;w<g;w++)b=m+w,i[b]=s[b]^d[w];m+=g}}function Zme(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=Fme({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return nS(s),nS(o),c_(i),c_(n),(a,l,d,u,h=0)=>{gi(a),gi(l),gi(d);const f=d.length;if(u===void 0&&(u=new Uint8Array(f)),gi(u),nS(h),h<0||h>=h7)throw new Error("arx: counter overflow");if(u.length<f)throw new Error(`arx: output (${u.length}) is shorter than data (${f})`);const p=[];let m=a.length,g,w;if(m===32)p.push(g=d_(a)),w=Yme;else if(m===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),w=Gme,p.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${m}`);u_(l)||p.push(l=d_(l));const b=eu(g);if(r){if(l.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(w,b,eu(l.subarray(0,16)),b),l=l.subarray(16)}const y=16-s;if(y!==l.length)throw new Error(`arx: nonce must be ${y} or 16 bytes`);if(y!==12){const v=new Uint8Array(12);v.set(l,i?0:12-l.length),l=v,p.push(l)}const x=eu(l);return Jme(t,w,b,x,d,u,h,o),_g(...p),u}}const Gr=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class Xme{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=l_(e),gi(e,32);const n=Gr(e,0),r=Gr(e,2),s=Gr(e,4),i=Gr(e,6),o=Gr(e,8),a=Gr(e,10),l=Gr(e,12),d=Gr(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|l<<5)&8065,this.r[8]=(l>>>8|d<<8)&8191,this.r[9]=d>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Gr(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],l=o[1],d=o[2],u=o[3],h=o[4],f=o[5],p=o[6],m=o[7],g=o[8],w=o[9],b=Gr(e,n+0),y=Gr(e,n+2),x=Gr(e,n+4),v=Gr(e,n+6),E=Gr(e,n+8),R=Gr(e,n+10),S=Gr(e,n+12),C=Gr(e,n+14);let N=i[0]+(b&8191),T=i[1]+((b>>>13|y<<3)&8191),$=i[2]+((y>>>10|x<<6)&8191),U=i[3]+((x>>>7|v<<9)&8191),H=i[4]+((v>>>4|E<<12)&8191),K=i[5]+(E>>>1&8191),I=i[6]+((E>>>14|R<<2)&8191),j=i[7]+((R>>>11|S<<5)&8191),F=i[8]+((S>>>8|C<<8)&8191),P=i[9]+(C>>>5|s),L=0,B=L+N*a+T*(5*w)+$*(5*g)+U*(5*m)+H*(5*p);L=B>>>13,B&=8191,B+=K*(5*f)+I*(5*h)+j*(5*u)+F*(5*d)+P*(5*l),L+=B>>>13,B&=8191;let V=L+N*l+T*a+$*(5*w)+U*(5*g)+H*(5*m);L=V>>>13,V&=8191,V+=K*(5*p)+I*(5*f)+j*(5*h)+F*(5*u)+P*(5*d),L+=V>>>13,V&=8191;let X=L+N*d+T*l+$*a+U*(5*w)+H*(5*g);L=X>>>13,X&=8191,X+=K*(5*m)+I*(5*p)+j*(5*f)+F*(5*h)+P*(5*u),L+=X>>>13,X&=8191;let ae=L+N*u+T*d+$*l+U*a+H*(5*w);L=ae>>>13,ae&=8191,ae+=K*(5*g)+I*(5*m)+j*(5*p)+F*(5*f)+P*(5*h),L+=ae>>>13,ae&=8191;let ce=L+N*h+T*u+$*d+U*l+H*a;L=ce>>>13,ce&=8191,ce+=K*(5*w)+I*(5*g)+j*(5*m)+F*(5*p)+P*(5*f),L+=ce>>>13,ce&=8191;let ie=L+N*f+T*h+$*u+U*d+H*l;L=ie>>>13,ie&=8191,ie+=K*a+I*(5*w)+j*(5*g)+F*(5*m)+P*(5*p),L+=ie>>>13,ie&=8191;let Te=L+N*p+T*f+$*h+U*u+H*d;L=Te>>>13,Te&=8191,Te+=K*l+I*a+j*(5*w)+F*(5*g)+P*(5*m),L+=Te>>>13,Te&=8191;let ue=L+N*m+T*p+$*f+U*h+H*u;L=ue>>>13,ue&=8191,ue+=K*d+I*l+j*a+F*(5*w)+P*(5*g),L+=ue>>>13,ue&=8191;let Q=L+N*g+T*m+$*p+U*f+H*h;L=Q>>>13,Q&=8191,Q+=K*u+I*d+j*l+F*a+P*(5*w),L+=Q>>>13,Q&=8191;let xe=L+N*w+T*g+$*m+U*p+H*f;L=xe>>>13,xe&=8191,xe+=K*h+I*u+j*d+F*l+P*a,L+=xe>>>13,xe&=8191,L=(L<<2)+L|0,L=L+B|0,B=L&8191,L=L>>>13,V+=L,i[0]=B,i[1]=V,i[2]=X,i[3]=ae,i[4]=ce,i[5]=ie,i[6]=Te,i[7]=ue,i[8]=Q,i[9]=xe}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;_g(r)}update(e){h4(this),e=l_(e),gi(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){_g(this.h,this.r,this.buffer,this.pad)}digestInto(e){h4(this),Ume(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function ege(t){const e=(r,s)=>t(s).update(l_(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const tge=ege(t=>new Xme(t));function nge(t,e,n,r,s,i=20){let o=t[0],a=t[1],l=t[2],d=t[3],u=e[0],h=e[1],f=e[2],p=e[3],m=e[4],g=e[5],w=e[6],b=e[7],y=s,x=n[0],v=n[1],E=n[2],R=o,S=a,C=l,N=d,T=u,$=h,U=f,H=p,K=m,I=g,j=w,F=b,P=y,L=x,B=v,V=E;for(let ae=0;ae<i;ae+=2)R=R+T|0,P=rn(P^R,16),K=K+P|0,T=rn(T^K,12),R=R+T|0,P=rn(P^R,8),K=K+P|0,T=rn(T^K,7),S=S+$|0,L=rn(L^S,16),I=I+L|0,$=rn($^I,12),S=S+$|0,L=rn(L^S,8),I=I+L|0,$=rn($^I,7),C=C+U|0,B=rn(B^C,16),j=j+B|0,U=rn(U^j,12),C=C+U|0,B=rn(B^C,8),j=j+B|0,U=rn(U^j,7),N=N+H|0,V=rn(V^N,16),F=F+V|0,H=rn(H^F,12),N=N+H|0,V=rn(V^N,8),F=F+V|0,H=rn(H^F,7),R=R+$|0,V=rn(V^R,16),j=j+V|0,$=rn($^j,12),R=R+$|0,V=rn(V^R,8),j=j+V|0,$=rn($^j,7),S=S+U|0,P=rn(P^S,16),F=F+P|0,U=rn(U^F,12),S=S+U|0,P=rn(P^S,8),F=F+P|0,U=rn(U^F,7),C=C+H|0,L=rn(L^C,16),K=K+L|0,H=rn(H^K,12),C=C+H|0,L=rn(L^C,8),K=K+L|0,H=rn(H^K,7),N=N+T|0,B=rn(B^N,16),I=I+B|0,T=rn(T^I,12),N=N+T|0,B=rn(B^N,8),I=I+B|0,T=rn(T^I,7);let X=0;r[X++]=o+R|0,r[X++]=a+S|0,r[X++]=l+C|0,r[X++]=d+N|0,r[X++]=u+T|0,r[X++]=h+$|0,r[X++]=f+U|0,r[X++]=p+H|0,r[X++]=m+K|0,r[X++]=g+I|0,r[X++]=w+j|0,r[X++]=b+F|0,r[X++]=y+P|0,r[X++]=x+L|0,r[X++]=v+B|0,r[X++]=E+V|0}const rge=Zme(nge,{counterRight:!1,counterLength:4,allowShortKeys:!1}),sge=new Uint8Array(16),g4=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(sge.subarray(n))},ige=new Uint8Array(32);function y4(t,e,n,r,s){const i=t(e,n,ige),o=tge.create(i);s&&g4(o,s),g4(o,r);const a=Vme(r.length,s?s.length:0,!0);o.update(a);const l=o.digest();return _g(i,a),l}const oge=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=f4(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const l=y4(t,e,n,a,r);return i.set(l,o),_g(l),i},decrypt(s,i){i=f4(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),l=y4(t,e,n,o,r);if(!zme(a,l))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),_g(l),i}}),f7=Hme({blockSize:64,nonceLength:12,tagLength:16},oge(rge));let p7=class extends sN{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,xR(e);const r=xa(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Lo(i)}update(e){return au(this),this.iHash.update(e),this}digestInto(e){au(this),Uo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const oN=(t,e,n)=>new p7(t,e).update(n).digest();oN.create=(t,e)=>new p7(t,e);function age(t,e,n){return xR(t),n===void 0&&(n=new Uint8Array(t.outputLen)),oN(t,xa(n),xa(e))}const rS=Uint8Array.from([0]),w4=Uint8Array.of();function cge(t,e,n,r=32){xR(t),Il(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=w4);const o=new Uint8Array(i*s),a=oN.create(t,e),l=a._cloneInto(),d=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)rS[0]=u+1,l.update(u===0?w4:d).update(n).update(rS).digestInto(d),o.set(d,s*u),a._cloneInto(l);return a.destroy(),l.destroy(),Lo(d,rS),o.slice(0,r)}const lge=(t,e,n,r,s)=>cge(t,age(t,e,n),r,s),aN=iN,NR=BigInt(0),h_=BigInt(1);function IE(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function gv(t){const e=t.toString(16);return e.length&1?"0"+e:e}function m7(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?NR:BigInt("0x"+t)}function cN(t){return m7(Xw(t))}function RE(t){return Uo(t),m7(Xw(Uint8Array.from(t).reverse()))}function AR(t,e){return vR(t.toString(16).padStart(e*2,"0"))}function SR(t,e){return AR(t,e).reverse()}function pi(t,e,n){let r;if(typeof e=="string")try{r=vR(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(wR(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const sS=t=>typeof t=="bigint"&&NR<=t;function dge(t,e,n){return sS(t)&&sS(e)&&sS(n)&&e<=t&&t<n}function f_(t,e,n,r){if(!dge(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function uge(t){let e;for(e=0;t>NR;t>>=h_,e+=1);return e}const lN=t=>(h_<<BigInt(t))-h_;function hge(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=f=>new Uint8Array(f),s=f=>Uint8Array.of(f);let i=r(t),o=r(t),a=0;const l=()=>{i.fill(1),o.fill(0),a=0},d=(...f)=>n(o,i,...f),u=(f=r(0))=>{o=d(s(0),f),i=d(),f.length!==0&&(o=d(s(1),f),i=d())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const p=[];for(;f<e;){i=d();const m=i.slice();p.push(m),f+=i.length}return mh(...p)};return(f,p)=>{l(),u(f);let m;for(;!(m=p(h()));)u();return l(),m}}function dN(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const l=typeof a;if(l!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${l}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function x4(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Ei=BigInt(0),Gs=BigInt(1),gh=BigInt(2),fge=BigInt(3),g7=BigInt(4),y7=BigInt(5),w7=BigInt(8);function No(t,e){const n=t%e;return n>=Ei?n:e+n}function Ko(t,e,n){let r=t;for(;e-- >Ei;)r*=r,r%=n;return r}function b4(t,e){if(t===Ei)throw new Error("invert: expected non-zero number");if(e<=Ei)throw new Error("invert: expected positive modulus, got "+e);let n=No(t,e),r=e,s=Ei,i=Gs;for(;n!==Ei;){const o=r/n,a=r%n,l=s-i*o;r=n,n=a,s=i,i=l}if(r!==Gs)throw new Error("invert: does not exist");return No(s,e)}function x7(t,e){const n=(t.ORDER+Gs)/g7,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function pge(t,e){const n=(t.ORDER-y7)/w7,r=t.mul(e,gh),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,gh),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function mge(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-Gs,n=0;for(;e%gh===Ei;)e/=gh,n++;let r=gh;const s=e0(t);for(;v4(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return x7;let i=s.pow(r,e);const o=(e+Gs)/gh;return function(a,l){if(a.is0(l))return l;if(v4(a,l)!==1)throw new Error("Cannot find square root");let d=n,u=a.mul(a.ONE,i),h=a.pow(l,e),f=a.pow(l,o);for(;!a.eql(h,a.ONE);){if(a.is0(h))return a.ZERO;let p=1,m=a.sqr(h);for(;!a.eql(m,a.ONE);)if(p++,m=a.sqr(m),p===d)throw new Error("Cannot find square root");const g=Gs<<BigInt(d-p-1),w=a.pow(u,g);d=p,u=a.sqr(w),h=a.mul(h,u),f=a.mul(f,w)}return f}}function gge(t){return t%g7===fge?x7:t%w7===y7?pge:mge(t)}const yge=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function wge(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=yge.reduce((r,s)=>(r[s]="function",r),e);return dN(t,n),t}function xge(t,e,n){if(n<Ei)throw new Error("invalid exponent, negatives unsupported");if(n===Ei)return t.ONE;if(n===Gs)return e;let r=t.ONE,s=e;for(;n>Ei;)n&Gs&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Gs;return r}function b7(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,l)=>t.is0(a)?o:(r[l]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,l)=>t.is0(a)?o:(r[l]=t.mul(o,r[l]),t.mul(o,a)),i),r}function v4(t,e){const n=(t.ORDER-Gs)/gh,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function bge(t,e){e!==void 0&&Il(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function e0(t,e,n=!1,r={}){if(t<=Ei)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const u=e;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(n=u.isLE)}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=bge(t,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let l;const d=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:a,MASK:lN(o),ZERO:Ei,ONE:Gs,create:u=>No(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return Ei<=u&&u<t},is0:u=>u===Ei,isValidNot0:u=>!d.is0(u)&&d.isValid(u),isOdd:u=>(u&Gs)===Gs,neg:u=>No(-u,t),eql:(u,h)=>u===h,sqr:u=>No(u*u,t),add:(u,h)=>No(u+h,t),sub:(u,h)=>No(u-h,t),mul:(u,h)=>No(u*h,t),pow:(u,h)=>xge(d,u,h),div:(u,h)=>No(u*b4(h,t),t),sqrN:u=>u*u,addN:(u,h)=>u+h,subN:(u,h)=>u-h,mulN:(u,h)=>u*h,inv:u=>b4(u,t),sqrt:i||(u=>(l||(l=gge(t)),l(d,u))),toBytes:u=>n?SR(u,a):AR(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return n?RE(u):cN(u)},invertBatch:u=>b7(d,u),cmov:(u,h,f)=>f?h:u});return Object.freeze(d)}function v7(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function E7(t){const e=v7(t);return e+Math.ceil(e/2)}function vge(t,e,n=!1){const r=t.length,s=v7(e),i=E7(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?RE(t):cN(t),a=No(o,e-Gs)+Gs;return n?SR(a,s):AR(a,s)}const kg=BigInt(0),yh=BigInt(1);function Ty(t,e){const n=e.negate();return t?n:e}function Ege(t,e,n){const r=i=>i.pz,s=b7(t.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(t.fromAffine)}function C7(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function iS(t,e){C7(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=lN(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function E4(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),l=t>>o;a>r&&(a-=i,l+=yh);const d=e*r,u=d+Math.abs(a)-1,h=a===0,f=a<0,p=e%2!==0;return{nextN:l,offset:u,isZero:h,isNeg:f,isNegF:p,offsetF:d}}function Cge(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function Nge(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const oS=new WeakMap,N7=new WeakMap;function aS(t){return N7.get(t)||1}function C4(t){if(t!==kg)throw new Error("invalid wNAF")}function Age(t,e){return{constTimeNegate:Ty,hasPrecomputes(n){return aS(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>kg;)r&yh&&(s=s.add(i)),i=i.double(),r>>=yh;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=iS(r,e),o=[];let a=n,l=a;for(let d=0;d<s;d++){l=a,o.push(l);for(let u=1;u<i;u++)l=l.add(a),o.push(l);a=l.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=iS(n,e);for(let l=0;l<a.windows;l++){const{nextN:d,offset:u,isZero:h,isNeg:f,isNegF:p,offsetF:m}=E4(s,l,a);s=d,h?o=o.add(Ty(p,r[m])):i=i.add(Ty(f,r[u]))}return C4(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=iS(n,e);for(let a=0;a<o.windows&&s!==kg;a++){const{nextN:l,offset:d,isZero:u,isNeg:h}=E4(s,a,o);if(s=l,!u){const f=r[d];i=i.add(h?f.negate():f)}}return C4(s),i},getPrecomputes(n,r,s){let i=oS.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),oS.set(r,i))),i},wNAFCached(n,r,s){const i=aS(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=aS(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){C7(r,e),N7.set(n,r),oS.delete(n)}}}function Sge(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>kg||r>kg;)n&yh&&(i=i.add(s)),r&yh&&(o=o.add(s)),s=s.double(),n>>=yh,r>>=yh;return{p1:i,p2:o}}function Tge(t,e,n,r){Cge(n,t),Nge(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=uge(BigInt(s));let l=1;a>12?l=a-3:a>4?l=a-2:a>0&&(l=2);const d=lN(l),u=new Array(Number(d)+1).fill(o),h=Math.floor((e.BITS-1)/l)*l;let f=o;for(let p=h;p>=0;p-=l){u.fill(o);for(let g=0;g<i;g++){const w=r[g],b=Number(w>>BigInt(p)&d);u[b]=u[b].add(n[g])}let m=o;for(let g=u.length-1,w=o;g>0;g--)w=w.add(u[g]),m=m.add(w);if(f=f.add(m),p!==0)for(let g=0;g<l;g++)f=f.double()}return f}function N4(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return wge(e),e}else return e0(t)}function _ge(t,e,n={}){if(!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const o of["p","n","h"]){const a=e[o];if(!(typeof a=="bigint"&&a>kg))throw new Error(`CURVE.${o} must be positive bigint`)}const r=N4(e.p,n.Fp),s=N4(e.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const B0=BigInt(0),ep=BigInt(1),yv=BigInt(2);function kge(t){return dN(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function Ige(t){const e=kge(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const l=o||Xg,d=a?255:448,u=a?32:56,h=BigInt(a?9:5),f=BigInt(a?121665:39081),p=a?yv**BigInt(254):yv**BigInt(447),m=a?BigInt(8)*yv**BigInt(251)-ep:BigInt(4)*yv**BigInt(445)-ep,g=p+m+ep,w=N=>No(N,n),b=y(h);function y(N){return SR(w(N),u)}function x(N){const T=pi("u coordinate",N,u);return a&&(T[31]&=127),w(RE(T))}function v(N){return RE(s(pi("scalar",N,u)))}function E(N,T){const $=C(x(T),v(N));if($===B0)throw new Error("invalid private or public key received");return y($)}function R(N){return E(N,b)}function S(N,T,$){const U=w(N*(T-$));return T=w(T-U),$=w($+U),{x_2:T,x_3:$}}function C(N,T){f_("u",N,B0,n),f_("scalar",T,p,g);const $=T,U=N;let H=ep,K=B0,I=N,j=ep,F=B0;for(let L=BigInt(d-1);L>=B0;L--){const B=$>>L&ep;F^=B,{x_2:H,x_3:I}=S(F,H,I),{x_2:K,x_3:j}=S(F,K,j),F=B;const V=H+K,X=w(V*V),ae=H-K,ce=w(ae*ae),ie=X-ce,Te=I+j,ue=I-j,Q=w(ue*V),xe=w(Te*ae),Pe=Q+xe,Y=Q-xe;I=w(Pe*Pe),j=w(U*w(Y*Y)),H=w(X*ce),K=w(ie*(X+w(f*ie)))}({x_2:H,x_3:I}=S(F,H,I)),{x_2:K,x_3:j}=S(F,K,j);const P=i(K);return w(H*P)}return{scalarMult:E,scalarMultBase:R,getSharedSecret:(N,T)=>E(N,T),getPublicKey:N=>R(N),utils:{randomPrivateKey:()=>l(u)},GuBytes:b.slice()}}BigInt(0);const Rge=BigInt(1),A4=BigInt(2),jge=BigInt(3),Pge=BigInt(5);BigInt(8);const A7={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Oge(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=A7.p,o=t*t%i*t%i,a=Ko(o,A4,i)*o%i,l=Ko(a,Rge,i)*t%i,d=Ko(l,Pge,i)*l%i,u=Ko(d,e,i)*d%i,h=Ko(u,n,i)*u%i,f=Ko(h,r,i)*h%i,p=Ko(f,s,i)*f%i,m=Ko(p,s,i)*f%i,g=Ko(m,e,i)*d%i;return{pow_p_5_8:Ko(g,A4,i)*t%i,b2:o}}function Dge(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const p_=(()=>{const t=A7.p;return Ige({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=Oge(e);return No(Ko(n,jge,t)*r,t)},adjustScalarBytes:Dge})})();function S4(t){t.lowS!==void 0&&IE("lowS",t.lowS),t.prehash!==void 0&&IE("prehash",t.prehash)}class Mge extends Error{constructor(e=""){super(e)}}const Qc={Err:Mge,_tlv:{encode:(t,e)=>{const{Err:n}=Qc;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=gv(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?gv(s.length/2|128):"";return gv(t)+i+s+e},decode(t,e){const{Err:n}=Qc;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const l=s&127;if(!l)throw new n("tlv.decode(long): indefinite length not supported");if(l>4)throw new n("tlv.decode(long): byte length is too big");const d=e.subarray(r,r+l);if(d.length!==l)throw new n("tlv.decode: length bytes not complete");if(d[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of d)o=o<<8|u;if(r+=l,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Qc;if(t<_y)throw new e("integer: negative integers are not allowed");let n=gv(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Qc;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return cN(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Qc,s=pi("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l}=r.decode(2,i),{v:d,l:u}=r.decode(2,l);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(d)}},hexFromSig(t){const{_tlv:e,_int:n}=Qc,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},_y=BigInt(0),ky=BigInt(1),Uge=BigInt(2),wv=BigInt(3),Lge=BigInt(4);function Bge(t,e,n){function r(s){const i=t.sqr(s),o=t.mul(i,s);return t.add(t.add(o,t.mul(s,e)),n)}return r}function S7(t,e,n){const{BYTES:r}=t;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=pi("private key",i);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const l=new Uint8Array(r);l.set(a,l.length-a.length),a=l}try{o=t.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function $ge(t,e={}){const{Fp:n,Fn:r}=_ge("weierstrass",t,e),{h:s,n:i}=t;dN(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!n.is0(t.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function l(C,N,T){const{x:$,y:U}=N.toAffine(),H=n.toBytes($);if(IE("isCompressed",T),T){a();const K=!n.isOdd(U);return mh(T7(K),H)}else return mh(Uint8Array.of(4),H,n.toBytes(U))}function d(C){Uo(C);const N=n.BYTES,T=N+1,$=2*N+1,U=C.length,H=C[0],K=C.subarray(1);if(U===T&&(H===2||H===3)){const I=n.fromBytes(K);if(!n.isValid(I))throw new Error("bad point: is not on curve, wrong x");const j=f(I);let F;try{F=n.sqrt(j)}catch(L){const B=L instanceof Error?": "+L.message:"";throw new Error("bad point: is not on curve, sqrt error"+B)}a();const P=n.isOdd(F);return(H&1)===1!==P&&(F=n.neg(F)),{x:I,y:F}}else if(U===$&&H===4){const I=n.fromBytes(K.subarray(N*0,N*1)),j=n.fromBytes(K.subarray(N*1,N*2));if(!p(I,j))throw new Error("bad point: is not on curve");return{x:I,y:j}}else throw new Error(`bad point: got length ${U}, expected compressed=${T} or uncompressed=${$}`)}const u=e.toBytes||l,h=e.fromBytes||d,f=Bge(n,t.a,t.b);function p(C,N){const T=n.sqr(N),$=f(C);return n.eql(T,$)}if(!p(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const m=n.mul(n.pow(t.a,wv),Lge),g=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(m,g)))throw new Error("bad curve params: a or b");function w(C,N,T=!1){if(!n.isValid(N)||T&&n.is0(N))throw new Error(`bad point coordinate ${C}`);return N}function b(C){if(!(C instanceof E))throw new Error("ProjectivePoint expected")}const y=x4((C,N)=>{const{px:T,py:$,pz:U}=C;if(n.eql(U,n.ONE))return{x:T,y:$};const H=C.is0();N==null&&(N=H?n.ONE:n.inv(U));const K=n.mul(T,N),I=n.mul($,N),j=n.mul(U,N);if(H)return{x:n.ZERO,y:n.ZERO};if(!n.eql(j,n.ONE))throw new Error("invZ was invalid");return{x:K,y:I}}),x=x4(C=>{if(C.is0()){if(e.allowInfinityPoint&&!n.is0(C.py))return;throw new Error("bad point: ZERO")}const{x:N,y:T}=C.toAffine();if(!n.isValid(N)||!n.isValid(T))throw new Error("bad point: x or y not field elements");if(!p(N,T))throw new Error("bad point: equation left != right");if(!C.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function v(C,N,T,$,U){return T=new E(n.mul(T.px,C),T.py,T.pz),N=Ty($,N),T=Ty(U,T),N.add(T)}class E{constructor(N,T,$){this.px=w("x",N),this.py=w("y",T,!0),this.pz=w("z",$),Object.freeze(this)}static fromAffine(N){const{x:T,y:$}=N||{};if(!N||!n.isValid(T)||!n.isValid($))throw new Error("invalid affine point");if(N instanceof E)throw new Error("projective point not allowed");return n.is0(T)&&n.is0($)?E.ZERO:new E(T,$,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(N){return Ege(E,"pz",N)}static fromBytes(N){return Uo(N),E.fromHex(N)}static fromHex(N){const T=E.fromAffine(h(pi("pointHex",N)));return T.assertValidity(),T}static fromPrivateKey(N){const T=S7(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return E.BASE.multiply(T(N))}static msm(N,T){return Tge(E,r,N,T)}precompute(N=8,T=!0){return S.setWindowSize(this,N),T||this.multiply(wv),this}_setWindowSize(N){this.precompute(N)}assertValidity(){x(this)}hasEvenY(){const{y:N}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(N)}equals(N){b(N);const{px:T,py:$,pz:U}=this,{px:H,py:K,pz:I}=N,j=n.eql(n.mul(T,I),n.mul(H,U)),F=n.eql(n.mul($,I),n.mul(K,U));return j&&F}negate(){return new E(this.px,n.neg(this.py),this.pz)}double(){const{a:N,b:T}=t,$=n.mul(T,wv),{px:U,py:H,pz:K}=this;let I=n.ZERO,j=n.ZERO,F=n.ZERO,P=n.mul(U,U),L=n.mul(H,H),B=n.mul(K,K),V=n.mul(U,H);return V=n.add(V,V),F=n.mul(U,K),F=n.add(F,F),I=n.mul(N,F),j=n.mul($,B),j=n.add(I,j),I=n.sub(L,j),j=n.add(L,j),j=n.mul(I,j),I=n.mul(V,I),F=n.mul($,F),B=n.mul(N,B),V=n.sub(P,B),V=n.mul(N,V),V=n.add(V,F),F=n.add(P,P),P=n.add(F,P),P=n.add(P,B),P=n.mul(P,V),j=n.add(j,P),B=n.mul(H,K),B=n.add(B,B),P=n.mul(B,V),I=n.sub(I,P),F=n.mul(B,L),F=n.add(F,F),F=n.add(F,F),new E(I,j,F)}add(N){b(N);const{px:T,py:$,pz:U}=this,{px:H,py:K,pz:I}=N;let j=n.ZERO,F=n.ZERO,P=n.ZERO;const L=t.a,B=n.mul(t.b,wv);let V=n.mul(T,H),X=n.mul($,K),ae=n.mul(U,I),ce=n.add(T,$),ie=n.add(H,K);ce=n.mul(ce,ie),ie=n.add(V,X),ce=n.sub(ce,ie),ie=n.add(T,U);let Te=n.add(H,I);return ie=n.mul(ie,Te),Te=n.add(V,ae),ie=n.sub(ie,Te),Te=n.add($,U),j=n.add(K,I),Te=n.mul(Te,j),j=n.add(X,ae),Te=n.sub(Te,j),P=n.mul(L,ie),j=n.mul(B,ae),P=n.add(j,P),j=n.sub(X,P),P=n.add(X,P),F=n.mul(j,P),X=n.add(V,V),X=n.add(X,V),ae=n.mul(L,ae),ie=n.mul(B,ie),X=n.add(X,ae),ae=n.sub(V,ae),ae=n.mul(L,ae),ie=n.add(ie,ae),V=n.mul(X,ie),F=n.add(F,V),V=n.mul(Te,ie),j=n.mul(ce,j),j=n.sub(j,V),V=n.mul(ce,X),P=n.mul(Te,P),P=n.add(P,V),new E(j,F,P)}subtract(N){return this.add(N.negate())}is0(){return this.equals(E.ZERO)}multiply(N){const{endo:T}=e;if(!r.isValidNot0(N))throw new Error("invalid scalar: out of range");let $,U;const H=K=>S.wNAFCached(this,K,E.normalizeZ);if(T){const{k1neg:K,k1:I,k2neg:j,k2:F}=T.splitScalar(N),{p:P,f:L}=H(I),{p:B,f:V}=H(F);U=L.add(V),$=v(T.beta,P,B,K,j)}else{const{p:K,f:I}=H(N);$=K,U=I}return E.normalizeZ([$,U])[0]}multiplyUnsafe(N){const{endo:T}=e,$=this;if(!r.isValid(N))throw new Error("invalid scalar: out of range");if(N===_y||$.is0())return E.ZERO;if(N===ky)return $;if(S.hasPrecomputes(this))return this.multiply(N);if(T){const{k1neg:U,k1:H,k2neg:K,k2:I}=T.splitScalar(N),{p1:j,p2:F}=Sge(E,$,H,I);return v(T.beta,j,F,U,K)}else return S.wNAFCachedUnsafe($,N)}multiplyAndAddUnsafe(N,T,$){const U=this.multiplyUnsafe(T).add(N.multiplyUnsafe($));return U.is0()?void 0:U}toAffine(N){return y(this,N)}isTorsionFree(){const{isTorsionFree:N}=e;return s===ky?!0:N?N(E,this):S.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:N}=e;return s===ky?this:N?N(E,this):this.multiplyUnsafe(s)}toBytes(N=!0){return IE("isCompressed",N),this.assertValidity(),u(E,this,N)}toRawBytes(N=!0){return this.toBytes(N)}toHex(N=!0){return Xw(this.toBytes(N))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}E.BASE=new E(t.Gx,t.Gy,n.ONE),E.ZERO=new E(n.ZERO,n.ONE,n.ZERO),E.Fp=n,E.Fn=r;const R=r.BITS,S=Age(E,e.endo?Math.ceil(R/2):R);return E}function T7(t){return Uint8Array.of(t?2:3)}function Fge(t,e,n={}){dN(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||Xg,s=e.hmac||(($,...U)=>oN(e.hash,$,mh(...U))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:l}=o;function d($){const U=a>>ky;return $>U}function u($){return d($)?o.neg($):$}function h($,U){if(!o.isValidNot0(U))throw new Error(`invalid signature ${$}: out of range 1..CURVE.n`)}class f{constructor(U,H,K){h("r",U),h("s",H),this.r=U,this.s=H,K!=null&&(this.recovery=K),Object.freeze(this)}static fromCompact(U){const H=o.BYTES,K=pi("compactSignature",U,H*2);return new f(o.fromBytes(K.subarray(0,H)),o.fromBytes(K.subarray(H,H*2)))}static fromDER(U){const{r:H,s:K}=Qc.toSig(pi("DER",U));return new f(H,K)}assertValidity(){}addRecoveryBit(U){return new f(this.r,this.s,U)}recoverPublicKey(U){const H=i.ORDER,{r:K,s:I,recovery:j}=this;if(j==null||![0,1,2,3].includes(j))throw new Error("recovery id invalid");if(a*Uge<H&&j>1)throw new Error("recovery id is ambiguous for h>1 curve");const F=j===2||j===3?K+a:K;if(!i.isValid(F))throw new Error("recovery id 2 or 3 invalid");const P=i.toBytes(F),L=t.fromHex(mh(T7((j&1)===0),P)),B=o.inv(F),V=x(pi("msgHash",U)),X=o.create(-V*B),ae=o.create(I*B),ce=t.BASE.multiplyUnsafe(X).add(L.multiplyUnsafe(ae));if(ce.is0())throw new Error("point at infinify");return ce.assertValidity(),ce}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new f(this.r,o.neg(this.s),this.recovery):this}toBytes(U){if(U==="compact")return mh(o.toBytes(this.r),o.toBytes(this.s));if(U==="der")return vR(Qc.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Xw(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Xw(this.toBytes("compact"))}}const p=S7(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),m={isValidPrivateKey($){try{return p($),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const $=a;return vge(r(E7($)),$)},precompute($=8,U=t.BASE){return U.precompute($,!1)}};function g($,U=!0){return t.fromPrivateKey($).toBytes(U)}function w($){if(typeof $=="bigint")return!1;if($ instanceof t)return!0;const U=pi("key",$).length,H=i.BYTES,K=H+1,I=2*H+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===K))return U===K||U===I}function b($,U,H=!0){if(w($)===!0)throw new Error("first arg must be private key");if(w(U)===!1)throw new Error("second arg must be public key");return t.fromHex(U).multiply(p($)).toBytes(H)}const y=e.bits2int||function($){if($.length>8192)throw new Error("input is too large");const U=cN($),H=$.length*8-l;return H>0?U>>BigInt(H):U},x=e.bits2int_modN||function($){return o.create(y($))},v=lN(l);function E($){return f_("num < 2^"+l,$,_y,v),o.toBytes($)}function R($,U,H=S){if(["recovered","canonical"].some(ce=>ce in H))throw new Error("sign() legacy options not supported");const{hash:K}=e;let{lowS:I,prehash:j,extraEntropy:F}=H;I==null&&(I=!0),$=pi("msgHash",$),S4(H),j&&($=pi("prehashed msgHash",K($)));const P=x($),L=p(U),B=[E(L),E(P)];if(F!=null&&F!==!1){const ce=F===!0?r(i.BYTES):F;B.push(pi("extraEntropy",ce))}const V=mh(...B),X=P;function ae(ce){const ie=y(ce);if(!o.isValidNot0(ie))return;const Te=o.inv(ie),ue=t.BASE.multiply(ie).toAffine(),Q=o.create(ue.x);if(Q===_y)return;const xe=o.create(Te*o.create(X+Q*L));if(xe===_y)return;let Pe=(ue.x===Q?0:2)|Number(ue.y&ky),Y=xe;return I&&d(xe)&&(Y=u(xe),Pe^=1),new f(Q,Y,Pe)}return{seed:V,k2sig:ae}}const S={lowS:e.lowS,prehash:!1},C={lowS:e.lowS,prehash:!1};function N($,U,H=S){const{seed:K,k2sig:I}=R($,U,H);return hge(e.hash.outputLen,o.BYTES,s)(K,I)}t.BASE.precompute(8);function T($,U,H,K=C){const I=$;U=pi("msgHash",U),H=pi("publicKey",H),S4(K);const{lowS:j,prehash:F,format:P}=K;if("strict"in K)throw new Error("options.strict was renamed to lowS");if(P!==void 0&&!["compact","der","js"].includes(P))throw new Error('format must be "compact", "der" or "js"');const L=typeof I=="string"||wR(I),B=!L&&!P&&typeof I=="object"&&I!==null&&typeof I.r=="bigint"&&typeof I.s=="bigint";if(!L&&!B)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let V,X;try{if(B)if(P===void 0||P==="js")V=new f(I.r,I.s);else throw new Error("invalid format");if(L){try{P!=="compact"&&(V=f.fromDER(I))}catch(Pe){if(!(Pe instanceof Qc.Err))throw Pe}!V&&P!=="der"&&(V=f.fromCompact(I))}X=t.fromHex(H)}catch{return!1}if(!V||j&&V.hasHighS())return!1;F&&(U=e.hash(U));const{r:ae,s:ce}=V,ie=x(U),Te=o.inv(ce),ue=o.create(ie*Te),Q=o.create(ae*Te),xe=t.BASE.multiplyUnsafe(ue).add(X.multiplyUnsafe(Q));return xe.is0()?!1:o.create(xe.x)===ae}return Object.freeze({getPublicKey:g,getSharedSecret:b,sign:N,verify:T,utils:m,Point:t,Signature:f})}function zge(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=e0(e.n,t.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function Hge(t){const{CURVE:e,curveOpts:n}=zge(t),r={hash:t.hash,hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,ecdsaOpts:r}}function Vge(t,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:t})}function Wge(t){const{CURVE:e,curveOpts:n,ecdsaOpts:r}=Hge(t),s=$ge(e,n),i=Fge(s,r,n);return Vge(t,i)}function m_(t,e){const n=r=>Wge({...t,hash:r});return{...n(e),create:n}}const _7={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},k7={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},I7={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},qge=e0(_7.p),Kge=e0(k7.p),Gge=e0(I7.p),Yge=m_({..._7,Fp:qge,lowS:!1},iN);m_({...k7,Fp:Kge,lowS:!1},rme),m_({...I7,Fp:Gge,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},nme);const Qge=Yge,R7="base10",Ys="base16",yi="base64pad",gd="base64url",cb="utf8",j7=0,wl=1,lb=2,Jge=0,T4=1,Iy=12,TR=32;function Zge(){const t=p_.utils.randomPrivateKey(),e=p_.getPublicKey(t);return{privateKey:_i(t,Ys),publicKey:_i(e,Ys)}}function g_(){const t=Xg(TR);return _i(t,Ys)}function Xge(t,e){const n=p_.getSharedSecret(Io(t,Ys),Io(e,Ys)),r=lge(aN,n,void 0,void 0,TR);return _i(r,Ys)}function f1(t){const e=aN(Io(t,Ys));return _i(e,Ys)}function vo(t){const e=aN(Io(t,cb));return _i(e,Ys)}function P7(t){return Io(`${t}`,R7)}function xf(t){return Number(_i(t,R7))}function O7(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function D7(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function e0e(t){const e=P7(typeof t.type<"u"?t.type:j7);if(xf(e)===wl&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?Io(t.senderPublicKey,Ys):void 0,r=typeof t.iv<"u"?Io(t.iv,Ys):Xg(Iy),s=Io(t.symKey,Ys),i=f7(s,r).encrypt(Io(t.message,cb)),o=M7({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===gd?O7(o):o}function t0e(t){const e=Io(t.symKey,Ys),{sealed:n,iv:r}=tx({encoded:t.encoded,encoding:t.encoding}),s=f7(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return _i(s,cb)}function n0e(t,e){const n=P7(lb),r=Xg(Iy),s=Io(t,cb),i=M7({type:n,sealed:s,iv:r});return e===gd?O7(i):i}function r0e(t,e){const{sealed:n}=tx({encoded:t,encoding:e});return _i(n,cb)}function M7(t){if(xf(t.type)===lb)return _i(Sy([t.type,t.sealed]),yi);if(xf(t.type)===wl){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return _i(Sy([t.type,t.senderPublicKey,t.iv,t.sealed]),yi)}return _i(Sy([t.type,t.iv,t.sealed]),yi)}function tx(t){const e=(t.encoding||yi)===gd?D7(t.encoded):t.encoded,n=Io(e,yi),r=n.slice(Jge,T4),s=T4;if(xf(r)===wl){const l=s+TR,d=l+Iy,u=n.slice(s,l),h=n.slice(l,d),f=n.slice(d);return{type:r,sealed:f,iv:h,senderPublicKey:u}}if(xf(r)===lb){const l=n.slice(s),d=Xg(Iy);return{type:r,sealed:l,iv:d}}const i=s+Iy,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function s0e(t,e){const n=tx({encoded:t,encoding:e==null?void 0:e.encoding});return U7({type:xf(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?_i(n.senderPublicKey,Ys):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function U7(t){const e=(t==null?void 0:t.type)||j7;if(e===wl){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function _4(t){return t.type===wl&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function k4(t){return t.type===lb}function i0e(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return Sy([new Uint8Array([4]),e,n])}function o0e(t,e){const[n,r,s]=t.split("."),i=Buffer.from(D7(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),l=`${n}.${r}`,d=aN(l),u=i0e(e);if(!Qge.verify(Sy([o,a]),d,u))throw new Error("Invalid signature");return JT(t).payload}const a0e="irn";function jE(t){return(t==null?void 0:t.relay)||{protocol:a0e}}function Bp(t){const e=Dfe[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function c0e(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function I4(t){if(!t.includes("wc:")){const d=G9(t);d!=null&&d.includes("wc:")&&(t=d)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a={};o.forEach((d,u)=>{a[u]=d});const l=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:l0e(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:c0e(a),methods:l,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function l0e(t){return t.startsWith("//")?t.substring(2):t}function d0e(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function R4(t){const e=new URLSearchParams,n=d0e(t.relay);Object.keys(n).sort().forEach(s=>{e.set(s,n[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const r=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${r}`}function xv(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var u0e=Object.defineProperty,h0e=Object.defineProperties,f0e=Object.getOwnPropertyDescriptors,j4=Object.getOwnPropertySymbols,p0e=Object.prototype.hasOwnProperty,m0e=Object.prototype.propertyIsEnumerable,P4=(t,e,n)=>e in t?u0e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,g0e=(t,e)=>{for(var n in e||(e={}))p0e.call(e,n)&&P4(t,n,e[n]);if(j4)for(var n of j4(e))m0e.call(e,n)&&P4(t,n,e[n]);return t},y0e=(t,e)=>h0e(t,f0e(e));function t0(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function w0e(t){const e=[];return Object.values(t).forEach(n=>{e.push(...t0(n.accounts))}),e}function x0e(t,e){const n=[];return Object.values(t).forEach(r=>{t0(r.accounts).includes(e)&&n.push(...r.methods)}),n}function b0e(t,e){const n=[];return Object.values(t).forEach(r=>{t0(r.accounts).includes(e)&&n.push(...r.events)}),n}function uN(t){return t.includes(":")}function $p(t){return uN(t)?t.split(":")[0]:t}function O4(t){var e,n,r;const s={};if(!bc(t))return s;for(const[i,o]of Object.entries(t)){const a=uN(i)?[i]:o.chains,l=o.methods||[],d=o.events||[],u=$p(i);s[u]=y0e(g0e({},s[u]),{chains:xc(a,(e=s[u])==null?void 0:e.chains),methods:xc(l,(n=s[u])==null?void 0:n.methods),events:xc(d,(r=s[u])==null?void 0:r.events)})}return s}function v0e(t){const e={};return t==null||t.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function D4(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=v0e(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=xc(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function E0e(t,e){var n,r,s,i,o,a;const l=O4(t),d=O4(e),u={},h=Object.keys(l).concat(Object.keys(d));for(const f of h)u[f]={chains:xc((n=l[f])==null?void 0:n.chains,(r=d[f])==null?void 0:r.chains),methods:xc((s=l[f])==null?void 0:s.methods,(i=d[f])==null?void 0:i.methods),events:xc((o=l[f])==null?void 0:o.events,(a=d[f])==null?void 0:a.events)};return u}const C0e={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},N0e={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Re(t,e){const{message:n,code:r}=N0e[t];return{message:e?`${n} ${e}`:n,code:r}}function Fn(t,e){const{message:n,code:r}=C0e[t];return{message:e?`${n} ${e}`:n,code:r}}function xl(t,e){return!!Array.isArray(t)}function bc(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function kr(t){return typeof t>"u"}function wr(t,e){return e&&kr(t)?!0:typeof t=="string"&&!!t.trim().length}function _R(t,e){return e&&kr(t)?!0:typeof t=="number"&&!isNaN(t)}function A0e(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return ph(s,r)?(r.forEach(o=>{const{accounts:a,methods:l,events:d}=t.namespaces[o],u=t0(a),h=n[o];(!ph(H9(o,h),u)||!ph(h.methods,l)||!ph(h.events,d))&&(i=!1)}),i):!1}function PE(t){return wr(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function S0e(t){if(wr(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&PE(n)}}return!1}function T0e(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(wr(t,!1)){if(e(t))return!0;const n=G9(t);return e(n)}}catch{}return!1}function _0e(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function k0e(t){return t==null?void 0:t.topic}function I0e(t,e){let n=null;return wr(t==null?void 0:t.publicKey,!1)||(n=Re("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function M4(t){let e=!0;return xl(t)?t.length&&(e=t.every(n=>wr(n,!1))):e=!1,e}function R0e(t,e,n){let r=null;return xl(e)&&e.length?e.forEach(s=>{r||PE(s)||(r=Fn("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):PE(t)||(r=Fn("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function j0e(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=R0e(s,H9(s,i),`${e} ${n}`);o&&(r=o)}),r}function P0e(t,e){let n=null;return xl(t)?t.forEach(r=>{n||S0e(r)||(n=Fn("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=Fn("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function O0e(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=P0e(r==null?void 0:r.accounts,`${e} namespace`);s&&(n=s)}),n}function D0e(t,e){let n=null;return M4(t==null?void 0:t.methods)?M4(t==null?void 0:t.events)||(n=Fn("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=Fn("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function L7(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=D0e(r,`${e}, namespace`);s&&(n=s)}),n}function M0e(t,e,n){let r=null;if(t&&bc(t)){const s=L7(t,e);s&&(r=s);const i=j0e(t,e,n);i&&(r=i)}else r=Re("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function cS(t,e){let n=null;if(t&&bc(t)){const r=L7(t,e);r&&(n=r);const s=O0e(t,e);s&&(n=s)}else n=Re("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function B7(t){return wr(t.protocol,!0)}function U0e(t,e){let n=!1;return t?t&&xl(t)&&t.length&&t.forEach(r=>{n=B7(r)}):n=!0,n}function L0e(t){return typeof t=="number"}function li(t){return typeof t<"u"&&typeof t!==null}function B0e(t){return!(!t||typeof t!="object"||!t.code||!_R(t.code,!1)||!t.message||!wr(t.message,!1))}function $0e(t){return!(kr(t)||!wr(t.method,!1))}function F0e(t){return!(kr(t)||kr(t.result)&&kr(t.error)||!_R(t.id,!1)||!wr(t.jsonrpc,!1))}function z0e(t){return!(kr(t)||!wr(t.name,!1))}function U4(t,e){return!(!PE(e)||!w0e(t).includes(e))}function H0e(t,e,n){return wr(n,!1)?x0e(t,e).includes(n):!1}function V0e(t,e,n){return wr(n,!1)?b0e(t,e).includes(n):!1}function L4(t,e,n){let r=null;const s=W0e(t),i=q0e(e),o=Object.keys(s),a=Object.keys(i),l=B4(Object.keys(t)),d=B4(Object.keys(e)),u=l.filter(h=>!d.includes(h));return u.length&&(r=Re("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),ph(o,a)||(r=Re("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||r)return;const f=t0(e[h].accounts);f.includes(h)||(r=Re("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${f.toString()}`))}),o.forEach(h=>{r||(ph(s[h].methods,i[h].methods)?ph(s[h].events,i[h].events)||(r=Re("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${h}`)):r=Re("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${h}`))}),r}function W0e(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function B4(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function q0e(t){const e={};return Object.keys(t).forEach(n=>{if(n.includes(":"))e[n]=t[n];else{const r=t0(t[n].accounts);r==null||r.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}}),e}function K0e(t,e){return _R(t,!1)&&t<=e.max&&t>=e.min}function $4(){const t=ob();return new Promise(e=>{switch(t){case Yi.browser:e(G0e());break;case Yi.reactNative:e(Y0e());break;case Yi.node:e(Q0e());break;default:e(!0)}})}function G0e(){return Zg()&&(navigator==null?void 0:navigator.onLine)}async function Y0e(){if(Eu()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function Q0e(){return!0}function J0e(t){switch(ob()){case Yi.browser:Z0e(t);break;case Yi.reactNative:X0e(t);break}}function Z0e(t){!Eu()&&Zg()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function X0e(t){Eu()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}function eye(){var t;return Zg()&&gf()?((t=gf())==null?void 0:t.visibilityState)==="visible":!0}const lS={};class $0{static get(e){return lS[e]}static set(e,n){lS[e]=n}static delete(e){delete lS[e]}}function tye(t){const e=Jg.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function nye({publicKey:t,signature:e,payload:n}){var r;const s=y_(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=iye(n.address),a=n.era==="00"?new Uint8Array([0]):y_(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const l=parseInt(n.nonce,16),d=new Uint8Array([l&255,l>>8&255]),u=BigInt(`0x${sye(n.tip)}`),h=aye(u),f=new Uint8Array([0,...t,o,...e,...a,...d,...h,...s]),p=oye(f.length+1);return new Uint8Array([...p,i,...f])}function rye(t){const e=y_(t),n=Kfe.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function y_(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function sye(t){return t.startsWith("0x")?t.slice(2):t}function iye(t){const e=Jg.decode(t)[0];return e===42?0:e===60?2:1}function oye(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function aye(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function cye(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=tye(t.transaction.address),r=nye({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return rye(s)}const lye="PARSE_ERROR",dye="INVALID_REQUEST",uye="METHOD_NOT_FOUND",hye="INVALID_PARAMS",$7="INTERNAL_ERROR",kR="SERVER_ERROR",fye=[-32700,-32600,-32601,-32602,-32603],Ry={[lye]:{code:-32700,message:"Parse error"},[dye]:{code:-32600,message:"Invalid Request"},[uye]:{code:-32601,message:"Method not found"},[hye]:{code:-32602,message:"Invalid params"},[$7]:{code:-32603,message:"Internal error"},[kR]:{code:-32e3,message:"Server error"}},F7=kR;function pye(t){return fye.includes(t)}function F4(t){return Object.keys(Ry).includes(t)?Ry[t]:Ry[F7]}function mye(t){const e=Object.values(Ry).find(n=>n.code===t);return e||Ry[F7]}function z7(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var H7={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var w_=function(t,e){return w_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},w_(t,e)};function gye(t,e){w_(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var x_=function(){return x_=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},x_.apply(this,arguments)};function yye(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function wye(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function xye(t,e){return function(n,r){e(n,r,t)}}function bye(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function vye(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{d(r.next(u))}catch(h){o(h)}}function l(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):s(u.value).then(a,l)}d((r=r.apply(t,e||[])).next())})}function Eye(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(d){return function(u){return l([d,u])}}function l(d){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,s=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){n.label=d[1];break}if(d[0]===6&&n.label<i[1]){n.label=i[1],i=d;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(d);break}i[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(u){d=[6,u],s=0}finally{r=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Cye(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function Nye(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function b_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function V7(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function Aye(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(V7(arguments[e]));return t}function Sye(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function nx(t){return this instanceof nx?(this.v=t,this):new nx(t)}function Tye(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(f){r[f]&&(s[f]=function(p){return new Promise(function(m,g){i.push([f,p,m,g])>1||a(f,p)})})}function a(f,p){try{l(r[f](p))}catch(m){h(i[0][3],m)}}function l(f){f.value instanceof nx?Promise.resolve(f.value.v).then(d,u):h(i[0][2],f)}function d(f){a("next",f)}function u(f){a("throw",f)}function h(f,p){f(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function _ye(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:nx(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function kye(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof b_=="function"?b_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,l){o=t[i](o),s(a,l,o.done,o.value)})}}function s(i,o,a,l){Promise.resolve(l).then(function(d){i({value:d,done:a})},o)}}function Iye(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Rye(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function jye(t){return t&&t.__esModule?t:{default:t}}function Pye(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Oye(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const Dye=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return x_},__asyncDelegator:_ye,__asyncGenerator:Tye,__asyncValues:kye,__await:nx,__awaiter:vye,__classPrivateFieldGet:Pye,__classPrivateFieldSet:Oye,__createBinding:Cye,__decorate:wye,__exportStar:Nye,__extends:gye,__generator:Eye,__importDefault:jye,__importStar:Rye,__makeTemplateObject:Iye,__metadata:bye,__param:xye,__read:V7,__rest:yye,__spread:Aye,__spreadArrays:Sye,__values:b_},Symbol.toStringTag,{value:"Module"})),Mye=OM(Dye);var Lc={},z4;function Uye(){if(z4)return Lc;z4=1,Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.isBrowserCryptoAvailable=Lc.getSubtleCrypto=Lc.getBrowerCrypto=void 0;function t(){return(ec==null?void 0:ec.crypto)||(ec==null?void 0:ec.msCrypto)||{}}Lc.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Lc.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Lc.isBrowserCryptoAvailable=n,Lc}var Bc={},H4;function Lye(){if(H4)return Bc;H4=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.isBrowser=Bc.isNode=Bc.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Bc.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Bc.isNode=e;function n(){return!t()&&!e()}return Bc.isBrowser=n,Bc}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Mye;e.__exportStar(Uye(),t),e.__exportStar(Lye(),t)})(H7);function Fa(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function Fd(t=6){return BigInt(Fa(t))}function tc(t,e,n){return{id:n||Fa(),jsonrpc:"2.0",method:t,params:e}}function rx(t,e){return{id:t,jsonrpc:"2.0",result:e}}function hN(t,e,n){return{id:t,jsonrpc:"2.0",error:Bye(e)}}function Bye(t,e){return typeof t>"u"?F4($7):(typeof t=="string"&&(t=Object.assign(Object.assign({},F4(kR)),{message:t})),pye(t.code)&&(t=mye(t.code)),t)}let $ye=class{},Fye=class extends $ye{constructor(){super()}},zye=class extends Fye{constructor(e){super()}};const Hye="^https?:",Vye="^wss?:";function Wye(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function W7(t,e){const n=Wye(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function V4(t){return W7(t,Hye)}function W4(t){return W7(t,Vye)}function qye(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function q7(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function IR(t){return q7(t)&&"method"in t}function fN(t){return q7(t)&&(za(t)||Eo(t))}function za(t){return"result"in t}function Eo(t){return"error"in t}let Fo=class extends zye{constructor(e){super(e),this.events=new $o.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(tc(e.method,e.params||[],e.id||Fd().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{Eo(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),fN(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const Kye=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Gye=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",q4=t=>t.split("?")[0],K4=10,Yye=Kye();let Qye=class{constructor(e){if(this.url=e,this.events=new $o.EventEmitter,this.registering=!1,!W4(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(kl(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!W4(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=H7.isReactNative()?void 0:{rejectUnauthorized:!qye(e)},i=new Yye(e,[],s);Gye()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?mf(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=hN(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return z7(e,q4(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>K4&&this.events.setMaxListeners(K4)}emitError(e){const n=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${q4(this.url)}`));return this.events.emit("register_error",n),n}};var Jye={};const K7="wc",G7=2,v_="core",Sc=`${K7}@2:${v_}:`,Zye={logger:"error"},Xye={database:":memory:"},ewe="crypto",G4="client_ed25519_seed",twe=Ie.ONE_DAY,nwe="keychain",rwe="0.3",swe="messages",iwe="0.3",owe=Ie.SIX_HOURS,awe="publisher",Y7="irn",cwe="error",Q7="wss://relay.walletconnect.org",lwe="relayer",cr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},dwe="_subscription",oo={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},uwe=.1,E_="2.21.7",Pn={link_mode:"link_mode",relay:"relay"},p1={inbound:"inbound",outbound:"outbound"},hwe="0.3",fwe="WALLETCONNECT_CLIENT_ID",Y4="WALLETCONNECT_LINK_MODE_APPS",Mi={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},pwe="subscription",mwe="0.3",gwe="pairing",ywe="0.3",F0={wc_pairingDelete:{req:{ttl:Ie.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Ie.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Ie.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Ie.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Ie.ONE_DAY,prompt:!1,tag:0},res:{ttl:Ie.ONE_DAY,prompt:!1,tag:0}}},Yu={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},qo={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},wwe="history",xwe="0.3",bwe="expirer",ho={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},vwe="0.3",Ewe="verify-api",Cwe="https://verify.walletconnect.com",J7="https://verify.walletconnect.org",jy=J7,Nwe=`${jy}/v3`,Awe=[Cwe,J7],Swe="echo",Twe="https://echo.walletconnect.com",Ba={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},zc={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},td={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},z0={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Pu={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},H0={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},_we=.1,kwe="event-client",Iwe=86400,Rwe="https://pulse.walletconnect.org/batch";function jwe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,l=t.charAt(0),d=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,w=0,b=0,y=m.length;b!==y&&m[b]===0;)b++,g++;for(var x=(y-b)*u+1>>>0,v=new Uint8Array(x);b!==y;){for(var E=m[b],R=0,S=x-1;(E!==0||R<w)&&S!==-1;S--,R++)E+=256*v[S]>>>0,v[S]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");w=R,b++}for(var C=x-w;C!==x&&v[C]===0;)C++;for(var N=l.repeat(g);C<x;++C)N+=t.charAt(v[C]);return N}function f(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var w=0,b=0;m[g]===l;)w++,g++;for(var y=(m.length-g)*d+1>>>0,x=new Uint8Array(y);m[g];){var v=n[m.charCodeAt(g)];if(v===255)return;for(var E=0,R=y-1;(v!==0||E<b)&&R!==-1;R--,E++)v+=a*x[R]>>>0,x[R]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");b=E,g++}if(m[g]!==" "){for(var S=y-b;S!==y&&x[S]===0;)S++;for(var C=new Uint8Array(w+(y-S)),N=w;S!==y;)C[N++]=x[S++];return C}}}function p(m){var g=f(m);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:f,decode:p}}var Pwe=jwe,Owe=Pwe;const Z7=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Dwe=t=>new TextEncoder().encode(t),Mwe=t=>new TextDecoder().decode(t);class Uwe{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Lwe{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return X7(this,e)}}class Bwe{constructor(e){this.decoders=e}or(e){return X7(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const X7=(t,e)=>new Bwe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class $we{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new Uwe(e,n,r),this.decoder=new Lwe(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pN=({name:t,prefix:e,encode:n,decode:r})=>new $we(t,e,n,r),db=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=Owe(n,e);return pN({prefix:t,name:e,encode:r,decode:i=>Z7(s(i))})},Fwe=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,l=0,d=0;for(let u=0;u<i;++u){const h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${r} character`);l=l<<n|h,a+=n,a>=8&&(a-=8,o[d++]=255&l>>a)}if(a>=n||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return o},zwe=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let l=0;l<t.length;++l)for(a=a<<8|t[l],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},hs=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>pN({prefix:e,name:t,encode(s){return zwe(s,r,n)},decode(s){return Fwe(s,r,n,t)}}),Hwe=pN({prefix:"\0",name:"identity",encode:t=>Mwe(t),decode:t=>Dwe(t)});var Vwe=Object.freeze({__proto__:null,identity:Hwe});const Wwe=hs({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var qwe=Object.freeze({__proto__:null,base2:Wwe});const Kwe=hs({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Gwe=Object.freeze({__proto__:null,base8:Kwe});const Ywe=db({prefix:"9",name:"base10",alphabet:"0123456789"});var Qwe=Object.freeze({__proto__:null,base10:Ywe});const Jwe=hs({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Zwe=hs({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Xwe=Object.freeze({__proto__:null,base16:Jwe,base16upper:Zwe});const exe=hs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),txe=hs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),nxe=hs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rxe=hs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),sxe=hs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ixe=hs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),oxe=hs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),axe=hs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),cxe=hs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var lxe=Object.freeze({__proto__:null,base32:exe,base32upper:txe,base32pad:nxe,base32padupper:rxe,base32hex:sxe,base32hexupper:ixe,base32hexpad:oxe,base32hexpadupper:axe,base32z:cxe});const dxe=db({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),uxe=db({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var hxe=Object.freeze({__proto__:null,base36:dxe,base36upper:uxe});const fxe=db({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),pxe=db({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var mxe=Object.freeze({__proto__:null,base58btc:fxe,base58flickr:pxe});const gxe=hs({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),yxe=hs({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wxe=hs({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),xxe=hs({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var bxe=Object.freeze({__proto__:null,base64:gxe,base64pad:yxe,base64url:wxe,base64urlpad:xxe});const ez=Array.from(""),vxe=ez.reduce((t,e,n)=>(t[n]=e,t),[]),Exe=ez.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function Cxe(t){return t.reduce((e,n)=>(e+=vxe[n],e),"")}function Nxe(t){const e=[];for(const n of t){const r=Exe[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const Axe=pN({prefix:"",name:"base256emoji",encode:Cxe,decode:Nxe});var Sxe=Object.freeze({__proto__:null,base256emoji:Axe}),Txe=tz,Q4=128,_xe=-128,kxe=Math.pow(2,31);function tz(t,e,n){e=e||[],n=n||0;for(var r=n;t>=kxe;)e[n++]=t&255|Q4,t/=128;for(;t&_xe;)e[n++]=t&255|Q4,t>>>=7;return e[n]=t|0,tz.bytes=n-r+1,e}var Ixe=C_,Rxe=128,J4=127;function C_(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw C_.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&J4)<<s:(o&J4)*Math.pow(2,s),s+=7}while(o>=Rxe);return C_.bytes=i-r,n}var jxe=Math.pow(2,7),Pxe=Math.pow(2,14),Oxe=Math.pow(2,21),Dxe=Math.pow(2,28),Mxe=Math.pow(2,35),Uxe=Math.pow(2,42),Lxe=Math.pow(2,49),Bxe=Math.pow(2,56),$xe=Math.pow(2,63),Fxe=function(t){return t<jxe?1:t<Pxe?2:t<Oxe?3:t<Dxe?4:t<Mxe?5:t<Uxe?6:t<Lxe?7:t<Bxe?8:t<$xe?9:10},zxe={encode:Txe,decode:Ixe,encodingLength:Fxe},nz=zxe;const Z4=(t,e,n=0)=>(nz.encode(t,e,n),e),X4=t=>nz.encodingLength(t),N_=(t,e)=>{const n=e.byteLength,r=X4(t),s=r+X4(n),i=new Uint8Array(s+n);return Z4(t,i,0),Z4(n,i,r),i.set(e,s),new Hxe(t,n,e,i)};class Hxe{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const rz=({name:t,code:e,encode:n})=>new Vxe(t,e,n);class Vxe{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?N_(this.code,n):n.then(r=>N_(this.code,r))}else throw Error("Unknown type, must be binary type")}}const sz=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Wxe=rz({name:"sha2-256",code:18,encode:sz("SHA-256")}),qxe=rz({name:"sha2-512",code:19,encode:sz("SHA-512")});var Kxe=Object.freeze({__proto__:null,sha256:Wxe,sha512:qxe});const iz=0,Gxe="identity",oz=Z7,Yxe=t=>N_(iz,oz(t)),Qxe={code:iz,name:Gxe,encode:oz,digest:Yxe};var Jxe=Object.freeze({__proto__:null,identity:Qxe});new TextEncoder,new TextDecoder;const e5={...Vwe,...qwe,...Gwe,...Qwe,...Xwe,...lxe,...hxe,...mxe,...bxe,...Sxe};({...Kxe,...Jxe});function az(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Zxe(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?az(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function cz(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const t5=cz("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),dS=cz("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=Zxe(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),Xxe={utf8:t5,"utf-8":t5,hex:e5.base16,latin1:dS,ascii:dS,binary:dS,...e5};function ebe(t,e="utf8"){const n=Xxe[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?az(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var tbe=Object.defineProperty,nbe=(t,e,n)=>e in t?tbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ma=(t,e,n)=>nbe(t,typeof e!="symbol"?e+"":e,n);class rbe{constructor(e,n){this.core=e,this.logger=n,Ma(this,"keychain",new Map),Ma(this,"name",nwe),Ma(this,"version",rwe),Ma(this,"initialized",!1),Ma(this,"storagePrefix",Sc),Ma(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),Ma(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),Ma(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),Ma(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=Re("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),Ma(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=Ds(n,this.name)}get context(){return Ri(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,i_(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?o_(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}}var sbe=Object.defineProperty,ibe=(t,e,n)=>e in t?sbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yr=(t,e,n)=>ibe(t,typeof e!="symbol"?e+"":e,n);class obe{constructor(e,n,r){this.core=e,this.logger=n,Yr(this,"name",ewe),Yr(this,"keychain"),Yr(this,"randomSessionIdentifier",g_()),Yr(this,"initialized",!1),Yr(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Yr(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Yr(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=ID(s);return e9(i.publicKey)}),Yr(this,"generateKeyPair",()=>{this.isInitialized();const s=Zge();return this.setPrivateKey(s.publicKey,s.privateKey)}),Yr(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=ID(i),a=this.randomSessionIdentifier;return await jde(a,s,twe,o)}),Yr(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),l=Xge(a,i);return this.setSymKey(l,o)}),Yr(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||f1(s);return await this.keychain.set(o,s),o}),Yr(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Yr(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Yr(this,"encode",async(s,i,o)=>{this.isInitialized();const a=U7(o),l=kl(i);if(k4(a))return n0e(l,o==null?void 0:o.encoding);if(_4(a)){const f=a.senderPublicKey,p=a.receiverPublicKey;s=await this.generateSharedKey(f,p)}const d=this.getSymKey(s),{type:u,senderPublicKey:h}=a;return e0e({type:u,symKey:d,message:l,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),Yr(this,"decode",async(s,i,o)=>{this.isInitialized();const a=s0e(i,o);if(k4(a)){const l=r0e(i,o==null?void 0:o.encoding);return mf(l)}if(_4(a)){const l=a.receiverPublicKey,d=a.senderPublicKey;s=await this.generateSharedKey(l,d)}try{const l=this.getSymKey(s),d=t0e({symKey:l,encoded:i,encoding:o==null?void 0:o.encoding});return mf(d)}catch(l){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(l)}}),Yr(this,"getPayloadType",(s,i=yi)=>{const o=tx({encoded:s,encoding:i});return xf(o.type)}),Yr(this,"getPayloadSenderPublicKey",(s,i=yi)=>{const o=tx({encoded:s,encoding:i});return o.senderPublicKey?_i(o.senderPublicKey,Ys):void 0}),this.core=e,this.logger=Ds(n,this.name),this.keychain=r||new rbe(this.core,this.logger)}get context(){return Ri(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(G4)}catch{e=g_(),await this.keychain.set(G4,e)}return ebe(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}}var abe=Object.defineProperty,cbe=Object.defineProperties,lbe=Object.getOwnPropertyDescriptors,n5=Object.getOwnPropertySymbols,dbe=Object.prototype.hasOwnProperty,ube=Object.prototype.propertyIsEnumerable,A_=(t,e,n)=>e in t?abe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hbe=(t,e)=>{for(var n in e||(e={}))dbe.call(e,n)&&A_(t,n,e[n]);if(n5)for(var n of n5(e))ube.call(e,n)&&A_(t,n,e[n]);return t},fbe=(t,e)=>cbe(t,lbe(e)),Pi=(t,e,n)=>A_(t,typeof e!="symbol"?e+"":e,n);class pbe extends Iae{constructor(e,n){super(e,n),this.logger=e,this.core=n,Pi(this,"messages",new Map),Pi(this,"messagesWithoutClientAck",new Map),Pi(this,"name",swe),Pi(this,"version",iwe),Pi(this,"initialized",!1),Pi(this,"storagePrefix",Sc),Pi(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Pi(this,"set",async(r,s,i)=>{this.isInitialized();const o=vo(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===p1.inbound){const l=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,fbe(hbe({},l),{[o]:s}))}return await this.persist(),o}),Pi(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),Pi(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Pi(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=vo(s);return typeof i[o]<"u"}),Pi(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=vo(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),Pi(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Ds(e,this.name),this.core=n}get context(){return Ri(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,i_(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,i_(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?o_(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?o_(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}}var mbe=Object.defineProperty,gbe=Object.defineProperties,ybe=Object.getOwnPropertyDescriptors,r5=Object.getOwnPropertySymbols,wbe=Object.prototype.hasOwnProperty,xbe=Object.prototype.propertyIsEnumerable,S_=(t,e,n)=>e in t?mbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,tp=(t,e)=>{for(var n in e||(e={}))wbe.call(e,n)&&S_(t,n,e[n]);if(r5)for(var n of r5(e))xbe.call(e,n)&&S_(t,n,e[n]);return t},s5=(t,e)=>gbe(t,ybe(e)),ao=(t,e,n)=>S_(t,typeof e!="symbol"?e+"":e,n);class bbe extends Rae{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,ao(this,"events",new $o.EventEmitter),ao(this,"name",awe),ao(this,"queue",new Map),ao(this,"publishTimeout",Ie.toMiliseconds(Ie.ONE_MINUTE)),ao(this,"initialPublishTimeout",Ie.toMiliseconds(Ie.ONE_SECOND*15)),ao(this,"needsTransportRestart",!1),ao(this,"publish",async(r,s,i)=>{var o,a,l,d,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const h=(i==null?void 0:i.ttl)||owe,f=(i==null?void 0:i.prompt)||!1,p=(i==null?void 0:i.tag)||0,m=(i==null?void 0:i.id)||Fd().toString(),g=Bp(jE().protocol),w={id:m,method:(i==null?void 0:i.publishMethod)||g.publish,params:tp({topic:r,message:s,ttl:h,prompt:f,tag:p,attestation:i==null?void 0:i.attestation},(i==null?void 0:i.tvf)&&{tvf:i.tvf})},b=`Failed to publish payload, please try again. id:${m} tag:${p}`;try{kr((o=w.params)==null?void 0:o.prompt)&&((a=w.params)==null||delete a.prompt),kr((l=w.params)==null?void 0:l.tag)&&((d=w.params)==null||delete d.tag);const y=new Promise(async x=>{const v=({id:R})=>{var S;((S=w.id)==null?void 0:S.toString())===R.toString()&&(this.removeRequestFromQueue(R),this.relayer.events.removeListener(cr.publish,v),x())};this.relayer.events.on(cr.publish,v);const E=lc(new Promise((R,S)=>{this.rpcPublish(w,i).then(R).catch(C=>{this.logger.warn(C,C==null?void 0:C.message),S(C)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${m} tag:${p}`);try{await E,this.events.removeListener(cr.publish,v)}catch(R){this.queue.set(m,{request:w,opts:i,attempt:1}),this.logger.warn(R,R==null?void 0:R.message)}});this.logger.trace({type:"method",method:"publish",params:{id:m,topic:r,message:s,opts:i}}),await lc(y,this.publishTimeout,b)}catch(y){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(y),(u=i==null?void 0:i.internal)!=null&&u.throwOnFailedPublish)throw y}finally{this.queue.delete(m)}}),ao(this,"publishCustom",async r=>{var s,i,o,a,l;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:d,opts:u={}}=r,{attestation:h,tvf:f,publishMethod:p,prompt:m,tag:g,ttl:w=Ie.FIVE_MINUTES}=u,b=u.id||Fd().toString(),y=Bp(jE().protocol),x=p||y.publish,v={id:b,method:x,params:tp(s5(tp({},d),{ttl:w,prompt:m,tag:g,attestation:h}),f)},E=`Failed to publish custom payload, please try again. id:${b} tag:${g}`;try{kr((s=v.params)==null?void 0:s.prompt)&&((i=v.params)==null||delete i.prompt),kr((o=v.params)==null?void 0:o.tag)&&((a=v.params)==null||delete a.tag);const R=new Promise(async S=>{const C=({id:T})=>{var $;(($=v.id)==null?void 0:$.toString())===T.toString()&&(this.removeRequestFromQueue(T),this.relayer.events.removeListener(cr.publish,C),S())};this.relayer.events.on(cr.publish,C);const N=lc(new Promise((T,$)=>{this.rpcPublish(v,u).then(T).catch(U=>{this.logger.warn(U,U==null?void 0:U.message),$(U)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${x} id:${b} tag:${g}`);try{await N,this.events.removeListener(cr.publish,C)}catch(T){this.queue.set(b,{request:v,opts:u,attempt:1}),this.logger.warn(T,T==null?void 0:T.message)}});this.logger.trace({type:"method",method:"publish",params:{id:b,payload:d,opts:u}}),await lc(R,this.publishTimeout,E)}catch(R){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(R),(l=u==null?void 0:u.internal)!=null&&l.throwOnFailedPublish)throw R}finally{this.queue.delete(b)}}),ao(this,"on",(r,s)=>{this.events.on(r,s)}),ao(this,"once",(r,s)=>{this.events.once(r,s)}),ao(this,"off",(r,s)=>{this.events.off(r,s)}),ao(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=Ds(n,this.name),this.registerEventListeners()}get context(){return Ri(this.logger)}async rpcPublish(e,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(cr.publish,tp(tp({},e),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{var r;const s=e.attempt+1;this.queue.set(n,s5(tp({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Of.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(cr.connection_stalled);return}this.checkQueue()}),this.relayer.on(cr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var vbe=Object.defineProperty,Ebe=(t,e,n)=>e in t?vbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,np=(t,e,n)=>Ebe(t,typeof e!="symbol"?e+"":e,n);class Cbe{constructor(){np(this,"map",new Map),np(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),np(this,"get",e=>this.map.get(e)||[]),np(this,"exists",(e,n)=>this.get(e).includes(n)),np(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),np(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var Nbe=Object.defineProperty,Abe=Object.defineProperties,Sbe=Object.getOwnPropertyDescriptors,i5=Object.getOwnPropertySymbols,Tbe=Object.prototype.hasOwnProperty,_be=Object.prototype.propertyIsEnumerable,T_=(t,e,n)=>e in t?Nbe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V0=(t,e)=>{for(var n in e||(e={}))Tbe.call(e,n)&&T_(t,n,e[n]);if(i5)for(var n of i5(e))_be.call(e,n)&&T_(t,n,e[n]);return t},uS=(t,e)=>Abe(t,Sbe(e)),Sn=(t,e,n)=>T_(t,typeof e!="symbol"?e+"":e,n);class kbe extends Oae{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Sn(this,"subscriptions",new Map),Sn(this,"topicMap",new Cbe),Sn(this,"events",new $o.EventEmitter),Sn(this,"name",pwe),Sn(this,"version",mwe),Sn(this,"pending",new Map),Sn(this,"cached",[]),Sn(this,"initialized",!1),Sn(this,"storagePrefix",Sc),Sn(this,"subscribeTimeout",Ie.toMiliseconds(Ie.ONE_MINUTE)),Sn(this,"initialSubscribeTimeout",Ie.toMiliseconds(Ie.ONE_SECOND*15)),Sn(this,"clientId"),Sn(this,"batchSubscribeTopicsLimit",500),Sn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Sn(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=jE(s),a={topic:r,relay:o,transportType:s==null?void 0:s.transportType};(i=s==null?void 0:s.internal)!=null&&i.skipSubscribe||this.pending.set(r,a);const l=await this.rpcSubscribe(r,o,s);return typeof l=="string"&&(this.onSubscribe(l,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),l}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Sn(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),Sn(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),Sn(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),Sn(this,"on",(r,s)=>{this.events.on(r,s)}),Sn(this,"once",(r,s)=>{this.events.once(r,s)}),Sn(this,"off",(r,s)=>{this.events.off(r,s)}),Sn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),Sn(this,"start",async()=>{await this.onConnect()}),Sn(this,"stop",async()=>{await this.onDisconnect()}),Sn(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Sn(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),Sn(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Of.pulse,async()=>{await this.checkPending()}),this.events.on(Mi.created,async r=>{const s=Mi.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(Mi.deleted,async r=>{const s=Mi.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=Ds(n,this.name),this.clientId=""}get context(){return Ri(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=jE(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=Fn("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r==null?void 0:r.internal)!=null&&s.skipSubscribe)return o;(!r||(r==null?void 0:r.transportType)===Pn.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const a={method:Bp(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const l=(i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish;try{if((r==null?void 0:r.transportType)===Pn.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(h=>this.logger.warn(h))},Ie.toMiliseconds(Ie.ONE_SECOND)),o;const d=new Promise(async h=>{const f=p=>{p.topic===e&&(this.events.removeListener(Mi.created,f),h(p.id))};this.events.on(Mi.created,f);try{const p=await lc(new Promise((m,g)=>{this.relayer.request(a).catch(w=>{this.logger.warn(w,w==null?void 0:w.message),g(w)}).then(m)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Mi.created,f),h(p)}catch{}}),u=await lc(d,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&l)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(d){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(cr.connection_stalled),l)throw d}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:Bp(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await lc(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(cr.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:Bp(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await lc(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(cr.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:Bp(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,uS(V0({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,V0({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,V0({},n)),this.topicMap.set(n.topic,e),this.events.emit(Mi.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=Re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(Mi.deleted,uS(V0({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Mi.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Mi.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=Re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>uS(V0({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await bpe(Ie.toMiliseconds(Ie.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return vo(e+await this.getClientId())}}var Ibe=Object.defineProperty,o5=Object.getOwnPropertySymbols,Rbe=Object.prototype.hasOwnProperty,jbe=Object.prototype.propertyIsEnumerable,__=(t,e,n)=>e in t?Ibe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,a5=(t,e)=>{for(var n in e||(e={}))Rbe.call(e,n)&&__(t,n,e[n]);if(o5)for(var n of o5(e))jbe.call(e,n)&&__(t,n,e[n]);return t},sn=(t,e,n)=>__(t,typeof e!="symbol"?e+"":e,n);class Pbe extends jae{constructor(e){super(e),sn(this,"protocol","wc"),sn(this,"version",2),sn(this,"core"),sn(this,"logger"),sn(this,"events",new $o.EventEmitter),sn(this,"provider"),sn(this,"messages"),sn(this,"subscriber"),sn(this,"publisher"),sn(this,"name",lwe),sn(this,"transportExplicitlyClosed",!1),sn(this,"initialized",!1),sn(this,"connectionAttemptInProgress",!1),sn(this,"relayUrl"),sn(this,"projectId"),sn(this,"packageName"),sn(this,"bundleId"),sn(this,"hasExperiencedNetworkDisruption",!1),sn(this,"pingTimeout"),sn(this,"heartBeatTimeout",Ie.toMiliseconds(Ie.THIRTY_SECONDS+Ie.FIVE_SECONDS)),sn(this,"reconnectTimeout"),sn(this,"connectPromise"),sn(this,"reconnectInProgress",!1),sn(this,"requestsInFlight",[]),sn(this,"connectTimeout",Ie.toMiliseconds(Ie.ONE_SECOND*15)),sn(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||Fd().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),sn(this,"resetPingTimeout",()=>{_E()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),sn(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),sn(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(cr.connect)}),sn(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),sn(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(cr.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),sn(this,"registerProviderListeners",()=>{this.provider.on(oo.payload,this.onPayloadHandler),this.provider.on(oo.connect,this.onConnectHandler),this.provider.on(oo.disconnect,this.onDisconnectHandler),this.provider.on(oo.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ds(e.logger,this.name):nb(qg({level:e.logger||cwe})),this.messages=new pbe(this.logger,e.core),this.subscriber=new kbe(this,this.logger),this.publisher=new bbe(this,this.logger),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Q7,spe()?this.packageName=QD():ipe()&&(this.bundleId=QD()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return Ri(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:Pn.relay},p1.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||(n==null?void 0:n.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((r=n==null?void 0:n.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",l;const d=u=>{u.topic===e&&(this.subscriber.off(Mi.created,d),l())};return await Promise.all([new Promise(u=>{l=u,this.subscriber.on(Mi.created,d)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(e,a5({internal:{throwOnFailedPublish:o}},n)).catch(f=>{o&&h(f)})||a,u()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await lc(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await $4())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=Ar(Ie.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(cr.message,e),await this.recordMessageEvent(e,p1.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(oo.disconnect,i),await lc(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(oo.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const l=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(oo.disconnect,l),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(oo.disconnect,l)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,Ie.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(_E())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Fo(new Qye(dpe({sdkVersion:E_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),IR(e)){if(!e.method.endsWith(dwe))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:Pn.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(a5({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else fN(e)&&this.events.emit(cr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,p1.inbound),this.events.emit(cr.message,e))}async acknowledgePayload(e){const n=rx(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(oo.payload,this.onPayloadHandler),this.provider.off(oo.connect,this.onConnectHandler),this.provider.off(oo.disconnect,this.onDisconnectHandler),this.provider.off(oo.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await $4();J0e(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r==null?void 0:r.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Of.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&eye())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n==null?void 0:n.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(cr.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Ie.toMiliseconds(uwe)))))}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function Obe(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function c5(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function l5(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Dbe="[object RegExp]",Mbe="[object String]",Ube="[object Number]",Lbe="[object Boolean]",d5="[object Arguments]",Bbe="[object Symbol]",$be="[object Date]",Fbe="[object Map]",zbe="[object Set]",Hbe="[object Array]",Vbe="[object Function]",Wbe="[object ArrayBuffer]",hS="[object Object]",qbe="[object Error]",Kbe="[object DataView]",Gbe="[object Uint8Array]",Ybe="[object Uint8ClampedArray]",Qbe="[object Uint16Array]",Jbe="[object Uint32Array]",Zbe="[object BigUint64Array]",Xbe="[object Int8Array]",eve="[object Int16Array]",tve="[object Int32Array]",nve="[object BigInt64Array]",rve="[object Float32Array]",sve="[object Float64Array]";function ive(){}function u5(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function ove(t,e,n){return dy(t,e,void 0,void 0,void 0,void 0,n)}function dy(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Py(t,e,i,o)}return Py(t,e,i,o)}function Py(t,e,n,r){if(Object.is(t,e))return!0;let s=l5(t),i=l5(e);if(s===d5&&(s=hS),i===d5&&(i=hS),s!==i)return!1;switch(s){case Mbe:return t.toString()===e.toString();case Ube:{const l=t.valueOf(),d=e.valueOf();return Obe(l,d)}case Lbe:case $be:case Bbe:return Object.is(t.valueOf(),e.valueOf());case Dbe:return t.source===e.source&&t.flags===e.flags;case Vbe:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case Fbe:{if(t.size!==e.size)return!1;for(const[l,d]of t.entries())if(!e.has(l)||!dy(d,e.get(l),l,t,e,n,r))return!1;return!0}case zbe:{if(t.size!==e.size)return!1;const l=Array.from(t.values()),d=Array.from(e.values());for(let u=0;u<l.length;u++){const h=l[u],f=d.findIndex(p=>dy(h,p,void 0,t,e,n,r));if(f===-1)return!1;d.splice(f,1)}return!0}case Hbe:case Gbe:case Ybe:case Qbe:case Jbe:case Zbe:case Xbe:case eve:case tve:case nve:case rve:case sve:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let l=0;l<t.length;l++)if(!dy(t[l],e[l],l,t,e,n,r))return!1;return!0}case Wbe:return t.byteLength!==e.byteLength?!1:Py(new Uint8Array(t),new Uint8Array(e),n,r);case Kbe:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Py(new Uint8Array(t),new Uint8Array(e),n,r);case qbe:return t.name===e.name&&t.message===e.message;case hS:{if(!(Py(t.constructor,e.constructor,n,r)||u5(t)&&u5(e)))return!1;const l=[...Object.keys(t),...c5(t)],d=[...Object.keys(e),...c5(e)];if(l.length!==d.length)return!1;for(let u=0;u<l.length;u++){const h=l[u],f=t[h];if(!Object.hasOwn(e,h))return!1;const p=e[h];if(!dy(f,p,h,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function ave(t,e){return ove(t,e,ive)}var cve=Object.defineProperty,h5=Object.getOwnPropertySymbols,lve=Object.prototype.hasOwnProperty,dve=Object.prototype.propertyIsEnumerable,k_=(t,e,n)=>e in t?cve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,f5=(t,e)=>{for(var n in e||(e={}))lve.call(e,n)&&k_(t,n,e[n]);if(h5)for(var n of h5(e))dve.call(e,n)&&k_(t,n,e[n]);return t},oi=(t,e,n)=>k_(t,typeof e!="symbol"?e+"":e,n);class Uf extends Pae{constructor(e,n,r,s=Sc,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,oi(this,"map",new Map),oi(this,"version",hwe),oi(this,"cached",[]),oi(this,"initialized",!1),oi(this,"getKey"),oi(this,"storagePrefix",Sc),oi(this,"recentlyDeleted",[]),oi(this,"recentlyDeletedLimit",200),oi(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!kr(o)?this.map.set(this.getKey(o),o):_0e(o)?this.map.set(o.id,o):k0e(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),oi(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),oi(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),oi(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(l=>ave(a[l],o[l]))):this.values)),oi(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const l=f5(f5({},this.getData(o)),a);this.map.set(o,l),await this.persist()}),oi(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Ds(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Ri(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=Re("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=Re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=Re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}}var uve=Object.defineProperty,hve=(t,e,n)=>e in t?uve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$t=(t,e,n)=>hve(t,typeof e!="symbol"?e+"":e,n);class fve{constructor(e,n){this.core=e,this.logger=n,$t(this,"name",gwe),$t(this,"version",ywe),$t(this,"events",new JI),$t(this,"pairings"),$t(this,"initialized",!1),$t(this,"storagePrefix",Sc),$t(this,"ignoredPayloadTypes",[wl]),$t(this,"registeredMethods",[]),$t(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),$t(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),$t(this,"create",async r=>{this.isInitialized();const s=g_(),i=await this.core.crypto.setSymKey(s),o=Ar(Ie.FIVE_MINUTES),a={protocol:Y7},l={topic:i,expiry:o,relay:a,active:!1,methods:r==null?void 0:r.methods},d=R4({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r==null?void 0:r.methods});return this.events.emit(Yu.create,l),this.core.expirer.set(i,o),await this.pairings.set(i,l),await this.core.relayer.subscribe(i,{transportType:r==null?void 0:r.transportType,internal:r==null?void 0:r.internal}),{topic:i,uri:d}}),$t(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r==null?void 0:r.uri,trace:[Ba.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:l,methods:d}=I4(r.uri);s.props.properties.topic=i,s.addTrace(Ba.pairing_uri_validation_success),s.addTrace(Ba.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Ba.existing_pairing),u.active)throw s.setError(zc.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Ba.pairing_not_expired)}const h=l||Ar(Ie.FIVE_MINUTES),f={topic:i,relay:a,expiry:h,active:!1,methods:d};this.core.expirer.set(i,h),await this.pairings.set(i,f),s.addTrace(Ba.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(Yu.create,f),s.addTrace(Ba.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Ba.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(zc.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(p){throw s.setError(zc.subscribe_pairing_topic_failure),p}return s.addTrace(Ba.subscribe_pairing_topic_success),f}),$t(this,"activate",async({topic:r})=>{this.isInitialized();const s=Ar(Ie.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),$t(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:l}=zu();this.events.once(hn("pairing_ping",i),({error:d})=>{d?l(d):a()}),await o()}}),$t(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),$t(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),$t(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),$t(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Fn("USER_DISCONNECTED")),await this.deletePairing(s))}),$t(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,l=this.core.crypto.keychain.get(s);return R4({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:l,relay:i,expiryTimestamp:o,methods:a})}),$t(this,"sendRequest",async(r,s,i)=>{const o=tc(s,i),a=await this.core.crypto.encode(r,o),l=F0[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,l),o.id}),$t(this,"sendResult",async(r,s,i)=>{const o=rx(r,i),a=await this.core.crypto.encode(s,o),l=(await this.core.history.get(s,r)).request.method,d=F0[l].res;await this.core.relayer.publish(s,a,d),await this.core.history.resolve(o)}),$t(this,"sendError",async(r,s,i)=>{const o=hN(r,i),a=await this.core.crypto.encode(s,o),l=(await this.core.history.get(s,r)).request.method,d=F0[l]?F0[l].res:F0.unregistered_method.res;await this.core.relayer.publish(s,a,d),await this.core.history.resolve(o)}),$t(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,Fn("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),$t(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>cd(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),$t(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),$t(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),$t(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(Yu.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),$t(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{za(s)?this.events.emit(hn("pairing_ping",i),{}):Eo(s)&&this.events.emit(hn("pairing_ping",i),{error:s.error})},500)}),$t(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Yu.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),$t(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=Fn("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),$t(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(Fn("WC_METHOD_UNSUPPORTED",r))}),$t(this,"isValidPair",(r,s)=>{var i;if(!li(r)){const{message:a}=Re("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(zc.malformed_pairing_uri),new Error(a)}if(!T0e(r.uri)){const{message:a}=Re("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(zc.malformed_pairing_uri),new Error(a)}const o=I4(r==null?void 0:r.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=Re("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(zc.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=Re("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(zc.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Ie.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(zc.pairing_expired);const{message:a}=Re("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),$t(this,"isValidPing",async r=>{if(!li(r)){const{message:i}=Re("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),$t(this,"isValidDisconnect",async r=>{if(!li(r)){const{message:i}=Re("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),$t(this,"isValidPairingTopic",async r=>{if(!wr(r,!1)){const{message:s}=Re("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=Re("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(cd(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=Re("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=Ds(n,this.name),this.pairings=new Uf(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ri(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(cr.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==Pn.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);IR(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):fN(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(ho.expired,async e=>{const{topic:n}=K9(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Yu.expire,{topic:n}))})}}var pve=Object.defineProperty,mve=(t,e,n)=>e in t?pve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qr=(t,e,n)=>mve(t,typeof e!="symbol"?e+"":e,n);class gve extends kae{constructor(e,n){super(e,n),this.core=e,this.logger=n,Qr(this,"records",new Map),Qr(this,"events",new $o.EventEmitter),Qr(this,"name",wwe),Qr(this,"version",xwe),Qr(this,"cached",[]),Qr(this,"initialized",!1),Qr(this,"storagePrefix",Sc),Qr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Qr(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:Ar(Ie.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(qo.created,o)}),Qr(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=Eo(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(qo.updated,s))}),Qr(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Qr(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(qo.deleted,i)}}),this.persist()}),Qr(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Qr(this,"on",(r,s)=>{this.events.on(r,s)}),Qr(this,"once",(r,s)=>{this.events.once(r,s)}),Qr(this,"off",(r,s)=>{this.events.off(r,s)}),Qr(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Ds(n,this.name)}get context(){return Ri(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:tc(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=Re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(qo.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=Re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(qo.created,e=>{const n=qo.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(qo.updated,e=>{const n=qo.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(qo.deleted,e=>{const n=qo.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(Of.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{Ie.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(qo.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}}var yve=Object.defineProperty,wve=(t,e,n)=>e in t?yve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vs=(t,e,n)=>wve(t,typeof e!="symbol"?e+"":e,n);class xve extends Dae{constructor(e,n){super(e,n),this.core=e,this.logger=n,vs(this,"expirations",new Map),vs(this,"events",new $o.EventEmitter),vs(this,"name",bwe),vs(this,"version",vwe),vs(this,"cached",[]),vs(this,"initialized",!1),vs(this,"storagePrefix",Sc),vs(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),vs(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),vs(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(ho.created,{target:i,expiration:o})}),vs(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),vs(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(ho.deleted,{target:s,expiration:i})}}),vs(this,"on",(r,s)=>{this.events.on(r,s)}),vs(this,"once",(r,s)=>{this.events.once(r,s)}),vs(this,"off",(r,s)=>{this.events.off(r,s)}),vs(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Ds(n,this.name)}get context(){return Ri(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return upe(e);if(typeof e=="number")return hpe(e);const{message:n}=Re("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ho.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=Re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=Re("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;Ie.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(ho.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(Of.pulse,()=>this.checkExpirations()),this.events.on(ho.created,e=>{const n=ho.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(ho.expired,e=>{const n=ho.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(ho.deleted,e=>{const n=ho.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}}var bve=Object.defineProperty,vve=(t,e,n)=>e in t?bve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mr=(t,e,n)=>vve(t,typeof e!="symbol"?e+"":e,n);class Eve extends Mae{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,mr(this,"name",Ewe),mr(this,"abortController"),mr(this,"isDevEnv"),mr(this,"verifyUrlV3",Nwe),mr(this,"storagePrefix",Sc),mr(this,"version",G7),mr(this,"publicKey"),mr(this,"fetchPromise"),mr(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Ie.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),mr(this,"register",async s=>{if(!Zg()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,l=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const d=gf(),u=this.startAbortTimer(Ie.ONE_SECOND*5),h=await new Promise((f,p)=>{const m=()=>{window.removeEventListener("message",w),d.body.removeChild(g),p("attestation aborted")};this.abortController.signal.addEventListener("abort",m);const g=d.createElement("iframe");g.src=l,g.style.display="none",g.addEventListener("error",m,{signal:this.abortController.signal});const w=b=>{if(b.data&&typeof b.data=="string")try{const y=JSON.parse(b.data);if(y.type==="verify_attestation"){if(JT(y.attestation).payload.id!==o)return;clearInterval(u),d.body.removeChild(g),this.abortController.signal.removeEventListener("abort",m),window.removeEventListener("message",w),f(y.attestation===null?"":y.attestation)}}catch(y){this.logger.warn(y)}};d.body.appendChild(g),window.addEventListener("message",w,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(d){this.logger.warn(d)}return""}),mr(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(JT(i).payload.id!==a)return;const d=await this.isValidJwtAttestation(i);if(d){if(!d.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return d}}if(!o)return;const l=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,l)}),mr(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Ie.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),mr(this,"getVerifyUrl",s=>{let i=s||jy;return Awe.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${jy}`),i=jy),i}),mr(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Ie.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),mr(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),mr(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),mr(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),mr(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),mr(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),mr(this,"validateAttestation",(s,i)=>{const o=o0e(s,i.publicKey),a={hasExpired:Ie.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Ds(n,this.name),this.abortController=new AbortController,this.isDevEnv=mR(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Ri(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Ie.toMiliseconds(e))}}var Cve=Object.defineProperty,Nve=(t,e,n)=>e in t?Cve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p5=(t,e,n)=>Nve(t,typeof e!="symbol"?e+"":e,n);class Ave extends Uae{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,p5(this,"context",Swe),p5(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,l=`${Twe}/${this.projectId}/clients`;await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Ds(n,this.context)}}var Sve=Object.defineProperty,m5=Object.getOwnPropertySymbols,Tve=Object.prototype.hasOwnProperty,_ve=Object.prototype.propertyIsEnumerable,I_=(t,e,n)=>e in t?Sve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W0=(t,e)=>{for(var n in e||(e={}))Tve.call(e,n)&&I_(t,n,e[n]);if(m5)for(var n of m5(e))_ve.call(e,n)&&I_(t,n,e[n]);return t},Ur=(t,e,n)=>I_(t,typeof e!="symbol"?e+"":e,n);class kve extends Lae{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,Ur(this,"context",kwe),Ur(this,"storagePrefix",Sc),Ur(this,"storageVersion",_we),Ur(this,"events",new Map),Ur(this,"shouldPersist",!1),Ur(this,"init",async()=>{if(!mR())try{const s={eventId:ZD(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:W9(this.core.relayer.protocol,this.core.relayer.version,E_)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Ur(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:l}}=s,d=ZD(),u=this.core.projectId||"",h=Date.now(),f=W0({eventId:d,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:l}},bundleId:u,domain:this.getAppDomain()},this.setMethods(d));return this.telemetryEnabled&&(this.events.set(d,f),this.shouldPersist=!0),f}),Ur(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(l=>l.props.properties.topic===o);if(a)return W0(W0({},a),this.setMethods(a.eventId))}),Ur(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Ur(this,"setEventListeners",()=>{this.core.heartbeat.on(Of.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Ie.fromMiliseconds(Date.now())-Ie.fromMiliseconds(s.timestamp)>Iwe&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Ur(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Ur(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Ur(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Ur(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Ur(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,W0(W0({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Ur(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Ur(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${Rwe}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${E_}${i}`,{method:"POST",body:JSON.stringify(s)})}),Ur(this,"getAppDomain",()=>V9().url),this.logger=Ds(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Ive=Object.defineProperty,g5=Object.getOwnPropertySymbols,Rve=Object.prototype.hasOwnProperty,jve=Object.prototype.propertyIsEnumerable,R_=(t,e,n)=>e in t?Ive(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,y5=(t,e)=>{for(var n in e||(e={}))Rve.call(e,n)&&R_(t,n,e[n]);if(g5)for(var n of g5(e))jve.call(e,n)&&R_(t,n,e[n]);return t},_n=(t,e,n)=>R_(t,typeof e!="symbol"?e+"":e,n);let Pve=class lz extends Aae{constructor(e){var n;super(e),_n(this,"protocol",K7),_n(this,"version",G7),_n(this,"name",v_),_n(this,"relayUrl"),_n(this,"projectId"),_n(this,"customStoragePrefix"),_n(this,"events",new $o.EventEmitter),_n(this,"logger"),_n(this,"heartbeat"),_n(this,"relayer"),_n(this,"crypto"),_n(this,"storage"),_n(this,"history"),_n(this,"expirer"),_n(this,"pairing"),_n(this,"verify"),_n(this,"echoClient"),_n(this,"linkModeSupportedApps"),_n(this,"eventClient"),_n(this,"initialized",!1),_n(this,"logChunkController"),_n(this,"on",(a,l)=>this.events.on(a,l)),_n(this,"once",(a,l)=>this.events.once(a,l)),_n(this,"off",(a,l)=>this.events.off(a,l)),_n(this,"removeListener",(a,l)=>this.events.removeListener(a,l)),_n(this,"dispatchEnvelope",({topic:a,message:l,sessionExists:d})=>{if(!a||!l)return;const u={topic:a,message:l,publishedAt:Date.now(),transportType:Pn.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:d})});const r=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Q7,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=qg({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:Zye.logger,name:v_}),{logger:i,chunkLoggerController:o}=XI({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,l;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((l=this.logChunkController)==null||l.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ds(i,this.name),this.heartbeat=new foe,this.crypto=new obe(this,this.logger,e==null?void 0:e.keychain),this.history=new gve(this,this.logger),this.expirer=new xve(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Yoe(y5(y5({},Xye),e==null?void 0:e.storageOptions)),this.relayer=new Pbe({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new fve(this,this.logger),this.verify=new Eve(this,this.logger,this.storage),this.echoClient=new Ave(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new kve(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new lz(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(fwe,r),n}get context(){return Ri(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Y4,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Y4)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&Jye.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Ove=Pve,dz="wc",uz=2,hz="client",RR=`${dz}@${uz}:${hz}:`,fS={name:hz,logger:"error"},w5="WALLETCONNECT_DEEPLINK_CHOICE",Dve="proposal",x5="Proposal expired",Mve="session",rp=Ie.SEVEN_DAYS,Uve="engine",Jr={wc_sessionPropose:{req:{ttl:Ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Ie.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Ie.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Ie.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Ie.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Ie.FIVE_MINUTES,prompt:!1,tag:1119}}},pS={min:Ie.FIVE_MINUTES,max:Ie.SEVEN_DAYS},Ua={idle:"IDLE",active:"ACTIVE"},Lve={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Bve="request",$ve=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Fve="wc",zve="auth",Hve="authKeys",Vve="pairingTopics",Wve="requests",mN=`${Fve}@${1.5}:${zve}:`,m1=`${mN}:PUB_KEY`;var qve=Object.defineProperty,Kve=Object.defineProperties,Gve=Object.getOwnPropertyDescriptors,b5=Object.getOwnPropertySymbols,Yve=Object.prototype.hasOwnProperty,Qve=Object.prototype.propertyIsEnumerable,j_=(t,e,n)=>e in t?qve(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gn=(t,e)=>{for(var n in e||(e={}))Yve.call(e,n)&&j_(t,n,e[n]);if(b5)for(var n of b5(e))Qve.call(e,n)&&j_(t,n,e[n]);return t},Es=(t,e)=>Kve(t,Gve(e)),Ce=(t,e,n)=>j_(t,typeof e!="symbol"?e+"":e,n);class Jve extends zae{constructor(e){super(e),Ce(this,"name",Uve),Ce(this,"events",new JI),Ce(this,"initialized",!1),Ce(this,"requestQueue",{state:Ua.idle,queue:[]}),Ce(this,"sessionRequestQueue",{state:Ua.idle,queue:[]}),Ce(this,"emittedSessionRequests",new vpe({limit:500})),Ce(this,"requestQueueDelay",Ie.ONE_SECOND),Ce(this,"expectedPairingMethodMap",new Map),Ce(this,"recentlyDeletedMap",new Map),Ce(this,"recentlyDeletedLimit",200),Ce(this,"relayMessageCache",[]),Ce(this,"pendingSessions",new Map),Ce(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Jr)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Ie.toMiliseconds(this.requestQueueDelay)))}),Ce(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=Es(gn({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=E0e(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:l,relays:d}=r;let u=s,h,f=!1;try{if(u){const R=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),f=R.active}}catch(R){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),R}if(!u||!f){const{topic:R,uri:S}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=R,h=S}if(!u){const{message:R}=Re("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(R)}const p=await this.client.core.crypto.generateKeyPair(),m=Jr.wc_sessionPropose.req.ttl||Ie.FIVE_MINUTES,g=Ar(m),w=Es(gn(gn({requiredNamespaces:i,optionalNamespaces:o,relays:d??[{protocol:Y7}],proposer:{publicKey:p,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),l&&{scopedProperties:l}),{id:Fa()}),b=hn("session_connect",w.id),{reject:y,resolve:x,done:v}=zu(m,x5),E=({id:R})=>{R===w.id&&(this.client.events.off("proposal_expire",E),this.pendingSessions.delete(w.id),this.events.emit(b,{error:{message:x5,code:0}}))};return this.client.events.on("proposal_expire",E),this.events.once(b,({error:R,session:S})=>{this.client.events.off("proposal_expire",E),R?y(R):S&&x(S)}),await this.sendProposeSession({proposal:w,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:w.id}}}),await this.setProposal(w.id,w),{uri:h,approval:v}}),Ce(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),Ce(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n==null?void 0:n.id)==null?void 0:r.toString(),trace:[td.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(N){throw o.setError(z0.no_internet_connection),N}try{await this.isValidProposalId(n==null?void 0:n.id)}catch(N){throw this.client.logger.error(`approve() -> proposal.get(${n==null?void 0:n.id}) failed`),o.setError(z0.proposal_not_found),N}try{await this.isValidApprove(n)}catch(N){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(z0.session_approve_namespace_validation_failure),N}const{id:a,relayProtocol:l,namespaces:d,sessionProperties:u,scopedProperties:h,sessionConfig:f}=n,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:m,proposer:g,requiredNamespaces:w,optionalNamespaces:b}=p;let y=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:m});y||(y=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:td.session_approve_started,properties:{topic:m,trace:[td.session_approve_started,td.session_namespaces_validation_success]}}));const x=await this.client.core.crypto.generateKeyPair(),v=g.publicKey,E=await this.client.core.crypto.generateSharedKey(x,v),R=gn(gn(gn({relay:{protocol:l??"irn"},namespaces:d,controller:{publicKey:x,metadata:this.client.metadata},expiry:Ar(rp)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),S=Pn.relay;y.addTrace(td.subscribing_session_topic);try{await this.client.core.relayer.subscribe(E,{transportType:S,internal:{skipSubscribe:!0}})}catch(N){throw y.setError(z0.subscribe_session_topic_failure),N}y.addTrace(td.subscribe_session_topic_success);const C=Es(gn({},R),{topic:E,requiredNamespaces:w,optionalNamespaces:b,pairingTopic:m,acknowledged:!1,self:R.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:x,transportType:Pn.relay});await this.client.session.set(E,C),y.addTrace(td.store_session);try{await this.sendApproveSession({sessionTopic:E,proposal:p,pairingProposalResponse:{relay:{protocol:l??"irn"},responderPublicKey:x},sessionSettleRequest:R,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),y.addTrace(td.session_approve_publish_success)}catch(N){throw this.client.logger.error(N),this.client.session.delete(E,Fn("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(E),N}return this.client.core.eventClient.deleteEvent({eventId:y.eventId}),await this.client.core.pairing.updateMetadata({topic:m,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:m}),await this.setExpiry(E,Ar(rp)),{topic:E,acknowledged:()=>Promise.resolve(this.client.session.get(E))}}),Ce(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Jr.wc_sessionPropose.reject}),await this.deleteProposal(r)}),Ce(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=zu(),l=Fa(),d=Fd().toString(),u=this.client.session.get(r).namespaces;return this.events.once(hn("session_update",l),({error:h})=>{h?a(h):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:l,relayRpcId:d}).catch(h=>{this.client.logger.error(h),this.client.session.update(r,{namespaces:u}),a(h)}),{acknowledged:i}}),Ce(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(l){throw this.client.logger.error("extend() -> isValidExtend() failed"),l}const{topic:r}=n,s=Fa(),{done:i,resolve:o,reject:a}=zu();return this.events.once(hn("session_extend",s),({error:l})=>{l?a(l):o()}),await this.setExpiry(r,Ar(rp)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(l=>{a(l)}),{acknowledged:i}}),Ce(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:r,request:s,topic:i,expiry:o=Jr.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);(a==null?void 0:a.transportType)===Pn.relay&&await this.confirmOnlineStateOrThrow();const l=Fa(),d=Fd().toString(),{done:u,resolve:h,reject:f}=zu(o,"Request expired. Please try again.");this.events.once(hn("session_request",l),({error:w,result:b})=>{w?f(w):h(b)});const p="wc_sessionRequest",m=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(m)return await this.sendRequest({clientRpcId:l,relayRpcId:d,topic:i,method:p,params:{request:Es(gn({},s),{expiryTimestamp:Ar(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:m}).catch(w=>f(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:l}),await u();const g={request:Es(gn({},s),{expiryTimestamp:Ar(o)}),chainId:r};return await Promise.all([new Promise(async w=>{await this.sendRequest({clientRpcId:l,relayRpcId:d,topic:i,method:p,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(l,g)}).catch(b=>f(b)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:l}),w()}),new Promise(async w=>{var b;if(!((b=a.sessionConfig)!=null&&b.disableDeepLink)){const y=await gpe(this.client.core.storage,w5);await fpe({id:l,topic:i,wcDeepLink:y})}w()}),u()]).then(w=>w[2])}),Ce(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===Pn.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);za(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):Eo(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(n)}),Ce(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=Fa(),i=Fd().toString(),{done:o,resolve:a,reject:l}=zu();this.events.once(hn("session_ping",s),({error:d})=>{d?l(d):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),Ce(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=Fd().toString(),a=Fa();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),Ce(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:Fn("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=Re("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),Ce(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>A0e(r,n)))),Ce(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),Ce(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Pn.link_mode:Pn.relay;o===Pn.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:l="",uri:d,domain:u,nonce:h,type:f,exp:p,nbf:m,methods:g=[],expiry:w}=n,b=[...n.resources||[]],{topic:y,uri:x}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:y,uri:x}});const v=await this.client.core.crypto.generateKeyPair(),E=f1(v);if(await Promise.all([this.client.auth.authKeys.set(m1,{responseTopic:E,publicKey:v}),this.client.auth.pairingTopics.set(E,{topic:E,pairingTopic:y})]),await this.client.core.relayer.subscribe(E,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${y}`),g.length>0){const{namespace:L}=Yh(a[0]);let B=jme(L,"request",g);h1(b)&&(B=Ome(B,b.pop())),b.push(B)}const R=w&&w>Jr.wc_sessionAuthenticate.req.ttl?w:Jr.wc_sessionAuthenticate.req.ttl,S={authPayload:{type:f??"caip122",chains:a,statement:l,aud:d,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:p,nbf:m,resources:b},requester:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:Ar(R)},C={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},N={requiredNamespaces:{},optionalNamespaces:C,relays:[{protocol:"irn"}],pairingTopic:y,proposer:{publicKey:v,metadata:this.client.metadata},expiryTimestamp:Ar(Jr.wc_sessionPropose.req.ttl),id:Fa()},{done:T,resolve:$,reject:U}=zu(R,"Request expired"),H=Fa(),K=hn("session_connect",N.id),I=hn("session_request",H),j=async({error:L,session:B})=>{this.events.off(I,F),L?U(L):B&&$({session:B})},F=async L=>{var B,V,X;if(await this.deletePendingAuthRequest(H,{message:"fulfilled",code:0}),L.error){const xe=Fn("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return L.error.code===xe.code?void 0:(this.events.off(K,j),U(L.error.message))}await this.deleteProposal(N.id),this.events.off(K,j);const{cacaos:ae,responder:ce}=L.result,ie=[],Te=[];for(const xe of ae){await l4({cacao:xe,projectId:this.client.core.projectId})||(this.client.logger.error(xe,"Signature verification failed"),U(Fn("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Pe}=xe,Y=h1(Pe.resources),me=[a_(Pe.iss)],le=kE(Pe.iss);if(Y){const tt=d4(Y),Ve=u4(Y);ie.push(...tt),me.push(...Ve)}for(const tt of me)Te.push(`${tt}:${le}`)}const ue=await this.client.core.crypto.generateSharedKey(v,ce.publicKey);let Q;ie.length>0&&(Q={topic:ue,acknowledged:!0,self:{publicKey:v,metadata:this.client.metadata},peer:ce,controller:ce.publicKey,expiry:Ar(rp),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:y,namespaces:D4([...new Set(ie)],[...new Set(Te)]),transportType:o},await this.client.core.relayer.subscribe(ue,{transportType:o}),await this.client.session.set(ue,Q),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:ce.metadata}),Q=this.client.session.get(ue)),(B=this.client.metadata.redirect)!=null&&B.linkMode&&(V=ce.metadata.redirect)!=null&&V.linkMode&&(X=ce.metadata.redirect)!=null&&X.universal&&r&&(this.client.core.addLinkModeSupportedApp(ce.metadata.redirect.universal),this.client.session.update(ue,{transportType:Pn.link_mode})),$({auths:ae,session:Q})};this.events.once(K,j),this.events.once(I,F);let P;try{if(i){const L=tc("wc_sessionAuthenticate",S,H);this.client.core.history.set(y,L);const B=await this.client.core.crypto.encode("",L,{type:lb,encoding:gd});P=xv(r,y,B)}else await Promise.all([this.sendRequest({topic:y,method:"wc_sessionAuthenticate",params:S,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:H}),this.sendRequest({topic:y,method:"wc_sessionPropose",params:N,expiry:Jr.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:N.id})])}catch(L){throw this.events.off(K,j),this.events.off(I,F),L}return await this.setProposal(N.id,N),await this.setAuthRequest(H,{request:Es(gn({},S),{verifyContext:{}}),pairingTopic:y,transportType:o}),{uri:P??x,response:T}}),Ce(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Pu.authenticated_session_approve_started]}});try{this.isInitialized()}catch(w){throw i.setError(H0.no_internet_connection),w}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(H0.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Pn.relay;a===Pn.relay&&await this.confirmOnlineStateOrThrow();const l=o.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),u=f1(l),h={type:wl,receiverPublicKey:l,senderPublicKey:d},f=[],p=[];for(const w of s){if(!await l4({cacao:w,projectId:this.client.core.projectId})){i.setError(H0.invalid_cacao);const E=Fn("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:E,encodeOpts:h}),new Error(E.message)}i.addTrace(Pu.cacaos_verified);const{p:b}=w,y=h1(b.resources),x=[a_(b.iss)],v=kE(b.iss);if(y){const E=d4(y),R=u4(y);f.push(...E),x.push(...R)}for(const E of x)p.push(`${E}:${v}`)}const m=await this.client.core.crypto.generateSharedKey(d,l);i.addTrace(Pu.create_authenticated_session_topic);let g;if((f==null?void 0:f.length)>0){g={topic:m,acknowledged:!0,self:{publicKey:d,metadata:this.client.metadata},peer:{publicKey:l,metadata:o.requester.metadata},controller:l,expiry:Ar(rp),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:D4([...new Set(f)],[...new Set(p)]),transportType:a},i.addTrace(Pu.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(m,{transportType:a})}catch(w){throw i.setError(H0.subscribe_authenticated_session_topic_failure),w}i.addTrace(Pu.subscribe_authenticated_session_topic_success),await this.client.session.set(m,g),i.addTrace(Pu.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Pu.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:d,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(w){throw i.setError(H0.authenticated_session_approve_publish_failure),w}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),Ce(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Pn.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),l=f1(o),d={type:wl,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:l,error:s,encodeOpts:d,rpcOpts:Jr.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),Ce(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return c7(r,s)}),Ce(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),Ce(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),Ce(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:l}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Fn("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(l.publicKey)&&await this.client.core.crypto.deleteKeyPair(l.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(w5).catch(d=>this.client.logger.warn(d)),this.getPendingSessionRequests().forEach(d=>{d.topic===s&&this.deletePendingSessionRequest(d.id,Fn("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=Ua.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),Ce(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(z0.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,Fn("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),Ce(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=Ua.idle,this.client.events.emit("session_request_expire",{id:n}))}),Ce(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),Ce(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),Ce(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,Ar(Jr.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),Ce(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=Pn.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),Ce(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||Ar(Jr.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),Ce(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:l,throwOnFailedPublish:d,appLink:u,tvf:h,publishOpts:f={}}=n,p=tc(s,i,l);let m;const g=!!u;try{const y=g?gd:yi;m=await this.client.core.crypto.encode(r,p,{encoding:y})}catch(y){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),y}let w;if($ve.includes(s)){const y=vo(JSON.stringify(p)),x=vo(m);w=await this.client.core.verify.register({id:x,decryptedId:y})}const b=gn(gn({},Jr[s].req),f);if(b.attestation=w,o&&(b.ttl=o),a&&(b.id=a),this.client.core.history.set(r,p),g){const y=xv(u,r,m);await global.Linking.openURL(y,this.client.name)}else b.tvf=Es(gn({},h),{correlationId:p.id}),d?(b.internal=Es(gn({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,m,b)):this.client.core.relayer.publish(r,m,b).catch(y=>this.client.logger.error(y));return p.id}),Ce(this,"sendProposeSession",async n=>{const{proposal:r,publishOpts:s}=n,i=tc("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:yi}),a=vo(JSON.stringify(i)),l=vo(o),d=await this.client.core.verify.register({id:l,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:Es(gn({},s),{publishMethod:"wc_proposeSession",attestation:d})})}),Ce(this,"sendApproveSession",async n=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=n,l=rx(i.id,s),d=await this.client.core.crypto.encode(i.pairingTopic,l,{encoding:yi}),u=tc("wc_sessionSettle",o,a==null?void 0:a.id),h=await this.client.core.crypto.encode(r,u,{encoding:yi});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:d,sessionSettlementRequest:h},opts:Es(gn({},a),{publishMethod:"wc_approveSession"})})}),Ce(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:l}=n,d=rx(r,i);let u;const h=l&&typeof(global==null?void 0:global.Linking)<"u";try{const m=h?gd:yi;u=await this.client.core.crypto.encode(s,d,Es(gn({},a||{}),{encoding:m}))}catch(m){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),m}let f,p;try{f=await this.client.core.history.get(s,r);const m=f.request;try{p=this.getTVFParams(r,m.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(m){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),m}if(h){const m=xv(l,s,u);await global.Linking.openURL(m,this.client.name)}else{const m=f.request.method,g=Jr[m].res;g.tvf=Es(gn({},p),{correlationId:r}),o?(g.internal=Es(gn({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(w=>this.client.logger.error(w))}await this.client.core.history.resolve(d)}),Ce(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:l}=n,d=hN(r,i);let u;const h=l&&typeof(global==null?void 0:global.Linking)<"u";try{const p=h?gd:yi;u=await this.client.core.crypto.encode(s,d,Es(gn({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),p}let f;try{f=await this.client.core.history.get(s,r)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),p}if(h){const p=xv(l,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=f.request.method,m=a||Jr[p].res;this.client.core.relayer.publish(s,u,m)}await this.client.core.history.resolve(d)}),Ce(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;cd(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{cd(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),Ce(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),Ce(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),Ce(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Ua.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ua.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=Ua.idle}),Ce(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,l=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:l}))switch(l){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${l}`)}}),Ce(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),Ce(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=Re("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),Ce(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),Ce(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:l}=s;try{const d=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),d==null||d.setError(zc.proposal_listener_not_found)),this.isValidConnect(gn({},s.params));const u=a.expiryTimestamp||Ar(Jr.wc_sessionPropose.req.ttl),h=gn({id:l,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(l,h);const f=await this.getVerifyContext({attestationId:i,hash:vo(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});d==null||d.addTrace(Ba.emit_session_proposal),this.client.events.emit("session_proposal",{id:l,params:h,verifyContext:f})}catch(d){await this.sendError({id:l,topic:r,error:d,rpcOpts:Jr.wc_sessionPropose.autoReject}),this.client.logger.error(d)}}),Ce(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(za(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const l=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l});const d=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:d});const u=await this.client.core.crypto.generateSharedKey(l,d);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:l});const h=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:n})}else if(Eo(r)){await this.deleteProposal(i);const o=hn("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),Ce(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:l,namespaces:d,sessionProperties:u,scopedProperties:h,sessionConfig:f}=r.params,p=[...this.pendingSessions.values()].find(w=>w.sessionTopic===n);if(!p)return this.client.logger.error(`Pending session not found for topic ${n}`);const m=this.client.proposal.get(p.proposalId),g=Es(gn(gn(gn({topic:n,relay:o,expiry:l,namespaces:d,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),f&&{sessionConfig:f}),{transportType:Pn.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(hn("session_connect",p.proposalId),{session:g}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),Ce(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;za(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(hn("session_approve",s),{})):Eo(r)&&(await this.client.session.delete(n,Fn("USER_DISCONNECTED")),this.events.emit(hn("session_approve",s),{error:r.error}))}),Ce(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=$0.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:Fn("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(gn({topic:n},s));try{$0.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(l){throw $0.delete(o),l}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),Ce(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),Ce(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=hn("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);za(r)?this.events.emit(hn("session_update",s),{}):Eo(r)&&this.events.emit(hn("session_update",s),{error:r.error})}),Ce(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,Ar(rp)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),Ce(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=hn("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);za(r)?this.events.emit(hn("session_extend",s),{}):Eo(r)&&this.events.emit(hn("session_extend",s),{error:r.error})}),Ce(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),Ce(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=hn("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);za(r)?this.events.emit(hn("session_ping",s),{}):Eo(r)&&this.events.emit(hn("session_ping",s),{error:r.error})},500)}),Ce(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),await Promise.all([new Promise(i=>{this.client.core.relayer.once(cr.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:Fn("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),Ce(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:l,encryptedId:d,transportType:u}=n,{id:h,params:f}=a;try{await this.isValidRequest(gn({topic:o},f));const p=this.client.session.get(o),m=await this.getVerifyContext({attestationId:l,hash:vo(JSON.stringify(tc("wc_sessionRequest",f,h))),encryptedId:d,metadata:p.peer.metadata,transportType:u}),g={id:h,topic:o,params:f,verifyContext:m};await this.setPendingSessionRequest(g),u===Pn.link_mode&&(r=p.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=p.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(p){await this.sendError({id:h,topic:o,error:p}),this.client.logger.error(p)}}),Ce(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=hn("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);za(r)?this.events.emit(hn("session_request",s),{result:r.result}):Eo(r)&&this.events.emit(hn("session_request",s),{error:r.error})}),Ce(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=$0.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(gn({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),$0.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),Ce(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),za(r)?this.events.emit(hn("session_request",s),{result:r.result}):Eo(r)&&this.events.emit(hn("session_request",s),{error:r.error})}),Ce(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:l}=n;try{const{requester:d,authPayload:u,expiryTimestamp:h}=i.params,f=await this.getVerifyContext({attestationId:o,hash:vo(JSON.stringify(i)),encryptedId:a,metadata:d.metadata,transportType:l}),p={requester:d,pairingTopic:s,id:i.id,authPayload:u,verifyContext:f,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:p,pairingTopic:s,transportType:l}),l===Pn.link_mode&&(r=d.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(d.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:f})}catch(d){this.client.logger.error(d);const u=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),f=this.getAppLinkIfEnabled(i.params.requester.metadata,l),p={type:wl,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:d,encodeOpts:p,rpcOpts:Jr.wc_sessionAuthenticate.autoReject,appLink:f})}}),Ce(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),Ce(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ua.idle,this.processSessionRequestQueue()},Ie.toMiliseconds(this.requestQueueDelay))}),Ce(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=hn("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(hn("session_request",i.request.id),{error:r})})}),Ce(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Ua.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),Ce(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=Ua.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),Ce(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:tc("wc_sessionPropose",Es(gn({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),Ce(this,"isValidConnect",async n=>{if(!li(n)){const{message:d}=Re("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(d)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:l}=n;if(kr(r)||await this.isValidPairingTopic(r),!U0e(l)){const{message:d}=Re("MISSING_OR_INVALID",`connect() relays: ${l}`);throw new Error(d)}if(!kr(s)&&bc(s)!==0){const d="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(d):this.client.logger.warn(d),this.validateNamespaces(s,"requiredNamespaces")}if(!kr(i)&&bc(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),kr(o)||this.validateSessionProps(o,"sessionProperties"),!kr(a)){this.validateSessionProps(a,"scopedProperties");const d=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>d.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(d)}`)}}),Ce(this,"validateNamespaces",(n,r)=>{const s=M0e(n,"connect()",r);if(s)throw new Error(s.message)}),Ce(this,"isValidApprove",async n=>{if(!li(n))throw new Error(Re("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const l=this.client.proposal.get(r),d=cS(s,"approve()");if(d)throw new Error(d.message);const u=L4(l.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!wr(i,!0)){const{message:h}=Re("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(kr(o)||this.validateSessionProps(o,"sessionProperties"),!kr(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(a).every(f=>h.has(f.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),Ce(this,"isValidReject",async n=>{if(!li(n)){const{message:i}=Re("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!B0e(s)){const{message:i}=Re("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),Ce(this,"isValidSessionSettleRequest",n=>{if(!li(n)){const{message:d}=Re("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(d)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!B7(r)){const{message:d}=Re("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(d)}const a=I0e(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const l=cS(i,"onSessionSettleRequest()");if(l)throw new Error(l.message);if(cd(o)){const{message:d}=Re("EXPIRED","onSessionSettleRequest()");throw new Error(d)}}),Ce(this,"isValidUpdate",async n=>{if(!li(n)){const{message:l}=Re("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(l)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=cS(s,"update()");if(o)throw new Error(o.message);const a=L4(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),Ce(this,"isValidExtend",async n=>{if(!li(n)){const{message:s}=Re("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),Ce(this,"isValidRequest",async n=>{if(!li(n)){const{message:l}=Re("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(l)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!U4(a,i)){const{message:l}=Re("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(l)}if(!$0e(s)){const{message:l}=Re("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(l)}if(!H0e(a,i,s.method)){const{message:l}=Re("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(l)}if(o&&!K0e(o,pS)){const{message:l}=Re("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${pS.min} and ${pS.max}`);throw new Error(l)}}),Ce(this,"isValidRespond",async n=>{var r;if(!li(n)){const{message:o}=Re("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n==null?void 0:n.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!F0e(i)){const{message:o}=Re("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),Ce(this,"isValidPing",async n=>{if(!li(n)){const{message:s}=Re("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),Ce(this,"isValidEmit",async n=>{if(!li(n)){const{message:a}=Re("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!U4(o,i)){const{message:a}=Re("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!z0e(s)){const{message:a}=Re("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!V0e(o,i,s.name)){const{message:a}=Re("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),Ce(this,"isValidDisconnect",async n=>{if(!li(n)){const{message:s}=Re("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),Ce(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!wr(s,!1))throw new Error("uri is required parameter");if(!wr(i,!1))throw new Error("domain is required parameter");if(!wr(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(l=>Yh(l).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Yh(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),Ce(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,l={verified:{verifyUrl:o.verifyUrl||jy,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Pn.link_mode){const u=this.getAppLinkIfEnabled(o,a);return l.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",l}const d=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});d&&(l.verified.origin=d.origin,l.verified.isScam=d.isScam,l.verified.validation=d.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(d){this.client.logger.warn(d)}return this.client.logger.debug(`Verify context: ${JSON.stringify(l)}`),l}),Ce(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=Re("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),Ce(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),Ce(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),Ce(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=Re("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),Ce(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,l,d,u,h,f;return!n||r!==Pn.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((d=(l=this.client.metadata)==null?void 0:l.redirect)==null?void 0:d.universal)!==""&&((u=n==null?void 0:n.redirect)==null?void 0:u.universal)!==void 0&&((h=n==null?void 0:n.redirect)==null?void 0:h.universal)!==""&&((f=n==null?void 0:n.redirect)==null?void 0:f.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),Ce(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n==null?void 0:n.redirect)==null?void 0:s.universal:void 0}),Ce(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=JD(n,"topic")||"",s=decodeURIComponent(JD(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Pn.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),Ce(this,"registerLinkModeListeners",async()=>{var n;if(mR()||Eu()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),Ce(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const l={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const d=this.extractTxHashesFromResult(r.request,s);l.txHashes=d,l.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(d){this.client.logger.warn("Error getting TVF params",d)}return l}),Ce(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=(n==null?void 0:n.data)||((r=n==null?void 0:n[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),Ce(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=Lve[i];if(i==="sui_signTransaction")return[gme(r.transactionBytes)];if(i==="near_signTransaction")return[i4(r)];if(i==="near_signTransactions")return r.map(l=>i4(l));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[cye({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return xl(r)?r.map(l=>o4(l)):[o4(r)];if(i==="cosmos_signDirect")return[wme(r)];if(typeof r=="string")return[r];const a=r[o.key];if(xl(a))return i==="solana_signAllTransactions"?a.map(l=>mme(l)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=Re("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(cr.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(m1)?this.client.auth.authKeys.get(m1):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===Pn.link_mode?gd:yi});IR(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:vo(r)})):fN(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(ho.expired,async e=>{const{topic:n,id:r}=K9(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,Re("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,Re("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(Yu.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Yu.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!wr(e,!1)){const{message:n}=Re("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=Re("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(cd(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=Re("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!wr(e,!1)){const{message:n}=Re("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=Re("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(cd(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=Re("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=Re("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(wr(e,!1)){const{message:n}=Re("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=Re("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!L0e(e)){const{message:n}=Re("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=Re("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(cd(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=Re("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}}class Zve extends Uf{constructor(e,n){super(e,n,Dve,RR),this.core=e,this.logger=n}}let Xve=class extends Uf{constructor(e,n){super(e,n,Mve,RR),this.core=e,this.logger=n}};class e1e extends Uf{constructor(e,n){super(e,n,Bve,RR,r=>r.id),this.core=e,this.logger=n}}class t1e extends Uf{constructor(e,n){super(e,n,Hve,mN,()=>m1),this.core=e,this.logger=n}}class n1e extends Uf{constructor(e,n){super(e,n,Vve,mN),this.core=e,this.logger=n}}class r1e extends Uf{constructor(e,n){super(e,n,Wve,mN,r=>r.id),this.core=e,this.logger=n}}var s1e=Object.defineProperty,i1e=(t,e,n)=>e in t?s1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mS=(t,e,n)=>i1e(t,typeof e!="symbol"?e+"":e,n);class o1e{constructor(e,n){this.core=e,this.logger=n,mS(this,"authKeys"),mS(this,"pairingTopics"),mS(this,"requests"),this.authKeys=new t1e(this.core,this.logger),this.pairingTopics=new n1e(this.core,this.logger),this.requests=new r1e(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var a1e=Object.defineProperty,c1e=(t,e,n)=>e in t?a1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ft=(t,e,n)=>c1e(t,typeof e!="symbol"?e+"":e,n);let l1e=class fz extends Fae{constructor(e){super(e),Ft(this,"protocol",dz),Ft(this,"version",uz),Ft(this,"name",fS.name),Ft(this,"metadata"),Ft(this,"core"),Ft(this,"logger"),Ft(this,"events",new $o.EventEmitter),Ft(this,"engine"),Ft(this,"session"),Ft(this,"proposal"),Ft(this,"pendingRequest"),Ft(this,"auth"),Ft(this,"signConfig"),Ft(this,"on",(r,s)=>this.events.on(r,s)),Ft(this,"once",(r,s)=>this.events.once(r,s)),Ft(this,"off",(r,s)=>this.events.off(r,s)),Ft(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Ft(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Ft(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Ft(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Ft(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Ft(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||fS.name,this.metadata=ape(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const n=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nb(qg({level:(e==null?void 0:e.logger)||fS.logger}));this.core=(e==null?void 0:e.core)||new Ove(e),this.logger=Ds(n,this.name),this.session=new Xve(this.core,this.logger),this.proposal=new Zve(this.core,this.logger),this.pendingRequest=new e1e(this.core,this.logger),this.engine=new Jve(this),this.auth=new o1e(this.core,this.logger)}static async init(e){const n=new fz(e);return await n.initialize(),n}get context(){return Ri(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var P_={exports:{}};(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof ec<"u"&&ec,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof ec<"u"&&ec||{},l={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function d(I){return I&&DataView.prototype.isPrototypeOf(I)}if(l.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(I){return I&&u.indexOf(Object.prototype.toString.call(I))>-1};function f(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(I)||I==="")throw new TypeError('Invalid character in header field name: "'+I+'"');return I.toLowerCase()}function p(I){return typeof I!="string"&&(I=String(I)),I}function m(I){var j={next:function(){var F=I.shift();return{done:F===void 0,value:F}}};return l.iterable&&(j[Symbol.iterator]=function(){return j}),j}function g(I){this.map={},I instanceof g?I.forEach(function(j,F){this.append(F,j)},this):Array.isArray(I)?I.forEach(function(j){if(j.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+j.length);this.append(j[0],j[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function(j){this.append(j,I[j])},this)}g.prototype.append=function(I,j){I=f(I),j=p(j);var F=this.map[I];this.map[I]=F?F+", "+j:j},g.prototype.delete=function(I){delete this.map[f(I)]},g.prototype.get=function(I){return I=f(I),this.has(I)?this.map[I]:null},g.prototype.has=function(I){return this.map.hasOwnProperty(f(I))},g.prototype.set=function(I,j){this.map[f(I)]=p(j)},g.prototype.forEach=function(I,j){for(var F in this.map)this.map.hasOwnProperty(F)&&I.call(j,this.map[F],F,this)},g.prototype.keys=function(){var I=[];return this.forEach(function(j,F){I.push(F)}),m(I)},g.prototype.values=function(){var I=[];return this.forEach(function(j){I.push(j)}),m(I)},g.prototype.entries=function(){var I=[];return this.forEach(function(j,F){I.push([F,j])}),m(I)},l.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function w(I){if(!I._noBody){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}}function b(I){return new Promise(function(j,F){I.onload=function(){j(I.result)},I.onerror=function(){F(I.error)}})}function y(I){var j=new FileReader,F=b(j);return j.readAsArrayBuffer(I),F}function x(I){var j=new FileReader,F=b(j),P=/charset=([A-Za-z0-9_-]+)/.exec(I.type),L=P?P[1]:"utf-8";return j.readAsText(I,L),F}function v(I){for(var j=new Uint8Array(I),F=new Array(j.length),P=0;P<j.length;P++)F[P]=String.fromCharCode(j[P]);return F.join("")}function E(I){if(I.slice)return I.slice(0);var j=new Uint8Array(I.byteLength);return j.set(new Uint8Array(I)),j.buffer}function R(){return this.bodyUsed=!1,this._initBody=function(I){this.bodyUsed=this.bodyUsed,this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:l.blob&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:l.formData&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():l.arrayBuffer&&l.blob&&d(I)?(this._bodyArrayBuffer=E(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(I)||h(I))?this._bodyArrayBuffer=E(I):this._bodyText=I=Object.prototype.toString.call(I):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var I=w(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var I=w(this);return I||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(l.blob)return this.blob().then(y);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var I=w(this);if(I)return I;if(this._bodyBlob)return x(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(v(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(T)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function C(I){var j=I.toUpperCase();return S.indexOf(j)>-1?j:I}function N(I,j){if(!(this instanceof N))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');j=j||{};var F=j.body;if(I instanceof N){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,j.headers||(this.headers=new g(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,!F&&I._bodyInit!=null&&(F=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=j.credentials||this.credentials||"same-origin",(j.headers||!this.headers)&&(this.headers=new g(j.headers)),this.method=C(j.method||this.method||"GET"),this.mode=j.mode||this.mode||null,this.signal=j.signal||this.signal||function(){if("AbortController"in a){var B=new AbortController;return B.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&F)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(F),(this.method==="GET"||this.method==="HEAD")&&(j.cache==="no-store"||j.cache==="no-cache")){var P=/([?&])_=[^&]*/;if(P.test(this.url))this.url=this.url.replace(P,"$1_="+new Date().getTime());else{var L=/\?/;this.url+=(L.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}N.prototype.clone=function(){return new N(this,{body:this._bodyInit})};function T(I){var j=new FormData;return I.trim().split("&").forEach(function(F){if(F){var P=F.split("="),L=P.shift().replace(/\+/g," "),B=P.join("=").replace(/\+/g," ");j.append(decodeURIComponent(L),decodeURIComponent(B))}}),j}function $(I){var j=new g,F=I.replace(/\r?\n[\t ]+/g," ");return F.split("\r").map(function(P){return P.indexOf(`
`)===0?P.substr(1,P.length):P}).forEach(function(P){var L=P.split(":"),B=L.shift().trim();if(B){var V=L.join(":").trim();try{j.append(B,V)}catch(X){console.warn("Response "+X.message)}}}),j}R.call(N.prototype);function U(I,j){if(!(this instanceof U))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(j||(j={}),this.type="default",this.status=j.status===void 0?200:j.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=j.statusText===void 0?"":""+j.statusText,this.headers=new g(j.headers),this.url=j.url||"",this._initBody(I)}R.call(U.prototype),U.prototype.clone=function(){return new U(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},U.error=function(){var I=new U(null,{status:200,statusText:""});return I.ok=!1,I.status=0,I.type="error",I};var H=[301,302,303,307,308];U.redirect=function(I,j){if(H.indexOf(j)===-1)throw new RangeError("Invalid status code");return new U(null,{status:j,headers:{location:I}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(j,F){this.message=j,this.name=F;var P=Error(j);this.stack=P.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function K(I,j){return new Promise(function(F,P){var L=new N(I,j);if(L.signal&&L.signal.aborted)return P(new o.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function V(){B.abort()}B.onload=function(){var ce={statusText:B.statusText,headers:$(B.getAllResponseHeaders()||"")};L.url.indexOf("file://")===0&&(B.status<200||B.status>599)?ce.status=200:ce.status=B.status,ce.url="responseURL"in B?B.responseURL:ce.headers.get("X-Request-URL");var ie="response"in B?B.response:B.responseText;setTimeout(function(){F(new U(ie,ce))},0)},B.onerror=function(){setTimeout(function(){P(new TypeError("Network request failed"))},0)},B.ontimeout=function(){setTimeout(function(){P(new TypeError("Network request timed out"))},0)},B.onabort=function(){setTimeout(function(){P(new o.DOMException("Aborted","AbortError"))},0)};function X(ce){try{return ce===""&&a.location.href?a.location.href:ce}catch{return ce}}if(B.open(L.method,X(L.url),!0),L.credentials==="include"?B.withCredentials=!0:L.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&(l.blob?B.responseType="blob":l.arrayBuffer&&(B.responseType="arraybuffer")),j&&typeof j.headers=="object"&&!(j.headers instanceof g||a.Headers&&j.headers instanceof a.Headers)){var ae=[];Object.getOwnPropertyNames(j.headers).forEach(function(ce){ae.push(f(ce)),B.setRequestHeader(ce,p(j.headers[ce]))}),L.headers.forEach(function(ce,ie){ae.indexOf(ie)===-1&&B.setRequestHeader(ie,ce)})}else L.headers.forEach(function(ce,ie){B.setRequestHeader(ie,ce)});L.signal&&(L.signal.addEventListener("abort",V),B.onreadystatechange=function(){B.readyState===4&&L.signal.removeEventListener("abort",V)}),B.send(typeof L._bodyInit>"u"?null:L._bodyInit)})}return K.polyfill=!0,a.fetch||(a.fetch=K,a.Headers=g,a.Request=N,a.Response=U),o.Headers=g,o.Request=N,o.Response=U,o.fetch=K,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(P_,P_.exports);var d1e=P_.exports;const v5=Ug(d1e);var u1e=Object.defineProperty,h1e=Object.defineProperties,f1e=Object.getOwnPropertyDescriptors,E5=Object.getOwnPropertySymbols,p1e=Object.prototype.hasOwnProperty,m1e=Object.prototype.propertyIsEnumerable,C5=(t,e,n)=>e in t?u1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,N5=(t,e)=>{for(var n in e||(e={}))p1e.call(e,n)&&C5(t,n,e[n]);if(E5)for(var n of E5(e))m1e.call(e,n)&&C5(t,n,e[n]);return t},A5=(t,e)=>h1e(t,f1e(e));const g1e={Accept:"application/json","Content-Type":"application/json"},y1e="POST",S5={headers:g1e,method:y1e},T5=10;let Ta=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new $o.EventEmitter,this.isAvailable=!1,this.registering=!1,!V4(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=kl(e),r=await(await v5(this.url,A5(N5({},S5),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!V4(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=kl({id:1,jsonrpc:"2.0",method:"test",params:[]});await v5(e,A5(N5({},S5),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?mf(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=hN(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return z7(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>T5&&this.events.setMaxListeners(T5)}};const _5="error",w1e="wss://relay.walletconnect.org",x1e="wc",b1e="universal_provider",bv=`${x1e}@2:${b1e}:`,pz="https://rpc.walletconnect.org/v1/",mz="generic",v1e=`${pz}bundler`,zo={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function jR(t){return t==null||typeof t!="object"&&typeof t!="function"}function gz(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function yz(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const E1e="[object RegExp]",wz="[object String]",xz="[object Number]",bz="[object Boolean]",vz="[object Arguments]",C1e="[object Symbol]",N1e="[object Date]",A1e="[object Map]",S1e="[object Set]",T1e="[object Array]",_1e="[object ArrayBuffer]",k1e="[object Object]",I1e="[object DataView]",R1e="[object Uint8Array]",j1e="[object Uint8ClampedArray]",P1e="[object Uint16Array]",O1e="[object Uint32Array]",D1e="[object Int8Array]",M1e="[object Int16Array]",U1e="[object Int32Array]",L1e="[object Float32Array]",B1e="[object Float64Array]";function PR(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function $1e(t,e){return Fp(t,void 0,t,new Map,e)}function Fp(t,e,n,r=new Map,s=void 0){const i=s==null?void 0:s(t,e,n,r);if(i!=null)return i;if(jR(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Fp(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,l]of t)o.set(a,Fp(l,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(Fp(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(PR(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Fp(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Qu(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Qu(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Qu(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Qu(o,t,n,r,s),o}if(typeof t=="object"&&F1e(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Qu(o,t,n,r,s),o}return t}function Qu(t,e,n=t,r,s){const i=[...Object.keys(e),...gz(e)];for(let o=0;o<i.length;o++){const a=i[o],l=Object.getOwnPropertyDescriptor(t,a);(l==null||l.writable)&&(t[a]=Fp(e[a],a,n,r,s))}}function F1e(t){switch(yz(t)){case vz:case T1e:case _1e:case I1e:case bz:case N1e:case L1e:case B1e:case D1e:case M1e:case U1e:case A1e:case xz:case k1e:case E1e:case S1e:case wz:case C1e:case R1e:case j1e:case P1e:case O1e:return!0;default:return!1}}function z1e(t,e){return $1e(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case xz:case wz:case bz:{const o=new t.constructor(t==null?void 0:t.valueOf());return Qu(o,t),o}case vz:{const o={};return Qu(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function k5(t){return z1e(t)}function I5(t){return t!==null&&typeof t=="object"&&yz(t)==="[object Arguments]"}function R5(t){return typeof t=="object"&&t!==null}function H1e(){}function V1e(t){return PR(t)}function W1e(t){var n;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const r=t[Symbol.toStringTag];return r==null||!((n=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&n.writable)?!1:t.toString()===`[object ${r}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function q1e(t){if(jR(t))return t;if(Array.isArray(t)||PR(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function K1e(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=O_(s,o,r,new Map)}return s}function O_(t,e,n,r){if(jR(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return q1e(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...gz(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],l=t[o];if(I5(a)&&(a={...a}),I5(l)&&(l={...l}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=k5(a)),Array.isArray(a))if(typeof l=="object"&&l!=null){const u=[],h=Reflect.ownKeys(l);for(let f=0;f<h.length;f++){const p=h[f];u[p]=l[p]}l=u}else l=[];const d=n(l,a,o,t,e,r);d!=null?t[o]=d:Array.isArray(a)||R5(l)&&R5(a)?t[o]=O_(l,a,n,r):l==null&&W1e(a)?t[o]=O_({},a,n,r):l==null&&V1e(a)?t[o]=k5(a):(l===void 0||a!==void 0)&&(t[o]=a)}return t}function G1e(t,...e){return K1e(t,...e,H1e)}var Y1e=Object.defineProperty,Q1e=Object.defineProperties,J1e=Object.getOwnPropertyDescriptors,j5=Object.getOwnPropertySymbols,Z1e=Object.prototype.hasOwnProperty,X1e=Object.prototype.propertyIsEnumerable,P5=(t,e,n)=>e in t?Y1e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vv=(t,e)=>{for(var n in e||(e={}))Z1e.call(e,n)&&P5(t,n,e[n]);if(j5)for(var n of j5(e))X1e.call(e,n)&&P5(t,n,e[n]);return t},eEe=(t,e)=>Q1e(t,J1e(e));function Xi(t,e,n){var r;const s=Yh(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${pz}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function Lf(t){return t.includes(":")?t.split(":")[1]:t}function Ez(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function tEe(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function O5(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n==null?void 0:n.chains)==null?void 0:r.length)&&((s=n==null?void 0:n.chains)==null?void 0:s.length)>0}))}function Ev(t={},e={}){const n=O5(D5(t)),r=O5(D5(e));return G1e(n,r)}function D5(t){var e,n,r,s,i;const o={};if(!bc(t))return o;for(const[a,l]of Object.entries(t)){const d=uN(a)?[a]:l.chains,u=l.methods||[],h=l.events||[],f=l.rpcMap||{},p=$p(a);o[p]=eEe(vv(vv({},o[p]),l),{chains:xc(d,(e=o[p])==null?void 0:e.chains),methods:xc(u,(n=o[p])==null?void 0:n.methods),events:xc(h,(r=o[p])==null?void 0:r.events)}),(bc(f)||bc(((s=o[p])==null?void 0:s.rpcMap)||{}))&&(o[p].rpcMap=vv(vv({},f),(i=o[p])==null?void 0:i.rpcMap))}return o}function M5(t){return t.includes(":")?t.split(":")[2]:t}function U5(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=uN(n)?[n]:r.chains?r.chains:Ez(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function gS(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const Cz={},ln=t=>Cz[t],yS=(t,e)=>{Cz[t]=e};var nEe=Object.defineProperty,L5=Object.getOwnPropertySymbols,rEe=Object.prototype.hasOwnProperty,sEe=Object.prototype.propertyIsEnumerable,B5=(t,e,n)=>e in t?nEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$5=(t,e)=>{for(var n in e||(e={}))rEe.call(e,n)&&B5(t,n,e[n]);if(L5)for(var n of L5(e))sEe.call(e,n)&&B5(t,n,e[n]);return t};const F5="eip155",iEe=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],oEe=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,wS=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,z5=t=>Object.keys(t).filter(e=>iEe.includes(e)).reduce((e,n)=>(e[n]=t[n],e),{}),aEe=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!bc(s)&&!bc(r))return;const o=z5(r);for(const a of n){const l=oEe(a);if(!l)continue;i[wS(l)]=o;const d=s==null?void 0:s[`${F5}:${l}`];if(d){const u=d==null?void 0:d[`${F5}:${l}:${e}`];i[wS(l)]=$5($5({},i[wS(l)]),z5(u||d))}}for(const[a,l]of Object.entries(i))Object.keys(l).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var cEe=Object.defineProperty,lEe=(t,e,n)=>e in t?cEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sp=(t,e,n)=>lEe(t,typeof e!="symbol"?e+"":e,n);class dEe{constructor(e){sp(this,"name","polkadot"),sp(this,"client"),sp(this,"httpProviders"),sp(this,"events"),sp(this,"namespace"),sp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Lf(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}}var uEe=Object.defineProperty,hEe=Object.defineProperties,fEe=Object.getOwnPropertyDescriptors,H5=Object.getOwnPropertySymbols,pEe=Object.prototype.hasOwnProperty,mEe=Object.prototype.propertyIsEnumerable,D_=(t,e,n)=>e in t?uEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V5=(t,e)=>{for(var n in e||(e={}))pEe.call(e,n)&&D_(t,n,e[n]);if(H5)for(var n of H5(e))mEe.call(e,n)&&D_(t,n,e[n]);return t},W5=(t,e)=>hEe(t,fEe(e)),ip=(t,e,n)=>D_(t,typeof e!="symbol"?e+"":e,n);class gEe{constructor(e){ip(this,"name","eip155"),ip(this,"client"),ip(this,"chainId"),ip(this,"namespace"),ip(this,"httpProviders"),ip(this,"events"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n),this.chainId=parseInt(e),this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||Xi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(Lf(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],l=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const d=this.client.session.get(e.topic),u=((o=d==null?void 0:d.sessionProperties)==null?void 0:o.capabilities)||{},h=`${a}${l.join(",")}`,f=u==null?void 0:u[h];if(f)return f;let p;try{p=aEe(d,a,l)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(p)return p;const m=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:W5(V5({},d.sessionProperties||{}),{capabilities:W5(V5({},u||{}),{[h]:m})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return m}async getCallStatus(e){var n,r;const s=this.client.session.get(e.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from bundler",l,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tc("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${v1e}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}}var yEe=Object.defineProperty,wEe=(t,e,n)=>e in t?yEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,op=(t,e,n)=>wEe(t,typeof e!="symbol"?e+"":e,n);class xEe{constructor(e){op(this,"name","solana"),op(this,"client"),op(this,"httpProviders"),op(this,"events"),op(this,"namespace"),op(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Lf(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}}var bEe=Object.defineProperty,vEe=(t,e,n)=>e in t?bEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ap=(t,e,n)=>vEe(t,typeof e!="symbol"?e+"":e,n);class EEe{constructor(e){ap(this,"name","cosmos"),ap(this,"client"),ap(this,"httpProviders"),ap(this,"events"),ap(this,"namespace"),ap(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Lf(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}}var CEe=Object.defineProperty,NEe=(t,e,n)=>e in t?CEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cp=(t,e,n)=>NEe(t,typeof e!="symbol"?e+"":e,n);class AEe{constructor(e){cp(this,"name","algorand"),cp(this,"client"),cp(this,"httpProviders"),cp(this,"events"),cp(this,"namespace"),cp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(!this.httpProviders[e]){const r=n||Xi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Fo(new Ta(r,ln("disableProviderPing")))}}var SEe=Object.defineProperty,TEe=(t,e,n)=>e in t?SEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lp=(t,e,n)=>TEe(t,typeof e!="symbol"?e+"":e,n);class _Ee{constructor(e){lp(this,"name","cip34"),lp(this,"client"),lp(this,"httpProviders"),lp(this,"events"),lp(this,"namespace"),lp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=Lf(n);e[s]=this.createHttpProvider(s,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}getCardanoRPCUrl(e){const n=this.namespace.rpcMap;if(n)return n[e]}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}}var kEe=Object.defineProperty,IEe=(t,e,n)=>e in t?kEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dp=(t,e,n)=>IEe(t,typeof e!="symbol"?e+"":e,n);class REe{constructor(e){dp(this,"name","elrond"),dp(this,"client"),dp(this,"httpProviders"),dp(this,"events"),dp(this,"namespace"),dp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Lf(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}}var jEe=Object.defineProperty,PEe=(t,e,n)=>e in t?jEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,up=(t,e,n)=>PEe(t,typeof e!="symbol"?e+"":e,n);class OEe{constructor(e){up(this,"name","multiversx"),up(this,"client"),up(this,"httpProviders"),up(this,"events"),up(this,"namespace"),up(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Lf(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}}var DEe=Object.defineProperty,MEe=(t,e,n)=>e in t?DEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hp=(t,e,n)=>MEe(t,typeof e!="symbol"?e+"":e,n);class UEe{constructor(e){hp(this,"name","near"),hp(this,"client"),hp(this,"httpProviders"),hp(this,"events"),hp(this,"namespace"),hp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||Xi(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace);return typeof r>"u"?void 0:new Fo(new Ta(r,ln("disableProviderPing")))}}var LEe=Object.defineProperty,BEe=(t,e,n)=>e in t?LEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fp=(t,e,n)=>BEe(t,typeof e!="symbol"?e+"":e,n);class $Ee{constructor(e){fp(this,"name","tezos"),fp(this,"client"),fp(this,"httpProviders"),fp(this,"events"),fp(this,"namespace"),fp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||Xi(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{e[n]=this.createHttpProvider(n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace);return typeof r>"u"?void 0:new Fo(new Ta(r))}}var FEe=Object.defineProperty,zEe=(t,e,n)=>e in t?FEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pp=(t,e,n)=>zEe(t,typeof e!="symbol"?e+"":e,n);class HEe{constructor(e){pp(this,"name",mz),pp(this,"client"),pp(this,"httpProviders"),pp(this,"events"),pp(this,"namespace"),pp(this,"chainId"),this.namespace=e.namespace,this.events=ln("events"),this.client=ln("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(zo.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return Yh(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{const i=Yh(s);r[i.reference]=this.createHttpProvider(s)}),r}getHttpProvider(e){const n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Xi(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fo(new Ta(r,ln("disableProviderPing")))}}var VEe=Object.defineProperty,WEe=Object.defineProperties,qEe=Object.getOwnPropertyDescriptors,q5=Object.getOwnPropertySymbols,KEe=Object.prototype.hasOwnProperty,GEe=Object.prototype.propertyIsEnumerable,M_=(t,e,n)=>e in t?VEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cv=(t,e)=>{for(var n in e||(e={}))KEe.call(e,n)&&M_(t,n,e[n]);if(q5)for(var n of q5(e))GEe.call(e,n)&&M_(t,n,e[n]);return t},xS=(t,e)=>WEe(t,qEe(e)),co=(t,e,n)=>M_(t,typeof e!="symbol"?e+"":e,n);let YEe=class Nz{constructor(e){co(this,"client"),co(this,"namespaces"),co(this,"optionalNamespaces"),co(this,"sessionProperties"),co(this,"scopedProperties"),co(this,"events",new JI),co(this,"rpcProviders",{}),co(this,"session"),co(this,"providerOpts"),co(this,"logger"),co(this,"uri"),co(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nb(qg({level:(e==null?void 0:e.logger)||_5})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const n=new Nz(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Cv({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,rx(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Fn("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=U5(this.session.namespaces);this.namespaces=Ev(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){const{uri:n,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=U5(s.namespaces);return this.namespaces=Ev(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(!xl(n))return;for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}catch(n){this.logger.warn("Failed to cleanup pending pairings",n)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await l1e.init({core:this.providerOpts.core,logger:this.providerOpts.logger||_5,relayUrl:this.providerOpts.relayUrl||w1e,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>$p(n)))];yS("client",this.client),yS("events",this.events),yS("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=tEe(n,this.session);if((r==null?void 0:r.length)===0)return;const s=Ez(r),i=Ev(this.namespaces,this.optionalNamespaces),o=xS(Cv({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new gEe({namespace:o});break;case"algorand":this.rpcProviders[n]=new AEe({namespace:o});break;case"solana":this.rpcProviders[n]=new xEe({namespace:o});break;case"cosmos":this.rpcProviders[n]=new EEe({namespace:o});break;case"polkadot":this.rpcProviders[n]=new dEe({namespace:o});break;case"cip34":this.rpcProviders[n]=new _Ee({namespace:o});break;case"elrond":this.rpcProviders[n]=new REe({namespace:o});break;case"multiversx":this.rpcProviders[n]=new OEe({namespace:o});break;case"near":this.rpcProviders[n]=new UEe({namespace:o});break;case"tezos":this.rpcProviders[n]=new $Ee({namespace:o});break;default:this.rpcProviders[n]=new HEe({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&xl(o)&&this.events.emit("accountsChanged",o.map(M5))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,l=$p(o),d=gS(o)!==gS(a)?`${l}:${gS(a)}`:o;this.onChainChanged(d)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=xS(Cv({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",xS(Cv({},Fn("USER_DISCONNECTED")),{data:e.topic})))}),this.on(zo.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[mz]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Ev(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>$p(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=$p(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(r,s);const i=this.getProvider(r).getDefaultChain();n?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e})):this.getProvider(r).setDefaultChain(s),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(l=>l.includes(`${r}:`)).map(M5);if(!xl(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${bv}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${bv}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${bv}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(bv)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}},Ou=null;const qi={getSIWX(){return fe.state.siwx},async initializeIfEnabled(t=M.getActiveCaipAddress()){var i,o,a;const e=fe.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if(M.checkIfSupportedNetwork(n,`${n}:${r}`))try{if((i=fe.state.remoteFeatures)!=null&&i.emailCapture){const d=(o=M.getAccountData(n))==null?void 0:o.user;await Dt.open({view:"DataCapture",data:{email:(d==null?void 0:d.email)??void 0}});return}if(Ou&&await Ou,(await e.getSessions(`${n}:${r}`,s)).length)return;await Dt.open({view:"SIWXSignMessage"})}catch(l){console.error("SIWXUtil:initializeIfEnabled",l),Lt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(l)}),await((a=Oe._getClient())==null?void 0:a.disconnect().catch(console.error)),ut.reset("Connect"),cc.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=fe.state.siwx,e=Le.getPlainAddress(M.getActiveCaipAddress()),n=oy(),r=Oe._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),i=s.toString();ke.getConnectorId(n.chainNamespace)===ne.CONNECTOR_ID.AUTH&&ut.pushTransactionStack({});const a=await r.signMessage(i);await t.addSession({data:s,message:i,signature:a}),M.setLastConnectedSIWECaipNetwork(n),Dt.close(),Lt.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){(!Dt.state.open||ut.state.view==="ApproveTransaction")&&await Dt.open({view:"SIWXSignMessage"}),cc.showError("Error signing message"),Lt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(s)}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var t;try{const e=this.getSIWX();if((t=e==null?void 0:e.getRequired)==null?void 0:t.call(e)){const r=M.getLastConnectedSIWECaipNetwork();if(r){const s=await(e==null?void 0:e.getSessions(r==null?void 0:r.caipNetworkId,Le.getPlainAddress(M.getActiveCaipAddress())||""));s&&s.length>0?await M.switchActiveNetwork(r):await Oe.disconnect()}else await Oe.disconnect()}else Dt.close();Dt.close(),Lt.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const t=this.getSIWX(),e=M.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await(t==null?void 0:t.getSessions(r.caipNetworkId,Le.getPlainAddress(M.getActiveCaipAddress())||""));s&&n.push(...s)})),n},async getSessions(t){const e=fe.state.siwx;let n=t==null?void 0:t.address;if(!n){const s=M.getActiveCaipAddress();n=Le.getPlainAddress(s)}let r=t==null?void 0:t.caipNetworkId;if(!r){const s=M.getActiveCaipNetwork();r=s==null?void 0:s.caipNetworkId}return e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){var e;const t=this.getSIWX();if(t){const n=ut.state.view==="ApproveTransaction",r=ut.state.view==="SIWXSignMessage";if(n||r)return((e=t.getRequired)==null?void 0:e.call(t))&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){var h;const i=qi.getSIWX(),o=oy();if(!i||!s.includes(ne.CHAIN.EVM)||(h=fe.state.remoteFeatures)!=null&&h.emailCapture){const f=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:f.address,chainId:f.chainId,accounts:f.accounts}}const a=`${s}:${e}`,l=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),d={accountAddress:l.accountAddress,chainId:l.chainId,domain:l.domain,uri:l.uri,version:l.version,nonce:l.nonce,notBefore:l.notBefore,statement:l.statement,resources:l.resources,requestId:l.requestId,issuedAt:l.issuedAt,expirationTime:l.expirationTime,serializedMessage:l.toString()},u=await t.connect({chainId:e,socialUri:n,siwxMessage:d,preferredAccountType:r});return d.accountAddress=u.address,d.serializedMessage=u.message||"",u.signature&&u.message&&await qi.addEmbeddedWalletSession(d,u.message,u.signature),M.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(t,e,n){if(Ou)return Ou;const r=qi.getSIWX();return r?(Ou=r.addSession({data:t,message:e,signature:n}).finally(()=>{Ou=null}),Ou):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){var d,u,h;const r=qi.getSIWX(),s=oy(),i=new Set(e.map(f=>f.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:((d=oy())==null?void 0:d.caipNetworkId)||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(f=>f!==o.chainId)]});cc.showLoading("Authenticating...",{autoClose:!1});const l={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:(u=a.session.peer.metadata.icons)==null?void 0:u[0],type:"WALLET_CONNECT"};if(M.setAccountProp("connectedWalletInfo",l,Array.from(i)[0]),(h=a==null?void 0:a.auths)!=null&&h.length){const f=a.auths.map(p=>{const m=t.client.formatAuthMessage({request:p.p,iss:p.p.iss});return{data:{...p.p,accountAddress:p.p.iss.split(":").slice(-1).join(""),chainId:p.p.iss.split(":").slice(2,4).join(":"),uri:p.p.aud,version:p.p.version||o.version,expirationTime:p.p.exp,issuedAt:p.p.iat,notBefore:p.p.nbf},message:m,signature:p.s.s,cacao:p}});try{await r.setSessions(f),s&&M.setLastConnectedSIWECaipNetwork(s),Lt.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:qi.getSIWXEventProperties()})}catch(p){throw console.error("SIWX:universalProviderAuth - failed to set sessions",p),Lt.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:qi.getSIWXEventProperties(p)}),await t.disconnect().catch(console.error),p}finally{cc.hide()}}return!0},getSIWXEventProperties(t){var n;const e=M.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:((n=M.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||"",isSmartAccount:Ws(e)===fr.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?Le.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},Wt={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",EIP155:ne.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH",getSDKVersionWarningMessage(t,e){return`
     @@@@@@@           @@@@@@@@@@@@@@@@@@      
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@   @@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@   @@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@  @@@@@@@@@@@@@
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@   @@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@   @@@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@   @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
      @@@@@            @@@@@@@@@@@@@@@@@@  
      
AppKit SDK version ${t} is outdated. Latest version is ${e}. Please update to the latest version for bug fixes and new features.
            
Changelog: https://github.com/reown-com/appkit/releases
NPM Registry: https://www.npmjs.com/package/@reown/appkit`}},ic={ConnectorExplorerIds:{[ne.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ne.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ne.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[ne.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[ne.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[Wt.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[Wt.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[Wt.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[Wt.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[Wt.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[Wt.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[Wt.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[Wt.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[Wt.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[Wt.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[Wt.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[Wt.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700"},ConnectorImageIds:{[ne.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ne.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ne.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[ne.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[ne.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[ne.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[ne.CONNECTOR_ID.INJECTED]:"Browser Wallet",[ne.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[ne.CONNECTOR_ID.COINBASE]:"Coinbase",[ne.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[ne.CONNECTOR_ID.LEDGER]:"Ledger",[ne.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[ne.CONNECTOR_ID.INJECTED]:"INJECTED",[ne.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[ne.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[ne.CONNECTOR_ID.AUTH]:"AUTH",[Wt.CONNECTOR_TYPE_AUTH]:"AUTH"}},nr={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${Wt.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())},getActiveNamespaceConnectedToAuth(){const t=M.state.activeChain;return ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>ke.getConnectorId(e)===ne.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return ne.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(r=>r!==t):[]},getConnectorStorageInfo(t,e){const r=ye.getConnections()[e]??[];return{hasDisconnected:ye.isConnectorDisconnected(t,e),hasConnected:r.some(s=>nr.isLowerCaseMatch(s.connectorId,t))}}},QEe={extractVersion(t){var r;if(!t||typeof t!="string")return null;const e=/(?:[~^>=<]+\s*)?(?<version>\d+(?:\.\d+){0,2})(?:-[a-zA-Z]+\.\d+)?/u,n=t.match(e);return((r=n==null?void 0:n.groups)==null?void 0:r.version)||null},checkSDKVersion(t){this.extractVersion(t)},isValidVersion(t){return typeof t=="string"&&/^\d+\.\d+\.\d+$/u.test(t)},isOlder(t,e){const n=this.extractVersion(t),r=this.extractVersion(e);if(!n||!r)return!1;function s(a){const l=a.split(".").map(Number);for(;l.length<3;)l.push(0);return l}const i=s(n),o=s(r);for(let a=0;a<Math.max(i.length,o.length);a+=1){const l=i[a]||0,d=o[a]||0;if(l<d)return!0;if(l>d)return!1}return!1}},JEe=new AbortController,_s={EmbeddedWalletAbortController:JEe,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${iy()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},Az={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:dF.asset,84532:xie.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(Az.TOKEN_ADDRESSES_BY_SYMBOL).find(([n,r])=>Object.values(r).includes(t))??[];return e}},ZEe={createLogger(t,e="error"){const n=qg({level:e}),{logger:r}=XI({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},XEe="rpc.walletconnect.org";function K5(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const bS=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],vp={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===XEe}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:ne.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${ne.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){var s,i,o;const r=(o=(i=(s=t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return bS.includes(e)?K5(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){var f,p,m,g,w,b,y;const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=(m=(p=(f=t.rpcUrls)==null?void 0:f.default)==null?void 0:p.http)==null?void 0:m[0],a=this.getDefaultRpcUrl(t,i,n),l=((b=(w=(g=t==null?void 0:t.rpcUrls)==null?void 0:g.chainDefault)==null?void 0:w.http)==null?void 0:b[0])||o,d=((y=r==null?void 0:r[i])==null?void 0:y.map(x=>x.url))||[],u=[...d,...a?[a]:[]],h=[...d];return l&&!h.includes(l)&&h.push(l),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:ic.NetworkImageIds[t.id],imageUrl:e==null?void 0:e[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:h}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>vp.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){var s,i,o;const r=[];return n==null||n.forEach(a=>{r.push(tv(a.url,a.config))}),bS.includes(t.caipNetworkId)&&r.push(tv(K5(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=t==null?void 0:t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{r.push(tv(a))}),BO(r)},extendWagmiTransports(t,e,n){if(bS.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return BO([n,tv(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:ne.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){var l;const e=ye.getActiveCaipNetworkId(),n=M.getAllRequestedCaipNetworks(),r=Array.from(((l=M.state.chains)==null?void 0:l.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?r.includes(s):!1,o=n==null?void 0:n.find(d=>d.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||(n==null?void 0:n[0])}},G5={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Zr={set(t,e){Ki.isClient&&localStorage.setItem(`${Ze.STORAGE_KEY}${t}`,e)},get(t){return Ki.isClient?localStorage.getItem(`${Ze.STORAGE_KEY}${t}`):null},delete(t,e){Ki.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${Ze.STORAGE_KEY}${t}`))}},Nv=30*1e3,Ki={checkIfAllowedToTriggerEmail(){const t=Zr.get(Ze.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Nv){const n=Math.ceil((Nv-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=Zr.get(Ze.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Nv)return Math.ceil((Nv-e)/1e3)}return 0},checkIfRequestExists(t){return fr.NOT_SAFE_RPC_METHODS.includes(t.method)||fr.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&((t==null?void 0:t.match(G5.transactionHash))||(t==null?void 0:t.match(G5.signedMessage)))?Ze.RPC_RESPONSE_TYPE_TX:Ze.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return fr.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var cn;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(cn||(cn={}));var U_;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(U_||(U_={}));const He=cn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),yd=t=>{switch(typeof t){case"undefined":return He.undefined;case"string":return He.string;case"number":return isNaN(t)?He.nan:He.number;case"boolean":return He.boolean;case"function":return He.function;case"bigint":return He.bigint;case"symbol":return He.symbol;case"object":return Array.isArray(t)?He.array:t===null?He.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?He.promise:typeof Map<"u"&&t instanceof Map?He.map:typeof Set<"u"&&t instanceof Set?He.set:typeof Date<"u"&&t instanceof Date?He.date:He.object;default:return He.unknown}},_e=cn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),eCe=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class ba extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,l=0;for(;l<o.path.length;){const d=o.path[l];l===o.path.length-1?(a[d]=a[d]||{_errors:[]},a[d]._errors.push(n(o))):a[d]=a[d]||{_errors:[]},a=a[d],l++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,cn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}ba.create=t=>new ba(t);const sx=(t,e)=>{let n;switch(t.code){case _e.invalid_type:t.received===He.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case _e.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,cn.jsonStringifyReplacer)}`;break;case _e.unrecognized_keys:n=`Unrecognized key(s) in object: ${cn.joinValues(t.keys,", ")}`;break;case _e.invalid_union:n="Invalid input";break;case _e.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${cn.joinValues(t.options)}`;break;case _e.invalid_enum_value:n=`Invalid enum value. Expected ${cn.joinValues(t.options)}, received '${t.received}'`;break;case _e.invalid_arguments:n="Invalid function arguments";break;case _e.invalid_return_type:n="Invalid function return type";break;case _e.invalid_date:n="Invalid date";break;case _e.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:cn.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case _e.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case _e.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case _e.custom:n="Invalid input";break;case _e.invalid_intersection_types:n="Intersection results could not be merged";break;case _e.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case _e.not_finite:n="Number must be finite";break;default:n=e.defaultError,cn.assertNever(t)}return{message:n}};let Sz=sx;function tCe(t){Sz=t}function OE(){return Sz}const DE=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const l=r.filter(d=>!!d).slice().reverse();for(const d of l)a=d(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},nCe=[];function Ke(t,e){const n=DE({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,OE(),sx].filter(r=>!!r)});t.common.issues.push(n)}class Ps{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return Ct;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return Ps.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Ct;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const Ct=Object.freeze({status:"aborted"}),Tz=t=>({status:"dirty",value:t}),Qs=t=>({status:"valid",value:t}),L_=t=>t.status==="aborted",B_=t=>t.status==="dirty",ix=t=>t.status==="valid",ME=t=>typeof Promise<"u"&&t instanceof Promise;var ht;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ht||(ht={}));class Tc{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Y5=(t,e)=>{if(ix(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new ba(t.common.issues);return this._error=n,this._error}}};function At(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class It{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return yd(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:yd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ps,ctx:{common:e.parent.common,data:e.data,parsedType:yd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ME(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:yd(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Y5(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:yd(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(ME(s)?s:Promise.resolve(s));return Y5(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:_e.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new Aa({schema:this,typeName:xt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return bl.create(this,this._def)}nullable(){return Ef.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return va.create(this,this._def)}promise(){return Rg.create(this,this._def)}or(e){return lx.create([this,e],this._def)}and(e){return dx.create(this,e,this._def)}transform(e){return new Aa({...At(this._def),schema:this,typeName:xt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new mx({...At(this._def),innerType:this,defaultValue:n,typeName:xt.ZodDefault})}brand(){return new kz({typeName:xt.ZodBranded,type:this,...At(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new $E({...At(this._def),innerType:this,catchValue:n,typeName:xt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return ub.create(this,e)}readonly(){return zE.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const rCe=/^c[^\s-]{8,}$/i,sCe=/^[a-z][a-z0-9]*$/,iCe=/^[0-9A-HJKMNP-TV-Z]{26}$/,oCe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,aCe=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,cCe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let vS;const lCe=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,dCe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,uCe=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function hCe(t,e){return!!((e==="v4"||!e)&&lCe.test(t)||(e==="v6"||!e)&&dCe.test(t))}class ma extends It{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==He.string){const i=this._getOrReturnCtx(e);return Ke(i,{code:_e.invalid_type,expected:He.string,received:i.parsedType}),Ct}const r=new Ps;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?Ke(s,{code:_e.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&Ke(s,{code:_e.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")aCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"email",code:_e.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")vS||(vS=new RegExp(cCe,"u")),vS.test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"emoji",code:_e.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")oCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"uuid",code:_e.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")rCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"cuid",code:_e.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")sCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"cuid2",code:_e.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")iCe.test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"ulid",code:_e.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Ke(s,{validation:"url",code:_e.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"regex",code:_e.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?uCe(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?hCe(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Ke(s,{validation:"ip",code:_e.invalid_string,message:i.message}),r.dirty()):cn.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:_e.invalid_string,...ht.errToObj(r)})}_addCheck(e){return new ma({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ht.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ht.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ht.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ht.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ht.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ht.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ht.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ht.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,...ht.errToObj(e==null?void 0:e.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ht.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ht.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ht.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ht.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ht.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ht.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ht.errToObj(n)})}nonempty(e){return this.min(1,ht.errToObj(e))}trim(){return new ma({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ma({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ma({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ma.create=t=>{var e;return new ma({checks:[],typeName:xt.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...At(t)})};function fCe(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class cu extends It{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==He.number){const i=this._getOrReturnCtx(e);return Ke(i,{code:_e.invalid_type,expected:He.number,received:i.parsedType}),Ct}let r;const s=new Ps;for(const i of this._def.checks)i.kind==="int"?cn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?fCe(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.not_finite,message:i.message}),s.dirty()):cn.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ht.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ht.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ht.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ht.toString(n))}setLimit(e,n,r,s){return new cu({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ht.toString(s)}]})}_addCheck(e){return new cu({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ht.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ht.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ht.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ht.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ht.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ht.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ht.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ht.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ht.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&cn.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}cu.create=t=>new cu({checks:[],typeName:xt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...At(t)});class lu extends It{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==He.bigint){const i=this._getOrReturnCtx(e);return Ke(i,{code:_e.invalid_type,expected:He.bigint,received:i.parsedType}),Ct}let r;const s=new Ps;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:_e.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):cn.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ht.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ht.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ht.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ht.toString(n))}setLimit(e,n,r,s){return new lu({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ht.toString(s)}]})}_addCheck(e){return new lu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ht.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ht.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ht.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ht.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ht.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}lu.create=t=>{var e;return new lu({checks:[],typeName:xt.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...At(t)})};class ox extends It{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==He.boolean){const r=this._getOrReturnCtx(e);return Ke(r,{code:_e.invalid_type,expected:He.boolean,received:r.parsedType}),Ct}return Qs(e.data)}}ox.create=t=>new ox({typeName:xt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...At(t)});class bf extends It{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==He.date){const i=this._getOrReturnCtx(e);return Ke(i,{code:_e.invalid_type,expected:He.date,received:i.parsedType}),Ct}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Ke(i,{code:_e.invalid_date}),Ct}const r=new Ps;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Ke(s,{code:_e.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):cn.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new bf({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ht.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ht.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}bf.create=t=>new bf({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:xt.ZodDate,...At(t)});class UE extends It{_parse(e){if(this._getType(e)!==He.symbol){const r=this._getOrReturnCtx(e);return Ke(r,{code:_e.invalid_type,expected:He.symbol,received:r.parsedType}),Ct}return Qs(e.data)}}UE.create=t=>new UE({typeName:xt.ZodSymbol,...At(t)});class ax extends It{_parse(e){if(this._getType(e)!==He.undefined){const r=this._getOrReturnCtx(e);return Ke(r,{code:_e.invalid_type,expected:He.undefined,received:r.parsedType}),Ct}return Qs(e.data)}}ax.create=t=>new ax({typeName:xt.ZodUndefined,...At(t)});class cx extends It{_parse(e){if(this._getType(e)!==He.null){const r=this._getOrReturnCtx(e);return Ke(r,{code:_e.invalid_type,expected:He.null,received:r.parsedType}),Ct}return Qs(e.data)}}cx.create=t=>new cx({typeName:xt.ZodNull,...At(t)});class Ig extends It{constructor(){super(...arguments),this._any=!0}_parse(e){return Qs(e.data)}}Ig.create=t=>new Ig({typeName:xt.ZodAny,...At(t)});class Qh extends It{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Qs(e.data)}}Qh.create=t=>new Qh({typeName:xt.ZodUnknown,...At(t)});class Rl extends It{_parse(e){const n=this._getOrReturnCtx(e);return Ke(n,{code:_e.invalid_type,expected:He.never,received:n.parsedType}),Ct}}Rl.create=t=>new Rl({typeName:xt.ZodNever,...At(t)});class LE extends It{_parse(e){if(this._getType(e)!==He.undefined){const r=this._getOrReturnCtx(e);return Ke(r,{code:_e.invalid_type,expected:He.void,received:r.parsedType}),Ct}return Qs(e.data)}}LE.create=t=>new LE({typeName:xt.ZodVoid,...At(t)});class va extends It{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==He.array)return Ke(n,{code:_e.invalid_type,expected:He.array,received:n.parsedType}),Ct;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(Ke(n,{code:o?_e.too_big:_e.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(Ke(n,{code:_e.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(Ke(n,{code:_e.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Tc(n,o,n.path,a)))).then(o=>Ps.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Tc(n,o,n.path,a)));return Ps.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new va({...this._def,minLength:{value:e,message:ht.toString(n)}})}max(e,n){return new va({...this._def,maxLength:{value:e,message:ht.toString(n)}})}length(e,n){return new va({...this._def,exactLength:{value:e,message:ht.toString(n)}})}nonempty(e){return this.min(1,e)}}va.create=(t,e)=>new va({type:t,minLength:null,maxLength:null,exactLength:null,typeName:xt.ZodArray,...At(e)});function Ep(t){if(t instanceof Wn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=bl.create(Ep(r))}return new Wn({...t._def,shape:()=>e})}else return t instanceof va?new va({...t._def,type:Ep(t.element)}):t instanceof bl?bl.create(Ep(t.unwrap())):t instanceof Ef?Ef.create(Ep(t.unwrap())):t instanceof _c?_c.create(t.items.map(e=>Ep(e))):t}class Wn extends It{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=cn.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==He.object){const d=this._getOrReturnCtx(e);return Ke(d,{code:_e.invalid_type,expected:He.object,received:d.parsedType}),Ct}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Rl&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||a.push(d);const l=[];for(const d of o){const u=i[d],h=s.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new Tc(s,h,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof Rl){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(d==="strict")a.length>0&&(Ke(s,{code:_e.unrecognized_keys,keys:a}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of a){const h=s.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new Tc(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of l){const h=await u.key;d.push({key:h,value:await u.value,alwaysSet:u.alwaysSet})}return d}).then(d=>Ps.mergeObjectSync(r,d)):Ps.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return ht.errToObj,new Wn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const l=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=ht.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Wn({...this._def,unknownKeys:"strip"})}passthrough(){return new Wn({...this._def,unknownKeys:"passthrough"})}extend(e){return new Wn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Wn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:xt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Wn({...this._def,catchall:e})}pick(e){const n={};return cn.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Wn({...this._def,shape:()=>n})}omit(e){const n={};return cn.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Wn({...this._def,shape:()=>n})}deepPartial(){return Ep(this)}partial(e){const n={};return cn.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new Wn({...this._def,shape:()=>n})}required(e){const n={};return cn.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof bl;)i=i._def.innerType;n[r]=i}}),new Wn({...this._def,shape:()=>n})}keyof(){return _z(cn.objectKeys(this.shape))}}Wn.create=(t,e)=>new Wn({shape:()=>t,unknownKeys:"strip",catchall:Rl.create(),typeName:xt.ZodObject,...At(e)});Wn.strictCreate=(t,e)=>new Wn({shape:()=>t,unknownKeys:"strict",catchall:Rl.create(),typeName:xt.ZodObject,...At(e)});Wn.lazycreate=(t,e)=>new Wn({shape:t,unknownKeys:"strip",catchall:Rl.create(),typeName:xt.ZodObject,...At(e)});class lx extends It{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new ba(a.ctx.common.issues));return Ke(n,{code:_e.invalid_union,unionErrors:o}),Ct}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const l of r){const d={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(l=>new ba(l));return Ke(n,{code:_e.invalid_union,unionErrors:a}),Ct}}get options(){return this._def.options}}lx.create=(t,e)=>new lx({options:t,typeName:xt.ZodUnion,...At(e)});const g1=t=>t instanceof hx?g1(t.schema):t instanceof Aa?g1(t.innerType()):t instanceof fx?[t.value]:t instanceof du?t.options:t instanceof px?Object.keys(t.enum):t instanceof mx?g1(t._def.innerType):t instanceof ax?[void 0]:t instanceof cx?[null]:null;class gN extends It{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.object)return Ke(n,{code:_e.invalid_type,expected:He.object,received:n.parsedType}),Ct;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Ke(n,{code:_e.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ct)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=g1(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new gN({typeName:xt.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...At(r)})}}function $_(t,e){const n=yd(t),r=yd(e);if(t===e)return{valid:!0,data:t};if(n===He.object&&r===He.object){const s=cn.objectKeys(e),i=cn.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const l=$_(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===He.array&&r===He.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],l=$_(o,a);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===He.date&&r===He.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class dx extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(L_(i)||L_(o))return Ct;const a=$_(i.value,o.value);return a.valid?((B_(i)||B_(o))&&n.dirty(),{status:n.value,value:a.data}):(Ke(r,{code:_e.invalid_intersection_types}),Ct)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}dx.create=(t,e,n)=>new dx({left:t,right:e,typeName:xt.ZodIntersection,...At(n)});class _c extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.array)return Ke(r,{code:_e.invalid_type,expected:He.array,received:r.parsedType}),Ct;if(r.data.length<this._def.items.length)return Ke(r,{code:_e.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ct;!this._def.rest&&r.data.length>this._def.items.length&&(Ke(r,{code:_e.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Tc(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Ps.mergeArray(n,o)):Ps.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new _c({...this._def,rest:e})}}_c.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new _c({items:t,typeName:xt.ZodTuple,rest:null,...At(e)})};class ux extends It{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.object)return Ke(r,{code:_e.invalid_type,expected:He.object,received:r.parsedType}),Ct;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Tc(r,a,r.path,a)),value:o._parse(new Tc(r,r.data[a],r.path,a))});return r.common.async?Ps.mergeObjectAsync(n,s):Ps.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof It?new ux({keyType:e,valueType:n,typeName:xt.ZodRecord,...At(r)}):new ux({keyType:ma.create(),valueType:e,typeName:xt.ZodRecord,...At(n)})}}class BE extends It{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.map)return Ke(r,{code:_e.invalid_type,expected:He.map,received:r.parsedType}),Ct;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,l],d)=>({key:s._parse(new Tc(r,a,r.path,[d,"key"])),value:i._parse(new Tc(r,l,r.path,[d,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const d=await l.key,u=await l.value;if(d.status==="aborted"||u.status==="aborted")return Ct;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(d.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const d=l.key,u=l.value;if(d.status==="aborted"||u.status==="aborted")return Ct;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(d.value,u.value)}return{status:n.value,value:a}}}}BE.create=(t,e,n)=>new BE({valueType:e,keyType:t,typeName:xt.ZodMap,...At(n)});class vf extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==He.set)return Ke(r,{code:_e.invalid_type,expected:He.set,received:r.parsedType}),Ct;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Ke(r,{code:_e.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Ke(r,{code:_e.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(l){const d=new Set;for(const u of l){if(u.status==="aborted")return Ct;u.status==="dirty"&&n.dirty(),d.add(u.value)}return{status:n.value,value:d}}const a=[...r.data.values()].map((l,d)=>i._parse(new Tc(r,l,r.path,d)));return r.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new vf({...this._def,minSize:{value:e,message:ht.toString(n)}})}max(e,n){return new vf({...this._def,maxSize:{value:e,message:ht.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}vf.create=(t,e)=>new vf({valueType:t,minSize:null,maxSize:null,typeName:xt.ZodSet,...At(e)});class dm extends It{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.function)return Ke(n,{code:_e.invalid_type,expected:He.function,received:n.parsedType}),Ct;function r(a,l){return DE({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,OE(),sx].filter(d=>!!d),issueData:{code:_e.invalid_arguments,argumentsError:l}})}function s(a,l){return DE({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,OE(),sx].filter(d=>!!d),issueData:{code:_e.invalid_return_type,returnTypeError:l}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Rg){const a=this;return Qs(async function(...l){const d=new ba([]),u=await a._def.args.parseAsync(l,i).catch(p=>{throw d.addIssue(r(l,p)),d}),h=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(h,i).catch(p=>{throw d.addIssue(s(h,p)),d})})}else{const a=this;return Qs(function(...l){const d=a._def.args.safeParse(l,i);if(!d.success)throw new ba([r(l,d.error)]);const u=Reflect.apply(o,this,d.data),h=a._def.returns.safeParse(u,i);if(!h.success)throw new ba([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new dm({...this._def,args:_c.create(e).rest(Qh.create())})}returns(e){return new dm({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new dm({args:e||_c.create([]).rest(Qh.create()),returns:n||Qh.create(),typeName:xt.ZodFunction,...At(r)})}}class hx extends It{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}hx.create=(t,e)=>new hx({getter:t,typeName:xt.ZodLazy,...At(e)});class fx extends It{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ke(n,{received:n.data,code:_e.invalid_literal,expected:this._def.value}),Ct}return{status:"valid",value:e.data}}get value(){return this._def.value}}fx.create=(t,e)=>new fx({value:t,typeName:xt.ZodLiteral,...At(e)});function _z(t,e){return new du({values:t,typeName:xt.ZodEnum,...At(e)})}class du extends It{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Ke(n,{expected:cn.joinValues(r),received:n.parsedType,code:_e.invalid_type}),Ct}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return Ke(n,{received:n.data,code:_e.invalid_enum_value,options:r}),Ct}return Qs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return du.create(e)}exclude(e){return du.create(this.options.filter(n=>!e.includes(n)))}}du.create=_z;class px extends It{_parse(e){const n=cn.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==He.string&&r.parsedType!==He.number){const s=cn.objectValues(n);return Ke(r,{expected:cn.joinValues(s),received:r.parsedType,code:_e.invalid_type}),Ct}if(n.indexOf(e.data)===-1){const s=cn.objectValues(n);return Ke(r,{received:r.data,code:_e.invalid_enum_value,options:s}),Ct}return Qs(e.data)}get enum(){return this._def.values}}px.create=(t,e)=>new px({values:t,typeName:xt.ZodNativeEnum,...At(e)});class Rg extends It{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.promise&&n.common.async===!1)return Ke(n,{code:_e.invalid_type,expected:He.promise,received:n.parsedType}),Ct;const r=n.parsedType===He.promise?n.data:Promise.resolve(n.data);return Qs(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Rg.create=(t,e)=>new Rg({type:t,typeName:xt.ZodPromise,...At(e)});class Aa extends It{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===xt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{Ke(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const l=s.refinement(a,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Ct:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?Ct:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ix(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>ix(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);cn.assertNever(s)}}Aa.create=(t,e,n)=>new Aa({schema:t,typeName:xt.ZodEffects,effect:e,...At(n)});Aa.createWithPreprocess=(t,e,n)=>new Aa({schema:e,effect:{type:"preprocess",transform:t},typeName:xt.ZodEffects,...At(n)});class bl extends It{_parse(e){return this._getType(e)===He.undefined?Qs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}bl.create=(t,e)=>new bl({innerType:t,typeName:xt.ZodOptional,...At(e)});class Ef extends It{_parse(e){return this._getType(e)===He.null?Qs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ef.create=(t,e)=>new Ef({innerType:t,typeName:xt.ZodNullable,...At(e)});class mx extends It{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===He.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}mx.create=(t,e)=>new mx({innerType:t,typeName:xt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...At(e)});class $E extends It{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ME(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ba(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ba(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}$E.create=(t,e)=>new $E({innerType:t,typeName:xt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...At(e)});class FE extends It{_parse(e){if(this._getType(e)!==He.nan){const r=this._getOrReturnCtx(e);return Ke(r,{code:_e.invalid_type,expected:He.nan,received:r.parsedType}),Ct}return{status:"valid",value:e.data}}}FE.create=t=>new FE({typeName:xt.ZodNaN,...At(t)});const pCe=Symbol("zod_brand");class kz extends It{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ub extends It{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ct:i.status==="dirty"?(n.dirty(),Tz(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ct:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new ub({in:e,out:n,typeName:xt.ZodPipeline})}}class zE extends It{_parse(e){const n=this._def.innerType._parse(e);return ix(n)&&(n.value=Object.freeze(n.value)),n}}zE.create=(t,e)=>new zE({innerType:t,typeName:xt.ZodReadonly,...At(e)});const Iz=(t,e={},n)=>t?Ig.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,l=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,d=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...d,fatal:l})}}):Ig.create(),mCe={object:Wn.lazycreate};var xt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(xt||(xt={}));const gCe=(t,e={message:`Input not instance of ${t.name}`})=>Iz(n=>n instanceof t,e),Rz=ma.create,jz=cu.create,yCe=FE.create,wCe=lu.create,Pz=ox.create,xCe=bf.create,bCe=UE.create,vCe=ax.create,ECe=cx.create,CCe=Ig.create,NCe=Qh.create,ACe=Rl.create,SCe=LE.create,TCe=va.create,_Ce=Wn.create,kCe=Wn.strictCreate,ICe=lx.create,RCe=gN.create,jCe=dx.create,PCe=_c.create,OCe=ux.create,DCe=BE.create,MCe=vf.create,UCe=dm.create,LCe=hx.create,BCe=fx.create,$Ce=du.create,FCe=px.create,zCe=Rg.create,Q5=Aa.create,HCe=bl.create,VCe=Ef.create,WCe=Aa.createWithPreprocess,qCe=ub.create,KCe=()=>Rz().optional(),GCe=()=>jz().optional(),YCe=()=>Pz().optional(),QCe={string:t=>ma.create({...t,coerce:!0}),number:t=>cu.create({...t,coerce:!0}),boolean:t=>ox.create({...t,coerce:!0}),bigint:t=>lu.create({...t,coerce:!0}),date:t=>bf.create({...t,coerce:!0})},JCe=Ct;var O=Object.freeze({__proto__:null,defaultErrorMap:sx,setErrorMap:tCe,getErrorMap:OE,makeIssue:DE,EMPTY_PATH:nCe,addIssueToContext:Ke,ParseStatus:Ps,INVALID:Ct,DIRTY:Tz,OK:Qs,isAborted:L_,isDirty:B_,isValid:ix,isAsync:ME,get util(){return cn},get objectUtil(){return U_},ZodParsedType:He,getParsedType:yd,ZodType:It,ZodString:ma,ZodNumber:cu,ZodBigInt:lu,ZodBoolean:ox,ZodDate:bf,ZodSymbol:UE,ZodUndefined:ax,ZodNull:cx,ZodAny:Ig,ZodUnknown:Qh,ZodNever:Rl,ZodVoid:LE,ZodArray:va,ZodObject:Wn,ZodUnion:lx,ZodDiscriminatedUnion:gN,ZodIntersection:dx,ZodTuple:_c,ZodRecord:ux,ZodMap:BE,ZodSet:vf,ZodFunction:dm,ZodLazy:hx,ZodLiteral:fx,ZodEnum:du,ZodNativeEnum:px,ZodPromise:Rg,ZodEffects:Aa,ZodTransformer:Aa,ZodOptional:bl,ZodNullable:Ef,ZodDefault:mx,ZodCatch:$E,ZodNaN:FE,BRAND:pCe,ZodBranded:kz,ZodPipeline:ub,ZodReadonly:zE,custom:Iz,Schema:It,ZodSchema:It,late:mCe,get ZodFirstPartyTypeKind(){return xt},coerce:QCe,any:CCe,array:TCe,bigint:wCe,boolean:Pz,date:xCe,discriminatedUnion:RCe,effect:Q5,enum:$Ce,function:UCe,instanceof:gCe,intersection:jCe,lazy:LCe,literal:BCe,map:DCe,nan:yCe,nativeEnum:FCe,never:ACe,null:ECe,nullable:VCe,number:jz,object:_Ce,oboolean:YCe,onumber:GCe,optional:HCe,ostring:KCe,pipeline:qCe,preprocess:WCe,promise:zCe,record:OCe,set:MCe,strictObject:kCe,string:Rz,symbol:bCe,transformer:Q5,tuple:PCe,undefined:vCe,union:ICe,unknown:NCe,void:SCe,NEVER:JCe,ZodIssueCode:_e,quotelessJson:eCe,ZodError:ba});const Jn=O.object({message:O.string()});function We(t){return O.literal(Ze[t])}const yN=O.object({serializedMessage:O.string().optional(),accountAddress:O.string(),chainId:O.string(),notBefore:O.string().optional(),domain:O.string(),uri:O.string(),version:O.string(),nonce:O.string(),statement:O.string().optional(),resources:O.array(O.string()).optional(),requestId:O.string().optional(),issuedAt:O.string().optional(),expirationTime:O.string().optional()});O.object({accessList:O.array(O.string()),blockHash:O.string().nullable(),blockNumber:O.string().nullable(),chainId:O.string().or(O.number()),from:O.string(),gas:O.string(),hash:O.string(),input:O.string().nullable(),maxFeePerGas:O.string(),maxPriorityFeePerGas:O.string(),nonce:O.string(),r:O.string(),s:O.string(),to:O.string(),transactionIndex:O.string().nullable(),type:O.string(),v:O.string(),value:O.string()});const ZCe=O.object({chainId:O.string().or(O.number()),rpcUrl:O.optional(O.string())}),XCe=O.object({email:O.string().email()}),eNe=O.object({otp:O.string()}),tNe=O.object({uri:O.string(),preferredAccountType:O.optional(O.string()),chainId:O.optional(O.string().or(O.number())),siwxMessage:O.optional(yN),rpcUrl:O.optional(O.string())}),nNe=O.object({chainId:O.optional(O.string().or(O.number())),preferredAccountType:O.optional(O.string()),socialUri:O.optional(O.string()),siwxMessage:O.optional(yN),rpcUrl:O.optional(O.string())}),rNe=O.object({provider:O.enum(["google","github","apple","facebook","x","discord"])}),sNe=O.object({email:O.string().email()}),iNe=O.object({otp:O.string()}),oNe=O.object({otp:O.string()}),aNe=O.object({themeMode:O.optional(O.enum(["light","dark"])),themeVariables:O.optional(O.record(O.string(),O.string().or(O.number()))),w3mThemeVariables:O.optional(O.record(O.string(),O.string()))}),cNe=O.object({metadata:O.object({name:O.string(),description:O.string(),url:O.string(),icons:O.array(O.string())}).optional(),sdkVersion:O.string().optional(),sdkType:O.string().optional(),projectId:O.string()}),lNe=O.object({type:O.string()}),dNe=O.object({action:O.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),uNe=O.object({url:O.string()}),hNe=O.object({userName:O.string()}),fNe=O.object({email:O.string().optional().nullable(),address:O.string(),chainId:O.string().or(O.number()),accounts:O.array(O.object({address:O.string(),type:O.enum([fr.ACCOUNT_TYPES.EOA,fr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:O.string().optional().nullable(),preferredAccountType:O.optional(O.string()),signature:O.string().optional(),message:O.string().optional(),siwxMessage:O.optional(yN)}),pNe=O.object({action:O.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),mNe=O.object({email:O.string().email().optional().nullable(),address:O.string(),chainId:O.string().or(O.number()),smartAccountDeployed:O.optional(O.boolean()),accounts:O.array(O.object({address:O.string(),type:O.enum([fr.ACCOUNT_TYPES.EOA,fr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:O.optional(O.string()),signature:O.string().optional(),message:O.string().optional(),siwxMessage:O.optional(yN)}),gNe=O.object({uri:O.string()}),yNe=O.object({isConnected:O.boolean()}),wNe=O.object({chainId:O.string().or(O.number())}),xNe=O.object({chainId:O.string().or(O.number())}),bNe=O.object({newEmail:O.string().email()}),vNe=O.object({smartAccountEnabledNetworks:O.array(O.number())});O.object({address:O.string(),isDeployed:O.boolean()});const ENe=O.object({version:O.string().optional()}),CNe=O.object({type:O.string(),address:O.string()}),NNe=O.any(),ANe=O.object({method:O.literal("eth_accounts")}),SNe=O.object({method:O.literal("eth_blockNumber")}),TNe=O.object({method:O.literal("eth_call"),params:O.array(O.any())}),_Ne=O.object({method:O.literal("eth_chainId")}),kNe=O.object({method:O.literal("eth_estimateGas"),params:O.array(O.any())}),INe=O.object({method:O.literal("eth_feeHistory"),params:O.array(O.any())}),RNe=O.object({method:O.literal("eth_gasPrice")}),jNe=O.object({method:O.literal("eth_getAccount"),params:O.array(O.any())}),PNe=O.object({method:O.literal("eth_getBalance"),params:O.array(O.any())}),ONe=O.object({method:O.literal("eth_getBlockByHash"),params:O.array(O.any())}),DNe=O.object({method:O.literal("eth_getBlockByNumber"),params:O.array(O.any())}),MNe=O.object({method:O.literal("eth_getBlockReceipts"),params:O.array(O.any())}),UNe=O.object({method:O.literal("eth_getBlockTransactionCountByHash"),params:O.array(O.any())}),LNe=O.object({method:O.literal("eth_getBlockTransactionCountByNumber"),params:O.array(O.any())}),BNe=O.object({method:O.literal("eth_getCode"),params:O.array(O.any())}),$Ne=O.object({method:O.literal("eth_getFilterChanges"),params:O.array(O.any())}),FNe=O.object({method:O.literal("eth_getFilterLogs"),params:O.array(O.any())}),zNe=O.object({method:O.literal("eth_getLogs"),params:O.array(O.any())}),HNe=O.object({method:O.literal("eth_getProof"),params:O.array(O.any())}),VNe=O.object({method:O.literal("eth_getStorageAt"),params:O.array(O.any())}),WNe=O.object({method:O.literal("eth_getTransactionByBlockHashAndIndex"),params:O.array(O.any())}),qNe=O.object({method:O.literal("eth_getTransactionByBlockNumberAndIndex"),params:O.array(O.any())}),KNe=O.object({method:O.literal("eth_getTransactionByHash"),params:O.array(O.any())}),GNe=O.object({method:O.literal("eth_getTransactionCount"),params:O.array(O.any())}),YNe=O.object({method:O.literal("eth_getTransactionReceipt"),params:O.array(O.any())}),QNe=O.object({method:O.literal("eth_getUncleCountByBlockHash"),params:O.array(O.any())}),JNe=O.object({method:O.literal("eth_getUncleCountByBlockNumber"),params:O.array(O.any())}),ZNe=O.object({method:O.literal("eth_maxPriorityFeePerGas")}),XNe=O.object({method:O.literal("eth_newBlockFilter")}),eAe=O.object({method:O.literal("eth_newFilter"),params:O.array(O.any())}),tAe=O.object({method:O.literal("eth_newPendingTransactionFilter")}),nAe=O.object({method:O.literal("eth_sendRawTransaction"),params:O.array(O.any())}),rAe=O.object({method:O.literal("eth_syncing"),params:O.array(O.any())}),sAe=O.object({method:O.literal("eth_uninstallFilter"),params:O.array(O.any())}),J5=O.object({method:O.literal("personal_sign"),params:O.array(O.any())}),iAe=O.object({method:O.literal("eth_signTypedData_v4"),params:O.array(O.any())}),oAe=O.object({method:O.literal("eth_sendTransaction"),params:O.array(O.any())}),aAe=O.object({method:O.literal("solana_signMessage"),params:O.object({message:O.string(),pubkey:O.string()})}),cAe=O.object({method:O.literal("solana_signTransaction"),params:O.object({transaction:O.string()})}),lAe=O.object({method:O.literal("solana_signAllTransactions"),params:O.object({transactions:O.array(O.string())})}),dAe=O.object({method:O.literal("solana_signAndSendTransaction"),params:O.object({transaction:O.string(),options:O.object({skipPreflight:O.boolean().optional(),preflightCommitment:O.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:O.number().optional(),minContextSlot:O.number().optional()}).optional()})}),uAe=O.object({method:O.literal("wallet_sendCalls"),params:O.array(O.object({chainId:O.string().or(O.number()).optional(),from:O.string().optional(),version:O.string().optional(),capabilities:O.any().optional(),calls:O.array(O.object({to:O.string().startsWith("0x"),data:O.string().startsWith("0x").optional(),value:O.string().optional()}))}))}),hAe=O.object({method:O.literal("wallet_getCallsStatus"),params:O.array(O.string())}),fAe=O.object({method:O.literal("wallet_getCapabilities"),params:O.array(O.string().or(O.number()).optional()).optional()}),pAe=O.object({method:O.literal("wallet_grantPermissions"),params:O.array(O.any())}),mAe=O.object({method:O.literal("wallet_revokePermissions"),params:O.any()}),gAe=O.object({method:O.literal("wallet_getAssets"),params:O.any()}),Z5=O.object({token:O.string()}),qe=O.object({id:O.string().optional()}),ES={appEvent:qe.extend({type:We("APP_SWITCH_NETWORK"),payload:ZCe}).or(qe.extend({type:We("APP_CONNECT_EMAIL"),payload:XCe})).or(qe.extend({type:We("APP_CONNECT_DEVICE")})).or(qe.extend({type:We("APP_CONNECT_OTP"),payload:eNe})).or(qe.extend({type:We("APP_CONNECT_SOCIAL"),payload:tNe})).or(qe.extend({type:We("APP_GET_FARCASTER_URI")})).or(qe.extend({type:We("APP_CONNECT_FARCASTER")})).or(qe.extend({type:We("APP_GET_USER"),payload:O.optional(nNe)})).or(qe.extend({type:We("APP_GET_SOCIAL_REDIRECT_URI"),payload:rNe})).or(qe.extend({type:We("APP_SIGN_OUT")})).or(qe.extend({type:We("APP_IS_CONNECTED"),payload:O.optional(Z5)})).or(qe.extend({type:We("APP_GET_CHAIN_ID")})).or(qe.extend({type:We("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(qe.extend({type:We("APP_INIT_SMART_ACCOUNT")})).or(qe.extend({type:We("APP_SET_PREFERRED_ACCOUNT"),payload:lNe})).or(qe.extend({type:We("APP_RPC_REQUEST"),payload:J5.or(gAe).or(ANe).or(SNe).or(TNe).or(_Ne).or(kNe).or(INe).or(RNe).or(jNe).or(PNe).or(ONe).or(DNe).or(MNe).or(UNe).or(LNe).or(BNe).or($Ne).or(FNe).or(zNe).or(HNe).or(VNe).or(WNe).or(qNe).or(KNe).or(GNe).or(YNe).or(QNe).or(JNe).or(ZNe).or(XNe).or(eAe).or(tAe).or(nAe).or(rAe).or(sAe).or(J5).or(iAe).or(oAe).or(aAe).or(cAe).or(lAe).or(dAe).or(hAe).or(uAe).or(fAe).or(pAe).or(mAe).and(O.object({chainId:O.string().or(O.number()).optional(),chainNamespace:O.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:O.string().optional()}))})).or(qe.extend({type:We("APP_UPDATE_EMAIL"),payload:sNe})).or(qe.extend({type:We("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:iNe})).or(qe.extend({type:We("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:oNe})).or(qe.extend({type:We("APP_SYNC_THEME"),payload:aNe})).or(qe.extend({type:We("APP_SYNC_DAPP_DATA"),payload:cNe})).or(qe.extend({type:We("APP_RELOAD")})).or(qe.extend({type:We("APP_RPC_ABORT")})),frameEvent:qe.extend({type:We("FRAME_SWITCH_NETWORK_ERROR"),payload:Jn}).or(qe.extend({type:We("FRAME_SWITCH_NETWORK_SUCCESS"),payload:xNe})).or(qe.extend({type:We("FRAME_CONNECT_EMAIL_SUCCESS"),payload:dNe})).or(qe.extend({type:We("FRAME_CONNECT_EMAIL_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:uNe})).or(qe.extend({type:We("FRAME_GET_FARCASTER_URI_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:hNe})).or(qe.extend({type:We("FRAME_CONNECT_FARCASTER_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_CONNECT_OTP_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_CONNECT_OTP_SUCCESS")})).or(qe.extend({type:We("FRAME_CONNECT_DEVICE_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_CONNECT_DEVICE_SUCCESS")})).or(qe.extend({type:We("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:fNe})).or(qe.extend({type:We("FRAME_CONNECT_SOCIAL_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_GET_USER_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_GET_USER_SUCCESS"),payload:mNe})).or(qe.extend({type:We("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:gNe})).or(qe.extend({type:We("FRAME_SIGN_OUT_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_SIGN_OUT_SUCCESS")})).or(qe.extend({type:We("FRAME_IS_CONNECTED_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_IS_CONNECTED_SUCCESS"),payload:yNe})).or(qe.extend({type:We("FRAME_GET_CHAIN_ID_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_GET_CHAIN_ID_SUCCESS"),payload:wNe})).or(qe.extend({type:We("FRAME_RPC_REQUEST_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_RPC_REQUEST_SUCCESS"),payload:NNe})).or(qe.extend({type:We("FRAME_SESSION_UPDATE"),payload:Z5})).or(qe.extend({type:We("FRAME_UPDATE_EMAIL_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_UPDATE_EMAIL_SUCCESS"),payload:pNe})).or(qe.extend({type:We("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(qe.extend({type:We("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:bNe})).or(qe.extend({type:We("FRAME_SYNC_THEME_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_SYNC_THEME_SUCCESS")})).or(qe.extend({type:We("FRAME_SYNC_DAPP_DATA_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(qe.extend({type:We("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:vNe})).or(qe.extend({type:We("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:CNe})).or(qe.extend({type:We("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_READY"),payload:ENe})).or(qe.extend({type:We("FRAME_RELOAD_ERROR"),payload:Jn})).or(qe.extend({type:We("FRAME_RELOAD_SUCCESS")}))};function CS(t,e={}){var n;return typeof(e==null?void 0:e.type)=="string"&&((n=e==null?void 0:e.type)==null?void 0:n.includes(t))}function yAe({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=ne.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(Dse);return i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",Use),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class wAe{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=ne.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,l,d)=>{function u({data:h}){var p;if(!CS(Ze.FRAME_EVENT_KEY,h))return;const f=ES.frameEvent.safeParse(h);if(!f.success){console.warn("W3mFrame: invalid frame event",f.error.message);return}((p=f.data)==null?void 0:p.id)===a&&(l(f.data),window.removeEventListener("message",u))}Ki.isClient&&(window.addEventListener("message",u),d.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{Ki.isClient&&window.addEventListener("message",({data:l})=>{if(!CS(Ze.FRAME_EVENT_KEY,l))return;const d=ES.frameEvent.safeParse(l);d.success?a(d.data):console.warn("W3mFrame: invalid frame event",d.error.message)})},onAppEvent:a=>{Ki.isClient&&window.addEventListener("message",({data:l})=>{if(!CS(Ze.APP_EVENT_KEY,l))return;const d=ES.appEvent.safeParse(l);d.success||console.warn("W3mFrame: invalid app event",d.error.message),a(l)})},postAppEvent:a=>{var l;if(Ki.isClient){if(!((l=this.iframe)!=null&&l.contentWindow))throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(Ki.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,l)=>{this.frameLoadPromiseResolver={resolve:a,reject:l}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((a,l)=>{this.frameLoadPromiseResolver={resolve:a,reject:l}}),Ki.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=yAe({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=a,this.iframe.onerror=()=>{var l;(l=this.frameLoadPromiseResolver)==null||l.reject("Unable to load email login dependency")},this.events.onFrameEvent(l=>{var d;l.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(d=this.frameLoadPromiseResolver)==null||d.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}class xAe{constructor(e){var i;const n=qg({level:Mse}),{logger:r,chunkLoggerController:s}=XI({opts:n});this.logger=Ds(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class bAe{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:l}){this.openRpcRequests=new Map,this.isInitialized=!1,r&&(this.w3mLogger=new xAe(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const d=this.getRpcUrl(n);this.w3mFrame=new wAe({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:d,enableCloudAuthAccount:l}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Zr.get(Ze.EMAIL_LOGIN_USED_KEY)}getEmail(){return Zr.get(Ze.EMAIL)}getUsername(){return Zr.get(Ze.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:Ze.APP_RELOAD})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error reloading iframe"),n}}async connectEmail(e){var n;try{Ki.checkIfAllowedToTriggerEmail(),await this.init();const r=await this.appEvent({type:Ze.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting email"),r}}async connectDevice(){var e;try{return this.appEvent({type:Ze.APP_CONNECT_DEVICE})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting device"),n}}async connectOtp(e){var n;try{return this.appEvent({type:Ze.APP_CONNECT_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting otp"),r}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const n=await this.appEvent({type:Ze.APP_IS_CONNECTED});return n!=null&&n.isConnected||this.deleteAuthLoginCache(),n}catch(n){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error checking connection"),n}}async getChainId(){var e;try{const n=await this.appEvent({type:Ze.APP_GET_CHAIN_ID});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting chain id"),n}}async getSocialRedirectUri(e){var n;try{return await this.init(),this.appEvent({type:Ze.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error getting social redirect uri"),r}}async updateEmail(e){var n;try{const r=await this.appEvent({type:Ze.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email"),r}}async updateEmailPrimaryOtp(e){var n;try{return this.appEvent({type:Ze.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email primary otp"),r}}async updateEmailSecondaryOtp(e){var n;try{const r=await this.appEvent({type:Ze.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(r.newEmail),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email secondary otp"),r}}async syncTheme(e){var n;try{return this.appEvent({type:Ze.APP_SYNC_THEME,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing theme"),r}}async syncDappData(e){var n;try{return this.appEvent({type:Ze.APP_SYNC_DAPP_DATA,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing dapp data"),r}}async getSmartAccountEnabledNetworks(){var e;try{const n=await this.appEvent({type:Ze.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(n.smartAccountEnabledNetworks),n}catch(n){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting smart account enabled networks"),n}}async setPreferredAccount(e){var n;try{return this.appEvent({type:Ze.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error setting preferred account"),r}}async connect(e){var n,r;if(e!=null&&e.socialUri)try{await this.init();const s=this.getRpcUrl(e.chainId),i=await this.appEvent({type:Ze.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:s}});return i.userName&&this.setSocialLoginSuccess(i.userName),this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(n=this.w3mLogger)==null||n.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType,siwxMessage:e==null?void 0:e.siwxMessage,rpcUrl:this.getRpcUrl(s)});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting"),s}}async getUser(e){var n;try{await this.init();const r=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:Ze.APP_GET_USER,payload:{...e,chainId:r,rpcUrl:this.getRpcUrl(r)}});return this.user=s,s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting"),r}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){var s;try{await this.init();const i=this.getRpcUrl(n),o=await this.appEvent({type:Ze.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:i,preferredAccountType:r}});return o.userName&&this.setSocialLoginSuccess(o.userName),o}catch(i){throw(s=this.w3mLogger)==null||s.logger.error({error:i},"Error connecting social"),i}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:Ze.APP_GET_FARCASTER_URI})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting farcaster uri"),n}}async connectFarcaster(){var e;try{const n=await this.appEvent({type:Ze.APP_CONNECT_FARCASTER});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting farcaster"),n}}async switchNetwork({chainId:e}){var n;try{const r=this.getRpcUrl(e),s=await this.appEvent({type:Ze.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:r}});return this.setLastUsedChainId(s.chainId),s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error switching network"),r}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async r=>{const s=setTimeout(()=>{r()},3e3);await this.appEvent({type:Ze.APP_SIGN_OUT}),clearTimeout(s),r()})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error disconnecting"),n}}async request(e){var r,s,i,o,a;const n=e;try{if(fr.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const l=e.chainNamespace||"eip155",d=(r=this.getActiveCaipNetwork(l))==null?void 0:r.id;n.chainNamespace=l,n.chainId=d,n.rpcUrl=this.getRpcUrl(d),(s=this.rpcRequestHandler)==null||s.call(this,e);const u=await this.appEvent({type:Ze.APP_RPC_REQUEST,payload:n});return(i=this.rpcSuccessHandler)==null||i.call(this,u,n),u}catch(l){throw(o=this.rpcErrorHandler)==null||o.call(this,l,n),(a=this.w3mLogger)==null||a.logger.error({error:l},"Error requesting"),l}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_IS_CONNECTED_ERROR&&e(),n.type===Ze.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===Ze.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===Ze.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:fr.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){var e;try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:n,method:r})=>{fr.SAFE_RPC_METHODS.includes(r)||n.abort(),await this.appEvent({type:Ze.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(n){(e=this.w3mLogger)==null||e.logger.error({error:n},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(l){return l.replace("@w3m-app/","")}const i=[Ze.APP_SYNC_DAPP_DATA,Ze.APP_SYNC_THEME,Ze.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{var l;(l=this.onTimeout)==null||l.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[Ze.APP_CONNECT_EMAIL,Ze.APP_CONNECT_DEVICE,Ze.APP_CONNECT_OTP,Ze.APP_CONNECT_SOCIAL,Ze.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{var l;(l=this.onTimeout)==null||l.call(this,"iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((l,d)=>{var p,m,g;const u=Math.random().toString(36).substring(7);(g=(p=this.w3mLogger)==null?void 0:(m=p.logger).info)==null||g.call(m,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const h=new AbortController;if(o==="RPC_REQUEST"){const w=e;this.openRpcRequests.set(u,{...w.payload,abortController:h})}h.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?d(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&d(new Error("Something went wrong"))});const f=(w,b)=>{var y,x,v;w.id===u&&((x=b==null?void 0:(y=b.logger).info)==null||x.call(y,{framEvent:w,id:u},"Received frame response"),this.openRpcRequests.delete(w.id),w.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in w&&l(w.payload),l(void 0)):w.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in w&&d(new Error(((v=w.payload)==null?void 0:v.message)||"An error occurred")),d(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(u,w=>f(w,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Zr.set(Ze.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Zr.set(Ze.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Zr.set(Ze.EMAIL,e),Zr.set(Ze.EMAIL_LOGIN_USED_KEY,"true"),Zr.delete(Ze.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Zr.delete(Ze.EMAIL_LOGIN_USED_KEY),Zr.delete(Ze.EMAIL),Zr.delete(Ze.LAST_USED_CHAIN_KEY),Zr.delete(Ze.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Zr.set(Ze.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Zr.get(Ze.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){Zr.set(Ze.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){var i,o;let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=(i=Rr.parseCaipNetworkId(e))==null?void 0:i.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n),s=e?r.find(a=>String(a.id)===String(e)||a.caipNetworkId===e):r[0];return(o=s==null?void 0:s.rpcUrls.default.http)==null?void 0:o[0]}}class Oy{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){var l;return Oy.instance||(Oy.instance=new bAe({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!((l=fe.state.remoteFeatures)!=null&&l.emailCapture)})),Oy.instance}}var X5={};const vAe={ACCOUNT_TABS:[{label:"Tokens"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof X5<"u"?X5.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120},VIEWS_WITH_LEGAL_FOOTER:["Connect","ConnectWallets","OnRampTokenSelect","OnRampFiatSelect","OnRampProviders"],VIEWS_WITH_DEFAULT_FOOTER:["Networks"]},F_={filterOutDuplicatesByRDNS(t){const e=fe.state.enableEIP6963?ke.state.connectors:[],n=ye.getRecentWallets(),r=e.map(a=>{var l;return(l=a.info)==null?void 0:l.rdns}).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&Le.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a!=null&&a.rdns&&i.includes(String(a.rdns))||!(a!=null&&a.rdns)&&e.some(d=>d.name===a.name)))},filterOutDuplicatesByIds(t){const e=ke.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),n=ye.getRecentWallets(),r=e.map(a=>a.explorerId),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=ke.state,{featuredWalletIds:n}=fe.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>{var l;return(l=a.info)!=null&&l.rdns&&(o[a.info.rdns]=!0),o},{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const l=Number(a.installed)-Number(o.installed);if(l!==0)return l;if(n!=null&&n.length){const d=n.indexOf(o.id),u=n.indexOf(a.id);if(d!==-1&&u!==-1)return d-u;if(d!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){var l;const n=(t==null?void 0:t.connectMethodsOrder)||((l=fe.state.features)==null?void 0:l.connectMethodsOrder),r=e||ke.state.connectors;if(n)return n;const{injected:s,announced:i}=y1.getConnectorsByType(r,dt.state.recommended,dt.state.featured),o=s.filter(y1.showConnector),a=i.filter(y1.showConnector);return o.length||a.length?["wallet","email","social"]:vAe.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&dt.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&dt.state.excludedWallets.some(r=>nr.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))}},y1={getConnectorsByType(t,e,n){const{customWallets:r}=fe.state,s=ye.getRecentWallets(),i=F_.filterOutDuplicateWallets(e),o=F_.filterOutDuplicateWallets(n),a=t.filter(h=>h.type==="MULTI_CHAIN"),l=t.filter(h=>h.type==="ANNOUNCED"),d=t.filter(h=>h.type==="INJECTED"),u=t.filter(h=>h.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:l,injected:d,recommended:i,featured:o}},showConnector(t){var s;const e=(s=t.info)==null?void 0:s.rdns,n=!!e&&dt.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),r=!!t.name&&dt.state.excludedWallets.some(i=>nr.isLowerCaseMatch(i.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!Le.isMobile()||Le.isMobile()&&!e&&!Oe.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(M.state.chains.values()).some(n=>ke.getConnectorId(n.namespace)===ne.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:l=(d=>(d=fe.state.features)==null?void 0:d.connectorTypeOrder)()??[]}){const h=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(g=>g.isEnabled),f=new Set(h.map(g=>g.type)),p=l.filter(g=>f.has(g)).map(g=>({type:g,isEnabled:!0})),m=h.filter(({type:g})=>!p.some(({type:b})=>b===g));return Array.from(new Set([...p,...m].map(({type:g})=>g)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,n)=>e.explorerWallet&&n.explorerWallet?(e.explorerWallet.order??0)-(n.explorerWallet.order??0):e.explorerWallet?-1:n.explorerWallet?1:0)},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){var e,n;try{if(t.name==="Browser Wallet"&&!Le.isMobile())return{accounts:[],chainId:void 0};if(t.id===ne.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[r,s]=await Promise.all([(e=t.provider)==null?void 0:e.request({method:"eth_accounts"}),(n=t.provider)==null?void 0:n.request({method:"eth_chainId"}).then(i=>Number(i))]);return{accounts:r,chainId:s}}catch(r){return console.warn(`Failed to fetch provider data for ${t.name}`,r),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const w1=globalThis,OR=w1.ShadowRoot&&(w1.ShadyCSS===void 0||w1.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,DR=Symbol(),e6=new WeakMap;let Oz=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==DR)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(OR&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=e6.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&e6.set(n,e))}return e}toString(){return this.cssText}};const ea=t=>new Oz(typeof t=="string"?t:t+"",void 0,DR),wd=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new Oz(n,t,DR)},EAe=(t,e)=>{if(OR)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=w1.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},t6=OR?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return ea(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:CAe,defineProperty:NAe,getOwnPropertyDescriptor:AAe,getOwnPropertyNames:SAe,getOwnPropertySymbols:TAe,getPrototypeOf:_Ae}=Object,tu=globalThis,n6=tu.trustedTypes,kAe=n6?n6.emptyScript:"",NS=tu.reactiveElementPolyfillSupport,Dy=(t,e)=>t,z_={toAttribute(t,e){switch(e){case Boolean:t=t?kAe:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},Dz=(t,e)=>!CAe(t,e),r6={attribute:!0,type:String,converter:z_,reflect:!1,useDefault:!1,hasChanged:Dz};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),tu.litPropertyMetadata??(tu.litPropertyMetadata=new WeakMap);let Cp=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=r6){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&NAe(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=AAe(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??r6}static _$Ei(){if(this.hasOwnProperty(Dy("elementProperties")))return;const e=_Ae(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Dy("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Dy("properties"))){const n=this.properties,r=[...SAe(n),...TAe(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(t6(s))}else e!==void 0&&n.push(t6(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(n=>n(this))}addController(e){var n;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((n=e.hostConnected)==null||n.call(e))}removeController(e){var n;(n=this._$EO)==null||n.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return EAe(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostConnected)==null?void 0:r.call(n)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostDisconnected)==null?void 0:r.call(n)})}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){var i;const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const o=(((i=r.converter)==null?void 0:i.toAttribute)!==void 0?r.converter:z_).toAttribute(n,r.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,n){var i,o;const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=r.getPropertyOptions(s),l=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:z_;this._$Em=s;const d=l.fromAttribute(n,a.type);this[s]=d??((o=this._$Ej)==null?void 0:o.get(s))??d,this._$Em=null}}requestUpdate(e,n,r){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(r??(r=i.getPropertyOptions(e)),!((r.hasChanged??Dz)(o,n)||r.useDefault&&r.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,l=this[i];a!==!0||this._$AL.has(i)||l===void 0||this.C(i,void 0,o,l)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),(r=this._$EO)==null||r.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(n)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(n)}willUpdate(e){}_$AE(e){var n;(n=this._$EO)==null||n.forEach(r=>{var s;return(s=r.hostUpdated)==null?void 0:s.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};Cp.elementStyles=[],Cp.shadowRootOptions={mode:"open"},Cp[Dy("elementProperties")]=new Map,Cp[Dy("finalized")]=new Map,NS==null||NS({ReactiveElement:Cp}),(tu.reactiveElementVersions??(tu.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const My=globalThis,HE=My.trustedTypes,s6=HE?HE.createPolicy("lit-html",{createHTML:t=>t}):void 0,Mz="$lit$",xd=`lit$${Math.random().toFixed(9).slice(2)}$`,Uz="?"+xd,IAe=`<${Uz}>`,Cf=document,gx=()=>Cf.createComment(""),yx=t=>t===null||typeof t!="object"&&typeof t!="function",MR=Array.isArray,RAe=t=>MR(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",AS=`[ 	
\f\r]`,q0=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,i6=/-->/g,o6=/>/g,Du=RegExp(`>|${AS}(?:([^\\s"'>=/]+)(${AS}*=${AS}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),a6=/'/g,c6=/"/g,Lz=/^(?:script|style|textarea|title)$/i,Bz=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),bje=Bz(1),vje=Bz(2),jg=Symbol.for("lit-noChange"),zr=Symbol.for("lit-nothing"),l6=new WeakMap,wh=Cf.createTreeWalker(Cf,129);function $z(t,e){if(!MR(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return s6!==void 0?s6.createHTML(e):e}const jAe=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=q0;for(let a=0;a<n;a++){const l=t[a];let d,u,h=-1,f=0;for(;f<l.length&&(o.lastIndex=f,u=o.exec(l),u!==null);)f=o.lastIndex,o===q0?u[1]==="!--"?o=i6:u[1]!==void 0?o=o6:u[2]!==void 0?(Lz.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Du):u[3]!==void 0&&(o=Du):o===Du?u[0]===">"?(o=s??q0,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,d=u[1],o=u[3]===void 0?Du:u[3]==='"'?c6:a6):o===c6||o===a6?o=Du:o===i6||o===o6?o=q0:(o=Du,s=void 0);const p=o===Du&&t[a+1].startsWith("/>")?" ":"";i+=o===q0?l+IAe:h>=0?(r.push(d),l.slice(0,h)+Mz+l.slice(h)+xd+p):l+xd+(h===-2?a:p)}return[$z(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class wx{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,l=this.parts,[d,u]=jAe(e,n);if(this.el=wx.createElement(d,r),wh.currentNode=this.el.content,n===2||n===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(s=wh.nextNode())!==null&&l.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const h of s.getAttributeNames())if(h.endsWith(Mz)){const f=u[o++],p=s.getAttribute(h).split(xd),m=/([.?@])?(.*)/.exec(f);l.push({type:1,index:i,name:m[2],strings:p,ctor:m[1]==="."?OAe:m[1]==="?"?DAe:m[1]==="@"?MAe:wN}),s.removeAttribute(h)}else h.startsWith(xd)&&(l.push({type:6,index:i}),s.removeAttribute(h));if(Lz.test(s.tagName)){const h=s.textContent.split(xd),f=h.length-1;if(f>0){s.textContent=HE?HE.emptyScript:"";for(let p=0;p<f;p++)s.append(h[p],gx()),wh.nextNode(),l.push({type:2,index:++i});s.append(h[f],gx())}}}else if(s.nodeType===8)if(s.data===Uz)l.push({type:2,index:i});else{let h=-1;for(;(h=s.data.indexOf(xd,h+1))!==-1;)l.push({type:7,index:i}),h+=xd.length-1}i++}}static createElement(e,n){const r=Cf.createElement("template");return r.innerHTML=e,r}}function Pg(t,e,n=t,r){var o,a;if(e===jg)return e;let s=r!==void 0?(o=n._$Co)==null?void 0:o[r]:n._$Cl;const i=yx(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??(n._$Co=[]))[r]=s:n._$Cl=s),s!==void 0&&(e=Pg(t,s._$AS(t,e.values),s,r)),e}class PAe{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=((e==null?void 0:e.creationScope)??Cf).importNode(n,!0);wh.currentNode=s;let i=wh.nextNode(),o=0,a=0,l=r[0];for(;l!==void 0;){if(o===l.index){let d;l.type===2?d=new n0(i,i.nextSibling,this,e):l.type===1?d=new l.ctor(i,l.name,l.strings,this,e):l.type===6&&(d=new UAe(i,this,e)),this._$AV.push(d),l=r[++a]}o!==(l==null?void 0:l.index)&&(i=wh.nextNode(),o++)}return wh.currentNode=Cf,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class n0{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=zr,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=Pg(this,e,n),yx(e)?e===zr||e==null||e===""?(this._$AH!==zr&&this._$AR(),this._$AH=zr):e!==this._$AH&&e!==jg&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):RAe(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==zr&&yx(this._$AH)?this._$AA.nextSibling.data=e:this.T(Cf.createTextNode(e)),this._$AH=e}$(e){var i;const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=wx.createElement($z(r.h,r.h[0]),this.options)),r);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(n);else{const o=new PAe(s,this),a=o.u(this.options);o.p(n),this.T(a),this._$AH=o}}_$AC(e){let n=l6.get(e.strings);return n===void 0&&l6.set(e.strings,n=new wx(e)),n}k(e){MR(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new n0(this.O(gx()),this.O(gx()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,n);e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var n;this._$AM===void 0&&(this._$Cv=e,(n=this._$AP)==null||n.call(this,e))}}class wN{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=zr,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=zr}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=Pg(this,e,n,0),o=!yx(e)||e!==this._$AH&&e!==jg,o&&(this._$AH=e);else{const a=e;let l,d;for(e=i[0],l=0;l<i.length-1;l++)d=Pg(this,a[r+l],n,l),d===jg&&(d=this._$AH[l]),o||(o=!yx(d)||d!==this._$AH[l]),d===zr?e=zr:e!==zr&&(e+=(d??"")+i[l+1]),this._$AH[l]=d}o&&!s&&this.j(e)}j(e){e===zr?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class OAe extends wN{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===zr?void 0:e}}class DAe extends wN{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==zr)}}class MAe extends wN{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=Pg(this,e,n,0)??zr)===jg)return;const r=this._$AH,s=e===zr&&r!==zr||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==zr&&(r===zr||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n;typeof this._$AH=="function"?this._$AH.call(((n=this.options)==null?void 0:n.host)??this.element,e):this._$AH.handleEvent(e)}}class UAe{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Pg(this,e)}}const Eje={I:n0},SS=My.litHtmlPolyfillSupport;SS==null||SS(wx,n0),(My.litHtmlVersions??(My.litHtmlVersions=[])).push("3.3.1");const LAe=(t,e,n)=>{const r=(n==null?void 0:n.renderBefore)??e;let s=r._$litPart$;if(s===void 0){const i=(n==null?void 0:n.renderBefore)??null;r._$litPart$=s=new n0(e.insertBefore(gx(),i),i,void 0,n??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Jh=globalThis;class x1 extends Cp{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var n;const e=super.createRenderRoot();return(n=this.renderOptions).renderBefore??(n.renderBefore=e.firstChild),e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=LAe(n,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return jg}}var jM;x1._$litElement$=!0,x1.finalized=!0,(jM=Jh.litElementHydrateSupport)==null||jM.call(Jh,{LitElement:x1});const TS=Jh.litElementPolyfillSupport;TS==null||TS({LitElement:x1});(Jh.litElementVersions??(Jh.litElementVersions=[])).push("4.2.1");const BAe={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},VE={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},$Ae={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},FAe={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},zAe={regular:"KHTeka",mono:"KHTekaMono"},HAe={regular:"400",medium:"500"},VAe={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},WAe={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},qAe={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},KAe={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},H_={colors:BAe,fontFamily:zAe,fontWeight:HAe,textSize:VAe,typography:WAe,tokens:{core:VE.core,theme:VE.dark},borderRadius:$Ae,spacing:FAe,durations:KAe,easings:qAe},d6="--apkt",qc={createCSSVariables(t){const e={},n={};function r(i,o,a=""){for(const[l,d]of Object.entries(i)){const u=a?`${a}-${l}`:l;d&&typeof d=="object"&&Object.keys(d).length?(o[l]={},r(d,o[l],u)):typeof d=="string"&&(o[l]=`${d6}-${u}`)}}function s(i,o){for(const[a,l]of Object.entries(i))l&&typeof l=="object"?(o[a]={},s(l,o[a])):typeof l=="string"&&(o[a]=`var(${l})`)}return r(t,e),s(e,n),{cssVariables:e,cssVariablesVarPrefix:n}},assignCSSVariables(t,e){const n={};function r(s,i,o){for(const[a,l]of Object.entries(s)){const d=o?`${o}-${a}`:a,u=i[a];l&&typeof l=="object"?r(l,u,d):typeof u=="string"&&(n[`${d6}-${d}`]=u)}}return r(t,e),n},createRootStyles(t,e){const n={...H_,tokens:{...H_.tokens,theme:t==="light"?VE.light:VE.dark}},{cssVariables:r}=qc.createCSSVariables(n),s=qc.assignCSSVariables(r,n),i=qc.generateW3MVariables(e),o=qc.generateW3MOverrides(e),a=qc.generateScaledVariables(e),l=qc.generateBaseVariables(s),d={...s,...l,...i,...o,...a},u=qc.applyColorMixToVariables(e,d),h={...d,...u};return`:root {${Object.entries(h).map(([p,m])=>`${p}:${m.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e={};return e["--w3m-font-family"]=t["--w3m-font-family"]||"KHTeka",e["--w3m-accent"]=t["--w3m-accent"]||"#0988F0",e["--w3m-color-mix"]=t["--w3m-color-mix"]||"#000",e["--w3m-color-mix-strength"]=`${t["--w3m-color-mix-strength"]||0}%`,e["--w3m-font-size-master"]=t["--w3m-font-size-master"]||"10px",e["--w3m-border-radius-master"]=t["--w3m-border-radius-master"]||"4px",e},generateW3MOverrides(t){if(!t)return{};const e={};if(t["--w3m-accent"]){const n=t["--w3m-accent"];e["--apkt-tokens-core-iconAccentPrimary"]=n,e["--apkt-tokens-core-borderAccentPrimary"]=n,e["--apkt-tokens-core-textAccentPrimary"]=n,e["--apkt-tokens-core-backgroundAccentPrimary"]=n}return t["--w3m-font-family"]&&(e["--apkt-fontFamily-regular"]=t["--w3m-font-family"]),t["--w3m-z-index"]&&(e["--apkt-tokens-core-zIndex"]=`${t["--w3m-z-index"]}`),e},generateScaledVariables(t){if(!t)return{};const e={};if(t["--w3m-font-size-master"]){const n=parseFloat(t["--w3m-font-size-master"].replace("px",""));e["--apkt-textSize-h1"]=`${Number(n)*5}px`,e["--apkt-textSize-h2"]=`${Number(n)*4.4}px`,e["--apkt-textSize-h3"]=`${Number(n)*3.8}px`,e["--apkt-textSize-h4"]=`${Number(n)*3.2}px`,e["--apkt-textSize-h5"]=`${Number(n)*2.6}px`,e["--apkt-textSize-h6"]=`${Number(n)*2}px`,e["--apkt-textSize-large"]=`${Number(n)*1.6}px`,e["--apkt-textSize-medium"]=`${Number(n)*1.4}px`,e["--apkt-textSize-small"]=`${Number(n)*1.2}px`}if(t["--w3m-border-radius-master"]){const n=parseFloat(t["--w3m-border-radius-master"].replace("px",""));e["--apkt-borderRadius-1"]=`${Number(n)}px`,e["--apkt-borderRadius-2"]=`${Number(n)*2}px`,e["--apkt-borderRadius-3"]=`${Number(n)*3}px`,e["--apkt-borderRadius-4"]=`${Number(n)*4}px`,e["--apkt-borderRadius-5"]=`${Number(n)*5}px`,e["--apkt-borderRadius-6"]=`${Number(n)*6}px`,e["--apkt-borderRadius-8"]=`${Number(n)*8}px`,e["--apkt-borderRadius-16"]=`${Number(n)*16}px`,e["--apkt-borderRadius-20"]=`${Number(n)*20}px`,e["--apkt-borderRadius-32"]=`${Number(n)*32}px`,e["--apkt-borderRadius-64"]=`${Number(n)*64}px`,e["--apkt-borderRadius-128"]=`${Number(n)*128}px`}return e},generateColorMixCSS(t,e){if(!(t!=null&&t["--w3m-color-mix"])||!t["--w3m-color-mix-strength"])return"";const n=t["--w3m-color-mix"],r=t["--w3m-color-mix-strength"];if(!r||r===0)return"";const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),l=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!l});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const a=(e==null?void 0:e[o])||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${n} ${r}%, ${a});`:`${o}: color-mix(in srgb, ${n} ${r}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},n=t["--apkt-tokens-theme-backgroundPrimary"];n&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=n);const r=t["--apkt-tokens-core-backgroundAccentPrimary"];return r&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=r),e},applyColorMixToVariables(t,e){const n={};if(e!=null&&e["--apkt-tokens-theme-backgroundPrimary"]&&(n["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e!=null&&e["--apkt-tokens-core-backgroundAccentPrimary"]&&(n["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)"),!(t!=null&&t["--w3m-color-mix"])||!t["--w3m-color-mix-strength"])return n;const r=t["--w3m-color-mix"],s=t["--w3m-color-mix-strength"];if(!s||s===0)return n;const i=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon")||o.includes("-tokens-theme-overlay"),l=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!l});return i.length===0||i.forEach(o=>{const a=(e==null?void 0:e[o])||"";o.endsWith("-base")||(o==="--apkt-tokens-theme-backgroundPrimary"||o==="--apkt-tokens-core-backgroundAccentPrimary"?n[o]=`color-mix(in srgb, ${r} ${s}%, var(${o}-base))`:a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?n[o]=`color-mix(in srgb, ${r} ${s}%, ${a})`:n[o]=`color-mix(in srgb, ${r} ${s}%, var(${o}-base, ${a}))`)}),n}},{cssVariablesVarPrefix:GAe}=qc.createCSSVariables(H_);function Cje(t,...e){return wd(t,...e.map(n=>ea(typeof n=="function"?n(GAe):n)))}let Ju,xh,dc,Wi,WE;const Hc={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function qE(t,e="dark"){Ju&&document.head.removeChild(Ju),Ju=document.createElement("style"),Ju.textContent=qc.createRootStyles(e,t),document.head.appendChild(Ju)}function Nje(t,e="dark"){if(WE=t,xh=document.createElement("style"),dc=document.createElement("style"),Wi=document.createElement("style"),xh.textContent=um(t).core.cssText,dc.textContent=um(t).dark.cssText,Wi.textContent=um(t).light.cssText,document.head.appendChild(xh),document.head.appendChild(dc),document.head.appendChild(Wi),qE(t,e),V_(e),!(t!=null&&t["--w3m-font-family"]))for(const[n,r]of Object.entries(Hc)){const s=document.createElement("link");s.rel="preload",s.href=r,s.as="font",s.type=n.includes("woff2")?"font/woff2":"font/woff",s.crossOrigin="anonymous",document.head.appendChild(s)}V_(e)}function V_(t="dark"){dc&&Wi&&Ju&&(t==="light"?(qE(WE,t),dc.removeAttribute("media"),Wi.media="enabled"):(qE(WE,t),Wi.removeAttribute("media"),dc.media="enabled"))}function YAe(t){var e,n,r;if(WE=t,xh&&dc&&Wi&&(xh.textContent=um(t).core.cssText,dc.textContent=um(t).dark.cssText,Wi.textContent=um(t).light.cssText,t!=null&&t["--w3m-font-family"])){const s=t["--w3m-font-family"];xh.textContent=(e=xh.textContent)==null?void 0:e.replace("font-family: KHTeka",`font-family: ${s}`),dc.textContent=(n=dc.textContent)==null?void 0:n.replace("font-family: KHTeka",`font-family: ${s}`),Wi.textContent=(r=Wi.textContent)==null?void 0:r.replace("font-family: KHTeka",`font-family: ${s}`)}if(Ju){const s=(Wi==null?void 0:Wi.media)==="enabled"?"light":"dark";qE(t,s)}}function um(t){const e=!!(t!=null&&t["--w3m-font-family"]);return{core:wd`
      ${e?wd``:wd`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${ea(Hc["KHTeka-400-woff2"])}) format('woff2'),
                url(${ea(Hc["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${ea(Hc["KHTeka-300-woff2"])}) format('woff2'),
                url(${ea(Hc["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${ea(Hc["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${ea(Hc["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${ea(Hc["KHTeka-400-woff2"])}) format('woff2'),
                url(${ea(Hc["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:wd`
      :root {
      }
    `,light:wd`
      :root {
      }
    `}}const Aje=wd`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,Sje=wd`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,Zh={hexStringToNumber(t){const e=t.startsWith("0x")?t.slice(2):t;return parseInt(e,16)},numberToHexString(t){return`0x${t.toString(16)}`},async getUserInfo(t){const[e,n]=await Promise.all([Zh.getAddresses(t),Zh.getChainId(t)]);return{chainId:n,addresses:e}},async getChainId(t){const e=await t.request({method:"eth_chainId"});return Number(e)},async getAddress(t){const[e]=await t.request({method:"eth_accounts"});return e},async getAddresses(t){return await t.request({method:"eth_accounts"})},async addEthereumChain(t,e){var r,s;const n=((r=e.rpcUrls.chainDefault)==null?void 0:r.http)||[];await t.request({method:"wallet_addEthereumChain",params:[{chainId:Zh.numberToHexString(e.id),rpcUrls:[...n],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[ic.NetworkImageIds[e.id]]}]})}},mp={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},QAe=Nse({id:56,name:"BNB Smart Chain",blockTime:750,nativeCurrency:{decimals:18,name:"BNB",symbol:"BNB"},rpcUrls:{default:{http:["https://56.rpc.thirdweb.com"]}},blockExplorers:{default:{name:"BscScan",url:"https://bscscan.com",apiUrl:"https://api.bscscan.com/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:15921452}}});function r0(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const u6=r0({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),h6=r0({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});r0({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});r0({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});r0({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});r0({id:"00000008819873e925422c1ff0f99f7c",caipNetworkId:"bip122:00000008819873e925422c1ff0f99f7c",chainNamespace:"bip122",name:"Bitcoin Signet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const Fz={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Ji={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return Fz[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,l]=i.split(":");!a||!l||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[l]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,l=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const d=`${o}:${i}`,u=r[o];switch(u.chains.push(d),d){case u6.caipNetworkId:u.chains.push(u6.deprecatedCaipNetworkId);break;case h6.caipNetworkId:u.chains.push(h6.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&l&&(u.rpcMap[i]=l),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{var r;const e=await Ny.resolveName(t);return((r=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:r.address)||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.code=="number",r=n&&e.code===Ji.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=n&&e.code===Ji.RPC_ERROR_CODE.USER_REJECTED;return r||s}return!1}catch{return!1}},isOriginAllowed(t,e,n){for(const r of[...e,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(r).origin===t)return!0}catch{if(r===t)return!0}return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=Ji.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("accountsChanged",a=>{var l,d,u,h,f;try{const p=((u=(d=(l=t.session)==null?void 0:l.namespaces)==null?void 0:d[e])==null?void 0:u.accounts)||[],m=(f=(h=t.rpcProviders)==null?void 0:h[e])==null?void 0:f.getDefaultChain(),g=a.map(w=>{const b=p.find(v=>v.includes(`${e}:${m}:${w}`));if(!b)return;const{chainId:y,chainNamespace:x}=Rr.parseCaipAddress(b);return{address:w,chainId:y,chainNamespace:x}}).filter(w=>w!==void 0);g.length>0&&s(g)}catch(p){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,p)}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){var s,i,o,a;const n=new Set,r=(a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(l=>Rr.parseCaipAddress(l)).filter(({address:l})=>n.has(l.toLowerCase())?!1:(n.add(l.toLowerCase()),!0));return r&&r.length>0?r:[]}};class JAe{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case ne.CHAIN.EVM:await this.syncEVMConnections(e);break;case ne.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case ne.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:a,hasConnected:l}=nr.getConnectorStorageInfo(o.id,this.namespace);return!a&&l}).map(async o=>{if(o.id===ne.CONNECTOR_ID.WALLET_CONNECT){const a=Ji.getWalletConnectAccounts(r,this.namespace),l=n.find(d=>{var u,h;return d.chainNamespace===this.namespace&&d.id.toString()===((h=(u=a[0])==null?void 0:u.chainId)==null?void 0:h.toString())});a.length>0&&s({connectorId:o.id,accounts:a.map(d=>({address:d.address})),caipNetwork:l})}else{const{accounts:a,chainId:l}=await y1.fetchProviderData(o);if(a.length>0&&l){const d=n.find(u=>u.chainNamespace===this.namespace&&u.id.toString()===l.toString());s({connectorId:o.id,accounts:a.map(u=>({address:u})),caipNetwork:d}),o.provider&&o.id!==ne.CONNECTOR_ID.AUTH&&o.id!==ne.CONNECTOR_ID.WALLET_CONNECT&&i(o.id,o.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:a,hasConnected:l}=nr.getConnectorStorageInfo(o.id,this.namespace);return!a&&l}).map(async o=>{if(o.id===ne.CONNECTOR_ID.WALLET_CONNECT){const a=Ji.getWalletConnectAccounts(r,this.namespace);a.length>0&&s({connectorId:o.id,accounts:a.map(l=>({address:l.address})),caipNetwork:n})}else{const a=await o.connect({chainId:n==null?void 0:n.id});a&&(s({connectorId:o.id,accounts:[{address:a}],caipNetwork:n}),i(o.id,o.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:a,hasConnected:l}=nr.getConnectorStorageInfo(o.id,this.namespace);return!a&&l}).map(async o=>{var h,f,p,m,g,w;if(o.id===ne.CONNECTOR_ID.WALLET_CONNECT){const b=Ji.getWalletConnectAccounts(r,this.namespace);b.length>0&&s({connectorId:o.id,accounts:b.map(y=>({address:y.address})),caipNetwork:n});return}const a=await o.connect(),l=await o.getAccountAddresses();let d=l==null?void 0:l.map(b=>Le.createAccount(ne.CHAIN.BITCOIN,b.address,b.purpose||"payment",b.publicKey,b.path));if(d&&d.length>1&&(d=[{namespace:ne.CHAIN.BITCOIN,publicKey:((h=d[mp.ACCOUNT_INDEXES.PAYMENT])==null?void 0:h.publicKey)??"",path:((f=d[mp.ACCOUNT_INDEXES.PAYMENT])==null?void 0:f.path)??"",address:((p=d[mp.ACCOUNT_INDEXES.PAYMENT])==null?void 0:p.address)??"",type:"payment"},{namespace:ne.CHAIN.BITCOIN,publicKey:((m=d[mp.ACCOUNT_INDEXES.ORDINAL])==null?void 0:m.publicKey)??"",path:((g=d[mp.ACCOUNT_INDEXES.ORDINAL])==null?void 0:g.path)??"",address:((w=d[mp.ACCOUNT_INDEXES.ORDINAL])==null?void 0:w.address)??"",type:"ordinal"}]),!(o.chains.find(b=>b.id===(n==null?void 0:n.id))||o.chains[0]))throw new Error("The connector does not support any of the requested chains");a&&(i(o.id,o.provider),s({connectorId:o.id,accounts:d.map(b=>({address:b.address,type:b.type,publicKey:b.publicKey,path:b.path})),caipNetwork:n}))}))}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(d=>nr.isLowerCaseMatch(d.connectorId,n));if(!o)return null;const a=s.find(d=>nr.isLowerCaseMatch(d.id,o.connectorId)),l=e?o.accounts.find(d=>nr.isLowerCaseMatch(d.address,e)):o.accounts[0];return{...o,account:l,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>nr.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(l=>nr.isLowerCaseMatch(l.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const uc={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class UR{constructor({provider:e,namespace:n}){this.id=ne.CONNECTOR_ID.WALLET_CONNECT,this.name=ic.ConnectorNamesMap[ne.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=ic.ConnectorImageIds[ne.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=M.getCaipNetworks.bind(M),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=fe.state.universalProviderConfigOverride,s=Ji.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return qi.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:ZAe})}}const ZAe=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],XAe=[ne.CONNECTOR_ID.AUTH,ne.CONNECTOR_ID.WALLET_CONNECT];class zz{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>M.getCaipNetworks(n),this.getConnectorId=n=>ke.getConnectorId(n),e&&this.construct(e),e!=null&&e.namespace&&(this.connectionManager=new JAe({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===(n==null?void 0:n.toString()));e&&r&&this.addConnection({connectorId:ne.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:ne.CONNECTOR_ID.AUTH,type:"AUTH",name:ne.CONNECTOR_NAMES.AUTH,provider:e,imageId:ic.ConnectorImageIds[ne.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>!nr.isLowerCaseMatch(n.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){M.setAccountProp("status",e,n)}on(e,n){var r;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(r=this.eventListeners.get(e))==null||r.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(n){throw Ji.isUserRejectedRequestError(n)?new HI(n):n}}async switchNetwork(e){const{caipNetwork:n,providerType:r}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=Ws(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n instanceof UR);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=Le.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===(s==null?void 0:s.toString())),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:l}=Le.getAccount(a);return{address:l}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){var s,i;if(e.length>0){const{address:o}=Le.getAccount(e[0]),a=(s=this.connectionManager)==null?void 0:s.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});o&&nr.isLowerCaseMatch(this.getConnectorId(ne.CHAIN.EVM),n)&&this.emit("accountChanged",{address:o,chainId:(i=a==null?void 0:a.caipNetwork)==null?void 0:i.id,connector:a==null?void 0:a.connector}),this.addConnection({connectorId:n,accounts:e.map(l=>{const{address:d}=Le.getAccount(l);return{address:d}}),caipNetwork:a==null?void 0:a.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),nr.isLowerCaseMatch(this.getConnectorId(ne.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){var o;const r=typeof e=="string"&&e.startsWith("0x")?Zh.hexStringToNumber(e).toString():e.toString(),s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),nr.isLowerCaseMatch(this.getConnectorId(ne.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(XAe.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){var n,r;const e=(n=this.connectionManager)==null?void 0:n.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[s]=e.accounts;this.emit("accountChanged",{address:s==null?void 0:s.address,chainId:(r=e.caipNetwork)==null?void 0:r.id,connector:e.connector})}}}class eSe extends zz{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new UR({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){var s,i,o,a;const n=this.provider,r=((a=(o=(i=(s=n==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(l=>{const[,,d]=l.split(":");return d}).filter((l,d,u)=>u.indexOf(l)===d))||[];return Promise.resolve({accounts:r.map(l=>Le.createAccount(e,l,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var o,a,l,d,u;if(!(e.caipNetwork&&Vt.BALANCE_SUPPORTED_CHAINS.includes((o=e.caipNetwork)==null?void 0:o.chainNamespace))||(a=e.caipNetwork)!=null&&a.testnet)return{balance:"0.00",symbol:((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""};const r=M.getAccountData();if(r!=null&&r.balanceLoading&&e.chainId===((d=M.state.activeCaipNetwork)==null?void 0:d.id))return{balance:(r==null?void 0:r.balance)||"0.00",symbol:(r==null?void 0:r.balanceSymbol)||""};const i=(await M.fetchTokenBalance()).find(h=>{var f,p;return h.chainId===`${(f=e.caipNetwork)==null?void 0:f.chainNamespace}:${e.chainId}`&&h.symbol===((p=e.caipNetwork)==null?void 0:p.nativeCurrency.symbol)});return{balance:(i==null?void 0:i.quantity.numeric)||"0.00",symbol:(i==null?void 0:i.symbol)||((u=e.caipNetwork)==null?void 0:u.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,l;const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=M.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===ne.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:Jg.encode(new TextEncoder().encode(r)),pubkey:s}},(a=M.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},(l=M.state.activeCaipNetwork)==null?void 0:l.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,l,d;const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===ne.CHAIN.EVM)try{await((s=r.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:MO(n.id)}]}))}catch(u){if(u.code===uc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===uc.ERROR_INVALID_CHAIN_ID||u.code===uc.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===uc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((d=r.provider)==null?void 0:d.request({method:"wallet_addEthereumChain",params:[{chainId:MO(n.id),rpcUrls:[(a=n==null?void 0:n.rpcUrls.chainDefault)==null?void 0:a.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[(l=n.blockExplorers)==null?void 0:l.default.url]}]}))}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(r=>r.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}const tSe=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],Av={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Vt.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Vt.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Vt.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Vt.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Vt.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Vt.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Vt.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?Vt.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t}},nSe={localSettingsOverridden:new Set,getApiConfig(t,e){return e==null?void 0:e.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=Av[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=Av[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return(a==null?void 0:a.config)===null?this.processFallbackFeature(t,o):a!=null&&a.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Av[t].processApi(e)},processFallbackFeature(t,e){return Av[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await dt.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Vt.DEFAULT_REMOTE_FEATURES:Vt.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of tSe){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Vt.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;Ts.open({debugMessage:_s.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class rSe{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{var s,i,o;if(n){const a=(s=M.getCaipNetworks(n))==null?void 0:s.find(u=>u.id===r);if(a)return a;const l=(i=M.getNetworkData(n))==null?void 0:i.caipNetwork;return l||((o=M.getRequestedCaipNetworks(n).filter(u=>u.chainNamespace===n))==null?void 0:o[0])}return M.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>M.getCaipNetworks(n),this.getActiveChainNamespace=()=>M.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{M.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>M.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>{var r,s;return M.state.activeChain===n||!n?M.state.activeCaipAddress:(s=(r=M.state.chains.get(n))==null?void 0:r.accountState)==null?void 0:s.caipAddress},this.setClientId=n=>{gt.setClientId(n)},this.getProvider=n=>Jt.getProvider(n),this.getProviderType=n=>Jt.getProviderId(n),this.getPreferredAccountType=n=>Ws(n),this.setCaipAddress=(n,r,s=!1)=>{M.setAccountProp("caipAddress",n,r,s),M.setAccountProp("address",Le.getPlainAddress(n),r,s)},this.setBalance=(n,r,s)=>{M.setAccountProp("balance",n,s),M.setAccountProp("balanceSymbol",r,s)},this.setProfileName=(n,r)=>{M.setAccountProp("profileName",n,r)},this.setProfileImage=(n,r)=>{M.setAccountProp("profileImage",n,r)},this.setUser=(n,r)=>{M.setAccountProp("user",n,r)},this.resetAccount=n=>{M.resetAccount(n)},this.setCaipNetwork=n=>{M.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{M.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{M.setAccountProp("status",n,r),ke.isConnected()?ye.setConnectionStatus("connected"):ye.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>{var r;return(r=M.getAccountData(n))==null?void 0:r.address},this.setConnectors=n=>{const r=[...ke.state.allConnectors,...n];ke.setConnectors(r)},this.setConnections=(n,r)=>{ye.setConnections(n,r),Oe.setConnections(n,r)},this.fetchIdentity=n=>gt.fetchIdentity(n),this.getReownName=n=>Ny.getNamesForAddress(n),this.getConnectors=()=>ke.getConnectors(),this.getConnectorImage=n=>oF.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?yE.getConnectionsData(n).connections:(Ts.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?yE.getConnectionsData(n).recentConnections:(Ts.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){Ts.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await Oe.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){Ts.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}ye.deleteAddressFromConnection(n),Oe.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=Jt.getProviderId(r),i=n?{...n,type:s}:void 0;M.setAccountProp("connectedWalletInfo",i,r)},this.getIsConnectedState=()=>!!M.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{var o;const i=((o=M.getAccountData(s))==null?void 0:o.addressLabels)||{};M.setAccountProp("addressLabels",{...i,[n]:r},s)},this.removeAddressLabel=(n,r)=>{var i;const s=((i=M.getAccountData(r))==null?void 0:i.addressLabels)||{};M.setAccountProp("addressLabels",{...s,[n]:void 0},r)},this.getAddress=n=>{var s;const r=n||M.state.activeChain;return(s=M.getAccountData(r))==null?void 0:s.address},this.setApprovedCaipNetworksData=n=>M.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{M.resetNetwork(n)},this.addConnector=n=>{ke.addConnector(n)},this.resetWcConnection=()=>{Oe.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{M.setAccountProp("addressExplorerUrl",n,r)},this.setSmartAccountDeployed=(n,r)=>{M.setAccountProp("smartAccountDeployed",n,r)},this.setPreferredAccountType=(n,r)=>{M.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{fe.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e),QEe.checkSDKVersion(e.sdkVersion)}getChainNamespacesSet(e,n){const r=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(r!=null&&r.length)return[...new Set(r)];const s=n==null?void 0:n.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var n,r,s,i,o;if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),fe.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await nSe.fetchRemoteFeatures(e),fe.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&$T.setOnrampProviders(this.remoteFeatures.onramp),((n=fe.state.remoteFeatures)!=null&&n.email||Array.isArray((r=fe.state.remoteFeatures)==null?void 0:r.socials)&&((s=fe.state.remoteFeatures)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins(),(i=fe.state.features)!=null&&i.reownAuthentication||(o=fe.state.remoteFeatures)!=null&&o.reownAuthentication){const{ReownAuthentication:a}=await $n(async()=>{const{ReownAuthentication:d}=await import("./features-FtV0ohcQ.js");return{ReownAuthentication:d}},[]),l=fe.state.siwx;l instanceof a||(l&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),fe.setSIWX(new a))}}async openSend(e){var i;const n=e.namespace||M.state.activeChain,r=this.getCaipAddress(n),s=(i=this.getCaipNetwork(n))==null?void 0:i.id;if(!r)throw new Error("openSend: caipAddress not found");if((s==null?void 0:s.toString())!==e.chainId.toString()){const o=M.getCaipNetworkById(e.chainId,n);if(!o)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(o,{throwOnFailure:!0})}try{const o=Az.getTokenSymbolByAddress(e.assetAddress);o&&await dt.fetchTokenImages([o])}catch{}return await Dt.open({view:"WalletSend",data:{send:e}}),new Promise((o,a)=>{const l=Pt.subscribeKey("hash",h=>{h&&(u(),o({hash:h}))}),d=Dt.subscribe(h=>{h.open||(u(),a(new Error("Modal closed")))}),u=this.createCleanupHandler([l,d])})}toModalOptions(){function e(r){return(r==null?void 0:r.view)==="Swap"}function n(r){return(r==null?void 0:r.view)==="WalletSend"}return{isSwap:e,isSend:n}}async checkAllowedOrigins(){try{const e=await dt.fetchAllowedOrigins();if(!Le.isClient())return;const n=window.location.origin;Ji.isOriginAllowed(n,e,uc.DEFAULT_ALLOWED_ANCESTORS)||Ts.open(_s.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":Ts.open(_s.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;Ts.open({displayMessage:_s.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:_s.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(n=>{try{n()}catch{}})}}sendInitializeEvent(e){var r;const{...n}=e;delete n.adapters,delete n.universalProvider,Lt.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(s=>s.id),siweConfig:{options:((r=e.siweConfig)==null?void 0:r.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&fi.setThemeMode(e.themeMode),e.themeVariables&&fi.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");M.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&M.setActiveCaipNetwork(n)}initializeConnectionController(e){Oe.initialize(e.adapters??[]),Oe.setWcBasic(e.basic??!1)}initializeConnectorController(){ke.initialize(this.chainNamespaces)}initializeProjectSettings(e){fe.setProjectId(e.projectId),fe.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var s;fe.setDebug(e.debug!==!1),fe.setEnableWalletGuide(e.enableWalletGuide!==!1),fe.setEnableWallets(e.enableWallets!==!1),fe.setEIP6963Enabled(e.enableEIP6963!==!1),fe.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),fe.setEnableReconnect(e.enableReconnect!==!1),fe.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),fe.setEnableAuthLogger(e.enableAuthLogger!==!1),fe.setCustomRpcUrls(e.customRpcUrls),fe.setEnableEmbedded(e.enableEmbedded),fe.setAllWallets(e.allWallets),fe.setIncludeWalletIds(e.includeWalletIds),fe.setExcludeWalletIds(e.excludeWalletIds),fe.setFeaturedWalletIds(e.featuredWalletIds),fe.setTokens(e.tokens),fe.setTermsConditionsUrl(e.termsConditionsUrl),fe.setPrivacyPolicyUrl(e.privacyPolicyUrl),fe.setCustomWallets(e.customWallets),fe.setFeatures(e.features),fe.setAllowUnsupportedChain(e.allowUnsupportedChain),fe.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),fe.setPreferUniversalLinks(e.experimental_preferUniversalLinks),fe.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),fe.setMetadata(e.metadata),fe.setDisableAppend(e.disableAppend),fe.setEnableEmbedded(e.enableEmbedded),fe.setSIWX(e.siwx),this.features=fe.state.features??{},!e.projectId){Ts.open(_s.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((s=e.adapters)==null?void 0:s.find(i=>i.namespace===ne.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");fe.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,n,r,s;return Le.isClient()?{name:((n=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:n.textContent)||"",description:((r=document.querySelector('meta[property="og:description"]'))==null?void 0:r.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=vp.getUnsupportedNetwork(`${n}:${e}`);M.setActiveCaipNetwork(r)}}getDefaultNetwork(){return vp.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return vp.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return vp.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return n?vp.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,n){var r,s;try{this.setLoading(!0,e);let i={connections:[]};const o=this.getAdapter(e);return(((s=(r=M.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.caipAddress)||!fe.state.enableReconnect)&&(o!=null&&o.disconnect)&&(i=await o.disconnect({id:n})),this.setLoading(!1,e),i}catch(i){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${i.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var d;const e=M.state.activeChain,n=this.getAdapter(e),r=(d=this.getCaipNetwork(e))==null?void 0:d.id,s=Oe.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId((a==null?void 0:a.clientId)||null),ye.setConnectedNamespaces([...M.state.chains.keys()]),await this.syncWalletConnectAccount(),await qi.initializeIfEnabled()},connectExternal:async e=>{const n=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,n),n?{address:n.address}:void 0},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{var a;const i=M.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:n,type:r,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),ye.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{var d;const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||M.state.activeChain,o=ke.getConnectorId(i),a=n===ne.CONNECTOR_ID.AUTH||o===ne.CONNECTOR_ID.AUTH,l=n===ne.CONNECTOR_ID.WALLET_CONNECT||o===ne.CONNECTOR_ID.WALLET_CONNECT;try{const u=Array.from(M.state.chains.keys());let h=r?[r]:u;(l||a)&&(h=u);const f=h.map(async g=>{const w=ke.getConnectorId(g),b=n||w,y=await this.disconnectConnector(g,b);y&&(a&&ye.deleteConnectedSocialProvider(),y.connections.forEach(x=>{ye.addDisconnectedConnectorId(x.connectorId,g)})),s&&this.onDisconnectNamespace({chainNamespace:g,closeModal:!1})}),p=await Promise.allSettled(f);Pt.resetSend(),Oe.resetWcConnection(),(d=qi.getSIWX())!=null&&d.signOutOnDisconnect&&await qi.clearSessions(),ke.setFilterByNamespace(void 0),Oe.syncStorageConnections();const m=p.filter(g=>g.status==="rejected");if(m.length>0)throw new Error(m.map(g=>g.reason.message).join(", "));Lt.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(u){throw new Error(`Failed to disconnect chains: ${u.message}`)}},checkInstalled:e=>e?e.some(n=>{var r;return!!((r=window.ethereum)!=null&&r[String(n)])}):!!window.ethereum,signMessage:async e=>{const n=M.state.activeChain,r=this.getAdapter(M.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=this.getAddress(n);if(!s)throw new Error("signMessage: address not found");const i=await(r==null?void 0:r.signMessage({message:e,address:s,provider:Jt.getProvider(n)}));return(i==null?void 0:i.signature)||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Vt.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=Jt.getProvider(n),i=await(r==null?void 0:r.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===ne.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=Jt.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");const o=await(r==null?void 0:r.estimateGas({...e,provider:s,caipNetwork:i}));return(o==null?void 0:o.gas)||0n}return 0n},getEnsAvatar:async()=>{var s;const e=M.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const n=this.getAddress(e);if(!n)throw new Error("getEnsAvatar: address not found");await this.syncIdentity({address:n,chainId:Number((s=this.getCaipNetwork())==null?void 0:s.id),chainNamespace:e});const r=M.getAccountData();return(r==null?void 0:r.profileImage)||!1},getEnsAddress:async e=>await Ji.resolveReownName(e),writeContract:async e=>{const n=M.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=Jt.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");const a=await(r==null?void 0:r.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}));return a==null?void 0:a.hash},parseUnits:(e,n)=>{const r=this.getAdapter(M.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return(r==null?void 0:r.parseUnits({value:e,decimals:n}))??0n},formatUnits:(e,n)=>{const r=this.getAdapter(M.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return(r==null?void 0:r.formatUnits({value:e,decimals:n}))??"0"},getCapabilities:async e=>{const n=this.getAdapter(M.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await(n==null?void 0:n.getCapabilities(e))},grantPermissions:async e=>{const n=this.getAdapter(M.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await(n==null?void 0:n.grantPermissions(e))},revokePermissions:async e=>{const n=this.getAdapter(M.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n!=null&&n.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(M.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await(n==null?void 0:n.walletGetAssets(e))??{}},updateBalance:e=>{const n=this.getAddress(e),r=this.getCaipNetwork(e);!r||!n||this.updateNativeBalance(n,r==null?void 0:r.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},Oe.setClient(this.connectionControllerClient)}async onConnectExternal(e){var d,u,h,f,p,m,g,w;const n=M.state.activeChain,r=e.chain||n,s=this.getAdapter(r);let i=!0;if(e.type===Wt.CONNECTOR_TYPE_AUTH&&ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(x=>ke.getConnectorId(x)===ne.CONNECTOR_ID.AUTH)&&e.chain!==n&&(i=!1),e.chain&&e.chain!==n&&!e.caipNetwork){const b=this.getCaipNetworks().find(y=>y.chainNamespace===e.chain);b&&i&&this.setCaipNetwork(b)}if(!r)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(r),a=e.caipNetwork||o,l=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:((d=e.caipNetwork)==null?void 0:d.id)||(o==null?void 0:o.id),rpcUrl:((p=(f=(h=(u=e.caipNetwork)==null?void 0:u.rpcUrls)==null?void 0:h.default)==null?void 0:f.http)==null?void 0:p[0])||((w=(g=(m=o==null?void 0:o.rpcUrls)==null?void 0:m.default)==null?void 0:g.http)==null?void 0:w[0])});if(l)return ye.addConnectedNamespace(r),this.syncProvider({...l,chainNamespace:r}),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),ye.removeDisconnectedConnectorId(e.id,r),{address:l.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,n){var l;const r=e.type===Wt.CONNECTOR_TYPE_AUTH,s=nr.getOtherAuthNamespaces((l=n==null?void 0:n.connectedCaipNetwork)==null?void 0:l.chainNamespace),i=M.state.activeCaipNetwork,o=this.getAdapter(i==null?void 0:i.chainNamespace),a=Jt.getProvider(i==null?void 0:i.chainNamespace);r&&(await Promise.all(s.map(async d=>{var u,h,f;try{const p=Jt.getProvider(d),m=this.getCaipNetwork(d),g=this.getAdapter(d);await(g==null?void 0:g.connect({...e,provider:p,socialUri:void 0,chainId:m==null?void 0:m.id,rpcUrl:(f=(h=(u=m==null?void 0:m.rpcUrls)==null?void 0:u.default)==null?void 0:h.http)==null?void 0:f[0]}))&&(ye.addConnectedNamespace(d),ye.removeDisconnectedConnectorId(e.id,d),this.setStatus("connected",d),this.syncConnectedWalletInfo(d))}catch(p){Ts.warn(_s.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,_s.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(d,p instanceof Error?p.message:void 0),_s.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await(o==null?void 0:o.switchNetwork({caipNetwork:i,provider:a,providerType:e.type})))}getApprovedCaipNetworksData(){var n,r,s,i,o;if(Jt.getProviderId(M.state.activeChain)===Wt.CONNECTOR_TYPE_WALLET_CONNECT){const a=(r=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:r.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=Jt.getProvider(n),i=Jt.getProviderId(n);if(e.chainNamespace===M.state.activeChain){const o=this.getAdapter(n);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===Wt.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=Rr.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{var i,o;const s=e==null?void 0:e.find(a=>a.namespace===r);return s?(s.construct({namespace:r,projectId:(i=this.options)==null?void 0:i.projectId,networks:(o=this.caipNetworks)==null?void 0:o.filter(({chainNamespace:a})=>a===r)}),n[r]=s):n[r]=new eSe({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){var n;this.onConnectors(e),this.listenAdapter(e),await((n=this.chainAdapters)==null?void 0:n[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const n=this.getAdapter(e);n==null||n.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=ye.getConnectionStatus();fe.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(ye.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{var d,u;const o=this.getCaipNetworks().find(h=>h.id.toString()===i.toString()||h.caipNetworkId.toString()===i.toString()),a=M.state.activeChain===e,l=(u=(d=M.state.chains.get(e))==null?void 0:d.accountState)==null?void 0:u.address;if(o){const h=a&&s?s:l;h&&this.syncAccount({address:h,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(Oe.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=this.getAddress(e),i=M.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{var u,h;this.handlePreviousConnectorConnection(o);const a=M.state.activeChain===e;o!=null&&o.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o==null?void 0:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const l=(h=(u=M.getNetworkData(e))==null?void 0:u.caipNetwork)==null?void 0:h.id,d=i||l;a&&d?this.syncAccount({address:s,chainId:d,chainNamespace:e}):!a&&d?(this.syncAccountInfo(s,d,e),this.syncBalance({address:s,chainId:d,chainNamespace:e})):this.syncAccountInfo(s,i,e),ye.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){var l;const n=e==null?void 0:e.chain,r=e==null?void 0:e.id,s=ke.getConnectorId(n),i=(l=fe.state.remoteFeatures)==null?void 0:l.multiWallet,a=n&&r&&s&&s!==r&&!i;try{a&&await Oe.disconnect({id:s,namespace:n})}catch(d){console.warn("Error disconnecting previous connector",d)}}async createUniversalProviderForAdapter(e){var n,r,s;await this.getUniversalProvider(),this.universalProvider&&await((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setUniversalProvider)==null?void 0:s.call(r,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>Oe.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||ye.deleteRecentWallet();const n=ye.getRecentWallet();Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:Le.isMobile()?"mobile":"qrcode",name:(n==null?void 0:n.name)||"Unknown",reconnect:!0,view:ut.state.view,walletRank:n==null?void 0:n.order}})}async syncNamespaceConnection(e){try{e===ne.CHAIN.EVM&&Le.isSafeApp()&&ke.setConnectorId(ne.CONNECTOR_ID.SAFE,e);const n=ke.getConnectorId(e);switch(this.setStatus("connecting",e),n){case ne.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case ne.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};M.resetAccount(n),M.resetNetwork(n),ye.removeConnectedNamespace(n);const s=Array.from(M.state.chains.keys());(n?[n]:s).forEach(o=>ye.addDisconnectedConnectorId(ke.getConnectorId(o)||"",o)),ke.removeConnectorId(n),Jt.resetChain(n),this.setUser(null,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(null,n),r!==!1&&Dt.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getAdapter(e),r=this.getCaipAddress(e),s=this.getCaipNetwork(e);return n==null?void 0:n.syncConnections({connectToFirstConnector:!r,caipNetwork:s})}))}async syncAdapterConnection(e){var a,l,d,u;const n=this.getAdapter(e),r=this.getCaipNetwork(e),s=ke.getConnectorId(e),o=ke.getConnectors(e).find(h=>h.id===s);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(r!=null&&r.id))throw new Error("CaipNetwork not found");const h=await(n==null?void 0:n.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:(d=(l=(a=r==null?void 0:r.rpcUrls)==null?void 0:a.default)==null?void 0:l.http)==null?void 0:d[0]}));h?(this.syncProvider({...h,chainNamespace:e}),await this.syncAccount({...h,chainNamespace:e}),this.setStatus("connected",e),Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:h.address,properties:{method:"browser",name:((u=o.info)==null?void 0:u.name)||o.name||"Unknown",reconnect:!0,view:ut.state.view,walletRank:void 0}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){var r,s;const e=Object.keys(((s=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:s.namespaces)||{}),n=this.chainNamespaces.map(async i=>{var u,h,f,p,m;const o=this.getAdapter(i);if(!o)return;const a=((p=(f=(h=(u=this.universalProvider)==null?void 0:u.session)==null?void 0:h.namespaces)==null?void 0:f[i])==null?void 0:p.accounts)||[],l=(m=M.state.activeCaipNetwork)==null?void 0:m.id,d=a.find(g=>{const{chainId:w}=Rr.parseCaipAddress(g);return w===(l==null?void 0:l.toString())})||a[0];if(d){const g=Rr.validateCaipAddress(d),{chainId:w,address:b}=Rr.parseCaipAddress(g);if(Jt.setProviderId(i,Wt.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&M.state.activeCaipNetwork&&o.namespace!==ne.CHAIN.EVM){const y=o.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:M.state.activeCaipNetwork});Jt.setProvider(i,y)}else Jt.setProvider(i,this.universalProvider);ke.setConnectorId(ne.CONNECTOR_ID.WALLET_CONNECT,i),ye.addConnectedNamespace(i),await this.syncAccount({address:b,chainId:w,chainNamespace:i})}else e.includes(i)&&this.setStatus("disconnected",i);this.syncConnectedWalletInfo(i),await M.setApprovedCaipNetworksData(i)});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){Jt.setProviderId(s,e),Jt.setProvider(s,n),ke.setConnectorId(r,s)}async syncAccount(e){var h,f;const n=e.chainNamespace===M.state.activeChain,r=M.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=ye.getActiveNetworkProps(),l=i||a,d=((h=M.state.activeCaipNetwork)==null?void 0:h.name)===ne.UNSUPPORTED_NETWORK_NAME,u=M.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(d&&!u)&&l){let p=this.getCaipNetworks().find(b=>b.id.toString()===l.toString()),m=this.getCaipNetworks().find(b=>b.chainNamespace===o);if(!u&&!p&&!m){const b=this.getApprovedCaipNetworkIds()||[],y=b.find(v=>{var E;return((E=Rr.parseCaipNetworkId(v))==null?void 0:E.chainId)===l.toString()}),x=b.find(v=>{var E;return((E=Rr.parseCaipNetworkId(v))==null?void 0:E.chainNamespace)===o});p=this.getCaipNetworks().find(v=>v.caipNetworkId===y),m=this.getCaipNetworks().find(v=>v.caipNetworkId===x||"deprecatedCaipNetworkId"in v&&v.deprecatedCaipNetworkId===x)}const g=p||m;(g==null?void 0:g.chainNamespace)===M.state.activeChain?fe.state.enableNetworkSwitch&&!fe.state.allowUnsupportedChain&&((f=M.state.activeCaipNetwork)==null?void 0:f.name)===ne.UNSUPPORTED_NETWORK_NAME?M.showUnsupportedChainUI():this.setCaipNetwork(g):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);const w=this.getAddress(o);nr.isLowerCaseMatch(s,w)||this.syncAccountInfo(s,g==null?void 0:g.id,o),n?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r==null?void 0:r.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){var s;const n=ke.getConnectorId(e),r=Jt.getProviderId(e);if(r===Wt.CONNECTOR_TYPE_ANNOUNCED||r===Wt.CONNECTOR_TYPE_INJECTED){if(n){const o=this.getConnectors().find(a=>{var h,f;const l=a.id===n,d=((h=a.info)==null?void 0:h.rdns)===n,u=(f=a.connectors)==null?void 0:f.some(p=>{var m;return p.id===n||((m=p.info)==null?void 0:m.rdns)===n});return l||d||!!u});if(o){const{info:a,name:l,imageUrl:d}=o,u=d||this.getConnectorImage(o);this.setConnectedWalletInfo({name:l,icon:u,...a},e)}}}else if(r===Wt.CONNECTOR_TYPE_WALLET_CONNECT){const i=Jt.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(n&&(n===ne.CONNECTOR_ID.COINBASE_SDK||n===ne.CONNECTOR_ID.COINBASE)){const i=this.getConnectors().find(d=>d.id===n),o=(i==null?void 0:i.name)||"Coinbase Wallet",a=(i==null?void 0:i.imageUrl)||this.getConnectorImage(i),l=i==null?void 0:i.info;this.setConnectedWalletInfo({...l,name:o,icon:a},e)}}async syncBalance(e){!W8.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>{var s;return r.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=M.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){var r,s,i,o,a,l,d,u,h,f;const e=ZEe.createLogger((p,...m)=>{p&&this.handleAlertError(p),console.error(...m)}),n={projectId:(r=this.options)==null?void 0:r.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(l=this.options)!=null&&l.metadata?(d=this.options)==null?void 0:d.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(h=this.options)==null?void 0:h.metadata.icons:[""]},logger:e};fe.setManualWCControl(!!((f=this.options)!=null&&f.manualWCControl)),this.universalProvider=this.options.universalProvider??await YEe.init(n),fe.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Ji.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{Oe.setUri(n)},onConnect:n=>{const{address:r}=Le.getAccount(n[0]);Oe.finalizeWcConnection(r)},onDisconnect:()=>{M.state.noAdapters&&this.resetAccount(e),Oe.resetWcConnection()},onChainChanged:n=>{const r=M.state.activeChain,s=r&&ke.state.activeConnectorIds[r]===ne.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(M.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}(o==null?void 0:o.id.toString())!==(i==null?void 0:i.id.toString())&&(o==null?void 0:o.chainNamespace)===(i==null?void 0:i.chainNamespace)&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=M.state.activeChain,s=r&&ke.state.activeConnectorIds[r]===ne.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(M.state.noAdapters||s)){const i=n==null?void 0:n[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&Le.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Lt.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const n=Object.entries(_s.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=_s.ALERT_ERRORS[o];a&&(Ts.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){var n;if(e)return(n=this.chainAdapters)==null?void 0:n[e]}createAdapter(e){var s,i;if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:(s=this.options)==null?void 0:s.projectId,networks:(i=this.caipNetworks)==null?void 0:i.filter(({chainNamespace:o})=>o===n)}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){await this.injectModalUi(),e!=null&&e.uri&&Oe.setUri(e.uri);const{isSwap:n,isSend:r}=this.toModalOptions();return n(e)?Dt.open({...e,data:{swap:e.arguments}}):r(e)&&e.arguments?this.openSend(e.arguments):Dt.open(e)}async close(){await this.injectModalUi(),Dt.close()}setLoading(e,n){Dt.setLoading(e,n)}async disconnect(e){await Oe.disconnect({namespace:e})}getSIWX(){return fe.state.siwx}getError(){return""}getChainId(){var e;return(e=M.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e,{throwOnFailure:n=!1}={}){const r=this.getCaipNetworks().find(s=>s.id===e.id);if(!r){Ts.open(_s.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await M.switchActiveNetwork(r,{throwOnFailure:n})}getWalletProvider(){return M.state.activeChain?Jt.state.providers[M.state.activeChain]:null}getWalletProviderType(){return Jt.getProviderId(M.state.activeChain)}subscribeProviders(e){return Jt.subscribeProviders(e)}getThemeMode(){return fi.state.themeMode}getThemeVariables(){return fi.state.themeVariables}setThemeMode(e){fi.setThemeMode(e),V_(fi.state.themeMode)}setTermsConditionsUrl(e){fe.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){fe.setPrivacyPolicyUrl(e)}setThemeVariables(e){fi.setThemeVariables(e),YAe(fi.state.themeVariables)}subscribeTheme(e){return fi.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?Oe.subscribe(e):(Ts.open(ne.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){var r,s;if(e)return(s=(r=M.state.chains.get(e))==null?void 0:r.accountState)==null?void 0:s.connectedWalletInfo;const n=M.getAccountData();return n==null?void 0:n.connectedWalletInfo}getAccount(e){const n=e||M.state.activeChain,r=ke.getAuthConnector(n),s=M.getAccountData(n),i=ye.getConnectedConnectorId(M.state.activeChain),o=Oe.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(l=>l.accounts.map(({address:d,type:u,publicKey:h})=>Le.createAccount(n,d,u||"eoa",h)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:Le.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===ne.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:ye.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:Ws(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?M.subscribeChainProp("accountState",r,n):M.subscribe(r),ke.subscribe(r)}subscribeNetwork(e){return M.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n==null?void 0:n.id,caipNetworkId:n==null?void 0:n.caipNetworkId})})}subscribeWalletInfo(e,n){return n?M.subscribeChainProp("accountState",r=>e(r==null?void 0:r.connectedWalletInfo),n):M.subscribeChainProp("accountState",r=>e(r==null?void 0:r.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){M.subscribeChainProp("accountState",n=>e(n==null?void 0:n.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){M.subscribeKey("activeCaipNetwork",e)}getState(){return pa.state}getRemoteFeatures(){return fe.state.remoteFeatures}subscribeState(e){return pa.subscribe(e)}subscribeRemoteFeatures(e){return fe.subscribeKey("remoteFeatures",e)}showErrorMessage(e){cc.showError(e)}showSuccessMessage(e){cc.showSuccess(e)}getEvent(){return{...Lt.state}}subscribeEvents(e){return Lt.subscribe(e)}replace(e){ut.replace(e)}redirect(e){ut.push(e)}popTransactionStack(e){ut.popTransactionStack(e)}isOpen(){return Dt.state.open}isTransactionStackEmpty(){return ut.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){fe.setFeatures(e)}updateRemoteFeatures(e){fe.setRemoteFeatures(e)}updateOptions(e){const r={...fe.state||{},...e};fe.setOptions(r)}setConnectMethodsOrder(e){fe.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){fe.setWalletFeaturesOrder(e)}setCollapseWallets(e){fe.setCollapseWallets(e)}setSocialsOrder(e){fe.setSocialsOrder(e)}getConnectMethodsOrder(){return F_.getConnectOrderMethod(fe.state.features,ke.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||M.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&M.removeNetwork(e,n)}}let f6=!1;class Hz extends rSe{async onAuthProviderConnected(e){const n=nr.userChainIdToChainNamespace(e==null?void 0:e.chainId);if(e.message&&e.signature&&e.siwxMessage&&await qi.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===ne.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=fe.state.defaultAccountTypes[n],i=Ws(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:a,siwxMessage:l,message:d,...u}=e,h=M.getAccountData(n);this.setUser({...(h==null?void 0:h.user)||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{Ki.checkIfRequestExists(n)?Ki.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(fr.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(fr.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=Ki.checkIfRequestIsSafe(r),i=this.getAddress(),o=M.state.activeCaipNetwork;s||(i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=M.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");ke.getConnectorId(n)===ne.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=M.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=fi.getSnapshot(),r=fe.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:Sw(n.themeVariables,n.themeMode)})])}async syncAuthConnector(e,n){var u,h,f,p,m,g,w,b,y;const r=ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===M.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername(),l=((u=M.getAccountData(n))==null?void 0:u.user)||{};this.setUser({...l,username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:d}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),n&&r&&s){const x=await e.getSmartAccountEnabledNetworks();if(M.setSmartAccountEnabledNetworks((x==null?void 0:x.smartAccountEnabledNetworks)||[],n),d&&((h=this.connectionControllerClient)!=null&&h.connectExternal)){await((m=this.connectionControllerClient)==null?void 0:m.connectExternal({id:ne.CONNECTOR_ID.AUTH,info:{name:ne.CONNECTOR_ID.AUTH},type:Wt.CONNECTOR_TYPE_AUTH,provider:e,chainId:(p=(f=M.getNetworkData(n))==null?void 0:f.caipNetwork)==null?void 0:p.id,chain:n})),this.setStatus("connected",n);const v=ye.getConnectedSocialProvider();v?Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:v,reconnect:!0}}):Lt.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:((y=(b=(w=(g=this.universalProvider)==null?void 0:g.session)==null?void 0:w.peer)==null?void 0:b.metadata)==null?void 0:y.name)||"Unknown",reconnect:!0,view:ut.state.view,walletRank:void 0}})}else ke.getConnectorId(n)===ne.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),ye.removeConnectedNamespace(n))}this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){var n;try{if(!Le.isTelegram())return;const r=ye.getTelegramSocialProvider();if(!r||!Le.isClient())return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;r&&M.setAccountProp("socialProvider",r,e),await((n=this.authProvider)==null?void 0:n.init());const o=ke.getAuthConnector();r&&o&&(this.setLoading(!0,e),await Oe.connectExternal({id:o.id,type:o.type,socialUri:i},o.chain),ye.setConnectedSocialProvider(r),ye.removeTelegramSocialProvider(),Lt.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:r}}))}catch(r){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",r)}try{const r=new URL(window.location.href);r.searchParams.delete("result_uri"),window.history.replaceState({},document.title,r.toString())}catch(r){console.error("tma social login failed",r)}}createAuthProvider(e){var d,u,h,f;if(!ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=(d=this.remoteFeatures)==null?void 0:d.email,s=Array.isArray((u=this.remoteFeatures)==null?void 0:u.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=nr.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&((h=this.options)!=null&&h.projectId)&&i&&(this.authProvider=Oy.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(f=this.getCaipNetwork(a))==null?void 0:f.caipNetworkId,abortController:_s.EmbeddedWalletAbortController,onTimeout:p=>{p==="iframe_load_failed"?Ts.open(_s.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):p==="iframe_request_timeout"?Ts.open(_s.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):p==="unverified_domain"&&Ts.open(_s.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:p=>oy(p),getCaipNetworks:p=>M.getCaipNetworks(p)}),pa.subscribeOpen(p=>{var m;!p&&this.isTransactionStackEmpty()&&((m=this.authProvider)==null||m.rejectRpcRequests())}));const l=e===M.state.activeChain&&fe.state.enableReconnect;fe.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&l&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var n,r,s;this.createAuthProvider(e),this.authProvider&&((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setAuthProvider)==null||s.call(r,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&dt.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var o,a,l;if(!e)return;const n=M.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&((o=M.getAccountData(r))!=null&&o.caipAddress)){const d=this.getAdapter(r),u=Jt.getProvider(r),h=Jt.getProviderId(r);await(d==null?void 0:d.switchNetwork({caipNetwork:e,provider:u,providerType:h})),this.setCaipNetwork(e)}else{const u=Jt.getProviderId(n)===Wt.CONNECTOR_TYPE_AUTH,h=Jt.getProviderId(r),f=h===Wt.CONNECTOR_TYPE_AUTH,p=ne.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((u&&h===void 0||f)&&p)try{if(M.state.activeChain=e.chainNamespace,s){const m=this.getAdapter(r);await(m==null?void 0:m.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:h}))}else await((l=(a=this.connectionControllerClient)==null?void 0:a.connectExternal)==null?void 0:l.call(a,{id:ne.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:Wt.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch{const g=this.getAdapter(r);await(g==null?void 0:g.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:h}))}else if(h===Wt.CONNECTOR_TYPE_WALLET_CONNECT){if(!M.state.noAdapters){const m=this.getAdapter(r),g=Jt.getProvider(r),w=Jt.getProviderId(r);await(m==null?void 0:m.switchNetwork({caipNetwork:e,provider:g,providerType:w}))}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){var n;await super.initialize(e),(n=this.chainNamespaces)==null||n.forEach(r=>{this.createAuthProviderForAdapter(r)}),await this.injectModalUi(),pa.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){var a;const s=`${r}:${n}`,i=(a=this.caipNetworks)==null?void 0:a.find(l=>l.caipNetworkId===s);if(i!=null&&i.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=ke.getConnectorId(r)===ne.CONNECTOR_ID.AUTH;try{const{name:l,avatar:d}=await this.fetchIdentity({address:e});!l&&o?await this.syncReownName(e,r):(this.setProfileName(l,r),this.setProfileImage(d,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=Jt.getProviderId(e);if(n===Wt.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=ye.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(Le.isClient()&&!f6)try{const e={...Vt.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),Le.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!fe.state.disableAppend&&!fe.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}f6=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!Le.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push($n(()=>import("./embedded-wallet-CfMbZ0AZ.js"),__vite__mapDeps([4,5,6,7,8,9,10,11,12,13,14,15,16]))),n.email&&r.push($n(()=>import("./email-CgVU0I2B.js"),__vite__mapDeps([17,5,18,15,9,14,7,8,13,19,11]))),n.socials&&r.push($n(()=>import("./socials-sd0HdVgU.js"),__vite__mapDeps([20,5,7,21,8,22,14,23,13,9,24,6,25]))),n.swaps&&n.swaps.length>0&&r.push($n(()=>import("./swaps-k-IslVI4.js"),__vite__mapDeps([26,5,13,9,14,7,27,28,29,25,30,6,11,8]))),e.send&&r.push($n(()=>import("./send-CTdyFvs8.js"),__vite__mapDeps([31,5,13,9,14,7,32,8,33,15,30,6,25,29,11,34,35]))),e.receive&&r.push($n(()=>import("./receive-C-R_bSaO.js"),__vite__mapDeps([36,5,7,6,24]))),n.onramp&&n.onramp.length>0&&r.push($n(()=>import("./onramp-D8B83kPY.js"),__vite__mapDeps([37,5,7,38,9,21,8,6,39,40,15,13,14,23,41,11]))),n.payWithExchange&&r.push($n(()=>import("./pay-with-exchange-UxwdD9kI.js"),__vite__mapDeps([42,5,7,6,12,38,9,25,13,33,8,15,41,14,11,34,32]))),n.activity&&r.push($n(()=>import("./transactions-pDRveUta.js"),__vite__mapDeps([43,5,44,14,7,15,6,25]))),(e.pay||n.payments)&&r.push($n(()=>import("./index-BJvp_40v.js"),__vite__mapDeps([45,5,7,13,9,46,12,6,38,47,32,48,14,23]))),n.emailCapture&&r.push($n(()=>import("./data-capture-C827PCWs.js"),__vite__mapDeps([49,5,18,15,9,50]))),await Promise.all([...r,$n(()=>import("./index-DVnqGUTL.js"),__vite__mapDeps([51,5,7,6,9,35,14,52,40,15,10,48,12,38,13,44,25,34,27,28,32,8,11,47,19,21,22,23,24,16,39])),$n(()=>import("./w3m-modal-CF38VRb8.js"),__vite__mapDeps([53,5,7,46,6,10,9,14,28,52,40,15,48,29]))])}}const sSe="1.8.7";function Vz(t){return new Hz({...t,sdkVersion:Le.generateSdkVersion(t.adapters??[],"html",sSe)})}const iSe=Object.freeze(Object.defineProperty({__proto__:null,AppKit:Hz,CoreHelperUtil:Le,DEFAULT_METHODS:Fz,WcConstantsUtil:uc,WcHelpersUtil:Ji,createAppKit:Vz},Symbol.toStringTag,{value:"Module"})),gp={signMessage:async(t,e,n)=>{if(!e)throw new Error("signMessage - provider is undefined");const r=Tn(t)?t:Be(mc(t));return await e.request({method:"personal_sign",params:[r,n]})},estimateGas:async(t,e,n,r)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!n)throw new Error("estimateGas - address is undefined");if(t.chainNamespace&&t.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const s={from:t.address,to:t.to,data:t.data,type:0},i=new Dr(e,r);return await new cm(i,n).estimateGas(s)},sendTransaction:async(t,e,n,r)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!n)throw new Error("sendTransaction - address is undefined");if(t.chainNamespace&&t.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const s={to:t.to,value:t.value,gasLimit:t.gas,gasPrice:t.gasPrice,data:t.data,type:0},i=new Dr(e,r),l=await(await new cm(i,n).sendTransaction(s)).wait();return(l==null?void 0:l.hash)||null},writeContract:async(t,e,n,r)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!n)throw new Error("writeContract - address is undefined");const s=new Dr(e,r),i=new cm(s,n),o=new rr(t.tokenAddress,t.abi,i);if(!o||!t.method)throw new Error("Contract method is undefined");const a=o[t.method];if(a)return await a(...t.args);throw new Error("Contract method is undefined")},parseWalletCapabilities:t=>{try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:im,formatUnits:ha};class Wz extends zz{constructor(){super({adapterType:ne.ADAPTER_TYPES.ETHERS,namespace:ne.CHAIN.EVM}),this.balancePromises={}}async createEthersConfig(e){if(!e.metadata)return;let n;function r(){if(n)return n;if(!(typeof window>"u")&&window.ethereum)return n=window.ethereum,n}async function s(){const{SafeProvider:a}=await $n(async()=>{const{SafeProvider:f}=await import("./SafeProvider-IQGJWtuE.js");return{SafeProvider:f}},__vite__mapDeps([54,55,1,2])),{default:l}=await $n(async()=>{const{default:f}=await import("./index-B5g2Fl0J.js").then(p=>p.e);return{default:f}},__vite__mapDeps([55,1,2])),d=new l,u=await d.safe.getInfo(),h=new a(u,d);return await h.connect().catch(f=>{console.info("Failed to auto-connect to Safe:",f)}),h}async function i(){var a,l,d;try{const{createCoinbaseWalletSDK:u}=await $n(async()=>{const{createCoinbaseWalletSDK:f}=await import("./index-CboEqQpE.js");return{createCoinbaseWalletSDK:f}},__vite__mapDeps([56,2,3]));return typeof window>"u"?void 0:u({appName:(a=e==null?void 0:e.metadata)==null?void 0:a.name,appLogoUrl:(l=e==null?void 0:e.metadata)==null?void 0:l.icons[0],appChainIds:((d=e.networks)==null?void 0:d.map(f=>f.id))||[1,84532],preference:{options:e.coinbasePreference??"all"}}).getProvider()}catch(u){console.error("Failed to import Coinbase Wallet SDK:",u);return}}const o={metadata:e.metadata};if(e.enableInjected!==!1&&(o.injected=r()),e.enableCoinbase!==!1){const a=await i();a&&(o.coinbase=a)}if(Le.isSafeApp()){const a=await s();a&&(o.safe=a)}return o.EIP6963=e.enableEIP6963!==!1,o}async signMessage(e){const{message:n,address:r,provider:s}=e;if(!s)throw new Error("Provider is undefined");try{return{signature:await gp.signMessage(n,s,r)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){var s,i;if(!e.provider)throw new Error("Provider is undefined");const n=(s=M.getAccountData(ne.CHAIN.EVM))==null?void 0:s.address;if(!n)throw new Error("Address is undefined");return{hash:await gp.sendTransaction({value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),to:e.to,data:e.data?e.data:"0x",gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,address:n},e.provider,n,Number((i=e.caipNetwork)==null?void 0:i.id))}}async writeContract(e){var s;if(!e.provider)throw new Error("Provider is undefined");const{address:n}=Rr.parseCaipAddress(e.caipAddress);return{hash:await gp.writeContract(e,e.provider,n,Number((s=e.caipNetwork)==null?void 0:s.id))}}async estimateGas(e){const{provider:n,caipNetwork:r,address:s}=e;if(!n)throw new Error("Provider is undefined");try{return{gas:await gp.estimateGas({data:e.data,to:e.to,address:s},n,s,Number(r==null?void 0:r.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}parseUnits(e){return gp.parseUnits(e.value,e.decimals)}formatUnits(e){return gp.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:n,chainId:r}=e,s=this.connectors.find(l=>l.id===n),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");const o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"});if(this.listenProviderEvents(n,i),!o[0])throw new Error("No accounts found");if(!(s!=null&&s.type))throw new Error("Connector type not found");return{address:this.toChecksummedAddress(o[0]),chainId:Number(a)||Number(r),provider:i,type:s.type,id:n}}async syncConnectors(e){var r;this.ethersConfig=await this.createEthersConfig(e),(r=this.ethersConfig)!=null&&r.EIP6963&&this.listenInjectedConnector(!0),Object.keys(this.ethersConfig||{}).filter(s=>s!=="metadata"&&s!=="EIP6963").forEach(s=>{var a,l;const i=s==="coinbase"?"coinbaseWalletSDK":s,o=s===ne.CONNECTOR_ID.INJECTED;this.namespace&&this.addConnector({id:i,explorerId:ic.ConnectorExplorerIds[i],imageUrl:(a=e==null?void 0:e.connectorImages)==null?void 0:a[i],name:ic.ConnectorNamesMap[i]||"Unknown",imageId:ic.ConnectorImageIds[i],type:ic.ConnectorTypesMap[i]??"EXTERNAL",info:o?void 0:{rdns:i},chain:this.namespace,chains:[],provider:(l=this.ethersConfig)==null?void 0:l[s]})})}async disconnectAll(){return{connections:await Promise.all(this.connections.map(async n=>{const r=this.connectors.find(s=>nr.isLowerCaseMatch(s.id,n.connectorId));if(!r)throw new Error("Connector not found");return await this.disconnect({id:r.id}),n}))}}async syncConnections({connectToFirstConnector:e}){var n;await((n=this.connectionManager)==null?void 0:n.syncConnections({connectors:this.connectors,caipNetworks:this.getCaipNetworks(),universalProvider:this.universalProvider,onConnection:this.addConnection.bind(this),onListenProvider:this.listenProviderEvents.bind(this)})),e&&this.emitFirstAvailableConnection()}async setUniversalProvider(e){this.universalProvider=e;const n=ne.CONNECTOR_ID.WALLET_CONNECT;return Ji.listenWcProvider({universalProvider:e,namespace:ne.CHAIN.EVM,onConnect:r=>this.onConnect(r,n),onDisconnect:()=>this.onDisconnect(n),onAccountsChanged:r=>this.onAccountsChanged(r,n,!1),onChainChanged:r=>this.onChainChanged(r,n)}),this.addConnector(new UR({provider:e,caipNetworks:this.getCaipNetworks(),namespace:ne.CHAIN.EVM})),Promise.resolve()}eip6963EventHandler(e){var n;if(e.detail){const{info:r,provider:s}=e.detail;if(!((n=this.connectors)==null?void 0:n.find(o=>o.name===(r==null?void 0:r.name)))){const o=ic.ConnectorTypesMap[ne.CONNECTOR_ID.EIP6963],a=(r==null?void 0:r.rdns)||(r==null?void 0:r.name)||(r==null?void 0:r.uuid);this.namespace&&a&&this.addConnector({id:a,type:o,imageUrl:r==null?void 0:r.icon,name:(r==null?void 0:r.name)||"Unknown",provider:s,info:r,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const n=this.eip6963EventHandler.bind(this);window.addEventListener(Wt.EIP6963_ANNOUNCE_EVENT,n),window.dispatchEvent(new Event(Wt.EIP6963_REQUEST_EVENT))}}async connect({id:e,address:n,type:r,chainId:s,socialUri:i}){var o;try{const a=this.connectors.find(f=>nr.isLowerCaseMatch(f.id,e));if(!a)throw new Error("Connector not found");const l=(o=this.connectionManager)==null?void 0:o.getConnection({address:n,connectorId:e,connections:this.connections,connectors:this.connectors});if(l){const f=l.caipNetwork;if(!f)throw new Error("EthersAdapter:connect - could not find the caipNetwork to connect");if(l.account)return this.emit("accountChanged",{address:this.toChecksummedAddress(l.account.address),chainId:f.id,connector:a}),{address:this.toChecksummedAddress(l.account.address),chainId:f.id,provider:a.provider,type:a.type,id:e}}const d=a==null?void 0:a.provider;if(!d)throw new Error("Provider not found");let u=[],h;if(r===Wt.CONNECTOR_TYPE_AUTH){const{address:f,accounts:p}=await qi.authConnectorAuthenticate({authConnector:d,chainNamespace:ne.CHAIN.EVM,chainId:s,socialUri:i,preferredAccountType:Ws("eip155")}),m=this.getCaipNetworks().find(g=>g.id.toString()===(s==null?void 0:s.toString()));u=[f],this.addConnection({connectorId:e,accounts:p?p.map(g=>({address:g.address})):u.map(g=>({address:g})),caipNetwork:m,auth:{name:ye.getConnectedSocialProvider(),username:ye.getConnectedSocialUsername()}}),this.emit("accountChanged",{address:this.toChecksummedAddress(u[0]),chainId:Number(s),connector:a})}else{u=await d.request({method:"eth_requestAccounts"}),h=await d.request({method:"eth_chainId"});const f=this.getCaipNetworks().find(p=>p.id.toString()===(s==null?void 0:s.toString()));if(h!==s){if(!f)throw new Error("EthersAdapter:connect - could not find the caipNetwork to switch");try{await this.switchNetwork({caipNetwork:f,provider:d,providerType:r})}catch{throw new Error("EthersAdapter:connect - Switch network failed")}}this.emit("accountChanged",{address:this.toChecksummedAddress(u[0]),chainId:Number(s),connector:a}),this.addConnection({connectorId:e,accounts:u.map(p=>({address:p})),caipNetwork:f}),a.id!==ne.CONNECTOR_ID.WALLET_CONNECT&&this.listenProviderEvents(e,d)}return{address:this.toChecksummedAddress(u[0]),chainId:Number(s),provider:d,type:r,id:e}}catch(a){throw pl.isUserRejectedRequestError(a)?new HI(a):a}}async reconnect(e){const{id:n,chainId:r}=e,s=this.connectors.find(i=>i.id===n);s&&s.type==="AUTH"&&r&&await qi.authConnectorAuthenticate({authConnector:s.provider,chainNamespace:ne.CHAIN.EVM,chainId:r,preferredAccountType:Ws("eip155")})}async getAccounts(e){var o;const n=this.connectors.find(a=>a.id===e.id),r=n==null?void 0:n.provider;if(!r||!n)throw new Error("Provider not found");const s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});if(s)return{accounts:s.accounts.map(({address:a})=>Le.createAccount(ne.CHAIN.EVM,a,"eoa"))};if(e.id===ne.CONNECTOR_ID.AUTH){const a=n.provider;if(!a.user)return{accounts:[]};const{accounts:l,address:d}=a.user;return Promise.resolve({accounts:(l||[{address:d,type:"eoa"}]).map(u=>Le.createAccount(ne.CHAIN.EVM,u.address,u.type))})}return{accounts:(await r.request({method:"eth_requestAccounts"})).map(a=>Le.createAccount(ne.CHAIN.EVM,a,"eoa"))}}async disconnect(e){var n,r;if(e.id){const s=this.connectors.find(o=>nr.isLowerCaseMatch(o.id,e.id));if(!s)throw new Error("Connector not found");const i=(n=this.connectionManager)==null?void 0:n.getConnection({connectorId:e.id,connections:this.connections,connectors:this.connectors});switch(s.type){case Wt.CONNECTOR_TYPE_WALLET_CONNECT:s.provider.session&&s.provider.disconnect();break;case Wt.CONNECTOR_TYPE_AUTH:await((r=s.provider)==null?void 0:r.disconnect());break;case Wt.CONNECTOR_TYPE_ANNOUNCED:case Wt.CONNECTOR_TYPE_EXTERNAL:await this.revokeProviderPermissions(s.provider);break;default:throw new Error("Unsupported provider type")}return s.id&&(this.removeProviderListeners(s.id),this.deleteConnection(s.id)),this.connections.length===0?this.emit("disconnect"):this.emitFirstAvailableConnection(),{connections:i?[i]:[]}}return this.disconnectAll()}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>{var i;return s.id.toString()===((i=e.chainId)==null?void 0:i.toString())});if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&r.chainNamespace===ne.CHAIN.EVM){const s=`${r.caipNetworkId}:${n}`,i=this.balancePromises[s];if(i)return i;const o=ye.getNativeBalanceCacheForCaipAddress(s);if(o)return{balance:o.balance,symbol:o.symbol};const a=new Eg(r.rpcUrls.default.http[0],{chainId:r.id,name:r.name});if(a)try{return this.balancePromises[s]=new Promise(async l=>{try{const d=await a.getBalance(n),u=gc(d);ye.updateNativeBalanceCache({caipAddress:s,balance:u,symbol:r.nativeCurrency.symbol,timestamp:Date.now()}),l({balance:u,symbol:r.nativeCurrency.symbol})}catch{l({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}async switchNetwork(e){var i,o;const{caipNetwork:n,provider:r,providerType:s}=e;if(s==="AUTH"){await super.switchNetwork(e);return}try{await r.request({method:"wallet_switchEthereumChain",params:[{chainId:Zh.numberToHexString(n.id)}]})}catch(a){if(a.code===uc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||a.code===uc.ERROR_INVALID_CHAIN_ID||a.code===uc.ERROR_CODE_DEFAULT||((o=(i=a==null?void 0:a.data)==null?void 0:i.originalError)==null?void 0:o.code)===uc.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await Zh.addEthereumChain(r,n);else if(s==="ANNOUNCED"||s==="EXTERNAL"||s==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){var e;return(e=this.connectors.find(n=>n.type==="WALLET_CONNECT"))==null?void 0:e.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(s=>s.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(n){console.info("Could not revoke permissions from wallet. Disconnecting...",n)}}async getCapabilities(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const n=Jt.getProvider(ne.CHAIN.EVM);if(!n)throw new Error("Provider is undefined");return await n.request({method:"wallet_getAssets",params:[e]})}toChecksummedAddress(e){try{return dn(e.toLowerCase())}catch{return e}}}const oSe=Object.freeze(Object.defineProperty({__proto__:null,EthersAdapter:Wz,EthersHelpersUtil:Zh},Symbol.toStringTag,{value:"Module"})),th=class th{constructor(){q(this,"appKit",null);q(this,"provider",null);q(this,"isInitialized",!1);q(this,"connectionCallbacks",[])}static getInstance(){return th.instance||(th.instance=new th),th.instance}async initialize(){if(!this.isInitialized)try{const e="ec7b7de733ccdb815ca5ef14d3136983",n=new Wz;this.appKit=Vz({adapters:[n],projectId:e,networks:[QAe],metadata:{name:"Zotrust P2P Trading",description:"Decentralized P2P Trading Platform with Voice Calls on BSC",url:typeof window<"u"?window.location.origin:"https://zotrust.app",icons:["https://zotrust.app/icon.png"]},features:{analytics:!0,email:!1,socials:[],emailShowWallets:!1}}),this.appKit.subscribeAccount(async r=>{if(console.log("WalletConnect Account Updated:",r),r.isConnected&&r.address){const s=this.appKit.getWalletProvider();if(s){if(this.provider=new Dr(s),this.appKit.getChainId()!==56){console.log(" WalletConnect: Switching to BSC Mainnet...");try{await this.appKit.switchNetwork({chainId:56})}catch(o){console.warn("Failed to auto-switch to BSC Mainnet:",o)}}this.notifyConnectionChange(!0)}}else this.provider=null,this.notifyConnectionChange(!1)}),this.isInitialized=!0,console.log(" WalletConnect initialized successfully")}catch(e){throw console.error(" Failed to initialize WalletConnect:",e),e}}async openModal(){this.isInitialized||await this.initialize(),this.appKit&&this.appKit.open()}async connect(){this.isInitialized||await this.initialize();try{const e=this.appKit.getAccount();if(e&&e.isConnected&&e.address){const n=this.appKit.getChainId()||56;return{address:e.address,chainId:n}}return await this.appKit.open(),new Promise((n,r)=>{let s=!1,i=null;try{i=this.appKit.subscribeAccount(u=>{if(!s&&u&&u.isConnected&&u.address){s=!0;const h=this.appKit.getChainId()||56;n({address:u.address,chainId:h})}})}catch(u){console.warn("Failed to set up account subscription:",u);const h=()=>{if(s)return;const f=this.appKit.getAccount();if(f&&f.isConnected&&f.address){s=!0;const p=this.appKit.getChainId()||56;n({address:f.address,chainId:p})}else setTimeout(h,1e3)};setTimeout(h,1e3)}const o=setTimeout(()=>{s||(s=!0,r(new Error("Connection cancelled or timed out. Please try again.")))},6e4),a=()=>{if(clearTimeout(o),i&&typeof i=="function")try{i()}catch(u){console.warn("Failed to cleanup subscription:",u)}},l=n;n=u=>{a(),l(u)};const d=r;r=u=>{a(),d(u)}})}catch(e){throw console.error("WalletConnect connection failed:",e),e}}async disconnect(){this.appKit&&await this.appKit.disconnect(),this.provider=null,this.notifyConnectionChange(!1),console.log(" WalletConnect disconnected")}async getAccountInfo(){const e=this.appKit.getAccount(),n=this.appKit.getChainId();if(!e||!e.address)throw new Error("No account connected");return{address:e.address,chainId:n||56}}getProvider(){return this.provider}async getSigner(){return this.provider?await this.provider.getSigner():null}isConnected(){var n;const e=(n=this.appKit)==null?void 0:n.getAccount();return e?e.isConnected:!1}async signMessage(e){if(!this.provider)throw new Error("Wallet not connected");return await(await this.provider.getSigner()).signMessage(e)}getChainId(){var e;return(e=this.appKit)==null?void 0:e.getChainId()}async switchNetwork(e){if(!this.appKit)throw new Error("WalletConnect not initialized");try{console.log(` WalletConnect: Switching to network ${e}`),await this.appKit.switchNetwork({chainId:e}),console.log(" WalletConnect: Network switched successfully")}catch(n){throw console.error(" WalletConnect: Network switch failed:",n),new Error(`Failed to switch WalletConnect network: ${n.message}`)}}onConnectionChange(e){return this.connectionCallbacks.push(e),()=>{const n=this.connectionCallbacks.indexOf(e);n>-1&&this.connectionCallbacks.splice(n,1)}}notifyConnectionChange(e){this.connectionCallbacks.forEach(n=>{try{n(e)}catch(r){console.error("Error in connection callback:",r)}})}static createTrustWalletDeepLink(e){return`trust://wc?uri=${encodeURIComponent(e)}`}static createTrustWalletUniversalLink(e){return`https://link.trustwallet.com/wc?uri=${encodeURIComponent(e)}`}getQRCodeURI(){return null}static isTrustWalletInstalled(){return typeof window<"u"&&/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static isMobile(){return typeof window<"u"&&/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}};q(th,"instance");let W_=th;const ai=W_.getInstance(),aSe=(t,e,n=30)=>{const r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3),document.cookie=`${t}=${e};expires=${r.toUTCString()};path=/;SameSite=Lax`},cSe=t=>{const e=t+"=",n=document.cookie.split(";");for(let r=0;r<n.length;r++){let s=n[r];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return s.substring(e.length,s.length)}return null},lSe=t=>{document.cookie=`${t}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`},_S=(t,e,n)=>{const r={address:t,walletType:e,chainId:n,timestamp:Date.now()};aSe("wallet_state",JSON.stringify(r),30)},dSe=()=>{const t=cSe("wallet_state");if(!t)return null;try{const e=JSON.parse(t),n=Date.now()-30*24*60*60*1e3;return e.timestamp&&e.timestamp<n?(q_(),null):e}catch(e){return console.error("Failed to parse wallet state from cookie:",e),q_(),null}},q_=()=>{lSe("wallet_state")},kS=()=>{var s,i,o,a;const t=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),e=!!window.ethereum,n=e&&((s=window.ethereum)==null?void 0:s.isMetaMask),r=e&&(((i=window.ethereum)==null?void 0:i.isTrust)||((o=window.ethereum)==null?void 0:o.isTrustWallet)||((a=window.ethereum)==null?void 0:a.isTrustWallet)||navigator.userAgent.includes("TrustWallet")||navigator.userAgent.includes("Trust Wallet"));return{isMobile:t,hasEthereum:e,isMetaMask:n,isTrustWallet:r,userAgent:navigator.userAgent}},Xt=CI((t,e)=>({address:null,isConnected:!1,chainId:null,balance:{bnb:"0",usdt:"0",wbnb:"0",usdc:"0"},isConnecting:!1,isUpdatingBalances:!1,connectionError:null,walletType:null,connect:async n=>{const{isConnecting:r}=e();if(r){console.log(" Connection already in progress, skipping...");return}n||(n=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"walletconnect":"metamask"),console.log(" Connecting wallet type:",n);try{t({isConnecting:!0,connectionError:null,walletType:n}),n==="metamask"?await e().connectMetaMask():n==="trustwallet"?await e().connectTrustWallet():await e().connectWalletConnect()}catch(s){console.error("Failed to connect wallet:",s);let i="Wallet connection failed";if(s.code===4001)i="Connection cancelled by user";else if(s.code===-32002){i="Connection request already pending. Please wait and try again.",console.log(" Connection already pending, will retry automatically..."),t({connectionError:null,walletType:null});return}else s.message&&(i=s.message);t({connectionError:i,walletType:null}),D.error(i)}finally{t({isConnecting:!1})}},connectMetaMask:async()=>{var a,l,d;console.log(" Connecting MetaMask...");const n=kS();if(console.log(" Wallet detection:",n),!n.hasEthereum){let u=" MetaMask install   TrustWallet dApp browser   ";n.isMobile&&(u="Mobile  MetaMask app install   Trust Wallet dApp browser   ",console.log(" Mobile detected, suggesting mobile solutions")),t({connectionError:u}),D.error(u);return}n.isMetaMask||(console.log(" Detected wallet is not MetaMask, but proceeding..."),console.log(" Ethereum provider info:",{isMetaMask:(a=window.ethereum)==null?void 0:a.isMetaMask,isTrust:(l=window.ethereum)==null?void 0:l.isTrust,isCoinbaseWallet:(d=window.ethereum)==null?void 0:d.isCoinbaseWallet}));const r=await window.ethereum.request({method:"eth_requestAccounts"});if(!r||r.length===0){const u=" account  ";t({connectionError:u}),D.error(u);return}const s=r[0],i=await window.ethereum.request({method:"eth_chainId"}),o=parseInt(i,16);if(t({address:s,isConnected:!0,chainId:o,walletType:"metamask"}),_S(s,"metamask",o),sessionStorage.setItem("walletType","metamask"),o!==56){console.log(" Switching to BSC Mainnet..."),D.loading("Switching to BSC Mainnet...",{id:"network-switch"});try{await e().switchToNetwork(56),await new Promise(f=>setTimeout(f,1e3));const u=await window.ethereum.request({method:"eth_chainId"});if(parseInt(u,16)===56)t({chainId:56}),D.success("Switched to BSC Mainnet!",{id:"network-switch"});else throw new Error("Failed to switch to BSC Mainnet")}catch(u){console.error("Network switch failed:",u);const h="Please manually switch to BSC Mainnet in MetaMask";t({connectionError:h}),D.error(h,{id:"network-switch"});return}}await e().authenticateUser(s),await e().updateBalances()},connectTrustWallet:async()=>{var a,l,d,u;console.log(" Connecting Trust Wallet...");const n=kS();if(console.log(" Trust Wallet detection:",n),n.isMobile&&!n.hasEthereum){console.log(" Mobile detected, attempting to open Trust Wallet app...");const h=`trust://open_url?url=${encodeURIComponent(window.location.href)}`;try{window.location.href=h,D.loading("Opening Trust Wallet app...",{duration:3e3}),setTimeout(()=>{D.error("Trust Wallet app not found. Please install Trust Wallet from the app store.")},2e3);return}catch{console.log("Trust Wallet deep link failed, falling back to regular connection")}}if(!n.hasEthereum){let h=" Trust Wallet install   MetaMask dApp browser   ";n.isMobile&&(h="Mobile  Trust Wallet app install   MetaMask dApp browser   ",console.log(" Mobile detected, suggesting mobile solutions")),t({connectionError:h}),D.error(h);return}n.isTrustWallet||(console.log(" Detected wallet is not Trust Wallet, but proceeding..."),console.log(" Ethereum provider info:",{isMetaMask:(a=window.ethereum)==null?void 0:a.isMetaMask,isTrust:(l=window.ethereum)==null?void 0:l.isTrust,isTrustWallet:(d=window.ethereum)==null?void 0:d.isTrustWallet,isCoinbaseWallet:(u=window.ethereum)==null?void 0:u.isCoinbaseWallet,userAgent:navigator.userAgent}));const r=await window.ethereum.request({method:"eth_requestAccounts"});if(!r||r.length===0){const h=" account  ";t({connectionError:h}),D.error(h);return}const s=r[0],i=await window.ethereum.request({method:"eth_chainId"}),o=parseInt(i,16);if(t({address:s,isConnected:!0,chainId:o,walletType:"trustwallet"}),_S(s,"trustwallet",o),sessionStorage.setItem("walletType","trustwallet"),o!==56){console.log(" Switching to BSC Mainnet..."),D.loading("Switching to BSC Mainnet...",{id:"network-switch"});try{await e().switchToNetwork(56),await new Promise(p=>setTimeout(p,1e3));const h=await window.ethereum.request({method:"eth_chainId"});if(parseInt(h,16)===56)t({chainId:56}),D.success("Switched to BSC Mainnet!",{id:"network-switch"});else throw new Error("Failed to switch to BSC Mainnet")}catch(h){console.error("Network switch failed:",h);const f="Please manually switch to BSC Mainnet in Trust Wallet";t({connectionError:f}),D.error(f,{id:"network-switch"});return}}await e().authenticateUser(s),await e().updateBalances()},authenticateUser:async n=>{var o,a,l;const{loginWithWallet:r,fetchUserProfile:s}=ss.getState(),i=`Welcome to Zotrust! Please sign this message to authenticate.

Timestamp: ${Date.now()}`;try{let d;const{walletType:u}=e();u==="metamask"?d=await window.ethereum.request({method:"personal_sign",params:[i,n]}):d=await ai.signMessage(i),await r(n,d,i),await s(n),D.success(`Wallet connected and logged in! ${n.slice(0,6)}...${n.slice(-4)}`)}catch(d){if((d==null?void 0:d.code)==="ACTION_REJECTED"||(d==null?void 0:d.code)===4001||((o=d==null?void 0:d.message)==null?void 0:o.includes("User rejected"))||((a=d==null?void 0:d.message)==null?void 0:a.includes("user rejected"))||((l=d==null?void 0:d.message)==null?void 0:l.includes("user-denied"))||(d==null?void 0:d.reason)==="rejected"){console.log(" User skipped signature - wallet connected but not authenticated");try{await s(n),D.success(`Wallet connected! ${n.slice(0,6)}...${n.slice(-4)}`,{duration:3e3,icon:""})}catch{D("Wallet connected! Sign in later to access all features.",{duration:4e3,icon:""})}}else{console.error("Signature failed:",d);try{await s(n),D.success(`Wallet connected! ${n.slice(0,6)}...${n.slice(-4)}`)}catch{D.error("Failed to authenticate. Wallet connected but some features may be limited.",{duration:4e3})}}}},connectWalletConnect:async()=>{console.log(" Connecting WalletConnect...");try{await ai.initialize();const{address:n,chainId:r}=await ai.connect();if(t({address:n,isConnected:!0,chainId:r,walletType:"walletconnect"}),_S(n,"walletconnect",r),sessionStorage.setItem("walletType","walletconnect"),r!==56){console.log(" WalletConnect: Not on BSC Mainnet, attempting to switch..."),D.loading("Switching to BSC Mainnet...",{id:"walletconnect-switch"});try{await ai.switchNetwork(56),await new Promise(i=>setTimeout(i,2e3)),ai.getChainId()===56?(t({chainId:56}),D.success("Switched to BSC Mainnet!",{id:"walletconnect-switch"})):(console.log("Network switch attempted, continuing with connection..."),D.success("Network switch requested!",{id:"walletconnect-switch"}))}catch(s){console.error("WalletConnect network switch failed:",s);const i="Please manually switch to BSC Mainnet in your wallet";t({connectionError:i}),D.error(i,{id:"walletconnect-switch"});return}}await e().authenticateUser(n),console.log(" WalletConnect: Waiting for provider to be ready..."),await new Promise(s=>setTimeout(s,1e3));try{await e().updateBalances(),console.log(" WalletConnect: Balances fetched successfully")}catch(s){console.error(" WalletConnect: Balance fetch failed, retrying...",s),await new Promise(i=>setTimeout(i,2e3)),await e().updateBalances()}}catch(n){if(console.error("WalletConnect connection failed:",n),n.message.includes("Project ID required")){if(D.error("WalletConnect setup incomplete. Using MetaMask instead."),window.ethereum){await e().connectMetaMask();return}}else{if(n.message.includes("timeout")||n.message.includes("cancelled"))throw new Error("Connection was cancelled or timed out. Please try connecting again.");if(n.message.includes("User rejected"))throw new Error("Connection was rejected. Please approve the connection in your wallet.");if(n.message.includes("No accounts"))throw new Error("No wallet accounts found. Please make sure your wallet is unlocked.")}throw n}},disconnect:async()=>{const{address:n,walletType:r}=e();if(r==="walletconnect")try{await ai.disconnect()}catch(s){console.error("Failed to disconnect WalletConnect:",s)}if(t({address:null,isConnected:!1,chainId:null,balance:{bnb:"0",usdt:"0",wbnb:"0",usdc:"0"},connectionError:null,walletType:null}),sessionStorage.removeItem("walletType"),q_(),n)try{const{fetchUserProfile:s}=ss.getState();await s(n),D.success("Wallet disconnected, but you remain logged in")}catch(s){console.error("Failed to fetch user after disconnect:",s);const{setUser:i}=ss.getState();i(null),localStorage.removeItem("authToken"),D.success("Wallet disconnected and logged out")}else{const{setUser:s}=ss.getState();s(null),localStorage.removeItem("authToken"),D.success("Wallet disconnected and logged out")}},switchToNetwork:async n=>{try{if(!window.ethereum)throw new Error("No wallet detected");const r=`0x${n.toString(16)}`;console.log(` Switching to network: ${n} (${r})`);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]}),console.log(" Network switched successfully")}catch(o){if(console.log(" Network switch failed, trying to add network...",o),o.code===4902){const a=H8[n];if(a)console.log(" Adding BSC Mainnet to wallet..."),await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:a.name,rpcUrls:[a.rpcUrl],blockExplorerUrls:[a.blockExplorerUrl],nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18}}]}),console.log(" BSC Mainnet added to wallet");else throw new Error(`Network configuration not found for chain ID: ${n}`)}else throw new Error(`Failed to switch network: ${o.message}`)}const s=await window.ethereum.request({method:"eth_chainId"}),i=parseInt(s,16);if(i!==n)throw new Error(`Network switch verification failed. Expected: ${n}, Got: ${i}`);console.log(" Network switch verified successfully")}catch(r){throw console.error(" Network switch failed:",r),r}},updateBalances:async(n=!1)=>{var l,d;const{address:r,isConnected:s,chainId:i,walletType:o,isUpdatingBalances:a}=e();if(a){console.log(" Balance update already in progress, skipping duplicate call");return}if(!(!r||!s||!i)){if(t({isUpdatingBalances:!0}),i===56){console.log(" BSC Mainnet: Checking BNB balance");try{let u;if(o==="metamask"||o==="trustwallet"){if(!window.ethereum)throw new Error(`${o==="metamask"?"MetaMask":"Trust Wallet"} provider not available`);u=new Dr(window.ethereum),console.log(` Using ${o==="metamask"?"MetaMask":"Trust Wallet"} provider for balance fetch`)}else{let v=ai.getProvider();if(v||(console.log(" WalletConnect: Initializing service for balance fetch..."),await ai.initialize(),v=ai.getProvider()),v)u=v;else{console.error(" WalletConnect provider not available, retrying..."),await new Promise(R=>setTimeout(R,1e3));const E=ai.getProvider();if(!E)throw new Error("WalletConnect provider not available");u=E}}let h="0.00";try{console.log(" Fetching BNB balance for:",r);const v=await u.getBalance(r);h=parseFloat(gc(v)).toFixed(6),console.log(" BNB Formatted Balance:",h)}catch(v){console.error(" Failed to fetch BNB balance:",v),h="0.000000"}const f=["function balanceOf(address) view returns (uint256)","function decimals() view returns (uint8)"];let p="0.00";const m="0x55d398326f99059fF775485246999027B3197955";let g=0;const w=2;let b=!1;for(;g<w;)try{console.log(` Fetching USDT balance for: ${r} (attempt ${g+1})`);let v=u;if(b||g>0){console.log(" Using read-only RPC provider for USDT balance...");const{BSC_MAINNET_RPC:C}=await $n(async()=>{const{BSC_MAINNET_RPC:N}=await Promise.resolve().then(()=>TO);return{BSC_MAINNET_RPC:N}},void 0);v=new Eg(C)}const E=new rr(m,f,v),R=await Promise.race([E.balanceOf(r),new Promise((C,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]),S=await Promise.race([E.decimals(),new Promise((C,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]);p=parseFloat(ha(R,S)).toFixed(6),console.log(" USDT Formatted Balance:",p);break}catch(v){g++,console.error(` Failed to fetch USDT balance (attempt ${g}):`,v),(v.code==="CALL_EXCEPTION"||(l=v.message)!=null&&l.includes("missing revert data"))&&(b=!0,console.log(" CALL_EXCEPTION detected, will use read-only provider on retry")),g<w?await new Promise(E=>setTimeout(E,2e3*g)):(console.warn(" All USDT balance fetch attempts failed, using fallback"),p="0.000000")}let y="0.00";const x="0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d";for(g=0,b=!1;g<w;)try{console.log(` Fetching USDC balance for: ${r} (attempt ${g+1})`);let v=u;if(b||g>0){console.log(" Using read-only RPC provider for USDC balance...");const{BSC_MAINNET_RPC:C}=await $n(async()=>{const{BSC_MAINNET_RPC:N}=await Promise.resolve().then(()=>TO);return{BSC_MAINNET_RPC:N}},void 0);v=new Eg(C)}const E=new rr(x,f,v),R=await Promise.race([E.balanceOf(r),new Promise((C,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]),S=await Promise.race([E.decimals(),new Promise((C,N)=>setTimeout(()=>N(new Error("Timeout")),15e3))]);y=parseFloat(ha(R,S)).toFixed(6),console.log(" USDC Formatted Balance:",y);break}catch(v){g++,console.error(` Failed to fetch USDC balance (attempt ${g}):`,v),(v.code==="CALL_EXCEPTION"||(d=v.message)!=null&&d.includes("missing revert data"))&&(b=!0,console.log(" CALL_EXCEPTION detected, will use read-only provider on retry")),g<w?await new Promise(E=>setTimeout(E,2e3*g)):(console.warn(" All USDC balance fetch attempts failed, using fallback"),y="0.000000")}t({balance:{bnb:h,usdt:p,wbnb:y,usdc:"0.000000"}}),console.log(" BNB balance updated:",h),console.log(" USDT balance updated:",p),console.log(" USDC balance updated:",y),n&&(parseFloat(h)>0||parseFloat(p)>0||parseFloat(y)>0)&&D.success(`Balances: BNB ${parseFloat(h).toFixed(4)}, USDT ${parseFloat(p).toFixed(2)}, USDC ${parseFloat(y).toFixed(2)}`,{duration:3e3,icon:""})}catch(u){console.error("Failed to fetch token balances:",u),t({balance:{bnb:"0.00",usdt:"0.00",wbnb:"0.00",usdc:"0.00"}})}finally{t({isUpdatingBalances:!1})}return}console.log(" Non-BSC Mainnet network: showing native balance only");try{let u;if(o==="metamask"||o==="trustwallet"){if(!window.ethereum)throw new Error(`${o==="metamask"?"MetaMask":"Trust Wallet"} provider not available`);u=new Dr(window.ethereum)}else{const p=ai.getProvider();if(!p)throw new Error("WalletConnect provider not available");u=p}const h=await u.getBalance(r),f=gc(h);t({balance:{bnb:f,usdt:"0.00",wbnb:"0.00",usdc:"0.00"}}),console.log("Native balance updated:",f)}catch(u){console.error("Failed to fetch native balance:",u),t({balance:{bnb:"0.00",usdt:"0.00",wbnb:"0.00",usdc:"0.00"}})}}},clearError:()=>{t({connectionError:null})},debugWalletDetection:()=>{const r={...kS(),ethereum:!!window.ethereum,ethereumProviders:window.ethereum?Object.keys(window.ethereum):[],ethereumMethods:window.ethereum?Object.getOwnPropertyNames(window.ethereum):[],location:window.location.href,referrer:document.referrer};return console.log(" Wallet Debug Info:",r),r},restoreWalletState:async()=>{try{const n=dSe();if(!n)return;console.log(" Restoring wallet state from cookies:",n);let r=n.walletType;const s=sessionStorage.getItem("walletType");if(s&&["metamask","trustwallet","walletconnect"].includes(s)&&(r=s,console.log(" Restored walletType from sessionStorage:",r)),t({address:n.address,isConnected:!0,chainId:n.chainId,walletType:r}),r==="metamask"){if(window.ethereum)try{const i=await window.ethereum.request({method:"eth_accounts"});if(i.length>0&&i[0].toLowerCase()===n.address.toLowerCase()){console.log(" MetaMask wallet restored successfully"),await e().updateBalances(),await e().authenticateUser(n.address);return}}catch{console.log(" MetaMask wallet not available, clearing state"),e().disconnect()}}else if(r==="walletconnect")try{if(await ai.initialize(),ai.isConnected()){console.log(" WalletConnect wallet restored successfully"),await e().updateBalances(),await e().authenticateUser(n.address);return}}catch{console.log(" WalletConnect session not available, clearing state"),e().disconnect()}console.log(" Wallet not available, clearing saved state"),e().disconnect()}catch(n){console.error(" Failed to restore wallet state:",n),e().disconnect()}}}));typeof window<"u"&&(window.__zotrustAutoConnectTriggered||(window.__zotrustAutoConnectTriggered=!0,setTimeout(()=>{Xt.getState().restoreWalletState()},1e3)),window.ethereum&&(window.ethereum.on("accountsChanged",async t=>{if(console.log(" Account changed:",t),t.length===0)Xt.getState().disconnect();else{const{isConnecting:e}=Xt.getState();e||await Xt.getState().connect()}}),window.ethereum.on("chainChanged",async t=>{console.log(" Chain changed:",t);const e=parseInt(t,16);if(Xt.setState({chainId:e}),e!==56){console.log(" Wrong network detected, requesting switch to BSC Mainnet"),D.error("Please switch to BSC Mainnet for proper functionality");try{await Xt.getState().switchToNetwork(56),D.success("Switched to BSC Mainnet!")}catch(n){console.error("Failed to auto-switch network:",n)}}else console.log(" Connected to BSC Mainnet"),D.success("Connected to BSC Mainnet!");setTimeout(()=>{Xt.getState().updateBalances()},1e3)})));const LR=A.createContext({});function BR(t){const e=A.useRef(null);return e.current===null&&(e.current=t()),e.current}const $R=typeof window<"u",qz=$R?A.useLayoutEffect:A.useEffect,xN=A.createContext(null);function FR(t,e){t.indexOf(e)===-1&&t.push(e)}function zR(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const jl=(t,e,n)=>n>e?e:n<t?t:n;let HR=()=>{};const Pl={},Kz=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function Gz(t){return typeof t=="object"&&t!==null}const Yz=t=>/^0[^.\s]+$/u.test(t);function VR(t){let e;return()=>(e===void 0&&(e=t()),e)}const Po=t=>t,uSe=(t,e)=>n=>e(t(n)),hb=(...t)=>t.reduce(uSe),xx=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r};class WR{constructor(){this.subscriptions=[]}add(e){return FR(this.subscriptions,e),()=>zR(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const vc=t=>t*1e3,Ec=t=>t/1e3;function Qz(t,e){return e?t*(1e3/e):0}const Jz=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,hSe=1e-7,fSe=12;function pSe(t,e,n,r,s){let i,o,a=0;do o=e+(n-e)/2,i=Jz(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>hSe&&++a<fSe);return o}function fb(t,e,n,r){if(t===e&&n===r)return Po;const s=i=>pSe(i,0,1,t,n);return i=>i===0||i===1?i:Jz(s(i),e,r)}const Zz=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,Xz=t=>e=>1-t(1-e),eH=fb(.33,1.53,.69,.99),qR=Xz(eH),tH=Zz(qR),nH=t=>(t*=2)<1?.5*qR(t):.5*(2-Math.pow(2,-10*(t-1))),KR=t=>1-Math.sin(Math.acos(t)),rH=Xz(KR),sH=Zz(KR),mSe=fb(.42,0,1,1),gSe=fb(0,0,.58,1),iH=fb(.42,0,.58,1),ySe=t=>Array.isArray(t)&&typeof t[0]!="number",oH=t=>Array.isArray(t)&&typeof t[0]=="number",wSe={linear:Po,easeIn:mSe,easeInOut:iH,easeOut:gSe,circIn:KR,circInOut:sH,circOut:rH,backIn:qR,backInOut:tH,backOut:eH,anticipate:nH},xSe=t=>typeof t=="string",p6=t=>{if(oH(t)){HR(t.length===4);const[e,n,r,s]=t;return fb(e,n,r,s)}else if(xSe(t))return wSe[t];return t},Sv=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function bSe(t,e){let n=new Set,r=new Set,s=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(u){o.has(u)&&(d.schedule(u),t()),u(a)}const d={schedule:(u,h=!1,f=!1)=>{const m=f&&s?n:r;return h&&o.add(u),m.has(u)||m.add(u),u},cancel:u=>{r.delete(u),o.delete(u)},process:u=>{if(a=u,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(l),n.clear(),s=!1,i&&(i=!1,d.process(u))}};return d}const vSe=40;function aH(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Sv.reduce((x,v)=>(x[v]=bSe(i),x),{}),{setup:a,read:l,resolveKeyframes:d,preUpdate:u,update:h,preRender:f,render:p,postRender:m}=o,g=()=>{const x=Pl.useManualTiming?s.timestamp:performance.now();n=!1,Pl.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(x-s.timestamp,vSe),1)),s.timestamp=x,s.isProcessing=!0,a.process(s),l.process(s),d.process(s),u.process(s),h.process(s),f.process(s),p.process(s),m.process(s),s.isProcessing=!1,n&&e&&(r=!1,t(g))},w=()=>{n=!0,r=!0,s.isProcessing||t(g)};return{schedule:Sv.reduce((x,v)=>{const E=o[v];return x[v]=(R,S=!1,C=!1)=>(n||w(),E.schedule(R,S,C)),x},{}),cancel:x=>{for(let v=0;v<Sv.length;v++)o[Sv[v]].cancel(x)},state:s,steps:o}}const{schedule:Vn,cancel:uu,state:ts,steps:IS}=aH(typeof requestAnimationFrame<"u"?requestAnimationFrame:Po,!0);let b1;function ESe(){b1=void 0}const Ci={now:()=>(b1===void 0&&Ci.set(ts.isProcessing||Pl.useManualTiming?ts.timestamp:performance.now()),b1),set:t=>{b1=t,queueMicrotask(ESe)}},cH=t=>e=>typeof e=="string"&&e.startsWith(t),GR=cH("--"),CSe=cH("var(--"),YR=t=>CSe(t)?NSe.test(t.split("/*")[0].trim()):!1,NSe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,s0={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},bx={...s0,transform:t=>jl(0,1,t)},Tv={...s0,default:1},Uy=t=>Math.round(t*1e5)/1e5,QR=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ASe(t){return t==null}const SSe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,JR=(t,e)=>n=>!!(typeof n=="string"&&SSe.test(n)&&n.startsWith(t)||e&&!ASe(n)&&Object.prototype.hasOwnProperty.call(n,e)),lH=(t,e,n)=>r=>{if(typeof r!="string")return r;const[s,i,o,a]=r.match(QR);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},TSe=t=>jl(0,255,t),RS={...s0,transform:t=>Math.round(TSe(t))},bh={test:JR("rgb","red"),parse:lH("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+RS.transform(t)+", "+RS.transform(e)+", "+RS.transform(n)+", "+Uy(bx.transform(r))+")"};function _Se(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const K_={test:JR("#"),parse:_Se,transform:bh.transform},pb=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),sd=pb("deg"),Cc=pb("%"),bt=pb("px"),kSe=pb("vh"),ISe=pb("vw"),m6={...Cc,parse:t=>Cc.parse(t)/100,transform:t=>Cc.transform(t*100)},zp={test:JR("hsl","hue"),parse:lH("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+Cc.transform(Uy(e))+", "+Cc.transform(Uy(n))+", "+Uy(bx.transform(r))+")"},yr={test:t=>bh.test(t)||K_.test(t)||zp.test(t),parse:t=>bh.test(t)?bh.parse(t):zp.test(t)?zp.parse(t):K_.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?bh.transform(t):zp.transform(t),getAnimatableNone:t=>{const e=yr.parse(t);return e.alpha=0,yr.transform(e)}},RSe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function jSe(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(QR))==null?void 0:e.length)||0)+(((n=t.match(RSe))==null?void 0:n.length)||0)>0}const dH="number",uH="color",PSe="var",OSe="var(",g6="${}",DSe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function vx(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const a=e.replace(DSe,l=>(yr.test(l)?(r.color.push(i),s.push(uH),n.push(yr.parse(l))):l.startsWith(OSe)?(r.var.push(i),s.push(PSe),n.push(l)):(r.number.push(i),s.push(dH),n.push(parseFloat(l))),++i,g6)).split(g6);return{values:n,split:a,indexes:r,types:s}}function hH(t){return vx(t).values}function fH(t){const{split:e,types:n}=vx(t),r=e.length;return s=>{let i="";for(let o=0;o<r;o++)if(i+=e[o],s[o]!==void 0){const a=n[o];a===dH?i+=Uy(s[o]):a===uH?i+=yr.transform(s[o]):i+=s[o]}return i}}const MSe=t=>typeof t=="number"?0:yr.test(t)?yr.getAnimatableNone(t):t;function USe(t){const e=hH(t);return fH(t)(e.map(MSe))}const hu={test:jSe,parse:hH,createTransformer:fH,getAnimatableNone:USe};function jS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function LSe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;s=jS(l,a,t+1/3),i=jS(l,a,t),o=jS(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}function KE(t,e){return n=>n>0?e:t}const Gn=(t,e,n)=>t+(e-t)*n,PS=(t,e,n)=>{const r=t*t,s=n*(e*e-r)+r;return s<0?0:Math.sqrt(s)},BSe=[K_,bh,zp],$Se=t=>BSe.find(e=>e.test(t));function y6(t){const e=$Se(t);if(!e)return!1;let n=e.parse(t);return e===zp&&(n=LSe(n)),n}const w6=(t,e)=>{const n=y6(t),r=y6(e);if(!n||!r)return KE(t,e);const s={...n};return i=>(s.red=PS(n.red,r.red,i),s.green=PS(n.green,r.green,i),s.blue=PS(n.blue,r.blue,i),s.alpha=Gn(n.alpha,r.alpha,i),bh.transform(s))},G_=new Set(["none","hidden"]);function FSe(t,e){return G_.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function zSe(t,e){return n=>Gn(t,e,n)}function ZR(t){return typeof t=="number"?zSe:typeof t=="string"?YR(t)?KE:yr.test(t)?w6:WSe:Array.isArray(t)?pH:typeof t=="object"?yr.test(t)?w6:HSe:KE}function pH(t,e){const n=[...t],r=n.length,s=t.map((i,o)=>ZR(i)(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}}function HSe(t,e){const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=ZR(t[s])(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function VSe(t,e){const n=[],r={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],o=t.indexes[i][r[i]],a=t.values[o]??0;n[s]=a,r[i]++}return n}const WSe=(t,e)=>{const n=hu.createTransformer(e),r=vx(t),s=vx(e);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?G_.has(t)&&!s.values.length||G_.has(e)&&!r.values.length?FSe(t,e):hb(pH(VSe(r,s),s.values),n):KE(t,e)};function mH(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Gn(t,e,n):ZR(t)(t,e)}const qSe=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>Vn.update(e,n),stop:()=>uu(e),now:()=>ts.isProcessing?ts.timestamp:Ci.now()}},gH=(t,e,n=10)=>{let r="";const s=Math.max(Math.round(e/n),2);for(let i=0;i<s;i++)r+=Math.round(t(i/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},GE=2e4;function XR(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<GE;)e+=n,r=t.next(e);return e>=GE?1/0:e}function KSe(t,e=100,n){const r=n({...t,keyframes:[0,e]}),s=Math.min(XR(r),GE);return{type:"keyframes",ease:i=>r.next(s*i).value/e,duration:Ec(s)}}const GSe=5;function yH(t,e,n){const r=Math.max(e-GSe,0);return Qz(n-t(r),e-r)}const er={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},OS=.001;function YSe({duration:t=er.duration,bounce:e=er.bounce,velocity:n=er.velocity,mass:r=er.mass}){let s,i,o=1-e;o=jl(er.minDamping,er.maxDamping,o),t=jl(er.minDuration,er.maxDuration,Ec(t)),o<1?(s=d=>{const u=d*o,h=u*t,f=u-n,p=Y_(d,o),m=Math.exp(-h);return OS-f/p*m},i=d=>{const h=d*o*t,f=h*n+n,p=Math.pow(o,2)*Math.pow(d,2)*t,m=Math.exp(-h),g=Y_(Math.pow(d,2),o);return(-s(d)+OS>0?-1:1)*((f-p)*m)/g}):(s=d=>{const u=Math.exp(-d*t),h=(d-n)*t+1;return-OS+u*h},i=d=>{const u=Math.exp(-d*t),h=(n-d)*(t*t);return u*h});const a=5/t,l=JSe(s,i,a);if(t=vc(t),isNaN(l))return{stiffness:er.stiffness,damping:er.damping,duration:t};{const d=Math.pow(l,2)*r;return{stiffness:d,damping:o*2*Math.sqrt(r*d),duration:t}}}const QSe=12;function JSe(t,e,n){let r=n;for(let s=1;s<QSe;s++)r=r-t(r)/e(r);return r}function Y_(t,e){return t*Math.sqrt(1-e*e)}const ZSe=["duration","bounce"],XSe=["stiffness","damping","mass"];function x6(t,e){return e.some(n=>t[n]!==void 0)}function e2e(t){let e={velocity:er.velocity,stiffness:er.stiffness,damping:er.damping,mass:er.mass,isResolvedFromDuration:!1,...t};if(!x6(t,XSe)&&x6(t,ZSe))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*jl(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:er.mass,stiffness:s,damping:i}}else{const n=YSe(t);e={...e,...n,mass:er.mass},e.isResolvedFromDuration=!0}return e}function YE(t=er.visualDuration,e=er.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:d,mass:u,duration:h,velocity:f,isResolvedFromDuration:p}=e2e({...n,velocity:-Ec(n.velocity||0)}),m=f||0,g=d/(2*Math.sqrt(l*u)),w=o-i,b=Ec(Math.sqrt(l/u)),y=Math.abs(w)<5;r||(r=y?er.restSpeed.granular:er.restSpeed.default),s||(s=y?er.restDelta.granular:er.restDelta.default);let x;if(g<1){const E=Y_(b,g);x=R=>{const S=Math.exp(-g*b*R);return o-S*((m+g*b*w)/E*Math.sin(E*R)+w*Math.cos(E*R))}}else if(g===1)x=E=>o-Math.exp(-b*E)*(w+(m+b*w)*E);else{const E=b*Math.sqrt(g*g-1);x=R=>{const S=Math.exp(-g*b*R),C=Math.min(E*R,300);return o-S*((m+g*b*w)*Math.sinh(C)+E*w*Math.cosh(C))/E}}const v={calculatedDuration:p&&h||null,next:E=>{const R=x(E);if(p)a.done=E>=h;else{let S=E===0?m:0;g<1&&(S=E===0?vc(m):yH(x,E,R));const C=Math.abs(S)<=r,N=Math.abs(o-R)<=s;a.done=C&&N}return a.value=a.done?o:R,a},toString:()=>{const E=Math.min(XR(v),GE),R=gH(S=>v.next(E*S).value,E,30);return E+"ms "+R},toTransition:()=>{}};return v}YE.applyToOptions=t=>{const e=KSe(t,100,YE);return t.ease=e.ease,t.duration=vc(e.duration),t.type="keyframes",t};function Q_({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:d=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},p=C=>a!==void 0&&C<a||l!==void 0&&C>l,m=C=>a===void 0?l:l===void 0||Math.abs(a-C)<Math.abs(l-C)?a:l;let g=n*e;const w=h+g,b=o===void 0?w:o(w);b!==w&&(g=b-h);const y=C=>-g*Math.exp(-C/r),x=C=>b+y(C),v=C=>{const N=y(C),T=x(C);f.done=Math.abs(N)<=d,f.value=f.done?b:T};let E,R;const S=C=>{p(f.value)&&(E=C,R=YE({keyframes:[f.value,m(f.value)],velocity:yH(x,C,f.value),damping:s,stiffness:i,restDelta:d,restSpeed:u}))};return S(0),{calculatedDuration:null,next:C=>{let N=!1;return!R&&E===void 0&&(N=!0,v(C),S(C)),E!==void 0&&C>=E?R.next(C-E):(!N&&v(C),f)}}}function t2e(t,e,n){const r=[],s=n||Pl.mix||mH,i=t.length-1;for(let o=0;o<i;o++){let a=s(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Po:e;a=hb(l,a)}r.push(a)}return r}function n2e(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(HR(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=t2e(e,r,s),l=a.length,d=u=>{if(o&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=xx(t[h],t[h+1],u);return a[h](f)};return n?u=>d(jl(t[0],t[i-1],u)):d}function r2e(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=xx(0,e,r);t.push(Gn(n,1,s))}}function s2e(t){const e=[0];return r2e(e,t.length-1),e}function i2e(t,e){return t.map(n=>n*e)}function o2e(t,e){return t.map(()=>e||iH).splice(0,t.length-1)}function Ly({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=ySe(r)?r.map(p6):p6(r),i={done:!1,value:e[0]},o=i2e(n&&n.length===e.length?n:s2e(e),t),a=n2e(o,e,{ease:Array.isArray(s)?s:o2e(e,s)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const a2e=t=>t!==null;function ej(t,{repeat:e,repeatType:n="loop"},r,s=1){const i=t.filter(a2e),a=s<0||e&&n!=="loop"&&e%2===1?0:i.length-1;return!a||r===void 0?i[a]:r}const c2e={decay:Q_,inertia:Q_,tween:Ly,keyframes:Ly,spring:YE};function wH(t){typeof t.type=="string"&&(t.type=c2e[t.type])}class tj{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const l2e=t=>t/100;class nj extends tj{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,s;const{motionValue:n}=this.options;n&&n.updatedAt!==Ci.now()&&this.tick(Ci.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(r=this.options).onStop)==null||s.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;wH(e);const{type:n=Ly,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=e;let{keyframes:a}=e;const l=n||Ly;l!==Ly&&typeof a[0]!="number"&&(this.mixKeyframes=hb(l2e,mH(a[0],a[1])),a=[0,100]);const d=l({...e,keyframes:a});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=XR(d));const{calculatedDuration:u}=d;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=d}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:d=0,keyframes:u,repeat:h,repeatType:f,repeatDelay:p,type:m,onUpdate:g,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const b=this.currentTime-d*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?b<0:b>s;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let x=this.currentTime,v=r;if(h){const C=Math.min(this.currentTime,s)/a;let N=Math.floor(C),T=C%1;!T&&C>=1&&(T=1),T===1&&N--,N=Math.min(N,h+1),!!(N%2)&&(f==="reverse"?(T=1-T,p&&(T-=p/a)):f==="mirror"&&(v=o)),x=jl(0,1,T)*a}const E=y?{done:!1,value:u[0]}:v.next(x);i&&(E.value=i(E.value));let{done:R}=E;!y&&l!==null&&(R=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return S&&m!==Q_&&(E.value=ej(u,this.options,w,this.speed)),g&&g(E.value),S&&this.finish(),E}then(e,n){return this.finished.then(e,n)}get duration(){return Ec(this.calculatedDuration)}get time(){return Ec(this.currentTime)}set time(e){var n;e=vc(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ci.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ec(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:e=qSe,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(s=this.options).onPlay)==null||i.call(s);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ci.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function d2e(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const vh=t=>t*180/Math.PI,J_=t=>{const e=vh(Math.atan2(t[1],t[0]));return Z_(e)},u2e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:J_,rotateZ:J_,skewX:t=>vh(Math.atan(t[1])),skewY:t=>vh(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Z_=t=>(t=t%360,t<0&&(t+=360),t),b6=J_,v6=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),E6=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),h2e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:v6,scaleY:E6,scale:t=>(v6(t)+E6(t))/2,rotateX:t=>Z_(vh(Math.atan2(t[6],t[5]))),rotateY:t=>Z_(vh(Math.atan2(-t[2],t[0]))),rotateZ:b6,rotate:b6,skewX:t=>vh(Math.atan(t[4])),skewY:t=>vh(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function X_(t){return t.includes("scale")?1:0}function ek(t,e){if(!t||t==="none")return X_(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=h2e,s=n;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=u2e,s=a}if(!s)return X_(e);const i=r[e],o=s[1].split(",").map(p2e);return typeof i=="function"?i(o):o[i]}const f2e=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return ek(n,e)};function p2e(t){return parseFloat(t.trim())}const i0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],o0=new Set(i0),C6=t=>t===s0||t===bt,m2e=new Set(["x","y","z"]),g2e=i0.filter(t=>!m2e.has(t));function y2e(t){const e=[];return g2e.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const Xh={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>ek(e,"x"),y:(t,{transform:e})=>ek(e,"y")};Xh.translateX=Xh.x;Xh.translateY=Xh.y;const ef=new Set;let tk=!1,nk=!1,rk=!1;function xH(){if(nk){const t=Array.from(ef).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const s=y2e(r);s.length&&(n.set(r,s),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,o])=>{var a;(a=r.getValue(i))==null||a.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}nk=!1,tk=!1,ef.forEach(t=>t.complete(rk)),ef.clear()}function bH(){ef.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(nk=!0)})}function w2e(){rk=!0,bH(),xH(),rk=!1}class rj{constructor(e,n,r,s,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(ef.add(this),tk||(tk=!0,Vn.read(bH),Vn.resolveKeyframes(xH))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:s}=this;if(e[0]===null){const i=s==null?void 0:s.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(r&&n){const a=r.readValue(n,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),s&&i===void 0&&s.set(e[0])}d2e(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),ef.delete(this)}cancel(){this.state==="scheduled"&&(ef.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const x2e=t=>t.startsWith("--");function b2e(t,e,n){x2e(e)?t.style.setProperty(e,n):t.style[e]=n}const v2e=VR(()=>window.ScrollTimeline!==void 0),E2e={};function C2e(t,e){const n=VR(t);return()=>E2e[e]??n()}const vH=C2e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),uy=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,N6={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:uy([0,.65,.55,1]),circOut:uy([.55,0,1,.45]),backIn:uy([.31,.01,.66,-.59]),backOut:uy([.33,1.53,.69,.99])};function EH(t,e){if(t)return typeof t=="function"?vH()?gH(t,e):"ease-out":oH(t)?uy(t):Array.isArray(t)?t.map(n=>EH(n,e)||N6.easeOut):N6[t]}function N2e(t,e,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:a="easeOut",times:l}={},d=void 0){const u={[e]:n};l&&(u.offset=l);const h=EH(a,s);Array.isArray(h)&&(u.easing=h);const f={delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return d&&(f.pseudoElement=d),t.animate(u,f)}function CH(t){return typeof t=="function"&&"applyToOptions"in t}function A2e({type:t,...e}){return CH(t)&&vH()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class S2e extends tj{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,HR(typeof e.type!="string");const d=A2e(e);this.animation=N2e(n,r,s,d,i),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=ej(s,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):b2e(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,r;const e=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Ec(Number(e))}get time(){return Ec(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=vc(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&v2e()?(this.animation.timeline=e,Po):n(this)}}const NH={anticipate:nH,backInOut:tH,circInOut:sH};function T2e(t){return t in NH}function _2e(t){typeof t.ease=="string"&&T2e(t.ease)&&(t.ease=NH[t.ease])}const A6=10;class k2e extends S2e{constructor(e){_2e(e),wH(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const a=new nj({...o,autoplay:!1}),l=vc(this.finishedTime??this.time);n.setWithVelocity(a.sample(l-A6).value,a.sample(l).value,A6),a.stop()}}const S6=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(hu.test(t)||t==="0")&&!t.startsWith("url("));function I2e(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function R2e(t,e,n,r){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=S6(s,e),a=S6(i,e);return!o||!a?!1:I2e(t)||(n==="spring"||CH(n))&&r}function sk(t){t.duration=0,t.type}const j2e=new Set(["opacity","clipPath","filter","transform"]),P2e=VR(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function O2e(t){var u;const{motionValue:e,name:n,repeatDelay:r,repeatType:s,damping:i,type:o}=t;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:d}=e.owner.getProps();return P2e()&&n&&j2e.has(n)&&(n!=="transform"||!d)&&!l&&!r&&s!=="mirror"&&i!==0&&o!=="inertia"}const D2e=40;class M2e extends tj{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",keyframes:a,name:l,motionValue:d,element:u,...h}){var m;super(),this.stop=()=>{var g,w;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(w=this.keyframeResolver)==null||w.cancel()},this.createdAt=Ci.now();const f={autoplay:e,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:o,name:l,motionValue:d,element:u,...h},p=(u==null?void 0:u.KeyframeResolver)||rj;this.keyframeResolver=new p(a,(g,w,b)=>this.onKeyframesResolved(g,w,f,!b),l,d,u),(m=this.keyframeResolver)==null||m.scheduleResolve()}onKeyframesResolved(e,n,r,s){this.keyframeResolver=void 0;const{name:i,type:o,velocity:a,delay:l,isHandoff:d,onUpdate:u}=r;this.resolvedAt=Ci.now(),R2e(e,i,o,a)||((Pl.instantAnimations||!l)&&(u==null||u(ej(e,r,n))),e[0]=e[e.length-1],sk(r),r.repeat=0);const f={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>D2e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:e},p=!d&&O2e(f)?new k2e({...f,element:f.motionValue.owner.current}):new nj(f);p.finished.then(()=>this.notifyFinished()).catch(Po),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),w2e()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const U2e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function L2e(t){const e=U2e.exec(t);if(!e)return[,];const[,n,r,s]=e;return[`--${n??r}`,s]}function AH(t,e,n=1){const[r,s]=L2e(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return Kz(o)?parseFloat(o):o}return YR(s)?AH(s,e,n+1):s}function sj(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const SH=new Set(["width","height","top","left","right","bottom",...i0]),B2e={test:t=>t==="auto",parse:t=>t},TH=t=>e=>e.test(t),_H=[s0,bt,Cc,sd,ISe,kSe,B2e],T6=t=>_H.find(TH(t));function $2e(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Yz(t):!0}const F2e=new Set(["brightness","contrast","saturate","opacity"]);function z2e(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(QR)||[];if(!r)return t;const s=n.replace(r,"");let i=F2e.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const H2e=/\b([a-z-]*)\(.*?\)/gu,ik={...hu,getAnimatableNone:t=>{const e=t.match(H2e);return e?e.map(z2e).join(" "):t}},_6={...s0,transform:Math.round},V2e={rotate:sd,rotateX:sd,rotateY:sd,rotateZ:sd,scale:Tv,scaleX:Tv,scaleY:Tv,scaleZ:Tv,skew:sd,skewX:sd,skewY:sd,distance:bt,translateX:bt,translateY:bt,translateZ:bt,x:bt,y:bt,z:bt,perspective:bt,transformPerspective:bt,opacity:bx,originX:m6,originY:m6,originZ:bt},ij={borderWidth:bt,borderTopWidth:bt,borderRightWidth:bt,borderBottomWidth:bt,borderLeftWidth:bt,borderRadius:bt,radius:bt,borderTopLeftRadius:bt,borderTopRightRadius:bt,borderBottomRightRadius:bt,borderBottomLeftRadius:bt,width:bt,maxWidth:bt,height:bt,maxHeight:bt,top:bt,right:bt,bottom:bt,left:bt,padding:bt,paddingTop:bt,paddingRight:bt,paddingBottom:bt,paddingLeft:bt,margin:bt,marginTop:bt,marginRight:bt,marginBottom:bt,marginLeft:bt,backgroundPositionX:bt,backgroundPositionY:bt,...V2e,zIndex:_6,fillOpacity:bx,strokeOpacity:bx,numOctaves:_6},W2e={...ij,color:yr,backgroundColor:yr,outlineColor:yr,fill:yr,stroke:yr,borderColor:yr,borderTopColor:yr,borderRightColor:yr,borderBottomColor:yr,borderLeftColor:yr,filter:ik,WebkitFilter:ik},kH=t=>W2e[t];function IH(t,e){let n=kH(t);return n!==ik&&(n=hu),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const q2e=new Set(["auto","none","0"]);function K2e(t,e,n){let r=0,s;for(;r<t.length&&!s;){const i=t[r];typeof i=="string"&&!q2e.has(i)&&vx(i).values.length&&(s=t[r]),r++}if(s&&n)for(const i of e)t[i]=IH(n,s)}class G2e extends rj{constructor(e,n,r,s,i){super(e,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let d=e[l];if(typeof d=="string"&&(d=d.trim(),YR(d))){const u=AH(d,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!SH.has(r)||e.length!==2)return;const[s,i]=e,o=T6(s),a=T6(i);if(o!==a)if(C6(o)&&C6(a))for(let l=0;l<e.length;l++){const d=e[l];typeof d=="string"&&(e[l]=parseFloat(d))}else Xh[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let s=0;s<e.length;s++)(e[s]===null||$2e(e[s]))&&r.push(s);r.length&&K2e(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Xh[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(r,s).jump(s,!1)}measureEndState(){var a;const{element:e,name:n,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const s=e.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,o=r[i];r[i]=Xh[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,d])=>{e.getValue(l).set(d)}),this.resolveNoneKeyframes()}}function Y2e(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const s=(n==null?void 0:n[t])??r.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const RH=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function jH(t){return Gz(t)&&"offsetHeight"in t}const k6=30,Q2e=t=>!isNaN(parseFloat(t));class J2e{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var i;const s=Ci.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Ci.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Q2e(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new WR);const r=this.events[e].add(n);return e==="change"?()=>{r(),Vn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ci.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>k6)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,k6);return Qz(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Og(t,e){return new J2e(t,e)}const{schedule:oj}=aH(queueMicrotask,!1),Qo={x:!1,y:!1};function PH(){return Qo.x||Qo.y}function Z2e(t){return t==="x"||t==="y"?Qo[t]?null:(Qo[t]=!0,()=>{Qo[t]=!1}):Qo.x||Qo.y?null:(Qo.x=Qo.y=!0,()=>{Qo.x=Qo.y=!1})}function OH(t,e){const n=Y2e(t),r=new AbortController,s={passive:!0,...e,signal:r.signal};return[n,s,()=>r.abort()]}function I6(t){return!(t.pointerType==="touch"||PH())}function X2e(t,e,n={}){const[r,s,i]=OH(t,n),o=a=>{if(!I6(a))return;const{target:l}=a,d=e(l,a);if(typeof d!="function"||!l)return;const u=h=>{I6(h)&&(d(h),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(a=>{a.addEventListener("pointerenter",o,s)}),i}const DH=(t,e)=>e?t===e?!0:DH(t,e.parentElement):!1,aj=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,eTe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function tTe(t){return eTe.has(t.tagName)||t.tabIndex!==-1}const v1=new WeakSet;function R6(t){return e=>{e.key==="Enter"&&t(e)}}function DS(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const nTe=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=R6(()=>{if(v1.has(n))return;DS(n,"down");const s=R6(()=>{DS(n,"up")}),i=()=>DS(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function j6(t){return aj(t)&&!PH()}function rTe(t,e,n={}){const[r,s,i]=OH(t,n),o=a=>{const l=a.currentTarget;if(!j6(a))return;v1.add(l);const d=e(l,a),u=(p,m)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),v1.has(l)&&v1.delete(l),j6(p)&&typeof d=="function"&&d(p,{success:m})},h=p=>{u(p,l===window||l===document||n.useGlobalTarget||DH(l,p.target))},f=p=>{u(p,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",f,s)};return r.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,s),jH(a)&&(a.addEventListener("focus",d=>nTe(d,s)),!tTe(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),i}function MH(t){return Gz(t)&&"ownerSVGElement"in t}function sTe(t){return MH(t)&&t.tagName==="svg"}const Is=t=>!!(t&&t.getVelocity),iTe=[..._H,yr,hu],oTe=t=>iTe.find(TH(t)),cj=A.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function P6(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function aTe(...t){return e=>{let n=!1;const r=t.map(s=>{const i=P6(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():P6(t[s],null)}}}}function cTe(...t){return A.useCallback(aTe(...t),t)}class lTe extends A.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=jH(r)&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function dTe({children:t,isPresent:e,anchorX:n,root:r}){const s=A.useId(),i=A.useRef(null),o=A.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=A.useContext(cj),l=cTe(i,t==null?void 0:t.ref);return A.useInsertionEffect(()=>{const{width:d,height:u,top:h,left:f,right:p}=o.current;if(e||!i.current||!d||!u)return;const m=n==="left"?`left: ${f}`:`right: ${p}`;i.current.dataset.motionPopId=s;const g=document.createElement("style");a&&(g.nonce=a);const w=r??document.head;return w.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${u}px !important;
            ${m}px !important;
            top: ${h}px !important;
          }
        `),()=>{w.contains(g)&&w.removeChild(g)}},[e]),c.jsx(lTe,{isPresent:e,childRef:i,sizeRef:o,children:A.cloneElement(t,{ref:l})})}const uTe=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o,anchorX:a,root:l})=>{const d=BR(hTe),u=A.useId();let h=!0,f=A.useMemo(()=>(h=!1,{id:u,initial:e,isPresent:n,custom:s,onExitComplete:p=>{d.set(p,!0);for(const m of d.values())if(!m)return;r&&r()},register:p=>(d.set(p,!1),()=>d.delete(p))}),[n,d,r]);return i&&h&&(f={...f}),A.useMemo(()=>{d.forEach((p,m)=>d.set(m,!1))},[n]),A.useEffect(()=>{!n&&!d.size&&r&&r()},[n]),o==="popLayout"&&(t=c.jsx(dTe,{isPresent:n,anchorX:a,root:l,children:t})),c.jsx(xN.Provider,{value:f,children:t})};function hTe(){return new Map}function UH(t=!0){const e=A.useContext(xN);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=e,i=A.useId();A.useEffect(()=>{if(t)return s(i)},[t]);const o=A.useCallback(()=>t&&r&&r(i),[i,r,t]);return!n&&r?[!1,o]:[!0]}const _v=t=>t.key||"";function O6(t){const e=[];return A.Children.forEach(t,n=>{A.isValidElement(n)&&e.push(n)}),e}const Oo=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:o=!1,anchorX:a="left",root:l})=>{const[d,u]=UH(o),h=A.useMemo(()=>O6(t),[t]),f=o&&!d?[]:h.map(_v),p=A.useRef(!0),m=A.useRef(h),g=BR(()=>new Map),[w,b]=A.useState(h),[y,x]=A.useState(h);qz(()=>{p.current=!1,m.current=h;for(let R=0;R<y.length;R++){const S=_v(y[R]);f.includes(S)?g.delete(S):g.get(S)!==!0&&g.set(S,!1)}},[y,f.length,f.join("-")]);const v=[];if(h!==w){let R=[...h];for(let S=0;S<y.length;S++){const C=y[S],N=_v(C);f.includes(N)||(R.splice(S,0,C),v.push(C))}return i==="wait"&&v.length&&(R=v),x(O6(R)),b(h),null}const{forceRender:E}=A.useContext(LR);return c.jsx(c.Fragment,{children:y.map(R=>{const S=_v(R),C=o&&!d?!1:h===y||f.includes(S),N=()=>{if(g.has(S))g.set(S,!0);else return;let T=!0;g.forEach($=>{$||(T=!1)}),T&&(E==null||E(),x(m.current),o&&(u==null||u()),r&&r())};return c.jsx(uTe,{isPresent:C,initial:!p.current||n?void 0:!1,custom:e,presenceAffectsLayout:s,mode:i,root:l,onExitComplete:C?void 0:N,anchorX:a,children:R},S)})})},LH=A.createContext({strict:!1}),D6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Dg={};for(const t in D6)Dg[t]={isEnabled:e=>D6[t].some(n=>!!e[n])};function fTe(t){for(const e in t)Dg[e]={...Dg[e],...t[e]}}const pTe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function QE(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||pTe.has(t)}let BH=t=>!QE(t);function mTe(t){typeof t=="function"&&(BH=e=>e.startsWith("on")?!QE(e):t(e))}try{mTe(require("@emotion/is-prop-valid").default)}catch{}function gTe(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(BH(s)||n===!0&&QE(s)||!e&&!QE(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}const bN=A.createContext({});function vN(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Ex(t){return typeof t=="string"||Array.isArray(t)}const lj=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],dj=["initial",...lj];function EN(t){return vN(t.animate)||dj.some(e=>Ex(t[e]))}function $H(t){return!!(EN(t)||t.variants)}function yTe(t,e){if(EN(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Ex(n)?n:void 0,animate:Ex(r)?r:void 0}}return t.inherit!==!1?e:{}}function wTe(t){const{initial:e,animate:n}=yTe(t,A.useContext(bN));return A.useMemo(()=>({initial:e,animate:n}),[M6(e),M6(n)])}function M6(t){return Array.isArray(t)?t.join(" "):t}const Cx={};function xTe(t){for(const e in t)Cx[e]=t[e],GR(e)&&(Cx[e].isCSSVariable=!0)}function FH(t,{layout:e,layoutId:n}){return o0.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Cx[t]||t==="opacity")}const bTe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},vTe=i0.length;function ETe(t,e,n){let r="",s=!0;for(let i=0;i<vTe;i++){const o=i0[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const d=RH(a,ij[o]);if(!l){s=!1;const u=bTe[o]||o;r+=`${u}(${d}) `}n&&(e[o]=d)}}return r=r.trim(),n?r=n(e,s?"":r):s&&(r="none"),r}function uj(t,e,n){const{style:r,vars:s,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const d=e[l];if(o0.has(l)){o=!0;continue}else if(GR(l)){s[l]=d;continue}else{const u=RH(d,ij[l]);l.startsWith("origin")?(a=!0,i[l]=u):r[l]=u}}if(e.transform||(o||n?r.transform=ETe(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:d="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${d} ${u}`}}const hj=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function zH(t,e,n){for(const r in e)!Is(e[r])&&!FH(r,n)&&(t[r]=e[r])}function CTe({transformTemplate:t},e){return A.useMemo(()=>{const n=hj();return uj(n,e,t),Object.assign({},n.vars,n.style)},[e])}function NTe(t,e){const n=t.style||{},r={};return zH(r,n,t),Object.assign(r,CTe(t,e)),r}function ATe(t,e){const n={},r=NTe(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}const STe={offset:"stroke-dashoffset",array:"stroke-dasharray"},TTe={offset:"strokeDashoffset",array:"strokeDasharray"};function _Te(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?STe:TTe;t[i.offset]=bt.transform(-r);const o=bt.transform(e),a=bt.transform(n);t[i.array]=`${o} ${a}`}function HH(t,{attrX:e,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:o=0,...a},l,d,u){if(uj(t,a,d),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:f}=t;h.transform&&(f.transform=h.transform,delete h.transform),(f.transform||h.transformOrigin)&&(f.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete h.transformBox),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),r!==void 0&&(h.scale=r),s!==void 0&&_Te(h,s,i,o,!1)}const VH=()=>({...hj(),attrs:{}}),WH=t=>typeof t=="string"&&t.toLowerCase()==="svg";function kTe(t,e,n,r){const s=A.useMemo(()=>{const i=VH();return HH(i,e,WH(r),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};zH(i,t.style,t),s.style={...i,...s.style}}return s}const ITe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function fj(t){return typeof t!="string"||t.includes("-")?!1:!!(ITe.indexOf(t)>-1||/[A-Z]/u.test(t))}function RTe(t,e,n,{latestValues:r},s,i=!1){const a=(fj(t)?kTe:ATe)(e,r,s,t),l=gTe(e,typeof t=="string",i),d=t!==A.Fragment?{...l,...a,ref:n}:{},{children:u}=e,h=A.useMemo(()=>Is(u)?u.get():u,[u]);return A.createElement(t,{...d,children:h})}function U6(t){const e=[{},{}];return t==null||t.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function pj(t,e,n,r){if(typeof e=="function"){const[s,i]=U6(r);e=e(n!==void 0?n:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=U6(r);e=e(n!==void 0?n:t.custom,s,i)}return e}function E1(t){return Is(t)?t.get():t}function jTe({scrapeMotionValuesFromProps:t,createRenderState:e},n,r,s){return{latestValues:PTe(n,r,s,t),renderState:e()}}function PTe(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=E1(i[f]);let{initial:o,animate:a}=t;const l=EN(t),d=$H(t);e&&d&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;if(h&&typeof h!="boolean"&&!vN(h)){const f=Array.isArray(h)?h:[h];for(let p=0;p<f.length;p++){const m=pj(t,f[p]);if(m){const{transitionEnd:g,transition:w,...b}=m;for(const y in b){let x=b[y];if(Array.isArray(x)){const v=u?x.length-1:0;x=x[v]}x!==null&&(s[y]=x)}for(const y in g)s[y]=g[y]}}}return s}const qH=t=>(e,n)=>{const r=A.useContext(bN),s=A.useContext(xN),i=()=>jTe(t,e,r,s);return n?i():BR(i)};function mj(t,e,n){var i;const{style:r}=t,s={};for(const o in r)(Is(r[o])||e.style&&Is(e.style[o])||FH(o,t)||((i=n==null?void 0:n.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(s[o]=r[o]);return s}const OTe=qH({scrapeMotionValuesFromProps:mj,createRenderState:hj});function KH(t,e,n){const r=mj(t,e,n);for(const s in t)if(Is(t[s])||Is(e[s])){const i=i0.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=t[s]}return r}const DTe=qH({scrapeMotionValuesFromProps:KH,createRenderState:VH}),MTe=Symbol.for("motionComponentSymbol");function Hp(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function UTe(t,e,n){return A.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Hp(n)&&(n.current=r))},[e])}const gj=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),LTe="framerAppearId",GH="data-"+gj(LTe),YH=A.createContext({});function BTe(t,e,n,r,s){var g,w;const{visualElement:i}=A.useContext(bN),o=A.useContext(LH),a=A.useContext(xN),l=A.useContext(cj).reducedMotion,d=A.useRef(null);r=r||o.renderer,!d.current&&r&&(d.current=r(t,{visualState:e,parent:i,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=d.current,h=A.useContext(YH);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&$Te(d.current,n,s,h);const f=A.useRef(!1);A.useInsertionEffect(()=>{u&&f.current&&u.update(n,a)});const p=n[GH],m=A.useRef(!!p&&!((g=window.MotionHandoffIsComplete)!=null&&g.call(window,p))&&((w=window.MotionHasOptimisedAnimation)==null?void 0:w.call(window,p)));return qz(()=>{u&&(f.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),m.current&&u.animationState&&u.animationState.animateChanges())}),A.useEffect(()=>{u&&(!m.current&&u.animationState&&u.animationState.animateChanges(),m.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)==null||b.call(window,p)}),m.current=!1),u.enteringChildren=void 0)}),u}function $Te(t,e,n,r){const{layoutId:s,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:d,layoutCrossfade:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:QH(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||a&&Hp(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:d})}function QH(t){if(t)return t.options.allowProjection!==!1?t.projection:QH(t.parent)}function MS(t,{forwardMotionProps:e=!1}={},n,r){n&&fTe(n);const s=fj(t)?DTe:OTe;function i(a,l){let d;const u={...A.useContext(cj),...a,layoutId:FTe(a)},{isStatic:h}=u,f=wTe(a),p=s(a,h);if(!h&&$R){zTe();const m=HTe(u);d=m.MeasureLayout,f.visualElement=BTe(t,p,u,r,m.ProjectionNode)}return c.jsxs(bN.Provider,{value:f,children:[d&&f.visualElement?c.jsx(d,{visualElement:f.visualElement,...u}):null,RTe(t,a,UTe(p,f.visualElement,l),p,h,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=A.forwardRef(i);return o[MTe]=t,o}function FTe({layoutId:t}){const e=A.useContext(LR).id;return e&&t!==void 0?e+"-"+t:t}function zTe(t,e){A.useContext(LH).strict}function HTe(t){const{drag:e,layout:n}=Dg;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function VTe(t,e){if(typeof Proxy>"u")return MS;const n=new Map,r=(i,o)=>MS(i,o,t,e),s=(i,o)=>r(i,o);return new Proxy(s,{get:(i,o)=>o==="create"?r:(n.has(o)||n.set(o,MS(o,void 0,t,e)),n.get(o))})}function JH({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function WTe({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function qTe(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function US(t){return t===void 0||t===1}function ok({scale:t,scaleX:e,scaleY:n}){return!US(t)||!US(e)||!US(n)}function Hu(t){return ok(t)||ZH(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function ZH(t){return L6(t.x)||L6(t.y)}function L6(t){return t&&t!=="0%"}function JE(t,e,n){const r=t-n,s=e*r;return n+s}function B6(t,e,n,r,s){return s!==void 0&&(t=JE(t,s,r)),JE(t,n,r)+e}function ak(t,e=0,n=1,r,s){t.min=B6(t.min,e,n,r,s),t.max=B6(t.max,e,n,r,s)}function XH(t,{x:e,y:n}){ak(t.x,e.translate,e.scale,e.originPoint),ak(t.y,n.translate,n.scale,n.originPoint)}const $6=.999999999999,F6=1.0000000000001;function KTe(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let a=0;a<s;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Wp(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,XH(t,o)),r&&Hu(i.latestValues)&&Wp(t,i.latestValues))}e.x<F6&&e.x>$6&&(e.x=1),e.y<F6&&e.y>$6&&(e.y=1)}function Vp(t,e){t.min=t.min+e,t.max=t.max+e}function z6(t,e,n,r,s=.5){const i=Gn(t.min,t.max,s);ak(t,e,n,i,r)}function Wp(t,e){z6(t.x,e.x,e.scaleX,e.scale,e.originX),z6(t.y,e.y,e.scaleY,e.scale,e.originY)}function eV(t,e){return JH(qTe(t.getBoundingClientRect(),e))}function GTe(t,e,n){const r=eV(t,n),{scroll:s}=e;return s&&(Vp(r.x,s.offset.x),Vp(r.y,s.offset.y)),r}const H6=()=>({translate:0,scale:1,origin:0,originPoint:0}),qp=()=>({x:H6(),y:H6()}),V6=()=>({min:0,max:0}),ar=()=>({x:V6(),y:V6()}),ck={current:null},tV={current:!1};function YTe(){if(tV.current=!0,!!$R)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>ck.current=t.matches;t.addEventListener("change",e),e()}else ck.current=!1}const QTe=new WeakMap;function JTe(t,e,n){for(const r in e){const s=e[r],i=n[r];if(Is(s))t.addValue(r,s);else if(Is(i))t.addValue(r,Og(s,{owner:t}));else if(i!==s)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(r);t.addValue(r,Og(o!==void 0?o:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const W6=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class ZTe{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=rj,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Ci.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Vn.render(this.render,!1,!0))};const{latestValues:l,renderState:d}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=d,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=EN(n),this.isVariantNode=$H(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in h){const p=h[f];l[f]!==void 0&&Is(p)&&p.set(l[f])}}mount(e){var n;this.current=e,QTe.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,s)=>this.bindToMotionValue(s,r)),tV.current||YTe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ck.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),uu(this.notifyUpdate),uu(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const r=this.features[n];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=o0.has(e);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Vn.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Dg){const n=Dg[e];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[e]&&s&&r(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ar()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<W6.length;r++){const s=W6[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=JTe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Og(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(Kz(r)||Yz(r))?r=parseFloat(r):!oTe(r)&&hu.test(n)&&(r=IH(e,n)),this.setBaseTarget(e,Is(r)?r.get():r)),Is(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const o=pj(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);o&&(r=o[e])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Is(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new WR),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){oj.render(this.render)}}class nV extends ZTe{constructor(){super(...arguments),this.KeyframeResolver=G2e}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Is(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function rV(t,{style:e,vars:n},r,s){const i=t.style;let o;for(o in e)i[o]=e[o];s==null||s.applyProjectionStyles(i,r);for(o in n)i.setProperty(o,n[o])}function XTe(t){return window.getComputedStyle(t)}class e_e extends nV{constructor(){super(...arguments),this.type="html",this.renderInstance=rV}readValueFromInstance(e,n){var r;if(o0.has(n))return(r=this.projection)!=null&&r.isProjecting?X_(n):f2e(e,n);{const s=XTe(e),i=(GR(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return eV(e,n)}build(e,n,r){uj(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return mj(e,n,r)}}const sV=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function t_e(t,e,n,r){rV(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(sV.has(s)?s:gj(s),e.attrs[s])}class n_e extends nV{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ar}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(o0.has(n)){const r=kH(n);return r&&r.default||0}return n=sV.has(n)?n:gj(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return KH(e,n,r)}build(e,n,r){HH(e,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,n,r,s){t_e(e,n,r,s)}mount(e){this.isSVGTag=WH(e.tagName),super.mount(e)}}const r_e=(t,e)=>fj(t)?new n_e(e):new e_e(e,{allowProjection:t!==A.Fragment});function hm(t,e,n){const r=t.getProps();return pj(r,e,n!==void 0?n:r.custom,t)}const lk=t=>Array.isArray(t);function s_e(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Og(n))}function i_e(t){return lk(t)?t[t.length-1]||0:t}function o_e(t,e){const n=hm(t,e);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const o in i){const a=i_e(i[o]);s_e(t,o,a)}}function a_e(t){return!!(Is(t)&&t.add)}function dk(t,e){const n=t.getValue("willChange");if(a_e(n))return n.add(e);if(!n&&Pl.WillChange){const r=new Pl.WillChange("auto");t.addValue("willChange",r),r.add(e)}}function iV(t){return t.props[GH]}const c_e=t=>t!==null;function l_e(t,{repeat:e,repeatType:n="loop"},r){const s=t.filter(c_e),i=e&&n!=="loop"&&e%2===1?0:s.length-1;return s[i]}const d_e={type:"spring",stiffness:500,damping:25,restSpeed:10},u_e=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),h_e={type:"keyframes",duration:.8},f_e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},p_e=(t,{keyframes:e})=>e.length>2?h_e:o0.has(t)?t.startsWith("scale")?u_e(e[1]):d_e:f_e;function m_e({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:d,...u}){return!!Object.keys(u).length}const yj=(t,e,n,r={},s,i)=>o=>{const a=sj(r,t)||{},l=a.delay||r.delay||0;let{elapsed:d=0}=r;d=d-vc(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-d,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:s};m_e(a)||Object.assign(u,p_e(t,u)),u.duration&&(u.duration=vc(u.duration)),u.repeatDelay&&(u.repeatDelay=vc(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(sk(u),u.delay===0&&(h=!0)),(Pl.instantAnimations||Pl.skipAnimations)&&(h=!0,sk(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,h&&!i&&e.get()!==void 0){const f=l_e(u.keyframes,a);if(f!==void 0){Vn.update(()=>{u.onUpdate(f),u.onComplete()});return}}return a.isSync?new nj(u):new M2e(u)};function g_e({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function oV(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...a}=e;r&&(i=r);const l=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const u in a){const h=t.getValue(u,t.latestValues[u]??null),f=a[u];if(f===void 0||d&&g_e(d,u))continue;const p={delay:n,...sj(i||{},u)},m=h.get();if(m!==void 0&&!h.isAnimating&&!Array.isArray(f)&&f===m&&!p.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const b=iV(t);if(b){const y=window.MotionHandoffAnimation(b,u,Vn);y!==null&&(p.startTime=y,g=!0)}}dk(t,u),h.start(yj(u,h,f,t.shouldReduceMotion&&SH.has(u)?{type:!1}:p,t,g));const w=h.animation;w&&l.push(w)}return o&&Promise.all(l).then(()=>{Vn.update(()=>{o&&o_e(t,o)})}),l}function aV(t,e,n,r=0,s=1){const i=Array.from(t).sort((d,u)=>d.sortNodePosition(u)).indexOf(e),o=t.size,a=(o-1)*r;return typeof n=="function"?n(i,o):s===1?i*r:a-i*r}function uk(t,e,n={}){var l;const r=hm(t,e,n.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(oV(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=s;return y_e(t,e,d,u,h,f,n)}:()=>Promise.resolve(),{when:a}=s;if(a){const[d,u]=a==="beforeChildren"?[i,o]:[o,i];return d().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function y_e(t,e,n=0,r=0,s=0,i=1,o){const a=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),a.push(uk(l,e,{...o,delay:n+(typeof r=="function"?0:r)+aV(t.variantChildren,l,r,s,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function w_e(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>uk(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=uk(t,e,n);else{const s=typeof e=="function"?hm(t,e,n.custom):e;r=Promise.all(oV(t,s,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}function cV(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const x_e=dj.length;function lV(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?lV(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<x_e;n++){const r=dj[n],s=t.props[r];(Ex(s)||s===!1)&&(e[r]=s)}return e}const b_e=[...lj].reverse(),v_e=lj.length;function E_e(t){return e=>Promise.all(e.map(({animation:n,options:r})=>w_e(t,n,r)))}function C_e(t){let e=E_e(t),n=q6(),r=!0;const s=l=>(d,u)=>{var f;const h=hm(t,u,l==="exit"?(f=t.presenceContext)==null?void 0:f.custom:void 0);if(h){const{transition:p,transitionEnd:m,...g}=h;d={...d,...g,...m}}return d};function i(l){e=l(t)}function o(l){const{props:d}=t,u=lV(t.parent)||{},h=[],f=new Set;let p={},m=1/0;for(let w=0;w<v_e;w++){const b=b_e[w],y=n[b],x=d[b]!==void 0?d[b]:u[b],v=Ex(x),E=b===l?y.isActive:null;E===!1&&(m=w);let R=x===u[b]&&x!==d[b]&&v;if(R&&r&&t.manuallyAnimateOnMount&&(R=!1),y.protectedKeys={...p},!y.isActive&&E===null||!x&&!y.prevProp||vN(x)||typeof x=="boolean")continue;const S=N_e(y.prevProp,x);let C=S||b===l&&y.isActive&&!R&&v||w>m&&v,N=!1;const T=Array.isArray(x)?x:[x];let $=T.reduce(s(b),{});E===!1&&($={});const{prevResolvedValues:U={}}=y,H={...U,...$},K=F=>{C=!0,f.has(F)&&(N=!0,f.delete(F)),y.needsAnimating[F]=!0;const P=t.getValue(F);P&&(P.liveStyle=!1)};for(const F in H){const P=$[F],L=U[F];if(p.hasOwnProperty(F))continue;let B=!1;lk(P)&&lk(L)?B=!cV(P,L):B=P!==L,B?P!=null?K(F):f.add(F):P!==void 0&&f.has(F)?K(F):y.protectedKeys[F]=!0}y.prevProp=x,y.prevResolvedValues=$,y.isActive&&(p={...p,...$}),r&&t.blockInitialAnimation&&(C=!1);const I=R&&S;C&&(!I||N)&&h.push(...T.map(F=>{const P={type:b};if(typeof F=="string"&&r&&!I&&t.manuallyAnimateOnMount&&t.parent){const{parent:L}=t,B=hm(L,F);if(L.enteringChildren&&B){const{delayChildren:V}=B.transition||{};P.delay=aV(L.enteringChildren,t,V)}}return{animation:F,options:P}}))}if(f.size){const w={};if(typeof d.initial!="boolean"){const b=hm(t,Array.isArray(d.initial)?d.initial[0]:d.initial);b&&b.transition&&(w.transition=b.transition)}f.forEach(b=>{const y=t.getBaseTarget(b),x=t.getValue(b);x&&(x.liveStyle=!0),w[b]=y??null}),h.push({animation:w})}let g=!!h.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(g=!1),r=!1,g?e(h):Promise.resolve()}function a(l,d){var h;if(n[l].isActive===d)return Promise.resolve();(h=t.variantChildren)==null||h.forEach(f=>{var p;return(p=f.animationState)==null?void 0:p.setActive(l,d)}),n[l].isActive=d;const u=o(l);for(const f in n)n[f].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=q6(),r=!0}}}function N_e(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!cV(e,t):!1}function Mu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function q6(){return{animate:Mu(!0),whileInView:Mu(),whileHover:Mu(),whileTap:Mu(),whileDrag:Mu(),whileFocus:Mu(),exit:Mu()}}class Cu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class A_e extends Cu{constructor(e){super(e),e.animationState||(e.animationState=C_e(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();vN(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let S_e=0;class T_e extends Cu{constructor(){super(...arguments),this.id=S_e++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const __e={animation:{Feature:A_e},exit:{Feature:T_e}};function Nx(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function mb(t){return{point:{x:t.pageX,y:t.pageY}}}const k_e=t=>e=>aj(e)&&t(e,mb(e));function By(t,e,n,r){return Nx(t,e,k_e(n),r)}const dV=1e-4,I_e=1-dV,R_e=1+dV,uV=.01,j_e=0-uV,P_e=0+uV;function qs(t){return t.max-t.min}function O_e(t,e,n){return Math.abs(t-e)<=n}function K6(t,e,n,r=.5){t.origin=r,t.originPoint=Gn(e.min,e.max,t.origin),t.scale=qs(n)/qs(e),t.translate=Gn(n.min,n.max,t.origin)-t.originPoint,(t.scale>=I_e&&t.scale<=R_e||isNaN(t.scale))&&(t.scale=1),(t.translate>=j_e&&t.translate<=P_e||isNaN(t.translate))&&(t.translate=0)}function $y(t,e,n,r){K6(t.x,e.x,n.x,r?r.originX:void 0),K6(t.y,e.y,n.y,r?r.originY:void 0)}function G6(t,e,n){t.min=n.min+e.min,t.max=t.min+qs(e)}function D_e(t,e,n){G6(t.x,e.x,n.x),G6(t.y,e.y,n.y)}function Y6(t,e,n){t.min=e.min-n.min,t.max=t.min+qs(e)}function Fy(t,e,n){Y6(t.x,e.x,n.x),Y6(t.y,e.y,n.y)}function fo(t){return[t("x"),t("y")]}const hV=({current:t})=>t?t.ownerDocument.defaultView:null,Q6=(t,e)=>Math.abs(t-e);function M_e(t,e){const n=Q6(t.x,e.x),r=Q6(t.y,e.y);return Math.sqrt(n**2+r**2)}class fV{constructor(e,n,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=BS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,m=M_e(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!m)return;const{point:g}=f,{timestamp:w}=ts;this.history.push({...g,timestamp:w});const{onStart:b,onMove:y}=this.handlers;p||(b&&b(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,f)},this.handlePointerMove=(f,p)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=LS(p,this.transformPagePoint),Vn.update(this.updatePoint,!0)},this.handlePointerUp=(f,p)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=BS(f.type==="pointercancel"?this.lastMoveEventInfo:LS(p,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,b),g&&g(f,b)},!aj(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=s||window;const a=mb(e),l=LS(a,this.transformPagePoint),{point:d}=l,{timestamp:u}=ts;this.history=[{...d,timestamp:u}];const{onSessionStart:h}=n;h&&h(e,BS(l,this.history)),this.removeListeners=hb(By(this.contextWindow,"pointermove",this.handlePointerMove),By(this.contextWindow,"pointerup",this.handlePointerUp),By(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),uu(this.updatePoint)}}function LS(t,e){return e?{point:e(t.point)}:t}function J6(t,e){return{x:t.x-e.x,y:t.y-e.y}}function BS({point:t},e){return{point:t,delta:J6(t,pV(e)),offset:J6(t,U_e(e)),velocity:L_e(e,.1)}}function U_e(t){return t[0]}function pV(t){return t[t.length-1]}function L_e(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=pV(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>vc(e)));)n--;if(!r)return{x:0,y:0};const i=Ec(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function B_e(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Gn(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Gn(n,t,r.max):Math.min(t,n)),t}function Z6(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function $_e(t,{top:e,left:n,bottom:r,right:s}){return{x:Z6(t.x,n,s),y:Z6(t.y,e,r)}}function X6(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function F_e(t,e){return{x:X6(t.x,e.x),y:X6(t.y,e.y)}}function z_e(t,e){let n=.5;const r=qs(t),s=qs(e);return s>r?n=xx(e.min,e.max-r,t.min):r>s&&(n=xx(t.min,t.max-s,e.min)),jl(0,1,n)}function H_e(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const hk=.35;function V_e(t=hk){return t===!1?t=0:t===!0&&(t=hk),{x:eM(t,"left","right"),y:eM(t,"top","bottom")}}function eM(t,e,n){return{min:tM(t,e),max:tM(t,n)}}function tM(t,e){return typeof t=="number"?t:t[e]||0}const W_e=new WeakMap;class q_e{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ar(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(mb(h).point)},o=(h,f)=>{const{drag:p,dragPropagation:m,onDragStart:g}=this.getProps();if(p&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Z2e(p),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fo(b=>{let y=this.getAxisMotionValue(b).get()||0;if(Cc.test(y)){const{projection:x}=this.visualElement;if(x&&x.layout){const v=x.layout.layoutBox[b];v&&(y=qs(v)*(parseFloat(y)/100))}}this.originPoint[b]=y}),g&&Vn.postRender(()=>g(h,f)),dk(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},a=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f;const{dragPropagation:p,dragDirectionLock:m,onDirectionLock:g,onDrag:w}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:b}=f;if(m&&this.currentDirection===null){this.currentDirection=K_e(b),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,b),this.updateAxis("y",f.point,b),this.visualElement.render(),w&&w(h,f)},l=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f,this.stop(h,f),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>fo(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)==null?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new fV(e,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:hV(this.visualElement)})}stop(e,n){const r=e||this.latestPointerEvent,s=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!r)return;const{velocity:o}=s;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&Vn.postRender(()=>a(r,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!kv(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=B_e(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;e&&Hp(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=$_e(r.layoutBox,e):this.constraints=!1,this.elastic=V_e(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&fo(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=H_e(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Hp(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=GTe(r,s.root,this.visualElement.getTransformPagePoint());let o=F_e(s.layout.layoutBox,i);if(n){const a=n(WTe(o));this.hasMutatedConstraints=!!a,a&&(o=JH(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},d=fo(u=>{if(!kv(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const f=s?200:1e6,p=s?40:1e7,m={type:"inertia",velocity:r?e[u]:0,bounceStiffness:f,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,m)});return Promise.all(d).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return dk(this.visualElement,e),r.start(yj(e,r,0,n,this.visualElement,!1))}stopAnimation(){fo(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){fo(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){fo(n=>{const{drag:r}=this.getProps();if(!kv(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[n];i.set(e[n]-Gn(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Hp(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};fo(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();s[o]=z_e({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),fo(o=>{if(!kv(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:d}=this.constraints[o];a.set(Gn(l,d,s[o]))})}addListeners(){if(!this.visualElement.current)return;W_e.set(this.visualElement,this);const e=this.visualElement.current,n=By(e,"pointerdown",l=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Hp(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Vn.read(r);const o=Nx(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:d})=>{this.isDragging&&d&&(fo(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=hk,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function kv(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function K_e(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class G_e extends Cu{constructor(e){super(e),this.removeGroupControls=Po,this.removeListeners=Po,this.controls=new q_e(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Po}unmount(){this.removeGroupControls(),this.removeListeners()}}const nM=t=>(e,n)=>{t&&Vn.postRender(()=>t(e,n))};class Y_e extends Cu{constructor(){super(...arguments),this.removePointerDownListener=Po}onPointerDown(e){this.session=new fV(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:hV(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:nM(e),onStart:nM(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&Vn.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=By(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const C1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function rM(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const K0={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(bt.test(t))t=parseFloat(t);else return t;const n=rM(t,e.target.x),r=rM(t,e.target.y);return`${n}% ${r}%`}},Q_e={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=hu.parse(t);if(s.length>5)return r;const i=hu.createTransformer(t),o=typeof s[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;s[0+o]/=a,s[1+o]/=l;const d=Gn(a,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=d),typeof s[3+o]=="number"&&(s[3+o]/=d),i(s)}};let $S=!1;class J_e extends A.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;xTe(Z_e),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),$S&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),C1.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:o}=r;return o&&(o.isPresent=i,$S=!0,s||e.layoutDependency!==n||n===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Vn.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),oj.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;$S=!0,s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function mV(t){const[e,n]=UH(),r=A.useContext(LR);return c.jsx(J_e,{...t,layoutGroup:r,switchLayoutGroup:A.useContext(YH),isPresent:e,safeToRemove:n})}const Z_e={borderRadius:{...K0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:K0,borderTopRightRadius:K0,borderBottomLeftRadius:K0,borderBottomRightRadius:K0,boxShadow:Q_e};function X_e(t,e,n){const r=Is(t)?t:Og(t);return r.start(yj("",r,e,n)),r.animation}const eke=(t,e)=>t.depth-e.depth;class tke{constructor(){this.children=[],this.isDirty=!1}add(e){FR(this.children,e),this.isDirty=!0}remove(e){zR(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(eke),this.isDirty=!1,this.children.forEach(e)}}function nke(t,e){const n=Ci.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(uu(r),t(i-e))};return Vn.setup(r,!0),()=>uu(r)}const gV=["TopLeft","TopRight","BottomLeft","BottomRight"],rke=gV.length,sM=t=>typeof t=="string"?parseFloat(t):t,iM=t=>typeof t=="number"||bt.test(t);function ske(t,e,n,r,s,i){s?(t.opacity=Gn(0,n.opacity??1,ike(r)),t.opacityExit=Gn(e.opacity??1,0,oke(r))):i&&(t.opacity=Gn(e.opacity??1,n.opacity??1,r));for(let o=0;o<rke;o++){const a=`border${gV[o]}Radius`;let l=oM(e,a),d=oM(n,a);if(l===void 0&&d===void 0)continue;l||(l=0),d||(d=0),l===0||d===0||iM(l)===iM(d)?(t[a]=Math.max(Gn(sM(l),sM(d),r),0),(Cc.test(d)||Cc.test(l))&&(t[a]+="%")):t[a]=d}(e.rotate||n.rotate)&&(t.rotate=Gn(e.rotate||0,n.rotate||0,r))}function oM(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const ike=yV(0,.5,rH),oke=yV(.5,.95,Po);function yV(t,e,n){return r=>r<t?0:r>e?1:n(xx(t,e,r))}function aM(t,e){t.min=e.min,t.max=e.max}function lo(t,e){aM(t.x,e.x),aM(t.y,e.y)}function cM(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function lM(t,e,n,r,s){return t-=e,t=JE(t,1/n,r),s!==void 0&&(t=JE(t,1/s,r)),t}function ake(t,e=0,n=1,r=.5,s,i=t,o=t){if(Cc.test(e)&&(e=parseFloat(e),e=Gn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Gn(i.min,i.max,r);t===i&&(a-=e),t.min=lM(t.min,e,n,a,s),t.max=lM(t.max,e,n,a,s)}function dM(t,e,[n,r,s],i,o){ake(t,e[n],e[r],e[s],e.scale,i,o)}const cke=["x","scaleX","originX"],lke=["y","scaleY","originY"];function uM(t,e,n,r){dM(t.x,e,cke,n?n.x:void 0,r?r.x:void 0),dM(t.y,e,lke,n?n.y:void 0,r?r.y:void 0)}function hM(t){return t.translate===0&&t.scale===1}function wV(t){return hM(t.x)&&hM(t.y)}function fM(t,e){return t.min===e.min&&t.max===e.max}function dke(t,e){return fM(t.x,e.x)&&fM(t.y,e.y)}function pM(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function xV(t,e){return pM(t.x,e.x)&&pM(t.y,e.y)}function mM(t){return qs(t.x)/qs(t.y)}function gM(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class uke{constructor(){this.members=[]}add(e){FR(this.members,e),e.scheduleRender()}remove(e){if(zR(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function hke(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((s||i||o)&&(r=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:d,rotate:u,rotateX:h,rotateY:f,skewX:p,skewY:m}=n;d&&(r=`perspective(${d}px) ${r}`),u&&(r+=`rotate(${u}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),p&&(r+=`skewX(${p}deg) `),m&&(r+=`skewY(${m}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const FS=["","X","Y","Z"],fke=1e3;let pke=0;function zS(t,e,n,r){const{latestValues:s}=e;s[t]&&(n[t]=s[t],e.setStaticValue(t,0),r&&(r[t]=0))}function bV(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=iV(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Vn,!(s||i))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&bV(r)}function vV({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},a=e==null?void 0:e()){this.id=pke++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(yke),this.nodes.forEach(vke),this.nodes.forEach(Eke),this.nodes.forEach(wke)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new tke)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new WR),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=MH(o)&&!sTe(o),this.instance=o;const{layoutId:a,layout:l,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),t){let u,h=0;const f=()=>this.root.updateBlockedByResize=!1;Vn.read(()=>{h=window.innerWidth}),t(o,()=>{const p=window.innerWidth;p!==h&&(h=p,this.root.updateBlockedByResize=!0,u&&u(),u=nke(f,250),C1.hasAnimatedSinceResize&&(C1.hasAnimatedSinceResize=!1,this.nodes.forEach(xM)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&d&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||d.getDefaultTransition()||Tke,{onLayoutAnimationStart:g,onLayoutAnimationComplete:w}=d.getProps(),b=!this.targetLayout||!xV(this.targetLayout,p),y=!h&&f;if(this.options.layoutRoot||this.resumeFrom||y||h&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const x={...sj(m,"layout"),onPlay:g,onComplete:w};(d.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x),this.setAnimationOrigin(u,y)}else h||xM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),uu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Cke),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&bV(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(yM);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(wM);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(bke),this.nodes.forEach(mke),this.nodes.forEach(gke)):this.nodes.forEach(wM),this.clearAllSnapshots();const a=Ci.now();ts.delta=jl(0,1e3/60,a-ts.timestamp),ts.timestamp=a,ts.isProcessing=!0,IS.update.process(ts),IS.preRender.process(ts),IS.render.process(ts),ts.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,oj.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(xke),this.sharedNodes.forEach(Nke)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Vn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Vn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!qs(this.snapshot.measuredBox.x)&&!qs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ar(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!wV(this.projectionDelta),l=this.getTransformTemplate(),d=l?l(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;o&&this.instance&&(a||Hu(this.latestValues)||u)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),_ke(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:o}=this.options;if(!o)return ar();const a=o.measureViewportBox();if(!(((d=this.scroll)==null?void 0:d.wasRoot)||this.path.some(kke))){const{scroll:u}=this.root;u&&(Vp(a.x,u.offset.x),Vp(a.y,u.offset.y))}return a}removeElementScroll(o){var l;const a=ar();if(lo(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&lo(a,o),Vp(a.x,h.offset.x),Vp(a.y,h.offset.y))}return a}applyTransform(o,a=!1){const l=ar();lo(l,o);for(let d=0;d<this.path.length;d++){const u=this.path[d];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Wp(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Hu(u.latestValues)&&Wp(l,u.latestValues)}return Hu(this.latestValues)&&Wp(l,this.latestValues),l}removeTransform(o){const a=ar();lo(a,o);for(let l=0;l<this.path.length;l++){const d=this.path[l];if(!d.instance||!Hu(d.latestValues))continue;ok(d.latestValues)&&d.updateSnapshot();const u=ar(),h=d.measurePageBox();lo(u,h),uM(a,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Hu(this.latestValues)&&uM(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ts.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var f;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!(!this.layout||!(u||h))){if(this.resolvedRelativeTargetAt=ts.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ar(),this.relativeTargetOrigin=ar(),Fy(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),lo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ar(),this.targetWithTransforms=ar()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),D_e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):lo(this.target,this.layout.layoutBox),XH(this.target,this.targetDelta)):lo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ar(),this.relativeTargetOrigin=ar(),Fy(this.relativeTargetOrigin,this.target,p.target),lo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||ok(this.parent.latestValues)||ZH(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var m;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ts.timestamp&&(l=!1),l)return;const{layout:d,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||u))return;lo(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;KTe(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=ar());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(cM(this.prevProjectionDelta.x,this.projectionDelta.x),cM(this.prevProjectionDelta.y,this.projectionDelta.y)),$y(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!gM(this.projectionDelta.x,this.prevProjectionDelta.x)||!gM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=qp(),this.projectionDelta=qp(),this.projectionDeltaWithTransform=qp()}setAnimationOrigin(o,a=!1){const l=this.snapshot,d=l?l.latestValues:{},u={...this.latestValues},h=qp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=ar(),p=l?l.source:void 0,m=this.layout?this.layout.source:void 0,g=p!==m,w=this.getStack(),b=!w||w.members.length<=1,y=!!(g&&!b&&this.options.crossfade===!0&&!this.path.some(Ske));this.animationProgress=0;let x;this.mixTargetDelta=v=>{const E=v/1e3;bM(h.x,o.x,E),bM(h.y,o.y,E),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Fy(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ake(this.relativeTarget,this.relativeTargetOrigin,f,E),x&&dke(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=ar()),lo(x,this.relativeTarget)),g&&(this.animationValues=u,ske(u,d,this.latestValues,E,y,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,d;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(d=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||d.stop(),this.pendingAnimation&&(uu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Vn.update(()=>{C1.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Og(0)),this.currentAnimation=X_e(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fke),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:d,latestValues:u}=o;if(!(!a||!l||!d)){if(this!==o&&this.layout&&d&&EV(this.options.animationType,this.layout.layoutBox,d.layoutBox)){l=this.target||ar();const h=qs(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const f=qs(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+f}lo(a,l),Wp(a,u),$y(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new uke),this.sharedNodes.get(o).add(a);const d=a.options.initialPromotionConfig;a.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const d=this.getStack();d&&d.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const d={};l.z&&zS("z",o,d,this.animationValues);for(let u=0;u<FS.length;u++)zS(`rotate${FS[u]}`,o,d,this.animationValues),zS(`skew${FS[u]}`,o,d,this.animationValues);o.render();for(const u in d)o.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=E1(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=E1(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Hu(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=d.animationValues||d.latestValues;this.applyTransformsToTarget();let h=hke(this.projectionDeltaWithTransform,this.treeScale,u);l&&(h=l(u,h)),o.transform=h;const{x:f,y:p}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,d.animationValues?o.opacity=d===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=d===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in Cx){if(u[m]===void 0)continue;const{correct:g,applyTo:w,isCSSVariable:b}=Cx[m],y=h==="none"?u[m]:g(u[m],d);if(w){const x=w.length;for(let v=0;v<x;v++)o[w[v]]=y}else b?this.options.visualElement.renderState.vars[m]=y:o[m]=y}this.options.layoutId&&(o.pointerEvents=d===this?E1(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(yM),this.root.sharedNodes.clear()}}}function mke(t){t.updateLayout()}function gke(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=e.source!==t.layout.source;i==="size"?fo(h=>{const f=o?e.measuredBox[h]:e.layoutBox[h],p=qs(f);f.min=r[h].min,f.max=f.min+p}):EV(i,e.layoutBox,r)&&fo(h=>{const f=o?e.measuredBox[h]:e.layoutBox[h],p=qs(r[h]);f.max=f.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+p)});const a=qp();$y(a,r,e.layoutBox);const l=qp();o?$y(l,t.applyTransform(s,!0),e.measuredBox):$y(l,r,e.layoutBox);const d=!wV(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:p}=h;if(f&&p){const m=ar();Fy(m,e.layoutBox,f.layoutBox);const g=ar();Fy(g,r,p.layoutBox),xV(m,g)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=g,t.relativeTargetOrigin=m,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:d,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function yke(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function wke(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function xke(t){t.clearSnapshot()}function yM(t){t.clearMeasurements()}function wM(t){t.isLayoutDirty=!1}function bke(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function xM(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function vke(t){t.resolveTargetDelta()}function Eke(t){t.calcProjection()}function Cke(t){t.resetSkewAndRotation()}function Nke(t){t.removeLeadSnapshot()}function bM(t,e,n){t.translate=Gn(e.translate,0,n),t.scale=Gn(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function vM(t,e,n,r){t.min=Gn(e.min,n.min,r),t.max=Gn(e.max,n.max,r)}function Ake(t,e,n,r){vM(t.x,e.x,n.x,r),vM(t.y,e.y,n.y,r)}function Ske(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Tke={duration:.45,ease:[.4,0,.1,1]},EM=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),CM=EM("applewebkit/")&&!EM("chrome/")?Math.round:Po;function NM(t){t.min=CM(t.min),t.max=CM(t.max)}function _ke(t){NM(t.x),NM(t.y)}function EV(t,e,n){return t==="position"||t==="preserve-aspect"&&!O_e(mM(e),mM(n),.2)}function kke(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const Ike=vV({attachResizeListener:(t,e)=>Nx(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),HS={current:void 0},CV=vV({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!HS.current){const t=new Ike({});t.mount(window),t.setOptions({layoutScroll:!0}),HS.current=t}return HS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Rke={pan:{Feature:Y_e},drag:{Feature:G_e,ProjectionNode:CV,MeasureLayout:mV}};function AM(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&Vn.postRender(()=>i(e,mb(e)))}class jke extends Cu{mount(){const{current:e}=this.node;e&&(this.unmount=X2e(e,(n,r)=>(AM(this.node,r,"Start"),s=>AM(this.node,s,"End"))))}unmount(){}}class Pke extends Cu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hb(Nx(this.node.current,"focus",()=>this.onFocus()),Nx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function SM(t,e,n){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&Vn.postRender(()=>i(e,mb(e)))}class Oke extends Cu{mount(){const{current:e}=this.node;e&&(this.unmount=rTe(e,(n,r)=>(SM(this.node,r,"Start"),(s,{success:i})=>SM(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const fk=new WeakMap,VS=new WeakMap,Dke=t=>{const e=fk.get(t.target);e&&e(t)},Mke=t=>{t.forEach(Dke)};function Uke({root:t,...e}){const n=t||document;VS.has(n)||VS.set(n,{});const r=VS.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Mke,{root:t,...e})),r[s]}function Lke(t,e,n){const r=Uke(e);return fk.set(t,n),r.observe(t),()=>{fk.delete(t),r.unobserve(t)}}const Bke={some:0,all:1};class $ke extends Cu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Bke[s]},a=l=>{const{isIntersecting:d}=l;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=d?u:h;f&&f(l)};return Lke(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Fke(e,n))&&this.startObserver()}unmount(){}}function Fke({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const zke={inView:{Feature:$ke},tap:{Feature:Oke},focus:{Feature:Pke},hover:{Feature:jke}},Hke={layout:{ProjectionNode:CV,MeasureLayout:mV}},Vke={...__e,...zke,...Rke,...Hke},ee=VTe(Vke,r_e),nh=class nh{constructor(){}static getInstance(){return nh.instance||(nh.instance=new nh),nh.instance}isWebRTCSupported(){try{const e=!!(window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection),n=!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),r=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia),s=!!(window.RTCSessionDescription||window.webkitRTCSessionDescription),i=!!(window.RTCIceCandidate||window.webkitRTCIceCandidate),o=/Chrome/.test(navigator.userAgent)&&/Mobile/.test(navigator.userAgent),a={hasRTCPeerConnection:e,hasMediaDevices:n,hasGetUserMedia:r,hasRTCSessionDescription:s,hasRTCIceCandidate:i,isMobileChrome:o,userAgent:navigator.userAgent,isSecureContext:this.isSecureContext()};return console.log("WebRTC Support Check:",a),o?e&&(n||r):e&&s&&i&&(n||r)}catch(e){return console.error("WebRTC support check failed:",e),!1}}isSecureContext(){const e=location.hostname,n=e==="localhost"||e==="127.0.0.1"||e.startsWith("192.168.")||e.startsWith("10.")||e.startsWith("172.")||e.endsWith(".local")||e==="0.0.0.0"||/^\d+\.\d+\.\d+\.\d+$/.test(e),r=location.protocol==="https:"||n;return console.log(" Security Context Check:",{hostname:e,protocol:location.protocol,isLocalNetwork:n,isSecure:r,userAgent:navigator.userAgent}),r}async checkMicrophonePermission(){try{if("permissions"in navigator){const e=await navigator.permissions.query({name:"microphone"});return{granted:e.state==="granted",denied:e.state==="denied",prompt:e.state==="prompt"}}try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(n=>n.stop()),{granted:!0,denied:!1,prompt:!1}}catch(e){const n=e;return n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone permission was denied"}:n.name==="NotFoundError"?{granted:!1,denied:!0,prompt:!1,error:"No microphone found on this device"}:{granted:!1,denied:!1,prompt:!0,error:n.message}}}catch{return{granted:!1,denied:!1,prompt:!0,error:"Unable to check microphone permission"}}}async requestMicrophonePermission(){try{return this.isWebRTCSupported()?this.isSecureContext()?((await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})).getTracks().forEach(n=>n.stop()),{granted:!0,denied:!1,prompt:!1}):{granted:!1,denied:!0,prompt:!1,error:"Microphone access requires HTTPS. Please use a secure connection."}:{granted:!1,denied:!0,prompt:!1,error:"WebRTC is not supported in this browser. Please use Chrome, Firefox, Safari, or Edge."}}catch(e){const n=e;return console.error("Microphone permission error:",n),n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone permission was denied. Please allow microphone access and try again."}:n.name==="NotFoundError"?{granted:!1,denied:!0,prompt:!1,error:"No microphone found. Please connect a microphone and try again."}:n.name==="NotReadableError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone is already in use by another application."}:n.name==="OverconstrainedError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone does not meet the required constraints."}:n.name==="SecurityError"?{granted:!1,denied:!0,prompt:!1,error:"Microphone access blocked due to security restrictions."}:{granted:!1,denied:!1,prompt:!0,error:`Microphone access failed: ${n.message}`}}}getPermissionErrorMessage(e){return e.error?e.error:e.denied?"Microphone permission is required for voice calls. Please enable microphone access in your browser settings.":e.prompt?"Please allow microphone access when prompted to enable voice calls.":"Unknown permission error occurred."}getPermissionInstructions(){const e=navigator.userAgent.toLowerCase();return e.includes("chrome")?"Chrome: Click the microphone icon in the address bar, or go to Settings > Privacy and Security > Site Settings > Microphone.":e.includes("firefox")?"Firefox: Click the microphone icon in the address bar, or go to Preferences > Privacy & Security > Permissions > Microphone.":e.includes("safari")?"Safari: Go to Preferences > Websites > Microphone, and allow access for this site.":e.includes("edge")?"Edge: Click the microphone icon in the address bar, or go to Settings > Cookies and site permissions > Microphone.":"Please check your browser settings to allow microphone access for this website."}};q(nh,"instance");let pk=nh;const zy=pk.getInstance(),Wke=({isOpen:t,onClose:e})=>{const[n,r]=A.useState(!1),s=window.location.origin,i=async()=>{try{await navigator.clipboard.writeText(s),r(!0),setTimeout(()=>r(!1),2e3)}catch(o){console.error("Failed to copy URL:",o)}};return t?c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 border border-white/20",onClick:o=>o.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx("div",{className:"p-2 bg-yellow-600 rounded-lg",children:c.jsx(Jd,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-white",children:"Local Network Access"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Microphone permission setup"})]})]}),c.jsxs("div",{className:"space-y-4 mb-6",children:[c.jsx("div",{className:"p-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:c.jsxs("p",{className:"text-yellow-200 text-sm",children:[c.jsx("strong",{children:"Issue:"})," Browsers require special permission for local network IP addresses to access microphone."]})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h4",{className:"text-white font-medium",children:"Solution Options:"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"1"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white text-sm font-medium",children:"Use localhost instead"}),c.jsxs("p",{className:"text-gray-400 text-xs",children:["Access via: ",c.jsx("code",{className:"bg-slate-700 px-1 rounded",children:"https://localhost:5000"})," (HTTPS enabled)"]})]})]}),c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"2"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white text-sm font-medium",children:"Enable microphone for this IP"}),c.jsx("p",{className:"text-gray-400 text-xs",children:"In Chrome: Settings  Privacy  Site Settings  Microphone"})]})]}),c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"3"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white text-sm font-medium",children:"Use Chrome flags (Advanced)"}),c.jsxs("p",{className:"text-gray-400 text-xs",children:["Enable: ",c.jsx("code",{className:"bg-slate-700 px-1 rounded",children:"--unsafely-treat-insecure-origin-as-secure"})]})]})]})]})]}),c.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg",children:[c.jsx("p",{className:"text-gray-300 text-sm mb-2",children:"Current URL:"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("code",{className:"flex-1 bg-slate-800 px-2 py-1 rounded text-xs text-gray-300 break-all",children:s}),c.jsx("button",{onClick:i,className:"p-2 bg-slate-600 hover:bg-slate-500 rounded text-white transition-colors",title:"Copy URL",children:n?c.jsx(yI,{className:"w-4 h-4"}):c.jsx(wB,{className:"w-4 h-4"})})]})]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",children:"Got It"}),c.jsx("button",{onClick:()=>{window.location.href="https://localhost:5000"},className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Try Localhost"})]})]})}):null},NV=({isOpen:t,onClose:e,onPermissionGranted:n,onPermissionDenied:r})=>{const[s,i]=A.useState(!1),[o,a]=A.useState(null),[l,d]=A.useState(!1),u=async()=>{var f;i(!0),a(null);try{console.log(" Requesting microphone permission...");const p=await zy.checkMicrophonePermission();if(console.log(" Current microphone permission status:",p),p.granted){console.log(" Microphone permission already granted"),n();return}if(p.denied){a("Microphone permission was previously denied. Please enable it in your browser settings."),r();return}const m=await zy.requestMicrophonePermission();if(console.log(" Permission request result:",m),m.granted)console.log(" Microphone permission granted"),n();else{const g=window.location.hostname;if((g.startsWith("192.168.")||g.startsWith("10.")||g.startsWith("172."))&&((f=m.error)!=null&&f.includes("permission"))){d(!0);return}a(m.error||"Failed to get microphone permission"),r()}}catch(p){console.error(" Microphone permission error:",p),a(p.message||"Failed to request microphone permission"),r()}finally{i(!1)}},h=()=>{console.log(" User skipped microphone permission"),r()};return t?c.jsxs(Oo,{children:[c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 border border-white/20",onClick:f=>f.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:c.jsx(dg,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-white",children:"Microphone Access Required"}),c.jsx("p",{className:"text-sm text-gray-400",children:"For voice calls"})]})]}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:c.jsx(an,{className:"w-5 h-5 text-gray-400"})})]}),c.jsxs("div",{className:"space-y-4 mb-6",children:[c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(qt,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Why do we need microphone access?"}),c.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"To enable voice calls between traders, we need access to your microphone. This allows you to communicate directly with other users during P2P transactions."})]})]}),c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(kt,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-medium",children:"Your privacy is protected"}),c.jsxs("p",{className:"text-gray-300 text-sm mt-1",children:[" Audio is only transmitted during active calls",c.jsx("br",{})," No recording or storage of conversations",c.jsx("br",{})," You can revoke permission anytime in browser settings"]})]})]}),o&&c.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-900/20 border border-red-500/30 rounded-lg",children:[c.jsx(qt,{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-red-400 font-medium",children:"Permission Error"}),c.jsx("p",{className:"text-red-300 text-sm mt-1",children:o})]})]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:h,className:"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors",disabled:s,children:"Listen Only"}),c.jsx("button",{onClick:u,disabled:s,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-600/50 text-white rounded-lg font-medium transition-colors flex items-center justify-center space-x-2",children:s?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),c.jsx("span",{children:"Requesting..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(dg,{className:"w-4 h-4"}),c.jsx("span",{children:"Allow Microphone"})]})})]}),c.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg",children:[c.jsxs("p",{className:"text-xs text-gray-400 text-center",children:[" ",c.jsx("strong",{children:"Listen Only:"})," You can join the call without microphone to hear the other person"]}),c.jsxs("p",{className:"text-xs text-gray-400 text-center mt-1",children:[" ",c.jsx("strong",{children:"Full Access:"})," Allow microphone to speak and listen"]}),window.location.hostname!=="localhost"&&!window.location.protocol.includes("https")&&c.jsxs("p",{className:"text-xs text-yellow-400 text-center mt-2",children:[" ",c.jsx("strong",{children:"Local Network:"})," For local network access, you may need to enable microphone permissions in your browser settings for this IP address"]})]})]})}),c.jsx(Wke,{isOpen:l,onClose:()=>d(!1)})]}):null},wj=({isOpen:t,callerAddress:e,callerName:n,ad:r,callId:s,onAccept:i,onReject:o,onClose:a})=>{const[l,d]=A.useState(!1),[u,h]=A.useState(30),[f,p]=A.useState(!1),[m,g]=A.useState(!1);A.useEffect(()=>{if(t&&u>0){const E=setInterval(()=>{h(R=>R<=1?(b(),0):R-1)},1e3);return()=>clearInterval(E)}},[t,u]);const w=async()=>{d(!0);try{console.log(" IncomingCallModal: Accepting call with callId:",s),i()}catch(E){console.error("Failed to accept call:",E);const R=(E==null?void 0:E.message)||"Failed to accept call";if(R.includes("Microphone permission required")){console.log(" Microphone permission required for answering call, showing permission modal"),p(!0),d(!1);return}D.error(R),o()}finally{d(!1)}},b=async()=>{try{const E=localStorage.getItem("authToken");E&&await fetch(`/api/calls/${s}/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}}),o(),D("Call rejected",{icon:""})}catch(E){console.error("Failed to reject call:",E),o()}},y=()=>{console.log(" Microphone permission granted, retrying call acceptance"),p(!1),w()},x=()=>{console.log(" Microphone permission denied, rejecting call"),p(!1),D.error("Microphone permission is required for voice calls"),o()},v=E=>`${E.slice(0,6)}...${E.slice(-4)}`;return c.jsxs(Oo,{children:[t&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"modal-container bg-black/95 backdrop-blur-sm flex items-center justify-center p-4 overflow-hidden",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999},children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-900 to-slate-800 rounded-2xl p-6 sm:p-8 w-full max-w-sm mx-4 border border-white/20 text-center shadow-2xl relative",style:{maxHeight:"90vh",overflowY:"auto"},children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(ug,{size:40,className:"text-white"})}),c.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Incoming Call"}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-gray-300 font-medium",children:n||v(e)}),c.jsx("p",{className:"text-gray-400 text-sm",children:v(e)}),r&&c.jsxs("p",{className:"text-blue-400 text-sm",children:["About: ",r.type," ",r.token," Ad"]})]})]}),c.jsx("div",{className:"mb-6",children:c.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[c.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full animate-pulse"}),c.jsxs("span",{className:"text-red-400 text-sm font-medium",children:[u,"s remaining"]})]})}),m?c.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-4",children:[c.jsx("div",{className:"animate-pulse",children:c.jsx("div",{className:"w-20 h-20 sm:w-16 sm:h-16 rounded-full bg-green-500/20 border-2 border-green-500 flex items-center justify-center",children:c.jsx(fn,{size:40,className:"text-green-400 sm:w-8 sm:h-8"})})}),c.jsx("p",{className:"text-green-400 text-base font-medium",children:"Connecting..."}),c.jsx("p",{className:"text-gray-400 text-xs text-center max-w-xs",children:"Please wait while we establish the connection"})]}):c.jsxs("div",{className:"flex items-center justify-center space-x-8 sm:space-x-6",children:[c.jsx(ee.button,{onClick:b,disabled:l,className:"p-5 sm:p-4 rounded-full bg-red-500 text-white shadow-lg disabled:opacity-50 min-w-[64px] min-h-[64px] sm:min-w-[56px] sm:min-h-[56px] flex items-center justify-center",whileTap:{scale:.95},whileHover:{scale:1.05},title:"Reject call",style:{touchAction:"manipulation"},children:c.jsx(Vx,{size:28,className:"sm:w-6 sm:h-6"})}),c.jsx(ee.button,{onClick:w,disabled:l,className:"p-5 sm:p-4 rounded-full bg-green-500 text-white shadow-lg disabled:opacity-50 relative min-w-[64px] min-h-[64px] sm:min-w-[56px] sm:min-h-[56px] flex items-center justify-center",whileTap:{scale:.95},whileHover:{scale:1.05},title:"Accept call",style:{touchAction:"manipulation"},children:l?c.jsx("div",{className:"animate-spin rounded-full h-7 w-7 sm:h-6 sm:w-6 border-2 border-white border-t-transparent"}):c.jsx(fn,{size:28,className:"sm:w-6 sm:h-6"})})]}),r&&c.jsxs("div",{className:"mt-6 p-4 bg-white/10 rounded-lg border border-white/20",children:[c.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Ad Details"}),c.jsxs("div",{className:"space-y-1 text-xs text-gray-300",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Type:"}),c.jsx("span",{className:r.type==="BUY"?"text-green-400":"text-red-400",children:r.type})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Token:"}),c.jsx("span",{className:"text-blue-400",children:r.token})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Price:"}),c.jsxs("span",{className:"text-yellow-400",children:["",r.priceInr]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Range:"}),c.jsxs("span",{className:"text-gray-300",children:[r.minAmount," - ",r.maxAmount," ",r.token]})]})]})]}),c.jsx("div",{className:"absolute inset-0 rounded-2xl border-2 border-blue-500/30 animate-ping pointer-events-none"})]})},"incoming-call-modal"),c.jsx(NV,{isOpen:f,onClose:()=>p(!1),onPermissionGranted:y,onPermissionDenied:x},"microphone-permission-modal")]})},rh=class rh{constructor(){q(this,"incomingCallAudio",null);q(this,"outgoingCallAudio",null);q(this,"callConnectedAudio",null);q(this,"callEndedAudio",null);q(this,"isPlaying",{});q(this,"audioContext",null);q(this,"activeOscillators",[]);this.initializeAudioElements()}static getInstance(){return rh.instance||(rh.instance=new rh),rh.instance}initializeAudioElements(){try{this.incomingCallAudio=new Audio,this.outgoingCallAudio=new Audio,this.callConnectedAudio=new Audio,this.callEndedAudio=new Audio,this.incomingCallAudio.src="/sounds/ring.mp3",this.outgoingCallAudio.src="/sounds/ring.mp3",this.incomingCallAudio.loop=!0,this.outgoingCallAudio.loop=!0,[this.incomingCallAudio,this.outgoingCallAudio,this.callConnectedAudio,this.callEndedAudio].forEach(e=>{e&&(e.volume=.7,e.preload="auto")}),this.incomingCallAudio.onerror=()=>this.createFallbackAudio("incoming"),this.outgoingCallAudio.onerror=()=>this.createFallbackAudio("outgoing")}catch(e){console.error("Failed to initialize audio elements:",e),this.createFallbackAudio("all")}}createFallbackAudio(e){console.log(`Creating fallback audio for: ${e}`),(e==="incoming"||e==="all")&&(this.incomingCallAudio=this.createBeepAudio(800,.5)),(e==="outgoing"||e==="all")&&(this.outgoingCallAudio=this.createBeepAudio(440,1))}createBeepAudio(e,n){return{play:()=>{try{const s=new(window.AudioContext||window.webkitAudioContext),i=s.createOscillator(),o=s.createGain();i.connect(o),o.connect(s.destination),i.frequency.setValueAtTime(e,s.currentTime),i.type="sine",o.gain.setValueAtTime(.3,s.currentTime),o.gain.exponentialRampToValueAtTime(.01,s.currentTime+n),i.start(s.currentTime),i.stop(s.currentTime+n)}catch{console.log("Web Audio API not available, using silent fallback")}return Promise.resolve()},pause:()=>{},currentTime:0,volume:.7,loop:!1}}async playIncomingCall(){try{this.incomingCallAudio&&(this.isPlaying.incoming=!0,await this.incomingCallAudio.play(),console.log(" Playing incoming call sound"))}catch(e){console.log("Could not play incoming call sound:",e)}}stopIncomingCall(){try{this.incomingCallAudio&&(this.isPlaying.incoming=!1,this.incomingCallAudio.pause(),this.incomingCallAudio.currentTime=0,console.log(" Stopped incoming call sound"))}catch(e){console.log("Could not stop incoming call sound:",e)}}async playOutgoingCall(){try{this.outgoingCallAudio&&(this.isPlaying.outgoing=!0,await this.outgoingCallAudio.play(),console.log(" Playing outgoing call sound"))}catch(e){console.log("Could not play outgoing call sound:",e)}}stopOutgoingCall(){try{this.outgoingCallAudio&&(this.isPlaying.outgoing=!1,this.outgoingCallAudio.pause(),this.outgoingCallAudio.currentTime=0,console.log(" Stopped outgoing call sound"))}catch(e){console.log("Could not stop outgoing call sound:",e)}}async playCallConnected(){try{this.stopAllOscillators(),this.audioContext=new(window.AudioContext||window.webkitAudioContext);const e=this.audioContext.createOscillator(),n=this.audioContext.createGain();e.connect(n),n.connect(this.audioContext.destination),e.frequency.setValueAtTime(600,this.audioContext.currentTime),e.type="sine",n.gain.setValueAtTime(.2,this.audioContext.currentTime),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),this.activeOscillators.push(e),e.start(this.audioContext.currentTime),e.stop(this.audioContext.currentTime+.3),setTimeout(()=>{this.removeOscillator(e)},300),console.log(" Playing call connected sound")}catch(e){console.log("Could not play call connected sound:",e)}}async playCallEnded(){try{this.stopAllOscillators(),this.audioContext=new(window.AudioContext||window.webkitAudioContext);const e=this.audioContext.createOscillator(),n=this.audioContext.createGain();e.connect(n),n.connect(this.audioContext.destination),e.frequency.setValueAtTime(300,this.audioContext.currentTime),e.type="sine",n.gain.setValueAtTime(.2,this.audioContext.currentTime),n.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.5),this.activeOscillators.push(e),e.start(this.audioContext.currentTime),e.stop(this.audioContext.currentTime+.5),setTimeout(()=>{this.removeOscillator(e)},500),console.log(" Playing call ended sound")}catch(e){console.log("Could not play call ended sound:",e)}}stopAllSounds(){this.stopIncomingCall(),this.stopOutgoingCall(),this.stopAllOscillators(),console.log(" Stopped all call sounds")}stopAllOscillators(){if(this.activeOscillators.forEach(e=>{try{e.stop()}catch{}}),this.activeOscillators=[],this.audioContext){try{this.audioContext.close()}catch{}this.audioContext=null}}removeOscillator(e){const n=this.activeOscillators.indexOf(e);n>-1&&this.activeOscillators.splice(n,1)}setVolume(e){const n=Math.max(0,Math.min(1,e));[this.incomingCallAudio,this.outgoingCallAudio,this.callConnectedAudio,this.callEndedAudio].forEach(r=>{r&&(r.volume=n)})}};q(rh,"instance");let mk=rh;const Cs=mk.getInstance(),qke={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.ekiga.net"},{urls:"stun:stun.ideasip.com"},{urls:"stun:stun.schlund.de"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.voipbuster.com"},{urls:"stun:stun.voipstunt.com"},{urls:"stun:stun.counterpath.com"},{urls:"stun:stun.1und1.de"},{urls:"stun:stun.gmx.net"},{urls:"stun:stun.callwithus.com"},{urls:"stun:stun.counterpath.net"},{urls:"stun:stun.1und1.de"},{urls:"stun:stun.sipgate.net"},{urls:"stun:stun.voip.aebc.com"}],iceCandidatePoolSize:10},CN=({isOpen:t,ad:e,onClose:n})=>{var it,An,nt,bn;const{user:r}=ss(),{walletAddress:s}=AC(),{address:i}=Xt(),o=(r==null?void 0:r.address)||s||i;console.log(" CallModal: Props received:",{isOpen:t,ad:!!e,user:!!r,effectiveAddress:o});const[a,l]=A.useState("initiating"),[d,u]=A.useState(!1),[h,f]=A.useState(!0),[p,m]=A.useState(0),[g,w]=A.useState(null),[b,y]=A.useState(!1),[x,v]=A.useState("disconnected"),[E,R]=A.useState(!1),[S,C]=A.useState(0),[N,T]=A.useState(!1),[$,U]=A.useState(!1),H=A.useRef(null),K=A.useRef(null),I=A.useRef(null),j=A.useRef(null),F=A.useRef(null),P=A.useRef(null),L=A.useRef(null),B=A.useRef(null),V=A.useRef(null),X=A.useRef(!1),ae=A.useRef(0),ce=A.useRef(null);A.useEffect(()=>{if(!o){console.log(" CallModal: No effective address available, skipping socket setup");return}return console.log(" CallModal: Setting up socket connection to:",Ca),console.log(" CallModal: Using address:",o),F.current=jo(Ca,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,timeout:2e4}),F.current.on("connect",()=>{console.log(" CallModal: Connected to signaling server"),F.current.emit("register",o),R(!0),console.log(" CallModal: Registered with address:",o)}),F.current.on("disconnect",()=>{console.log(" CallModal: Disconnected from signaling server"),R(!1)}),F.current.on("answer",async({answer:Fe,from:ct})=>{if(console.log(" CallModal: Received answer from",ct),P.current)try{await P.current.setRemoteDescription(new RTCSessionDescription(Fe)),await Q(),l("active"),v("connected"),ie()}catch(wt){console.error(" CallModal: Failed to set remote description:",wt)}}),F.current.on("ice-candidate",({candidate:Fe,from:ct})=>{console.log("Received ICE candidate from",ct),P.current&&Fe?(P.current.queuedCandidates||(P.current.queuedCandidates=[]),P.current.queuedCandidates.push(new RTCIceCandidate(Fe)),P.current.remoteDescription?(console.log("Processing queued ICE candidates immediately"),Q()):(console.log(" Remote description not set, queuing ICE candidate for later"),ce.current&&clearTimeout(ce.current),ce.current=setTimeout(()=>{P.current&&P.current.queuedCandidates&&(console.log(" Clearing queued ICE candidates due to timeout"),P.current.queuedCandidates=[])},1e4))):console.log(" No peer connection or candidate, ignoring ICE candidate")}),F.current.on("call-ended",({from:Fe})=>{console.log("Call ended by",Fe),Y()}),()=>{F.current&&F.current.disconnect(),L.current&&L.current.getTracks().forEach(Fe=>Fe.stop())}},[o]);const ie=()=>{j.current&&clearInterval(j.current),m(0),j.current=setInterval(()=>{m(Fe=>Fe+1)},1e3)},Te=()=>{j.current&&(clearInterval(j.current),j.current=null),m(0)},ue=Fe=>{const ct=Math.floor(Fe/60),wt=Fe%60;return`${ct.toString().padStart(2,"0")}:${wt.toString().padStart(2,"0")}`},Q=async()=>{if(!P.current||!P.current.queuedCandidates)return;console.log("Processing queued ICE candidates:",P.current.queuedCandidates.length);const Fe=[...P.current.queuedCandidates];P.current.queuedCandidates=[];for(const ct of Fe)try{P.current&&P.current.remoteDescription?(await P.current.addIceCandidate(ct),console.log(" Successfully added queued ICE candidate")):(console.log(" Remote description not set, re-queuing ICE candidate"),P.current.queuedCandidates||(P.current.queuedCandidates=[]),P.current.queuedCandidates.push(ct))}catch(wt){console.error(" Failed to add queued ICE candidate:",wt)}},xe=()=>{P.current&&(console.log("Cleaning up existing peer connection"),P.current.close(),P.current=null),console.log("Creating peer connection");const Fe=new RTCPeerConnection(qke);return Fe.onicecandidate=ct=>{ct.candidate&&B.current&&(console.log("Sending ICE candidate to",B.current),F.current.emit("ice-candidate",{candidate:ct.candidate,to:B.current}))},Fe.ontrack=ct=>{if(console.log(" Received remote track:",{kind:ct.track.kind,streamCount:ct.streams.length,trackId:ct.track.id,enabled:ct.track.enabled}),ct.streams&&ct.streams[0]&&K.current){const wt=ct.streams[0];console.log(" Setting remote audio stream:",{streamId:wt.id,trackCount:wt.getTracks().length}),K.current.srcObject=wt,K.current.play().then(()=>{console.log(" Remote audio playing successfully")}).catch(ft=>{console.error(" Audio play error:",ft),setTimeout(()=>{K.current&&K.current.srcObject&&K.current.play().catch(Rn=>{console.error(" Audio play retry failed:",Rn)})},500)})}else console.warn(" Received track but missing stream or audio element")},Fe.onconnectionstatechange=()=>{if(console.log("Connection state:",Fe.connectionState),v(Fe.connectionState),Fe.connectionState==="connected"){const ct=Fe.iceConnectionState;ct==="connected"||ct==="completed"?(l("active"),v("connected"),C(0),ie(),console.log(" Call fully connected - both connection and ICE ready"),D.success("Call connected!")):console.log(" Connection ready but ICE not ready yet:",ct)}else(Fe.connectionState==="disconnected"||Fe.connectionState==="failed")&&(console.log("Connection lost, attempting to reconnect..."),a==="active"&&S<3?(l("ringing"),C(ct=>ct+1),V.current=setTimeout(()=>{B.current&&F.current&&!N&&(console.log("Attempting to reconnect..."),P.current&&P.current.createOffer().then(ct=>{P.current.setLocalDescription(ct),F.current.emit("offer",{offer:ct,to:B.current})}).catch(ct=>{console.error("Failed to create reconnection offer:",ct),Y()}))},3e3)):(console.log("Max reconnection attempts reached, ending call"),Y()))},Fe.oniceconnectionstatechange=()=>{console.log("ICE connection state:",Fe.iceConnectionState),Fe.iceConnectionState==="connected"||Fe.iceConnectionState==="completed"?(l("active"),v("connected"),ie(),D.success("Voice connection established!")):(Fe.iceConnectionState==="disconnected"||Fe.iceConnectionState==="failed")&&console.log("ICE connection lost, connection may be unstable")},Fe};A.useEffect(()=>(t&&e&&E&&!N&&!$&&(console.log(" CallModal: Starting call to:",e.ownerAddress),setTimeout(()=>{X.current||Pe()},100)),()=>{g&&Y()}),[t,e,E]);const Pe=async()=>{if(!e||!(r!=null&&r.address)){console.log(" CallModal: Cannot initiate call - missing ad or user address");return}if(N||$||X.current){console.log(" CallModal: Call already in progress or initializing, skipping initiation");return}const Fe=Date.now();if(Fe-ae.current<2e3){console.log(" CallModal: Call attempt too soon, debouncing...");return}if(ae.current=Fe,!F.current||!E){console.log(" CallModal: Cannot initiate call - socket not connected or not registered"),console.log(" CallModal: Socket ref:",!!F.current,"Registered:",E),setTimeout(()=>{F.current&&E&&!N&&!$&&(console.log(" CallModal: Retrying call initiation"),Pe())},500);return}console.log(" CallModal: Initiating call to:",e.ownerAddress);try{X.current=!0,U(!0),T(!0),l("initiating"),B.current=e.ownerAddress;const ct=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});console.log("Got local stream"),L.current=ct,l("ringing"),P.current=xe(),ct.getAudioTracks().forEach(ft=>{P.current.addTrack(ft,ct)}),l("ringing");const wt=await P.current.createOffer();await P.current.setLocalDescription(wt),console.log(" CallModal: Sending offer to:",e.ownerAddress),F.current.emit("offer",{offer:wt,to:e.ownerAddress}),l("ringing"),console.log(" CallModal: Call status set to ringing"),I.current=setTimeout(()=>{a==="ringing"&&(l("ended"),D.error("Call not answered"),setTimeout(()=>n(),1e3))},3e4)}catch(ct){console.error("Call initiation error:",ct);const wt=ct instanceof Error?ct.message:"Failed to initiate call";if(wt.includes("Microphone permission required")){console.log(" Microphone permission required, showing permission modal"),y(!0),l("initiating");return}D.error(wt),T(!1),U(!1),X.current=!1,n()}};A.useEffect(()=>()=>{I.current&&(clearTimeout(I.current),I.current=null),j.current&&(clearInterval(j.current),j.current=null),V.current&&(clearTimeout(V.current),V.current=null),ce.current&&(clearTimeout(ce.current),ce.current=null)},[]);const Y=async()=>{try{Cs.stopAllSounds(),Te(),B.current&&F.current&&F.current.emit("end-call",{to:B.current}),P.current&&(P.current.close(),P.current=null),L.current&&(L.current.getTracks().forEach(Fe=>Fe.stop()),L.current=null)}catch(Fe){console.error("Failed to end call:",Fe)}l("ended"),m(0),w(null),v("disconnected"),T(!1),U(!1),X.current=!1,B.current=null,n()},me=()=>{console.log(" Microphone permission granted, retrying call initiation"),y(!1),Pe()},le=()=>{console.log(" Microphone permission denied, closing call modal"),y(!1),l("ended"),D.error("Microphone permission is required for voice calls"),setTimeout(()=>n(),2e3)},tt=()=>{if(L.current){const Fe=L.current.getAudioTracks()[0];Fe&&(Fe.enabled=!Fe.enabled,u(!Fe.enabled),D(d?"Microphone unmuted":"Microphone muted",{icon:d?"":""}))}},Ve=()=>{f(!h),K.current&&(K.current.volume=h?0:1),D(h?"Speaker off":"Speaker on",{icon:h?"":""})},Ue=()=>{switch(a){case"initiating":return"Connecting...";case"ringing":return"Ringing...";case"active":const Fe=ue(p);return d&&!navigator.mediaDevices?`${Fe} (Listen Only)`:Fe;case"ended":return"Call ended";default:return""}},pe=()=>{switch(a){case"initiating":return"text-yellow-400";case"ringing":return"text-blue-400";case"active":return"text-green-400";case"ended":return"text-gray-400";default:return"text-white"}};return console.log(" CallModal: Rendering with isOpen:",t,"ad:",!!e),c.jsxs(c.Fragment,{children:[c.jsxs(Oo,{children:[t&&e&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 rounded-2xl p-6 w-full max-w-md border border-white/20 text-center shadow-2xl",children:[c.jsx("button",{onClick:n,className:"absolute top-4 right-4 p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:c.jsx(an,{size:20})}),c.jsxs("div",{className:"space-y-6 mb-8",children:[c.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto shadow-lg",children:c.jsx("span",{className:"text-white font-bold text-2xl",children:((it=e.agent)==null?void 0:it.branchName.charAt(0))||"A"})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:((An=e.agent)==null?void 0:An.branchName)||"Agent"}),c.jsx("p",{className:"text-gray-300 text-sm",children:(nt=e.agent)==null?void 0:nt.city}),c.jsx("p",{className:"text-gray-400 text-xs",children:(bn=e.agent)==null?void 0:bn.mobile})]}),c.jsxs("div",{className:"bg-white/10 rounded-xl p-4 border border-white/20",children:[c.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[c.jsx(Pr,{size:16,className:"text-blue-400"}),c.jsx("span",{className:"text-blue-400 text-sm font-medium",children:"Call Status"})]}),c.jsx("p",{className:`text-lg font-semibold ${pe()}`,children:Ue()}),x!=="disconnected"&&c.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-2",children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${x==="connected"?"bg-green-500":x==="connecting"?"bg-yellow-500":"bg-red-500"}`}),c.jsx("span",{className:"text-xs text-gray-400 capitalize",children:x})]})]})]}),c.jsxs("div",{className:"space-y-4",children:[a==="active"&&c.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[c.jsx(ee.button,{onClick:tt,className:`p-4 rounded-full shadow-lg ${d?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-white/10 text-white border border-white/20"}`,whileTap:{scale:.95},whileHover:{scale:1.05},title:d?"Unmute microphone":"Mute microphone",children:d?c.jsx(uw,{size:24}):c.jsx(dg,{size:24})}),c.jsx(ee.button,{onClick:Ve,className:`p-4 rounded-full shadow-lg ${h?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-white/10 text-white border border-white/20"}`,whileTap:{scale:.95},whileHover:{scale:1.05},title:h?"Turn off speaker":"Turn on speaker",children:h?c.jsx(AB,{size:24}):c.jsx(SB,{size:24})})]}),c.jsx(ee.button,{onClick:Y,className:"p-5 rounded-full bg-red-500 text-white shadow-lg hover:bg-red-600 transition-colors",whileTap:{scale:.95},whileHover:{scale:1.05},title:"End call",children:c.jsx(Vx,{size:28})})]}),(a==="initiating"||a==="ringing")&&c.jsx("div",{className:"mt-6",children:c.jsx("div",{className:"flex justify-center space-x-1",children:[1,2,3].map(Fe=>c.jsx(ee.div,{className:"w-2 h-2 bg-blue-400 rounded-full",animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:Fe*.2}},Fe))})})]})}),c.jsx("audio",{ref:H,autoPlay:!0,muted:!0,style:{display:"none"}},"local-audio"),c.jsx("audio",{ref:K,autoPlay:!0,style:{display:"none"}},"remote-audio")]}),c.jsx(NV,{isOpen:b,onClose:()=>y(!1),onPermissionGranted:me,onPermissionDenied:le})]})};var WS={};const Kke=()=>{const t=WS.TURN_SERVER_IP||"YOUR_SERVER_IP",e=WS.TURN_USERNAME||"webrtc",n=WS.TURN_PASSWORD||"password123",r=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.voipbuster.com"}];return t!=="YOUR_SERVER_IP"?[...r,{urls:`turn:${t}:3478`,username:e,credential:n},{urls:`turn:${t}:3478?transport=tcp`,username:e,credential:n},{urls:`turn:${t}:5349?transport=tcp`,username:e,credential:n}]:[...r,{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"}]};class Gke{constructor(){q(this,"peerConnection",null);q(this,"localStream",null);q(this,"remoteStream",null);q(this,"pendingIceCandidates",[]);q(this,"callState",{isConnected:!1,isMuted:!1,isSpeakerOn:!0,callDuration:0,connectionState:"new"});q(this,"callStateCallbacks",[]);q(this,"durationInterval",null);q(this,"networkMonitorInterval",null);q(this,"iceRestartAttempts",0);q(this,"maxIceRestarts",3);q(this,"iceRestartTimeout",null);q(this,"connectionRecoveryAttempts",0);q(this,"maxConnectionRecoveryAttempts",3);q(this,"onIceCandidate",null);q(this,"onOffer",null);q(this,"onAnswer",null);this.setupPeerConnection()}setupPeerConnection(){this.peerConnection&&this.peerConnection.close();const e={iceServers:Kke(),iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};this.peerConnection=new RTCPeerConnection(e),this.peerConnection.ontrack=n=>{if(console.log(" Received remote track event:",{kind:n.track.kind,streamCount:n.streams.length,trackId:n.track.id,enabled:n.track.enabled,readyState:n.track.readyState}),n.streams&&n.streams.length>0){const r=n.streams[0];console.log(" Remote stream received:",{id:r.id,active:r.active,trackCount:r.getTracks().length}),r.getTracks().forEach((s,i)=>{console.log(` Remote track ${i}:`,{kind:s.kind,id:s.id,enabled:s.enabled,readyState:s.readyState,muted:s.muted})}),this.remoteStream=r,this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer(),console.log(" Remote stream set successfully and call state updated"),this.onRemoteStream&&this.onRemoteStream(r)}else console.warn(" Received track event without stream")},this.peerConnection.onconnectionstatechange=()=>{var r,s;const n=(r=this.peerConnection)==null?void 0:r.connectionState;if(console.log(" WebRTC Connection state changed:",n),n==="connected"){const i=(s=this.peerConnection)==null?void 0:s.iceConnectionState;i==="connected"||i==="completed"?(console.log(" WebRTC Connection established successfully!"),this.iceRestartAttempts=0,this.connectionRecoveryAttempts=0,this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer(),this.monitorNetworkQuality()):console.log(" Connection state is connected, but ICE not ready yet:",i)}else if(n==="disconnected")console.log(" WebRTC Connection disconnected (temporary - attempting recovery)"),this.connectionRecoveryAttempts>=this.maxConnectionRecoveryAttempts?(this.updateCallState({isConnected:!1,connectionState:"disconnected",callDuration:0}),this.stopCallTimer(),this.stopNetworkMonitor()):this.attemptConnectionRecovery();else if(n==="failed")if(console.log(" WebRTC Connection failed - attempting ICE restart"),this.iceRestartAttempts<this.maxIceRestarts){this.iceRestartTimeout&&clearTimeout(this.iceRestartTimeout);const i=Math.min(1e3*Math.pow(2,this.iceRestartAttempts),5e3);console.log(` Scheduling ICE restart attempt ${this.iceRestartAttempts+1}/${this.maxIceRestarts} after ${i}ms`),this.iceRestartAttempts++,this.iceRestartTimeout=setTimeout(()=>{this.restartIce()},i)}else console.error(" Max ICE restart attempts reached - connection failed"),this.updateCallState({isConnected:!1,connectionState:"failed",callDuration:0}),this.stopCallTimer(),this.stopNetworkMonitor();else n==="connecting"?(console.log(" WebRTC Connection in progress..."),this.updateCallState({connectionState:"connecting"}),setTimeout(()=>{var i;((i=this.peerConnection)==null?void 0:i.connectionState)==="connecting"&&(console.log(" WebRTC connection stuck in connecting state, forcing connection check..."),this.forceConnectionCheck())},5e3)):n==="new"&&(console.log(" WebRTC Connection in new state"),this.updateCallState({connectionState:"new"}))},this.peerConnection.oniceconnectionstatechange=()=>{var r,s;const n=(r=this.peerConnection)==null?void 0:r.iceConnectionState;if(console.log(" ICE Connection state changed:",n),n==="connected"||n==="completed"){console.log(" ICE Connection established!");const i=(s=this.peerConnection)==null?void 0:s.connectionState;i==="connected"||i==="connecting"?(this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer(),console.log(" Call fully connected - both ICE and connection state ready")):console.log(" ICE ready but connection state not ready yet:",i)}else if(n==="disconnected")console.log(" ICE Connection disconnected (temporary - may recover)");else if(n==="failed")if(console.log(" ICE Connection failed - attempting ICE restart"),this.iceRestartAttempts<this.maxIceRestarts){this.iceRestartTimeout&&clearTimeout(this.iceRestartTimeout);const i=Math.min(1e3*Math.pow(2,this.iceRestartAttempts),5e3);console.log(` Scheduling ICE restart attempt ${this.iceRestartAttempts+1}/${this.maxIceRestarts} after ${i}ms`),this.iceRestartAttempts++,this.iceRestartTimeout=setTimeout(()=>{this.restartIce()},i)}else console.error(" Max ICE restart attempts reached - ICE connection failed"),this.updateCallState({isConnected:!1,connectionState:"failed",callDuration:0}),this.stopCallTimer()},this.peerConnection.onicecandidate=n=>{var r;n.candidate?(console.log(" ICE candidate generated:",n.candidate),console.log(" Candidate type:",n.candidate.type),console.log(" Candidate protocol:",n.candidate.protocol),(r=this.onIceCandidate)==null||r.call(this,n.candidate)):console.log(" ICE candidate gathering completed (end-of-candidates indication)")},this.peerConnection.onicegatheringstatechange=()=>{var n;console.log(" ICE gathering state:",(n=this.peerConnection)==null?void 0:n.iceGatheringState)},this.peerConnection.onnegotiationneeded=async()=>{var n,r;console.log(" Negotiation needed - connection parameters changed");try{if(((n=this.peerConnection)==null?void 0:n.signalingState)==="stable"){console.log(" Creating new offer for renegotiation...");const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s),this.onOffer&&s&&(console.log(" Sending renegotiation offer via signaling"),this.onOffer(s))}else console.log(" Negotiation needed but signaling state is:",(r=this.peerConnection)==null?void 0:r.signalingState)}catch(s){console.error(" Error during negotiation:",s)}}}forceConnectionCheck(){if(this.peerConnection){const e=this.peerConnection.connectionState,n=this.peerConnection.iceConnectionState;(e==="failed"||n==="failed")&&(console.log("Connection failed, attempting recovery..."),this.restartIce())}}attemptConnectionRecovery(){if(this.connectionRecoveryAttempts>=this.maxConnectionRecoveryAttempts){console.log(" Max connection recovery attempts reached");return}this.connectionRecoveryAttempts++,console.log(` Attempting connection recovery (${this.connectionRecoveryAttempts}/${this.maxConnectionRecoveryAttempts})...`);const e=Math.min(2e3*Math.pow(2,this.connectionRecoveryAttempts-1),1e4);setTimeout(()=>{if(this.peerConnection){const n=this.peerConnection.connectionState,r=this.peerConnection.iceConnectionState;n==="failed"||r==="failed"?(this.iceRestartAttempts>=this.maxIceRestarts&&(this.iceRestartAttempts=0),this.restartIce()):n==="disconnected"&&r!=="failed"&&this.peerConnection.restartIce&&this.iceRestartAttempts<this.maxIceRestarts&&this.restartIce()}},e)}restartIce(){if(!this.peerConnection){console.warn(" Cannot restart ICE: peer connection not initialized");return}if(!this.peerConnection.restartIce){console.warn(" restartIce() not supported by browser"),this.createOfferWithIceRestart();return}console.log(` Restarting ICE (attempt ${this.iceRestartAttempts}/${this.maxIceRestarts})...`);try{this.peerConnection.restartIce(),console.log(" ICE restart initiated"),this.createOfferWithIceRestart()}catch(e){console.error(" Error restarting ICE:",e),this.createOfferWithIceRestart()}}async createOfferWithIceRestart(){var e;try{if(!this.peerConnection)return;const n=await this.peerConnection.createOffer({iceRestart:!0});await this.peerConnection.setLocalDescription(n),console.log("ICE restart offer created"),(e=this.onOffer)==null||e.call(this,n)}catch(n){console.error("Error creating ICE restart offer:",n)}}monitorNetworkQuality(){this.stopNetworkMonitor(),this.peerConnection&&(this.networkMonitorInterval=setInterval(async()=>{if(!this.peerConnection){this.stopNetworkMonitor();return}try{const e=await this.peerConnection.getStats();let n=0,r=0,s=0,i=0;if(e.forEach(o=>{o.type==="candidate-pair"&&o.state==="succeeded"?o.currentRoundTripTime&&(n+=o.currentRoundTripTime,r++,console.log("Current RTT:",o.currentRoundTripTime)):o.type==="inbound-rtp"&&o.mediaType==="audio"&&(s=o.packetsLost||0,i=o.packetsReceived||0)}),r>0){const o=n/r,a=i>0?s/(s+i)*100:0;let l="good";o>.5||a>5?l="poor":(o>.3||a>2)&&(l="fair"),this.updateCallState({networkQuality:l}),o>1&&console.warn("High latency detected:",o,"seconds")}}catch(e){console.error("Error monitoring network quality:",e)}},3e3))}stopNetworkMonitor(){this.networkMonitorInterval&&(clearInterval(this.networkMonitorInterval),this.networkMonitorInterval=null)}async initiateCall(){var e,n;try{if(this.updateCallState({connectionState:"connecting"}),this.peerConnection||(console.log("Recreating peer connection for new call"),this.setupPeerConnection()),!zy.isWebRTCSupported()){console.error("WebRTC Support Check Failed:",{RTCPeerConnection:!!window.RTCPeerConnection,webkitRTCPeerConnection:!!window.webkitRTCPeerConnection,mozRTCPeerConnection:!!window.mozRTCPeerConnection,mediaDevices:!!navigator.mediaDevices,getUserMedia:!!((e=navigator.mediaDevices)!=null&&e.getUserMedia),navigatorGetUserMedia:!!navigator.getUserMedia,userAgent:navigator.userAgent});try{new RTCPeerConnection().close(),console.log("WebRTC is actually supported, proceeding with call...")}catch(s){throw console.error("WebRTC fallback test failed:",s),new Error("WebRTC is not supported in this browser. Please use Chrome, Firefox, Safari, or Edge.")}}if(!zy.isSecureContext()){const s=window.location.hostname;throw s.startsWith("192.168.")||s.startsWith("10.")||s.startsWith("172.")?new Error("Local network access detected. Please enable microphone permissions in your browser settings for this IP address, or use localhost instead."):new Error("Voice calls require HTTPS. Please use a secure connection.")}if(console.log(" Getting microphone access..."),this.localStream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1}),console.log(" Got local stream with tracks:",this.localStream.getTracks().length),this.peerConnection||(console.log("Creating peer connection for new call"),this.setupPeerConnection()),!this.peerConnection)throw new Error("Peer connection not initialized");this.localStream.getTracks().forEach(s=>{console.log(" Adding track to peer connection:",s.kind,s.label),this.peerConnection.addTrack(s,this.localStream)}),console.log(" Tracks added to peer connection"),console.log(" Creating offer...");const r=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});await this.peerConnection.setLocalDescription(r),console.log(" Offer created and local description set"),(n=this.onOffer)==null||n.call(this,r)}catch(r){throw console.error("Error initiating call:",r),this.updateCallState({connectionState:"failed"}),r}}async prepareForIncomingCall(){try{console.log(" Preparing WebRTC service for incoming call..."),this.updateCallState({connectionState:"connecting"}),this.peerConnection||(console.log("Setting up peer connection for incoming call"),this.setupPeerConnection()),console.log(" Checking microphone permission for incoming call...");const e=await zy.checkMicrophonePermission();if(console.log(" Microphone permission status:",e),e.granted||(console.log(" Microphone permission not granted, proceeding in listen-only mode"),this.updateCallState({isMuted:!0})),e.granted)try{this.localStream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1}),console.log(" Microphone stream obtained successfully for incoming call")}catch(n){console.error("Failed to get user media:",n);const r=n;if(r.name==="NotAllowedError"||r.name==="PermissionDeniedError")console.log(" Microphone permission denied, continuing in listen-only mode"),this.localStream=null;else throw r.name==="NotFoundError"?new Error("No microphone found. Please connect a microphone and try again."):new Error(`Failed to access microphone: ${r.message}`)}else console.log(" No microphone permission, proceeding in listen-only mode"),this.localStream=null;this.localStream?this.localStream.getTracks().forEach(n=>{this.peerConnection&&this.peerConnection.addTrack(n,this.localStream)}):console.log(" No local stream available, call will be listen-only"),console.log(" WebRTC service prepared for incoming call, waiting for offer...")}catch(e){throw console.error("Error preparing for incoming call:",e),this.updateCallState({connectionState:"failed"}),e}}async answerCall(e){try{if(!e||!e.type||!e.sdp)throw new Error("Invalid offer: offer is required");if(console.log(" Answering call with offer (working pattern)"),this.updateCallState({connectionState:"connecting"}),console.log(" Getting microphone access for answering..."),this.localStream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1}),console.log(" Got local stream for answer with tracks:",this.localStream.getTracks().length),this.setupPeerConnection(),!this.peerConnection)throw new Error("Failed to create peer connection");if(this.localStream.getTracks().forEach(r=>{console.log(" Adding track to peer connection for answer:",r.kind,r.label),this.peerConnection.addTrack(r,this.localStream)}),console.log(" Tracks added to peer connection"),console.log(" Setting remote description (offer)..."),await this.peerConnection.setRemoteDescription(e),console.log(" Remote description set"),this.pendingIceCandidates.length>0){console.log(" Processing pending ICE candidates:",this.pendingIceCandidates.length);for(const r of this.pendingIceCandidates)try{await this.addIceCandidate(r)}catch(s){console.error(" Error adding pending ICE candidate:",s)}this.pendingIceCandidates=[]}console.log(" Creating answer...");const n=await this.peerConnection.createAnswer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});if(await this.peerConnection.setLocalDescription(n),console.log(" Answer created and local description set"),this.onAnswer)this.onAnswer(n);else throw new Error("onAnswer callback not set - cannot send answer")}catch(n){throw console.error(" Error answering call:",n),this.updateCallState({connectionState:"failed"}),this.localStream&&(this.localStream.getTracks().forEach(r=>r.stop()),this.localStream=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),n}}async handleAnswer(e){try{if(!this.peerConnection)throw new Error("Peer connection not initialized");if(await this.peerConnection.setRemoteDescription(e),console.log(" Answer received and set"),this.pendingIceCandidates.length>0){console.log(" Processing pending ICE candidates after answer:",this.pendingIceCandidates.length);for(const n of this.pendingIceCandidates)try{await this.addIceCandidate(n)}catch(r){console.error(" Error adding pending ICE candidate after answer:",r)}this.pendingIceCandidates=[]}}catch(n){throw console.error(" Error handling answer:",n),n}}async handleOffer(e){var n;try{if(console.log(" handleOffer called with offer:",e),!e.type||!e.sdp)throw console.error(" Invalid offer format in handleOffer:",e),new Error("Invalid offer format: missing type or sdp");if(this.peerConnection||(console.log(" Peer connection not ready, preparing for incoming call..."),await this.prepareForIncomingCall()),!this.peerConnection)throw new Error("Failed to initialize peer connection");if(console.log(" Setting remote offer description in handleOffer..."),await this.peerConnection.setRemoteDescription(e),console.log(" Remote offer description set successfully in handleOffer"),this.pendingIceCandidates.length>0){console.log(" Processing pending ICE candidates after setting remote offer:",this.pendingIceCandidates.length);const s=[...this.pendingIceCandidates];this.pendingIceCandidates=[];for(const i of s)try{this.peerConnection&&this.peerConnection.remoteDescription?await this.addIceCandidate(i):(console.warn(" Remote description not set, re-queuing ICE candidate"),this.pendingIceCandidates.push(i))}catch(o){console.error(" Error adding pending ICE candidate in handleOffer:",o)}}const r=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(r),console.log(" Answer created and set"),this.updateCallState({isConnected:!0,connectionState:"connected"}),console.log(" Call connection established"),console.log(" Local stream after answer:",!!this.localStream),this.localStream&&console.log(" Local stream tracks:",this.localStream.getTracks().length),(n=this.onAnswer)==null||n.call(this,r)}catch(r){throw console.error("Error handling offer:",r),this.updateCallState({connectionState:"failed"}),r}}async addIceCandidate(e){var n;try{if(!e||e===null||e===void 0){console.log(" Received null/undefined ICE candidate (end-of-candidates) - ignoring per WebRTC spec");return}if(!e.candidate&&!e.sdpMid&&e.sdpMLineIndex===void 0){console.warn(" Invalid ICE candidate missing both sdpMid and sdpMLineIndex - this is a Chrome bug, ignoring");return}if(!this.peerConnection){console.warn(" Cannot add ICE candidate: peer connection not initialized"),this.pendingIceCandidates.push(e),console.log(" ICE candidate queued for later (no peer connection)");return}if(!this.peerConnection.remoteDescription){console.warn(" Cannot add ICE candidate: remote description not set yet"),this.pendingIceCandidates.push(e),console.log(" ICE candidate queued for later (remote description pending)");return}try{await this.peerConnection.addIceCandidate(e),console.log(" ICE candidate added successfully")}catch(r){if((n=r==null?void 0:r.message)!=null&&n.includes("Candidate missing values for both sdpMid and sdpMLineIndex")){console.log(" Chrome bug: Ignoring expected end-of-candidates error");return}console.error(" Error adding ICE candidate:",r)}}catch(r){console.error(" Unexpected error in addIceCandidate:",r)}}toggleMute(){var e;if(this.localStream){const n=this.localStream.getAudioTracks();n.forEach(s=>{s.enabled=!s.enabled});const r=!((e=n[0])!=null&&e.enabled);return this.updateCallState({isMuted:r}),r}return!0}toggleSpeaker(){const e=!this.callState.isSpeakerOn;return this.updateCallState({isSpeakerOn:e}),e}resetConnectionState(){this.iceRestartAttempts=0,this.connectionRecoveryAttempts=0,this.iceRestartTimeout&&(clearTimeout(this.iceRestartTimeout),this.iceRestartTimeout=null)}endCall(){console.log("Ending call"),this.resetConnectionState(),this.localStream&&(this.localStream.getTracks().forEach(e=>e.stop()),this.localStream=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.updateCallState({isConnected:!1,isMuted:!1,isSpeakerOn:!0,callDuration:0,connectionState:"disconnected"}),this.stopCallTimer()}getCallState(){return{...this.callState}}checkConnection(){var o,a;const e=!!this.localStream,n=!!this.remoteStream,r=(o=this.peerConnection)==null?void 0:o.connectionState,s=(a=this.peerConnection)==null?void 0:a.iceConnectionState;console.log(" Connection check:",{hasLocalStream:e,hasRemoteStream:n,peerConnectionState:r,iceConnectionState:s,currentState:this.callState.connectionState});const i=e&&(n||r==="connected"||s==="connected"||s==="completed");return i&&this.callState.connectionState!=="connected"&&(console.log(" Manual connection check: forcing connected state"),this.updateCallState({isConnected:!0,connectionState:"connected"}),this.startCallTimer()),i}onCallStateChange(e){this.callStateCallbacks.push(e)}offCallStateChange(e){const n=this.callStateCallbacks.indexOf(e);n>-1&&this.callStateCallbacks.splice(n,1)}getLocalStream(){return this.localStream}getRemoteStream(){return this.remoteStream}updateCallState(e){this.callState={...this.callState,...e},this.callStateCallbacks.forEach(n=>n(this.callState))}startCallTimer(){console.log(" Starting call timer..."),this.stopCallTimer(),this.durationInterval=setInterval(()=>{const e=this.callState.callDuration+1;console.log(" Call duration:",e),this.updateCallState({callDuration:e})},1e3)}stopCallTimer(){this.durationInterval&&(clearInterval(this.durationInterval),this.durationInterval=null)}static formatDuration(e){const n=Math.floor(e/60),r=e%60;return`${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}}const Sr=new Gke;class Yke{constructor(){q(this,"socket",null);q(this,"isConnected",!1);q(this,"currentCallId",null);q(this,"callHandlers",new Map);q(this,"currentUserAddress",null);q(this,"receiverAddress",null);q(this,"callerSocketId",null);q(this,"callerAddress",null);this.setupWebRTCIntegration(),this.autoConnect(),Xt.subscribe(e=>{e.address&&e.address!==this.currentUserAddress&&(this.currentUserAddress=e.address,this.socket&&this.isConnected&&this.socket.emit("join-user-room",{address:e.address}))})}autoConnect(){setTimeout(async()=>{try{await this.ensureConnection(),console.log(" Signaling service auto-connected")}catch{console.log(" Signaling service auto-connect failed, will retry when needed")}},1e3)}async ensureConnection(){if(!this.isConnected||!this.socket){console.log(" Not connected to signaling server, attempting to connect...");try{await this.connect()}catch(e){throw console.error(" Failed to connect to signaling server:",e),new Error("Unable to connect to signaling server. Please check your internet connection and try again.")}}}connect(){return new Promise((e,n)=>{try{this.socket=jo(Ca,{transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,autoConnect:!0}),this.socket.on("connect",()=>{var s;console.log("Connected to signaling server"),this.isConnected=!0;const{address:r}=Xt.getState();r&&((s=this.socket)==null||s.emit("join-user-room",{address:r}),this.currentUserAddress=r),e()}),this.socket.on("disconnect",()=>{console.log("Disconnected from signaling server"),this.isConnected=!1}),this.socket.on("error",r=>{console.error("Signaling server error:",r),n(r)}),this.socket.on("signaling-message",r=>{this.handleSignalingMessage(r)}),this.socket.on("call-initiated",r=>{console.log("Call initiated:",r),this.handleCallInitiated(r)}),this.socket.on("incoming-call",r=>{console.log(" Incoming call received:",r),r.callerAddress&&(this.callerAddress=r.callerAddress,console.log(" Stored caller address for answer:",this.callerAddress)),this.handleCallInitiated(r)}),this.socket.on("call-answered",r=>{console.log(" Call answered event received:",r),console.log(" Current call ID:",this.currentCallId),console.log(" Event call ID:",r.callId),this.handleCallAnswered(r)}),this.socket.on("call-ended",r=>{console.log("Call ended:",r),this.handleCallEnded(r)}),this.socket.on("call-rejected",r=>{console.log(" Call rejected event received:",r),this.handleCallRejected(r)}),this.socket.on("incoming-call-cleared",r=>{console.log(" Incoming call cleared:",r),this.handleCallRejected(r)}),this.socket.on("call-offer",async r=>{if(console.log(" Received call offer (immediate processing):",r),r.offer){this.callerSocketId=r.callerSocketId,r.callerAddress?(this.callerAddress=r.callerAddress,console.log(" Stored caller address from call-offer:",this.callerAddress)):r.from&&(this.callerAddress=r.from);try{console.log(" Immediately calling webrtcService.answerCall with call-offer..."),await Sr.answerCall(r.offer),console.log(" Answer created and sent via onAnswer callback")}catch(s){console.error(" Error answering call-offer:",s)}}}),this.socket.on("offer",async r=>{if(console.log(" Received offer via socket (immediate processing):",r),r.offer&&r.from){this.callerSocketId=r.from,r.callerAddress?(this.callerAddress=r.callerAddress,console.log(" Stored caller address from offer:",this.callerAddress)):r.from&&(this.callerAddress=r.from,console.log(" Using from field as caller address:",this.callerAddress));try{console.log(" Immediately calling webrtcService.answerCall with offer..."),await Sr.answerCall(r.offer),console.log(" Answer created and sent via onAnswer callback")}catch(s){console.error(" Error answering call:",s)}}}),this.socket.on("call-answer",r=>{console.log(" Received call answer:",r),r.answer&&this.handleAnswer({type:"answer",data:r.answer,from:"",to:this.currentUserAddress||"",callId:r.callId})}),this.socket.on("ice-candidate",r=>{console.log(" Received ICE candidate:",r),r.candidate&&this.handleIceCandidate({type:"ice-candidate",data:r.candidate,from:"",to:this.currentUserAddress||"",callId:r.callId})})}catch(r){console.error("Error connecting to signaling server:",r),n(r)}})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.isConnected=!1)}async initiateCall(e,n,r){const{address:s}=Xt.getState(),i=r||s;if(!i)throw new Error("Wallet not connected or caller address not provided");this.currentUserAddress=i,this.receiverAddress=e,console.log(" Stored receiverAddress for call initiation:",this.receiverAddress),console.log(" Using caller address:",i);try{const o=localStorage.getItem("authToken"),a={"Content-Type":"application/json"};o&&(a.Authorization=`Bearer ${o}`);const l=await fetch("/api/calls",{method:"POST",headers:a,body:JSON.stringify({receiver_address:e,ad_id:n,signaling_data:{callerAddress:i}})});if(!l.ok){const h=await l.json();throw new Error(h.error||"Failed to initiate call")}const u=(await l.json()).data.id.toString();return this.currentCallId=u,await this.ensureConnection(),await Sr.initiateCall(),this.socket&&(this.socket.emit("initiate-call",{callId:u,receiverAddress:e,adId:n,callerAddress:i,timestamp:Date.now()}),console.log(" Call initiation sent to:",e)),console.log("Call initiated:",u),u}catch(o){throw console.error("Error initiating call:",o),o}}async answerCall(e,n,r){console.log(" signalingService.answerCall called:",{callId:e,hasOffer:!!n,callerAddress:r}),await this.ensureConnection(),this.currentCallId=e,r&&(this.callerAddress=r,console.log(" Stored caller address in answerCall:",this.callerAddress));try{n?(console.log(" Answering call with provided offer"),await Sr.answerCall(n),console.log(" webrtcService.answerCall completed")):(console.log(' No offer provided, waiting for offer via socket.on("offer") handler...'),console.log(" Offer will be processed immediately when received")),this.socket?(console.log(" Sending call-answered notification"),this.socket.emit("answer-call",{callId:e,timestamp:Date.now()})):console.warn(" Socket not connected, cannot send call-answered notification"),console.log(" Call answered successfully:",e)}catch(s){throw console.error(" Error answering call:",s),s}}endCall(){this.currentCallId&&this.socket&&this.socket.emit("end-call",{callId:this.currentCallId,timestamp:Date.now()}),Sr.endCall(),this.currentCallId=null}handleSignalingMessage(e){switch(console.log("Received signaling message:",e),e.type){case"offer":this.handleOffer(e);break;case"answer":this.handleAnswer(e);break;case"ice-candidate":this.handleIceCandidate(e);break;default:console.log("Unknown signaling message type:",e.type)}}async handleOffer(e){try{console.log(" Handling incoming offer:",e.data),await Sr.handleOffer(e.data),console.log(" Offer handled successfully")}catch(n){console.error(" Error handling offer:",n)}}async handleAnswer(e){try{console.log(" Handling incoming answer:",e.data),await Sr.handleAnswer(e.data),console.log(" Answer handled successfully")}catch(n){console.error(" Error handling answer:",n)}}async handleIceCandidate(e){try{await Sr.addIceCandidate(e.data)}catch(n){console.error("Error handling ICE candidate:",n)}}handleCallInitiated(e){const n=this.callHandlers.get("call-initiated");n&&n({type:"call-initiated",data:e,from:e.from,to:e.to,callId:e.callId})}handleCallAnswered(e){const n=this.callHandlers.get("call-answered");n&&n({type:"call-answered",data:e,from:e.from,to:e.to,callId:e.callId})}handleCallEnded(e){const n=this.callHandlers.get("call-ended");n&&n({type:"call-ended",data:e,from:e.from,to:e.to,callId:e.callId})}handleCallRejected(e){const n=this.callHandlers.get("call-rejected");n&&n({type:"call-rejected",data:e,from:e.from,to:e.to,callId:e.callId})}setupWebRTCIntegration(){Sr.onOffer=e=>{this.currentCallId&&this.currentUserAddress&&this.receiverAddress&&this.socket&&(console.log(" Sending WebRTC offer to:",this.receiverAddress),this.socket.emit("call-offer",{receiverAddress:this.receiverAddress,offer:e,callId:this.currentCallId,callerAddress:this.currentUserAddress}))},Sr.onAnswer=e=>{var n;if(console.log(" webrtcService.onAnswer callback triggered"),console.log(" Answer details:",{type:e.type,hasSdp:!!e.sdp,sdpLength:((n=e.sdp)==null?void 0:n.length)||0,callerAddress:this.callerAddress,receiverAddress:this.receiverAddress,currentCallId:this.currentCallId}),this.socket){const r=this.callerAddress||this.receiverAddress;r?(console.log(" Sending WebRTC answer to:",r),console.log(" Emitting answer event to socket with target:",r),this.socket.emit("answer",{answer:e,to:r}),console.log(" Answer event emitted via socket"),this.currentCallId&&(console.log(" Also emitting call-answer event for compatibility"),this.socket.emit("call-answer",{answer:e,callId:this.currentCallId}))):(console.error(" Cannot send answer: no target address available"),console.error(" callerAddress:",this.callerAddress),console.error(" receiverAddress:",this.receiverAddress))}else console.error(" Cannot send answer: socket not connected")},Sr.onIceCandidate=e=>{if(!this.socket){console.warn(" Cannot send ICE candidate: socket not connected");return}const n=this.callerAddress||this.receiverAddress;if(!n){console.warn(" Cannot send ICE candidate: no target address (callerAddress or receiverAddress)"),console.warn(" Current state:",{callerAddress:this.callerAddress,receiverAddress:this.receiverAddress,callerSocketId:this.callerSocketId,currentCallId:this.currentCallId});return}console.log(" Sending ICE candidate to:",n),console.log(" Candidate details:",{type:e.type,protocol:e.protocol,address:e.address}),this.socket.emit("ice-candidate",{candidate:e,to:n,callId:this.currentCallId||void 0})}}onCallEvent(e,n){this.callHandlers.set(e,n)}isSignalingConnected(){return this.isConnected}getCurrentCallId(){return this.currentCallId}}const id=new Yke;class Qke{constructor(){q(this,"activeCall",null);q(this,"callHandlers",new Map)}async initiateCall(e,n,r,s){const{address:i}=Xt.getState(),o=(s==null?void 0:s.callerAddress)||i;if(!o)throw new Error("Wallet not connected or caller address not provided");try{const a=localStorage.getItem("authToken"),l={receiver_address:e,ad_id:r,signaling_data:{context:n,callerAddress:o,...s}};console.log(" Sending call request:",l);const d=await fetch("/api/calls",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(l)});if(!d.ok){const f=await d.json();throw new Error(f.error||"Failed to initiate call")}const h=(await d.json()).data.id.toString();return this.activeCall={callId:h,callerAddress:o,receiverAddress:e,context:n,adId:r,timestamp:Date.now()},await id.initiateCall(e,r,o),console.log(" Call initiated:",h),h}catch(a){throw console.error(" Call initiation failed:",a),a}}async answerCall(e,n){try{const r=localStorage.getItem("authToken");if(!r)throw new Error("Authentication required");if(!this.activeCall)throw new Error("No active call to answer");const s=await fetch(`/api/calls/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({status:"active",answer:n,signaling_data:{answer:n}})});if(!s.ok){const i=await s.json();throw new Error(i.error||"Failed to answer call")}await id.answerCall(e,n),console.log(" Call answered:",e),D.success("Call connected!")}catch(r){throw console.error(" Failed to answer call:",r),r}}async rejectCall(e){try{const n=localStorage.getItem("authToken");if(!n)throw new Error("Authentication required");await fetch(`/api/calls/${e}/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}}),console.log(" Call rejected:",e),D("Call rejected",{icon:""})}catch(n){throw console.error(" Failed to reject call:",n),n}}async endCall(){if(this.activeCall)try{const e=localStorage.getItem("authToken");e&&await fetch(`/api/calls/${this.activeCall.callId}/end`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),id.endCall(),console.log(" Call ended:",this.activeCall.callId),this.activeCall=null}catch(e){console.error(" Failed to end call:",e)}}getActiveCall(){return this.activeCall}async checkUserAvailability(e){try{const n=await fetch(`/api/auth/user-by-address?address=${e}`);if(n.ok){const r=await n.json();return r.success&&r.data}return!1}catch(n){return console.error("Failed to check user availability:",n),!1}}async getUserInfo(e){try{const n=await fetch(`/api/auth/user-by-address?address=${e}`);if(n.ok){const r=await n.json();if(r.success&&r.data)return{name:r.data.name,verified:r.data.verified}}return null}catch(n){return console.error("Failed to get user info:",n),null}}onCallEvent(e,n){this.callHandlers.set(e,n)}offCallEvent(e){this.callHandlers.delete(e)}emitCallEvent(e,n){const r=this.callHandlers.get(e);r&&r(n)}initialize(){id.onCallEvent("call-answered",e=>{console.log(" CallService: Received call-answered event:",e),this.emitCallEvent("call-answered",e)}),id.onCallEvent("call-ended",e=>{console.log(" CallService: Received call-ended event:",e),this.emitCallEvent("call-ended",e),this.activeCall=null}),id.onCallEvent("call-rejected",e=>{console.log(" CallService: Received call-rejected event:",e),this.emitCallEvent("call-rejected",e),this.activeCall=null}),id.onCallEvent("call-status-updated",e=>{console.log(" CallService: Received call-status-updated event:",e),e.status==="active"?this.emitCallEvent("call-answered",e):e.status==="ended"&&(this.emitCallEvent("call-ended",e),this.activeCall=null)}),console.log(" Call service initialized")}cleanup(){this.activeCall=null,this.callHandlers.clear(),console.log(" Call service cleaned up")}}const Mg=new Qke;typeof window<"u"&&Mg.initialize();const AV=A.createContext({isConnected:!1,incomingCall:null,activeCall:!1,acceptCall:()=>{},rejectCall:()=>{}}),Jke=()=>A.useContext(AV),Zke=({children:t})=>{const[e,n]=A.useState(null),[r,s]=A.useState(!1),[i,o]=A.useState(null),[a,l]=A.useState(!1),[d,u]=A.useState(null),{address:h}=Xt(),{user:f}=ss();A.useEffect(()=>(h&&f?p():m(),()=>{m()}),[h,f]);const p=()=>{if(e!=null&&e.connected)return;console.log(" Connecting to WebSocket:",Ca);const x=jo(Ca,{transports:["websocket","polling"],autoConnect:!0,timeout:1e4,reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,query:{userAddress:h}});x.on("connect",()=>{console.log(" Connected to call notification service"),s(!0),x.emit("join-user-room",{address:h}),console.log(" Joined user room for address:",h)}),x.on("disconnect",v=>{console.log(" Disconnected from call notification service:",v),s(!1)}),x.on("connect_error",v=>{console.error(" WebSocket connection error:",v),s(!1)}),x.on("incoming-call",async v=>{console.log(" Incoming call received:",v);try{let E;if(v.adId&&v.adId!=="order-call"&&!v.adId.startsWith("order-")){const S=localStorage.getItem("authToken");if(S)try{const C=await fetch(`/api/ads/${v.adId}`,{headers:{Authorization:`Bearer ${S}`}});if(C.ok){const N=await C.json();N.success&&(E=N.data)}}catch(C){console.error(" Failed to fetch ad:",C)}}let R;try{const S=await fetch(`/api/auth/user-by-address?address=${v.callerAddress}`);if(S.ok){const C=await S.json();C.success&&C.data.name&&(R=C.data.name)}}catch(S){console.error(" Could not fetch caller name:",S)}o({callId:v.callId,callerAddress:v.callerAddress,callerName:R,ad:E,timestamp:v.timestamp,offer:v.offer}),Cs.playIncomingCall(),D(" Incoming call!",{duration:5e3,position:"top-center"})}catch(E){console.error(" Error handling incoming call:",E)}}),x.on("call-offer",async v=>{console.log(" Received WebRTC offer:",v);try{o(E=>E&&E.callId===v.callId?{...E,offer:v.offer}:E)}catch(E){console.error(" Error handling offer:",E)}}),x.on("call-answer",async v=>{console.log(" Received WebRTC answer:",v);try{await Sr.handleAnswer(v.answer),console.log(" Answer processed successfully")}catch(E){console.error(" Error handling answer:",E)}}),x.on("ice-candidate",async v=>{console.log(" Received ICE candidate");try{await Sr.addIceCandidate(v.candidate)}catch(E){console.error(" Error adding ICE candidate:",E)}}),x.on("call-answered",v=>{console.log(" Call answered event received:",v),Cs.stopIncomingCall(),Cs.stopOutgoingCall(),Cs.playCallConnected(),l(!0),o(null),D.success("Call connected!")}),x.on("call-status-updated",v=>{console.log(" Call status updated:",v),v.status==="ended"?g():v.status==="active"&&(Cs.stopIncomingCall(),Cs.stopOutgoingCall(),Cs.playCallConnected(),l(!0),D.success("Call connected!"))}),x.on("call-rejected",v=>{console.log(" Call rejected:",v),g(),D.error("Call was rejected")}),x.on("call-ended",v=>{console.log(" Call ended:",v),g()}),n(x)},m=()=>{e&&(e.disconnect(),n(null),s(!1))},g=()=>{Cs.stopAllSounds(),Cs.playCallEnded(),Sr.endCall(),o(null),l(!1),u(null),D("Call ended",{icon:""})},w=async x=>{if(!i){console.error(" No incoming call to accept");return}try{console.log(" Accepting call:",x),Cs.stopIncomingCall(),await Sr.prepareForIncomingCall(),console.log(" WebRTC prepared for incoming call"),i.offer?(await Sr.answerCall(i.offer),console.log(" Call answered with offer")):(await Sr.answerCall(),console.log(" Call answered without offer")),e&&e.emit("call-answered",{callId:x,receiverAddress:h,callerAddress:i.callerAddress}),Cs.playCallConnected(),l(!0),u((i==null?void 0:i.ad)||null),o(null),D.success("Call connected!")}catch(v){console.error(" Error accepting call:",v),Cs.stopIncomingCall(),D.error("Failed to accept call"),Sr.endCall(),o(null)}},b=async x=>{try{console.log(" Rejecting call:",x),Cs.stopIncomingCall(),await Mg.rejectCall(x),e&&i&&e.emit("call-rejected",{callId:x,receiverAddress:h,callerAddress:i.callerAddress}),Cs.playCallEnded(),o(null)}catch(v){console.error(" Error rejecting call:",v),Cs.stopIncomingCall()}},y={isConnected:r,incomingCall:i,activeCall:a,acceptCall:w,rejectCall:b};return c.jsxs(AV.Provider,{value:y,children:[t,i&&c.jsx(wj,{isOpen:!!i,callerAddress:i.callerAddress,callerName:i.callerName,ad:i.ad,callId:i.callId,onAccept:()=>w(i.callId),onReject:()=>b(i.callId),onClose:()=>o(null)}),a&&c.jsx(CN,{isOpen:a,ad:d,onClose:()=>{Sr.endCall();const x=id.getCurrentCallId();x&&Mg.endCall(),e&&x&&e.emit("end-call",{callId:x}),g()}})]})},SV=CI(t=>({unreadOrdersCount:0,setUnreadOrdersCount:e=>t({unreadOrdersCount:e}),clearUnreadOrdersCount:()=>t({unreadOrdersCount:0})})),Xke="/assets/logo-BZD251q-.jpeg",eIe=({children:t})=>{const e=xu(),{incomingCall:n,isConnected:r}=Jke(),{isConnected:s,address:i}=Xt(),{user:o}=ss(),{unreadOrdersCount:a}=SV(),l=u=>e.pathname===u,d=e.pathname==="/orders";return A.useEffect(()=>{if(!document.querySelector('meta[name="viewport"]')){const f=document.createElement("meta");f.name="viewport",f.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(f)}const h=()=>{document.addEventListener("touchend",()=>{document.body.style.zoom="1"},{once:!0})};return document.addEventListener("touchstart",h),()=>{document.removeEventListener("touchstart",h)}},[]),A.useEffect(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission().then(u=>{console.log("Notification permission:",u)})},[]),A.useEffect(()=>{if(n&&"navigator"in window&&"vibrate"in navigator){const u=[500,300,500,300,500,300];return navigator.vibrate(u),()=>{navigator.vibrate(0)}}},[n]),c.jsxs("div",{className:"min-h-screen flex flex-col relative",children:[s&&c.jsx("div",{className:"fixed top-0 left-0 right-0 z-40 bg-black/10 backdrop-blur-sm",children:c.jsx("div",{className:"max-w-md mx-auto px-4 py-1",children:c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${r?"bg-green-400":"bg-gray-400"}`}),c.jsx("span",{className:"text-gray-300",children:r?"Online":"Offline"})]}),o&&c.jsxs("div",{className:"flex items-center space-x-1",children:[o.verified&&c.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-400"}),c.jsx("span",{className:"text-gray-300 truncate max-w-20",children:o.name||`${i==null?void 0:i.slice(0,6)}...${i==null?void 0:i.slice(-4)}`})]})]})})}),c.jsx("header",{className:`bg-black/20 backdrop-blur-lg border-b border-white/10 ${s?"mt-6":""}`,children:c.jsx("div",{className:"max-w-md mx-auto px-4 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("img",{src:Xke,alt:"Zotrust Logo",className:"w-12 h-12 object-contain"}),n&&c.jsxs("div",{className:"flex items-center space-x-2 animate-pulse",children:[c.jsx(fn,{size:16,className:"text-green-400"}),c.jsx("span",{className:"text-green-400 text-sm font-medium",children:"Incoming Call"})]}),c.jsx("div",{className:"text-center flex items-center justify-center",children:c.jsx("p",{className:"text-gray-300 text-sm text-center font-bold",children:"Decentralized P2P Trading Platform"})})]})})}),c.jsx("main",{className:"flex-1 overflow-auto pb-safe",children:t}),c.jsx("nav",{className:"bg-black/30 backdrop-blur-lg border-t border-white/20 pb-safe",children:c.jsx("div",{className:"w-full px-2 sm:px-4",children:c.jsxs("div",{className:"flex items-center justify-between py-2 sm:py-3 safe-area-inset-bottom",children:[c.jsxs($d,{to:"/",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 ${l("/")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[c.jsx(dQ,{size:20,className:"sm:w-5 sm:h-5"}),c.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"Home"})]}),c.jsxs($d,{to:"/p2p",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 ${l("/p2p")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[c.jsx(hg,{size:20,className:"sm:w-5 sm:h-5"}),c.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"P2P"})]}),c.jsxs($d,{to:"/orders",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 relative ${l("/orders")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[c.jsxs("div",{className:"relative",children:[c.jsx(cl,{size:20,className:"sm:w-5 sm:h-5"}),n&&c.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-2.5 h-2.5 sm:w-3 sm:h-3 bg-red-500 rounded-full animate-pulse"}),!d&&a>0&&c.jsx("div",{className:"absolute top-0 right-0 min-w-[18px] h-[18px] bg-red-500 rounded-full flex items-center justify-center px-1 translate-x-1/2 -translate-y-1/2",children:c.jsx("span",{className:"text-white text-[10px] font-bold",children:a>99?"99+":a})})]}),c.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"Orders"})]}),c.jsxs($d,{to:"/profile",className:`flex flex-col items-center space-y-0.5 py-2 px-2 sm:py-3 sm:px-4 rounded-lg transition-all duration-200 min-h-[48px] sm:min-h-[56px] touch-manipulation flex-1 relative ${l("/profile")?"text-violet-400 bg-violet-400/20 scale-105":"text-gray-400 hover:text-white hover:bg-white/10 active:bg-white/20 active:scale-95"}`,style:{touchAction:"manipulation"},children:[c.jsx(ug,{size:20,className:"sm:w-5 sm:h-5"}),c.jsx("span",{className:"text-[10px] sm:text-xs font-medium leading-tight",children:"Profile"}),(o==null?void 0:o.verified)&&c.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-green-400 rounded-full"})]})]})})})]})},N1=()=>{localStorage.removeItem("adminToken"),console.log("Cleared expired admin token")},tIe=t=>{try{const e=JSON.parse(atob(t.split(".")[1])),n=Math.floor(Date.now()/1e3);return e.exp<n}catch{return!0}},TM=()=>localStorage.getItem("adminToken"),nIe=async()=>{const t=localStorage.getItem("adminToken");if(!t)return!1;if(tIe(t))return N1(),!1;try{return(await fetch("/api/admin/test-token",{headers:{Authorization:`Bearer ${t}`}})).ok?!0:(N1(),!1)}catch{return N1(),!1}},rIe=({children:t})=>{const[e,n]=A.useState(!1),[r,s]=A.useState(!1),[i,o]=A.useState(null),[a,l]=A.useState(!1),[d,u]=A.useState(0),[h,f]=A.useState(!1),[p,m]=A.useState(0),g=Os(),w=xu(),b=A.useRef(null),y=A.useRef(null),x=A.useRef(null),v=A.useRef(null),E=A.useRef(null),R=A.useRef(null),S=A.useRef(null),C=w.pathname==="/admin/login";Lx.useEffect(()=>{C||nIe().then(B=>{B||(g("/admin/login"),D.error("Session expired. Please login again."))})},[g,C]),A.useEffect(()=>{var X;const B=window.matchMedia("(min-width: 1024px)"),V=()=>s(B.matches);return V(),(X=B.addEventListener)==null||X.call(B,"change",V),()=>{var ae;return(ae=B.removeEventListener)==null?void 0:ae.call(B,"change",V)}},[]),A.useEffect(()=>{if(C)return;console.log(" AdminLayout: Setting up socket connection for admin (ALWAYS CONNECTED)...");const B=jo(Ca,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:1/0,timeout:2e4,forceNew:!1,autoConnect:!0});let V=null,X=null;const ae=()=>{B.connected&&(console.log(" AdminLayout: Registering as ADMIN_SUPPORT (fixed address)"),B.emit("register","ADMIN_SUPPORT",!0),console.log(" AdminLayout:  Emitted register event for ADMIN_SUPPORT"))},ce=()=>{B.connected&&B.emit("check-user-status","ADMIN_SUPPORT")};B.on("connect",()=>{console.log(" AdminLayout:  Connected to socket:",B.id),console.log(" AdminLayout: Socket URL:",Ca),ae(),setTimeout(()=>{ce()},500),V=setInterval(()=>{B.connected&&(console.log(" AdminLayout: Periodic registration check..."),ae())},3e4),X=setInterval(()=>{ce()},6e4),D.success(" Connected to support call service",{duration:2e3})}),B.on("registration-confirmed",ue=>{console.log(" AdminLayout:  Registration confirmed:",ue),console.log(" AdminLayout: Admin is now in support call group")}),B.on("user-status",ue=>{console.log(" AdminLayout: User status check result:",ue),ue.userId==="ADMIN_SUPPORT"&&ue.isOnline?console.log(" AdminLayout:  Admin is registered and online in support group"):(console.warn(" AdminLayout: Admin not online, re-registering..."),ae())}),B.on("disconnect",ue=>{console.log(" AdminLayout: Disconnected from socket:",ue),console.log(" AdminLayout: Will automatically reconnect..."),V&&(clearInterval(V),V=null),X&&(clearInterval(X),X=null)}),B.on("reconnect",ue=>{console.log(" AdminLayout:  Reconnected after",ue,"attempts"),ae(),V=setInterval(()=>{B.connected&&ae()},3e4),X=setInterval(()=>{ce()},6e4)}),B.on("connect_error",ue=>{console.error(" AdminLayout: Connection error:",ue),console.log(" AdminLayout: Will retry connection automatically...")}),B.on("incoming-call",ue=>{console.log(" AdminLayout: Incoming support call:",ue),fetch(`/api/auth/user-by-address?address=${ue.callerAddress}`).then(Q=>Q.json()).then(Q=>{var Y;const xe=Q.success&&((Y=Q.data)!=null&&Y.name)?Q.data.name:void 0,Pe={...ue,callerName:xe,isAdminSupportCall:!0};o(Pe),y.current=Pe,D(" New support call incoming!",{duration:5e3,position:"top-center",icon:""})}).catch(Q=>{console.error("Error fetching caller info:",Q);const xe={...ue,isAdminSupportCall:!0};o(xe),y.current=xe,D(" New support call incoming!",{duration:5e3,position:"top-center",icon:""})})}),B.on("offer",async ue=>{var Q;if(console.log(" AdminLayout: Received offer (direct WebRTC processing):",ue),console.log(" AdminLayout: Offer data:",{hasOffer:!!ue.offer,isAdminSupportCall:ue.isAdminSupportCall,from:ue.from,callerAddress:ue.callerAddress,isCallActive:a,hasIncomingCallRef:!!y.current}),ue.offer&&(ue.isAdminSupportCall||ue.from||ue.callerAddress||S.current)){const xe=ue.callerAddress||ue.from||S.current||((Q=y.current)==null?void 0:Q.callerAddress);if(xe&&(S.current=xe,console.log(" AdminLayout: Caller address set to:",xe)),a)console.log(" AdminLayout: Call already active, answering with direct WebRTC..."),await T(ue.offer,xe);else if(y.current&&y.current.callId){console.log(" AdminLayout: IncomingCallModal still open, updating with offer");const Pe={...y.current,offer:ue.offer};o(Pe),y.current=Pe,console.log(" AdminLayout: Updated IncomingCallModal with offer")}else console.log(" AdminLayout: No modal open but received offer, auto-accepting and answering..."),l(!0),await T(ue.offer,xe)}else console.warn(" AdminLayout: Received offer but missing required data:",ue)}),B.on("ice-candidate",async ue=>{const{candidate:Q,from:xe}=ue;if(console.log(" AdminLayout: Received ICE candidate from",xe),v.current&&Q&&Q.candidate)try{await v.current.addIceCandidate(new RTCIceCandidate(Q))}catch(Pe){console.error(" Error adding ICE candidate:",Pe)}}),B.on("call-ended",ue=>{console.log(" AdminLayout: Call ended:",ue),o(null),y.current=null,I(),Mg.endCall().catch(Q=>{console.error("Error ending call via service:",Q)})}),B.on("call-connected",ue=>{console.log(" AdminLayout: Call connected:",ue),l(!0),U()}),B.on("new-chat-message",ue=>{if(console.log(" AdminLayout: New chat message notification:",ue),ue.message&&ue.message.sender_type==="user"&&(m(Q=>Q+1),w.pathname!=="/admin/chat")){const Q=ue.userAddress?`${ue.userAddress.slice(0,6)}...${ue.userAddress.slice(-4)}`:"User";D(xe=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-semibold text-white",children:" New Chat Message"}),c.jsxs("p",{className:"text-sm text-gray-200",children:["From: ",c.jsx("span",{className:"font-medium",children:Q})]}),c.jsx("p",{className:"text-xs text-gray-300 mt-1 truncate max-w-xs",children:ue.message.message&&ue.message.message.length>50?ue.message.message.substring(0,50)+"...":ue.message.message||"New message"})]}),c.jsx("button",{onClick:()=>{g("/admin/chat"),D.dismiss(xe.id)},className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition-colors",children:"View"})]}),{duration:5e3,icon:"",position:"top-right",style:{background:"#1e293b",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.1)",minWidth:"300px"}})}});const ie=async()=>{var ue;try{const Q=localStorage.getItem("adminToken")||"",xe=await fetch("/api/admin/chat/unread-count",{headers:{Authorization:`Bearer ${Q}`}});if(xe.ok){const Pe=await xe.json();m(((ue=Pe.data)==null?void 0:ue.unread_count)||0)}}catch(Q){console.error("Error fetching unread count:",Q)}};b.current=B;let Te=null;return C||(ie(),Te=setInterval(ie,3e4)),()=>{x.current&&(clearInterval(x.current),x.current=null),console.log(" AdminLayout: Cleaning up socket connection..."),V&&clearInterval(V),X&&clearInterval(X),Te&&clearInterval(Te),b.current&&(b.current.disconnect(),b.current=null)}},[C,w.pathname,g]);const N=()=>{b.current&&(b.current.disconnect(),b.current=null),N1(),g("/admin/login"),D.success("Logged out successfully")},T=async(B,V)=>{try{console.log(" AdminLayout: Handling offer with direct WebRTC for:",V),console.log(" Getting microphone access...");const X=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});console.log(" Got local stream for answer"),E.current=X;const ae={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]};v.current=new RTCPeerConnection(ae),X.getAudioTracks().forEach(ie=>{v.current.addTrack(ie,X)}),v.current.onicecandidate=ie=>{ie.candidate&&b.current&&V&&(console.log(" Sending ICE candidate to caller"),b.current.emit("ice-candidate",{candidate:ie.candidate,to:V}))},v.current.ontrack=ie=>{console.log(" Received remote track:",ie.track.kind),ie.streams&&ie.streams[0]&&R.current&&(R.current.srcObject=ie.streams[0],R.current.play().catch(Te=>{console.error(" Audio play error:",Te),setTimeout(()=>{R.current&&R.current.srcObject&&R.current.play().catch(ue=>console.error("Retry failed:",ue))},500)}))},v.current.onconnectionstatechange=()=>{var Te;const ie=(Te=v.current)==null?void 0:Te.connectionState;console.log(" AdminLayout: Connection state changed:",ie),ie==="connected"?(l(!0),U(),D.success("Call connected!")):(ie==="disconnected"||ie==="failed")&&(console.log(" AdminLayout: Call disconnected, ending call"),I())},v.current.oniceconnectionstatechange=()=>{var Te;const ie=(Te=v.current)==null?void 0:Te.iceConnectionState;console.log(" AdminLayout: ICE connection state:",ie),ie==="connected"||ie==="completed"?(l(!0),U()):(ie==="disconnected"||ie==="failed")&&console.log(" AdminLayout: ICE connection failed")},console.log(" Setting remote description..."),await v.current.setRemoteDescription(new RTCSessionDescription(B)),console.log(" Creating answer...");const ce=await v.current.createAnswer();await v.current.setLocalDescription(ce),console.log(" Sending answer to caller:",V),b.current&&V?(b.current.emit("answer",{answer:ce,to:V}),console.log(" Answer sent to",V,"connection establishing...")):(console.error(" Cannot send answer - missing socket or callerAddress"),console.error("Socket:",!!b.current,"CallerAddress:",V)),l(!0),U(),D.success("Call connected!")}catch(X){console.error(" Error handling offer with direct WebRTC:",X),D.error(X.message||"Failed to answer call"),I()}},$=async()=>{if(!(!i||!b.current))try{console.log(" Admin accepting call:",i.callId),console.log(" Incoming call data:",i),console.log(" AdminLayout: Emitting call-accepted event to backend"),b.current.emit("call-accepted",{callId:i.callId,callerAddress:i.callerAddress}),console.log(" AdminLayout: Call-accepted event sent"),o(null),y.current=null,l(!0),D.success("Call accepted, waiting for connection..."),S.current=i.callerAddress,i.offer?(console.log(" Offer already available, answering immediately with direct WebRTC..."),await T(i.offer,i.callerAddress)):(console.log(" No offer yet, waiting for caller to send offer via socket..."),console.log(" AdminLayout: Call is active, will handle offer when it arrives"))}catch(B){console.error(" Error accepting call:",B),D.error("Failed to accept call"),o(null),y.current=null,l(!1)}},U=()=>{x.current&&clearInterval(x.current),u(0),x.current=setInterval(()=>{u(B=>B+1)},1e3)},H=()=>{x.current&&(clearInterval(x.current),x.current=null),u(0)},K=B=>{const V=Math.floor(B/60),X=B%60;return`${V.toString().padStart(2,"0")}:${X.toString().padStart(2,"0")}`},I=()=>{console.log(" AdminLayout: Ending support call"),H(),v.current&&(v.current.close(),v.current=null),E.current&&(E.current.getTracks().forEach(B=>B.stop()),E.current=null),b.current&&S.current&&b.current.emit("end-call",{to:S.current}),l(!1),S.current=null,D("Call ended",{icon:""})},j=()=>{if(E.current){const B=E.current.getAudioTracks()[0];B&&(B.enabled=!B.enabled,f(!B.enabled),D(h?"Microphone unmuted":"Microphone muted",{icon:h?"":""}))}},F=async()=>{if(!i||!b.current){o(null),y.current=null;return}try{b.current.emit("call-rejected",{callId:i.callId,receiverAddress:"ADMIN_SUPPORT",callerAddress:i.callerAddress}),D("Call rejected",{icon:""})}catch(B){console.error("Error rejecting call:",B)}finally{o(null),y.current=null}},P=[{name:"Dashboard",href:"/admin",icon:hQ},{name:"Orders",href:"/admin/orders",icon:W2},{name:"Transactions",href:"/admin/transactions",icon:dw},{name:"Disputes",href:"/admin/disputes",icon:X1},{name:"Support Calls",href:"/admin/support-calls",icon:fn},{name:"Chat Support",href:"/admin/chat",icon:Qd},{name:"Agents",href:"/admin/agents",icon:hg},{name:"Locations",href:"/admin/locations",icon:lg},{name:"Reviews",href:"/admin/reviews",icon:pc},{name:"Videos",href:"/admin/videos",icon:hl},{name:"Settings",href:"/admin/settings",icon:V2}],L=B=>B==="/admin"?w.pathname==="/admin":w.pathname.startsWith(B);return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:[!r&&e&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 lg:hidden",onClick:()=>n(!1)}),c.jsxs("div",{className:"flex h-screen overflow-hidden",children:[c.jsxs(ee.div,{initial:!1,animate:r?{x:0}:{x:e?0:"-100%"},className:"fixed lg:static inset-y-0 left-0 z-50 w-64 bg-white/10 backdrop-blur-lg border-r border-white/20 flex flex-col h-full",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/20 flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg flex items-center justify-center",children:c.jsx(cf,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-bold text-white",children:"Zotrust"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Admin Panel"})]})]}),c.jsx("button",{onClick:()=>n(!1),className:"lg:hidden text-gray-400 hover:text-white transition-colors",children:c.jsx(an,{size:20})})]}),c.jsx("nav",{className:"flex-1 overflow-y-auto px-4 py-6 space-y-2",children:P.map(B=>{const V=L(B.href),X=B.name==="Chat Support";return c.jsxs(ee.button,{onClick:()=>{g(B.href),n(!1),X&&m(0)},whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full flex items-center justify-between px-4 py-3 rounded-lg text-left transition-all duration-200 relative ${V?"bg-gradient-to-r from-purple-500 to-blue-500 text-white shadow-lg":"text-gray-300 hover:bg-white/10 hover:text-white"}`,children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(B.icon,{size:20}),c.jsx("span",{className:"font-medium",children:B.name})]}),X&&p>0&&c.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full animate-pulse min-w-[20px] text-center",children:p>99?"99+":p})]},B.name)})}),a&&c.jsx("div",{className:"p-4 border-t border-white/20 flex-shrink-0",children:c.jsxs(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-500/30 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),c.jsx("span",{className:"text-green-300 text-xs font-medium",children:"Call Active"})]}),c.jsx("span",{className:"text-green-400 text-xs font-mono",children:K(d)})]}),S.current&&c.jsxs("div",{className:"text-xs text-green-400 font-mono mb-2 truncate",children:[S.current.slice(0,6),"...",S.current.slice(-4)]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ee.button,{onClick:j,className:`flex-1 p-2 rounded-lg transition-colors flex items-center justify-center ${h?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-white/10 text-green-300 hover:bg-white/20"}`,whileTap:{scale:.95},title:h?"Unmute":"Mute",children:h?c.jsx(uw,{size:16}):c.jsx(dg,{size:16})}),c.jsx(ee.button,{onClick:I,className:"flex-1 p-2 rounded-lg bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors flex items-center justify-center",whileTap:{scale:.95},title:"End Call",children:c.jsx(Vx,{size:16})})]})]})}),c.jsx("div",{className:"p-4 border-t border-white/20 flex-shrink-0",children:c.jsxs("button",{onClick:N,className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-red-400 hover:bg-red-500/10 hover:text-red-300 transition-all duration-200",children:[c.jsx(gQ,{size:20}),c.jsx("span",{className:"font-medium",children:"Logout"})]})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto",children:[c.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-40",children:c.jsx("button",{onClick:()=>n(!0),className:"bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg p-2 text-gray-400 hover:text-white transition-colors",children:c.jsx(vQ,{size:24})})}),c.jsx("main",{className:"p-4 lg:p-6 min-h-full",children:t})]})]}),i&&c.jsx(wj,{isOpen:!!i,callerAddress:i.callerAddress,callerName:i.callerName,callId:i.callId,onAccept:$,onReject:F,onClose:()=>o(null)}),c.jsx("audio",{ref:R,autoPlay:!0,style:{display:"none"}})]})},sIe=({isOpen:t,onClose:e,onWalletSelect:n})=>{var u,h,f,p;const[r,s]=A.useState(!1),i=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),o=!!window.ethereum,a=o&&((u=window.ethereum)==null?void 0:u.isMetaMask),l=o&&(((h=window.ethereum)==null?void 0:h.isTrust)||((f=window.ethereum)==null?void 0:f.isTrustWallet)||((p=window.ethereum)==null?void 0:p.isTrustWallet)||navigator.userAgent.includes("TrustWallet")||navigator.userAgent.includes("Trust Wallet"));console.log(" Wallet Detection Debug:",{isMobileDevice:i,hasEthereum:o,isMetaMask:a,isTrustWallet:l,ethereum:window.ethereum,userAgent:navigator.userAgent});const d=async m=>{s(!0);try{await n(m),e()}catch(g){console.error("Wallet connection failed:",g),D.error("Failed to connect wallet")}finally{s(!1)}};return c.jsx(Oo,{children:t&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e,children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-900 rounded-xl p-6 w-full max-w-md border border-white/20",onClick:m=>m.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Connect Wallet"}),c.jsx("button",{onClick:e,className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",disabled:r,children:c.jsx(an,{size:20})})]}),c.jsxs("div",{className:"space-y-3",children:[!i&&c.jsxs(c.Fragment,{children:[c.jsx(ee.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("metamask"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-orange-500/20 to-orange-600/20 border border-orange-500/30 rounded-lg text-left hover:from-orange-500/30 hover:to-orange-600/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center",children:c.jsx(_Q,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-white",children:"MetaMask"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Browser extension wallet"})]})]})}),c.jsx(ee.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("walletconnect"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-blue-500/20 to-blue-600/20 border border-blue-500/30 rounded-lg text-left hover:from-blue-500/30 hover:to-blue-600/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:c.jsx(sA,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-white",children:"WalletConnect"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Scan QR with mobile wallet"})]})]})})]}),i&&c.jsxs(c.Fragment,{children:[c.jsx(ee.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("metamask"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-orange-500/20 to-orange-600/20 border border-orange-500/30 rounded-lg text-left hover:from-orange-500/30 hover:to-orange-600/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center",children:c.jsx(CB,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-white",children:"MetaMask Mobile"}),c.jsx("p",{className:"text-sm text-gray-400",children:a?"Detected - Open in MetaMask app":"Open in MetaMask app"})]})]})}),c.jsx(ee.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("walletconnect"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-blue-500/20 to-cyan-500/20 border border-blue-500/30 rounded-lg text-left hover:from-blue-500/30 hover:to-cyan-500/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center",children:c.jsx(sA,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-white",children:"Trust Wallet"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Connect via WalletConnect (Universal)"})]})]})})]}),c.jsx(ee.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d("walletconnect"),disabled:r,className:"w-full p-4 bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30 rounded-lg text-left hover:from-purple-500/30 hover:to-pink-500/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:c.jsx(sA,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-white",children:"Other Wallets"}),c.jsx("p",{className:"text-sm text-gray-400",children:i?"Connect with any other wallet":"Trust Wallet, Rainbow, Coinbase & more"})]})]})})]}),r&&c.jsx("div",{className:"mt-6 text-center",children:c.jsxs("div",{className:"inline-flex items-center space-x-2 text-blue-400",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}),c.jsx("span",{className:"text-sm",children:"Connecting wallet..."})]})}),c.jsxs("div",{className:"mt-6 p-3 bg-slate-800 rounded-lg",children:[c.jsx("p",{className:"text-xs text-gray-400 text-center",children:i?"MetaMask  Trust Wallet app install ,  connect ":"Desktop  MetaMask extension install   mobile wallet  QR scan "}),i&&c.jsxs("div",{className:"bg-gray-500/10 border border-gray-500/20 rounded-lg p-3 mt-4",children:[c.jsx("p",{className:"text-xs text-gray-400 mb-2",children:" Debug Info:"}),c.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[c.jsxs("p",{children:["Mobile: ",i?"Yes":"No"]}),c.jsxs("p",{children:["Ethereum: ",o?"Detected":"Not detected"]}),c.jsxs("p",{children:["MetaMask: ",a?"Yes":"No"]}),c.jsxs("p",{children:["Trust Wallet: ",l?"Yes":"No"]}),c.jsxs("p",{children:["User Agent: ",navigator.userAgent.slice(0,50),"..."]})]})]}),c.jsx("p",{className:"text-xs text-blue-400 text-center mt-2",children:" Connection modal will open - approve in your wallet app"}),c.jsx("p",{className:"text-xs text-yellow-400 text-center mt-1",children:" Only BNB Smart Chain (BSC) network supported"}),c.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:" Connection may take up to 60 seconds"})]})]})})})},iIe=({isOpen:t,onClose:e,onReviewSubmitted:n,userAddress:r})=>{const[s,i]=A.useState(0),[o,a]=A.useState(0),[l,d]=A.useState(""),[u,h]=A.useState(!1),f=async()=>{if(s===0){D.error("Please provide a rating");return}if(!r){D.error("User address not found. Please reconnect your wallet.");return}h(!0);try{const g=localStorage.getItem("authToken")||"",w=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({reviewee_address:r,rating:s,message:l.trim()||void 0})});if(w.ok)D.success("Thank you for your feedback! Your review helps us improve."),n(),e(),i(0),d("");else{const b=await w.json();D.error(b.error||"Failed to submit review")}}catch(g){console.error("Error submitting review:",g),D.error("Failed to submit review")}finally{h(!1)}},p=()=>{u||(i(0),d(""),e())},m=(g,w)=>c.jsx("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(b=>c.jsx("button",{type:"button",onClick:()=>w(b),onMouseEnter:()=>a(b),onMouseLeave:()=>a(0),className:"focus:outline-none",children:c.jsx(pc,{size:32,className:b<=(o||g)?"text-yellow-400 fill-current":"text-gray-400"})},b))});return c.jsx(Oo,{children:t&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:p,children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:g=>g.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center",children:c.jsx(pc,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Review Our Platform"}),c.jsx("p",{className:"text-gray-400 text-sm",children:"Share your experience with Zotrust"}),c.jsx("p",{className:"text-blue-400 text-xs mt-1",children:"How was your experience on our platform?"})]})]}),c.jsx("button",{onClick:p,disabled:u,className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors disabled:opacity-50",children:c.jsx(an,{size:20})})]}),c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"How would you rate our platform?"}),c.jsxs("div",{className:"flex items-center space-x-4",children:[m(s,i),c.jsx("span",{className:"text-gray-400 text-sm",children:s>0&&`${s} star${s>1?"s":""}`})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Share your feedback (optional)"}),c.jsx("textarea",{value:l,onChange:g=>d(g.target.value),placeholder:"Tell us about your experience with Zotrust platform...",rows:4,maxLength:500,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),c.jsxs("div",{className:"flex justify-between items-center mt-2",children:[c.jsxs("p",{className:"text-gray-500 text-xs",children:[l.length,"/500 characters"]}),c.jsx("p",{className:"text-gray-500 text-xs",children:"Review will be visible after admin approval"})]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:p,disabled:u,className:"flex-1 py-3 px-4 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors disabled:opacity-50",children:"Cancel"}),c.jsx("button",{onClick:f,disabled:u||s===0,className:"flex-1 py-3 px-4 rounded-lg bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-medium hover:from-yellow-600 hover:to-orange-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),c.jsx("span",{children:"Submitting..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(pc,{size:16}),c.jsx("span",{children:"Submit Review"})]})})]})]})]})})})},oIe=()=>{const[t,e]=A.useState(!1),[n,r]=A.useState(!0),[s,i]=A.useState([]),[o,a]=A.useState(null),[l,d]=A.useState(!1),[u,h]=A.useState(!1),[f,p]=A.useState(!1),[m,g]=A.useState(!1),[w,b]=A.useState({isOpen:!1,supportUrl:""}),y=A.useRef(!1),x=A.useRef(null),{address:v,isConnected:E,balance:R,chainId:S,isConnecting:C,isUpdatingBalances:N,connectionError:T,connect:$,disconnect:U,updateBalances:H,clearError:K,switchToNetwork:I,debugWalletDetection:j,connectMetaMask:F,connectTrustWallet:P}=Xt(),{user:L,refreshUserProfile:B}=ss(),V=Os(),X=Lx.useCallback(async()=>{if(!(!E||!v)){d(!0);try{const Y=await fetch("/api/reviews/all");if(Y.ok){const le=await Y.json();i(le.data)}const me=await fetch("/api/reviews/stats/total");if(me.ok){const le=await me.json();a(le.data)}}catch(Y){console.error("Error fetching reviews:",Y)}finally{d(!1)}}},[E,v]);A.useEffect(()=>{if(E&&v){if(r(!1),x.current!==v&&!N){const me=setTimeout(()=>{console.log(" Dashboard: Fetching balances for connected wallet..."),H()},500);return x.current=v,()=>clearTimeout(me)}}else{const Y=setTimeout(()=>{r(!1)},2e3);return()=>clearTimeout(Y)}},[E,v,N,H]),A.useEffect(()=>{E&&v&&x.current!==v&&(console.log(" Dashboard: Wallet connected, refreshing user profile..."),B())},[E,v,B]),A.useEffect(()=>{E&&v?(x.current!==v||!y.current)&&(y.current=!0,x.current=v,X()):(y.current=!1,x.current=null)},[E,v,X]);const ae=async()=>{if(E)U();else if(window.ethereum){const Y=window.ethereum.isMetaMask,me=window.ethereum.isTrust||window.ethereum.isTrustWallet;try{me?await ce():Y?await ie():await ie()}catch(le){console.error("Auto-connect failed:",le),e(!0)}}else e(!0)},ce=async()=>{try{await P(),S!==56&&await I(56),D.success("Trust Wallet connected successfully!")}catch(Y){console.error("Trust Wallet connection error:",Y),D.error(Y.message||"Failed to connect Trust Wallet")}},ie=async()=>{try{await F(),S!==56&&await I(56),D.success("MetaMask connected successfully!")}catch(Y){console.error("MetaMask connection error:",Y),D.error(Y.message||"Failed to connect MetaMask")}},Te=async Y=>{try{Y==="metamask"?await ie():Y==="trustwallet"?await ce():await $(Y),e(!1)}catch(me){console.error("Wallet connection failed:",me)}},ue=()=>{E&&H(!0)},Q=()=>{K()},xe=()=>{switch(S){case 56:return"BSC Mainnet";case 1:return"Ethereum Mainnet";default:return`Network ${S}`}},Pe=()=>S===56;return n?c.jsx("div",{className:"min-h-screen flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-500"}),c.jsx("p",{className:"text-gray-300",children:"Restoring wallet..."})]})}):c.jsxs("div",{className:" space-y-4 max-w-sm mx-auto",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-2xl mt-3 font-bold text-white",children:"Zotrust"}),L&&c.jsxs("div",{className:"bg-violet-500/20 backdrop-blur-lg rounded-lg p-2 border border-violet-500/30 mt-2",children:[c.jsxs("p",{className:"text-xs text-violet-200",children:["Welcome, ",c.jsx("span",{className:"text-white font-medium",children:L.name||"User"})]}),L.verified&&c.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-1",children:[c.jsx(kt,{size:12,className:"text-violet-400"}),c.jsx("span",{className:"text-xs text-violet-400",children:"Verified"})]})]}),c.jsxs("div",{className:"mt-2 space-x-2",children:[c.jsx($d,{to:"/benefits",className:"inline-block text-[11px] text-violet-300 hover:text-violet-200 underline underline-offset-2",children:"View platform benefits"}),c.jsx("span",{className:"text-[11px] text-violet-500",children:""}),c.jsx($d,{to:"/guide",className:"inline-block text-[11px] text-violet-300 hover:text-violet-200 underline underline-offset-2",children:"User guide"}),c.jsx("span",{className:"text-[11px] text-violet-500",children:""}),c.jsx("button",{onClick:()=>g(!0),className:"inline-block text-[11px] text-violet-300 hover:text-violet-200 underline underline-offset-2",children:"Watch demo video"})]})]}),c.jsx("div",{className:"bg-gradient-to-r from-violet-500/20 to-purple-500/20 border border-violet-500/30 rounded-xl p-4",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"pr-2",children:[c.jsx("h3",{className:"text-white font-semibold text-base",children:"Why trade with Zotrust?"}),c.jsxs("ul",{className:"mt-1 text-[11px] text-violet-200 space-y-1 list-disc list-inside",children:[c.jsx("li",{children:"No bank freeze risk, no middlemen"}),c.jsx("li",{children:"Smartcontract escrow, low fees"}),c.jsxs("li",{children:[c.jsx("span",{className:"font-bold underline px-2 py-0.5 rounded-md ",children:"Cash to USDT"})," ",""," ",c.jsx("span",{className:" underline font-bold px-2 py-0.5 rounded-md",children:"USDT to Cash"}),", global access"]})]})]}),c.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[c.jsx($d,{to:"/benefits",className:"px-3 py-1 rounded-lg text-xs bg-violet-600 hover:bg-violet-700 text-white transition-colors",children:"View Benefits"}),c.jsx($d,{to:"/guide",className:"px-3 py-1 rounded-lg text-xs bg-white/10 hover:bg-white/20 text-violet-100 border border-white/10 transition-colors",children:"Read Guide"}),c.jsxs("p",{onClick:()=>g(!0),className:"px-3 py-1 rounded-lg text-center text-xs cursor-pointer bg-white/10 hover:bg-white/20 text-violet-100 border border-white/10 transition-colors",children:["Platform Guide Video ",c.jsx(hl,{className:"w-4 h-4 inline-block"})]})]})]})}),m&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:c.jsxs("div",{className:"w-full max-w-md mx-auto bg-slate-900 border border-white/10 rounded-xl overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-white/10",children:[c.jsx("h3",{className:"text-sm font-semibold text-white",children:"Platform Demo"}),c.jsx("button",{onClick:()=>g(!1),className:"text-gray-300 hover:text-white",children:c.jsx(an,{size:18})})]}),c.jsx("div",{className:"bg-black",children:c.jsx("video",{controls:!0,playsInline:!0,className:"w-full h-64 bg-black",src:"/api/videos/stream/demo"})}),c.jsxs("div",{className:"p-3 flex items-center justify-end gap-2",children:[c.jsx("a",{href:"/api/videos/stream/demo",target:"_blank",rel:"noopener noreferrer",className:"text-xs px-3 py-1 rounded-lg bg-violet-600 hover:bg-violet-700 text-white",children:"Open in new tab"}),c.jsx("button",{onClick:()=>g(!1),className:"text-xs px-3 py-1 rounded-lg bg-white/10 hover:bg-white/20 text-gray-200 border border-white/10",children:"Close"})]})]})}),E&&L&&c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:`p-3 rounded-lg border flex items-center space-x-2 ${L.verified?"bg-violet-500/20 border-violet-500/30":"bg-yellow-500/20 border-yellow-500/30"}`,children:[L.verified?c.jsx(kt,{size:16,className:"text-violet-400"}):c.jsx(qt,{size:16,className:"text-yellow-400"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:`font-medium text-sm ${L.verified?"text-violet-300":"text-yellow-300"}`,children:L.verified?"Verified":"Not Verified"}),c.jsx("p",{className:`text-xs ${L.verified?"text-violet-400":"text-yellow-400"}`,children:L.verified?"Can access P2P trading":"Complete profile to trade"})]})]}),T&&c.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Connection Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:T})]}),c.jsx("button",{onClick:Q,className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),c.jsxs("div",{className:`backdrop-blur-lg rounded-lg p-4 border ${E?"bg-gradient-to-r from-violet-500/20 to-purple-500/20 border-violet-500/30":"bg-gradient-to-r from-orange-500/20 to-red-500/20 border-orange-500/30"}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h2",{className:"text-base font-bold text-white",children:E?"Wallet Connected":"Connect Wallet"}),E&&c.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${Pe()?"bg-violet-500/20 text-violet-300":"bg-red-500/20 text-red-300"}`,children:[xe(),!Pe()&&" (Switch to BSC Mainnet)"]})]}),E?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{className:"text-gray-300 text-sm",children:["Address: ",v==null?void 0:v.slice(0,6),"...",v==null?void 0:v.slice(-4)]}),!Pe()&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:" Wrong Network"}),c.jsx("p",{className:"text-red-400 text-xs",children:S===1?"Connected to Ethereum Mainnet":S===56?"Connected to BSC Mainnet":`Connected to Network ${S}`}),c.jsx("p",{className:"text-red-400 text-xs mt-1",children:"Please switch to BSC Mainnet"})]}),c.jsx("button",{onClick:()=>I(56),className:"w-full bg-orange-500/20 hover:bg-orange-500/30 text-orange-300 py-2 px-4 rounded-lg font-medium transition-colors",children:"Switch to BSC Mainnet"})]}),c.jsx("button",{onClick:ae,className:"w-full bg-red-500/20 hover:bg-red-500/30 text-red-300 py-2 px-4 rounded-lg font-medium transition-colors",children:"Disconnect Wallet"})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-gray-300 text-sm",children:"Connect your wallet to start trading"}),window.ethereum&&c.jsxs("div",{className:"space-y-2",children:[(window.ethereum.isMetaMask||!window.ethereum.isTrust)&&c.jsx("button",{onClick:ie,disabled:C,className:"w-full bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white py-2 px-3 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center space-x-2",children:C?c.jsxs(c.Fragment,{children:[c.jsx(sr,{className:"animate-spin",size:14}),c.jsx("span",{children:"Connecting..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Connect MetaMask"})]})}),(window.ethereum.isTrust||window.ethereum.isTrustWallet)&&c.jsx("button",{onClick:ce,disabled:C,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-2 px-3 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center space-x-2",children:C?c.jsxs(c.Fragment,{children:[c.jsx(sr,{className:"animate-spin",size:14}),c.jsx("span",{children:"Connecting..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Connect Trust Wallet"})]})})]}),c.jsx("button",{onClick:ae,disabled:C,className:"w-full bg-gradient-to-r from-violet-500 to-purple-500 text-white py-2 px-3 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center space-x-2",children:C?c.jsxs(c.Fragment,{children:[c.jsx(sr,{className:"animate-spin",size:14}),c.jsx("span",{children:"Connecting..."})]}):c.jsx("span",{children:"Connect Wallet"})}),c.jsx("button",{onClick:()=>{const Y=j();console.log(" Mobile Wallet Debug Info:",Y),D.success("Debug info logged to console")},className:"w-full bg-gray-500/20 hover:bg-gray-500/30 text-gray-300 py-2 px-4 rounded-lg font-medium transition-colors text-sm",children:" Debug Wallet Detection"})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-base font-semibold text-white",children:"Balances"}),c.jsx("button",{onClick:ue,disabled:!E||N,className:"p-1.5 rounded-lg bg-violet-500/20 text-violet-300 hover:bg-violet-500/30 transition-colors disabled:opacity-50",children:c.jsx(wa,{size:14,className:N?"animate-spin":""})})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("div",{className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{className:"text-violet-200 text-xs font-medium",children:"BNB"}),c.jsx(Lb,{size:14,className:"text-violet-400"})]}),c.jsx("p",{className:"text-white font-bold text-base",children:E?`${parseFloat(R.bnb||"0").toFixed(4)}`:"0.0000"})]}),c.jsxs("div",{className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{className:"text-violet-200 text-xs font-medium",children:"USDT"}),c.jsx(Lb,{size:14,className:"text-violet-400"})]}),c.jsx("p",{className:"text-white font-bold text-base",children:E?`${parseFloat(R.usdt||"0").toFixed(4)}`:"0.0000"})]}),c.jsxs("div",{className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{className:"text-violet-200 text-xs font-medium",children:"USDC"}),c.jsx(DY,{size:14,className:"text-violet-400"})]}),c.jsx("p",{className:"text-white font-bold text-base",children:E?`${parseFloat(R.wbnb||"0").toFixed(4)}`:"0.0000"})]})]}),!E&&c.jsx("div",{className:"text-center py-1",children:c.jsx("p",{className:"text-violet-300 text-xs",children:"Connect wallet to view balances"})})]}),E&&c.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-lg space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center space-x-2",children:[c.jsx(pc,{className:"w-5 h-5 text-yellow-500 fill-yellow-500"}),c.jsx("span",{children:"Reviews"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{onClick:()=>p(!f),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${f?"bg-violet-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:f?"Approved":"All"}),c.jsxs("button",{onClick:()=>{if(!v){D.error("Please connect your wallet first");return}h(!0)},className:"bg-violet-600 hover:bg-violet-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors flex items-center space-x-1.5",children:[c.jsx(Wx,{size:14}),c.jsx("span",{children:"Add Review"})]})]})]}),o&&c.jsx("div",{className:"bg-gradient-to-r from-violet-50 to-purple-50 rounded-lg p-4 border border-violet-200",children:c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o.total_reviews}),c.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Total Reviews"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"flex justify-center items-center space-x-1 mb-1",children:Array.from({length:5},(Y,me)=>c.jsx(pc,{size:16,className:me<Math.round(parseFloat(o.average_rating))?"text-yellow-500 fill-yellow-500":"text-gray-300"},me))}),c.jsxs("div",{className:"text-sm font-semibold text-gray-800",children:[o.average_rating," / 5.0"]}),c.jsx("div",{className:"text-xs text-gray-600",children:"Average Rating"})]})]})}),c.jsx("div",{className:"max-h-96 overflow-y-auto space-y-3 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:l?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(sr,{className:"w-6 h-6 animate-spin mx-auto mb-3 text-violet-600"}),c.jsx("p",{className:"text-gray-600 text-sm",children:"Loading reviews..."})]}):s.length>0?s.filter(Y=>f?Y.is_approved:!0).filter((Y,me,le)=>{const tt=(Y.reviewer_name||"Anonymous User").toLowerCase().trim();return me===le.findIndex(Ve=>(Ve.reviewer_name||"Anonymous User").toLowerCase().trim()===tt)}).map(Y=>c.jsxs(ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[c.jsx("div",{className:"flex items-center space-x-0.5",children:Array.from({length:5},(me,le)=>c.jsx(pc,{size:14,className:le<Y.rating?"text-yellow-500 fill-yellow-500":"text-gray-300"},le))}),c.jsxs("span",{className:"text-xs font-semibold text-gray-700",children:[Y.rating,".0"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-800",children:Y.reviewer_name||"Anonymous User"}),Y.is_approved&&c.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-medium",children:" Verified"})]})]}),c.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap ml-2",children:new Date(Y.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),Y.message&&c.jsx("p",{className:"text-sm text-gray-700 leading-relaxed mt-2",children:Y.message})]},Y.id)):c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Qd,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),c.jsx("p",{className:"text-gray-700 font-medium text-sm",children:f?"No approved reviews yet":"No reviews yet"}),c.jsx("p",{className:"text-gray-500 text-xs mt-1",children:f?"Reviews are pending admin approval":"Be the first to share your experience!"})]})})]}),c.jsxs("div",{className:"bg-violet-500/20 border-violet-500/30 text-violet-300 p-3 rounded-lg border flex items-center space-x-2",children:[c.jsx(kt,{size:16,className:"text-violet-400"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-xs font-medium",children:"System: Online"}),c.jsx("p",{className:"text-xs opacity-80",children:"All services operational"})]})]}),c.jsxs("button",{onClick:()=>{if(!E||!v){D.error("Please connect your wallet first",{duration:3e3,icon:""}),e(!0);return}if(!L||!L.verified){D.error("Please complete your profile verification first",{duration:4e3,icon:""}),V("/profile");return}const me=`${window.location.origin}/support-call/${v}`;b({isOpen:!0,supportUrl:me})},className:"w-full bg-gradient-to-r from-green-500/20 to-emerald-500/20 border border-green-500/30 rounded-lg p-4 flex items-center justify-between hover:from-green-500/30 hover:to-emerald-500/30 transition-all group",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center",children:c.jsx(fn,{size:20,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-semibold text-sm",children:"Support Call"}),c.jsx("p",{className:"text-green-300 text-xs",children:!E||!v?"Connect wallet to call":!L||!L.verified?"Verify profile to call":"Get help from admin"})]})]}),c.jsx(Lb,{size:16,className:"text-green-400 group-hover:text-green-300 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]}),c.jsxs("button",{onClick:()=>{if(!E||!v){D.error("Please connect your wallet first",{duration:3e3,icon:""}),e(!0);return}V("/chat")},className:"w-full bg-gradient-to-r from-blue-500/20 to-cyan-500/20 border border-blue-500/30 rounded-lg p-4 flex items-center justify-between hover:from-blue-500/30 hover:to-cyan-500/30 transition-all group",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center",children:c.jsx(Qd,{size:20,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-white font-semibold text-sm",children:"Chat Support"}),c.jsx("p",{className:"text-blue-300 text-xs",children:!E||!v?"Connect wallet to chat":"Chat with admin support"})]})]}),c.jsx(Lb,{size:16,className:"text-blue-400 group-hover:text-blue-300 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]}),c.jsx(sIe,{isOpen:t,onClose:()=>e(!1),onWalletSelect:Te}),v&&c.jsx(iIe,{isOpen:u,onClose:()=>h(!1),onReviewSubmitted:X,userAddress:v}),w.isOpen&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>b({isOpen:!1,supportUrl:""}),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:Y=>Y.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center",children:c.jsx(fn,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Support Call"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Copy URL to Browser"})]})]}),c.jsx("button",{onClick:()=>b({isOpen:!1,supportUrl:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:c.jsx(an,{size:20})})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsx("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4",children:c.jsx("p",{className:"text-sm text-blue-300 text-center",children:"Copy and paste in browser to make support call"})}),c.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/10",children:[c.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Support Call URL"}),c.jsx("p",{id:"support-url-display",className:"text-sm font-mono text-white break-all bg-black/20 p-3 rounded border border-white/10 select-all cursor-text",style:{userSelect:"all",WebkitUserSelect:"all"},onClick:Y=>{const me=document.createRange();me.selectNodeContents(Y.currentTarget);const le=window.getSelection();le==null||le.removeAllRanges(),le==null||le.addRange(me)},children:w.supportUrl}),c.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Tap to select, then copy manually"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs(ee.button,{onClick:async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(w.supportUrl),D.success("URL copied to clipboard! Copy and paste in browser.");else{const Y=document.getElementById("support-url-display");if(Y){const me=document.createRange();me.selectNodeContents(Y);const le=window.getSelection();le==null||le.removeAllRanges(),le==null||le.addRange(me),D("URL selected! Long press to copy",{icon:"",duration:3e3})}}}catch(Y){console.error("Failed to copy:",Y);const me=document.getElementById("support-url-display");if(me){const le=document.createRange();le.selectNodeContents(me);const tt=window.getSelection();tt==null||tt.removeAllRanges(),tt==null||tt.addRange(le),D("URL selected! Long press to copy",{icon:"",duration:4e3})}else D.error("Please manually select and copy the URL")}},className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-center space-x-3 transition-all shadow-lg",whileTap:{scale:.98},children:[c.jsx(cl,{size:24}),c.jsx("span",{children:"Copy URL"})]}),c.jsx(ee.button,{onClick:()=>{const Y=document.getElementById("support-url-display");if(Y){const me=document.createRange();me.selectNodeContents(Y);const le=window.getSelection();le==null||le.removeAllRanges(),le==null||le.addRange(me),D("URL selected! Long press to copy",{icon:"",duration:3e3})}},className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},children:c.jsx("span",{children:"Select URL (Manual Copy)"})}),c.jsx(ee.a,{href:w.supportUrl,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},onClick:()=>{window.open(w.supportUrl,"_blank")},children:c.jsx("span",{children:"Open in Browser"})})]}),c.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 space-y-2",children:[c.jsx("p",{className:"text-sm text-yellow-300 text-center",children:" Copy the URL and paste it in your browser to make a support call"}),c.jsx("p",{className:"text-xs text-yellow-400 text-center",children:"If copy fails, tap the URL above to select it, then long press to copy"})]})]})]})})]})};var _M={};const aIe={chainId:56,name:"BNB Smart Chain",rpcUrl:"https://bsc-dataseed.binance.org/",blockExplorer:"https://bscscan.com"},ZE={NETWORK:aIe,API_BASE_URL:_M.VITE_API_BASE_URL||"http://localhost:3000/api",WS_URL:_M.VITE_WS_URL||(typeof window<"u"&&window.location.protocol==="https:"?"wss://localhost:5000":"ws://localhost:5000"),ACCEPT_TIMEOUT_MINUTES:5,DEFAULT_LOCK_DURATION_HOURS:1,PLATFORM_FEE_PERCENT:2};function TV(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=TV(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Zn(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=TV(t))&&(r&&(r+=" "),r+=e);return r}const cIe=({isOpen:t,onClose:e,onSuccess:n})=>{const{user:r,agents:s,fetchAgents:i}=ss(),{isConnected:o,balance:a,updateBalances:l}=Xt(),[d,u]=A.useState(!1),[h,f]=A.useState({type:"BUY",token:"USDT",priceInr:"",minAmountInr:"500",maxAmountInr:"",sellQuantity:"",buyQuantity:"",lockDurationSeconds:ZE.DEFAULT_LOCK_DURATION_HOURS*3600,selectedAgentIds:[]}),m=h.token==="USDT"?parseFloat(a.usdt||"0"):h.token==="USDC"?parseFloat(a.wbnb||"0"):0,g=s.filter(y=>{var x;return(x=r==null?void 0:r.selectedAgentIds)==null?void 0:x.includes(String(y.id))});A.useEffect(()=>{t&&(r!=null&&r.locationId)&&i(r.locationId),t&&o&&l()},[t,r==null?void 0:r.locationId,o]),A.useEffect(()=>{r!=null&&r.selectedAgentIds&&r.selectedAgentIds.length>0&&f(y=>({...y,selectedAgentIds:r.selectedAgentIds||[]}))},[r==null?void 0:r.selectedAgentIds]),A.useEffect(()=>{const y=h.type==="BUY"?h.buyQuantity:h.sellQuantity,x=h.priceInr;if(y&&x&&!isNaN(parseFloat(y))&&!isNaN(parseFloat(x))){const v=(parseFloat(y)*parseFloat(x)).toFixed(2);f(E=>({...E,maxAmountInr:v}))}},[h.buyQuantity,h.sellQuantity,h.priceInr,h.type]),A.useEffect(()=>{const y=h.maxAmountInr,x=h.priceInr;if(y&&x&&!isNaN(parseFloat(y))&&!isNaN(parseFloat(x))){const v=(parseFloat(y)/parseFloat(x)).toFixed(2);f(E=>({...E,minAmountInr:v}))}},[h.maxAmountInr,h.priceInr]),A.useEffect(()=>{f(y=>({...y,priceInr:"",minAmountInr:"500",maxAmountInr:"",sellQuantity:"",buyQuantity:""}))},[h.type,h.token]);const w=async y=>{if(y.preventDefault(),h.type==="SELL"&&!o){D.error("Please connect your wallet first to check your balance");return}if(!(r!=null&&r.verified)){D.error("Please verify your profile first");return}if(!h.selectedAgentIds||h.selectedAgentIds.length===0){D.error("Please select at least one agent");return}const x=parseFloat(h.priceInr);if(isNaN(x)||x<=0){D.error("Please enter valid price per token");return}let v,E;if(h.type==="SELL"){const S=parseFloat(h.sellQuantity);if(isNaN(S)||S<=0){D.error("Please enter valid sell quantity");return}if(S>m){D.error(`Insufficient balance. You only have ${m.toFixed(6)} ${h.token}`);return}const C=parseFloat(h.minAmountInr),N=parseFloat(h.maxAmountInr);if(isNaN(C)||C<=0||isNaN(N)||N<=0){D.error("Please enter valid min and max amounts in INR");return}if(C>N){D.error("Min amount cannot be greater than max amount");return}if(v=C/x,E=N/x,E>S){D.error(`Max amount (${E.toFixed(6)} ${h.token}) cannot exceed sell quantity (${S} ${h.token})`);return}}else{const S=parseFloat(h.buyQuantity);if(isNaN(S)||S<=0){D.error("Please enter valid buy quantity");return}const C=parseFloat(h.minAmountInr),N=parseFloat(h.maxAmountInr);if(isNaN(C)||C<=0||isNaN(N)||N<=0){D.error("Please enter valid min and max amounts in INR");return}if(C>N){D.error("Min amount cannot be greater than max amount");return}if(v=C/x,E=N/x,E>S){D.error(`Max amount (${E.toFixed(6)} ${h.token}) cannot exceed buy quantity (${S} ${h.token})`);return}}const R=localStorage.getItem("authToken");if(!R){D.error("Please login first");return}u(!0);try{const S={type:h.type,token:h.token,price_inr:x,min_amount:v,max_amount:E,sell_quantity:h.type==="SELL"?parseFloat(h.sellQuantity):null,buy_quantity:h.type==="BUY"?parseFloat(h.buyQuantity):null,lock_duration_seconds:h.lockDurationSeconds,city:(r==null?void 0:r.locationId)||"Mumbai",selected_agent_ids:h.selectedAgentIds},C=await fetch("/api/ads",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${R}`},body:JSON.stringify(S)});if(C.ok)D.success("Ad created successfully!"),n(),f({type:"BUY",token:"USDT",priceInr:"",minAmountInr:"500",maxAmountInr:"",sellQuantity:"",buyQuantity:"",lockDurationSeconds:ZE.DEFAULT_LOCK_DURATION_HOURS*3600,selectedAgentIds:(r==null?void 0:r.selectedAgentIds)||[]});else{let N="Failed to create ad";try{const T=await C.json();N=T.error||T.message||N}catch{}D.error(N)}}catch(S){console.error("Ad creation error:",S),D.error(S.message||"Failed to create ad")}finally{u(!1)}},b=(y,x)=>{f(v=>({...v,[y]:x}))};return c.jsx(Oo,{children:t&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:e,children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:Zn("bg-slate-900 rounded-xl overflow-scroll h-[80vh] p-6 w-full max-w-md border-2",h.type==="BUY"?"border-green-500/50":"border-red-500/50"),onClick:y=>y.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Create New Ad"}),c.jsx("button",{onClick:e,className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:c.jsx(an,{size:20})})]}),!(r!=null&&r.verified)&&c.jsxs("div",{className:"mb-4 p-3 bg-yellow-500/20 border border-yellow-500/30 rounded-lg flex items-center space-x-2",children:[c.jsx(qt,{size:16,className:"text-yellow-400"}),c.jsx("p",{className:"text-yellow-300 text-sm",children:"Please verify your profile to create ads"})]}),c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Type"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:["BUY","SELL"].map(y=>c.jsx("button",{type:"button",onClick:()=>b("type",y),className:Zn("py-2 px-4 rounded-lg font-medium transition-all",h.type===y?y==="BUY"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gradient-to-r from-red-500 to-pink-500 text-white":y==="BUY"?"bg-white/10 text-green-300 border border-green-500/30 hover:bg-green-500/10":"bg-white/10 text-red-300 border border-red-500/30 hover:bg-red-500/10"),children:y},y))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Token"}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:["USDT","USDC"].map(y=>c.jsx("button",{type:"button",onClick:()=>b("token",y),className:Zn("py-2 px-4 rounded-lg font-medium transition-all",h.token===y?"bg-white/20 text-white border border-white/30":"bg-white/10 text-gray-300 border border-white/20"),children:y},y))})]}),h.type==="SELL"&&c.jsx("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-purple-300 text-sm font-medium",children:" Available Balance"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-white font-bold text-lg",children:m.toFixed(6)}),c.jsx("span",{className:"text-purple-300",children:h.token}),c.jsx("button",{type:"button",onClick:()=>l(),className:"p-1 rounded bg-purple-500/20 hover:bg-purple-500/30 transition-colors",title:"Refresh balance",children:c.jsx("svg",{className:"w-3 h-3 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]})}),h.type==="SELL"&&c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-white mb-2",children:[" Quantity to Sell (",h.token,")"]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",step:"0.000001",value:h.sellQuantity,onChange:y=>b("sellQuantity",y.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-20 py-3 text-white text-lg placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"0.02",max:m,required:!0}),c.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:c.jsx("button",{type:"button",onClick:()=>b("sellQuantity",m.toString()),className:"text-blue-400 hover:text-blue-300 text-xs font-medium",children:"MAX"})})]}),c.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Available: ",m.toFixed(6)," ",h.token]}),parseFloat(h.sellQuantity)>m&&c.jsxs("p",{className:"mt-1 text-xs text-red-400",children:[" Insufficient balance! You only have ",m.toFixed(6)," ",h.token]})]}),h.type==="BUY"&&c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-white mb-2",children:[" Quantity to Buy (",h.token,")"]}),c.jsx("div",{className:"relative",children:c.jsx("input",{type:"number",step:"0.000001",value:h.buyQuantity,onChange:y=>b("buyQuantity",y.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-3 text-white text-lg placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"10.0",required:!0})})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-white mb-2",children:[" Price per 1 ",h.token]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",step:"0.01",value:h.priceInr,onChange:y=>b("priceInr",y.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-12 py-3 text-white text-lg placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"95",required:!0}),c.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 font-medium",children:" INR"})]}),c.jsxs("p",{className:"mt-1 text-xs text-gray-400",children:["Example: 1 ",h.token," = 95 INR"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:" Order Limits ( INR)"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Min  INR"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",step:"0.01",value:h.minAmountInr,onChange:y=>b("minAmountInr",y.target.value),placeholder:"500",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-8 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",required:!0}),c.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 text-xs font-medium",children:""})]}),h.priceInr&&h.minAmountInr&&c.jsxs("p",{className:"mt-1 text-xs text-green-400",children:["= ",(parseFloat(h.minAmountInr)/parseFloat(h.priceInr)).toFixed(6)," ",h.token]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Max  INR"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",step:"0.01",value:h.maxAmountInr,onChange:y=>b("maxAmountInr",y.target.value),placeholder:"5000",className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 pr-8 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",required:!0}),c.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 text-xs font-medium",children:""})]}),h.priceInr&&h.maxAmountInr&&c.jsxs("p",{className:"mt-1 text-xs text-green-400",children:["= ",(parseFloat(h.maxAmountInr)/parseFloat(h.priceInr)).toFixed(6)," ",h.token]})]})]}),h.type==="SELL"&&h.priceInr&&h.maxAmountInr&&h.sellQuantity&&(()=>{const y=parseFloat(h.maxAmountInr)/parseFloat(h.priceInr),x=parseFloat(h.sellQuantity);return y>x?c.jsxs("p",{className:"mt-2 text-xs text-yellow-400",children:[" Max limit (",y.toFixed(6)," ",h.token,") exceeds your sell quantity (",x.toFixed(6)," ",h.token,")"]}):null})(),h.type==="BUY"&&h.priceInr&&h.maxAmountInr&&h.buyQuantity&&(()=>{const y=parseFloat(h.maxAmountInr)/parseFloat(h.priceInr),x=parseFloat(h.buyQuantity);return y>x?c.jsxs("p",{className:"mt-2 text-xs text-yellow-400",children:[" Max limit (",y.toFixed(6)," ",h.token,") exceeds your buy quantity (",x.toFixed(6)," ",h.token,")"]}):null})()]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Agents (from your profile)"}),g.length===0?c.jsxs("div",{className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-gray-400",children:[c.jsx("p",{children:"No agents selected in your profile"}),c.jsx("p",{className:"text-sm",children:"Please select agents in your profile first"})]}):c.jsx("div",{className:"max-h-48 overflow-y-auto bg-white/10 border border-white/20 rounded-lg p-3 space-y-2",children:g.map(y=>{var x;return c.jsxs("label",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors",children:[c.jsx("input",{type:"checkbox",checked:((x=h.selectedAgentIds)==null?void 0:x.includes(String(y.id)))||!1,onChange:v=>{const E=String(y.id),R=h.selectedAgentIds||[];v.target.checked?b("selectedAgentIds",[...R,E]):b("selectedAgentIds",R.filter(S=>S!==E))},className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500 focus:ring-2"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-white font-medium truncate",children:y.branchName}),c.jsx("p",{className:"text-gray-300 text-sm truncate",children:y.locationName}),c.jsx("p",{className:"text-gray-400 text-xs truncate",children:y.mobile}),y.address&&c.jsx("p",{className:"text-gray-400 text-xs truncate",children:y.address})]}),c.jsx("div",{className:"flex-shrink-0",children:y.verified?c.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-400",children:" Verified"}):c.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-500/20 text-yellow-400",children:" Unverified"})})]},y.id)})}),h.selectedAgentIds&&h.selectedAgentIds.length>0&&c.jsxs("div",{className:"mt-2 p-2 bg-blue-500/20 border border-blue-500/30 rounded-lg",children:[c.jsxs("p",{className:"text-blue-300 text-sm font-medium",children:["Selected Agents (",h.selectedAgentIds.length,"):"]}),c.jsx("div",{className:"mt-1 space-y-1",children:h.selectedAgentIds.map(y=>{const x=g.find(v=>String(v.id)===y);return x?c.jsxs("p",{className:"text-blue-200 text-xs",children:[" ",x.branchName," - ",x.locationName]},y):null})})]})]}),c.jsx(ee.button,{type:"submit",disabled:d||!(r!=null&&r.verified)||!h.selectedAgentIds||h.selectedAgentIds.length===0||h.type==="SELL"&&m===0,className:Zn("w-full text-white py-3 px-4 rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed",h.type==="BUY"?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-red-500 to-pink-500"),whileTap:{scale:.98},children:d?"Creating...":h.type==="SELL"&&m===0?`No ${h.token} to Sell`:"Create Ad"})]})]})})})},lIe=()=>{const[t,e]=A.useState("BUY"),[n,r]=A.useState("USDT"),[s,i]=A.useState([]),[o,a]=A.useState(!1),[l,d]=A.useState({isOpen:!1,ad:null}),[u,h]=A.useState(!1),[f,p]=A.useState(null),[m,g]=A.useState({isOpen:!1,ad:null}),[w,b]=A.useState(""),[y,x]=A.useState(""),[v,E]=A.useState(null),[R,S]=A.useState(null),[C,N]=A.useState({buyEnabled:!0,sellEnabled:!0,startTime:"09:00",endTime:"18:00"}),{user:T,refreshUserProfile:$}=ss(),{isConnected:U,address:H,connectionError:K,clearError:I}=Xt();A.useEffect(()=>{U&&(T!=null&&T.selectedAgentIds)&&T.selectedAgentIds.length>0&&F()},[t,n,U,T==null?void 0:T.selectedAgentIds]),A.useEffect(()=>{if(!U||!(T!=null&&T.selectedAgentIds)||T.selectedAgentIds.length===0)return;const Q=setInterval(()=>{console.log(" Auto-refreshing P2P ads every 15 seconds..."),F()},15e3);return()=>clearInterval(Q)},[U,T==null?void 0:T.selectedAgentIds]),A.useEffect(()=>{U&&H&&T&&(console.log(" P2P: Wallet connected, refreshing user profile..."),$())},[U,H,$]);const j=async()=>{try{const Q=await fetch("/api/admin/trading-hours");if(Q.ok){const xe=await Q.json();xe.success&&xe.data&&N(xe.data)}}catch(Q){console.error("Error fetching trading hours:",Q)}};A.useEffect(()=>{j()},[]);const F=async()=>{h(!0),E(null);try{const Q=localStorage.getItem("authToken");if(!Q){if(U&&H&&window.ethereum){console.log(" P2P: No token but wallet connected, attempting auto-login...");try{const xe="Sign this message to authenticate with Zotrust",Pe=await window.ethereum.request({method:"personal_sign",params:[xe,H]}),{loginWithWallet:Y}=ss.getState();if(await Y(H,Pe,xe)){const le=localStorage.getItem("authToken");if(le)return P(le)}}catch(xe){console.error("Auto-login failed:",xe)}}E("Please login first"),i([]);return}await P(Q)}catch(Q){console.error("Failed to fetch ads:",Q),E("Failed to load ads"),i([])}finally{h(!1)}},P=async Q=>{try{const Pe=await fetch(`/api/ads?type=${t==="BUY"?"SELL":"BUY"}&token=${n}&limit=20`,{headers:{Authorization:`Bearer ${Q}`}});if(Pe.ok){const Y=await Pe.json();if(Y.success){let me=(Y.data||[]).map(le=>({id:le.id.toString(),ownerAddress:le.owner_address,ownerSelectedAgentIds:le.selected_agent_ids||[],owner_name:le.owner_name||"",type:le.type,token:le.token,priceInr:le.price_inr.toString(),minAmount:le.min_amount.toString(),maxAmount:le.max_amount.toString(),sellQuantity:le.sell_quantity?le.sell_quantity.toString():null,buyQuantity:le.buy_quantity?le.buy_quantity.toString():null,lockDurationSeconds:le.lock_duration_seconds,city:le.city,active:le.active,createdAt:le.created_at,agent:le.agents&&le.agents.length>0?{id:le.agents[0].id.toString(),branchName:le.agents[0].branch_name,city:le.agents[0].city||le.city||"Mumbai",address:le.agents[0].address||"",mobile:le.agents[0].mobile||"",verified:le.agents[0].verified||!0,createdByAdmin:"1",createdAt:new Date().toISOString()}:void 0,agents:le.agents?le.agents.map(tt=>({id:tt.id.toString(),branchName:tt.branch_name,city:tt.city,address:tt.address||"",mobile:tt.mobile||"",verified:tt.verified||!0,createdByAdmin:"1",createdAt:new Date().toISOString()})):[]}));H&&(me=me.filter(le=>{if(le.ownerAddress.toLowerCase()===H.toLowerCase()||!(T!=null&&T.selectedAgentIds)||T.selectedAgentIds.length===0)return!1;if(le.type==="SELL"){if(le.sellQuantity!==null&&parseFloat(le.sellQuantity)<=0)return!1}else if(le.type==="BUY"&&le.buyQuantity!==null&&parseFloat(le.buyQuantity)<=0)return!1;return!0})),i(me)}else E(Y.error||"Failed to load ads"),i([])}else Pe.status===401?E("Session expired. Please login again."):E("Failed to load ads"),i([])}catch(xe){console.error("Failed to fetch ads:",xe),E("Failed to load ads"),i([])}},L=async(Q,xe)=>{if(p(Q.id),S(null),Q.type==="BUY"&&!C.sellEnabled){S("SELL trading is currently disabled. Please try again later."),p(null);return}if(Q.type==="SELL"&&!C.buyEnabled){S("BUY trading is currently disabled. Please try again later."),p(null);return}try{const Pe=localStorage.getItem("authToken");if(!Pe){S("Please login first");return}const Y=Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Calcutta",me=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Pe}`},body:JSON.stringify({ad_id:Q.id,amount:parseFloat(xe),selected_agent_id:y,timezone:Y})});if(me.ok){const le=await me.json();le.success?(D.success("Order created successfully"),F()):S(le.error||"Failed to create order")}else{const le=await me.json();S(le.error||"Failed to create order")}}catch(Pe){console.error("Order creation error:",Pe),S("Failed to create order")}finally{p(null)}},B=Q=>{d({isOpen:!0,ad:Q})},V=Q=>{ae(Q).disabled||(g({isOpen:!0,ad:Q}),b(""),Q.agents&&Q.agents.length>0?x(Q.agents[0].id):Q.agent?x(Q.agent.id):x(""))},X=()=>{if(!m.ad)return;const Q=parseFloat(w),xe=parseFloat(m.ad.minAmount),Pe=parseFloat(m.ad.maxAmount);if(isNaN(Q)){D.error("Please enter a valid amount");return}if(Q<xe||Q>Pe){D.error(`Quantity must be between ${xe.toFixed(2)} and ${Pe.toFixed(2)} ${m.ad.token}`);return}L(m.ad,w),g({isOpen:!1,ad:null}),b("")},ae=Q=>(H==null?void 0:H.toLowerCase())===Q.ownerAddress.toLowerCase()?{text:"Your Ad",disabled:!0,className:"bg-gray-500/20 text-gray-400 cursor-not-allowed",action:null}:Q.type==="BUY"?{text:"Sell",disabled:!1,className:"bg-gradient-to-r from-pink-500 to-red-500 text-white hover:from-red-600 hover:to-pink-600",action:"sell"}:{text:"Buy",disabled:!1,className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white hover:from-green-600 hover:to-emerald-600",action:"buy"},ce=!!(T!=null&&T.verified),ie=!!(T!=null&&T.selectedAgentIds&&T.selectedAgentIds.length>0),Te=ce&&ie,ue=!ie||!ce;return c.jsxs("div",{className:"p-3 sm:p-6 space-y-4 sm:space-y-6",children:[c.jsxs("div",{className:"text-center space-y-1",children:[c.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white",children:"P2P Trading"}),c.jsx("p",{className:"text-gray-300 text-xs sm:text-sm",children:"BNB Smart Chain"})]}),(!C.buyEnabled||!C.sellEnabled)&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Trading Disabled"}),c.jsx("p",{className:"text-red-400 text-xs",children:!C.buyEnabled&&!C.sellEnabled?"Both BUY and SELL trading are currently disabled.":C.buyEnabled?"SELL trading is currently disabled.":"BUY trading is currently disabled."})]})]}),K&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Connection Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:K})]}),c.jsx("button",{onClick:I,className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),v&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Load Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:v})]}),c.jsx("button",{onClick:()=>E(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),R&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Order Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:R})]}),c.jsx("button",{onClick:()=>S(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-lg p-1 border border-white/20",children:c.jsx("div",{className:"grid grid-cols-2 gap-1",children:["BUY","SELL"].map(Q=>c.jsx(ee.button,{onClick:()=>e(Q),className:Zn("py-2 px-3 sm:py-3 sm:px-4 rounded-md font-medium transition-all text-sm sm:text-base",t===Q?Q==="BUY"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gradient-to-r from-red-500 to-pink-500 text-white":Q==="BUY"?"text-green-300 hover:text-green-200 hover:bg-green-500/10":"text-red-300 hover:text-red-200 hover:bg-red-500/10"),whileTap:{scale:.98},children:Q},Q))})}),c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsx("div",{className:"flex space-x-1 sm:space-x-2",children:["USDT","USDC"].map(Q=>c.jsx(ee.button,{onClick:()=>r(Q),className:Zn("px-3 py-1.5 sm:px-4 sm:py-2 rounded-md font-medium transition-all text-sm",n===Q?"bg-white/20 text-white border border-white/30":"bg-white/10 text-gray-300 border border-white/10"),whileTap:{scale:.95},children:Q},Q))}),c.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[c.jsx(ee.button,{onClick:F,disabled:u,className:"p-1.5 sm:p-2 rounded-md bg-white/10 text-white hover:bg-white/20 disabled:opacity-50",whileTap:{scale:.95},children:u?c.jsx(sr,{size:14,className:"animate-spin sm:w-4 sm:h-4"}):c.jsx(wa,{size:14,className:"sm:w-4 sm:h-4"})}),Te&&c.jsxs(ee.button,{onClick:()=>a(!0),className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white px-3 py-1.5 sm:px-4 sm:py-2 rounded-md flex items-center space-x-1.5 sm:space-x-2",whileTap:{scale:.95},children:[c.jsx(Wx,{size:14,className:"sm:w-4 sm:h-4"}),c.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Create Ad"})]})]})]}),ue&&c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 space-y-4",children:[c.jsx("div",{className:"w-16 h-16 bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto",children:c.jsx(bB,{size:32,className:"text-yellow-400"})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Profile Verification Required"}),c.jsx("p",{className:"text-gray-300 text-sm max-w-xs mx-auto",children:"Profile verify karein aur ek agent select karein  tabhi aapko local P2P ads dikhengi."})]}),c.jsx(ee.button,{onClick:()=>a(!0),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white py-2 px-6 rounded-lg",whileTap:{scale:.98},children:"Complete Profile"})]}),!ue&&c.jsx("div",{className:"space-y-4",children:c.jsx(Oo,{children:u?c.jsx("div",{className:"space-y-4",children:[1,2,3].map(Q=>c.jsxs("div",{className:"bg-white/10 rounded-xl p-4 animate-pulse",children:[c.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4 mb-2"}),c.jsx("div",{className:"h-3 bg-white/20 rounded w-1/2"})]},Q))}):s.length===0?c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8 text-gray-400",children:c.jsxs("p",{children:["No ",t.toLowerCase()," ads available for ",n]})}):s.map(Q=>{var me,le,tt,Ve,Ue,pe,it;const xe=((le=(me=Q.agents)==null?void 0:me[0])==null?void 0:le.city)||((tt=Q.agent)==null?void 0:tt.city)||Q.city,Pe=Q.owner_name||"",Y=Q.type==="BUY"?Q.buyQuantity||Q.maxAmount:Q.sellQuantity||Q.maxAmount;return c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white/5 backdrop-blur-lg rounded-lg p-3 border border-white/10 hover:border-white/20 transition-all",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-7 h-7 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-xs",children:Pe.charAt(0).toUpperCase()}),c.jsx("div",{children:c.jsx("p",{className:"text-white font-medium text-xs",children:Pe})})]}),c.jsx("span",{className:Zn("px-2 py-0.5 rounded-full text-[10px] font-bold",Q.type==="BUY"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:Q.type})]}),c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{children:c.jsxs("div",{className:"flex items-baseline space-x-1",children:[c.jsxs("span",{className:"text-xl font-bold text-white",children:["",parseFloat(Q.priceInr).toFixed(2)]}),c.jsxs("span",{className:"text-xs text-gray-400",children:["/",Q.token]})]})}),c.jsx("div",{className:"bg-blue-500/10 px-2 py-1 rounded",children:c.jsxs("p",{className:"text-blue-300 text-[10px] font-medium",children:["Qty: ",parseFloat(Y).toFixed(2)," ",Q.token]})})]}),c.jsxs("div",{className:"flex items-center justify-between text-[10px] mb-2 bg-white/5 rounded p-1.5",children:[c.jsxs("span",{className:"text-gray-300",children:["Limit: ",(parseFloat(Q.minAmount)*parseFloat(Q.priceInr)).toLocaleString("en-IN",{maximumFractionDigits:0})," - ",(parseFloat(Q.maxAmount)*parseFloat(Q.priceInr)).toLocaleString("en-IN",{maximumFractionDigits:0})]}),c.jsxs("span",{className:"text-gray-400",children:[" ",Math.floor(Q.lockDurationSeconds/1800),"h"]})]}),c.jsxs("div",{className:"grid grid-cols-1 ",children:[c.jsxs("div",{className:"flex items-center justify-between ",children:[c.jsxs("div",{className:"text-gray-300 text-xs font-bold",children:["Aagnya Branch  ",c.jsxs("span",{className:"bg-blue-500/20 text-blue-300 px-2 py-1 rounded-full text-[10px] font-bold",children:[((Ve=Q.agents)==null?void 0:Ve.length)||1,((((Ue=Q.agents)==null?void 0:Ue.length)||1)>1,"")]})]}),c.jsx("div",{className:"flex items-center space-x-2",children:c.jsxs("div",{className:Zn("border rounded px-2 py-1",Q.type==="BUY"?"bg-red-500/10 border-red-500/20":"bg-green-500/10 border-green-500/20"),children:[c.jsx("span",{className:Zn("text-[10px] font-medium",Q.type==="BUY"?"text-red-300":"text-green-300"),children:(Q.type==="BUY","Platform Fee")}),c.jsx("span",{className:Zn("text-xs font-bold ml-2",Q.type==="BUY"?"text-red-400":"text-green-400"),children:Q.type==="BUY"?"1.0%":"0.8%"})]})})]}),c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"flex items-center space-x-2 ",children:c.jsxs("span",{className:"text-gray-400 text-[11px] font-extrabold",children:[" ",xe]})}),c.jsxs("div",{className:"text-gray-500 text-[10px]",children:[((pe=Q.agents)==null?void 0:pe.length)||1," location",(((it=Q.agents)==null?void 0:it.length)||1)>1?"s":""," available"]})]})]}),c.jsxs("div",{className:"flex space-x-1.5",children:[(()=>{const An=ae(Q),nt=f===Q.id,bn=Q.type==="BUY"&&!C.sellEnabled||Q.type==="SELL"&&!C.buyEnabled,Fe=An.disabled||nt||bn;return c.jsx(ee.button,{onClick:()=>V(Q),disabled:Fe,className:Zn("flex-1 py-2 px-3 rounded-lg font-semibold transition-all flex items-center justify-center space-x-1 text-xs",An.className,Fe&&"opacity-50 cursor-not-allowed"),whileTap:{scale:Fe?1:.95},title:bn?`${Q.type==="BUY"?"SELL":"BUY"} trading is currently disabled`:void 0,children:nt?c.jsxs(c.Fragment,{children:[c.jsx(sr,{size:14,className:"animate-spin"}),c.jsx("span",{children:"Creating..."})]}):c.jsx("span",{children:An.text})})})(),c.jsx(ee.button,{onClick:()=>B(Q),className:"p-2 rounded-lg bg-blue-500/20 text-blue-400 border border-blue-500/30 hover:bg-blue-500/30 transition-all",whileTap:{scale:.95},children:c.jsx(CQ,{size:16})})]})]},Q.id)})})}),c.jsx(cIe,{isOpen:o,onClose:()=>a(!1),onSuccess:()=>{a(!1),F()}}),c.jsx(CN,{isOpen:l.isOpen,ad:l.ad,onClose:()=>d({isOpen:!1,ad:null})}),c.jsx(Oo,{children:m.isOpen&&m.ad&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-2 sm:p-4",onClick:()=>g({isOpen:!1,ad:null}),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:Zn("bg-slate-900 rounded-lg p-4 sm:p-6 w-full max-w-md border-2 max-h-[90vh] overflow-y-auto",m.ad.type==="BUY"?"border-red-500/50":"border-green-500/50"),onClick:Q=>Q.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[c.jsx("h3",{className:Zn("text-lg sm:text-xl font-bold",m.ad.type==="BUY"?"text-red-400":"text-green-400"),children:m.ad.type==="BUY"?"Sell Request":"Buy Request"}),c.jsx("button",{onClick:()=>g({isOpen:!1,ad:null}),className:"p-1.5 sm:p-2 rounded-md bg-white/10 text-gray-400 hover:text-white transition-colors",children:c.jsx(an,{size:16,className:"sm:w-5 sm:h-5"})})]}),c.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[(!C.buyEnabled||!C.sellEnabled)&&c.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-md p-3",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(qt,{size:16,className:"text-red-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Trading Disabled"}),c.jsx("p",{className:"text-red-400 text-xs",children:!C.buyEnabled&&!C.sellEnabled?"Both BUY and SELL trading are currently disabled.":C.buyEnabled?"SELL trading is currently disabled.":"BUY trading is currently disabled."})]})]})}),c.jsxs("div",{className:"bg-white/5 rounded-md p-3 space-y-1 sm:space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-white font-semibold",children:["",m.ad.priceInr]}),c.jsx("span",{className:"text-gray-300 text-sm bg-white/10 px-2 py-1 rounded",children:m.ad.token})]}),c.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-md p-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-blue-300 text-sm font-medium",children:m.ad.type==="BUY"?"Want to Buy:":"Want to Sell:"}),c.jsx("span",{className:"text-blue-400 font-bold",children:m.ad.type==="BUY"?`${parseFloat(m.ad.buyQuantity||m.ad.maxAmount).toFixed(2)} ${m.ad.token}`:`${parseFloat(m.ad.sellQuantity||m.ad.maxAmount).toFixed(2)} ${m.ad.token}`})]}),c.jsxs("p",{className:"text-blue-200 text-xs mt-1",children:["Min: ",parseFloat(m.ad.minAmount).toFixed(2)," ",m.ad.token," | Max: ",parseFloat(m.ad.maxAmount).toFixed(2)," ",m.ad.token]})]}),c.jsxs("p",{className:"text-gray-300 text-sm",children:["Min: ",(parseFloat(m.ad.minAmount)*parseFloat(m.ad.priceInr)).toFixed(2)," | Max: ",(parseFloat(m.ad.maxAmount)*parseFloat(m.ad.priceInr)).toFixed(2)]}),c.jsx("p",{className:"text-gray-400 text-xs",children:"Lock Duration: 2 hours"})]}),(()=>{let Q=null;return m.ad.agents&&m.ad.agents.length>1&&y?Q=m.ad.agents.find(xe=>xe.id===y):m.ad.agent&&(Q=m.ad.agent),Q&&c.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-md p-3 space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),c.jsx("h4",{className:"text-blue-300 font-medium text-sm",children:"Selected Agent"})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-white font-medium text-sm truncate",children:Q.branchName}),c.jsx("span",{className:"text-green-400 text-xs bg-green-500/20 px-1.5 py-0.5 rounded",children:" Verified"})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("span",{className:"text-gray-400 text-xs",children:""}),c.jsx("span",{className:"text-gray-300 text-xs",children:Q.city})]}),Q.address&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("span",{className:"text-gray-400 text-xs",children:""}),c.jsx("span",{className:"text-gray-300 text-xs truncate",children:Q.address})]}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("span",{className:"text-gray-400 text-xs",children:""}),c.jsx("span",{className:"text-gray-300 text-xs",children:Q.mobile}),c.jsx("button",{onClick:()=>(Q==null?void 0:Q.mobile)&&window.open(`tel:${Q.mobile}`),className:"p-0.5 rounded bg-green-500/20 text-green-400 hover:bg-green-500/30 transition-colors",children:c.jsx(fn,{size:10})})]})]})]})]})})(),w&&parseFloat(w)>0&&c.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-md p-3 space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full"}),c.jsx("h4",{className:"text-yellow-300 font-medium text-sm",children:"Fee Calculation"})]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-300",children:"Order Amount:"}),c.jsxs("span",{className:"text-white font-medium",children:[w," ",m.ad.token]})]}),m.ad.type==="BUY"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-300",children:"Platform Fee (1.0%):"}),c.jsxs("span",{className:"text-red-400",children:["+",(parseFloat(w)*.01).toFixed(4)," ",m.ad.token]})]}),c.jsx("div",{className:"pt-2 border-t border-red-500/20",children:c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-red-300 font-medium",children:"You need to lock:"}),c.jsxs("span",{className:"text-red-400 font-bold",children:[(parseFloat(w)*1.01).toFixed(4)," ",m.ad.token]})]})})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-300",children:"Platform Fee (0.8%):"}),c.jsxs("span",{className:"text-green-400",children:["-",(parseFloat(w)*.008).toFixed(4)," ",m.ad.token]})]}),c.jsx("div",{className:"pt-2 border-t border-green-500/20",children:c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-green-300 font-medium",children:"You will receive:"}),c.jsxs("span",{className:"text-green-400 font-bold",children:[(parseFloat(w)*.992).toFixed(4)," ",m.ad.token]})]})})]})]})]}),m.ad.agents&&m.ad.agents.length>1&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Agent"}),c.jsx("select",{value:y,onChange:Q=>x(Q.target.value),className:"w-full bg-white/10 border border-white/20 rounded-md px-3 py-2 text-white focus:outline-none focus:border-blue-500 text-sm",children:m.ad.agents.map(Q=>c.jsxs("option",{value:Q.id,className:"bg-slate-800",children:[Q.branchName," - ",Q.city]},Q.id))}),c.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Choose which agent you want to work with"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Qty (",m.ad.token,")"]}),c.jsx("input",{type:"number",value:w,onChange:Q=>b(Q.target.value),className:Zn("w-full border rounded-md px-3 py-2 text-white placeholder-gray-400 focus:outline-none text-sm",w&&parseFloat(w)>parseFloat(m.ad.maxAmount)?"bg-red-500/10 border-red-500/50 focus:border-red-500":"bg-white/10 border-white/20 focus:border-blue-500"),placeholder:`Enter qty between ${parseFloat(m.ad.minAmount).toFixed(2)} - ${parseFloat(m.ad.maxAmount).toFixed(2)} ${m.ad.token}`,min:m.ad.minAmount,max:m.ad.maxAmount}),w&&parseFloat(w)>parseFloat(m.ad.maxAmount)&&c.jsxs("p",{className:"text-red-400 text-xs mt-1 flex items-center",children:[c.jsx("span",{className:"mr-1",children:""}),"Maximum quantity is ",parseFloat(m.ad.maxAmount).toFixed(2)," ",m.ad.token]}),w&&parseFloat(w)<parseFloat(m.ad.minAmount)&&parseFloat(w)>0&&c.jsxs("p",{className:"text-yellow-400 text-xs mt-1 flex items-center",children:[c.jsx("span",{className:"mr-1",children:""}),"Minimum quantity is ",parseFloat(m.ad.minAmount).toFixed(2)," ",m.ad.token]}),c.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["You will work with ",(()=>{var Q;if(m.ad.agents&&m.ad.agents.length>1){const xe=m.ad.agents.find(Pe=>Pe.id===y);return xe?xe.branchName:"selected agent"}return((Q=m.ad.agent)==null?void 0:Q.branchName)||"agent"})()," agent for this ",m.ad.type==="BUY"?"sell":"buy"," request"]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx(ee.button,{onClick:()=>g({isOpen:!1,ad:null}),className:"flex-1 py-2 px-3 rounded-md bg-white/10 text-white hover:bg-white/20 transition-colors text-sm",whileTap:{scale:.98},children:"Cancel"}),c.jsx(ee.button,{onClick:X,disabled:!w||f===m.ad.id||parseFloat(w)>parseFloat(m.ad.maxAmount)||parseFloat(w)<parseFloat(m.ad.minAmount)||m.ad.type==="BUY"&&!C.sellEnabled||m.ad.type==="SELL"&&!C.buyEnabled,className:Zn("flex-1 py-2 px-3 rounded-md text-white disabled:opacity-50 disabled:cursor-not-allowed text-sm",m.ad.type==="BUY"?"bg-gradient-to-r from-red-500 to-pink-500":"bg-gradient-to-r from-green-500 to-emerald-500"),whileTap:{scale:.98},title:m.ad.type==="BUY"&&!C.sellEnabled?"SELL trading is currently disabled":m.ad.type==="SELL"&&!C.buyEnabled?"BUY trading is currently disabled":void 0,children:f===m.ad.id?"Creating...":m.ad.type==="BUY"?"Sell Request":"Buy Request"})]})]})]})})})]})},dIe=({orderId:t,userRole:e,orderState:n,timeRemaining:r,appealTimeRemaining:s,confirmations:i,dispute:o,appeals:a,onConfirmPayment:l,onFileAppeal:d})=>{const[u,h]=A.useState(!1),[f,p]=A.useState({dispute_type:"PAYMENT_NOT_RECEIVED",description:"",evidence_video_url:"",evidence_screenshots:[],evidence_documents:[]}),m=E=>{const R=Math.floor(E/36e5),S=Math.floor(E%(1e3*60*60)/(1e3*60)),C=Math.floor(E%(1e3*60)/1e3);return`${R}h ${S}m ${C}s`},w=n==="LOCKED"&&r>0?"PHASE_1":n==="UNDER_DISPUTE"&&s>0?"PHASE_2":n==="UNDER_REVIEW"?"PHASE_3":n==="RESOLVED"||n==="RELEASED"||n==="REFUNDED"?"PHASE_4":"UNKNOWN",b=()=>c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx(Pr,{className:"h-6 w-6 text-blue-600 mr-2"}),c.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Phase 1: Payment Confirmation"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"font-medium",children:"Time Remaining:"}),c.jsx("span",{className:"text-lg font-bold text-blue-600",children:m(r)})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.max(0,r/(2*60*60*1e3)*100)}%`}})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white rounded-lg p-4",children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Buyer Confirmation"}),c.jsxs("div",{className:"flex items-center mb-2",children:[i!=null&&i.buyer_confirmed?c.jsx(kt,{className:"h-5 w-5 text-green-600 mr-2"}):c.jsx(xr,{className:"h-5 w-5 text-red-600 mr-2"}),c.jsx("span",{children:i!=null&&i.buyer_confirmed?"Confirmed":"Pending"})]}),e==="BUYER"&&!(i!=null&&i.buyer_confirmed)&&c.jsx("button",{onClick:()=>l(t,"SENT"),className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Confirm Payment Sent"})]}),c.jsxs("div",{className:"bg-white rounded-lg p-4",children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Seller Confirmation"}),c.jsxs("div",{className:"flex items-center mb-2",children:[i!=null&&i.seller_confirmed?c.jsx(kt,{className:"h-5 w-5 text-green-600 mr-2"}):c.jsx(xr,{className:"h-5 w-5 text-red-600 mr-2"}),c.jsx("span",{children:i!=null&&i.seller_confirmed?"Confirmed":"Pending"})]}),e==="SELLER"&&!(i!=null&&i.seller_confirmed)&&c.jsx("button",{onClick:()=>l(t,"RECEIVED"),className:"w-full bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700",children:"Confirm Payment Received"})]})]})]}),c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(Jd,{className:"h-5 w-5 text-yellow-600 mr-2"}),c.jsx("span",{className:"font-semibold text-yellow-800",children:"Important"})]}),c.jsx("p",{className:"text-yellow-700 text-sm",children:"Both parties must confirm within 2 hours. If not confirmed, the order will automatically move to dispute phase."})]})]}),y=()=>c.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx(Jd,{className:"h-6 w-6 text-orange-600 mr-2"}),c.jsx("h3",{className:"text-lg font-semibold text-orange-900",children:"Phase 2: Appeal Window"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"font-medium",children:"Appeal Time Remaining:"}),c.jsx("span",{className:"text-lg font-bold text-orange-600",children:m(s)})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-orange-600 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.max(0,s/(48*60*60*1e3)*100)}%`}})})]}),c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(Jd,{className:"h-5 w-5 text-red-600 mr-2"}),c.jsx("span",{className:"font-semibold text-red-800",children:"2 Hours Passed Without Full Confirmation"})]}),c.jsx("p",{className:"text-red-700 text-sm",children:"You have 48 hours to file an appeal if there's an issue with the payment."})]}),u?c.jsxs("div",{className:"bg-white rounded-lg p-4",children:[c.jsx("h4",{className:"font-semibold mb-4",children:"File Appeal"}),c.jsxs("form",{onSubmit:E=>{E.preventDefault(),d(t,f)},children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Dispute Type"}),c.jsxs("select",{value:f.dispute_type,onChange:E=>p({...f,dispute_type:E.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[c.jsx("option",{value:"PAYMENT_NOT_RECEIVED",children:"Payment Not Received"}),c.jsx("option",{value:"PAYMENT_NOT_SENT",children:"Payment Not Sent"}),c.jsx("option",{value:"OTHER",children:"Other Issue"})]})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Description"}),c.jsx("textarea",{value:f.description,onChange:E=>p({...f,description:E.target.value}),placeholder:"Describe the issue in detail...",className:"w-full border border-gray-300 rounded-md px-3 py-2 h-24",required:!0})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Evidence Video URL (Optional)"}),c.jsx("input",{type:"url",value:f.evidence_video_url,onChange:E=>p({...f,evidence_video_url:E.target.value}),placeholder:"https://...",className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{type:"submit",className:"flex-1 bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700",children:"Submit Appeal"}),c.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:"Cancel"})]})]})]}):c.jsx("button",{onClick:()=>h(!0),className:"w-full bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700",children:"File Appeal"})]}),a.length>0&&c.jsxs("div",{className:"bg-white rounded-lg p-4",children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Existing Appeals"}),a.map(E=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 mb-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("span",{className:"font-medium",children:[E.appellant_type," Appeal"]}),c.jsx("span",{className:"text-sm text-gray-500",children:new Date(E.created_at).toLocaleString()})]}),c.jsx("p",{className:"text-sm text-gray-700",children:E.description}),E.evidence_video_url&&c.jsxs("div",{className:"mt-2",children:[c.jsx(hl,{className:"h-4 w-4 inline mr-1"}),c.jsx("a",{href:E.evidence_video_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm",children:"View Evidence Video"})]})]},E.id))]})]}),x=()=>c.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx(cl,{className:"h-6 w-6 text-purple-600 mr-2"}),c.jsx("h3",{className:"text-lg font-semibold text-purple-900",children:"Phase 3: Under Review"})]}),c.jsxs("div",{className:"bg-white rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(Pr,{className:"h-5 w-5 text-purple-600 mr-2"}),c.jsx("span",{className:"font-medium",children:"Admin is reviewing your case"})]}),c.jsx("p",{className:"text-gray-700 text-sm",children:"Your dispute is being reviewed by our admin team. You will be notified once a decision is made."})]})]}),v=()=>c.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx(kt,{className:"h-6 w-6 text-green-600 mr-2"}),c.jsx("h3",{className:"text-lg font-semibold text-green-900",children:"Phase 4: Resolved"})]}),c.jsxs("div",{className:"bg-white rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(kt,{className:"h-5 w-5 text-green-600 mr-2"}),c.jsx("span",{className:"font-medium",children:"Dispute Resolved"})]}),c.jsx("p",{className:"text-gray-700 text-sm",children:"The dispute has been resolved. Check your wallet for the final transaction."})]})]});return c.jsxs("div",{className:"space-y-4",children:[w==="PHASE_1"&&b(),w==="PHASE_2"&&y(),w==="PHASE_3"&&x(),w==="PHASE_4"&&v()]})};class uIe{constructor(){q(this,"provider",null);q(this,"signer",null);q(this,"contract",null)}async init(){try{const e=Xt.getState().walletType;console.log(" Initializing blockchain service with walletType:",e);let n;if(e==="walletconnect"){const i=ai;i.isInitialized||(console.log(" WalletConnect not initialized, initializing now..."),await i.initialize(),await new Promise(a=>setTimeout(a,1e3)));let o=i.getProvider();if(console.log(" WalletConnect provider from service:",o?"Found":"Not found"),!o){const a=i.appKit;if(a){console.log(" Trying to get provider from appKit...");const l=a.getWalletProvider();l?(o=new Dr(l),console.log(" Got WalletConnect provider from appKit")):console.warn(" appKit.getWalletProvider() returned null")}else console.warn(" appKit is not available")}if(!o){const a=i.isConnected();if(console.log(" WalletConnect connected status:",a),a&&(await new Promise(l=>setTimeout(l,2e3)),o=i.getProvider(),console.log(" Retry: WalletConnect provider:",o?"Found":"Still not found"),!o)){const l=i.appKit;if(l){const d=l.getWalletProvider();d&&(o=new Dr(d),console.log(" Got WalletConnect provider from appKit (retry)"))}}}if(!o)throw new Error("WalletConnect provider not available. Please reconnect your wallet via WalletConnect.");n=o,console.log(" Using WalletConnect provider for transactions")}else{if(!window.ethereum)throw new Error("Please install MetaMask, Trust Wallet, or another Web3 wallet");try{await window.ethereum.request({method:"eth_requestAccounts"})}catch(i){i.code!==4001&&console.warn("eth_requestAccounts failed (might already be connected):",i)}n=new Dr(window.ethereum),console.log(" Using window.ethereum provider")}this.provider=n,this.signer=await n.getSigner();const r=await this.signer.getAddress();console.log(" Signer created, address:",r),this.contract=new rr(On,vi,this.signer),console.log(" Contract initialized"),console.log(" Contract Address:",On),console.log(" Wallet Address:",r);try{const i=await n.getNetwork();if(console.log(" Network:",i.name,"Chain ID:",i.chainId.toString()),this.contract)try{const o=await this.contract.admin();console.log(" Contract is accessible, admin:",o)}catch(o){console.warn(" Could not read from contract (might be expected):",o.message)}}catch(i){console.warn(" Could not get network info:",i.message)}const s=this.detectWalletType();return console.log(" Detected wallet type:",s),!0}catch(e){throw console.error(" Failed to initialize blockchain service:",e),e}}detectWalletType(){var n,r,s;try{if(typeof Xt<"u"&&(Xt!=null&&Xt.getState)){const i=(n=Xt.getState())==null?void 0:n.walletType;if(i)switch(i){case"metamask":return"MetaMask";case"trustwallet":return"Trust Wallet";case"walletconnect":return(r=window.ethereum)!=null&&r.isTrust||(s=window.ethereum)!=null&&s.isTrustWallet?"Trust Wallet (via WalletConnect)":"WalletConnect";default:break}}}catch{}if(!window.ethereum)return"Unknown Wallet";if(window.ethereum.isMetaMask)return"MetaMask";if(window.ethereum.isTrust||window.ethereum.isTrustWallet)return"Trust Wallet";if(window.ethereum.isCoinbaseWallet)return"Coinbase Wallet";if(window.ethereum.isRabby)return"Rabby";if(window.ethereum.isBraveWallet)return"Brave Wallet";const e=navigator.userAgent;return e.includes("TrustWallet")||e.includes("Trust Wallet")?"Trust Wallet (Mobile)":"Unknown Wallet"}isTrustWalletAvailable(){var e;return window.ethereum?!!(window.ethereum.isTrust||window.ethereum.isTrustWallet||(e=window.ethereum)!=null&&e.isTrustWallet||navigator.userAgent.includes("TrustWallet")||navigator.userAgent.includes("Trust Wallet")):!1}getWalletInstructions(){switch(this.detectWalletType()){case"Trust Wallet":return"Trust Wallet detected! Make sure you have sufficient BNB for gas fees and the required token balance.";case"Trust Wallet (Mobile)":return"Trust Wallet Mobile detected! Ensure you have sufficient BNB for gas fees and the required token balance.";case"MetaMask":return"MetaMask detected! Make sure you have sufficient BNB for gas fees and the required token balance.";default:return"Make sure you have sufficient BNB for gas fees and the required token balance."}}async createTrade(e){var r,s,i,o,a,l,d,u,h,f,p,m,g,w;const n=(r=Xt.getState())==null?void 0:r.walletType;if((!this.contract||!this.signer||!this.provider)&&(console.log(" Re-initializing blockchain service for createTrade..."),await this.init()),n==="walletconnect"){if(console.log(" Ensuring WalletConnect provider is ready for createTrade..."),await this.init(),!this.provider||!this.signer||!this.contract)throw new Error("WalletConnect provider not ready. Please ensure your wallet is connected via WalletConnect.");const b=await this.signer.getAddress();console.log(" WalletConnect ready, signer address:",b)}try{console.log(" Creating trade on blockchain (P2PEscrowV2)..."),console.log(" Token:",e.token),console.log(" Amount:",e.amount),console.log(" Buyer:",e.buyer),console.log(" Is Native BNB?",e.isNativeBNB),console.log(" Wallet Type:",n);const b=im(e.amount,18);if(e.token==="0x0000000000000000000000000000000000000000"||e.isNativeBNB?(console.log(" Creating trade with NATIVE BNB (address(0))"),console.log(" Note: No BNB sent now - will be sent during lockFunds()")):console.log(" Creating trade with ERC20 token (WBNB/USDT/USDC)"),!this.contract)throw new Error("Contract not initialized. Please reconnect your wallet.");if(!this.signer)throw new Error("Signer not available. Please reconnect your wallet.");if(!this.contract.createTrade)throw new Error("createTrade function not found in contract. Please check the contract ABI.");let x=0;try{this.contract&&this.contract.tradeCounter&&(x=Number(await this.contract.tradeCounter()),console.log(" Trade counter before transaction:",x))}catch(S){console.warn(" Could not get trade counter before transaction:",S.message)}let v;if(n==="walletconnect"){console.log(" WalletConnect detected - estimating gas for createTrade...");try{console.log(" Estimating gas...");const S=await this.contract.createTrade.estimateGas(e.token,b,e.buyer),C=S*130n/100n;console.log(" Estimated gas:",S.toString()),console.log(" Gas limit with buffer:",C.toString()),console.log(" Sending createTrade transaction with explicit gas..."),v=await this.contract.createTrade(e.token,b,e.buyer,{gasLimit:C}),console.log(" Transaction sent with explicit gas")}catch(S){console.warn(" Gas estimation failed, trying without explicit gas:",S),console.error(" Gas estimation error details:",{code:S.code,message:S.message,reason:S.reason});try{console.log(" Attempting createTrade without explicit gas..."),v=await this.contract.createTrade(e.token,b,e.buyer),console.log(" Transaction sent without explicit gas")}catch(C){throw console.error(" createTrade failed even without explicit gas:",C),console.error(" Fallback error details:",{code:C.code,message:C.message,reason:C.reason,data:C.data}),C}}}else console.log(" Sending createTrade transaction (standard wallet)..."),v=await this.contract.createTrade(e.token,b,e.buyer),console.log(" Transaction sent");console.log(" Transaction sent:",v.hash),console.log(" Waiting for confirmation...");const E=await v.wait();if(console.log(" Trade created on blockchain!"),console.log(" Block number:",E.blockNumber),console.log(" Receipt status:",E.status),E.status!==1)throw new Error(`Transaction failed on blockchain. Status: ${E.status}. Please check on BSCScan: ${v.hash}`);console.log(" Parsing transaction receipt for TradeCreated event..."),console.log(" Receipt logs count:",E.logs.length);let R=0;try{const S=this.contract.filters.TradeCreated(),N=(await this.contract.queryFilter(S,E.blockNumber,E.blockNumber)).find(T=>T.transactionHash===v.hash);if(N&&"args"in N&&N.args){const T=N.args;R=Number(T.tradeId||0),console.log(" TradeCreated event found via queryFilter!"),console.log(" Trade ID from event:",R),console.log(" Event args:",{tradeId:(s=T.tradeId)==null?void 0:s.toString(),seller:T.seller,buyer:T.buyer,token:T.token,amount:(i=T.amount)==null?void 0:i.toString()})}}catch(S){console.warn(" Event filtering failed, trying direct log parsing:",S.message)}if(R===0){console.log(" Trying direct log parsing...");for(let S=0;S<E.logs.length;S++){const C=E.logs[S];try{if(C.address.toLowerCase()!==On.toLowerCase())continue;const N=this.contract.interface.parseLog({topics:C.topics||[],data:C.data||"0x"});if(console.log(` Log ${S}: Event name: ${N==null?void 0:N.name}`),(N==null?void 0:N.name)==="TradeCreated"){R=Number(((o=N.args)==null?void 0:o.tradeId)||0),console.log(" TradeCreated event found via direct parsing!"),console.log(" Trade ID from event:",R),console.log(" Event args:",N.args);break}}catch{continue}}}if(R===0||isNaN(R)){console.warn(" TradeCreated event not found, trying fallback method...");try{console.log(" Fallback: Getting trade ID from contract state...");const S=await this.signer.getAddress();if(console.log(" Signer address for verification:",S),this.contract&&this.contract.tradeCounter){const C=Number(await this.contract.tradeCounter());console.log(" Trade counter after transaction:",C),console.log(" Trade counter before transaction:",x);const N=[];C>0&&N.push(C),x>0&&N.push(x+1);const T=5;for(let U=1;U<=T&&C-U>0;U++)N.push(C-U);const $=[...new Set(N)].sort((U,H)=>H-U);console.log(" Searching through candidate trade IDs:",$);for(const U of $)try{console.log(` Checking trade ID ${U}...`);const H=await this.contract.trades(U);if(H&&H.seller){const K=H.seller.toLowerCase(),I=((a=H.buyer)==null?void 0:a.toLowerCase())||"",j=e.buyer.toLowerCase();if(console.log(` Trade ${U} details:`,{seller:K,buyer:I,expectedBuyer:j,token:H.token,amount:(l=H.amount)==null?void 0:l.toString()}),K===S.toLowerCase())if(!I||I===j||I==="0x0000000000000000000000000000000000000000"){R=U,console.log(" Found matching trade! ID:",R),console.log(" Seller matches:",K),console.log(" Buyer matches or not set yet");break}else console.log(` Trade ${U} seller matches but buyer doesn't match`);else console.log(` Trade ${U} seller doesn't match`)}}catch(H){console.log(` Could not check trade ${U}:`,H.message);continue}if(R===0&&C>0&&(console.warn(" Could not find exact match, using tradeCounterAfter as fallback"),R=C),R===0)throw new Error(`Could not find matching trade ID. Searched ${$.length} candidates.`)}else throw console.error(" tradeCounter function not available in contract"),new Error("tradeCounter function not available")}catch(S){throw console.error(" Fallback method also failed:",S),console.error(" Fallback error details:",{message:S.message,code:S.code,reason:S.reason}),console.error(" Could not extract trade ID from transaction receipt"),console.error(" Transaction hash:",v.hash),console.error(" Block number:",E.blockNumber),console.error(" Receipt status:",E.status),console.error(" Logs count:",E.logs.length),console.error(" Logs:",E.logs.map(C=>{var N,T;return{address:C.address,topics:((N=C.topics)==null?void 0:N.length)||0,dataLength:((T=C.data)==null?void 0:T.length)||0}})),new Error("Failed to extract trade ID from blockchain transaction. The TradeCreated event was not found and fallback method also failed. Please check the transaction on BSCScan: "+v.hash)}}if(R===0||isNaN(R))throw console.error(" Invalid trade ID after all methods:",R),console.error(" Transaction hash:",v.hash),new Error("Failed to extract valid trade ID. Transaction may have failed. Please check on BSCScan: "+v.hash);return console.log(" Final trade ID:",R),{tradeId:R,txHash:v.hash}}catch(b){console.error(" Error creating trade:",b),console.error(" Error details:",{code:b.code,reason:b.reason,message:b.message,data:b.data,transaction:b.transaction});const y=this.detectWalletType(),v=((d=Xt.getState())==null?void 0:d.walletType)||y;if(b.code==="ACTION_REJECTED"||b.code===4001)throw new Error(`Transaction rejected by user in ${v}. Please try again and approve the transaction in your wallet.`);if(b.code==="INSUFFICIENT_FUNDS"||b.code===-32e3)throw new Error(`Insufficient BNB for gas fees in ${v}. Please add more BNB to your wallet for transaction fees.`);if(b.code==="UNSUPPORTED_OPERATION")throw new Error(`Operation not supported by ${v}. Please try with a different wallet or ensure you have sufficient BNB for gas.`);if(b.reason)throw new Error(`Smart contract error: ${b.reason}`);if((u=b.message)!=null&&u.includes("User rejected")||(h=b.message)!=null&&h.includes("user rejected")||(f=b.message)!=null&&f.includes("user-denied"))throw new Error(`Transaction rejected by user in ${v}. Please try again and approve the transaction.`);if((p=b.message)!=null&&p.includes("insufficient funds")||(m=b.message)!=null&&m.includes("insufficient balance"))throw new Error(`Insufficient BNB for gas fees in ${v}. Please add more BNB to your wallet.`);if((g=b.message)!=null&&g.includes("provider not available")||(w=b.message)!=null&&w.includes("provider not ready"))throw new Error(`Wallet provider not available. Please reconnect your wallet via ${v}.`);{const E=b.message||"Unknown error";throw new Error(`Failed to create trade on blockchain using ${v}. ${E}`)}}}async approveToken(e,n){var s,i,o,a,l,d,u,h;const r=(s=Xt.getState())==null?void 0:s.walletType;if((!this.provider||!this.signer)&&await this.init(),r==="walletconnect"){if(console.log(" Ensuring WalletConnect provider is available..."),await this.init(),!this.provider)throw new Error("WalletConnect provider not available. Please ensure your wallet is connected via WalletConnect.");if(!this.signer)throw new Error("WalletConnect signer not available. Please ensure your wallet is connected via WalletConnect.");const f=await this.signer.getAddress();console.log(" WalletConnect provider verified, signer address:",f)}if(e==="0x0000000000000000000000000000000000000000")return console.log(" Native BNB - no approval needed"),"NATIVE_BNB";try{console.log(" Approving ERC20 token spending..."),console.log(" Token:",e),console.log(" Trade Amount:",n),console.log(" Wallet Type:",r);const f=["function approve(address spender, uint256 amount) public returns (bool)","function allowance(address owner, address spender) public view returns (uint256)","function decimals() public view returns (uint8)"],p=new rr(e,f,this.signer);let m=18;try{m=await p.decimals(),console.log(" Token decimals:",m)}catch{console.warn(" Could not fetch token decimals, assuming 18")}console.log(" Fetching fee structure for approval...");let g,w;try{g=await this.contract.SELLER_EXTRA_BPS(),w=await this.contract.BPS_DENOM(),console.log(" Got fee structure from contract")}catch($){console.warn(" Failed to get fees from contract via signer provider:",$),console.log(" Trying read-only provider as fallback...");try{const U=new Eg(Cw),H=new rr(On,vi,U);g=await H.SELLER_EXTRA_BPS(),w=await H.BPS_DENOM(),console.log(" Got fee structure from read-only provider")}catch(U){console.error(" Failed to get fees from read-only provider:",U),console.warn(" Using default fee values (0% extra fee)"),w=10000n,g=0n}}const b=im(n,m),y=b*g/w,x=b+y;console.log(" Seller Extra Fee (BPS):",g.toString()),console.log(" Extra Fee Amount:",ha(y,m)),console.log(" Total to Approve:",ha(x,m));const v=await this.signer.getAddress(),E=await p.allowance(v,On);if(console.log(" Current allowance:",ha(E,m)),console.log(" Required amount (with fees):",ha(x,m)),E>=x)return console.log(" Already approved - skipping approval"),"ALREADY_APPROVED";if(!this.signer)throw new Error("Signer not available. Please reconnect your wallet.");const R=await this.signer.getAddress();console.log(" Approving with signer address:",R);const S=this.detectWalletType(),C=r==="trustwallet"||r==="walletconnect"||S.toLowerCase().includes("trust");let N;if(C){console.log(" Trust Wallet/WalletConnect detected - using explicit gas settings");try{console.log(" Estimating gas for approval...");const $=await p.approve.estimateGas(On,x),U=$*130n/100n;console.log(" Estimated gas:",$.toString()),console.log(" Gas limit with buffer:",U.toString()),console.log(" Sending approval transaction with explicit gas..."),N=await p.approve(On,x,{gasLimit:U}),console.log(" Approval transaction sent with explicit gas")}catch($){console.warn(" Gas estimation failed, trying without explicit gas:",$),console.log(" Attempting approval without explicit gas limit...");try{N=await p.approve(On,x),console.log(" Approval transaction sent without explicit gas")}catch(U){throw console.error(" Approval failed even without explicit gas:",U),U}}}else console.log(" Sending approval transaction (standard wallet)..."),N=await p.approve(On,x),console.log(" Approval transaction sent");console.log(" Approval transaction sent:",N.hash),console.log(" Waiting for confirmation...");const T=await N.wait();return console.log(" Token approved!"),console.log(" Block number:",T.blockNumber),N.hash}catch(f){console.error(" Error approving token:",f),console.error(" Error details:",{code:f.code,reason:f.reason,message:f.message,data:f.data});const p=this.detectWalletType();if(f.code==="ACTION_REJECTED"||f.code===4001)throw new Error(`Token approval rejected by user in ${p}. Please try again and approve the transaction in your wallet.`);if(f.code==="INSUFFICIENT_FUNDS"||f.code===-32e3)throw new Error(`Insufficient BNB for gas fees in ${p}. Please add more BNB to your wallet for transaction fees.`);if(f.code==="UNSUPPORTED_OPERATION")throw new Error(`Token approval not supported by ${p}. Please try with a different wallet or ensure you have sufficient BNB for gas.`);if(f.reason)throw new Error(`Approval failed: ${f.reason}`);if((i=f.message)!=null&&i.includes("User rejected")||(o=f.message)!=null&&o.includes("user rejected")||(a=f.message)!=null&&a.includes("user-denied"))throw new Error(`Token approval rejected by user in ${p}. Please try again and approve the transaction.`);if((l=f.message)!=null&&l.includes("insufficient funds")||(d=f.message)!=null&&d.includes("insufficient balance"))throw new Error(`Insufficient BNB for gas fees in ${p}. Please add more BNB to your wallet.`);if((u=f.message)!=null&&u.includes("CALL_EXCEPTION")||(h=f.message)!=null&&h.includes("missing revert data"))throw new Error(`Token approval failed in ${p}. Please ensure you have sufficient token balance and BNB for gas.`);{const m=f.message||"Unknown error";throw new Error(`Failed to approve token spending using ${p}. ${m}`)}}}async createTradeAndLockFunds(e,n,r){console.log(" NEW FLOW: Creating trade and locking funds together..."),console.log(" Step 1: Creating trade...");const s=await this.createTrade(e),i=s.tradeId,o=s.txHash;console.log(" Trade created! ID:",i),console.log(" Step 2: Locking funds...");const a=await this.lockFunds(i,n,r);return console.log(" Funds locked!"),{tradeId:i,createTradeTxHash:o,lockFundsTxHash:a}}async lockFunds(e,n="0x0000000000000000000000000000000000000000",r="0"){var s,i,o,a,l,d,u,h,f;(!this.contract||!this.signer)&&await this.init();try{console.log(" Step 0: Verifying trade on-chain..."),console.log(" Trade ID:",e);try{const y=await this.contract.trades(e),x=Number(y.status),v=Number(y.id);if(console.log(" Trade found on-chain"),console.log(" Trade Status:",x),console.log(" Trade ID from chain:",v),x===1)throw new Error("Trade already locked - funds are already locked on-chain");if(x===2)throw new Error("Trade already released - cannot lock funds");if(x===3)throw new Error("Trade already cancelled - cannot lock funds");x!==0&&console.warn(" Trade is in unexpected status:",x),v!==e&&console.warn(` Trade ID mismatch: expected ${e}, got ${v}`)}catch(y){if((s=y.message)!=null&&s.includes("already locked")||(i=y.message)!=null&&i.includes("already released")||(o=y.message)!=null&&o.includes("already cancelled"))throw y;console.warn(" Could not verify trade on-chain:",y.message)}console.log(" Step 1: Token Approval");const p=await this.approveToken(n,r);p!=="ALREADY_APPROVED"&&p!=="NATIVE_BNB"&&console.log(" Token approval confirmed:",p),console.log(" Step 2: Lock Funds"),console.log(" Locking funds on blockchain..."),console.log(" Trade ID:",e),console.log(" Calling lockFunds() function...");const m=await this.signer.getAddress();console.log(" Wallet address:",m);const g=n==="0x0000000000000000000000000000000000000000";let w;if(g){const y=im(r,18);console.log(" Fetching fee structure from contract...");let x,v;try{x=await this.contract.SELLER_EXTRA_BPS(),v=await this.contract.BPS_DENOM(),console.log(" Got fee structure from contract")}catch(S){console.warn(" Failed to get fees from contract via signer provider:",S),console.log(" Trying read-only provider as fallback...");try{const C=new Eg(Cw),N=new rr(On,vi,C);x=await N.SELLER_EXTRA_BPS(),v=await N.BPS_DENOM(),console.log(" Got fee structure from read-only provider")}catch(C){console.error(" Failed to get fees from read-only provider:",C),console.warn(" Using default fee values (0% extra fee)"),v=10000n,x=0n}}const E=y*x/v,R=y+E;console.log(" Trade Amount:",gc(y),"BNB"),console.log(" Seller Extra Fee (BPS):",x.toString()),console.log(" Extra Fee Amount:",gc(E),"BNB"),console.log(" Total to Send (sellerTotal):",gc(R),"BNB"),console.log(" Calling lockFundsNative() for NATIVE BNB"),w=await this.contract.lockFundsNative(e,{value:R})}else console.log(" Calling lockFunds() for ERC20 token (WBNB/USDT/USDC)"),w=await this.contract.lockFunds(e);console.log(" Transaction sent:",w.hash),console.log(" Waiting for confirmation...");const b=await w.wait();return console.log(" Transaction confirmed!"),console.log(" Block number:",b.blockNumber),console.log(" Gas used:",b.gasUsed.toString()),console.log(" Funds are now LOCKED on blockchain for 2 hours"),w.hash}catch(p){console.error(" Error locking funds:",p),console.error(" Error details:",{code:p.code,reason:p.reason,message:p.message,data:p.data});const m=this.detectWalletType();if(p.code==="CALL_EXCEPTION"||p.code==="UNPREDICTABLE_GAS_LIMIT"){let g=`Contract call failed in ${m}. `;throw p.data?g+=`Error data: ${p.data}`:(g+=`Possible reasons: Trade ID ${e} may not exist on-chain, trade already locked, or insufficient funds. `,g+="Please verify the trade ID matches the blockchain trade ID."),new Error(g)}throw p.code==="ACTION_REJECTED"?new Error(`Transaction rejected by user in ${m}`):p.code==="INSUFFICIENT_FUNDS"?new Error(`Insufficient balance for transaction in ${m}. Please add more funds.`):p.code==="UNSUPPORTED_OPERATION"?new Error(`Fund locking not supported by ${m}. Please try with a different wallet.`):p.reason?new Error(`Smart contract error: ${p.reason}`):(a=p.message)!=null&&a.includes("User rejected")?new Error(`Transaction rejected by user in ${m}`):(l=p.message)!=null&&l.includes("insufficient funds")?new Error(`Insufficient balance for transaction in ${m}. Please add more funds.`):(d=p.message)!=null&&d.includes("gas")?new Error(`Gas estimation failed in ${m}. Please try again or increase gas limit.`):(u=p.message)!=null&&u.includes("already locked")||(h=p.message)!=null&&h.includes("already released")||(f=p.message)!=null&&f.includes("already cancelled")?p:new Error(`Failed to lock funds on blockchain using ${m}. ${p.message||"Unknown error"}`)}}async releaseFunds(e){throw new Error("Direct release not supported. Seller should use confirmReceived() to release funds.")}async cancelTrade(e){(!this.contract||!this.signer)&&await this.init();try{console.log(" Cancelling trade on blockchain..."),console.log(" Trade ID:",e);const n=await this.contract.cancelTrade(e);return console.log(" Transaction sent:",n.hash),await n.wait(),console.log(" Trade cancelled, funds refunded"),n.hash}catch(n){console.error(" Error cancelling trade:",n);const r=this.detectWalletType();throw n.code==="ACTION_REJECTED"?new Error(`Transaction rejected by user in ${r}`):n.code==="INSUFFICIENT_FUNDS"?new Error(`Insufficient balance for gas fees in ${r}`):n.reason?new Error(`Smart contract error: ${n.reason}`):new Error(`Failed to cancel trade using ${r}`)}}async redeemAfterAppealWindow(e){(!this.contract||!this.signer)&&await this.init();try{console.log(" Redeem after appeal window...",e);const n=await this.contract.redeemAfterAppealWindow(e);return await n.wait(),n.hash}catch(n){console.error(" Error redeeming after appeal window:",n);const r=this.detectWalletType();throw n.code==="ACTION_REJECTED"?new Error(`Transaction rejected by user in ${r}`):n.code==="INSUFFICIENT_FUNDS"?new Error(`Insufficient balance for gas fees in ${r}`):n.reason?new Error(`Smart contract error: ${n.reason}`):new Error(`Failed to redeem after appeal window using ${r}`)}}async markPaid(e){return console.log(" Buyer confirmation is now off-chain only. No blockchain transaction needed."),console.log(" This function is deprecated. Buyer should confirm via frontend/database only."),"OFF_CHAIN_CONFIRMATION"}async confirmReceived(e){var n,r,s,i,o;(!this.contract||!this.signer)&&await this.init();try{console.log(" Seller confirming payment received on blockchain..."),console.log(" Trade ID:",e),console.log(" NEW FLOW: Seller confirmation will release funds immediately to buyer");const a=((n=Xt.getState())==null?void 0:n.walletType)||this.detectWalletType();if(console.log(" Wallet Type:",a),!this.contract)throw new Error("Contract not initialized. Please reconnect your wallet.");let l;if(this.contract.confirmReceived)l=this.contract.confirmReceived,console.log(" Using confirmReceived() function");else if(this.contract.markReceived)l=this.contract.markReceived,console.log(" Using markReceived() function (fallback)");else throw new Error("Neither confirmReceived nor markReceived function found in contract");let d;if(a==="walletconnect"){console.log(" WalletConnect detected - estimating gas...");try{const h=await l.estimateGas(e),f=h*130n/100n;console.log(" Estimated gas:",h.toString()),console.log(" Gas limit with buffer:",f.toString()),d=await l(e,{gasLimit:f}),console.log(" Transaction sent with explicit gas")}catch(h){console.warn(" Gas estimation failed, trying without explicit gas:",h),d=await l(e),console.log(" Transaction sent without explicit gas")}}else d=await l(e),console.log(" Transaction sent");console.log(" Transaction hash:",d.hash),console.log(" Waiting for confirmation...");const u=await d.wait();return console.log(" Payment confirmed and funds released to buyer!"),console.log(" Block number:",u.blockNumber),d.hash}catch(a){console.error(" Error confirming received:",a),console.error(" Error details:",{code:a.code,reason:a.reason,message:a.message,data:a.data});const l=this.detectWalletType(),u=((r=Xt.getState())==null?void 0:r.walletType)||l;if(a.code==="ACTION_REJECTED"||a.code===4001)throw new Error(`Payment confirmation cancelled. You can try again later. The transaction was rejected in ${u}.`);if(a.code==="INSUFFICIENT_FUNDS"||a.code===-32e3)throw new Error(`Insufficient BNB for gas fees in ${u}. Please add more BNB to your wallet for transaction fees.`);if(a.reason)throw new Error(`Smart contract error: ${a.reason}`);if((s=a.message)!=null&&s.includes("User rejected")||(i=a.message)!=null&&i.includes("user rejected")||(o=a.message)!=null&&o.includes("user-denied"))throw new Error("Payment confirmation cancelled. You can try again later.");{const h=a.message||"Unknown error";throw new Error(`Failed to confirm payment on blockchain using ${u}. ${h}`)}}}async markReceived(e){return this.confirmReceived(e)}async getTradeDetails(e){this.contract||await this.init();try{const n=await this.contract.trades(e);console.log(" Raw trade data from contract:",n);const r={0:"CREATED",1:"LOCKED",2:"APPEAL_WINDOW_OPEN",3:"UNDER_DISPUTE",4:"RELEASED",5:"REFUNDED",6:"COMPLETED"};let s;if(typeof n=="object"&&n!==null){s={id:n[0]??n.id,seller:n[1]??n.seller,buyer:n[2]??n.buyer,token:n[3]??n.token,amount:n[4]??n.amount,status:n[5]??n.status,lockedAt:n[6]??n.lockedAt,appealStartAt:n[7]??n.appealStartAt,buyerPaid:n[8]??n.buyerPaid??!1,sellerReceived:n[9]??n.sellerReceived??!1,appealFiled:n[10]??n.appealFiled??!1};const l=String(s.token||"0x0").toLowerCase();s.isNativeLocked=l==="0x0000000000000000000000000000000000000000"||l==="0x0"}else s=n,s.isNativeLocked=!1;const i=Number(s.status),o=r[i]||`UNKNOWN(${i})`;let a=18;try{s.token&&s.token!=="0x0000000000000000000000000000000000000000"&&(a=await new rr(s.token,["function decimals() view returns (uint8)"],this.provider).decimals())}catch(l){console.warn(" Could not fetch token decimals, using default 18:",l)}return{id:Number(s.id),seller:s.seller,buyer:s.buyer,token:s.token,amount:ha(s.amount,a),status:i,statusName:o,lockedAt:s.lockedAt&&Number(s.lockedAt)>0?Number(s.lockedAt):null,appealStartAt:s.appealStartAt&&Number(s.appealStartAt)>0?Number(s.appealStartAt):null,buyerPaid:s.buyerPaid||!1,sellerReceived:s.sellerReceived||!1,appealFiled:s.appealFiled||!1,isNativeLocked:s.isNativeLocked||!1}}catch(n){if(console.error("Error fetching trade details:",n),n.code==="BAD_DATA"&&n.data){console.log(" Attempting manual decoding of trade data...");try{return await this.getTradeDetailsManual(e)}catch(r){throw console.error("Manual decoding also failed:",r),n}}throw n}}async getTradeDetailsManual(e){this.provider||await this.init();try{const n=On,r=new uE(vi),s=r.encodeFunctionData("trades",[e]),i=await this.provider.call({to:n,data:s}),o=r.decodeFunctionResult("trades",i),a={0:"CREATED",1:"LOCKED",2:"APPEAL_WINDOW_OPEN",3:"UNDER_DISPUTE",4:"RELEASED",5:"REFUNDED",6:"COMPLETED"},l=Number(o[5]),d=a[l]||`UNKNOWN(${l})`;let u=18;const h=o[3],f=!h||h==="0x0000000000000000000000000000000000000000"||String(h).toLowerCase()==="0x0";try{f||(u=await new rr(h,["function decimals() view returns (uint8)"],this.provider).decimals())}catch(p){console.warn(" Could not fetch token decimals:",p)}return{id:Number(o[0]),seller:o[1],buyer:o[2],token:o[3],amount:ha(o[4],u),status:l,statusName:d,lockedAt:o[6]&&Number(o[6])>0?Number(o[6]):null,appealStartAt:o[7]&&Number(o[7])>0?Number(o[7]):null,buyerPaid:o[8]||!1,sellerReceived:o[9]||!1,appealFiled:o[10]||!1,isNativeLocked:f}}catch(n){throw console.error("Error in manual decoding:",n),n}}async verifyTradeStatus(e){try{console.log(" Verifying trade status on blockchain..."),console.log(" Trade ID:",e);const n=await this.getTradeDetails(e),r=n.status===4||n.status===6;return console.log(" Trade Status on Blockchain:",{status:n.status,statusName:n.statusName,isReleased:r,buyerPaid:n.buyerPaid,sellerReceived:n.sellerReceived}),{tradeId:e,blockchainStatus:n.status,blockchainStatusName:n.statusName,isReleased:r,seller:n.seller,buyer:n.buyer,amount:n.amount,token:n.token,buyerPaid:n.buyerPaid,sellerReceived:n.sellerReceived,details:n}}catch(n){throw console.error(" Error verifying trade status:",n),new Error(`Failed to verify trade status: ${n.message}`)}}async getNetwork(){this.provider||await this.init();const e=await this.provider.getNetwork();return{name:e.name,chainId:Number(e.chainId)}}async checkNetwork(){const e=await this.getNetwork(),n=56;return e.chainId!==n?(console.warn(` Wrong network! Expected: ${n}, Got: ${e.chainId}`),!1):!0}async switchToBSCMainnet(){if(!window.ethereum)throw new Error("Wallet not found");try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x38"}]})}catch(e){if(e.code===4902)await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x38",chainName:"BSC Mainnet",nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:["https://bsc-dataseed.binance.org/"],blockExplorerUrls:["https://bscscan.com"]}]});else throw e}}}const La=new uIe,hIe=()=>{const[t,e]=A.useState([]);Os(),xu();const[n,r]=A.useState([]),[s,i]=A.useState(!1),[o,a]=A.useState(!1),[l,d]=A.useState("orders"),[u,h]=A.useState("ALL"),[f,p]=A.useState(null),[m,g]=A.useState(Date.now()),[w,b]=A.useState({priceInr:"",minAmount:"",maxAmount:"",active:!0}),[y,x]=A.useState(null),[v,E]=A.useState(null),[R,S]=A.useState(null),[C,N]=A.useState({isOpen:!1,targetAddress:"",targetName:void 0,context:void 0}),[T,$]=A.useState(!1),[U,H]=A.useState(!1),[K,I]=A.useState(null),[j]=A.useState(!1),[F,P]=A.useState(0),[L,B]=A.useState({}),[V,X]=A.useState({isOpen:!1,orderId:""}),[ae,ce]=A.useState({}),[ie,Te]=A.useState({isOpen:!1,orderId:""}),[ue,Q]=A.useState(new Set),[xe,Pe]=A.useState({isOpen:!1,orderId:""}),[Y,me]=A.useState({isOpen:!1,phoneNumber:"",userName:""}),[le,tt]=A.useState({isOpen:!1,appealUrl:"",orderId:""}),[Ve,Ue]=A.useState({isOpen:!1,orderId:"",userRole:"buyer"}),{address:pe,connectionError:it,clearError:An}=Xt(),{user:nt}=ss(),{setUnreadOrdersCount:bn,clearUnreadOrdersCount:Fe}=SV(),ct=A.useRef(new Set),wt=A.useRef(null),ft=A.useRef(null),Rn=A.useRef(null),ro=A.useRef(null),Gt=A.useRef(null),or=A.useRef(null),Ic={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]},Rc=A.useCallback(()=>{console.log(" Orders: Creating peer connection");const _=new RTCPeerConnection(Ic);return _.onicecandidate=G=>{G.candidate&&Gt.current&&(console.log(" Orders: Sending ICE candidate to",Gt.current),ft.current.emit("ice-candidate",{candidate:G.candidate,to:Gt.current}))},_.ontrack=G=>{console.log(" Orders: Received remote track:",G.track.kind),G.streams&&G.streams[0]&&console.log(" Orders: Remote audio stream received")},_.onconnectionstatechange=()=>{console.log(" Orders: Connection state:",_.connectionState),_.connectionState==="connected"?(console.log(" Orders: Call connected!"),$(!0),D.success("Call connected!")):(_.connectionState==="disconnected"||_.connectionState==="failed")&&(console.log(" Orders: Call disconnected"),$(!1),I(null),D("Call ended",{icon:""}))},_},[]),Ml=A.useCallback(()=>{console.log(" Orders: Cleaning up call state"),Rn.current&&(Rn.current.close(),Rn.current=null),ro.current&&(ro.current.getTracks().forEach(_=>_.stop()),ro.current=null),$(!1),I(null),N({isOpen:!1,targetAddress:"",targetName:void 0,context:void 0}),Gt.current=null,P(Date.now()),console.log(" Orders: Call state cleaned up")},[pe]),Xs=A.useCallback(async()=>{if(K)try{console.log(" Orders: Accepting incoming call from",K.from);const _=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});ro.current=_,Gt.current=K.from,Rn.current=Rc(),_.getAudioTracks().forEach(J=>{Rn.current.addTrack(J,_)}),await Rn.current.setRemoteDescription(new RTCSessionDescription(K.offer));const G=await Rn.current.createAnswer();await Rn.current.setLocalDescription(G),ft.current.emit("answer",{answer:G,to:K.from}),N({isOpen:!0,targetAddress:K.from,targetName:`User ${K.from.slice(0,8)}`,context:"Incoming Call"}),I(null),$(!0),D.success("Call accepted!")}catch(_){console.error(" Orders: Error accepting call:",_),D.error("Failed to accept call"),I(null)}},[K,Rc]);A.useEffect(()=>{if(!(nt!=null&&nt.address))return;const _=window.location.origin;ft.current=jo(_),ft.current.on("disconnect",()=>{console.log(" Orders: Disconnected from signaling server"),H(!1)}),ft.current.on("reconnect",()=>{console.log(" Orders: Reconnected to signaling server"),nt!=null&&nt.address&&ft.current&&(ft.current.emit("register",nt.address),H(!0))}),ft.current.on("connect",()=>{console.log(" Orders: Connected to signaling server"),nt!=null&&nt.address&&ft.current&&(ft.current.emit("register",nt.address),H(!0),console.log(" Orders: User re-registered:",nt.address))}),or.current=setInterval(()=>{ft.current&&ft.current.connected&&(nt!=null&&nt.address)&&ft.current.emit("ping")},3e4);const G=async({offer:Ee,from:je})=>{console.log(" Orders: Received incoming call from",je),D.success(`Incoming call from ${je.slice(0,8)}...`),j?(console.log(" Orders: Auto-accepting incoming call"),I({from:je,offer:Ee,isOpen:!0}),setTimeout(()=>{Xs()},1e3)):I({from:je,offer:Ee,isOpen:!0})},J=({candidate:Ee,from:je})=>{console.log(" Orders: Received ICE candidate from",je),Rn.current&&Ee&&Rn.current.addIceCandidate(new RTCIceCandidate(Ee)).catch(be=>console.error("Error adding ICE candidate:",be))},de=async({answer:Ee,from:je})=>{console.log(" Orders: Received answer from",je),Rn.current&&(await Rn.current.setRemoteDescription(new RTCSessionDescription(Ee)),$(!0),D.success("Call connected!"))},oe=({from:Ee})=>{console.log(" Orders: Call ended by",Ee),Ml(),D("Call ended",{icon:""})},he=({target:Ee})=>{console.log(" Orders: Target user not found:",Ee),D.error("User not available for calling"),Ml()};return ft.current.on("offer",G),ft.current.on("ice-candidate",J),ft.current.on("answer",de),ft.current.on("call-ended",oe),ft.current.on("user-not-found",he),ft.current.on("registration-confirmed",({userId:Ee,socketId:je})=>{console.log(" Orders: Registration confirmed:",{userId:Ee,socketId:je}),H(!0)}),ft.current.on("user-status",({userId:Ee,isOnline:je,socketId:be})=>{console.log(" Orders: User status:",{userId:Ee,isOnline:je,socketId:be})}),ft.current.on("pong",()=>{console.log(" Orders: Heartbeat received")}),ft.current.on("online-users",Ee=>{console.log(" Orders: Online users:",Ee)}),()=>{ft.current&&(ft.current.off("offer",G),ft.current.off("ice-candidate",J),ft.current.off("answer",de),ft.current.off("call-ended",oe),ft.current.off("user-not-found",he),ft.current.disconnect()),or.current&&clearInterval(or.current)}},[nt==null?void 0:nt.address,Xs,Ml,j]);const ei=A.useCallback(()=>{console.log(" Orders: Rejecting incoming call from",K==null?void 0:K.from),I(null),D("Call rejected",{icon:""})},[K]);A.useCallback(async()=>!ft.current||!(nt!=null&&nt.address)?(console.log(" Orders: No socket or user address"),!1):ft.current.connected?(U||(console.log(" Orders: User not registered, re-registering"),ft.current.emit("register",nt.address),H(!0),await new Promise(_=>setTimeout(_,1e3))),U):(console.log(" Orders: Socket not connected, attempting to reconnect"),!1),[U,nt==null?void 0:nt.address]),A.useCallback(_=>new Promise(G=>{if(!ft.current){G(!1);return}const J=setTimeout(()=>{console.log(" Orders: User status check timeout"),G(!1)},3e3);ft.current.once("user-status",({userId:de,isOnline:oe})=>{clearTimeout(J),console.log(" Orders: User status received:",{userId:de,isOnline:oe}),G(oe)}),ft.current.emit("check-user-status",_)}),[]),A.useEffect(()=>{console.log(" Orders useEffect: Address changed:",pe),pe?(console.log(" Orders useEffect: Fetching orders and ads for address:",pe),qr(),Bf()):console.log(" Orders useEffect: No address, skipping fetch")},[pe]),A.useEffect(()=>{Fe()},[Fe]);const[Nu,_a]=A.useState(0);A.useEffect(()=>{const _=setInterval(()=>{_a(G=>G+1),g(G=>G+1e3)},1e3);return()=>clearInterval(_)},[]),A.useEffect(()=>{if(!pe)return;const _=setInterval(()=>{console.log(" Auto-refreshing orders every 20 seconds..."),qr()},15e3);return()=>clearInterval(_)},[pe]);const qr=async()=>{var G;console.log(" fetchOrders: Starting to fetch orders"),i(!0),x(null);const _=t;try{let J=localStorage.getItem("authToken")||"";if(console.log(" fetchOrders: Token exists:",!!J),!J&&pe){console.log(" Orders: No token but wallet connected, attempting auto-login...");try{const be="Sign this message to authenticate with Zotrust",we=await window.ethereum.request({method:"personal_sign",params:[be,pe]}),{loginWithWallet:Ae}=ss.getState();await Ae(pe,we,be)&&(J=localStorage.getItem("authToken")||"",console.log(" Orders: Auto-login successful, token:",!!J))}catch(be){console.error(" Orders: Auto-login failed:",be)}}const de=await fetch("/api/orders/my-orders",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${J}`}});if(console.log(" fetchOrders: Response status:",de.status),!de.ok){let be="";try{const we=await de.json();be=(we==null?void 0:we.error)||(we==null?void 0:we.message)||String(de.status),console.log(" fetchOrders: Error response:",we)}catch{}throw new Error(be||`HTTP ${de.status}`)}const oe=await de.json();console.log(" fetchOrders: Raw response data:",oe);const he=oe.data||[];if(console.log(" fetchOrders: Orders count:",he.length),(G=oe.meta)!=null&&G.server_time){const be=new Date(oe.meta.server_time).getTime();g(be);const we=Date.now(),Ae=Math.abs(be-we),mt=Math.floor(Ae/1e3);console.log(" fetchOrders: Server time sync:",{server_time:oe.meta.server_time,server_time_ms:be,server_time_utc:new Date(be).toUTCString(),server_time_local:new Date(be).toLocaleString(),local_time_ms:we,local_time_utc:new Date(we).toUTCString(),local_time_local:new Date(we).toLocaleString(),time_diff_seconds:mt,note:mt>60?" System time might be wrong!":" Time in sync"})}const Ee=he.map(be=>({id:String(be.id),adId:String(be.ad_id),adType:be.ad_type,buyerAddress:be.buyer_address,sellerAddress:be.seller_address,amount:Number(be.amount),token:be.token,priceInr:Number(be.price_inr??0),state:be.state,agentBranch:be.agent_branch||be.branch_name||"",agentNumber:be.agent_number||be.agent_mobile||"",agentAddress:be.agent_address||"",createdAt:be.created_at,startTime:be.start_time,timezone:be.timezone,startDatetimeString:be.start_datetime_string,acceptedAt:be.accepted_at,lockExpiresAt:be.lock_expires_at,txHash:be.tx_hash||void 0,adOwnerAddress:be.ad_owner_address,...be.blockchain_trade_id?{blockchain_trade_id:be.blockchain_trade_id}:{},...be.buyer_name?{buyerName:be.buyer_name}:{},...be.seller_name?{sellerName:be.seller_name}:{}}));e(Ee);const je=Ee.filter(be=>be.state==="CREATED"||be.state==="LOCKED");je.length>0?bn(je.length):Fe(),_.length>0&&Ee.forEach(be=>{const we=_.find(Ae=>Ae.id===be.id);we&&we.state==="ACCEPTED"&&be.state==="LOCKED"&&be.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase())&&(ue.has(be.id)||(console.log(" Funds locked! Showing popover to buyer for order:",be.id),Te({isOpen:!0,orderId:be.id}))),we&&we.state==="LOCKED"&&be.state!=="LOCKED"&&ie.isOpen&&ie.orderId===be.id&&(console.log(" Order status changed, closing popover for order:",be.id),Te({isOpen:!1,orderId:""}))})}catch(J){console.error(" fetchOrders: Error:",J),x(`Failed to load orders${J!=null&&J.message?`: ${J.message}`:""}`)}finally{i(!1)}},Bf=async()=>{a(!0),E(null);try{let _=localStorage.getItem("authToken")||"";if(!_&&pe)try{const he="Sign this message to authenticate with Zotrust",Ee=await window.ethereum.request({method:"personal_sign",params:[he,pe]}),{loginWithWallet:je}=ss.getState();await je(pe,Ee,he)&&(_=localStorage.getItem("authToken")||"")}catch(he){console.error(" Orders: Auto-login failed:",he)}const G=await fetch("/api/ads/my-ads",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`}});if(!G.ok){let he="";try{const Ee=await G.json();he=(Ee==null?void 0:Ee.error)||(Ee==null?void 0:Ee.message)||String(G.status),console.log(" fetchMyAds: Error response:",Ee)}catch{}throw new Error(he||`HTTP ${G.status}`)}const oe=((await G.json()).data||[]).map(he=>{var Ee,je;return{id:he.id.toString(),ownerAddress:he.owner_address,ownerSelectedAgentId:(Ee=he.owner_selected_agent_id)==null?void 0:Ee.toString(),type:he.type,token:he.token,priceInr:he.price_inr.toString(),minAmount:he.min_amount.toString(),maxAmount:he.max_amount.toString(),lockDurationSeconds:he.lock_duration_seconds,city:he.city,active:he.active,createdAt:he.created_at,agent:he.branch_name?{id:((je=he.owner_selected_agent_id)==null?void 0:je.toString())||"1",branchName:he.branch_name,city:he.city||"Mumbai",address:he.agent_address||"",mobile:he.agent_mobile||"",verified:!0,createdByAdmin:"1",createdAt:new Date().toISOString()}:void 0}});console.log(" fetchMyAds: Mapped ads:",oe),r(oe)}catch(_){console.error(" fetchMyAds: Error:",_),E(`Failed to load ads${_!=null&&_.message?`: ${_.message}`:""}`)}finally{a(!1)}},$f=async _=>{console.log(" handleAcceptOrder: Accepting order:",_);const G=t.find(de=>de.id===_);if(!G){D.error("Order not found");return}const J=De(G);if(J.isExpired){D.error(`Order expired. Max wait time is ${ZE.ACCEPT_TIMEOUT_MINUTES} minutes.`),console.log(" Order expired:",{orderId:G.id,startTimeIST:J.startTimeIST,expiryTimeIST:J.expiryTimeIST,timeRemaining:J.timeRemainingSeconds});return}try{const de=localStorage.getItem("authToken")||"";D.loading("Accepting order...",{id:"accept-flow"});const oe=await fetch(`/api/orders/${_}/accept-simple`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${de}`}});if(!oe.ok){const Ee=await oe.json();D.error(Ee.error||"Failed to accept order",{id:"accept-flow"});return}const he=await oe.json();console.log(" Order accepted:",he),D.success("Order accepted! Seller will now lock funds on blockchain.",{id:"accept-flow",duration:4e3}),qr()}catch(de){console.error(" handleAcceptOrder Error:",de),D.error("Failed to accept order",{id:"accept-flow"})}},gb=async _=>{try{if(!window.ethereum||!pe)return{hasEnoughBalance:!1,message:"Wallet not connected"};const G=new Dr(window.ethereum),J=(_==null?void 0:_.token)||"BNB",de=hh[J]||hh.BNB,oe=de.address,he=de.isNative||!1,Ee=(_==null?void 0:_.amount)||0;if(he){const je=await G.getBalance(pe),be=parseFloat(gc(je)),we=parseFloat(Ee.toString()),Ae=.001,mt=we+Ae;if(be<mt){const fs=mt-be;return{hasEnoughBalance:!1,message:`Insufficient BNB balance!

Required: ${mt.toFixed(6)} BNB (${we.toFixed(6)} BNB for lock + ${Ae.toFixed(6)} BNB for gas)
Your Balance: ${be.toFixed(6)} BNB
Shortfall: ${fs.toFixed(6)} BNB

Please add more BNB to your wallet.`}}return{hasEnoughBalance:!0,message:""}}else{const je=new rr(oe,z8,G),be=await je.balanceOf(pe),we=await je.decimals(),Ae=parseFloat(ha(be,we)),mt=parseFloat(Ee.toString()),fs=await G.getBalance(pe),Ia=parseFloat(gc(fs)),vn=.001;if(Ae<mt){const Mr=mt-Ae;return{hasEnoughBalance:!1,message:`Insufficient ${J} balance!

Required: ${mt.toFixed(6)} ${J}
Your Balance: ${Ae.toFixed(6)} ${J}
Shortfall: ${Mr.toFixed(6)} ${J}

Please add more ${J} to your wallet.`}}return Ia<vn?{hasEnoughBalance:!1,message:`Insufficient BNB for gas fees!

You have enough ${J} but need BNB for transaction fees.
Required: ${vn.toFixed(6)} BNB
Your Balance: ${Ia.toFixed(6)} BNB

Please add at least ${vn.toFixed(6)} BNB to your wallet for gas fees.`}:{hasEnoughBalance:!0,message:""}}}catch(G){return console.error("Error checking balance:",G),{hasEnoughBalance:!1,message:`Failed to check balance: ${G.message||"Unknown error"}`}}},a0=async _=>{var J,de;console.log(" handleLockFunds: Starting fund lock process:",_);const G=t.find(oe=>oe.id===_);if(!G){D.error("Order not found");return}try{console.log(" Checking balance before lock..."),D.loading("Checking balance...",{id:"lock-flow"});const oe=await gb(G);if(!oe.hasEnoughBalance){D.error(oe.message,{id:"lock-flow",duration:1e4});return}D.dismiss("lock-flow");const he=localStorage.getItem("authToken")||"";console.log(" Step 1: Getting OTP..."),D.loading("Preparing fund lock...",{id:"lock-flow"});const Ee=await fetch(`/api/orders/${_}/prepare-lock`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${he}`}});if(!Ee.ok){const Ra=await Ee.json();throw new Error(Ra.error||"Failed to prepare lock")}const je=await Ee.json();console.log(" Step 1 Complete: OTP received:",je.data.otp),console.log(" OTP Hash:",je.data.otpHash),D.success(`OTP: ${je.data.otp} - SAVE THIS!`,{id:"lock-flow",duration:8e3,icon:""});const be=La.getWalletInstructions();if(!window.confirm(` Your OTP: ${je.data.otp}

 SAVE THIS OTP!

Your funds will be locked for 2 hours. Once you have received the funds, please click the 'Received' button to confirm.

 ${be}

Click OK to lock ${G==null?void 0:G.amount} ${G==null?void 0:G.token} on blockchain.`)){D.error("Lock cancelled",{id:"lock-flow"});return}console.log(" Step 2: Creating trade and locking funds..."),D.loading("Creating trade and locking funds on blockchain...",{id:"lock-flow"}),console.log(" Wallet instructions:",La.getWalletInstructions());const Ae=(G==null?void 0:G.token)||"BNB",mt=hh[Ae]||hh.BNB,fs=mt.address,Ia=mt.isNative||!1;let vn="";(G==null?void 0:G.adType)==="SELL"?vn=G.buyerAddress:vn=G.adOwnerAddress||G.buyerAddress;let Mr,Su,Tu;try{const Ra=await La.createTradeAndLockFunds({token:fs,amount:((J=G==null?void 0:G.amount)==null?void 0:J.toString())||"0",buyer:vn,isNativeBNB:Ia},fs,((de=G==null?void 0:G.amount)==null?void 0:de.toString())||"0");Mr=Ra.tradeId,Su=Ra.createTradeTxHash,Tu=Ra.lockFundsTxHash,console.log(" Step 2 Complete: Trade created and funds locked!"),console.log(" Trade ID:",Mr),console.log(" Create Trade TX Hash:",Su),console.log(" Lock Funds TX Hash:",Tu);try{const l0=await La.verifyTradeStatus(Number(Mr));console.log(" Post-lock verify:",l0),!l0.isReleased&&l0.blockchainStatusName!=="LOCKED"&&D("Chain not yet LOCKED, retry after a few seconds.",{icon:""})}catch(l0){console.warn("Post-lock verification failed:",l0)}D.success(`Trade created and funds locked! ID: ${Mr}`,{id:"lock-flow",duration:5e3})}catch(Ra){console.error(" Step 2 FAILED:",Ra),D.error(`Failed to create trade and lock funds: ${Ra.message}`,{id:"lock-flow",duration:8e3});return}console.log(" Step 3: Updating database..."),console.log(" Step 3: Data to send:",{txHash:Tu,otpHash:je.data.otpHash,blockchainTradeId:Mr,blockchainTradeIdType:typeof Mr,createTradeTxHash:Su});const wb=Number(Mr);if(isNaN(wb)||wb<=0){console.error(" Step 3: Invalid blockchain trade ID:",Mr),D.error("Invalid blockchain trade ID. Please try again.",{id:"lock-flow"});return}console.log(" Step 3: Validated trade ID to send:",wb),D.loading("Finalizing...",{id:"lock-flow"});const Ej=await fetch(`/api/orders/${_}/lock-funds`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${he}`},body:JSON.stringify({txHash:Tu,otpHash:je.data.otpHash,blockchainTradeId:wb,createTradeTxHash:Su})});if(Ej.ok)console.log(" Step 3 Complete: Database updated"),D.success(`Funds locked successfully!
OTP: ${je.data.otp}
Trade ID: ${Mr}`,{id:"lock-flow",duration:1e4,icon:""}),console.log(" View TX: https://bscscan.com/tx/"+Tu),qr();else{const Ra=await Ej.json();D.error(Ra.error||"Failed to finalize",{id:"lock-flow"})}}catch(oe){console.error(" handleLockFunds Error:",oe),D.error("Failed to lock funds",{id:"lock-flow"})}},c0=async _=>{console.log(" handleRejectOrder: Rejecting order:",_);try{const G=localStorage.getItem("authToken")||"";console.log(" handleRejectOrder: Token exists:",!!G);const J=await fetch(`/api/orders/${_}/cancel`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${G}`},body:JSON.stringify({reason:"Rejected by seller"})});if(console.log(" handleRejectOrder: Response status:",J.status),J.ok)console.log(" handleRejectOrder: Order rejected successfully"),D.success("Order rejected"),qr();else{let de="Failed to reject order";try{const oe=await J.json();de=(oe==null?void 0:oe.error)||de,console.log(" handleRejectOrder: Error response:",oe)}catch{}console.error(" handleRejectOrder: Failed to reject order:",de),D.error(de)}}catch(G){console.error(" handleRejectOrder: Error:",G),D.error("Failed to reject order")}},NN=_=>{console.log(" handleEditAd: Starting to edit ad:",_.id),p(_),b({priceInr:_.priceInr,minAmount:_.minAmount,maxAmount:_.maxAmount,active:_.active})},yb=async()=>{if(f){console.log(" handleUpdateAd: Updating ad:",f.id);try{const _=localStorage.getItem("authToken")||"";console.log(" handleUpdateAd: Token exists:",!!_);const G=await fetch(`/api/ads/${f.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`},body:JSON.stringify({price_inr:parseFloat(w.priceInr),min_amount:parseFloat(w.minAmount),max_amount:parseFloat(w.maxAmount),active:w.active})});if(console.log(" handleUpdateAd: Response status:",G.status),G.ok)console.log(" handleUpdateAd: Ad updated successfully"),D.success("Ad updated successfully"),p(null),Bf();else{let J="Failed to update ad";try{const de=await G.json();J=(de==null?void 0:de.error)||J,console.log(" handleUpdateAd: Error response:",de)}catch{}console.error(" handleUpdateAd: Failed to update ad:",J),D.error(J)}}catch(_){console.error(" handleUpdateAd: Error:",_),D.error("Failed to update ad")}}},AN=async _=>{if(console.log(" handleDeleteAd: Deleting ad:",_),!!confirm("Are you sure you want to delete this ad? This action cannot be undone."))try{const G=localStorage.getItem("authToken")||"";console.log(" handleDeleteAd: Token exists:",!!G);const J=await fetch(`/api/ads/${_}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${G}`}});if(console.log(" handleDeleteAd: Response status:",J.status),J.ok)console.log(" handleDeleteAd: Ad deleted successfully"),D.success("Ad deleted successfully"),Bf();else{let de="Failed to delete ad";try{const oe=await J.json();de=(oe==null?void 0:oe.error)||de,console.log(" handleDeleteAd: Error response:",oe)}catch{}console.error(" handleDeleteAd: Failed to delete ad:",de),D.error(de)}}catch(G){console.error(" handleDeleteAd: Error:",G),D.error("Failed to delete ad")}},Au=async _=>{try{const G=localStorage.getItem("authToken")||"",J=await fetch(`/api/disputes/${_}/status`,{headers:{Authorization:`Bearer ${G}`}});if(J.ok){const de=await J.json();return B(oe=>({...oe,[_]:de.data})),de.data}}catch(G){console.error("Error fetching dispute status:",G)}return null},ka=async(_,G)=>{var J,de;try{const oe=t.find(we=>we.id===_);if(!oe){D.error("Order not found");return}if(console.log(oe),oe.state!=="LOCKED"&&oe.state!=="UNDER_DISPUTE"&&oe.state!=="APPEALED"){D.error(`Order must be LOCKED, UNDER_DISPUTE, or APPEALED to confirm payment. Current state: ${oe.state}`);return}let he=(oe==null?void 0:oe.blockchain_trade_id)||(oe==null?void 0:oe.blockchainTradeId);if(!he){console.log(" Blockchain trade ID not in order, fetching from dispute status...");const we=await Au(_);he=Number((we==null?void 0:we.blockchain_trade_id)||(we==null?void 0:we.blockchainTradeId))}if(!he||Number.isNaN(he)){D.error("Missing blockchain trade id. The order may not have been locked on the blockchain yet. Please wait for the seller to lock funds."),console.error("Missing blockchain_trade_id for order:",{orderId:_,orderState:oe.state,orderData:oe});return}G==="SENT"?(console.log(" Buyer confirming payment sent (OFF-CHAIN only)..."),console.log(" NEW FLOW: Buyer confirmation is off-chain, no blockchain transaction needed")):(console.log(" Seller confirming payment received (ON-CHAIN)..."),console.log(" NEW FLOW: Seller confirmation will release funds immediately to buyer"),await La.confirmReceived(he));const Ee=localStorage.getItem("authToken")||"",je=G==="SENT"?`/api/disputes/${_}/confirm-payment-sent`:`/api/disputes/${_}/confirm-payment-received`,be=await fetch(je,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ee}`}});if(be.ok){const we=await be.json();D.success(we.data.message||"Payment confirmation recorded"),Au(_),qr()}else{const we=await be.json();D.error(we.error||"Failed to confirm payment")}}catch(oe){console.error("Error confirming payment:",oe),(J=oe==null?void 0:oe.message)!=null&&J.includes("cancelled")||(de=oe==null?void 0:oe.message)!=null&&de.includes("rejected")||(oe==null?void 0:oe.code)==="ACTION_REJECTED"||(oe==null?void 0:oe.code)===4001?D("Payment confirmation cancelled. You can try again when ready.",{icon:"",duration:4e3}):D.error((oe==null?void 0:oe.reason)||(oe==null?void 0:oe.message)||"Failed to confirm payment")}},Ff=_=>{if(!pe){D.error("Please connect your wallet first");return}const J=window.location.href.split("/#")[0],de=pe;let oe;J.includes("/orders")?oe=`${J}/appeal/${de}/${_}`:oe=`${J}/orders/appeal/${de}/${_}`,tt({isOpen:!0,appealUrl:oe,orderId:_})},SN=async(_,G)=>{try{const J=localStorage.getItem("authToken")||"",de=await fetch(`/api/disputes/${_}/appeal`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${J}`},body:JSON.stringify(G)});if(de.ok){const oe=await de.json();D.success(oe.data.message||"Appeal filed successfully"),Au(_),X({isOpen:!1,orderId:""})}else{const oe=await de.json();D.error(oe.error||"Failed to file appeal")}}catch(J){console.error("Error filing appeal:",J),D.error("Failed to file appeal")}},TN=_=>{X({isOpen:!0,orderId:_}),Au(_)},W=_=>{const G=Math.floor(_/60),J=_%60;return`${G}:${J.toString().padStart(2,"0")}`},te=()=>{const _="2025-10-21T23:20:52.347Z",G=new Date(_),J=5.5*60*60*1e3,de=new Date(G.getTime()+J);console.log(" Timezone Conversion Test:",{inputUTC:_,utcDate:G.toISOString(),istOffset:"+05:30 (5.5 hours)",istOffsetMs:J,istDate:de.toISOString(),istFormatted:re(de),expectedIST:"22/10/2025, 04:50:52"})};A.useEffect(()=>{te()},[]);const re=_=>_.toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),ve=A.useCallback(_=>{const G=new Date(_),J=5.5*60*60*1e3,de=new Date(G.getTime()+J),oe=de.getDate(),Ee=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][de.getMonth()],je=de.getHours(),be=de.getMinutes(),we=je>=12?"PM":"AM",Ae=je%12||12,mt=be.toString().padStart(2,"0");return`${oe} ${Ee} ${Ae}:${mt} ${we}`},[]),De=A.useCallback(_=>{const G=new Date(_.startTime),J=5.5*60*60*1e3,de=new Date(G.getTime()+J),oe=new Date(de.getTime()+ZE.ACCEPT_TIMEOUT_MINUTES*60*1e3),he=new Date(m),Ee=new Date(he.getTime()+J),je=oe.getTime()-Ee.getTime(),be=Math.max(0,Math.floor(je/1e3));return{isExpired:be<=0,timeRemainingSeconds:be,startTimeIST:re(de),expiryTimeIST:re(oe)}},[m]),ot=A.useCallback(_=>{if(!_.lockExpiresAt)return{isExpired:!1,timeRemainingSeconds:0,timeRemainingHours:0,timeRemainingMinutes:0,timeRemainingSecs:0,lockExpiresAtIST:""};const G=new Date(_.lockExpiresAt),J=5.5*60*60*1e3,de=new Date(G.getTime()+J),oe=new Date(m),he=new Date(oe.getTime()+J),Ee=de.getTime()-he.getTime(),je=Math.max(0,Math.floor(Ee/1e3)),be=je<=0,we=Math.floor(je/3600),Ae=Math.floor(je%3600/60),mt=je%60;return{isExpired:be,timeRemainingSeconds:je,timeRemainingHours:we,timeRemainingMinutes:Ae,timeRemainingSecs:mt,lockExpiresAtIST:re(de)}},[m]),pt=A.useCallback((_,G,J)=>`${_.toString().padStart(2,"0")}:${G.toString().padStart(2,"0")}:${J.toString().padStart(2,"0")}`,[]),Xe=A.useCallback(_=>{switch(_){case"CREATED":return"text-yellow-400 bg-yellow-500/20";case"ACCEPTED":return"text-blue-400 bg-blue-500/20";case"LOCKED":return"text-purple-400 bg-purple-500/20";case"RELEASED":return"text-green-400 bg-green-500/20";case"CANCELLED":return"text-red-400 bg-red-500/20";case"EXPIRED":return"text-gray-500 bg-gray-600/20";case"UNDER_DISPUTE":return"text-orange-400 bg-orange-500/20";case"REFUNDED":return"text-gray-400 bg-gray-500/20";default:return"text-gray-400 bg-gray-500/20"}},[]),et=A.useCallback(()=>/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),[]);A.useCallback(async()=>{if(!et())return"desktop";try{if(navigator.permissions&&navigator.permissions.query){const G=await navigator.permissions.query({name:"microphone"});if(console.log(" Microphone permission status:",G.state),G.state==="granted"||G.state==="prompt")return"mobile-browser"}try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(J=>J.stop()),"mobile-browser"}catch(G){return console.log(" Microphone access check:",G),"mobile-app"}}catch(G){return console.log(" Permission check error:",G),"mobile-browser"}},[et]);const ze=A.useCallback(async _=>{var J,de,oe;const G=_==null?void 0:_.toLowerCase();if(G){if(ae[G])return ae[G];if(ct.current.has(G))return new Promise(he=>{const Ee=setInterval(()=>{ae[G]?(clearInterval(Ee),he(ae[G])):ct.current.has(G)||(clearInterval(Ee),he(void 0))},100)});ct.current.add(G);try{const he=await fetch(`/api/auth/user-by-address?address=${_}`);if(he.ok){const Ee=await he.json(),je={name:(J=Ee==null?void 0:Ee.data)==null?void 0:J.name,mobile:((de=Ee==null?void 0:Ee.data)==null?void 0:de.mobile)||((oe=Ee==null?void 0:Ee.data)==null?void 0:oe.phone)};return ce(be=>({...be,[G]:je})),je}}catch(he){console.log("Error fetching user info:",he)}finally{ct.current.delete(G)}}},[ae]),st=A.useCallback(async(_,G)=>{try{if(!pe){D.error("Please connect your wallet first");return}const J=G.sellerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),de=J?G.buyerAddress:G.sellerAddress,he=(ae[de.toLowerCase()]||{}).mobile,Ee=(J?G.buyerName:G.sellerName)||"User";if(!he){D.loading("Fetching contact number...",{id:"fetch-phone"});const je=await ze(de);if(je&&typeof je=="object"&&"mobile"in je&&je.mobile)return D.dismiss("fetch-phone"),st(de,G);D.error("Phone number not available for this user",{id:"fetch-phone"});return}me({isOpen:!0,phoneNumber:he,userName:Ee})}catch(J){console.error("Error handling call:",J),D.error("Failed to initiate call")}},[pe,ae,ze]),Et=A.useMemo(()=>u==="ALL"?t:t.filter(_=>_.state===u),[t,u]);A.useEffect(()=>{if(t.length!==0)return wt.current&&clearTimeout(wt.current),wt.current=setTimeout(()=>{const _=new Set;t.forEach(J=>{_.add(J.buyerAddress.toLowerCase()),_.add(J.sellerAddress.toLowerCase())});const G=Array.from(_).filter(J=>!ae[J]&&!ct.current.has(J));G.length>0&&(console.log(" Orders: Fetching user info for",G.length,"unique addresses"),G.forEach(async J=>{try{await ze(J)}catch(de){console.log("Error fetching user info for",J,de)}}))},500),()=>{wt.current&&clearTimeout(wt.current)}},[t,ze]),A.useEffect(()=>{if(ie.isOpen&&ie.orderId){const _=t.find(G=>G.id===ie.orderId);if(_){const G=_.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),J=_.sellerAddress.toLowerCase(),de=ae[J]||{};G&&!de.mobile&&J&&ze(J)}}},[ie.isOpen,ie.orderId,t,pe,ae,ze]);const jt=A.useCallback(_=>{if(!_.lockExpiresAt)return{canRedeem:!1,timeRemainingSeconds:0,timeRemainingHours:0,timeRemainingMinutes:0,timeRemainingSecs:0,redeemEligibleAt:null,redeemEligibleAtIST:""};const J=new Date(_.lockExpiresAt).getTime()+48*60*60*1e3,oe=J-m,he=Math.max(0,Math.floor(oe/1e3)),Ee=he<=0,je=Math.floor(he/3600),be=Math.floor(he%3600/60),we=he%60,Ae=Ee?null:new Date(J),mt=Ae?re(Ae):"";return{canRedeem:Ee,timeRemainingSeconds:he,timeRemainingHours:je,timeRemainingMinutes:be,timeRemainingSecs:we,redeemEligibleAt:Ae,redeemEligibleAtIST:mt}},[m]),pr=async _=>{var G,J,de,oe;try{const he=Number((_==null?void 0:_.blockchain_trade_id)||(_==null?void 0:_.blockchainTradeId));if(!he||Number.isNaN(he)){D.error("Missing blockchain trade id. This order may not have been locked on the blockchain yet."),console.error("Missing blockchain_trade_id for redeem:",{orderId:_.id,orderState:_.state,orderData:_});return}const Ee=jt(_);if(!Ee.canRedeem){D.error(`Refund not yet available. Please wait ${Ee.timeRemainingHours}h ${Ee.timeRemainingMinutes}m more.`,{duration:6e3});return}if(!window.confirm(` Claim Refund

You will receive:
- Original Amount: ${_.amount} ${_.token}
- Extra (1%): ${(parseFloat(_.amount.toString())*.01).toFixed(6)} ${_.token}
- Total: ${(parseFloat(_.amount.toString())*1.01).toFixed(6)} ${_.token}

This will refund your funds if buyer hasn't paid within 48 hours.

Continue?`)){D("Refund cancelled",{id:"redeem"});return}D.loading("Claiming refund on blockchain...",{id:"redeem"});const be=await La.redeemAfterAppealWindow(he);D.success(` Refund claimed successfully!
You received: ${(parseFloat(_.amount.toString())*1.01).toFixed(6)} ${_.token}
TX: ${be.slice(0,10)}...`,{id:"redeem",duration:1e4}),qr()}catch(he){console.error("Error redeeming:",he),(G=he==null?void 0:he.reason)!=null&&G.includes("Appeal deadline not passed")?D.error("Please wait for 48 hours appeal window to complete",{id:"redeem",duration:6e3}):(J=he==null?void 0:he.reason)!=null&&J.includes("Appeal already filed")?D.error("Buyer has filed an appeal. Admin will resolve the dispute.",{id:"redeem",duration:8e3}):(de=he==null?void 0:he.reason)!=null&&de.includes("Not in appeal window")?D.error("Appeal window not open yet. Please wait for 2 hours after lock.",{id:"redeem",duration:6e3}):(oe=he==null?void 0:he.reason)!=null&&oe.includes("Only seller")?D.error("Only seller can claim refund",{id:"redeem"}):D.error((he==null?void 0:he.reason)||(he==null?void 0:he.message)||"Failed to claim refund",{id:"redeem",duration:6e3})}},mn=async _=>{try{if(!(_.sellerAddress.toLowerCase()===(pe||"").toLowerCase())){D.error("Only seller can release funds on-chain");return}const J=Number((_==null?void 0:_.blockchain_trade_id)||(_==null?void 0:_.blockchainTradeId));if(!J||Number.isNaN(J)){D.error("Missing blockchain trade id. Cannot release on-chain.");return}D.loading("Verifying on-chain status...",{id:"force-release"});const de=await La.verifyTradeStatus(J);if(de.isReleased){D.success(" Already released on-chain!",{id:"force-release"}),qr();return}if(!window.confirm(` Database shows RELEASED but blockchain shows ${de.blockchainStatusName}.

Funds are still locked on blockchain. Do you want to release them now?

This will call confirmReceived() to release funds to buyer.

Trade ID: ${J}
Amount: ${de.amount} ${de.token}`)){D.dismiss("force-release");return}D.loading("Releasing funds on-chain...",{id:"force-release"});const he=await La.confirmReceived(J);console.log(" Funds released on-chain, TX:",he);try{const Ee=localStorage.getItem("authToken")||"",je=await fetch(`/api/disputes/${_.id}/confirm-payment-received`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ee}`}});if(je.ok){const be=await je.json();console.log(" Backend updated:",be)}else console.warn(" Backend update failed, but blockchain release succeeded")}catch(Ee){console.warn(" Backend update error (blockchain release succeeded):",Ee)}D.success(` Funds released on-chain! TX: ${he.slice(0,10)}...`,{id:"force-release",duration:8e3}),qr()}catch(G){console.error(" Error releasing on-chain:",G),D.error((G==null?void 0:G.reason)||(G==null?void 0:G.message)||"Failed to release on-chain",{id:"force-release",duration:8e3})}},Bt=async _=>{try{const G=Number((_==null?void 0:_.blockchain_trade_id)||(_==null?void 0:_.blockchainTradeId));if(!G||Number.isNaN(G)){D.error("Missing blockchain trade id. Cannot verify trade status.");return}D.loading("Checking blockchain status...",{id:"verify-status"});const J=await La.verifyTradeStatus(G);console.log(" Trade Status Verification:",J);const de=_.state,oe=J.blockchainStatusName;let he="",Ee=!1;const je=J.isReleased||J.blockchainStatus===6,be=J.blockchainStatus===6;if(de==="RELEASED"&&!je)_.sellerAddress.toLowerCase()===(pe||"").toLowerCase()?he=` Database shows RELEASED but blockchain shows ${oe}. Click "Release On-Chain" button below to release funds.`:he=` Database shows RELEASED but blockchain shows ${oe}. Seller needs to call confirmReceived() to release funds.`,Ee=!0;else if(de!=="RELEASED"&&je){he=` Blockchain shows ${oe} (funds released) but database shows ${de}. Auto-syncing...`,Ee=!0,D.loading("Syncing order status with blockchain...",{id:"verify-status"});try{const we=localStorage.getItem("authToken")||"",Ae=await fetch(`/api/orders/${_.id}/sync-blockchain-status`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${we}`}});if(Ae.ok){const mt=await Ae.json();console.log(" Blockchain status synced automatically:",mt),setTimeout(()=>{var fs;qr(),(fs=mt.data)!=null&&fs.synced?D.success(` Order status synced! Updated from ${mt.data.previousState} to ${mt.data.newState}`,{id:"verify-status",duration:6e3}):D.success(` Order status verified! Already in sync (${mt.data.currentState})`,{id:"verify-status",duration:5e3})},1e3);return}else console.warn(" Failed to sync blockchain status automatically"),setTimeout(()=>{qr(),D("Order refreshed. Please verify status again.",{id:"verify-status",duration:5e3})},2e3)}catch(we){console.error("Error auto-syncing:",we),setTimeout(()=>{qr(),D("Order refreshed. Please verify status again.",{id:"verify-status",duration:5e3})},2e3)}}else de===oe||de==="RELEASED"&&je?(he=` Status synced! Both database and blockchain show ${oe||"RELEASED"}.`,Ee=!1):(he=` Database: ${de}, Blockchain: ${oe}`,Ee=!1);D.dismiss("verify-status"),Ee?D.error(he,{id:"verify-status",duration:8e3}):D.success(he,{id:"verify-status",duration:5e3}),console.log(" Verification Details:",{tradeId:J.tradeId,databaseState:de,blockchainStatus:J.blockchainStatusName,blockchainStatusNumber:J.blockchainStatus,isReleased:J.isReleased,buyerPaid:J.buyerPaid,sellerReceived:J.sellerReceived,amount:J.amount,token:J.token})}catch(G){console.error("Error verifying trade status:",G),D.error(`Failed to verify: ${G.message}`,{id:"verify-status"})}};return c.jsxs("div",{className:"px-6 space-y-6",children:[c.jsxs("div",{className:"relative text-center space-y-2",children:[T&&c.jsx(ee.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-500 to-blue-500 rounded-lg p-3 mx-auto max-w-sm",children:c.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white",children:[c.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),c.jsx("span",{className:"text-sm font-medium",children:"Call Active"})]})}),C.isOpen&&c.jsx(ee.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg p-3 mx-auto max-w-sm",children:c.jsxs("div",{className:"flex items-center justify-center space-x-2 text-white",children:[c.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),c.jsx("span",{className:"text-sm font-medium",children:"Call Modal Open"})]})}),K&&c.jsx(ee.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-500 to-blue-500 rounded-xl p-6 mx-auto max-w-sm text-white",children:c.jsxs("div",{className:"text-center space-y-4",children:[c.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto",children:c.jsx(fn,{size:32,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Incoming Call"}),c.jsxs("p",{className:"text-sm opacity-90",children:["From: ",K.from.slice(0,8),"...",K.from.slice(-6)]})]}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs(ee.button,{onClick:ei,className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",whileTap:{scale:.95},children:[c.jsx(xr,{size:20}),c.jsx("span",{children:"Reject"})]}),c.jsxs(ee.button,{onClick:Xs,className:"flex-1 bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",whileTap:{scale:.95},children:[c.jsx(fn,{size:20}),c.jsx("span",{children:"Accept"})]})]})]})})]}),it&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Connection Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:it})]}),c.jsx("button",{onClick:An,className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),y&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Orders Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:y})]}),c.jsx("button",{onClick:()=>x(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),v&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Ads Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:v})]}),c.jsx("button",{onClick:()=>E(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),R&&c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-xl p-4 flex items-center space-x-3",children:[c.jsx(qt,{size:20,className:"text-red-400 flex-shrink-0"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 text-sm font-medium",children:"Action Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:R})]}),c.jsx("button",{onClick:()=>S(null),className:"p-1 rounded-lg bg-red-500/20 text-red-300 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:16})})]}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-1 border border-white/20",children:c.jsx("div",{className:"grid grid-cols-2 gap-1",children:["orders","ads"].map(_=>c.jsxs(ee.button,{onClick:()=>d(_),className:Zn("py-3 px-4 rounded-lg font-medium transition-all capitalize",l===_?"bg-gradient-to-r from-blue-500 to-purple-500 text-white":"text-gray-300 hover:text-white"),whileTap:{scale:.98},children:["My ",_]},_))})}),c.jsx("div",{className:" right-0 top-0",children:c.jsx("select",{value:u,onChange:_=>h(_.target.value),className:"text-white bg-slate-900 text-sm rounded-md px-3 py-2",title:"Filter by status",children:["ALL","CREATED","ACCEPTED","LOCKED","RELEASED","CANCELLED","EXPIRED","UNDER_DISPUTE","UNDER_REVIEW","APPEALED","CONFIRMED","REFUNDED"].map(_=>c.jsx("option",{value:_,children:_},_))})}),l==="orders"?c.jsx("div",{className:"space-y-4",children:s?c.jsx("div",{className:"space-y-4",children:[1,2,3].map(_=>c.jsxs("div",{className:"bg-white/10 rounded-xl p-4 animate-pulse",children:[c.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4 mb-2"}),c.jsx("div",{className:"h-3 bg-white/20 rounded w-1/2"})]},_))}):Et.length===0?c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 space-y-4",children:[c.jsx("div",{className:"w-16 h-16 bg-gray-500/20 rounded-full flex items-center justify-center mx-auto",children:c.jsx(Pr,{size:32,className:"text-gray-400"})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"No Orders Yet"}),c.jsx("p",{className:"text-gray-300 text-sm",children:"Your order requests will appear here"})]})]}):c.jsx(Oo,{children:c.jsx("div",{className:"h-[400px] rounded-sm overflow-y-auto ",children:Et.map(_=>{var je,be;const G=De(_),J=G.isExpired,de=G.timeRemainingSeconds,oe=_.sellerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),he=_.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),Ee=((je=_.adOwnerAddress)==null?void 0:je.toLowerCase())===(pe==null?void 0:pe.toLowerCase());return c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white/10 backdrop-blur-lg  mb-2 orounded-xl p-4 border border-white/20 space-y-4",children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"space-y-1 flex-1",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"text-white font-semibold",children:[_.amount," ",_.token]}),c.jsx("span",{className:Zn("px-2 py-1 rounded text-xs font-medium",Xe(_.state)),children:_.state})]}),c.jsxs("p",{className:"text-gray-300 text-sm",children:[oe?"Buyer":"Seller",": ",(oe?_.buyerAddress:_.sellerAddress).slice(0,8)+"..."+(oe?_.buyerAddress:_.sellerAddress).slice(-6)]}),c.jsxs("p",{className:"text-xs text-gray-400",children:["Name: ",(oe?_.buyerName:_.sellerName)||""]}),c.jsxs("p",{className:"text-xs text-gray-400",children:["Mobile: ",((be=ae[(oe?_.buyerAddress:_.sellerAddress).toLowerCase()])==null?void 0:be.mobile)||""]}),c.jsxs("p",{className:"text-xs text-gray-400",children:["You are the ",oe?"Seller":"Buyer"," in this order",Ee&&_.state==="CREATED"&&!J&&c.jsx("span",{className:"text-green-400 font-semibold",children:" - You can Accept/Reject (Ad Owner)"})]}),c.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded px-2 py-1 mt-1 inline-block",children:c.jsxs("p",{className:"text-xs text-blue-300",children:[" Created: ",c.jsx("span",{className:"font-semibold",children:ve(_.startTime)})]})})]}),_.state==="CREATED"&&c.jsxs("div",{className:"text-right space-y-1 ml-4",children:[c.jsx("p",{className:`font-mono text-xl font-bold ${J?"text-gray-500":de<60?"text-red-500 animate-pulse":"text-yellow-400"}`,children:J?"0:00":W(de)}),!J&&de>0&&c.jsxs("p",{className:"text-xs text-green-400 animate-pulse",children:[" Live countdown: ",de," seconds"]}),c.jsx("p",{className:"text-gray-400 text-xs",children:J?"expired":"remaining"}),c.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5 mt-2",children:c.jsx("div",{className:`h-1.5 rounded-full transition-all ${J?"bg-gray-500":de<60?"bg-red-500":"bg-yellow-400"}`,style:{width:`${J?0:de/300*100}%`}})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"of 5:00 min"})]}),c.jsx("div",{className:"flex space-x-2",children:c.jsxs(ee.button,{onClick:()=>{const we=Ee?oe?_.buyerAddress:_.sellerAddress:_.adOwnerAddress||(he?_.sellerAddress:_.buyerAddress);st(we,_)},className:"p-3 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg hover:from-blue-600 hover:to-purple-600 transition-all duration-200 flex items-center space-x-2",whileTap:{scale:.95},whileHover:{scale:1.05},title:`Call ${Ee?"Order Creator":"Ad Owner"}`,children:[c.jsx(_C,{size:18}),c.jsx("span",{className:"text-sm font-medium",children:"Call"})]})})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-3 space-y-2",children:[c.jsx("p",{className:"text-white text-sm font-medium",children:_.agentBranch}),c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-gray-300 text-xs",children:_.agentAddress}),c.jsx("p",{className:"text-gray-300 text-xs",children:_.agentNumber})]})})]}),_.state==="CREATED"&&Ee&&!J&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-3",children:c.jsxs("div",{className:"flex items-center space-x-2 text-green-400",children:[c.jsx(kt,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:"Action Required: Accept or Reject this order"})]})}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsxs(ee.button,{onClick:()=>$f(_.id),disabled:J,className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white py-2 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",whileTap:{scale:.98},children:[c.jsx(kt,{size:16}),c.jsx("span",{children:"Accept"})]}),c.jsxs(ee.button,{onClick:()=>c0(_.id),className:"flex-1 bg-gradient-to-r from-red-500 to-pink-500 text-white py-2 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",whileTap:{scale:.98},children:[c.jsx(xr,{size:16}),c.jsx("span",{children:"Reject"})]})]})]}),_.state==="ACCEPTED"&&oe&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"bg-orange-500/20 border border-orange-500/30 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-orange-400",children:[c.jsx(Va,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:"Action Required: Lock your funds on blockchain"})]}),c.jsxs("p",{className:"text-xs text-orange-300 mt-2",children:["Order accepted! Now you need to lock ",_.amount," ",_.token," as escrow."]}),c.jsxs("div",{className:"mt-2 p-2 bg-blue-500/10 border border-blue-500/20 rounded text-xs text-blue-300",children:[" ",La.getWalletInstructions()]})]}),c.jsxs(ee.button,{onClick:()=>a0(_.id),className:"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 shadow-lg hover:from-orange-600 hover:to-red-600 transition-all",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsx(Va,{size:18}),c.jsx("span",{children:" Lock Funds on Blockchain"})]})]}),!1,he&&c.jsxs("div",{className:"space-y-3",children:[_.state==="ACCEPTED"&&c.jsxs("div",{className:"flex items-center space-x-2 text-blue-400 bg-blue-500/20 p-3 rounded-lg",children:[c.jsx(kt,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:"Order accepted! Contact the agent to complete payment"})]}),_.state==="LOCKED"&&(()=>{const we=ue.has(_.id),Ae=ot(_);return c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-purple-400 bg-purple-500/20 p-3 rounded-lg",children:[c.jsx(Va,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:" Funds locked - Proceed to agent for payment"})]}),_.lockExpiresAt&&c.jsxs("div",{className:"bg-gradient-to-r from-purple-500/20 to-blue-500/20 border border-purple-500/30 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Pr,{size:18,className:"text-purple-300"}),c.jsx("span",{className:"text-sm font-semibold text-purple-300",children:"Lock Expires In"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[Ae.isExpired?c.jsx("span",{className:"text-red-400 text-sm font-bold",children:"EXPIRED"}):c.jsx("span",{className:`font-mono text-xl font-bold ${Ae.timeRemainingHours===0&&Ae.timeRemainingMinutes<30?"text-red-500 animate-pulse":Ae.timeRemainingHours===0?"text-orange-400":"text-green-400"}`,children:pt(Ae.timeRemainingHours,Ae.timeRemainingMinutes,Ae.timeRemainingSecs)}),c.jsx(ee.button,{onClick:()=>Ue({isOpen:!0,orderId:_.id,userRole:"buyer"}),className:"p-2 rounded-full bg-yellow-500/20 hover:bg-yellow-500/30 border border-yellow-500/30 transition-colors",whileTap:{scale:.95},whileHover:{scale:1.1},title:"Important Instructions",children:c.jsx(qt,{size:20,className:"text-yellow-400"})})]})]}),!Ae.isExpired&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full transition-all ${Ae.timeRemainingHours===0&&Ae.timeRemainingMinutes<30?"bg-red-500":Ae.timeRemainingHours===0?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.max(0,Math.min(100,Ae.timeRemainingSeconds/7200*100))}%`}})}),c.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[c.jsxs("span",{children:["Lock expires at: ",Ae.lockExpiresAtIST]}),c.jsxs("span",{children:[Ae.timeRemainingHours,"h ",Ae.timeRemainingMinutes,"m remaining"]})]})]}),Ae.isExpired&&c.jsx("div",{className:"text-red-400 text-sm mt-2",children:" Lock period has expired. Appeal window is now open."})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs(ee.button,{onClick:()=>{Pe({isOpen:!0,orderId:_.id}),Q(mt=>new Set(mt).add(_.id))},className:"flex-1 bg-gradient-to-r from-purple-500 to-blue-500 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2 shadow-lg hover:from-purple-600 hover:to-blue-600 transition-all",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsx("span",{children:" View Payment Details"}),!we&&c.jsx("span",{className:"ml-2 bg-yellow-400 text-yellow-900 text-xs px-2 py-0.5 rounded-full font-bold",children:"New"})]}),he&&(_==null?void 0:_.blockchain_trade_id)&&c.jsxs(ee.button,{onClick:()=>ka(_.id,"SENT"),className:"bg-blue-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.98},title:"Confirm payment sent (off-chain only - no gas fee)",children:[c.jsx(kt,{size:18}),c.jsx("span",{children:"Confirm"})]})]})]})})(),_.state==="RELEASED"&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-green-400 bg-green-500/20 p-3 rounded-lg",children:[c.jsx(kt,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:"Order completed successfully!"})]}),(_==null?void 0:_.blockchain_trade_id)&&c.jsxs(ee.button,{onClick:()=>Bt(_),className:"w-full bg-blue-500/20 border border-blue-500/30 text-blue-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"Verify if funds were actually released on blockchain",children:[c.jsx(kt,{size:14}),c.jsx("span",{children:" Verify Blockchain Status"})]}),(_==null?void 0:_.blockchain_trade_id)&&oe&&c.jsxs(ee.button,{onClick:()=>mn(_),className:"w-full bg-orange-500/20 border border-orange-500/30 text-orange-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-orange-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"If blockchain still shows LOCKED, release funds on-chain",children:[c.jsx(Va,{size:14}),c.jsx("span",{children:"Release On-Chain (Seller)"})]})]}),_.state==="CANCELLED"&&c.jsxs("div",{className:"flex items-center space-x-2 text-red-400 bg-red-500/20 p-3 rounded-lg",children:[c.jsx(xr,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:"Order was cancelled"})]})]}),oe&&_.state==="LOCKED"&&(()=>{const we=ot(_);return c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-purple-400 bg-purple-500/20 p-3 rounded-lg",children:[c.jsx(Va,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:" Funds locked - Wait for buyer to complete payment"})]}),_.lockExpiresAt&&c.jsxs("div",{className:"bg-gradient-to-r from-purple-500/20 to-blue-500/20 border border-purple-500/30 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Pr,{size:18,className:"text-purple-300"}),c.jsx("span",{className:"text-sm font-semibold text-purple-300",children:"Lock Expires In"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[we.isExpired?c.jsx("span",{className:"text-red-400 text-sm font-bold",children:"EXPIRED"}):c.jsx("span",{className:`font-mono text-xl font-bold ${we.timeRemainingHours===0&&we.timeRemainingMinutes<30?"text-red-500 animate-pulse":we.timeRemainingHours===0?"text-orange-400":"text-green-400"}`,children:pt(we.timeRemainingHours,we.timeRemainingMinutes,we.timeRemainingSecs)}),c.jsx(ee.button,{onClick:()=>Ue({isOpen:!0,orderId:_.id,userRole:"seller"}),className:"p-2 rounded-full bg-yellow-500/20 hover:bg-yellow-500/30 border border-yellow-500/30 transition-colors",whileTap:{scale:.95},whileHover:{scale:1.1},title:"Important Instructions",children:c.jsx(qt,{size:20,className:"text-yellow-400"})})]})]}),!we.isExpired&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full transition-all ${we.timeRemainingHours===0&&we.timeRemainingMinutes<30?"bg-red-500":we.timeRemainingHours===0?"bg-orange-500":"bg-green-500"}`,style:{width:`${Math.max(0,Math.min(100,we.timeRemainingSeconds/7200*100))}%`}})}),c.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[c.jsxs("span",{children:["Lock expires at: ",we.lockExpiresAtIST]}),c.jsxs("span",{children:[we.timeRemainingHours,"h ",we.timeRemainingMinutes,"m remaining"]})]})]}),we.isExpired&&c.jsx("div",{className:"text-red-400 text-sm mt-2",children:" Lock period has expired. Appeal window is now open."})]}),we.isExpired&&(()=>{const Ae=jt(_);return c.jsxs("div",{className:"bg-gradient-to-r from-orange-500/20 to-red-500/20 border border-orange-500/30 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Pr,{size:18,className:"text-orange-300"}),c.jsx("span",{className:"text-sm font-semibold text-orange-300",children:Ae.canRedeem?" Ready to Claim Refund":" Time Until Refund Available"})]}),c.jsx("div",{className:"flex items-center space-x-3",children:Ae.canRedeem?c.jsx("span",{className:"text-green-400 text-sm font-bold",children:"ELIGIBLE"}):c.jsx("span",{className:`font-mono text-xl font-bold ${Ae.timeRemainingHours===0&&Ae.timeRemainingMinutes<60?"text-red-500 animate-pulse":Ae.timeRemainingHours<6?"text-orange-400":"text-yellow-400"}`,children:pt(Ae.timeRemainingHours,Ae.timeRemainingMinutes,Ae.timeRemainingSecs)})})]}),!Ae.canRedeem&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full transition-all ${Ae.timeRemainingHours===0&&Ae.timeRemainingMinutes<60?"bg-red-500":Ae.timeRemainingHours<6?"bg-orange-500":"bg-yellow-500"}`,style:{width:`${Math.max(0,Math.min(100,Ae.timeRemainingSeconds/(48*60*60)*100))}%`}})}),c.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[c.jsxs("span",{children:["Refund available at: ",Ae.redeemEligibleAtIST||"Calculating..."]}),c.jsxs("span",{children:[Ae.timeRemainingHours,"h ",Ae.timeRemainingMinutes,"m remaining"]})]}),c.jsx("p",{className:"text-xs text-orange-300 mt-2",children:" After 48 hours from appeal window opening, you can claim your full refund (amount + 1% extra)"})]}),Ae.canRedeem&&c.jsxs("div",{className:"mt-3",children:[c.jsx("p",{className:"text-sm text-green-300 mb-2",children:" 48 hours have passed! You can now claim your refund if buyer hasn't paid."}),c.jsxs(ee.button,{onClick:()=>pr(_),className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 transition-all flex items-center justify-center space-x-2 shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},title:"Claim full refund (amount + 1% extra) after 48 hours appeal window",children:[c.jsx(xr,{size:18}),c.jsx("span",{children:" Claim Refund (Amount + 1% Extra)"})]}),c.jsxs("p",{className:"text-xs text-green-300 mt-2 text-center",children:["You will receive: ",_.amount," ",_.token," + ",(parseFloat(_.amount.toString())*.01).toFixed(6)," ",_.token," = ",(parseFloat(_.amount.toString())*1.01).toFixed(6)," ",_.token]})]})]})})(),(_==null?void 0:_.blockchain_trade_id)&&c.jsxs(ee.button,{onClick:()=>ka(_.id,"RECEIVED"),className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 px-4 rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 transition-all flex items-center justify-center space-x-2 shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},title:"Confirm payment received (on-chain - releases funds to buyer)",children:[c.jsx(kt,{size:18}),c.jsx("span",{children:" Confirm Payment Received"})]})]})})(),oe&&_.state==="RELEASED"&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-green-400 bg-green-500/20 p-3 rounded-lg",children:[c.jsx(kt,{size:16}),c.jsx("span",{className:"text-sm font-medium",children:" Funds released to buyer! Order completed successfully."})]}),(_==null?void 0:_.blockchain_trade_id)&&c.jsxs("div",{className:"space-y-2",children:[c.jsxs(ee.button,{onClick:()=>Bt(_),className:"w-full bg-blue-500/20 border border-blue-500/30 text-blue-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"Verify if funds were actually released on blockchain",children:[c.jsx(kt,{size:14}),c.jsx("span",{children:" Verify Blockchain Status"})]}),c.jsxs(ee.button,{onClick:()=>mn(_),className:"w-full bg-orange-500/20 border border-orange-500/30 text-orange-300 px-3 py-2 rounded-md text-sm font-medium hover:bg-orange-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},title:"If database shows RELEASED but blockchain shows LOCKED, click to release funds on-chain",children:[c.jsx(Va,{size:14}),c.jsx("span",{children:" Release On-Chain (Seller)"})]})]})]}),["LOCKED","UNDER_DISPUTE","APPEALED"].includes(_.state)&&(_.state==="LOCKED"&&!ot(_).isExpired?null:c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"bg-gradient-to-r from-purple-500/20 to-blue-500/20 border border-purple-500/30 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(X1,{size:18,className:"text-purple-400"}),c.jsx("span",{className:"text-purple-300 font-medium",children:"Dispute Resolution"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[(_==null?void 0:_.blockchain_trade_id)&&c.jsx("button",{onClick:()=>Bt(_),className:"text-blue-400 hover:text-blue-300 text-sm px-2 py-1 rounded bg-blue-500/20 hover:bg-blue-500/30 transition-colors",title:"Verify trade status on blockchain",children:" Verify Status"}),c.jsx("button",{onClick:()=>TN(_.id),className:"text-purple-400 hover:text-purple-300 text-sm",children:"View Details"})]})]}),c.jsxs("div",{className:"space-y-2",children:[_.state==="LOCKED"&&(()=>{const we=ot(_);return c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"text-sm text-blue-300",children:" Funds locked - Buyer confirms off-chain, Seller confirms on-chain to release funds"}),_.lockExpiresAt&&c.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-2",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-xs text-blue-300",children:"Lock Expires:"}),we.isExpired?c.jsx("span",{className:"text-red-400 text-xs font-bold",children:"EXPIRED"}):c.jsx("span",{className:`font-mono text-sm font-bold ${we.timeRemainingHours===0&&we.timeRemainingMinutes<30?"text-red-400":"text-blue-300"}`,children:pt(we.timeRemainingHours,we.timeRemainingMinutes,we.timeRemainingSecs)})]})})]})})(),_.state==="UNDER_DISPUTE"&&c.jsx("div",{className:"text-sm text-orange-300",children:" Dispute filed - 48 hours to appeal"}),_.state==="UNDER_REVIEW"&&c.jsx("div",{className:"text-sm text-purple-300",children:" Under admin review"})]}),c.jsxs("div",{className:"flex space-x-2 mt-3",children:[_.state==="LOCKED"&&c.jsxs(c.Fragment,{children:[he&&(_==null?void 0:_.blockchain_trade_id)&&c.jsxs(ee.button,{onClick:()=>ka(_.id,"SENT"),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-700",whileTap:{scale:.95},title:"Confirm payment sent (off-chain only - no gas fee)",children:[c.jsx(kt,{size:14,className:"inline mr-1"}),"Confirm Payment Sent"]}),oe&&(_==null?void 0:_.blockchain_trade_id)&&c.jsxs(ee.button,{onClick:()=>ka(_.id,"RECEIVED"),className:"flex-1 bg-green-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-green-700",whileTap:{scale:.95},title:"Confirm payment received (on-chain - releases funds to buyer)",children:[c.jsx(kt,{size:14,className:"inline mr-1"}),"Confirm Payment Received"]}),!(_!=null&&_.blockchain_trade_id)&&c.jsx("div",{className:"flex-1 bg-yellow-500/20 border border-yellow-500/30 rounded-md px-3 py-2 text-xs text-yellow-300",children:" Waiting for blockchain trade ID..."})]}),["UNDER_DISPUTE"].includes(_.state)&&c.jsxs(ee.button,{onClick:()=>Ff(_.id),className:"flex-1 bg-orange-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-orange-700",whileTap:{scale:.95},children:[c.jsx(cl,{size:14,className:"inline mr-1"}),"File Appeal"]}),_.state==="LOCKED"&&(()=>{const we=jt(_);return!(_.sellerAddress.toLowerCase()===(pe||"").toLowerCase())||!(_!=null&&_.blockchain_trade_id)?null:we.canRedeem?c.jsxs(ee.button,{onClick:()=>pr(_),className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:from-green-700 hover:to-emerald-700 shadow-lg",whileTap:{scale:.95},title:"Claim full refund (amount + 1% extra)",children:[c.jsx(xr,{size:14,className:"inline mr-1"})," Claim Refund"]}):c.jsxs("div",{className:"flex-1 bg-orange-500/20 border border-orange-500/30 rounded-md px-3 py-2 text-xs text-orange-300",children:[" Refund in ",we.timeRemainingHours,"h ",we.timeRemainingMinutes,"m"]})})()]})]})}))]},_.id)})})})}):c.jsx("div",{className:"space-y-4",children:o?c.jsx("div",{className:"space-y-4",children:[1,2,3].map(_=>c.jsxs("div",{className:"bg-white/10 rounded-xl p-4 animate-pulse",children:[c.jsx("div",{className:"h-4 bg-white/20 rounded w-3/4 mb-2"}),c.jsx("div",{className:"h-3 bg-white/20 rounded w-1/2"})]},_))}):n.length===0?c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-12 space-y-4",children:[c.jsx("div",{className:"w-16 h-16 bg-gray-500/20 rounded-full flex items-center justify-center mx-auto",children:c.jsx(Wx,{size:32,className:"text-gray-400"})}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"No Ads Yet"}),c.jsx("p",{className:"text-gray-300 text-sm",children:"Create your first P2P ad to start trading"})]})]}):c.jsx(Oo,{children:n.map(_=>c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 space-y-3",children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"text-white font-semibold text-lg",children:["",_.priceInr]}),c.jsx("span",{className:"text-gray-300 text-sm bg-white/10 px-2 py-1 rounded",children:_.token})]}),c.jsxs("p",{className:"text-gray-300 text-sm",children:["Min: ",_.minAmount," | Max: ",_.maxAmount]}),c.jsxs("p",{className:"text-gray-400 text-xs",children:["Lock: ",Math.floor(_.lockDurationSeconds/60)," min"]})]}),c.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[c.jsx("span",{className:Zn("px-2 py-1 rounded text-xs font-medium",_.type==="BUY"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"),children:_.type}),c.jsx("span",{className:Zn("px-2 py-1 rounded text-xs font-medium",_.active?"bg-green-500/20 text-green-300":"bg-gray-500/20 text-gray-300"),children:_.active?"Active":"Inactive"})]})]}),_.agent&&c.jsxs("div",{className:"bg-white/5 rounded-lg p-3 space-y-2",children:[c.jsx("p",{className:"text-white text-sm font-medium",children:_.agent.branchName}),c.jsx("p",{className:"text-gray-300 text-xs",children:_.agent.city}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-gray-300 text-xs",children:_.agent.mobile}),c.jsx(ee.button,{onClick:()=>{var G;return window.open(`tel:${(G=_.agent)==null?void 0:G.mobile}`)},className:"p-1 rounded bg-green-500/20 text-green-400",whileTap:{scale:.95},children:c.jsx(fn,{size:12})})]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs(ee.button,{onClick:()=>NN(_),className:"flex-1 py-2 px-4 rounded-lg bg-blue-500/20 text-blue-400 border border-blue-500/30 hover:bg-blue-500/30 transition-colors flex items-center justify-center space-x-2",whileTap:{scale:.95},children:[c.jsx(wI,{size:16}),c.jsx("span",{children:"Edit"})]}),c.jsx(ee.button,{onClick:()=>AN(_.id),className:"p-2 rounded-lg bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30 transition-colors",whileTap:{scale:.95},children:c.jsx(kC,{size:16})})]})]},_.id))})}),c.jsx(Oo,{children:f&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>p(null),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-900 rounded-xl p-6 w-full max-w-md border border-white/20",onClick:_=>_.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Edit Ad"}),c.jsx("button",{onClick:()=>p(null),className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:c.jsx(xr,{size:20})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-white/5 rounded-lg p-4 space-y-2",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-white font-semibold",children:[f.type," ",f.token]}),c.jsx("span",{className:"text-gray-300 text-sm bg-white/10 px-2 py-1 rounded",children:f.city})]})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Price (USDT)"}),c.jsx("input",{type:"number",value:w.priceInr,onChange:_=>b({...w,priceInr:_.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Enter price in USDT"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Amount (USDT)"}),c.jsx("input",{type:"number",value:w.minAmount,onChange:_=>b({...w,minAmount:_.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Min amount"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Amount (USDT)"}),c.jsx("input",{type:"number",value:w.maxAmount,onChange:_=>b({...w,maxAmount:_.target.value}),className:"w-full bg-white/10 border border-white/20 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Max amount"})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"checkbox",id:"active",checked:w.active,onChange:_=>b({...w,active:_.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),c.jsx("label",{htmlFor:"active",className:"text-sm font-medium text-gray-300",children:"Ad is active"})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(ee.button,{onClick:()=>p(null),className:"flex-1 py-2 px-4 rounded-lg bg-white/10 text-white hover:bg-white/20 transition-colors",whileTap:{scale:.98},children:"Cancel"}),c.jsx(ee.button,{onClick:yb,className:"flex-1 py-2 px-4 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 text-white",whileTap:{scale:.98},children:"Update Ad"})]})]})]})})}),C.isOpen&&c.jsx("div",{children:c.jsx(CN,{isOpen:C.isOpen,ad:{id:"order-call",ownerAddress:C.targetAddress,ownerSelectedAgentIds:["1"],type:"BUY",token:"USDT",priceInr:"0",minAmount:"0",maxAmount:"0",lockDurationSeconds:0,city:"Mumbai",active:!0,createdAt:new Date().toISOString(),agent:{id:"1",branchName:C.targetName||"User",city:"Mumbai",address:C.targetAddress,mobile:"",verified:!0,createdByAdmin:"1",createdAt:new Date().toISOString(),locationId:"1",locationName:"Mumbai"}},onClose:()=>{console.log(" Orders: CallModal closed, cleaning up"),Ml()}})}),V.isOpen&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>X({isOpen:!1,orderId:""}),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-900 rounded-xl  w-full max-w-4xl max-h-[90vh] overflow-y-auto border border-white/20",onClick:_=>_.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Dispute Resolution"}),c.jsx("button",{onClick:()=>X({isOpen:!1,orderId:""}),className:"p-2 rounded-lg bg-white/10 text-gray-400 hover:text-white transition-colors",children:c.jsx(an,{size:20})})]}),L[V.orderId]&&c.jsx(dIe,{orderId:V.orderId,userRole:L[V.orderId].userRole,orderState:L[V.orderId].state,timeRemaining:L[V.orderId].timeRemaining||0,appealTimeRemaining:L[V.orderId].appealTimeRemaining||0,confirmations:L[V.orderId].confirmations,dispute:L[V.orderId].dispute,appeals:L[V.orderId].appeals||[],onConfirmPayment:ka,onFileAppeal:SN})]})}),ie.isOpen&&(()=>{const _=t.find(we=>we.id===ie.orderId);if(!_)return null;const G=_.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),J=_.sellerAddress.toLowerCase(),de=ae[J]||{},oe=(_==null?void 0:_.sellerName)||"Seller",he=de.mobile||"Not available",Ee=Number((_==null?void 0:_.priceInr)||0),je=Number(_.amount||0),be=(Ee*je).toFixed(2);return c.jsx(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>{Te({isOpen:!1,orderId:""}),_&&Q(we=>new Set(we).add(_.id))},children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gradient-to-br from-green-500 to-blue-500 rounded-xl p-6 w-full max-w-lg border border-white/20 text-white overflow-y-auto max-h-[90vh] relative",onClick:we=>we.stopPropagation(),children:[c.jsx("button",{onClick:()=>{Te({isOpen:!1,orderId:""}),_&&Q(we=>new Set(we).add(_.id))},className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 text-white transition-colors z-10",title:"Close",children:c.jsx(an,{size:20})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-3",children:c.jsx(Va,{size:32,className:"text-white"})}),c.jsx("h3",{className:"text-xl font-bold mb-2",children:" Funds Locked Successfully!"}),c.jsx("p",{className:"text-white/90 text-sm",children:"The seller has locked their funds for 2 hours. You can now proceed with payment."})]}),c.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(fn,{size:18,className:"text-white"}),c.jsx("h4",{className:"font-semibold text-base",children:"Agent Details"})]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"font-medium min-w-[80px]",children:"Name:"}),c.jsx("span",{className:"text-white/90",children:_.agentBranch})]}),c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"font-medium min-w-[80px]",children:"Location:"}),c.jsx("span",{className:"text-white/90",children:_.agentAddress})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-medium min-w-[80px]",children:"Mobile:"}),c.jsxs("a",{href:`tel:${_.agentNumber}`,className:"text-white/90 hover:text-white underline flex items-center space-x-1",children:[c.jsx(fn,{size:14}),c.jsx("span",{children:_.agentNumber})]})]})]})]}),G&&c.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("h4",{className:"font-semibold text-base",children:"Seller Details"})]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"font-medium min-w-[80px]",children:"Name:"}),c.jsx("span",{className:"text-white/90",children:oe})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-medium min-w-[80px]",children:"Mobile:"}),he!=="Not available"?c.jsxs("a",{href:`tel:${he}`,className:"text-white/90 hover:text-white underline flex items-center space-x-1",children:[c.jsx(fn,{size:14}),c.jsx("span",{children:he})]}):c.jsx("span",{className:"text-white/70 italic",children:"Fetching..."})]})]})]}),c.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("h4",{className:"font-semibold text-base",children:"Payment Amount"})]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("span",{className:"text-white/80",children:["Rate (per ",_.token,"):"]}),c.jsxs("span",{className:"font-semibold",children:["",Ee.toFixed(2)]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("span",{className:"text-white/80",children:["Quantity (",_.token,"):"]}),c.jsx("span",{className:"font-semibold",children:je.toFixed(6)})]}),c.jsx("div",{className:"border-t border-white/30 pt-2 mt-2",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-base",children:"Total Amount to Pay:"}),c.jsxs("span",{className:"font-bold text-lg text-yellow-300",children:["",be]})]})})]})]}),c.jsxs("div",{className:"bg-white/20 rounded-lg p-4 space-y-2",children:[c.jsx("p",{className:"font-semibold text-sm mb-2",children:" Next Steps:"}),c.jsxs("ul",{className:"text-xs text-white/90 space-y-1 list-disc list-inside",children:[c.jsxs("li",{children:["Go to ",c.jsx("strong",{children:_.agentBranch})," within 2 hours"]}),c.jsxs("li",{children:["Pay ",c.jsxs("strong",{children:["",be]})," to the agent"]}),c.jsxs("li",{children:["Contact agent at ",c.jsx("strong",{children:_.agentNumber})]}),c.jsx("li",{children:"Complete the transaction with the agent"})]})]}),c.jsx("div",{className:"flex space-x-3 pt-2",children:c.jsx(ee.button,{onClick:()=>{Te({isOpen:!1,orderId:""}),Q(we=>new Set(we).add(_.id)),Pe({isOpen:!0,orderId:_.id})},className:"flex-1 bg-white/20 hover:bg-white/30 text-white py-3 px-4 rounded-lg font-medium transition-colors",whileTap:{scale:.95},children:"Got It - View Details"})})]})]})})})(),xe.isOpen&&(()=>{const _=t.find(we=>we.id===xe.orderId);if(!_)return null;const G=_.buyerAddress.toLowerCase()===(pe==null?void 0:pe.toLowerCase()),J=_.sellerAddress.toLowerCase(),de=ae[J]||{},oe=(_==null?void 0:_.sellerName)||"Seller",he=de.mobile||"Not available",Ee=Number((_==null?void 0:_.priceInr)||0),je=Number(_.amount||0),be=(Ee*je).toFixed(2);return c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-3 sm:p-4",onClick:()=>Pe({isOpen:!1,orderId:""}),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md sm:max-w-lg border border-white/20 text-white overflow-hidden shadow-2xl flex flex-col max-h-[95vh] sm:max-h-[90vh]",onClick:we=>we.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-white/10 flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx(cl,{size:20,className:"text-white"})}),c.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:" Payment Details"})]}),c.jsx("button",{onClick:()=>Pe({isOpen:!1,orderId:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors flex-shrink-0",title:"Close",children:c.jsx(an,{size:20})})]}),c.jsxs("div",{className:"overflow-y-auto flex-1 p-4 sm:p-6 space-y-4",children:[c.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(fn,{size:18,className:"text-blue-400 flex-shrink-0"}),c.jsx("h4",{className:"font-semibold text-base sm:text-lg text-blue-300",children:"Agent Details"})]}),c.jsxs("div",{className:"space-y-2.5 text-sm sm:text-base",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-1 sm:space-y-0 sm:space-x-3",children:[c.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Name:"}),c.jsx("span",{className:"text-white break-words",children:_.agentBranch})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-1 sm:space-y-0 sm:space-x-3",children:[c.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Location:"}),c.jsx("span",{className:"text-white break-words",children:_.agentAddress})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-3",children:[c.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Mobile:"}),c.jsxs("a",{href:`tel:${_.agentNumber}`,className:"text-blue-300 hover:text-blue-200 underline flex items-center space-x-2 text-base sm:text-lg font-medium",children:[c.jsx(fn,{size:16}),c.jsx("span",{children:_.agentNumber})]})]})]})]}),G&&c.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx("span",{className:"text-lg sm:text-xl",children:""}),c.jsx("h4",{className:"font-semibold text-base sm:text-lg text-purple-300",children:"Seller Details"})]}),c.jsxs("div",{className:"space-y-2.5 text-sm sm:text-base",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start space-y-1 sm:space-y-0 sm:space-x-3",children:[c.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Name:"}),c.jsx("span",{className:"text-white break-words",children:oe})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-1 sm:space-y-0 sm:space-x-3",children:[c.jsx("span",{className:"font-semibold min-w-[90px] sm:min-w-[100px] text-gray-300 flex-shrink-0",children:"Mobile:"}),he!=="Not available"?c.jsxs("a",{href:`tel:${he}`,className:"text-purple-300 hover:text-purple-200 underline flex items-center space-x-2 text-base sm:text-lg font-medium",children:[c.jsx(fn,{size:16}),c.jsx("span",{children:he})]}):c.jsx("span",{className:"text-gray-400 italic text-sm",children:"Fetching..."})]})]})]}),c.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx("span",{className:"text-lg sm:text-xl",children:""}),c.jsx("h4",{className:"font-semibold text-base sm:text-lg text-green-300",children:"Payment Amount"})]}),c.jsxs("div",{className:"space-y-3 text-sm sm:text-base",children:[c.jsxs("div",{className:"flex justify-between items-center py-2",children:[c.jsxs("span",{className:"text-gray-300",children:["Rate (per ",_.token,"):"]}),c.jsxs("span",{className:"font-semibold text-white text-base sm:text-lg",children:["",Ee.toFixed(2)]})]}),c.jsxs("div",{className:"flex justify-between items-center py-2",children:[c.jsxs("span",{className:"text-gray-300",children:["Quantity (",_.token,"):"]}),c.jsx("span",{className:"font-semibold text-white text-base sm:text-lg",children:je.toFixed(6)})]}),c.jsx("div",{className:"border-t border-white/20 pt-3 mt-3",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"font-semibold text-base sm:text-lg text-white",children:"Total Amount to Pay:"}),c.jsxs("span",{className:"font-bold text-xl sm:text-2xl text-yellow-300",children:["",be]})]})})]})]}),c.jsxs("div",{className:"bg-white/10 rounded-lg p-4 sm:p-5 space-y-3 border border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx("span",{className:"text-lg sm:text-xl",children:""}),c.jsx("h4",{className:"font-semibold text-base sm:text-lg text-yellow-300",children:"Next Steps"})]}),c.jsxs("ul",{className:"text-sm sm:text-base text-gray-300 space-y-2 list-disc list-inside",children:[c.jsxs("li",{children:["Go to ",c.jsx("strong",{className:"text-white",children:_.agentBranch})," within 2 hours"]}),c.jsxs("li",{children:["Pay ",c.jsxs("strong",{className:"text-yellow-300",children:["",be]})," to the agent"]}),c.jsxs("li",{children:["Contact agent at ",c.jsx("strong",{className:"text-white",children:_.agentNumber})]}),c.jsx("li",{children:"Complete the transaction with the agent"})]})]})]}),c.jsx("div",{className:"p-4 sm:p-6 border-t border-white/10 bg-white/5 flex-shrink-0",children:c.jsx(ee.button,{onClick:()=>Pe({isOpen:!1,orderId:""}),className:"w-full bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white py-3 px-4 rounded-lg font-medium transition-all text-base sm:text-lg",whileTap:{scale:.98},children:"Got It"})})]})})})(),Y.isOpen&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>me({isOpen:!1,phoneNumber:"",userName:""}),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:_=>_.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:c.jsx(fn,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-bold text-white",children:["Call ",Y.userName]}),c.jsx("p",{className:"text-sm text-gray-400",children:"Phone Number"})]})]}),c.jsx("button",{onClick:()=>me({isOpen:!1,phoneNumber:"",userName:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:c.jsx(an,{size:20})})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"bg-white/10 rounded-lg p-6 text-center border border-white/10",children:[c.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Phone Number"}),c.jsx("p",{id:"phone-number-display",className:"text-3xl font-bold text-white break-all select-all cursor-text",style:{userSelect:"all",WebkitUserSelect:"all"},onClick:_=>{const G=document.createRange();G.selectNodeContents(_.currentTarget);const J=window.getSelection();J==null||J.removeAllRanges(),J==null||J.addRange(G)},children:Y.phoneNumber}),c.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Tap to select, then copy manually"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs(ee.button,{onClick:async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(Y.phoneNumber),D.success("Phone number copied to clipboard!");else{const _=document.getElementById("phone-number-display");if(_){const G=document.createRange();G.selectNodeContents(_);const J=window.getSelection();J==null||J.removeAllRanges(),J==null||J.addRange(G),D("Number selected! Long press to copy",{icon:"",duration:3e3})}}}catch(_){console.error("Failed to copy:",_);const G=document.getElementById("phone-number-display");if(G){const J=document.createRange();J.selectNodeContents(G);const de=window.getSelection();de==null||de.removeAllRanges(),de==null||de.addRange(J),D("Number selected! Long press to copy",{icon:"",duration:4e3})}else D.error("Please manually select and copy the number")}},className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-center space-x-3 transition-all shadow-lg",whileTap:{scale:.98},children:[c.jsx(cl,{size:24}),c.jsx("span",{children:"Copy Number"})]}),c.jsx(ee.button,{onClick:()=>{const _=document.getElementById("phone-number-display");if(_){const G=document.createRange();G.selectNodeContents(_);const J=window.getSelection();J==null||J.removeAllRanges(),J==null||J.addRange(G),D("Number selected! Long press to copy",{icon:"",duration:3e3})}},className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},children:c.jsx("span",{children:"Select Number (Manual Copy)"})})]}),c.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 space-y-2",children:[c.jsx("p",{className:"text-sm text-blue-300 text-center",children:" Dialog me jakar call kar lo"}),c.jsx("p",{className:"text-xs text-blue-400 text-center",children:"If copy fails, tap the number above to select it, then long press to copy"})]})]})]})}),le.isOpen&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>tt({isOpen:!1,appealUrl:"",orderId:""}),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:_=>_.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-full flex items-center justify-center",children:c.jsx(cl,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"File Appeal"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Chrome Browser Required"})]})]}),c.jsx("button",{onClick:()=>tt({isOpen:!1,appealUrl:"",orderId:""}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:c.jsx(an,{size:20})})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsx("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4",children:c.jsx("p",{className:"text-sm text-blue-300 text-center",children:"Ye link copy karke browser me open karo"})}),c.jsxs("div",{className:"bg-white/10 rounded-lg p-4 border border-white/10",children:[c.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Appeal URL"}),c.jsx("p",{id:"appeal-url-display",className:"text-sm font-mono text-white break-all bg-black/20 p-3 rounded border border-white/10 select-all cursor-text",style:{userSelect:"all",WebkitUserSelect:"all"},onClick:_=>{const G=document.createRange();G.selectNodeContents(_.currentTarget);const J=window.getSelection();J==null||J.removeAllRanges(),J==null||J.addRange(G)},children:le.appealUrl}),c.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Tap to select, then copy manually"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs(ee.button,{onClick:async()=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(le.appealUrl),D.success("URL copied to clipboard! Copy and paste in browser.");else{const _=document.getElementById("appeal-url-display");if(_){const G=document.createRange();G.selectNodeContents(_);const J=window.getSelection();J==null||J.removeAllRanges(),J==null||J.addRange(G),D("URL selected! Long press to copy",{icon:"",duration:3e3})}}}catch(_){console.error("Failed to copy:",_);const G=document.getElementById("appeal-url-display");if(G){const J=document.createRange();J.selectNodeContents(G);const de=window.getSelection();de==null||de.removeAllRanges(),de==null||de.addRange(J),D("URL selected! Long press to copy",{icon:"",duration:4e3})}else D.error("Please manually select and copy the URL")}},className:"w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-center space-x-3 transition-all shadow-lg",whileTap:{scale:.98},children:[c.jsx(cl,{size:24}),c.jsx("span",{children:"Copy Link"})]}),c.jsx(ee.button,{onClick:()=>{const _=document.getElementById("appeal-url-display");if(_){const G=document.createRange();G.selectNodeContents(_);const J=window.getSelection();J==null||J.removeAllRanges(),J==null||J.addRange(G),D("URL selected! Long press to copy",{icon:"",duration:3e3})}},className:"w-full bg-white/10 hover:bg-white/20 text-white py-4 px-6 rounded-lg font-medium flex items-center justify-center space-x-3 transition-all border border-white/20",whileTap:{scale:.98},children:c.jsx("span",{children:"Select URL (Manual Copy)"})})]}),c.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 space-y-2",children:[c.jsx("p",{className:"text-sm text-yellow-300 text-center",children:"Ye link copy karke browser me open karo"}),c.jsx("p",{className:"text-xs text-yellow-400 text-center",children:"If copy fails, tap the URL above to select it, then long press to copy"})]})]})]})}),Ve.isOpen&&c.jsx(ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>Ue({isOpen:!1,orderId:"",userRole:"buyer"}),children:c.jsxs(ee.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl w-full max-w-md border border-white/20 text-white overflow-hidden shadow-2xl",onClick:_=>_.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center",children:c.jsx(qt,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Important Instructions"}),c.jsx("p",{className:"text-sm text-gray-400",children:Ve.userRole==="buyer"?"For Buyer":"For Seller"})]})]}),c.jsx("button",{onClick:()=>Ue({isOpen:!1,orderId:"",userRole:"buyer"}),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors",title:"Close",children:c.jsx(an,{size:20})})]}),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4",children:Ve.userRole==="buyer"?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(qt,{size:20,className:"text-yellow-400"}),c.jsx("span",{className:"font-semibold text-yellow-300",children:"Buyer Instructions"})]}),c.jsxs("p",{className:"text-white text-base leading-relaxed",children:[c.jsx("strong",{children:" Important:"})," Agent branch me payment ke baad hi confirm karo."]}),c.jsx("p",{className:"text-gray-300 text-sm mt-2",children:'Please complete the payment at the agent branch first, then click the "Confirm Payment Sent" button.'})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx(qt,{size:20,className:"text-yellow-400"}),c.jsx("span",{className:"font-semibold text-yellow-300",children:"Seller Instructions"})]}),c.jsxs("p",{className:"text-white text-base leading-relaxed",children:[c.jsx("strong",{children:" Important:"})," Payment milne ke baad confirm button dabao."]}),c.jsx("p",{className:"text-gray-300 text-sm mt-2",children:'Only click the "Confirm Payment Received" button after you have actually received the payment from the buyer.'})]})}),c.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:c.jsx("p",{className:"text-blue-300 text-sm",children:" This action is important for the security of the transaction. Please follow the instructions carefully."})})]}),c.jsx("div",{className:"p-6 border-t border-white/10 bg-white/5",children:c.jsx(ee.button,{onClick:()=>Ue({isOpen:!1,orderId:"",userRole:"buyer"}),className:"w-full bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white py-3 px-4 rounded-lg font-medium transition-all",whileTap:{scale:.98},children:"Got It"})})]})})]})},fIe=()=>{const{user:t,agents:e,locations:n,isLoading:r,updateProfile:s,fetchAgents:i,fetchLocations:o,fetchUserProfile:a,refreshUserProfile:l}=ss(),{address:d,isConnected:u,connectionError:h,clearError:f}=Xt(),[p,m]=A.useState(!1),[g,w]=A.useState(null),[b,y]=A.useState(!1),[x,v]=A.useState({name:"",phone:"",locationId:"",selectedAgentIds:[]});A.useEffect(()=>{u&&d&&a(d)},[d,u,a]),A.useEffect(()=>{u&&d&&t&&(console.log(" Profile: Wallet connected, refreshing user profile..."),l())},[u,d,l]),A.useEffect(()=>{t&&v({name:t.name||"",phone:t.phone||"",locationId:t.locationId||"",selectedAgentIds:t.selectedAgentIds||[]})},[t]),A.useEffect(()=>{o()},[o]),A.useEffect(()=>{x.locationId?i(x.locationId):i()},[x.locationId,i]);const E=(C,N)=>{v(T=>({...T,[C]:N}))},R=async()=>{if(!x.name.trim()||!x.phone.trim()||!x.locationId||x.selectedAgentIds.length===0){w("Please fill in all required fields and select at least one agent");return}try{w(null),await s(x)?(D.success("Profile updated successfully"),m(!1)):w("Failed to update profile")}catch(C){console.error("Profile update error:",C),w("Failed to update profile")}},S=e.filter(C=>{var N;return(N=x.selectedAgentIds)==null?void 0:N.includes(String(C.id))});return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-3",children:c.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"text-center",children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Profile"}),c.jsx("p",{className:"text-violet-300 text-sm",children:"Manage your account"})]}),h&&c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3 flex items-center space-x-2",children:[c.jsx(qt,{size:16,className:"text-red-400"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-red-300 font-medium text-sm",children:"Connection Error"}),c.jsx("p",{className:"text-red-400 text-xs",children:h})]}),c.jsx("button",{onClick:f,className:"p-1 rounded bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",children:c.jsx(an,{size:14})})]}),!u&&c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-4 border border-violet-500/20 text-center",children:[c.jsx(IC,{size:32,className:"text-violet-400 mx-auto mb-2"}),c.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Wallet Not Connected"}),c.jsx("p",{className:"text-violet-300 text-sm",children:"Please connect your wallet from Dashboard to view and edit your profile"})]}),u&&c.jsxs(c.Fragment,{children:[c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:Zn("p-3 rounded-lg border flex items-center space-x-2",t!=null&&t.verified?"bg-violet-500/20 border-violet-500/30":"bg-yellow-500/20 border-yellow-500/30"),children:[t!=null&&t.verified?c.jsx(kt,{size:16,className:"text-violet-400"}):c.jsx(qt,{size:16,className:"text-yellow-400"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:Zn("font-medium text-sm",t!=null&&t.verified?"text-violet-300":"text-yellow-300"),children:t!=null&&t.verified?"Verified":"Not Verified"}),c.jsx("p",{className:Zn("text-xs",t!=null&&t.verified?"text-violet-400":"text-yellow-400"),children:t!=null&&t.verified?"Can access P2P trading":"Complete profile to trade"})]})]}),c.jsx(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ug,{size:16,className:"text-violet-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-violet-300 text-xs",children:"Wallet Address"}),c.jsx("p",{className:"text-white font-mono text-xs",children:d?`${d.slice(0,6)}...${d.slice(-6)}`:"Not connected"})]})]})}),c.jsx(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-4 border border-violet-500/20",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-violet-300 mb-1",children:"Full Name *"}),c.jsx("input",{type:"text",value:x.name,onChange:C=>E("name",C.target.value),disabled:!p,className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-white text-sm focus:outline-none focus:border-violet-500 disabled:opacity-50",placeholder:"Enter your full name",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-violet-300 mb-1",children:"Phone Number *"}),c.jsx("input",{type:"tel",value:x.phone,onChange:C=>E("phone",C.target.value),disabled:!p,className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-white text-sm focus:outline-none focus:border-violet-500 disabled:opacity-50",placeholder:"Enter your phone number",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-violet-300 mb-1",children:"Location *"}),c.jsxs("select",{value:x.locationId,onChange:C=>E("locationId",C.target.value),disabled:!p,className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-white text-sm focus:outline-none focus:border-violet-500 disabled:opacity-50",required:!0,children:[c.jsx("option",{value:"",className:"bg-slate-800",children:"Select location"}),n.map(C=>c.jsx("option",{value:C.id,className:"bg-slate-800",children:C.name},C.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-violet-300 mb-1",children:"Select Agents * (Multiple)"}),x.locationId?e.length===0?c.jsx("div",{className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-violet-300 text-sm",children:c.jsx("p",{children:"No agents available"})}):c.jsx("div",{className:"max-h-32 overflow-y-auto bg-white/10 border border-violet-500/20 rounded p-2 space-y-1",children:e.map(C=>{var N;return c.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-white/5 cursor-pointer transition-colors",children:[c.jsx("input",{type:"checkbox",checked:((N=x.selectedAgentIds)==null?void 0:N.includes(String(C.id)))||!1,onChange:T=>{const $=String(C.id),U=x.selectedAgentIds||[];T.target.checked?E("selectedAgentIds",[...U,$]):E("selectedAgentIds",U.filter(H=>H!==$))},disabled:!p,className:"w-3 h-3 text-violet-600 bg-white/10 border-violet-500/20 rounded focus:ring-violet-500 focus:ring-1 disabled:opacity-50"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-white font-medium text-sm truncate",children:C.branchName}),c.jsx("p",{className:"text-violet-300 text-xs truncate",children:C.locationName}),c.jsx("p",{className:"text-violet-400 text-xs truncate",children:C.mobile})]}),c.jsx("div",{className:"flex-shrink-0",children:C.verified?c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-400",children:""}):c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-500/20 text-yellow-400",children:""})})]},C.id)})}):c.jsx("div",{className:"w-full bg-white/10 border border-violet-500/20 rounded px-2 py-1.5 text-violet-300 text-sm",children:c.jsx("p",{children:"Select location first"})}),x.selectedAgentIds&&x.selectedAgentIds.length>0&&c.jsxs("div",{className:"mt-2 p-2 bg-violet-500/20 border border-violet-500/30 rounded",children:[c.jsxs("p",{className:"text-violet-300 text-xs font-medium",children:["Selected (",x.selectedAgentIds.length,"):"]}),c.jsx("div",{className:"mt-1 space-y-0.5",children:S.map(C=>c.jsxs("p",{className:"text-violet-200 text-xs",children:[" ",C.branchName]},C.id))})]})]}),p&&c.jsxs("div",{className:"flex space-x-2 pt-3",children:[c.jsx("button",{onClick:R,disabled:r,className:"flex-1 bg-gradient-to-r from-violet-500 to-purple-500 text-white py-2 px-3 rounded font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-1 text-sm",children:r?c.jsxs(c.Fragment,{children:[c.jsx(sr,{size:14,className:"animate-spin"}),c.jsx("span",{children:"Saving..."})]}):c.jsx("span",{children:"Save"})}),c.jsx("button",{onClick:()=>{m(!1),w(null),t&&v({name:t.name||"",phone:t.phone||"",locationId:t.locationId||"",selectedAgentIds:t.selectedAgentIds||[]})},className:"px-3 py-2 border border-violet-500/20 text-white rounded hover:bg-white/10 transition-colors text-sm",children:"Cancel"})]}),!p&&c.jsx("button",{onClick:()=>y(!0),className:"w-full bg-gradient-to-r from-violet-500 to-purple-500 text-white py-2 px-3 rounded font-medium text-sm",children:"Edit Profile"}),g&&c.jsxs("div",{className:"p-2 bg-red-500/20 border border-red-500/30 rounded flex items-center space-x-2",children:[c.jsx(qt,{size:14,className:"text-red-400"}),c.jsx("p",{className:"text-red-300 text-xs",children:g})]})]})}),S.length>0&&c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"bg-violet-500/10 backdrop-blur-lg rounded-lg p-3 border border-violet-500/20",children:[c.jsxs("h3",{className:"text-base font-bold text-white mb-2 flex items-center space-x-1",children:[c.jsx(lg,{size:16,className:"text-violet-400"}),c.jsx("span",{children:"Selected Agents"})]}),c.jsx("div",{className:"space-y-2",children:S.map(C=>c.jsx("div",{className:"p-2 bg-white/5 rounded border border-white/10",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"space-y-0.5",children:[c.jsx("p",{className:"text-white font-medium text-sm",children:C.branchName}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(lg,{size:12,className:"text-violet-400"}),c.jsx("span",{className:"text-violet-300 text-xs",children:C.locationName})]}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(fn,{size:12,className:"text-violet-400"}),c.jsx("span",{className:"text-violet-300 text-xs",children:C.mobile})]})]}),c.jsx("div",{className:"flex-shrink-0",children:C.verified?c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-400",children:""}):c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-yellow-500/20 text-yellow-400",children:""})})]})},C.id))})]})]}),b&&c.jsx(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-3",onClick:()=>y(!1),children:c.jsx(ee.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gradient-to-br from-orange-500 to-red-500 rounded-lg p-4 w-full max-w-sm border border-white/20 text-white",onClick:C=>C.stopPropagation(),children:c.jsxs("div",{className:"text-center space-y-3",children:[c.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mx-auto",children:c.jsx(qt,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-bold mb-1",children:" Important Notice"}),c.jsx("p",{className:"text-white/90 text-sm mb-3",children:"Please fill all information correctly and accurately."}),c.jsxs("div",{className:"bg-white/20 rounded p-3 space-y-1",children:[c.jsx("p",{className:"text-white font-semibold text-xs",children:" Important:"}),c.jsx("p",{className:"text-xs text-white/90",children:" Name and mobile number must be correct"}),c.jsx("p",{className:"text-xs text-white/90",children:" Aagnya Branch may verify your information"}),c.jsx("p",{className:"text-xs text-white/90",children:" All other information should also be accurate"})]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx(ee.button,{onClick:()=>y(!1),className:"flex-1 bg-white/20 hover:bg-white/30 text-white py-2 px-3 rounded font-medium transition-colors text-sm",whileTap:{scale:.95},children:"Cancel"}),c.jsx(ee.button,{onClick:()=>{y(!1),m(!0)},className:"flex-1 bg-white text-orange-600 py-2 px-3 rounded font-medium hover:bg-white/90 transition-colors text-sm",whileTap:{scale:.95},children:"Continue"})]})]})})})]})})},pIe=()=>{const{user:t}=ss(),[e,n]=A.useState([]),[r,s]=A.useState([]),[i,o]=A.useState(!0),[a,l]=A.useState(null);A.useEffect(()=>{t!=null&&t.address&&(d(),u())},[t==null?void 0:t.address]);const d=async()=>{try{o(!0);const w=await fetch("/api/transactions",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(w.ok){const b=await w.json();n(b.data||[])}}catch(w){console.error("Error fetching transactions:",w)}finally{o(!1)}},u=async()=>{try{const w=await fetch("/api/support");if(w.ok){const b=await w.json();s(b.data||[])}}catch(w){console.error("Error fetching support contacts:",w)}},h=async(w,b)=>{try{await navigator.clipboard.writeText(w),l(b),setTimeout(()=>l(null),2e3)}catch(y){console.error("Failed to copy:",y)}},f=w=>{switch(w){case"COMPLETED":return c.jsx(kt,{className:"w-4 h-4 text-green-400"});case"PENDING":return c.jsx(Pr,{className:"w-4 h-4 text-yellow-400"});case"FAILED":return c.jsx(xr,{className:"w-4 h-4 text-red-400"});case"CANCELLED":return c.jsx(qt,{className:"w-4 h-4 text-gray-400"});default:return c.jsx(Pr,{className:"w-4 h-4 text-gray-400"})}},p=w=>{switch(w){case"COMPLETED":return"bg-green-500/20 text-green-400 border-green-500/30";case"PENDING":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"FAILED":return"bg-red-500/20 text-red-400 border-red-500/30";case"CANCELLED":return"bg-gray-500/20 text-gray-400 border-gray-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},m=w=>new Date(w).toLocaleString(),g=(w,b)=>`${w.toFixed(6)} ${b}`;return i?c.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:c.jsx("div",{className:"text-white",children:"Loading transactions..."})}):c.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Transaction History"}),c.jsx("p",{className:"text-gray-400",children:"View all your transaction records and support contacts"})]}),r.length>0&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(fn,{className:"w-5 h-5 mr-2"}),"Support Contacts"]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(w=>c.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[w.type==="phone"?c.jsx(fn,{className:"w-4 h-4 text-green-400"}):c.jsx(wQ,{className:"w-4 h-4 text-blue-400"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:w.label||w.type}),c.jsx("div",{className:"text-sm text-gray-400",children:w.value})]})]}),c.jsx("button",{onClick:()=>{w.type==="phone"?window.open(`tel:${w.value}`):window.open(`mailto:${w.value}`)},className:"p-2 rounded-lg bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 transition-colors",children:c.jsx(nQ,{className:"w-4 h-4"})})]})},w.id))})]}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(dw,{className:"w-5 h-5 mr-2"}),"Your Transactions"]}),e.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(dw,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No transactions found"}),c.jsx("p",{className:"text-gray-500",children:"Your transaction history will appear here once you complete orders."})]}):c.jsx("div",{className:"space-y-4",children:e.map(w=>c.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[f(w.status),c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium text-lg",children:["Transaction #",w.transaction_number]}),c.jsx("div",{className:"text-sm text-gray-400",children:m(w.created_at)})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${p(w.status)}`,children:w.status}),c.jsx("button",{onClick:()=>h(w.transaction_number,w.transaction_number),className:"p-1 rounded hover:bg-gray-700 transition-colors",children:a===w.transaction_number?c.jsx(yI,{className:"w-4 h-4 text-green-400"}):c.jsx(wB,{className:"w-4 h-4 text-gray-400"})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Amount"}),c.jsx("div",{className:"font-medium",children:g(w.amount,w.token)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Type"}),c.jsx("div",{className:"font-medium",children:w.transaction_type})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Order ID"}),c.jsxs("div",{className:"font-medium",children:["#",w.order_id]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-400 mb-1",children:"Buyer"}),c.jsx("div",{className:"font-mono text-xs break-all",children:w.buyer_address})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-400 mb-1",children:"Seller"}),c.jsx("div",{className:"font-mono text-xs break-all",children:w.seller_address})]})]}),w.completed_at&&c.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700",children:c.jsxs("div",{className:"text-sm text-gray-400",children:["Completed: ",m(w.completed_at)]})})]},w.id))})]})]})})},mIe=()=>{const t=[{icon:cf,title:"No Bank Freeze Risk",description:"Operate outside traditional banking systems. Your trades don't depend on banks, reducing freeze risk.",color:"from-green-500/20 to-emerald-500/20",borderColor:"border-green-500/30",iconColor:"text-green-400"},{icon:uJ,title:"Daily Cash  USDT Trading",description:"Seamlessly convert cash to USDT or USDT to cash daily via automated, peertopeer flows.",color:"from-yellow-500/20 to-orange-500/20",borderColor:"border-yellow-500/30",iconColor:"text-yellow-400"},{icon:vB,title:"Global Access",description:"Borderless access to decentralized financial transactions from anywhere in the world.",color:"from-indigo-500/20 to-blue-500/20",borderColor:"border-indigo-500/30",iconColor:"text-indigo-400"},{icon:_o,title:"Low Transaction Fees",description:"No intermediaries or centralized exchanges means significantly lower costs per trade.",color:"from-green-500/20 to-teal-500/20",borderColor:"border-green-500/30",iconColor:"text-green-400"},{icon:Va,title:"Privacy & Security",description:"Advanced encryption and onchain verification keep your identity and data private and secure.",color:"from-purple-500/20 to-pink-500/20",borderColor:"border-purple-500/30",iconColor:"text-purple-400"},{icon:CB,title:"No Need for Physical Visits",description:"Handle cash/USDT adjustments over verified callsno repeated inperson visits required.",color:"from-violet-500/20 to-fuchsia-500/20",borderColor:"border-violet-500/30",iconColor:"text-violet-400"},{icon:IC,title:"No Centralized Exchange Required",description:"Trade directly via decentralized wallets like MetaMask or Trust Wallet with full fund control.",color:"from-blue-500/20 to-cyan-500/20",borderColor:"border-blue-500/30",iconColor:"text-blue-400"},{icon:cf,title:"Smart Contract Protection",description:"Secure smart contracts govern every tradeno admin, agent, or third party can interfere.",color:"from-emerald-500/20 to-green-500/20",borderColor:"border-emerald-500/30",iconColor:"text-emerald-400"},{icon:NB,title:"Daily Arbitrage Opportunities",description:"Capitalize on market fluctuations by buying low and selling high for consistent profit.",color:"from-teal-500/20 to-cyan-500/20",borderColor:"border-teal-500/30",iconColor:"text-teal-400"},{icon:UQ,title:"Tax Flexibility",description:"Decentralized structure may enable tax optimizations depending on jurisdiction and setup.",color:"from-amber-500/20 to-yellow-500/20",borderColor:"border-amber-500/30",iconColor:"text-amber-400"},{icon:zY,title:"Full Financial Freedom",description:"Manage, trade, and grow assets without reliance on centralized systemsfreedom and control.",color:"from-pink-500/20 to-rose-500/20",borderColor:"border-pink-500/30",iconColor:"text-pink-400"}],e={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},n={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}};return c.jsxs("div",{className:"p-4 space-y-6 max-w-md mx-auto pb-20",children:[c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"text-center space-y-2",children:[c.jsx("h1",{className:"text-3xl font-bold text-white",children:"Platform Benefits"}),c.jsx("p",{className:"text-violet-300 text-sm",children:"Why choose our decentralized P2P trading platform?"})]}),c.jsx(ee.div,{variants:e,initial:"hidden",animate:"visible",className:"space-y-4",children:t.map((r,s)=>{const i=r.icon;return c.jsx(ee.div,{variants:n,className:`bg-gradient-to-r ${r.color} backdrop-blur-lg rounded-xl p-4 border ${r.borderColor} hover:scale-[1.02] transition-transform duration-200`,children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:`flex-shrink-0 p-2 rounded-lg bg-black/20 ${r.iconColor}`,children:c.jsx(i,{size:24})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-white font-semibold text-base mb-1",children:r.title}),c.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:r.description})]})]})},s)})}),c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.8,duration:.5},className:"bg-gradient-to-r from-violet-500/20 to-purple-500/20 backdrop-blur-lg rounded-xl p-6 border border-violet-500/30 text-center space-y-3",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:"Ready to Get Started?"}),c.jsx("p",{className:"text-violet-200 text-sm",children:"Join thousands of users trading securely on our decentralized platform"}),c.jsxs("div",{className:"flex flex-col space-y-2 pt-2",children:[c.jsxs("div",{className:"flex items-center justify-center space-x-2 text-violet-300 text-sm",children:[c.jsx(kt,{size:16,className:"text-violet-400"}),c.jsx("span",{children:"No signup required"})]}),c.jsxs("div",{className:"flex items-center justify-center space-x-2 text-violet-300 text-sm",children:[c.jsx(kt,{size:16,className:"text-violet-400"}),c.jsx("span",{children:"Just connect your wallet"})]}),c.jsxs("div",{className:"flex items-center justify-center space-x-2 text-violet-300 text-sm",children:[c.jsx(kt,{size:16,className:"text-violet-400"}),c.jsx("span",{children:"Start trading in seconds"})]})]})]})]})},kM=()=>{const t=[{icon:IC,title:"Connect Your Wallet",description:"Connect Trust Wallet, MetaMask, OKX Wallet, etc. No signup, no KYC, and no exchange deposits  you stay in full control."},{icon:UY,title:"Choose What You Want to Do",description:"Buy USDT (pay via cash/bank) or Sell USDT (receive cash/bank). See best offers from verified users/agents near you."},{icon:Va,title:"Trade Escrow Begins (Smart Contract Lock)",description:"When a trade starts, the sellers USDT is locked in a smart contract escrow until both sides confirm."},{icon:_o,title:"Buyer Makes the Payment",description:"Buyer pays seller directly via cash, UPI, or bank transfer as selected, then clicks Payment Done."},{icon:cf,title:"Smart Contract AutoRelease",description:"After the seller verifies payment, the smart contract automatically releases USDT to the buyer  instant and trustless."},{icon:fn,title:"Agent Support (Optional)",description:"Verified Aagnya Agents help convert cash  USDT. Once balance is set, trade anytime without repeated physical visits."},{icon:cf,title:"Smart Contract Escrow Explained",description:"Think of it like a digital locker that opens only when both sides agree. No admin or middleman can touch funds."},{icon:cl,title:"Zotrust Fee Structure",description:"Platform fee is only 1.8% per transaction. No hidden fees or withdrawal fees. Charges shown before confirming."},{icon:pc,title:"Reputation & Trust System",description:"Users and agents have trust scores from trading history. Higher score = more visibility; fraud is autodetected and flagged."},{icon:vB,title:"Once Setup, Always Easy",description:"After setting an amount with an agent (e.g., 1 lakh USDT), keep trading daily over calls/online without visiting again."}];return c.jsxs("div",{className:"p-4 space-y-6 max-w-md mx-auto pb-20",children:[c.jsxs(ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"text-center space-y-2",children:[c.jsx("h1",{className:"text-3xl font-bold text-white",children:" How Zotrust Works  Simple Explanation for Users"}),c.jsx("p",{className:"text-violet-300 text-sm",children:"Zotrust is a decentralized P2P USDT trading platform. No banks, no middlemen  trades are secured by blockchain smart contracts."})]}),c.jsx("div",{className:"space-y-4",children:t.map((e,n)=>{const r=e.icon;return c.jsx(ee.div,{initial:{y:16,opacity:0},animate:{y:0,opacity:1},transition:{delay:n*.05,duration:.4},className:"bg-violet-500/10 backdrop-blur-lg rounded-xl p-4 border border-violet-500/20",children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:"flex-shrink-0 p-2 rounded-lg bg-black/20 text-violet-400",children:c.jsx(r,{size:22})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-white font-semibold text-base mb-1",children:e.title}),c.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:e.description})]})]})},n)})})]})},Iv=()=>{const{walletAddress:t,orderId:e}=AC(),[n,r]=A.useState(!1),[s,i]=A.useState(null),[o,a]=A.useState(null),[l,d]=A.useState(null),[u,h]=A.useState(0),[f,p]=A.useState(!1),[m,g]=A.useState({orderId:e||"",walletAddress:t||"",reason:"",description:"This is Tesing 1",evidence:{}}),[w,b]=A.useState(!1),[y,x]=A.useState(null),[v,E]=A.useState({type:null,message:""}),[R,S]=A.useState(!1),C=A.useRef(null),N=A.useRef(null);A.useEffect(()=>()=>{H(),l&&l.getTracks().forEach(P=>P.stop())},[l]);const T=async()=>{try{x(null),p(!0),console.log(" Opening camera interface..."),await new Promise(B=>setTimeout(B,200)),console.log(" Requesting camera access...");const P=[{video:{facingMode:{ideal:"environment"},width:{ideal:1280,max:1920},height:{ideal:720,max:1080}},audio:{echoCancellation:!0,noiseSuppression:!0}},{video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!0},{video:{facingMode:"environment"},audio:!0},{video:{facingMode:"user"},audio:!0},{video:!0,audio:!0}];let L=null;for(let B=0;B<P.length;B++)try{console.log(` Trying camera config ${B+1}...`),L=await navigator.mediaDevices.getUserMedia(P[B]),console.log(` Camera config ${B+1} successful!`);break}catch(V){if(console.log(` Config ${B+1} failed:`,V.message),B===P.length-1)throw V}if(!L)throw new Error("Unable to access camera");if(d(L),C.current){C.current.srcObject=L;try{await C.current.play(),console.log(" Video preview playing")}catch(B){console.warn(" Video play warning:",B)}}F(" Camera opened successfully!","success")}catch(P){console.error(" Camera error:",P);const L=P.name==="NotAllowedError"?"Camera access denied. Please allow permissions.":"Failed to access camera: "+P.message;x(L),p(!1),F(L,"error")}},$=()=>{l&&(l.getTracks().forEach(P=>P.stop()),d(null)),C.current&&(C.current.srcObject=null),p(!1),console.log(" Camera closed")},U=async()=>{try{if(!l){F("Please open camera first","error");return}const P=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm","video/mp4"];let L=P[0];for(const X of P)if(MediaRecorder.isTypeSupported(X)){L=X;break}console.log(" Using MIME type:",L);const B=new MediaRecorder(l,{mimeType:L,videoBitsPerSecond:25e5}),V=[];B.ondataavailable=X=>{X.data.size>0&&(V.push(X.data),console.log(" Video chunk received:",X.data.size,"bytes"))},B.onstop=()=>{console.log(" Video recording stopped, creating blob...");const X=new Blob(V,{type:L});console.log(" Video blob created:",X.size,"bytes"),a(X),r(!1),N.current&&(clearInterval(N.current),N.current=null),g(ae=>({...ae,evidence:{...ae.evidence,video:X}})),F(" Video saved and ready for upload!","success")},B.onerror=X=>{console.error(" Recorder error:",X),x("Recording failed: "+X.message)},i(B),B.start(),r(!0),h(0),N.current=setInterval(()=>{h(X=>X+1)},1e3),F(" Video recording started!","success")}catch(P){console.error(" Error starting video recording:",P),x("Failed to start recording: "+P.message),F("Failed to start video recording","error")}},H=()=>{s&&n&&(console.log(" Stopping video recording..."),s.stop())},K=()=>{a(null),h(0),F("Video recording deleted","info")},I=async()=>{if(!m.reason||!m.description){E({type:"error",message:"Please fill in all required fields"});return}if(m.description.trim().length<10){E({type:"error",message:"Description must be at least 10 characters long"});return}b(!0),E({type:null,message:""});try{const P=new FormData;P.append("orderId",m.orderId),P.append("appellant_address",m.walletAddress),P.append("appellant_type","BUYER");let L="OTHER";switch(m.reason){case"payment_not_received":L="PAYMENT_NOT_RECEIVED";break;case"payment_sent_but_not_confirmed":L="PAYMENT_NOT_SENT";break;default:L="OTHER"}P.append("dispute_type",L),P.append("description",m.description),m.evidence.video&&(P.append("evidence_video",m.evidence.video,`video_evidence_${Date.now()}.webm`),console.log(" Added video to FormData:",m.evidence.video.size,"bytes")),console.log(" Submitting appeal with FormData..."),console.log(" Order ID:",m.orderId),console.log(" Wallet Address:",m.walletAddress),console.log(" Dispute Type:",L),console.log(" Description:",m.description);for(let[ae,ce]of P.entries())console.log(`  ${ae}:`,ce instanceof Blob?`Blob(${ce.size} bytes)`:ce);const B=`/api/disputes/${m.orderId}/appeal`;console.log(" API URL:",B);const V=await fetch(B,{method:"POST",body:P});if(console.log(" Response status:",V.status),console.log(" Response ok:",V.ok),!V.ok){const ae=await V.json();throw console.error(" Error response:",ae),new Error(ae.error||"Failed to submit appeal")}const X=await V.json();console.log(" Appeal submitted successfully to backend:",X),E({type:"success",message:" Appeal submitted successfully! Admin will review within 48 hours."})}catch(P){console.error(" Error submitting appeal:",P);const L=P.message||"Failed to submit appeal";E({type:"error",message:` Error: ${L}`})}finally{b(!1)}},j=P=>{const L=Math.floor(P/60),B=P%60;return`${L}:${B.toString().padStart(2,"0")}`},F=(P,L="info")=>{console.log(`[${L.toUpperCase()}] ${P}`)};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h1",{className:"text-3xl font-bold text-white",children:" File Appeal"}),c.jsxs("button",{onClick:()=>S(!0),className:"relative px-4 py-2.5 capitalize  text-lg font-medium  text-white border border-violet-400/30 transition-all shadow-lg hover:shadow-violet-500/20 flex items-center gap-2 overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0",children:c.jsx("video",{muted:!0,playsInline:!0,className:"w-full h-full object-cover scale-110",src:"/api/videos/stream/appeal"})}),c.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:["guide",c.jsx(KQ,{className:"w-6 h-6"})]})]})]}),c.jsxs("div",{className:"space-y-2 text-white/80",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Order ID:"})," ",e]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Wallet:"})," ",t==null?void 0:t.slice(0,6),"...",t==null?void 0:t.slice(-4)]})]})]}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsxs("h3",{className:"text-xl font-semibold text-white mb-4 flex items-center gap-2",children:[c.jsx(hl,{className:"w-5 h-5"})," Video Evidence"]}),y&&c.jsx("div",{className:"mb-4 bg-red-500/20 border border-red-500/30 rounded-lg p-3 text-red-300 text-sm",children:y}),f?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"relative rounded-xl overflow-hidden border-2 border-white/20",children:[c.jsx("video",{ref:C,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-[400px] object-cover bg-black"}),n&&c.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"REC ",j(u)]})]}),c.jsx("div",{className:"flex items-center gap-3",children:n?c.jsxs("button",{onClick:H,className:"flex-1 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-all",children:[c.jsx(YQ,{className:"w-5 h-5"}),"Stop & Save"]}):c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:U,disabled:!!o,className:"flex-1 bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-all",children:[c.jsx(hl,{className:"w-5 h-5"}),"Start Recording"]}),c.jsxs("button",{onClick:$,className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-medium flex items-center gap-2 transition-all",children:[c.jsx(an,{className:"w-5 h-5"}),"Close"]})]})}),o&&c.jsx("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2 text-green-300",children:[c.jsx(kt,{className:"w-5 h-5"}),c.jsxs("span",{className:"font-medium",children:["Video Saved (",o!=null&&o.size?(o.size/1024/1024).toFixed(1):"0"," MB)"]})]}),c.jsx("button",{onClick:K,className:"text-red-400 hover:text-red-300 transition-colors",children:c.jsx(an,{className:"w-5 h-5"})})]})})]}):c.jsxs("button",{onClick:T,className:"w-full bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white px-6 py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-all",children:[c.jsx(qY,{className:"w-5 h-5"}),"Open Camera"]})]}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:" Appeal Details"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-white font-medium mb-2",children:"Reason for Appeal *"}),c.jsxs("select",{value:m.reason,onChange:P=>g(L=>({...L,reason:P.target.value})),className:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Select a reason"}),c.jsx("option",{value:"payment_not_received",children:"Payment not received"}),c.jsx("option",{value:"payment_sent_but_not_confirmed",children:"Payment sent but not confirmed"}),c.jsx("option",{value:"dispute_over_amount",children:"Dispute over amount"}),c.jsx("option",{value:"technical_issue",children:"Technical issue"}),c.jsx("option",{value:"fraud_suspected",children:"Fraud suspected"}),c.jsx("option",{value:"other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-white font-medium mb-2",children:"Description *"}),c.jsx("textarea",{value:m.description,onChange:P=>g(L=>({...L,description:P.target.value})),placeholder:"Please provide detailed information about your appeal... (Minimum 10 characters)",rows:4,className:`w-full p-3 bg-white/10 border rounded-lg text-white placeholder-gray-400 focus:outline-none ${m.description.length>0&&m.description.length<10?"border-red-500/50 focus:border-red-500":"border-white/20 focus:border-blue-500"}`}),c.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[c.jsxs("div",{className:"text-xs text-gray-400",children:[m.description.length>0&&m.description.length<10&&c.jsxs("span",{className:"text-red-400 flex items-center gap-1",children:[c.jsx(qt,{className:"w-3 h-3"}),"Description must be at least 10 characters (",m.description.length,"/10)"]}),m.description.length>=10&&c.jsxs("span",{className:"text-green-400 flex items-center gap-1",children:[c.jsx(kt,{className:"w-3 h-3"}),m.description.length," characters"]})]}),c.jsxs("div",{className:"text-xs text-gray-400",children:[m.description.length,"/10 minimum"]})]})]})]})]}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:c.jsxs("div",{className:"space-y-4",children:[v.type&&c.jsx("div",{className:`p-4 rounded-lg border ${v.type==="success"?"bg-green-500/20 border-green-500/30 text-green-300":"bg-red-500/20 border-red-500/30 text-red-300"}`,children:c.jsxs("div",{className:"flex items-center gap-2",children:[v.type==="success"?c.jsx(kt,{className:"w-5 h-5"}):c.jsx(qt,{className:"w-5 h-5"}),c.jsx("span",{className:"font-medium",children:v.message})]})}),c.jsx("button",{onClick:I,disabled:w||!m.reason||!m.description||m.description.trim().length<10,className:"w-full bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-4 rounded-lg font-semibold text-lg flex items-center justify-center gap-3 transition-all shadow-lg hover:shadow-xl",children:w?c.jsxs(c.Fragment,{children:[c.jsx(sr,{className:"w-6 h-6 animate-spin"}),c.jsx("span",{children:"Submitting Appeal..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(kt,{className:"w-6 h-6"}),c.jsx("span",{children:"Submit Appeal"})]})}),(!m.reason||!m.description||m.description.trim().length<10)&&c.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 flex items-start gap-2",children:[c.jsx(qt,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),c.jsxs("div",{className:"text-yellow-200 text-sm",children:[c.jsx("p",{className:"font-medium mb-1",children:"Required fields missing:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-0.5",children:[!m.reason&&c.jsx("li",{children:"Please select a reason for appeal"}),!m.description&&c.jsx("li",{children:"Please provide a description"}),m.description&&m.description.trim().length<10&&c.jsxs("li",{children:["Description must be at least 10 characters (currently ",m.description.trim().length," characters)"]})]})]})]})]})}),R&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:c.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-slate-900 border border-white/10 rounded-xl overflow-hidden",style:{height:"80vh"},children:[c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Appeal Guide"}),c.jsx("button",{onClick:()=>S(!1),className:"text-gray-300 hover:text-white transition-colors",children:c.jsx(an,{size:20})})]}),c.jsx("div",{className:"bg-black flex-1 flex items-center justify-center",style:{height:"calc(80vh - 120px)"},children:c.jsx("video",{controls:!0,playsInline:!0,className:"w-full h-full object-contain bg-black",src:"/api/videos/stream/appeal"})}),c.jsxs("div",{className:"p-4 flex items-center justify-end gap-2 border-t border-white/10",children:[c.jsx("a",{href:"/api/videos/stream/appeal",target:"_blank",rel:"noopener noreferrer",className:"text-sm px-4 py-2 rounded-lg bg-violet-600 hover:bg-violet-700 text-white transition-colors",children:"Open in new tab"}),c.jsx("button",{onClick:()=>S(!1),className:"text-sm px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-gray-200 border border-white/10 transition-colors",children:"Close"})]})]})})]})})},Eh="ADMIN_SUPPORT",gIe={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]},yIe=({isOpen:t,onClose:e,callerAddress:n})=>{const[r,s]=A.useState("initiating"),[i,o]=A.useState(!1),[a,l]=A.useState(!0),[d,u]=A.useState(0),[h,f]=A.useState("disconnected"),p=A.useRef(null),m=A.useRef(null),g=A.useRef(null),w=A.useRef(null),b=A.useRef(null);A.useEffect(()=>{if(!(!t||!n))return console.log(" SupportCallModal: Setting up socket and starting call"),p.current=jo(Ca,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,timeout:2e4}),p.current.on("connect",()=>{console.log(" SupportCallModal: Connected to signaling server"),p.current.emit("register",n),console.log(" SupportCallModal: Registered as:",n),p.current.emit("initiate-call",{callId:`support-call-${Date.now()}`,receiverAddress:Eh,callerAddress:n,timestamp:Date.now()}),s("connecting"),D("Waiting for admin to accept...",{icon:""})}),p.current.on("call-accepted-by-admin",N=>{console.log(" SupportCallModal: Admin accepted call!",N),D.success("Admin accepted! Connecting..."),x()}),p.current.on("call-waiting-for-acceptance",N=>{console.log(" SupportCallModal: Call notification sent to admin, waiting for acceptance"),s("connecting")}),p.current.on("answer",async({answer:N,from:T})=>{if(console.log(" SupportCallModal: Received answer from",T),m.current&&N)try{await m.current.setRemoteDescription(new RTCSessionDescription(N)),console.log(" SupportCallModal: Remote description set"),s("connecting")}catch($){console.error(" SupportCallModal: Error setting remote description:",$)}}),p.current.on("ice-candidate",async({candidate:N,from:T})=>{if(console.log(" SupportCallModal: Received ICE candidate from",T),m.current&&N&&N.candidate)try{await m.current.addIceCandidate(new RTCIceCandidate(N))}catch($){console.error(" SupportCallModal: Error adding ICE candidate:",$)}}),p.current.on("call-ended",({from:N})=>{console.log(" SupportCallModal: Call ended by",N),v()}),()=>{p.current&&p.current.disconnect(),g.current&&g.current.getTracks().forEach(N=>N.stop()),m.current&&m.current.close()}},[t,n]);const y=()=>{console.log(" SupportCallModal: Creating peer connection");const N=new RTCPeerConnection(gIe);return N.onicecandidate=T=>{T.candidate&&p.current&&(console.log(" SupportCallModal: Sending ICE candidate to admin"),p.current.emit("ice-candidate",{candidate:T.candidate,to:Eh}))},N.ontrack=T=>{console.log(" SupportCallModal: Received remote track:",T.track.kind),T.streams&&T.streams[0]&&w.current&&(w.current.srcObject=T.streams[0],w.current.play().catch($=>{console.error(" SupportCallModal: Audio play error:",$),setTimeout(()=>{w.current&&w.current.srcObject&&w.current.play().catch(U=>console.error("Retry failed:",U))},500)}))},N.onconnectionstatechange=()=>{const T=N.connectionState;f(T),console.log(" SupportCallModal: Connection state:",T),T==="connected"?(s("connected"),S(),D.success("Call connected!")):T==="disconnected"||T==="failed"?(s("ended"),v()):T==="connecting"&&s("connecting")},N.oniceconnectionstatechange=()=>{console.log(" SupportCallModal: ICE connection state:",N.iceConnectionState),(N.iceConnectionState==="connected"||N.iceConnectionState==="completed")&&(s("connected"),S())},N},x=async()=>{try{s("connecting"),console.log(" SupportCallModal: Starting call to admin..."),console.log(" Getting microphone access...");const N=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});console.log(" Got local stream"),g.current=N,m.current=y(),N.getAudioTracks().forEach($=>{m.current.addTrack($,N)}),console.log(" Creating offer...");const T=await m.current.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});await m.current.setLocalDescription(T),console.log(" Offer created and set"),p.current&&(p.current.emit("offer",{offer:T,to:Eh}),console.log(" Offer sent to admin"))}catch(N){console.error(" SupportCallModal: Error starting call:",N),s("failed"),D.error(N.message||"Failed to start call"),v()}},v=()=>{console.log(" SupportCallModal: Ending call"),b.current&&(clearInterval(b.current),b.current=null),p.current&&p.current.emit("end-call",{to:Eh}),m.current&&(m.current.close(),m.current=null),g.current&&(g.current.getTracks().forEach(N=>N.stop()),g.current=null),s("ended"),u(0),e()},E=()=>{if(g.current){const N=g.current.getAudioTracks()[0];N&&(N.enabled=!N.enabled,o(!N.enabled),D(i?"Microphone unmuted":"Microphone muted",{icon:i?"":""}))}},R=()=>{l(!a),w.current&&(w.current.muted=a),D(a?"Speaker off":"Speaker on",{icon:a?"":""})},S=()=>{if(b.current)return;const N=Date.now();b.current=setInterval(()=>{const T=Math.floor((Date.now()-N)/1e3);u(T)},1e3)},C=N=>{const T=Math.floor(N/60),$=N%60;return`${T.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}`};return t?c.jsx(Oo,{children:t&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:c.jsxs(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 rounded-2xl p-6 w-full max-w-md mx-4 border border-white/20 shadow-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Support Call"}),c.jsx("button",{onClick:v,className:"p-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 transition-colors",children:c.jsx(an,{size:20,className:"text-red-400"})})]}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsxs("div",{className:"w-24 h-24 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4 relative",children:[c.jsx(_C,{size:40,className:"text-white"}),(r==="connecting"||r==="initiating")&&c.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-green-400 border-t-transparent animate-spin"})]}),c.jsxs("h3",{className:"text-lg font-semibold text-white mb-2",children:[r==="initiating"&&"Initiating call...",r==="connecting"&&"Connecting...",r==="connected"&&"Connected",r==="ended"&&"Call ended",r==="failed"&&"Call failed"]}),c.jsxs("p",{className:"text-gray-400 text-sm",children:[r==="connected"&&C(d),r!=="connected"&&"Admin Support"]}),h!=="disconnected"&&c.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-2",children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${h==="connected"?"bg-green-500":h==="connecting"?"bg-yellow-500":"bg-red-500"}`}),c.jsx("span",{className:"text-xs text-gray-400 capitalize",children:h})]})]}),r==="connected"&&c.jsx("div",{className:"text-center mb-6",children:c.jsxs("div",{className:"flex items-center justify-center space-x-2 text-gray-400",children:[c.jsx(Pr,{size:16}),c.jsx("span",{className:"text-sm font-mono",children:C(d)})]})}),c.jsxs("div",{className:"flex items-center justify-center space-x-6 mb-6",children:[c.jsx("button",{onClick:E,className:`p-4 rounded-full transition-colors ${i?"bg-red-500/20 hover:bg-red-500/30":"bg-white/10 hover:bg-white/20"}`,children:i?c.jsx(uw,{size:24,className:"text-red-400"}):c.jsx(dg,{size:24,className:"text-white"})}),c.jsx("button",{onClick:v,className:"p-4 rounded-full bg-red-500 hover:bg-red-600 transition-colors",children:c.jsx(Vx,{size:24,className:"text-white"})}),c.jsx("button",{onClick:R,className:`p-4 rounded-full transition-colors ${a?"bg-white/10 hover:bg-white/20":"bg-yellow-500/20 hover:bg-yellow-500/30"}`,children:a?c.jsx(AB,{size:24,className:"text-white"}):c.jsx(SB,{size:24,className:"text-yellow-400"})})]}),c.jsx("audio",{ref:w,autoPlay:!0})]})})}):null},_V=()=>{const t="0123456789abcdef";let e="0x";for(let n=0;n<40;n++)e+=t[Math.floor(Math.random()*t.length)];return e},IM=()=>{const[t,e]=A.useState(!0),[n,r]=A.useState(!1),[s,i]=A.useState(null),[o,a]=A.useState(!1),[l,d]=A.useState(null),[u,h]=A.useState(!1),f=Os(),{walletAddress:p}=AC(),{address:m}=Xt(),g=p||m||_V();A.useEffect(()=>{w(),b();const v=()=>{h(!1)};return Mg.onCallEvent("call-ended",v),()=>{Mg.offCallEvent("call-ended")}},[]);const w=()=>{const v=navigator.userAgent.toLowerCase(),E=v.includes("metamask")||v.includes("mim")||window.ethereum&&window.ethereum.isMetaMask&&v.includes("mobile");r(E),e(!1),E&&D("Please open this page in Chrome browser for better call experience",{duration:5e3,icon:""})},b=async()=>{var v;try{const E=await fetch("/api/admin/support-address");if(E.ok){const R=await E.json();R.success&&((v=R.data)!=null&&v.address)?i(R.data.address):(console.log(" Using fixed ADMIN_SUPPORT address"),i(Eh))}else console.log(" API failed, using fixed ADMIN_SUPPORT address"),i(Eh)}catch(E){console.error("Error fetching admin address:",E),console.log(" Using fixed ADMIN_SUPPORT address (fallback)"),i(Eh)}},y=async()=>{try{a(!0),d(null),console.log(" Opening support call modal with address:",g),h(!0),D.success("Connecting to admin support...")}catch(v){console.error("Error opening support call:",v),d(v.message||"Failed to open call"),D.error(v.message||"Failed to open call"),h(!1)}finally{a(!1)}},x=()=>{const v=window.location.href;navigator.userAgent.includes("Android")?window.location.href=`intent://${v.replace(/^https?:\/\//,"")}#Intent;scheme=https;package=com.android.chrome;end`:D("Please copy the URL and open it in Chrome browser",{duration:5e3})};return t?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:c.jsxs("div",{className:"text-center",children:[c.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-violet-500"}),c.jsx("p",{className:"text-gray-300",children:"Checking browser..."})]})}):c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:[c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("button",{onClick:()=>f(-1),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:c.jsx(an,{size:20,className:"text-white"})}),c.jsx("h1",{className:"text-xl font-bold text-white",children:"Support Call"}),c.jsx("div",{className:"w-9"})," "]}),n&&c.jsx(ee.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(qt,{size:20,className:"text-yellow-400 flex-shrink-0 mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-yellow-300 font-medium text-sm mb-2",children:"MetaMask Browser Detected"}),c.jsx("p",{className:"text-yellow-400 text-xs mb-3",children:"For the best call experience, please open this page in Chrome browser."}),c.jsx("button",{onClick:x,className:"text-xs bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-300 px-3 py-1.5 rounded-lg transition-colors",children:"Open in Chrome"})]})]})}),c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(_C,{size:32,className:"text-white"})}),c.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Contact Admin Support"}),c.jsx("p",{className:"text-gray-300 text-sm",children:"Get instant help from our admin team through voice call"})]}),p&&c.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(kt,{size:16,className:"text-blue-400"}),c.jsxs("p",{className:"text-blue-300 text-sm",children:["Wallet Address: ",p.slice(0,8),"...",p.slice(-6)]})]}),c.jsx("p",{className:"text-blue-400 text-xs mt-2",children:"Call will be made using wallet address from URL"})]}),!g&&c.jsxs("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(qt,{size:16,className:"text-red-400"}),c.jsx("p",{className:"text-red-300 text-sm",children:p?"Invalid wallet address in URL":"Please connect your wallet or provide wallet address in URL"})]}),c.jsx("button",{onClick:()=>f("/"),className:"mt-3 w-full bg-red-500/20 hover:bg-red-500/30 text-red-300 py-2 px-4 rounded-lg font-medium transition-colors text-sm",children:"Go to Dashboard"})]}),l&&c.jsx("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-4 mb-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(qt,{size:16,className:"text-red-400"}),c.jsx("p",{className:"text-red-300 text-sm",children:l})]})}),c.jsx("button",{onClick:y,disabled:!g||o,className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 disabled:from-gray-500 disabled:to-gray-600 disabled:opacity-50 text-white py-4 px-6 rounded-lg font-semibold transition-all flex items-center justify-center space-x-2",children:o?c.jsxs(c.Fragment,{children:[c.jsx(sr,{className:"w-5 h-5 animate-spin"}),c.jsx("span",{children:"Connecting..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(fn,{size:20}),c.jsx("span",{children:"Call Admin Support"})]})}),s===null&&c.jsx("p",{className:"text-center text-gray-400 text-xs mt-4",children:"Preparing admin support connection..."}),c.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:c.jsxs("div",{className:"space-y-2 text-xs text-gray-400",children:[c.jsxs("p",{className:"flex items-center space-x-2",children:[c.jsx(fn,{size:14,className:"text-green-400"}),c.jsx("span",{children:"Voice call powered by WebRTC"})]}),c.jsxs("p",{className:"flex items-center space-x-2",children:[c.jsx(qt,{size:14,className:"text-violet-400"}),c.jsx("span",{children:"Make sure microphone permissions are enabled"})]})]})})]})]}),g&&c.jsx(yIe,{isOpen:u,callerAddress:g,onClose:()=>{h(!1)}})]})},wIe=()=>{const[t,e]=A.useState(!0),[n,r]=A.useState(!1),[s,i]=A.useState(null),[o,a]=A.useState(null),[l,d]=A.useState(!0),[u,h]=A.useState(null),[f,p]=A.useState("idle"),[m,g]=A.useState(!1),[w,b]=A.useState(0),[y,x]=A.useState(!1),[v,E]=A.useState("disconnected"),[R,S]=A.useState(!1),C=Os(),{orderId:N,walletAddress:T}=AC(),$=T||_V(),U=A.useRef(null),H=A.useRef(null),K=A.useRef(null),I=A.useRef(null),j=A.useRef(null),F=A.useRef(null),P={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]},L=A.useCallback(()=>{if(!N||!T)return;const pe=`${window.location.href.split("/#")[0]}/call/${N}/${T}`;if(window.confirm(` Microphone Access Required!

To make voice calls, you need to open this in Chrome browser with microphone permissions.

Click OK to open in Chrome browser.

This will redirect you to: ${pe}

Wallet: ${T}
Order: ${N}`))try{window.open(pe,"_blank"),navigator.clipboard.writeText(pe).then(()=>{D.success("URL copied to clipboard! Paste it in Chrome browser.")}).catch(()=>{D.error("Please copy this URL and open in Chrome browser: "+pe)})}catch(An){console.error("Error opening external browser:",An),D.error("Please copy this URL and open in Chrome browser: "+pe)}},[N,T]);A.useCallback(()=>{if(!N||!T)return;const pe=`${window.location.href.split("/#")[0]}/call/${N}/${T}`;if(window.confirm(` DApp Browser Detected!

To make voice calls, you need to open this in your default browser (Chrome, Safari, etc.).

Click OK to open in external browser.

This will redirect you to: ${pe}

Wallet: ${T}
Order: ${N}`))try{window.open(pe,"_blank"),navigator.clipboard.writeText(pe).then(()=>{D.success("URL copied to clipboard! Paste it in your browser.")}).catch(()=>{D.error("Please copy this URL and open in your browser: "+pe)})}catch(An){console.error("Error opening external browser:",An),D.error("Please copy this URL and open in your browser: "+pe)}},[N,T]),A.useEffect(()=>{(async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){console.warn("MediaDevices API not available"),i(!1),e(!1);return}const Ue=await navigator.permissions.query({name:"microphone"}).catch(()=>null);if((Ue==null?void 0:Ue.state)==="denied"){console.warn("Microphone permission denied"),i(!1),e(!1);return}try{(await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})).getTracks().forEach(it=>it.stop()),i(!0)}catch(pe){console.warn("Failed to get microphone access:",pe),i(!1)}}catch(Ue){console.error("Error checking microphone:",Ue),i(!1)}finally{e(!1)}})()},[]),A.useEffect(()=>{!t&&s!==!1&&B()},[t,s,N,T]);const B=async()=>{var Ve;try{d(!0),h(null);const Ue=localStorage.getItem("authToken")||"",pe=await fetch("/api/orders/my-orders",{headers:{"Content-Type":"application/json",...Ue&&{Authorization:`Bearer ${Ue}`}}});if(!pe.ok)throw new Error("Failed to fetch order details. Please login to access this feature.");const nt=((await pe.json()).data||[]).find(wt=>String(wt.id)===String(N));if(!nt)throw new Error("Order not found");const bn={id:String(nt.id),buyerAddress:nt.buyer_address,sellerAddress:nt.seller_address,amount:nt.amount,token:nt.token,state:nt.state,buyerName:nt.buyer_name,sellerName:nt.seller_name};a(bn);const Fe=$.toLowerCase()===bn.buyerAddress.toLowerCase(),ct=$.toLowerCase()===bn.sellerAddress.toLowerCase();Fe?F.current=bn.sellerAddress:ct?F.current=bn.buyerAddress:F.current=Fe?bn.sellerAddress:bn.buyerAddress,F.current&&((Ve=U.current)!=null&&Ve.connected)&&V()}catch(Ue){console.error("Error fetching order:",Ue),h(Ue.message||"Failed to fetch order details")}finally{d(!1)}},V=()=>{U.current&&F.current&&U.current.emit("check-user-status",F.current)},X=()=>{H.current&&H.current.close(),console.log(" OrderCallPage: Creating peer connection");const Ve=new RTCPeerConnection(P);return Ve.onicecandidate=Ue=>{Ue.candidate&&U.current&&F.current&&(console.log(" OrderCallPage: Sending ICE candidate"),U.current.emit("ice-candidate",{candidate:Ue.candidate,to:F.current}))},Ve.ontrack=Ue=>{console.log(" OrderCallPage: Received remote track:",Ue.track.kind),Ue.streams&&Ue.streams[0]&&I.current&&(I.current.srcObject=Ue.streams[0],I.current.play().catch(pe=>{console.error(" Audio play error:",pe),setTimeout(()=>{I.current&&I.current.srcObject&&I.current.play().catch(it=>console.error("Retry failed:",it))},500)}))},Ve.onconnectionstatechange=()=>{const Ue=Ve.connectionState;console.log(" OrderCallPage: Connection state:",Ue),E(Ue),Ue==="connected"?(p("active"),ue(),D.success("Call connected!")):(Ue==="disconnected"||Ue==="failed")&&ce()},Ve},ae=async()=>{if(!F.current||!U.current){D.error("Target user not available");return}try{p("connecting");const Ve=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});K.current=Ve,H.current=X(),Ve.getAudioTracks().forEach(pe=>{H.current.addTrack(pe,Ve)});const Ue=await H.current.createOffer();await H.current.setLocalDescription(Ue),U.current.emit("offer",{offer:Ue,to:F.current}),p("ringing"),D.success("Call initiated")}catch(Ve){console.error("Error starting call:",Ve),D.error(Ve.message||"Failed to start call"),p("idle"),ie()}},ce=()=>{p("idle"),Q(),ie(),U.current&&F.current&&U.current.emit("end-call",{to:F.current}),D("Call ended",{icon:""})},ie=()=>{H.current&&(H.current.close(),H.current=null),K.current&&(K.current.getTracks().forEach(Ve=>Ve.stop()),K.current=null),E("disconnected")},Te=()=>{if(K.current){const Ve=K.current.getAudioTracks()[0];Ve&&(Ve.enabled=!Ve.enabled,g(!Ve.enabled),D(m?"Microphone unmuted":"Microphone muted",{icon:m?"":""}))}},ue=()=>{j.current&&clearInterval(j.current),b(0),j.current=setInterval(()=>{b(Ve=>Ve+1)},1e3)},Q=()=>{j.current&&(clearInterval(j.current),j.current=null),b(0)},xe=Ve=>{const Ue=Math.floor(Ve/60),pe=Ve%60;return`${Ue.toString().padStart(2,"0")}:${pe.toString().padStart(2,"0")}`};if(t)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:c.jsxs("div",{className:"text-center",children:[c.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-violet-500"}),c.jsx("p",{className:"text-gray-300",children:"Checking microphone access..."})]})});if(s===!1)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 max-w-md text-center",children:[c.jsx(uw,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Microphone Access Required"}),c.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"To make voice calls, you need to grant microphone permissions. Please open this page in Chrome browser and allow microphone access."}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("button",{onClick:L,className:"w-full bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Open in Chrome Browser"}),c.jsx("button",{onClick:()=>C("/orders"),className:"w-full bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go Back to Orders"})]})]})});if(n)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 max-w-md text-center",children:[c.jsx(qt,{className:"w-12 h-12 text-yellow-400 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"DApp Browser Detected"}),c.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"Please open this page in Chrome or Safari browser for the best call experience."}),c.jsx("button",{onClick:()=>C("/orders"),className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go Back to Orders"})]})});if(l)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:c.jsxs("div",{className:"text-center",children:[c.jsx(sr,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-violet-500"}),c.jsx("p",{className:"text-gray-300",children:"Loading order details..."})]})});if(u||!o)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 max-w-md text-center",children:[c.jsx(qt,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Order Not Found"}),c.jsx("p",{className:"text-gray-300 text-sm mb-4",children:u||"Unable to load order details"}),c.jsx("button",{onClick:()=>C("/orders"),className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go Back to Orders"})]})});const Pe=$.toLowerCase()===o.buyerAddress.toLowerCase(),Y=$.toLowerCase()===o.sellerAddress.toLowerCase(),me=Pe?o.sellerAddress:o.buyerAddress,le=Pe?o.sellerName:o.buyerName,tt=Pe?"Buyer":Y?"Seller":"Unknown";return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:[c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("button",{onClick:()=>C("/orders"),className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:c.jsx(an,{size:20,className:"text-white"})}),c.jsx("h1",{className:"text-xl font-bold text-white",children:"Order Call"}),c.jsx("div",{className:"w-9"})]}),c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(_C,{size:28,className:"text-white"})}),c.jsxs("h2",{className:"text-lg font-bold text-white mb-2",children:["Order #",o.id]}),c.jsxs("p",{className:"text-gray-300 text-sm",children:[o.amount," ",o.token]})]}),c.jsxs("div",{className:"space-y-3 mb-6",children:[c.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[c.jsx(kt,{size:14,className:"text-blue-400"}),c.jsxs("p",{className:"text-blue-300 text-sm font-medium",children:["You (",tt,")"]})]}),c.jsx("p",{className:"text-blue-400 text-xs font-mono break-all",children:$}),y&&c.jsxs("div",{className:"flex items-center space-x-1 mt-2",children:[c.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),c.jsx("span",{className:"text-green-400 text-xs",children:"Connected"})]})]}),c.jsxs("div",{className:"bg-purple-500/20 border border-purple-500/30 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[c.jsx(fn,{size:14,className:"text-purple-400"}),c.jsxs("p",{className:"text-purple-300 text-sm font-medium",children:[Pe?"Seller":"Buyer",le&&` (${le})`]})]}),c.jsx("p",{className:"text-purple-400 text-xs font-mono break-all",children:me}),c.jsx("div",{className:"flex items-center space-x-1 mt-2",children:R?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),c.jsx("span",{className:"text-green-400 text-xs",children:"Online"})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),c.jsx("span",{className:"text-gray-400 text-xs",children:"Offline"})]})})]})]}),!y&&c.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4",children:c.jsx("p",{className:"text-yellow-300 text-sm",children:"Connecting to call service..."})}),y&&c.jsxs("div",{className:"space-y-3",children:[f==="idle"&&c.jsxs("button",{onClick:ae,disabled:!R,className:"w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 disabled:from-gray-500 disabled:to-gray-600 disabled:opacity-50 text-white py-4 px-6 rounded-lg font-semibold transition-all flex items-center justify-center space-x-2",children:[c.jsx(fn,{size:20}),c.jsx("span",{children:R?"Call Other Party":"Other Party Offline"})]}),f==="connecting"&&c.jsxs("div",{className:"text-center py-4",children:[c.jsx(sr,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-blue-400"}),c.jsx("p",{className:"text-gray-300 text-sm",children:"Connecting..."})]}),f==="ringing"&&c.jsxs("div",{className:"text-center py-4",children:[c.jsx(sr,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-yellow-400"}),c.jsx("p",{className:"text-gray-300 text-sm",children:"Ringing..."})]}),f==="active"&&c.jsxs("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-4",children:[c.jsx("div",{className:"flex items-center justify-center space-x-4 mb-4",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Pr,{size:24,className:"text-green-400 mx-auto mb-2"}),c.jsx("p",{className:"text-green-300 font-mono text-lg",children:xe(w)})]})}),c.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[c.jsx(ee.button,{onClick:Te,className:`p-3 rounded-full transition-colors ${m?"bg-red-500/20 text-red-400":"bg-white/10 text-green-400"}`,whileTap:{scale:.95},children:m?c.jsx(uw,{size:24}):c.jsx(dg,{size:24})}),c.jsx(ee.button,{onClick:ce,className:"p-3 rounded-full bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors",whileTap:{scale:.95},children:c.jsx(Vx,{size:24})})]}),c.jsx("p",{className:"text-center text-green-300 text-sm mt-4",children:"Call Active"})]})]}),c.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:c.jsxs("div",{className:"space-y-2 text-xs text-gray-400",children:[c.jsxs("p",{className:"flex items-center space-x-2",children:[c.jsx(fn,{size:14,className:"text-green-400"}),c.jsx("span",{children:"Voice call powered by WebRTC"})]}),c.jsxs("p",{className:"flex items-center space-x-2",children:[c.jsx(qt,{size:14,className:"text-violet-400"}),c.jsx("span",{children:"Make sure microphone permissions are enabled"})]})]})})]})]}),c.jsx("audio",{ref:I,autoPlay:!0,style:{display:"none"}})]})},xIe=()=>{const[t,e]=A.useState({email:"admin@zotrust.com",password:"admin123"}),[n,r]=A.useState(!1),[s,i]=A.useState(!1),o=Os(),a=async d=>{var u,h;d.preventDefault(),i(!0);try{const f=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),p=await f.json();f.ok?(console.log("AdminLogin - Response data:",p),console.log("AdminLogin - Token received:",(u=p.data)==null?void 0:u.token),localStorage.setItem("adminToken",(h=p.data)==null?void 0:h.token),console.log("AdminLogin - Token stored in localStorage"),D.success("Login successful!"),o("/admin")):D.error(p.error||"Login failed")}catch(f){console.error("Login error:",f),D.error("Login failed. Please try again.")}finally{i(!1)}},l=d=>{e({...t,[d.target.name]:d.target.value})};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center p-4",children:c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 w-full max-w-md border border-white/20",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx(ee.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(cf,{className:"w-8 h-8 text-white"})}),c.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Admin Portal"}),c.jsx("p",{className:"text-gray-300",children:"Sign in to access the admin dashboard"})]}),c.jsxs("form",{onSubmit:a,className:"space-y-6",children:[c.jsxs(ee.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),c.jsx("div",{className:"relative",children:c.jsx("input",{type:"email",name:"email",value:t.email,onChange:l,required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"admin@zotrust.com"})})]}),c.jsxs(ee.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:n?"text":"password",name:"password",value:t.password,onChange:l,required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-12",placeholder:"Enter your password"}),c.jsx("button",{type:"button",onClick:()=>r(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white transition-colors",children:n?c.jsx(xB,{size:20}):c.jsx(cg,{size:20})})]})]}),c.jsx(ee.button,{type:"submit",disabled:s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:from-purple-700 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:s?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),c.jsx("span",{children:"Signing in..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Va,{size:20}),c.jsx("span",{children:"Sign In"})]})})]}),c.jsxs(ee.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-8 text-center",children:[c.jsx("p",{className:"text-gray-400 text-sm",children:"Secure admin access to Zotrust platform"}),c.jsx("button",{onClick:()=>{localStorage.clear(),D.success("Local storage cleared")},className:"mt-2 text-xs text-gray-500 hover:text-gray-300 underline",children:"Clear expired tokens"})]})]})})},bIe=()=>{const[t,e]=A.useState({totalOrders:0,totalTransactions:0,totalDisputes:0,totalAgents:0,totalLocations:0,pendingDisputes:0,completedOrders:0,totalVolume:0}),[n,r]=A.useState(!0),s=Os();A.useEffect(()=>{i()},[]);const i=async()=>{try{const l=localStorage.getItem("adminToken");if(console.log("AdminDashboard - Token from localStorage:",l),!l){s("/admin/login");return}console.log("AdminDashboard - Making request to /api/admin/dashboard-stats");const d=await fetch("/api/admin/dashboard-stats",{headers:{Authorization:`Bearer ${l}`}});if(d.ok){const u=await d.json();e(u.data)}else d.status===401?(localStorage.removeItem("adminToken"),s("/admin/login")):D.error("Failed to load dashboard stats")}catch(l){console.error("Error fetching dashboard stats:",l),D.error("Failed to load dashboard stats")}finally{r(!1)}},o=[{title:"Total Orders",value:t.totalOrders,icon:W2,color:"from-blue-500 to-blue-600",bgColor:"bg-blue-500/10",textColor:"text-blue-400"},{title:"Total Transactions",value:t.totalTransactions,icon:dw,color:"from-green-500 to-green-600",bgColor:"bg-green-500/10",textColor:"text-green-400"},{title:"Active Disputes",value:t.totalDisputes,icon:X1,color:"from-orange-500 to-orange-600",bgColor:"bg-orange-500/10",textColor:"text-orange-400"},{title:"Pending Disputes",value:t.pendingDisputes,icon:Jd,color:"from-red-500 to-red-600",bgColor:"bg-red-500/10",textColor:"text-red-400"},{title:"Total Agents",value:t.totalAgents,icon:hg,color:"from-purple-500 to-purple-600",bgColor:"bg-purple-500/10",textColor:"text-purple-400"},{title:"Total Locations",value:t.totalLocations,icon:lg,color:"from-indigo-500 to-indigo-600",bgColor:"bg-indigo-500/10",textColor:"text-indigo-400"},{title:"Completed Orders",value:t.completedOrders,icon:kt,color:"from-emerald-500 to-emerald-600",bgColor:"bg-emerald-500/10",textColor:"text-emerald-400"},{title:"Total Volume",value:`$${t.totalVolume.toLocaleString()}`,icon:_o,color:"from-yellow-500 to-yellow-600",bgColor:"bg-yellow-500/10",textColor:"text-yellow-400"}],a=[{title:"Manage Orders",description:"View and manage all orders",icon:W2,color:"from-blue-500 to-blue-600",onClick:()=>s("/admin/orders")},{title:"View Transactions",description:"Monitor all transactions",icon:dw,color:"from-green-500 to-green-600",onClick:()=>s("/admin/transactions")},{title:"Resolve Disputes",description:"Handle dispute cases",icon:X1,color:"from-orange-500 to-orange-600",onClick:()=>s("/admin/disputes")},{title:"Manage Agents",description:"Add and manage agents",icon:hg,color:"from-purple-500 to-purple-600",onClick:()=>s("/admin/agents")},{title:"Manage Locations",description:"Add and manage locations",icon:lg,color:"from-indigo-500 to-indigo-600",onClick:()=>s("/admin/locations")}];return n?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading dashboard..."})]})}):c.jsxs("div",{children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:o.map((l,d)=>c.jsx(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:d*.1},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 hover:bg-white/20 transition-all duration-300",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-300 text-sm font-medium",children:l.title}),c.jsx("p",{className:"text-2xl font-bold text-white mt-2",children:l.value})]}),c.jsx("div",{className:`w-12 h-12 rounded-lg ${l.bgColor} flex items-center justify-center`,children:c.jsx(l.icon,{className:`w-6 h-6 ${l.textColor}`})})]})},l.title))}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Quick Actions"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((l,d)=>c.jsx(ee.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:d*.1},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:l.onClick,className:"bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg p-4 text-left transition-all duration-300 group",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-r ${l.color} flex items-center justify-center`,children:c.jsx(l.icon,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-white font-medium group-hover:text-white/90",children:l.title}),c.jsx("p",{className:"text-gray-400 text-sm",children:l.description})]})]})},l.title))})]})]})},vIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,a]=A.useState(""),[l,d]=A.useState("all"),[u,h]=A.useState(null),[f,p]=A.useState(!1),[m,g]=A.useState({totalTransactionsToday:0,totalAmountToday:0,totalAdminFees:0,totalReleasedAmount:0,totalTokensReleased:0,totalTokensToAdmin:0,totalTokensToSellers:0}),w=Os();A.useEffect(()=>{y()},[]),A.useEffect(()=>{x(),b()},[t,o,l]);const b=()=>{const C=new Date().toDateString(),N=t.filter(P=>new Date(P.created_at).toDateString()===C),T=t.filter(P=>P.state==="RELEASED");let $=N.length,U=0,H=0,K=0,I=0,j=0,F=0;N.forEach(P=>{const L=parseFloat(P.amount);U+=L}),T.forEach(P=>{const L=parseFloat(P.amount),B=parseFloat(P.price_inr),V=L*B,X=V*.018,ae=V-X,ce=L*.018,ie=L-ce;H+=X,K+=ae,I+=L,j+=ce,F+=ie}),g({totalTransactionsToday:$,totalAmountToday:U,totalAdminFees:H,totalReleasedAmount:K,totalTokensReleased:I,totalTokensToAdmin:j,totalTokensToSellers:F})},y=async()=>{try{const C=localStorage.getItem("adminToken");if(!C){w("/admin/login");return}const N=await fetch("/api/admin/orders",{headers:{Authorization:`Bearer ${C}`}});if(N.ok){const T=await N.json();e(T.data)}else N.status===401?(localStorage.removeItem("adminToken"),w("/admin/login")):D.error("Failed to load orders")}catch(C){console.error("Error fetching orders:",C),D.error("Failed to load orders")}finally{i(!1)}},x=()=>{let C=t;o&&(C=C.filter(N=>{var T,$;return N.id.toString().toLowerCase().includes(o.toLowerCase())||N.buyer_address.toLowerCase().includes(o.toLowerCase())||N.seller_address.toLowerCase().includes(o.toLowerCase())||N.agent_branch.toLowerCase().includes(o.toLowerCase())||((T=N.buyer_name)==null?void 0:T.toLowerCase().includes(o.toLowerCase()))||(($=N.seller_name)==null?void 0:$.toLowerCase().includes(o.toLowerCase()))})),l!=="all"&&(C=C.filter(N=>N.state===l)),r(C)},v=C=>{switch(C){case"CREATED":return"text-blue-400 bg-blue-500/10";case"ACCEPTED":return"text-yellow-400 bg-yellow-500/10";case"LOCKED":return"text-orange-400 bg-orange-500/10";case"RELEASED":return"text-green-400 bg-green-500/10";case"CANCELLED":return"text-red-400 bg-red-500/10";case"EXPIRED":return"text-gray-400 bg-gray-500/10";case"UNDER_DISPUTE":return"text-purple-400 bg-purple-500/10";case"REFUNDED":return"text-pink-400 bg-pink-500/10";default:return"text-gray-400 bg-gray-500/10"}},E=C=>{switch(C){case"CREATED":return c.jsx(Pr,{size:16});case"ACCEPTED":return c.jsx(kt,{size:16});case"LOCKED":return c.jsx(Jd,{size:16});case"RELEASED":return c.jsx(kt,{size:16});case"CANCELLED":return c.jsx(xr,{size:16});case"EXPIRED":return c.jsx(xr,{size:16});case"UNDER_DISPUTE":return c.jsx(Jd,{size:16});case"REFUNDED":return c.jsx(_o,{size:16});default:return c.jsx(Pr,{size:16})}},R=C=>{h(C),p(!0)},S=async C=>{try{const N=localStorage.getItem("adminToken"),T=await fetch(`/api/admin/orders/${C}/manual-refund`,{method:"POST",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"}});if(T.ok)D.success("Manual refund initiated"),y(),p(!1);else{const $=await T.json();D.error($.error||"Failed to initiate refund")}}catch(N){console.error("Error initiating manual refund:",N),D.error("Failed to initiate refund")}};return s?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading orders..."})]})}):c.jsxs("div",{children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-blue-100 text-sm",children:"Today's Transactions"}),c.jsx("p",{className:"text-2xl font-bold",children:m.totalTransactionsToday})]}),c.jsx(_o,{size:24,className:"text-blue-200"})]})}),c.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-4 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-green-100 text-sm",children:"Total Tokens Released"}),c.jsxs("p",{className:"text-2xl font-bold",children:[m.totalTokensReleased.toFixed(6)," TBNB"]})]}),c.jsx(_o,{size:24,className:"text-green-200"})]})}),c.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-purple-100 text-sm",children:"Admin Wallet (1.8%)"}),c.jsxs("p",{className:"text-2xl font-bold",children:[m.totalTokensToAdmin.toFixed(6)," TBNB"]}),c.jsxs("p",{className:"text-purple-200 text-xs",children:["",m.totalAdminFees.toFixed(2)]})]}),c.jsx(_o,{size:24,className:"text-purple-200"})]})}),c.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-4 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-orange-100 text-sm",children:"Released to Sellers"}),c.jsxs("p",{className:"text-2xl font-bold",children:[m.totalTokensToSellers.toFixed(6)," TBNB"]}),c.jsxs("p",{className:"text-orange-200 text-xs",children:["",m.totalReleasedAmount.toFixed(2)]})]}),c.jsx(_o,{size:24,className:"text-orange-200"})]})})]}),c.jsx("div",{className:"flex justify-end mb-6",children:c.jsxs("button",{onClick:y,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(wa,{size:16}),c.jsx("span",{children:"Refresh"})]})}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),c.jsxs("div",{className:"relative",children:[c.jsx(Tf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c.jsx("input",{type:"text",value:o,onChange:C=>a(C.target.value),placeholder:"Search by ID, address, or agent...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status Filter"}),c.jsxs("select",{value:l,onChange:C=>d(C.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"all",children:"All Status"}),c.jsx("option",{value:"CREATED",children:"Created"}),c.jsx("option",{value:"ACCEPTED",children:"Accepted"}),c.jsx("option",{value:"LOCKED",children:"Locked"}),c.jsx("option",{value:"RELEASED",children:"Released"}),c.jsx("option",{value:"CANCELLED",children:"Cancelled"}),c.jsx("option",{value:"EXPIRED",children:"Expired"}),c.jsx("option",{value:"UNDER_DISPUTE",children:"Under Dispute"}),c.jsx("option",{value:"REFUNDED",children:"Refunded"})]})]}),c.jsx("div",{className:"flex items-end",children:c.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",n.length," of ",t.length," orders"]})})]})}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-white/5",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order ID"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Type"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Buyer"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Seller"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Agent"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((C,N)=>c.jsxs(ee.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.05},className:"hover:bg-white/5 transition-colors",children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",C.id]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${C.ad_type==="BUY"?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:C.ad_type})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium",children:[C.amount," ",C.token]}),c.jsxs("div",{className:"text-xs text-gray-400",children:["",parseFloat(C.price_inr).toFixed(2)]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:C.buyer_name||"Unknown"}),c.jsx("div",{className:"text-xs text-gray-400",children:C.buyer_mobile||"No mobile"}),c.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[C.buyer_address.slice(0,8),"...",C.buyer_address.slice(-6)]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:C.seller_name||"Unknown"}),c.jsx("div",{className:"text-xs text-gray-400",children:C.seller_mobile||"No mobile"}),c.jsxs("div",{className:"text-xs text-gray-500 font-mono",children:[C.seller_address.slice(0,8),"...",C.seller_address.slice(-6)]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${v(C.state)}`,children:[E(C.state),c.jsx("span",{className:"ml-1",children:C.state})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:C.agent_branch}),c.jsx("div",{className:"text-xs text-gray-400",children:C.agent_mobile}),c.jsx("div",{className:"text-xs text-gray-500",children:C.location_city})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(C.created_at).toLocaleDateString()}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsx("button",{onClick:()=>R(C),className:"text-blue-400 hover:text-blue-300 transition-colors",children:c.jsx(cg,{size:16})})})]},C.id))})]})})}),f&&u&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:c.jsxs(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Order Details"}),c.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-white transition-colors",children:c.jsx(xr,{size:24})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order ID"}),c.jsxs("p",{className:"text-white font-mono",children:["#",u.id]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Status"}),c.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${v(u.state)}`,children:[E(u.state),c.jsx("span",{className:"ml-1",children:u.state})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Amount"}),c.jsxs("p",{className:"text-white",children:[u.amount," ",u.token]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Price (INR)"}),c.jsxs("p",{className:"text-white",children:["",u.price_inr]})]})]}),c.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:[c.jsx("h4",{className:"text-blue-300 font-medium mb-2",children:"Buyer Information"}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Name:"})," ",u.buyer_name||"Unknown"]}),c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Mobile:"})," ",u.buyer_mobile||"No mobile"]}),c.jsxs("p",{className:"text-white font-mono text-sm",children:[c.jsx("span",{className:"text-gray-400",children:"Address:"})," ",u.buyer_address]})]})]}),c.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-4",children:[c.jsx("h4",{className:"text-green-300 font-medium mb-2",children:"Seller Information"}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Name:"})," ",u.seller_name||"Unknown"]}),c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Mobile:"})," ",u.seller_mobile||"No mobile"]}),c.jsxs("p",{className:"text-white font-mono text-sm",children:[c.jsx("span",{className:"text-gray-400",children:"Address:"})," ",u.seller_address]})]})]}),c.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-lg p-4",children:[c.jsx("h4",{className:"text-purple-300 font-medium mb-2",children:"Agent Information"}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Branch:"})," ",u.agent_branch]}),c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Mobile:"})," ",u.agent_mobile]}),c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Address:"})," ",u.agent_address]}),c.jsxs("p",{className:"text-white",children:[c.jsx("span",{className:"text-gray-400",children:"Location:"})," ",u.location_city,", ",u.location_state,", ",u.location_country]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Created At"}),c.jsx("p",{className:"text-white",children:new Date(u.created_at).toLocaleString()})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Accepted At"}),c.jsx("p",{className:"text-white",children:u.accepted_at?new Date(u.accepted_at).toLocaleString():"N/A"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Buyer Confirmed"}),c.jsx("p",{className:"text-white",children:u.buyer_confirmed?" Yes":" No"}),u.buyer_confirmed_at&&c.jsx("p",{className:"text-gray-400 text-xs",children:new Date(u.buyer_confirmed_at).toLocaleString()})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Seller Confirmed"}),c.jsx("p",{className:"text-white",children:u.seller_confirmed?" Yes":" No"}),u.seller_confirmed_at&&c.jsx("p",{className:"text-gray-400 text-xs",children:new Date(u.seller_confirmed_at).toLocaleString()})]})]}),u.state==="RELEASED"&&c.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/20 rounded-lg p-4",children:[c.jsx("h4",{className:"text-orange-300 font-medium mb-2",children:"Financial Breakdown"}),c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[c.jsx("h5",{className:"text-white font-medium mb-2",children:"Token Distribution"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-400",children:"Total Tokens:"}),c.jsxs("span",{className:"text-white font-mono",children:[parseFloat(u.amount).toFixed(6)," TBNB"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-400",children:"Admin Wallet (1.8%):"}),c.jsxs("span",{className:"text-orange-400 font-mono",children:[(parseFloat(u.amount)*.018).toFixed(6)," TBNB"]})]}),c.jsxs("div",{className:"flex justify-between border-t border-orange-500/20 pt-2",children:[c.jsx("span",{className:"text-gray-400 font-medium",children:"Released to Seller:"}),c.jsxs("span",{className:"text-green-400 font-medium font-mono",children:[(parseFloat(u.amount)*.982).toFixed(6)," TBNB"]})]})]})]})})]}),u.tx_hash&&c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Transaction Hash"}),c.jsx("p",{className:"text-white font-mono text-sm break-all",children:u.tx_hash}),u.blockchain_trade_id&&c.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["Trade ID: ",u.blockchain_trade_id]})]}),["LOCKED","UNDER_DISPUTE"].includes(u.state)&&c.jsx("div",{className:"pt-4 border-t border-white/20",children:c.jsx("button",{onClick:()=>S(u.id),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Initiate Manual Refund"})})]})]})})]})},EIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,a]=A.useState(""),[l,d]=A.useState("all"),[u,h]=A.useState("all"),[f,p]=A.useState(null),[m,g]=A.useState(!1),w=Os();A.useEffect(()=>{b()},[]),A.useEffect(()=>{y()},[t,o,l,u]);const b=async()=>{try{const S=localStorage.getItem("adminToken");if(!S){w("/admin/login");return}const C=await fetch("/api/admin/transactions",{headers:{Authorization:`Bearer ${S}`}});if(C.ok){const N=await C.json();e(N.data)}else C.status===401?(localStorage.removeItem("adminToken"),w("/admin/login")):D.error("Failed to load transactions")}catch(S){console.error("Error fetching transactions:",S),D.error("Failed to load transactions")}finally{i(!1)}},y=()=>{let S=t;o&&(S=S.filter(C=>C.id.toLowerCase().includes(o.toLowerCase())||C.order_id.toLowerCase().includes(o.toLowerCase())||C.tx_hash.toLowerCase().includes(o.toLowerCase()))),l!=="all"&&(S=S.filter(C=>C.status===l)),u!=="all"&&(S=S.filter(C=>C.transaction_type===u)),r(S)},x=S=>{switch(S){case"PENDING":return"text-yellow-400 bg-yellow-500/10";case"COMPLETED":return"text-green-400 bg-green-500/10";case"FAILED":return"text-red-400 bg-red-500/10";case"CANCELLED":return"text-gray-400 bg-gray-500/10";default:return"text-gray-400 bg-gray-500/10"}},v=S=>{switch(S){case"PENDING":return c.jsx(Pr,{size:16});case"COMPLETED":return c.jsx(kt,{size:16});case"FAILED":return c.jsx(xr,{size:16});case"CANCELLED":return c.jsx(xr,{size:16});default:return c.jsx(Pr,{size:16})}},E=S=>{switch(S){case"DEPOSIT":return c.jsx(NB,{size:16,className:"text-green-400"});case"WITHDRAWAL":return c.jsx(XQ,{size:16,className:"text-red-400"});case"TRANSFER":return c.jsx(_o,{size:16,className:"text-blue-400"});default:return c.jsx(_o,{size:16,className:"text-gray-400"})}},R=S=>{p(S),g(!0)};return s?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading transactions..."})]})}):c.jsxs("div",{children:[c.jsx("div",{className:"flex justify-end mb-6",children:c.jsxs("button",{onClick:b,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(wa,{size:16}),c.jsx("span",{children:"Refresh"})]})}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),c.jsxs("div",{className:"relative",children:[c.jsx(Tf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c.jsx("input",{type:"text",value:o,onChange:S=>a(S.target.value),placeholder:"Search by ID, order ID, or hash...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status Filter"}),c.jsxs("select",{value:l,onChange:S=>d(S.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"all",children:"All Status"}),c.jsx("option",{value:"PENDING",children:"Pending"}),c.jsx("option",{value:"COMPLETED",children:"Completed"}),c.jsx("option",{value:"FAILED",children:"Failed"}),c.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Type Filter"}),c.jsxs("select",{value:u,onChange:S=>h(S.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"all",children:"All Types"}),c.jsx("option",{value:"DEPOSIT",children:"Deposit"}),c.jsx("option",{value:"WITHDRAWAL",children:"Withdrawal"}),c.jsx("option",{value:"TRANSFER",children:"Transfer"})]})]}),c.jsx("div",{className:"flex items-end",children:c.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",n.length," of ",t.length," transactions"]})})]})}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-white/5",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Transaction ID"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order ID"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Type"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((S,C)=>c.jsxs(ee.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:C*.05},className:"hover:bg-white/5 transition-colors",children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",S.id]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",S.order_id]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[E(S.transaction_type),c.jsx("span",{className:"text-white",children:S.transaction_type})]})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:[S.amount," ",S.token]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${x(S.status)}`,children:[v(S.status),c.jsx("span",{className:"ml-1",children:S.status})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(S.created_at).toLocaleDateString()}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsx("button",{onClick:()=>R(S),className:"text-blue-400 hover:text-blue-300 transition-colors",children:c.jsx(cg,{size:16})})})]},S.id))})]})})}),m&&f&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:c.jsxs(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Transaction Details"}),c.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-white transition-colors",children:c.jsx(xr,{size:24})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Transaction ID"}),c.jsxs("p",{className:"text-white font-mono",children:["#",f.id]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order ID"}),c.jsxs("p",{className:"text-white font-mono",children:["#",f.order_id]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Type"}),c.jsxs("div",{className:"flex items-center space-x-2",children:[E(f.transaction_type),c.jsx("span",{className:"text-white",children:f.transaction_type})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Status"}),c.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${x(f.status)}`,children:[v(f.status),c.jsx("span",{className:"ml-1",children:f.status})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Amount"}),c.jsxs("p",{className:"text-white",children:[f.amount," ",f.token]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Price (INR)"}),c.jsxs("p",{className:"text-white",children:["",f.price_inr]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Created At"}),c.jsx("p",{className:"text-white",children:new Date(f.created_at).toLocaleString()})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Updated At"}),c.jsx("p",{className:"text-white",children:new Date(f.updated_at).toLocaleString()})]})]}),f.tx_hash&&c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Transaction Hash"}),c.jsx("p",{className:"text-white font-mono text-sm break-all",children:f.tx_hash})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order State"}),c.jsx("p",{className:"text-white",children:f.order_state})]})]})]})})]})},CIe=()=>{const{address:t,isConnected:e,chainId:n,switchToNetwork:r,connectMetaMask:s,connectTrustWallet:i}=Xt(),[o,a]=A.useState([]),[l,d]=A.useState([]),[u,h]=A.useState(!0),[f,p]=A.useState(""),[m,g]=A.useState("all"),[w,b]=A.useState(null),[y,x]=A.useState(!1),[v,E]=A.useState(!1),[R,S]=A.useState({type:null,appealId:"",reason:""}),[C,N]=A.useState(!1),[T,$]=A.useState(null),[U,H]=A.useState(null),[K,I]=A.useState(!1),j=async(Y,me=3,le=1e3)=>{let tt;for(let Ve=0;Ve<me;Ve++)try{return await Promise.race([Y(),new Promise((Ue,pe)=>setTimeout(()=>pe(new Error("RPC call timeout after 10 seconds")),1e4))])}catch(Ue){if(tt=Ue,Ve<me-1){const pe=le*Math.pow(2,Ve);await new Promise(it=>setTimeout(it,pe));continue}throw Ue}throw tt},F=Os();A.useEffect(()=>{P()},[]),A.useEffect(()=>{L()},[o,f,m]);const P=async()=>{try{const Y=localStorage.getItem("adminToken");if(!Y){F("/admin/login");return}const me=await fetch("/api/admin/appeals",{headers:{Authorization:`Bearer ${Y}`}});if(me.ok){const le=await me.json();a(le.data)}else me.status===401?(localStorage.removeItem("adminToken"),F("/admin/login")):D.error("Failed to load appeals")}catch(Y){console.error("Error fetching appeals:",Y),D.error("Failed to load appeals")}finally{h(!1)}},L=()=>{let Y=o;f&&(Y=Y.filter(me=>me.id.toString().toLowerCase().includes(f.toLowerCase())||me.order_id.toString().toLowerCase().includes(f.toLowerCase())||me.appellant_address.toLowerCase().includes(f.toLowerCase())||me.description.toLowerCase().includes(f.toLowerCase()))),m!=="all"&&(Y=Y.filter(me=>me.dispute_status===m)),d(Y)},B=Y=>{switch(Y){case"PENDING":return"text-yellow-400 bg-yellow-500/10";case"UNDER_REVIEW":return"text-blue-400 bg-blue-500/10";case"RESOLVED":return"text-green-400 bg-green-500/10";case"CLOSED":return"text-gray-400 bg-gray-500/10";default:return"text-gray-400 bg-gray-500/10"}},V=Y=>{switch(Y){case"PENDING":return c.jsx(Pr,{size:16});case"UNDER_REVIEW":return c.jsx(Jd,{size:16});case"RESOLVED":return c.jsx(kt,{size:16});case"CLOSED":return c.jsx(xr,{size:16});default:return c.jsx(Pr,{size:16})}},X=async Y=>{var me;if(!window.ethereum)return console.warn("Wallet not available for status check"),null;try{I(!0);const le=new Dr(window.ethereum),tt=new rr(On,vi,le),Ve=((me=Y==null?void 0:Y.order)==null?void 0:me.blockchain_trade_id)??(Y==null?void 0:Y.blockchain_trade_id)??(Y==null?void 0:Y.order_id),Ue=Number(Ve);if(!Ue||Number.isNaN(Ue)||Ue<=0)return console.warn("Invalid trade ID for status check"),null;const pe=await j(()=>tt.trades(Ue),2,1e3),it=Number(pe.status);return H({tradeId:Ue,status:it}),it}catch(le){return console.error("Error fetching blockchain status:",le),null}finally{I(!1)}},ae=async Y=>{b(Y),x(!0),H(null),window.ethereum&&await X(Y)},ce=async()=>{try{N(!1),await i(),n!==Di&&await r(Di),D.success("Trust Wallet connected successfully!")}catch(Y){console.error("Trust Wallet connection error:",Y),D.error(Y.message||"Failed to connect Trust Wallet")}},ie=async()=>{try{N(!1),await s(),n!==Di&&await r(Di),D.success("MetaMask connected successfully!")}catch(Y){console.error("MetaMask connection error:",Y),D.error(Y.message||"Failed to connect MetaMask")}},Te=async()=>{try{N(!1);const[{createAppKit:Y},{EthersAdapter:me}]=await Promise.all([$n(()=>Promise.resolve().then(()=>iSe),void 0),$n(()=>Promise.resolve().then(()=>oSe),void 0)]),le=window.REOWN_PROJECT_ID||void 0;if(!le){D.error("Missing Reown projectId (set VITE_REOWN_PROJECT_ID)");return}const tt=new me;await Y({projectId:le,adapters:[tt],features:{analytics:!1},networks:[{id:56,name:"BSC Mainnet"}]}).open(),n!==Di&&await r(Di),D.success("Connected with Reown")}catch(Y){console.error("Reown connection error:",Y),String((Y==null?void 0:Y.message)||"").includes("@reown")?D.error("Reown packages not installed. Run: npm i @reown/appkit @reown/appkit-adapter-ethers"):D.error((Y==null?void 0:Y.message)||"Failed to connect with Reown")}},ue=async(Y,me,le)=>{var tt,Ve,Ue;try{E(!0);const pe={CREATED:0,LOCKED:1,APPEAL_WINDOW_OPEN:2,UNDER_DISPUTE:3,RELEASED:4,REFUNDED:5,COMPLETED:6};if(!e||!t){D.error("Please connect your wallet first"),E(!1);return}n!==Di&&(D.loading("Switching to BSC Mainnet...",{id:"resolve-chain"}),await r(Di),D.success("Switched to BSC Mainnet",{id:"switch-network"}));const it=o.find(ei=>String(ei.id)===String(Y));if(!it){D.error("Appeal not found"),E(!1);return}const An=((tt=it==null?void 0:it.order)==null?void 0:tt.blockchain_trade_id)??(it==null?void 0:it.blockchain_trade_id)??(it==null?void 0:it.order_id),nt=Number(An);if(!nt||Number.isNaN(nt)||nt<=0){D.error("Invalid Blockchain Trade ID"),E(!1);return}if(!window.ethereum){D.error("Wallet not available"),E(!1);return}D.loading("Connecting to contract...",{id:"resolve-chain"});const bn=new Dr(window.ethereum),Fe=await bn.getSigner(),ct=await bn.getNetwork();if(Number(ct.chainId)!==Di)throw new Error(`Wrong network! Expected BSC Mainnet (56), got chain ${ct.chainId}`);const wt=new rr(On,vi,Fe),ft=(await Fe.getAddress()).toLowerCase(),Rn=(await j(()=>wt.admin(),2,1e3)).toLowerCase();if(ft!==Rn)throw new Error("You are not the contract admin");D.loading("Checking trade status...",{id:"resolve-chain"});const ro=await j(()=>wt.trades(nt),2,1e3);let Gt=Number(ro.status);if(Gt===pe.RELEASED||Gt===pe.COMPLETED){await Q(Y,"TRANSFER_TO_BUYER",le||"Trade already released"),D.success(" Appeal marked as resolved (funds already released)",{id:"resolve-chain"}),P(),x(!1),S({type:null,appealId:"",reason:""}),E(!1);return}if(Gt===pe.REFUNDED){await Q(Y,"REFUND_TO_SELLER",le||"Trade already refunded"),D.success(" Appeal marked as resolved (funds already refunded)",{id:"resolve-chain"}),P(),x(!1),S({type:null,appealId:"",reason:""}),E(!1);return}if(Gt!==pe.UNDER_DISPUTE){if(D.loading(`Current status: ${Gt}. Moving to UNDER_DISPUTE...`,{id:"resolve-chain"}),Gt===pe.LOCKED){D.loading("Step 1/2: Opening appeal window...",{id:"resolve-chain"});try{let ei;try{ei=await wt.autoOpenAppealWindow(nt)}catch(qr){if((Ve=qr.message)!=null&&Ve.includes("autoOpenAppealWindow"))ei=await wt.openAppealWindow(nt);else throw qr}const Nu=await ei.wait();console.log(" Appeal window opened, tx:",Nu.hash);const _a=await j(()=>wt.trades(nt),3,1e3);if(Gt=Number(_a.status),Gt===pe.APPEAL_WINDOW_OPEN)D.success("Step 1/2: Appeal window opened",{id:"resolve-chain"});else if(Gt===pe.UNDER_DISPUTE)D.success("Trade is already in UNDER_DISPUTE",{id:"resolve-chain"});else throw new Error(`Unexpected status after opening appeal window: ${Gt}`)}catch(ei){const Nu=await j(()=>wt.trades(nt),2,1e3),_a=Number(Nu.status);if(_a===pe.APPEAL_WINDOW_OPEN||_a===pe.UNDER_DISPUTE)Gt=_a,console.log("Appeal window already open or in dispute, continuing...");else throw new Error(`Failed to open appeal window: ${ei.message||ei.reason||"Unknown error"}`)}}if(Gt===pe.APPEAL_WINDOW_OPEN)D.loading("Attempting admin resolution from APPEAL_WINDOW_OPEN status...",{id:"resolve-chain"}),console.log(" Trade is in APPEAL_WINDOW_OPEN. Admin will attempt direct resolution.");else if(Gt===pe.LOCKED)throw new Error(`Trade is still LOCKED. Admin cannot file appeals (only participants can). Please wait for appeal window to open automatically, or ask buyer/seller to file an appeal first. Current status: ${Gt}`)}if(Gt===pe.UNDER_DISPUTE)D.loading(" Trade is in UNDER_DISPUTE. Proceeding with resolution...",{id:"resolve-chain"});else if(Gt===pe.APPEAL_WINDOW_OPEN)D.loading(" Trade is in APPEAL_WINDOW_OPEN. Attempting admin resolution...",{id:"resolve-chain"}),console.log(" Admin attempting resolution from APPEAL_WINDOW_OPEN status (contract may or may not allow this)");else throw new Error(`Cannot resolve appeal. Trade status is ${Gt}. Admin can only resolve from UNDER_DISPUTE (3) or APPEAL_WINDOW_OPEN (2). If status is LOCKED (1), please wait for appeal window to open or ask participant to file appeal.`);D.loading("Estimating gas...",{id:"resolve-chain"});let or;try{or=await wt.adminDecision.estimateGas(nt,me),or=or*BigInt(110)/BigInt(100)}catch{or=BigInt(3e5)}D.loading(me?"Releasing funds to buyer...":"Refunding to seller...",{id:"resolve-chain"});const Ic=await bn.getFeeData(),Rc=Ic.gasPrice||Ic.maxFeePerGas||im("3","gwei"),Ml=await wt.adminDecision(nt,me,{gasLimit:or,gasPrice:Rc});D.loading("Waiting for confirmation...",{id:"resolve-chain"}),await Ml.wait();const Xs=me?" Funds released to buyer":" Funds refunded to seller";D.success(Xs,{id:"resolve-chain",duration:5e3}),await Q(Y,me?"TRANSFER_TO_BUYER":"REFUND_TO_SELLER",le),D.success(" Appeal resolved successfully"),w&&await X(w),P(),x(!1),S({type:null,appealId:"",reason:""})}catch(pe){if(console.error(" Error resolving appeal:",pe),D.dismiss("resolve-chain"),$(null),pe.code==="ACTION_REJECTED"||(Ue=pe.message)!=null&&Ue.includes("User rejected"))D.error("Transaction rejected by user");else if(pe.code==="CALL_EXCEPTION"||pe.reason){const it=pe.reason||pe.message||"Unknown contract error";it.includes("Not participant")?D.error("Admin cannot file appeals. Please ask buyer or seller to file an appeal first, or wait for the trade to be in UNDER_DISPUTE status.",{duration:8e3}):it.includes("Invalid state")||it.includes("status")?D.error(`Contract error: ${it}. The trade may need to be in UNDER_DISPUTE status. Please ask a participant to file an appeal first.`,{duration:8e3}):D.error(`Contract error: ${it}`,{duration:6e3})}else D.error(pe.message||"Failed to resolve appeal")}finally{E(!1),setTimeout(()=>{$(null)},1e4)}},Q=async(Y,me,le)=>{var pe;const tt=localStorage.getItem("adminToken"),Ve=await fetch(`/api/admin/appeals/${Y}/resolve`,{method:"POST",headers:{Authorization:`Bearer ${tt}`,"Content-Type":"application/json"},body:JSON.stringify({resolution:me,resolution_reason:le})});if(!Ve.ok){const it=await Ve.json();throw new Error(it.error||"Failed to update backend")}const Ue=await Ve.json();if(Ue.success&&((pe=Ue.data)!=null&&pe.orderId))try{console.log(" Syncing blockchain status for order:",Ue.data.orderId);const it=await fetch(`/api/admin/orders/${Ue.data.orderId}/sync-blockchain-status`,{method:"POST",headers:{Authorization:`Bearer ${tt}`,"Content-Type":"application/json"}});if(it.ok){const An=await it.json();console.log(" Blockchain status synced:",An)}else console.warn(" Failed to sync blockchain status, but resolution succeeded")}catch(it){console.warn(" Error syncing blockchain status:",it)}return Ve},xe=async(Y,me)=>{var le;if(S({type:me?"buyer":"seller",appealId:Y,reason:""}),$(null),e&&window.ethereum)try{const tt=new Dr(window.ethereum),Ve=await tt.getNetwork();if(Number(Ve.chainId)===Di){const Ue=await tt.getSigner(),pe=new rr(On,vi,Ue),it=o.find(An=>String(An.id)===String(Y));if(it){const An=((le=it==null?void 0:it.order)==null?void 0:le.blockchain_trade_id)??(it==null?void 0:it.blockchain_trade_id)??(it==null?void 0:it.order_id),nt=Number(An);if(nt&&!Number.isNaN(nt)&&nt>0)try{const Fe=await pe.adminDecision.estimateGas(nt,me)*BigInt(110)/BigInt(100),ct=await tt.getFeeData();let wt=ct.gasPrice;!wt&&ct.maxFeePerGas&&(wt=ct.maxFeePerGas),wt||(wt=im("3","gwei"));const ft=Fe*wt,Rn=gc(ft);$(Rn),console.log(" Pre-estimated gas fee:",Rn,"BNB")}catch(bn){console.warn("Could not pre-estimate gas fee:",bn),$(null)}}}}catch(tt){console.warn("Could not estimate gas fee:",tt),$(null)}},Pe=()=>{if(!R.reason.trim()){D.error("Please provide a reason for this resolution");return}ue(R.appealId,R.type==="buyer",R.reason)};return u?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading appeals..."})]})}):c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("div",{children:e?c.jsxs("div",{className:"flex items-center space-x-2 text-white",children:[c.jsx(kt,{size:16,className:"text-green-400"}),c.jsxs("span",{className:"text-sm font-mono",children:[t==null?void 0:t.slice(0,6),"...",t==null?void 0:t.slice(-4)]}),n!==Di&&c.jsx("button",{onClick:()=>r(Di),className:"text-xs bg-yellow-600 hover:bg-yellow-700 px-2 py-1 rounded",children:"Switch to BSC Mainnet"})]}):c.jsxs(ee.button,{onClick:()=>N(!0),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white px-6 py-3 rounded-lg transition-all flex items-center space-x-2 shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsx("div",{className:"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-white text-sm font-bold",children:""})}),c.jsx("span",{className:"font-medium",children:"Connect Wallet"})]})}),c.jsx("div",{className:"flex items-center space-x-2",children:c.jsxs("button",{onClick:P,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(wa,{size:16}),c.jsx("span",{children:"Refresh"})]})})]}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search"}),c.jsxs("div",{className:"relative",children:[c.jsx(Tf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c.jsx("input",{type:"text",value:f,onChange:Y=>p(Y.target.value),placeholder:"Search by appeal ID, order ID, address, or description...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status Filter"}),c.jsxs("select",{value:m,onChange:Y=>g(Y.target.value),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"all",children:"All Status"}),c.jsx("option",{value:"PENDING",children:"Pending"}),c.jsx("option",{value:"UNDER_REVIEW",children:"Under Review"}),c.jsx("option",{value:"RESOLVED",children:"Resolved"}),c.jsx("option",{value:"CLOSED",children:"Closed"})]})]}),c.jsx("div",{className:"flex items-end",children:c.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",l.length," of ",o.length," appeals"]})})]})}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[c.jsx("div",{className:"hidden md:block overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-white/5",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Appeal ID"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order ID"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Type"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Appellant"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:l.map((Y,me)=>c.jsxs(ee.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:me*.05},className:"hover:bg-white/5 transition-colors",children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",Y.id]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:["#",Y.order_id]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:Y.dispute_type}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(Y.dispute_status)}`,children:[V(Y.dispute_status),c.jsx("span",{className:"ml-1",children:Y.dispute_status})]})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-mono",children:[Y.appellant_address.slice(0,10),"..."]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(Y.created_at).toLocaleDateString()}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsx("button",{onClick:()=>ae(Y),className:"text-blue-400 hover:text-blue-300 transition-colors",children:c.jsx(cg,{size:16})})})]},Y.id))})]})}),c.jsx("div",{className:"md:hidden p-4 space-y-4",children:l.map((Y,me)=>c.jsxs(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:me*.05},className:"bg-white/5 rounded-lg p-4 border border-white/10 hover:bg-white/10 transition-colors",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Appeal ID"}),c.jsxs("div",{className:"text-white font-mono font-semibold",children:["#",Y.id]})]}),c.jsx("button",{onClick:()=>ae(Y),className:"text-blue-400 hover:text-blue-300 transition-colors p-2",children:c.jsx(cg,{size:20})})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Order ID"}),c.jsxs("div",{className:"text-white font-mono text-sm",children:["#",Y.order_id]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Type"}),c.jsx("div",{className:"text-white text-sm",children:Y.dispute_type})]})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Status"}),c.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(Y.dispute_status)}`,children:[V(Y.dispute_status),c.jsx("span",{className:"ml-1",children:Y.dispute_status})]})]}),c.jsxs("div",{className:"mb-3",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Appellant"}),c.jsx("div",{className:"text-white font-mono text-sm break-all",children:Y.appellant_address})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Created"}),c.jsx("div",{className:"text-gray-300 text-sm",children:new Date(Y.created_at).toLocaleDateString()})]})]},Y.id))})]}),y&&w&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 overflow-y-auto",onClick:Y=>{Y.target===Y.currentTarget&&x(!1)},children:c.jsx(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},onClick:Y=>Y.stopPropagation(),className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-5xl my-8",style:{maxHeight:"calc(100vh - 4rem)"},children:c.jsxs("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 8rem)"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Appeal Details"}),c.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-white transition-colors",children:c.jsx(xr,{size:24})})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Appeal Information"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appeal ID"}),c.jsxs("p",{className:"text-white font-mono",children:["#",w.id]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Dispute ID"}),c.jsxs("p",{className:"text-white font-mono",children:["#",w.dispute_id]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Dispute Type"}),c.jsx("p",{className:"text-white",children:w.dispute_type})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Status"}),c.jsx("div",{className:"mt-1",children:c.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${B(w.dispute_status)}`,children:[V(w.dispute_status),c.jsx("span",{className:"ml-1",children:w.dispute_status})]})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appellant Address"}),c.jsx("p",{className:"text-white font-mono text-sm break-all",children:w.appellant_address})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appellant Type"}),c.jsx("p",{className:"text-white",children:w.appellant_type})]}),c.jsxs("div",{className:"col-span-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Description"}),c.jsx("p",{className:"text-white bg-white/5 p-3 rounded-lg mt-1",children:w.description})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Appeal Created At"}),c.jsx("p",{className:"text-white",children:new Date(w.created_at).toLocaleString()})]})]})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Order Details"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order ID"}),c.jsxs("p",{className:"text-white font-mono",children:["#",w.order_id]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Amount"}),c.jsxs("p",{className:"text-white font-semibold",children:[w.amount," ",w.token]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Token"}),c.jsx("p",{className:"text-white",children:w.token})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Order Created At"}),c.jsx("p",{className:"text-white",children:new Date(w.order_created_at).toLocaleString()})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Lock Expires At"}),c.jsx("p",{className:"text-white",children:new Date(w.lock_expires_at).toLocaleString()})]})]})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Buyer Information"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Buyer Name"}),c.jsx("p",{className:"text-white",children:w.buyer_name||"Not Available"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Buyer Address"}),c.jsx("p",{className:"text-white font-mono text-sm break-all",children:w.buyer_address})]})]})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Seller Information"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Seller Name"}),c.jsx("p",{className:"text-white",children:w.seller_name||"Not Available"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Seller Address"}),c.jsx("p",{className:"text-white font-mono text-sm break-all",children:w.seller_address})]})]})]}),w.evidence_video_url&&c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Video Evidence"}),c.jsx("div",{className:"mt-2",children:c.jsxs("video",{controls:!0,className:"w-full rounded-lg bg-black",preload:"metadata",playsInline:!0,style:{maxHeight:"400px"},children:[c.jsx("source",{src:`/uploads/${w.evidence_video_url}`,type:"video/webm"}),c.jsx("source",{src:`/uploads/${w.evidence_video_url}`,type:"video/mp4"}),"Your browser does not support the video tag."]})})]}),(w.evidence_screenshots||w.evidence_documents)&&c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsx("h3",{className:"text-lg font-semibold text-white mb-4 pb-2 border-b border-white/10",children:" Additional Evidence"}),w.evidence_screenshots&&w.evidence_screenshots.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"text-sm font-medium text-gray-300 mb-2 block",children:"Screenshots"}),c.jsxs("div",{className:"text-gray-400 text-sm",children:[w.evidence_screenshots.length," screenshot(s) uploaded"]})]}),w.evidence_documents&&w.evidence_documents.length>0&&c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-300 mb-2 block",children:"Documents"}),c.jsxs("div",{className:"text-gray-400 text-sm",children:[w.evidence_documents.length," document(s) uploaded"]})]})]}),K&&!U&&c.jsx("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 mb-4",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-4 h-4 border-2 border-blue-300 border-t-transparent rounded-full animate-spin"}),c.jsx("p",{className:"text-blue-300 text-sm",children:"Checking blockchain status..."})]})}),U&&c.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-blue-300 mb-1 block",children:" Blockchain Status"}),c.jsxs("p",{className:"text-white font-semibold",children:[U.status===0&&"CREATED",U.status===1&&"LOCKED",U.status===2&&"APPEAL_WINDOW_OPEN",U.status===3&&"UNDER_DISPUTE ",U.status===4&&"RELEASED",U.status===5&&"REFUNDED",U.status===6&&"COMPLETED",U.status>6&&`Unknown (${U.status})`]})]}),c.jsx("button",{onClick:()=>w&&X(w),disabled:K,className:"text-blue-300 hover:text-blue-200 text-sm disabled:opacity-50 flex items-center space-x-1",children:K?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-3 h-3 border-2 border-blue-300 border-t-transparent rounded-full animate-spin"}),c.jsx("span",{children:"Checking..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Refresh"})]})})]}),c.jsxs("p",{className:"text-xs text-blue-400 mt-2",children:["Trade ID: ",U.tradeId," | Status Code: ",U.status]})]}),!K&&!U&&window.ethereum&&c.jsxs("div",{className:"bg-gray-500/20 border border-gray-500/30 rounded-lg p-3 mb-4",children:[c.jsx("p",{className:"text-gray-300 text-sm",children:" Could not fetch blockchain status. Click refresh to try again."}),c.jsx("button",{onClick:()=>w&&X(w),className:"text-blue-300 hover:text-blue-200 text-xs mt-2",children:" Retry"})]}),U&&U.status!==4&&U.status!==5&&U.status!==6||!U?c.jsxs("div",{className:"pt-4 border-t border-white/20",children:[c.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Resolve Dispute"}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 mb-4 border border-white/10",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-gray-400",children:"Amount"}),c.jsxs("p",{className:"text-white font-semibold",children:[w.amount," ",w.token]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-gray-400",children:"Trade ID"}),c.jsx("p",{className:"text-white font-mono text-sm",children:w.blockchain_trade_id||w.order_id||"N/A"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-gray-400",children:"Buyer Address"}),c.jsx("p",{className:"text-white font-mono text-xs break-all",children:w.buyer_address})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs text-gray-400",children:"Seller Address"}),c.jsx("p",{className:"text-white font-mono text-xs break-all",children:w.seller_address})]})]})]}),U&&U.status!==3&&c.jsxs("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4",children:[c.jsxs("p",{className:"text-yellow-200 text-sm",children:[" Current blockchain status: ",U.status===1?"LOCKED":U.status===2?"APPEAL_WINDOW_OPEN":`Status ${U.status}`]}),c.jsx("p",{className:"text-yellow-300 text-xs mt-1",children:U.status===1?c.jsx(c.Fragment,{children:"Admin cannot file appeals. Please wait for appeal window to open automatically, or ask buyer/seller to file an appeal first."}):U.status===2?c.jsx(c.Fragment,{children:"Admin will attempt resolution from APPEAL_WINDOW_OPEN. If this fails, a participant must file an appeal first to move to UNDER_DISPUTE."}):c.jsx(c.Fragment,{children:"Admin will attempt to resolve. If status is not UNDER_DISPUTE, a participant may need to file an appeal first."})})]}),!e&&c.jsx("div",{className:"bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 mb-4",children:c.jsx("p",{className:"text-yellow-200 text-sm",children:" Please connect your wallet to resolve disputes on-chain"})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs(ee.button,{onClick:()=>xe(w.id,!0),disabled:v||!e,className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-4 rounded-lg transition-all flex items-center justify-center space-x-3 font-medium",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsx(kt,{size:20}),c.jsxs("div",{className:"text-left",children:[c.jsx("div",{className:"font-semibold",children:"Release Full Amount"}),c.jsx("div",{className:"text-xs text-green-100",children:"Transfer to Buyer"})]})]}),c.jsxs(ee.button,{onClick:()=>xe(w.id,!1),disabled:v||!e,className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-4 rounded-lg transition-all flex items-center justify-center space-x-3 font-medium",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsx(xr,{size:20}),c.jsxs("div",{className:"text-left",children:[c.jsx("div",{className:"font-semibold",children:"Refund Full Amount"}),c.jsx("div",{className:"text-xs text-orange-100",children:"Return to Seller"})]})]})]})]}):null]})]})})}),R.type&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 overflow-y-auto",onClick:Y=>{Y.target===Y.currentTarget&&!v&&S({type:null,appealId:"",reason:""})},children:c.jsx(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},onClick:Y=>Y.stopPropagation(),className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-md my-8",style:{maxHeight:"calc(100vh - 4rem)"},children:c.jsxs("div",{className:"overflow-y-auto",style:{maxHeight:"calc(100vh - 8rem)"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-xl font-bold text-white",children:R.type==="buyer"?"Release Funds to Buyer":"Refund Funds to Seller"}),c.jsx("button",{onClick:()=>S({type:null,appealId:"",reason:""}),className:"text-gray-400 hover:text-white transition-colors",disabled:v,children:c.jsx(xr,{size:24})})]}),c.jsxs("div",{className:"space-y-4",children:[w&&c.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-gray-400",children:["Amount to ",R.type==="buyer"?"Release":"Refund"]}),c.jsxs("p",{className:"text-white font-semibold text-lg",children:[w.amount," ",w.token]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs text-gray-400",children:[R.type==="buyer"?"Buyer":"Seller"," Address"]}),c.jsx("p",{className:"text-white font-mono text-sm break-all",children:R.type==="buyer"?w.buyer_address:w.seller_address})]})]})}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Resolution Reason ",c.jsx("span",{className:"text-red-400",children:"*"})]}),c.jsx("textarea",{value:R.reason,onChange:Y=>S({...R,reason:Y.target.value}),rows:4,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the reason for this resolution...",disabled:v})]}),T&&c.jsxs("div",{className:"bg-blue-500/20 border border-blue-500/30 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-blue-300 mb-1",children:"Estimated Network Fee"}),c.jsxs("p",{className:"text-lg font-bold text-blue-100",children:[T," BNB"]})]}),c.jsx("div",{className:"text-2xl",children:""})]}),c.jsx("p",{className:"text-xs text-blue-400 mt-2",children:"This fee will be deducted from your wallet balance"})]}),c.jsxs("div",{className:`rounded-lg p-3 ${R.type==="buyer"?"bg-green-500/20 border border-green-500/30":"bg-orange-500/20 border border-orange-500/30"}`,children:[c.jsxs("p",{className:`text-sm ${R.type==="buyer"?"text-green-200":"text-orange-200"}`,children:[" This action will transfer ",c.jsxs("strong",{children:[w==null?void 0:w.amount," ",w==null?void 0:w.token]})," on-chain. This cannot be undone."]}),c.jsxs("p",{className:`text-xs mt-1 ${R.type==="buyer"?"text-green-300":"text-orange-300"}`,children:["Note: 1% seller extra (",w?(parseFloat(w.amount)*.01).toFixed(6):"0"," ",w==null?void 0:w.token,") will remain in contract due to contract limitation."]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:()=>S({type:null,appealId:"",reason:""}),disabled:v,className:"flex-1 bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50",children:"Cancel"}),c.jsx(ee.button,{onClick:Pe,disabled:v||!R.reason.trim(),className:`flex-1 px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium ${R.type==="buyer"?"bg-green-600 hover:bg-green-700 text-white":"bg-orange-600 hover:bg-orange-700 text-white"}`,whileTap:{scale:.98},children:v?"Processing...":"Confirm & Execute"})]})]})]})})}),C&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>N(!1),children:c.jsxs(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},onClick:Y=>Y.stopPropagation(),className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 max-w-md w-full",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:"Choose Wallet"}),c.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-white transition-colors",children:c.jsx(xr,{size:24})})]}),c.jsx("p",{className:"text-gray-300 mb-6 text-sm",children:"Select a wallet to connect and resolve appeals on-chain"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs(ee.button,{onClick:Te,className:"w-full bg-purple-600 hover:bg-purple-700 text-white px-6 py-4 rounded-lg transition-all flex items-center justify-between shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-purple-600 text-lg font-bold",children:"R"})}),c.jsxs("div",{className:"text-left",children:[c.jsx("div",{className:"font-semibold text-lg",children:"Reown"}),c.jsx("div",{className:"text-sm text-purple-100",children:"Connect via Reown (WalletConnect)"})]})]}),c.jsx("div",{className:"text-purple-200",children:""})]}),c.jsxs(ee.button,{onClick:ce,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-4 rounded-lg transition-all flex items-center justify-between shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-blue-600 text-lg font-bold",children:"T"})}),c.jsxs("div",{className:"text-left",children:[c.jsx("div",{className:"font-semibold text-lg",children:"Trust Wallet"}),c.jsx("div",{className:"text-sm text-blue-100",children:"Connect via Trust Wallet"})]})]}),c.jsx("div",{className:"text-blue-200",children:""})]}),c.jsxs(ee.button,{onClick:ie,className:"w-full bg-orange-600 hover:bg-orange-700 text-white px-6 py-4 rounded-lg transition-all flex items-center justify-between shadow-lg",whileTap:{scale:.98},whileHover:{scale:1.02},children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-orange-600 text-lg font-bold",children:""})}),c.jsxs("div",{className:"text-left",children:[c.jsx("div",{className:"font-semibold text-lg",children:"MetaMask"}),c.jsx("div",{className:"text-sm text-orange-100",children:"Connect via MetaMask"})]})]}),c.jsx("div",{className:"text-orange-200",children:""})]})]}),c.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:c.jsx("p",{className:"text-xs text-gray-400 text-center",children:"Make sure you have the wallet extension installed and unlocked"})})]})})]})},NIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState([]),[o,a]=A.useState(!0),[l,d]=A.useState(""),[u,h]=A.useState(!1),[f,p]=A.useState(null),[m,g]=A.useState({branch_name:"",mobile:"",address:"",location_id:"",verified:!1}),w=Os();A.useEffect(()=>{b(),y()},[]),A.useEffect(()=>{x()},[t,l]);const b=async()=>{try{const C=localStorage.getItem("adminToken");if(!C){w("/admin/login");return}const N=await fetch("/api/admin/agents",{headers:{Authorization:`Bearer ${C}`}});if(N.ok){const T=await N.json();e(T.data)}else N.status===401?(localStorage.removeItem("adminToken"),w("/admin/login")):D.error("Failed to load agents")}catch(C){console.error("Error fetching agents:",C),D.error("Failed to load agents")}finally{a(!1)}},y=async()=>{try{const C=localStorage.getItem("adminToken");if(!C)return;const N=await fetch("/api/admin/locations",{headers:{Authorization:`Bearer ${C}`}});if(N.ok){const T=await N.json();r(T.data)}}catch(C){console.error("Error fetching locations:",C)}},x=()=>{let C=t;l&&(C=C.filter(N=>N.branch_name.toLowerCase().includes(l.toLowerCase())||N.mobile.toLowerCase().includes(l.toLowerCase())||N.city.toLowerCase().includes(l.toLowerCase())||N.location_name.toLowerCase().includes(l.toLowerCase()))),i(C)},v=()=>{p(null),g({branch_name:"",mobile:"",address:"",location_id:"",verified:!1}),h(!0)},E=C=>{p(C),g({branch_name:C.branch_name,mobile:C.mobile,address:C.address,location_id:C.location_id.toString(),verified:C.verified}),h(!0)},R=async C=>{C.preventDefault();try{const N=localStorage.getItem("adminToken"),T=f?`/api/admin/agents/${f.id}`:"/api/admin/agents",U=await fetch(T,{method:f?"PUT":"POST",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"},body:JSON.stringify(m)});if(U.ok)D.success(f?"Agent updated successfully":"Agent added successfully"),b(),h(!1);else{const H=await U.json();D.error(H.error||"Failed to save agent")}}catch(N){console.error("Error saving agent:",N),D.error("Failed to save agent")}},S=async C=>{if(confirm("Are you sure you want to delete this agent?"))try{const N=localStorage.getItem("adminToken"),T=await fetch(`/api/admin/agents/${C}`,{method:"DELETE",headers:{Authorization:`Bearer ${N}`}});if(T.ok)D.success("Agent deleted successfully"),b();else{const $=await T.json();D.error($.error||"Failed to delete agent")}}catch(N){console.error("Error deleting agent:",N),D.error("Failed to delete agent")}};return o?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading agents..."})]})}):c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-end space-x-3 mb-6",children:[c.jsxs("button",{onClick:b,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(wa,{size:16}),c.jsx("span",{children:"Refresh"})]}),c.jsxs("button",{onClick:v,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(Wx,{size:16}),c.jsx("span",{children:"Add Agent"})]})]}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:c.jsxs("div",{className:"relative",children:[c.jsx(Tf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c.jsx("input",{type:"text",value:l,onChange:C=>d(C.target.value),placeholder:"Search agents by branch name, mobile, city, or location...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Agent Details"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Contact"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Location"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),c.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:s.map((C,N)=>c.jsxs(ee.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:N*.05},className:"hover:bg-white/5 transition-colors duration-200",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:c.jsx(hg,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-white",children:C.branch_name}),c.jsx("div",{className:"text-sm text-gray-400",children:C.city})]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-300",children:[c.jsx(fn,{size:14}),c.jsx("span",{children:C.mobile})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"text-sm text-gray-300",children:[c.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[c.jsx(lg,{size:14}),c.jsx("span",{className:"font-medium",children:C.location_name})]}),c.jsx("div",{className:"text-xs text-gray-400 max-w-xs truncate",title:C.address,children:C.address})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${C.verified?"bg-green-500/10 text-green-400":"bg-yellow-500/10 text-yellow-400"}`,children:C.verified?"Verified":"Pending"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-400",children:new Date(C.created_at).toLocaleDateString()}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:c.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[c.jsxs("button",{onClick:()=>E(C),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[c.jsx(wI,{size:12}),c.jsx("span",{children:"Edit"})]}),c.jsxs("button",{onClick:()=>S(C.id.toString()),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[c.jsx(kC,{size:12}),c.jsx("span",{children:"Delete"})]})]})})]},C.id))})]})}),s.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(hg,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-400 text-lg",children:"No agents found"}),c.jsx("p",{className:"text-gray-500 text-sm mt-2",children:l?"Try adjusting your search terms":"Add your first agent to get started"})]})]}),u&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:c.jsxs(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-md",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:f?"Edit Agent":"Add New Agent"}),c.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white transition-colors",children:""})]}),c.jsxs("form",{onSubmit:R,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Branch Name"}),c.jsx("input",{type:"text",value:m.branch_name,onChange:C=>g({...m,branch_name:C.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Branch name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mobile"}),c.jsx("input",{type:"tel",value:m.mobile,onChange:C=>g({...m,mobile:C.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"+91 9876543210"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location"}),c.jsxs("select",{value:m.location_id,onChange:C=>g({...m,location_id:C.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select Location"}),n.map(C=>c.jsxs("option",{value:C.id,className:"bg-gray-800",children:[C.name," - ",C.city,", ",C.state]},C.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Address"}),c.jsx("textarea",{value:m.address,onChange:C=>g({...m,address:C.target.value}),required:!0,rows:3,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Full address"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",id:"verified",checked:m.verified,onChange:C=>g({...m,verified:C.target.checked}),className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500"}),c.jsx("label",{htmlFor:"verified",className:"text-sm text-gray-300",children:"Verified"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Cancel"}),c.jsxs("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[f?"Update":"Add"," Agent"]})]})]})]})})]})},AIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,a]=A.useState(""),[l,d]=A.useState(!1),[u,h]=A.useState(null),[f,p]=A.useState({name:"",city:"",state:"",country:"",active:!0});A.useEffect(()=>{m()},[]),A.useEffect(()=>{g()},[t,o]);const m=async()=>{try{const v=localStorage.getItem("adminToken");if(!v){window.location.href="/admin/login";return}const E=await fetch("/api/admin/locations",{headers:{Authorization:`Bearer ${v}`}});if(E.ok){const R=await E.json();e(R.data)}else E.status===401?(localStorage.removeItem("adminToken"),window.location.href="/admin/login"):D.error("Failed to load locations")}catch(v){console.error("Error fetching locations:",v),D.error("Failed to load locations")}finally{i(!1)}},g=()=>{let v=t;o&&(v=v.filter(E=>E.name.toLowerCase().includes(o.toLowerCase())||E.city.toLowerCase().includes(o.toLowerCase())||E.state.toLowerCase().includes(o.toLowerCase())||E.country.toLowerCase().includes(o.toLowerCase()))),r(v)},w=()=>{h(null),p({name:"",city:"",state:"",country:"",active:!0}),d(!0)},b=v=>{h(v),p({name:v.name,city:v.city,state:v.state,country:v.country,active:v.active}),d(!0)},y=async v=>{v.preventDefault();try{const E=localStorage.getItem("adminToken"),R=u?`/api/admin/locations/${u.id}`:"/api/admin/locations",C=await fetch(R,{method:u?"PUT":"POST",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify(f)});if(C.ok)D.success(u?"Location updated successfully":"Location added successfully"),m(),d(!1);else{const N=await C.json();D.error(N.error||"Failed to save location")}}catch(E){console.error("Error saving location:",E),D.error("Failed to save location")}},x=async v=>{if(confirm("Are you sure you want to delete this location?"))try{const E=localStorage.getItem("adminToken"),R=await fetch(`/api/admin/locations/${v}`,{method:"DELETE",headers:{Authorization:`Bearer ${E}`}});if(R.ok)D.success("Location deleted successfully"),m();else{const S=await R.json();D.error(S.error||"Failed to delete location")}}catch(E){console.error("Error deleting location:",E),D.error("Failed to delete location")}};return s?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading locations..."})]})}):c.jsxs("div",{children:[c.jsx("div",{className:"flex justify-between items-center mb-6",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("button",{onClick:m,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(wa,{size:16}),c.jsx("span",{children:"Refresh"})]}),c.jsxs("button",{onClick:w,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(Wx,{size:16}),c.jsx("span",{children:"Add Location"})]})]})}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:c.jsxs("div",{className:"relative",children:[c.jsx(Tf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c.jsx("input",{type:"text",value:o,onChange:v=>a(v.target.value),placeholder:"Search locations by name, city, state, or country...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-white/5",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Location"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"City"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"State"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Country"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Agents"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Created"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((v,E)=>c.jsxs(ee.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"hover:bg-white/5 transition-colors",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center mr-3",children:c.jsx(VY,{className:"w-5 h-5 text-white"})}),c.jsx("div",{children:c.jsx("div",{className:"text-sm font-medium text-white",children:v.name})})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:v.city}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:v.state}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:v.country}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"bg-blue-500/10 text-blue-400 px-2 py-1 rounded-full text-xs",children:[v.agent_count," total"]}),c.jsxs("span",{className:"bg-green-500/10 text-green-400 px-2 py-1 rounded-full text-xs",children:[v.verified_agents," verified"]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v.active?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:v.active?"Active":"Inactive"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(v.created_at).toLocaleDateString()}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>b(v),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[c.jsx(wI,{size:12}),c.jsx("span",{children:"Edit"})]}),c.jsxs("button",{onClick:()=>x(v.id.toString()),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[c.jsx(kC,{size:12}),c.jsx("span",{children:"Delete"})]})]})})]},v.id))})]})})}),l&&c.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:c.jsxs(ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-white",children:u?"Edit Location":"Add New Location"}),c.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-white transition-colors",children:""})]}),c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name"}),c.jsx("input",{type:"text",value:f.name,onChange:v=>p({...f,name:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Location name"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"City"}),c.jsx("input",{type:"text",value:f.city,onChange:v=>p({...f,city:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"City"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"State"}),c.jsx("input",{type:"text",value:f.state,onChange:v=>p({...f,state:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"State"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Country"}),c.jsx("input",{type:"text",value:f.country,onChange:v=>p({...f,country:v.target.value}),required:!0,className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Country"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",id:"active",checked:f.active,onChange:v=>p({...f,active:v.target.checked}),className:"w-4 h-4 text-blue-600 bg-white/10 border-white/20 rounded focus:ring-blue-500"}),c.jsx("label",{htmlFor:"active",className:"text-sm text-gray-300",children:"Active"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Cancel"}),c.jsxs("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[u?"Update":"Add"," Location"]})]})]})]})})]})},SIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState(!0),[s,i]=A.useState(!1),[o,a]=A.useState(""),[l,d]=A.useState({buyEnabled:!0,sellEnabled:!0,startTime:"09:00",endTime:"18:00"}),[u,h]=A.useState(!1),f=Os();A.useEffect(()=>{g(),p()},[]);const p=async()=>{try{const y=localStorage.getItem("adminToken");if(!y)return;const x=await fetch("/api/admin/trading-hours",{headers:{Authorization:`Bearer ${y}`}});if(x.ok){const v=await x.json();v.success&&v.data&&d(v.data)}}catch(y){console.error("Error fetching trading hours:",y)}},m=async()=>{h(!0);try{const y=localStorage.getItem("adminToken");if(!y){f("/admin/login");return}const x=await fetch("/api/admin/trading-hours",{method:"PUT",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(x.ok)D.success("Trading hours updated successfully"),p();else{const v=await x.json();D.error(v.error||"Failed to update trading hours")}}catch(y){console.error("Error updating trading hours:",y),D.error("Failed to update trading hours")}finally{h(!1)}},g=async()=>{try{const y=localStorage.getItem("adminToken");if(!y){f("/admin/login");return}const x=await fetch("/api/admin/settings",{headers:{Authorization:`Bearer ${y}`}});if(x.ok){const v=await x.json(),E=Array.isArray(v.data)?v.data:Array.isArray(v)?v:[];e(E);const R=E.find(S=>S.key==="admin_fee_wallet");R&&a(R.value||"")}else x.status===401?(localStorage.removeItem("adminToken"),f("/admin/login")):D.error("Failed to load settings")}catch(y){console.error("Error fetching settings:",y),D.error("Failed to load settings")}finally{r(!1)}},w=async()=>{if(!o.trim()){D.error("Please enter a valid wallet address");return}i(!0);try{const y=localStorage.getItem("adminToken"),x=await fetch("/api/admin/set-fee-wallet",{method:"POST",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"},body:JSON.stringify({address:o})});if(x.ok)D.success("Fee wallet updated successfully"),g();else{const v=await x.json();D.error(v.error||"Failed to update fee wallet")}}catch(y){console.error("Error updating fee wallet:",y),D.error("Failed to update fee wallet")}finally{i(!1)}},b=y=>({admin_fee_wallet:"Wallet address where admin fees are collected",buyer_fee_percent:"Percentage fee charged to buyers (as decimal, e.g., 0.01 for 1%)",seller_fee_percent:"Percentage fee charged to sellers (as decimal, e.g., 0.01 for 1%)",accept_timeout_minutes:"Time in minutes for order acceptance timeout",lock_duration_hours:"Duration in hours for fund lock period"})[y]||"Application setting";return n?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading settings..."})]})}):c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:c.jsx(V2,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"App Settings"}),c.jsx("p",{className:"text-gray-400",children:"Manage application configuration"})]})]}),c.jsxs("button",{onClick:g,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(wa,{size:16}),c.jsx("span",{children:"Refresh"})]})]}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(Pr,{className:"w-6 h-6 text-yellow-400"}),c.jsx("h2",{className:"text-xl font-semibold text-white",children:"Trading Hours Configuration"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("label",{className:"text-sm font-medium text-white",children:"BUY Trading"}),c.jsx("button",{onClick:()=>d({...l,buyEnabled:!l.buyEnabled}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${l.buyEnabled?"bg-green-500":"bg-gray-600"}`,children:c.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l.buyEnabled?"translate-x-6":"translate-x-1"}`})})]}),c.jsx("p",{className:"text-xs text-gray-400",children:l.buyEnabled?"BUY trading is enabled":"BUY trading is disabled"})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("label",{className:"text-sm font-medium text-white",children:"SELL Trading"}),c.jsx("button",{onClick:()=>d({...l,sellEnabled:!l.sellEnabled}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${l.sellEnabled?"bg-green-500":"bg-gray-600"}`,children:c.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l.sellEnabled?"translate-x-6":"translate-x-1"}`})})]}),c.jsx("p",{className:"text-xs text-gray-400",children:l.sellEnabled?"SELL trading is enabled":"SELL trading is disabled"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Time (IST)"}),c.jsx("input",{type:"time",value:l.startTime,onChange:y=>d({...l,startTime:y.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-yellow-500"}),c.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Trading start time in 24-hour format"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Time (IST)"}),c.jsx("input",{type:"time",value:l.endTime,onChange:y=>d({...l,endTime:y.target.value}),className:"w-full px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-yellow-500"}),c.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Trading end time in 24-hour format"})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{onClick:m,disabled:u,className:"bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[u?c.jsx(wa,{size:16,className:"animate-spin"}):c.jsx(s3,{size:16}),c.jsx("span",{children:u?"Saving...":"Save Trading Hours"})]})}),c.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:c.jsxs("p",{className:"text-sm text-blue-300",children:[c.jsx("strong",{children:"Current Status:"})," Trading is ",l.buyEnabled&&l.sellEnabled?"enabled":"partially enabled"," from ",l.startTime," to ",l.endTime," IST"]})})]})]}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(IC,{className:"w-6 h-6 text-blue-400"}),c.jsx("h2",{className:"text-xl font-semibold text-white",children:"Fee Wallet Configuration"})]}),c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Admin Fee Wallet Address"}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("input",{type:"text",value:o,onChange:y=>a(y.target.value),placeholder:"0x...",className:"flex-1 px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsxs("button",{onClick:w,disabled:s,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[s?c.jsx(wa,{size:16,className:"animate-spin"}):c.jsx(s3,{size:16}),c.jsx("span",{children:s?"Saving...":"Save"})]})]}),c.jsx("p",{className:"text-xs text-gray-400 mt-2",children:b("admin_fee_wallet")})]})})]}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-white/10",children:c.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center space-x-2",children:[c.jsx(cf,{className:"w-6 h-6 text-green-400"}),c.jsx("span",{children:"Application Settings"})]})}),c.jsx("div",{className:"divide-y divide-white/10",children:Array.isArray(t)&&t.map((y,x)=>c.jsx(ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:x*.05},className:"px-6 py-4 hover:bg-white/5 transition-colors",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-white capitalize",children:y.key.replace(/_/g," ")}),y.key==="admin_fee_wallet"&&c.jsx("span",{className:"px-2 py-1 bg-blue-500/10 text-blue-400 text-xs rounded-full",children:"Editable"})]}),c.jsx("p",{className:"text-sm text-gray-400 mb-2",children:b(y.key)}),c.jsx("div",{className:"bg-white/5 rounded-lg p-3",children:c.jsx("code",{className:"text-sm text-gray-300 break-all",children:y.value||"Not set"})})]}),c.jsx("div",{className:"ml-4 flex items-center space-x-2",children:y.key==="admin_fee_wallet"?c.jsxs("div",{className:"flex items-center space-x-1 text-green-400",children:[c.jsx(_o,{size:14}),c.jsx("span",{className:"text-xs",children:"Fee Collection"})]}):y.key.includes("fee")?c.jsxs("div",{className:"flex items-center space-x-1 text-yellow-400",children:[c.jsx(_o,{size:14}),c.jsx("span",{className:"text-xs",children:"Fee Rate"})]}):y.key.includes("timeout")||y.key.includes("duration")?c.jsxs("div",{className:"flex items-center space-x-1 text-blue-400",children:[c.jsx(Pr,{size:14}),c.jsx("span",{className:"text-xs",children:"Timing"})]}):c.jsxs("div",{className:"flex items-center space-x-1 text-gray-400",children:[c.jsx(V2,{size:14}),c.jsx("span",{className:"text-xs",children:"Config"})]})})]})},y.key))}),t.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(qt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-400 text-lg",children:"No settings found"}),c.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Settings will appear here once they are configured"})]})]})]})},TIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState([]),[s,i]=A.useState(!0),[o,a]=A.useState(""),[l,d]=A.useState("all"),u=Os();A.useEffect(()=>{h()},[]),A.useEffect(()=>{f()},[t,o,l]);const h=async()=>{try{const y=localStorage.getItem("adminToken");if(!y){u("/admin/login");return}const x=await fetch("/api/admin/reviews",{headers:{Authorization:`Bearer ${y}`}});if(x.ok){const v=await x.json();e(v.data)}else x.status===401?(localStorage.removeItem("adminToken"),u("/admin/login")):D.error("Failed to load reviews")}catch(y){console.error("Error fetching reviews:",y),D.error("Failed to load reviews")}finally{i(!1)}},f=()=>{let y=t;l==="pending"?y=y.filter(x=>!x.is_approved):l==="approved"?y=y.filter(x=>x.is_approved):l==="hidden"&&(y=y.filter(x=>!x.is_visible)),o&&(y=y.filter(x=>{var v,E,R;return((v=x.reviewer_name)==null?void 0:v.toLowerCase().includes(o.toLowerCase()))||((E=x.reviewee_name)==null?void 0:E.toLowerCase().includes(o.toLowerCase()))||((R=x.message)==null?void 0:R.toLowerCase().includes(o.toLowerCase()))||x.reviewer_address.toLowerCase().includes(o.toLowerCase())||x.reviewee_address.toLowerCase().includes(o.toLowerCase())})),r(y)},p=async y=>{try{const x=localStorage.getItem("adminToken"),v=await fetch(`/api/admin/reviews/${y}/approve`,{method:"POST",headers:{Authorization:`Bearer ${x}`}});if(v.ok)D.success("Review approved successfully"),h();else{const E=await v.json();D.error(E.error||"Failed to approve review")}}catch(x){console.error("Error approving review:",x),D.error("Failed to approve review")}},m=async y=>{try{const x=localStorage.getItem("adminToken"),v=await fetch(`/api/admin/reviews/${y}/toggle-visibility`,{method:"POST",headers:{Authorization:`Bearer ${x}`}});if(v.ok){const E=await v.json();D.success(E.message),h()}else{const E=await v.json();D.error(E.error||"Failed to toggle visibility")}}catch(x){console.error("Error toggling visibility:",x),D.error("Failed to toggle visibility")}},g=async y=>{if(confirm("Are you sure you want to delete this review?"))try{const x=localStorage.getItem("adminToken"),v=await fetch(`/api/admin/reviews/${y}`,{method:"DELETE",headers:{Authorization:`Bearer ${x}`}});if(v.ok)D.success("Review deleted successfully"),h();else{const E=await v.json();D.error(E.error||"Failed to delete review")}}catch(x){console.error("Error deleting review:",x),D.error("Failed to delete review")}},w=y=>Array.from({length:5},(x,v)=>c.jsx(pc,{size:16,className:v<y?"text-yellow-400 fill-current":"text-gray-400"},v)),b=y=>y.is_approved?y.is_visible?c.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Approved"}):c.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 text-xs rounded-full",children:"Hidden"}):c.jsx("span",{className:"px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full",children:"Pending"});return s?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-white text-lg",children:"Loading reviews..."})]})}):c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:c.jsx(pc,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Reviews Management"}),c.jsx("p",{className:"text-gray-400",children:"Manage user reviews and ratings"})]})]}),c.jsxs("button",{onClick:h,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(wa,{size:16}),c.jsx("span",{children:"Refresh"})]})]}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"relative",children:[c.jsx(Tf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c.jsx("input",{type:"text",value:o,onChange:y=>a(y.target.value),placeholder:"Search reviews by user, message, or address...",className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(bB,{size:16,className:"text-gray-400"}),c.jsxs("select",{value:l,onChange:y=>d(y.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"all",children:"All Reviews"}),c.jsx("option",{value:"pending",children:"Pending"}),c.jsx("option",{value:"approved",children:"Approved"}),c.jsx("option",{value:"hidden",children:"Hidden"})]})]})]})}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Review Details"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Rating"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Message"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Order Info"}),c.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:n.map((y,x)=>c.jsxs(ee.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:x*.05},className:"hover:bg-white/5 transition-colors duration-200",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:c.jsx(ug,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-white",children:y.reviewer_name||"Unknown User"}),c.jsxs("div",{className:"text-xs text-gray-400",children:[" ",y.reviewee_name||"Unknown User"]}),c.jsxs("div",{className:"text-xs text-gray-500",children:[y.reviewer_address.slice(0,6),"...",y.reviewer_address.slice(-4)]})]})]})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[c.jsx("div",{className:"flex items-center space-x-1",children:w(y.rating)}),c.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[y.rating,"/5 stars"]})]}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("div",{className:"text-sm text-gray-300 max-w-xs",children:y.message||c.jsx("span",{className:"text-gray-500 italic",children:"No message"})})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"text-sm text-gray-300",children:[c.jsxs("div",{className:"font-medium",children:["Order #",y.order_id]}),c.jsxs("div",{className:"text-xs text-gray-400",children:[y.amount," ",y.token]}),c.jsx("div",{className:"text-xs text-gray-500",children:new Date(y.created_at).toLocaleDateString()})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:b(y)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:c.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[!y.is_approved&&c.jsxs("button",{onClick:()=>p(y.id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[c.jsx(yI,{size:12}),c.jsx("span",{children:"Approve"})]}),c.jsxs("button",{onClick:()=>m(y.id),className:`px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1 ${y.is_visible?"bg-orange-600 hover:bg-orange-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[y.is_visible?c.jsx(xB,{size:12}):c.jsx(cg,{size:12}),c.jsx("span",{children:y.is_visible?"Hide":"Show"})]}),c.jsxs("button",{onClick:()=>g(y.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg text-xs transition-colors flex items-center space-x-1",children:[c.jsx(kC,{size:12}),c.jsx("span",{children:"Delete"})]})]})})]},y.id))})]})}),n.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Qd,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-400 text-lg",children:"No reviews found"}),c.jsx("p",{className:"text-gray-500 text-sm mt-2",children:o||l!=="all"?"Try adjusting your search or filter criteria":"Reviews will appear here once users start leaving feedback"})]})]})]})},_Ie=()=>{const[t,e]=A.useState(null),[n,r]=A.useState(null),[s,i]=A.useState(!1),[o,a]=A.useState(!1),[l,d]=A.useState(null),[u,h]=A.useState(null),f=A.useRef(null),p=A.useRef(null);Lx.useEffect(()=>{m()},[]);const m=async()=>{try{const[y,x]=await Promise.all([fetch("/api/videos/info/demo"),fetch("/api/videos/info/appeal")]);if(y.ok){const v=await y.json();d(v.exists?v:null)}if(x.ok){const v=await x.json();h(v.exists?v:null)}}catch(y){console.error("Error fetching video info:",y)}},g=async()=>{if(!t){D.error("Please select a demo video file");return}i(!0);const y=new FormData;y.append("video",t);try{const x=TM(),v=await fetch("/api/videos/upload/demo",{method:"POST",headers:{Authorization:`Bearer ${x}`},body:y}),E=await v.json();v.ok&&E.success?(D.success("Demo video uploaded successfully!"),e(null),f.current&&(f.current.value=""),m()):D.error(E.error||"Failed to upload demo video")}catch(x){console.error("Upload error:",x),D.error(x.message||"Failed to upload demo video")}finally{i(!1)}},w=async()=>{if(!n){D.error("Please select an appeal video file");return}a(!0);const y=new FormData;y.append("video",n);try{const x=TM(),v=await fetch("/api/videos/upload/appeal",{method:"POST",headers:{Authorization:`Bearer ${x}`},body:y}),E=await v.json();v.ok&&E.success?(D.success("Appeal video uploaded successfully!"),r(null),p.current&&(p.current.value=""),m()):D.error(E.error||"Failed to upload appeal video")}catch(x){console.error("Upload error:",x),D.error(x.message||"Failed to upload appeal video")}finally{a(!1)}},b=y=>{if(y===0)return"0 Bytes";const x=1024,v=["Bytes","KB","MB","GB"],E=Math.floor(Math.log(y)/Math.log(x));return Math.round(y/Math.pow(x,E)*100)/100+" "+v[E]};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Video Management"}),c.jsx("p",{className:"text-gray-300",children:"Upload and manage demo and appeal videos"})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center",children:c.jsx(hl,{className:"w-6 h-6 text-blue-400"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Demo Video"}),c.jsx("p",{className:"text-gray-400 text-sm",children:"Upload platform demonstration video"})]})]}),l&&c.jsx("div",{className:"mb-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(kt,{className:"w-5 h-5 text-green-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-green-300 text-sm font-medium",children:"Video Available"}),c.jsxs("p",{className:"text-gray-400 text-xs",children:[l.filename,"  ",b(l.size)]})]})]}),c.jsx("a",{href:l.streamUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-blue-300 transition-colors",children:c.jsx(r3,{className:"w-4 h-4"})})]})}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Demo Video (MP4, WebM, MOV, AVI - Max 500MB)"}),c.jsx("input",{ref:f,type:"file",accept:"video/*",onChange:y=>{var v;const x=(v=y.target.files)==null?void 0:v[0];if(x){if(x.size>500*1024*1024){D.error("File size must be less than 500MB");return}e(x)}},className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-violet-500 file:text-white hover:file:bg-violet-600 cursor-pointer"}),t&&c.jsxs("div",{className:"mt-2 p-3 bg-white/5 rounded-lg flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(hl,{className:"w-4 h-4 text-violet-400"}),c.jsx("span",{className:"text-sm text-gray-300",children:t.name}),c.jsxs("span",{className:"text-xs text-gray-400",children:["(",b(t.size),")"]})]}),c.jsx("button",{onClick:()=>{e(null),f.current&&(f.current.value="")},className:"p-1 hover:bg-red-500/20 rounded text-red-400",children:c.jsx(an,{className:"w-4 h-4"})})]})]}),c.jsx("button",{onClick:g,disabled:!t||s,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:s?c.jsxs(c.Fragment,{children:[c.jsx(sr,{className:"w-5 h-5 animate-spin"}),c.jsx("span",{children:"Uploading..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(i3,{className:"w-5 h-5"}),c.jsx("span",{children:"Upload Demo Video"})]})}),c.jsx("p",{className:"mt-3 text-xs text-gray-400",children:"Note: Only one demo video can be stored at a time. Uploading a new video will replace the existing one."})]}),c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center",children:c.jsx(hl,{className:"w-6 h-6 text-purple-400"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white",children:"Appeal Video"}),c.jsx("p",{className:"text-gray-400 text-sm",children:"Upload dispute appeal guide video"})]})]}),u&&c.jsx("div",{className:"mb-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(kt,{className:"w-5 h-5 text-green-400"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-green-300 text-sm font-medium",children:"Video Available"}),c.jsxs("p",{className:"text-gray-400 text-xs",children:[u.filename,"  ",b(u.size)]})]})]}),c.jsx("a",{href:u.streamUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 bg-purple-500/20 hover:bg-purple-500/30 rounded-lg text-purple-300 transition-colors",children:c.jsx(r3,{className:"w-4 h-4"})})]})}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Appeal Video (MP4, WebM, MOV, AVI - Max 500MB)"}),c.jsx("input",{ref:p,type:"file",accept:"video/*",onChange:y=>{var v;const x=(v=y.target.files)==null?void 0:v[0];if(x){if(x.size>500*1024*1024){D.error("File size must be less than 500MB");return}r(x)}},className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-violet-500 file:text-white hover:file:bg-violet-600 cursor-pointer"}),n&&c.jsxs("div",{className:"mt-2 p-3 bg-white/5 rounded-lg flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(hl,{className:"w-4 h-4 text-violet-400"}),c.jsx("span",{className:"text-sm text-gray-300",children:n.name}),c.jsxs("span",{className:"text-xs text-gray-400",children:["(",b(n.size),")"]})]}),c.jsx("button",{onClick:()=>{r(null),p.current&&(p.current.value="")},className:"p-1 hover:bg-red-500/20 rounded text-red-400",children:c.jsx(an,{className:"w-4 h-4"})})]})]}),c.jsx("button",{onClick:w,disabled:!n||o,className:"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white py-3 px-4 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:o?c.jsxs(c.Fragment,{children:[c.jsx(sr,{className:"w-5 h-5 animate-spin"}),c.jsx("span",{children:"Uploading..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(i3,{className:"w-5 h-5"}),c.jsx("span",{children:"Upload Appeal Video"})]})}),c.jsx("p",{className:"mt-3 text-xs text-gray-400",children:"Note: Only one appeal video can be stored at a time. Uploading a new video will replace the existing one."})]})]}),c.jsxs(ee.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Streaming URLs"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Demo Video Stream URL:"}),c.jsx("code",{className:"block p-3 bg-black/30 rounded-lg text-violet-300 text-sm break-all",children:typeof window<"u"?`${window.location.origin}/api/videos/stream/demo`:"/api/videos/stream/demo"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Appeal Video Stream URL:"}),c.jsx("code",{className:"block p-3 bg-black/30 rounded-lg text-violet-300 text-sm break-all",children:typeof window<"u"?`${window.location.origin}/api/videos/stream/appeal`:"/api/videos/stream/appeal"})]})]})]})]})},kIe=()=>{const[t,e]=A.useState(null),[n,r]=A.useState(!1),[s,i]=A.useState([]),[o,a]=A.useState(null),[l,d]=A.useState(null),u=A.useRef(null);A.useEffect(()=>((()=>{console.log(" AdminSupportCalls: Connecting to socket...");const w=jo(Ca,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,timeout:2e4});return w.on("connect",()=>{console.log(" AdminSupportCalls: Connected to socket"),r(!0),w.emit("register","ADMIN_SUPPORT",!0),console.log(" AdminSupportCalls: Registered as admin for support calls")}),w.on("disconnect",()=>{console.log(" AdminSupportCalls: Disconnected from socket"),r(!1)}),w.on("connect_error",b=>{console.error(" AdminSupportCalls: Connection error:",b),r(!1)}),w.on("incoming-call",b=>{if(console.log(" AdminSupportCalls: Incoming support call:",b),!b.callerAddress){console.error(" AdminSupportCalls: Missing callerAddress in incoming call data"),D.error("Invalid call data: missing caller address");return}h(b.callerAddress).then(y=>{const x={id:b.callId||`call-${Date.now()}`,callerAddress:b.callerAddress,callerName:y,timestamp:b.timestamp||Date.now(),status:"incoming"};i(v=>[...v,x]),d({...b,callerAddress:b.callerAddress,callerName:y,isAdminSupportCall:!0}),D(" New support call incoming!",{duration:5e3,position:"top-center"})})}),w.on("call-ended",b=>{console.log(" AdminSupportCalls: Call ended:",b),a(null),i(y=>y.map(x=>x.id===b.callId?{...x,status:"ended"}:x)),D("Call ended",{icon:""})}),w.on("offer",async b=>{console.log(" AdminSupportCalls: Received offer:",b),b.isAdminSupportCall&&o&&(console.log(" AdminSupportCalls: Offer received for active call - will be handled by CallModal"),l&&d(y=>({...y,offer:b.offer})))}),w.on("answer",async b=>{console.log(" AdminSupportCalls: Received answer:",b)}),w.on("ice-candidate",async b=>{console.log(" AdminSupportCalls: Received ICE candidate")}),e(w),u.current=w,()=>{w.disconnect()}})(),()=>{u.current&&u.current.disconnect()}),[]);const h=async g=>{try{const w=await fetch(`/api/auth/user-by-address?address=${g}`);if(w.ok){const b=await w.json();if(b.success&&b.data.name)return b.data.name}}catch(w){console.error("Error fetching caller info:",w)}},f=async()=>{if(l){if(!l.callerAddress){console.error(" AdminSupportCalls: Cannot accept call - missing callerAddress"),D.error("Invalid call data"),d(null);return}try{console.log(" AdminSupportCalls: Accepting call from",l.callerAddress),t&&(t.emit("call-accepted",{callId:l.callId,callerAddress:l.callerAddress}),console.log(" AdminSupportCalls: Call acceptance event sent to backend")),a({id:l.callId||`call-${Date.now()}`,callerAddress:l.callerAddress,callerName:l.callerName,timestamp:l.timestamp||Date.now(),status:"active"}),i(g=>g.map(w=>w.id===l.callId?{...w,status:"active"}:w)),d(null),D.success("Call accepted! Connecting...")}catch(g){console.error("Error accepting call:",g),D.error("Failed to accept call")}}},p=async()=>{if(l)try{t&&t.emit("call-rejected",{callId:l.callId,receiverAddress:"ADMIN_SUPPORT",callerAddress:l.callerAddress}),i(g=>g.map(w=>w.id===l.callId?{...w,status:"ended"}:w)),d(null),D("Call rejected",{icon:""})}catch(g){console.error("Error rejecting call:",g)}},m=()=>{o&&t&&t.emit("end-call",{callId:o.id,to:o.callerAddress}),a(null),D("Call ended",{icon:""})};return c.jsxs("div",{children:[c.jsx("div",{className:"mb-6",children:c.jsxs(ee.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`p-4 rounded-lg border flex items-center justify-between ${n?"bg-green-500/20 border-green-500/30":"bg-red-500/20 border-red-500/30"}`,children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${n?"bg-green-400":"bg-red-400"}`}),c.jsxs("div",{children:[c.jsxs("p",{className:`font-medium text-sm ${n?"text-green-300":"text-red-300"}`,children:["Support Call Service: ",n?"Online":"Offline"]}),c.jsx("p",{className:`text-xs ${n?"text-green-400":"text-red-400"}`,children:n?"Ready to receive support calls":"Not connected to call service"})]})]}),!n&&c.jsx(sr,{className:"w-4 h-4 animate-spin text-red-400"})]})}),c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx(fn,{size:24,className:"text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Support Calls"}),c.jsx("p",{className:"text-gray-300 text-sm mb-3",children:"Users can call you for support through the Dashboard. Incoming calls will appear here."}),c.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-400",children:[c.jsx(kt,{size:14,className:"text-green-400"}),c.jsx("span",{children:"Make sure to keep this page open to receive calls"})]})]})]})}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[c.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Recent Support Calls"}),s.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(fn,{size:48,className:"text-gray-500 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-400",children:"No support calls yet"}),c.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Waiting for incoming support calls..."})]}):c.jsx("div",{className:"space-y-3",children:s.map(g=>c.jsx(ee.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`p-4 rounded-lg border ${g.status==="active"?"bg-green-500/20 border-green-500/30":g.status==="incoming"?"bg-blue-500/20 border-blue-500/30":"bg-gray-500/20 border-gray-500/30"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[c.jsx(fn,{size:16,className:g.status==="active"?"text-green-400":g.status==="incoming"?"text-blue-400":"text-gray-400"}),c.jsx("p",{className:"font-medium text-white",children:g.callerName||"Unknown User"})]}),c.jsx("p",{className:"text-xs text-gray-400 font-mono",children:g.callerAddress?`${g.callerAddress.slice(0,6)}...${g.callerAddress.slice(-4)}`:"Unknown Address"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(g.timestamp).toLocaleString()})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[g.status==="active"&&c.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full",children:"Active"}),g.status==="incoming"&&c.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full animate-pulse",children:"Incoming"}),g.status==="ended"&&c.jsx("span",{className:"px-2 py-1 bg-gray-500/20 text-gray-400 text-xs rounded-full",children:"Ended"})]})]})},g.id))})]}),l&&c.jsx(wj,{isOpen:!!l,callerAddress:l.callerAddress,callerName:l.callerName,callId:l.callId,onAccept:f,onReject:p,onClose:()=>d(null)}),o&&c.jsx(CN,{isOpen:!!o,ad:null,onClose:m})]})},IIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState(null),[s,i]=A.useState([]),[o,a]=A.useState(""),[l,d]=A.useState(!0),[u,h]=A.useState(!1),[f,p]=A.useState(""),[m,g]=A.useState(0),w=A.useRef(null),b=A.useRef(null),y=A.useRef(null),x=()=>{var N;(N=w.current)==null||N.scrollIntoView({behavior:"smooth"})};A.useEffect(()=>{x()},[s]);const v=async()=>{try{const N=localStorage.getItem("adminToken")||"",T=await fetch("/api/admin/chat/users",{headers:{Authorization:`Bearer ${N}`}});if(T.ok){const U=(await T.json()).data||[];e(U);const H=U.reduce((K,I)=>K+(I.unread_from_user||0),0);g(H)}}catch(N){console.error("Error fetching users:",N)}finally{d(!1)}},E=async N=>{try{const T=localStorage.getItem("adminToken")||"",$=await fetch(`/api/admin/chat/messages/${N}`,{headers:{Authorization:`Bearer ${T}`}});if($.ok){const U=await $.json();i(U.data||[]),x()}}catch(T){console.error("Error fetching messages:",T)}};A.useEffect(()=>{try{const N=localStorage.getItem("adminToken")||"";if(N){const $=N.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),U=decodeURIComponent(atob($).split("").map(K=>"%"+("00"+K.charCodeAt(0).toString(16)).slice(-2)).join("")),H=JSON.parse(U);y.current=H.adminId||H.id||1,console.log(" AdminChat: Admin ID from token:",y.current)}}catch(N){console.error("Error decoding admin token:",N),y.current=1}},[]),A.useEffect(()=>{const N=jo(Ca,{transports:["websocket","polling"],reconnection:!0});return N.on("connect",()=>{console.log(" AdminChat: Connected to socket")}),N.on("new-chat-message",T=>{console.log(" AdminChat: New message from user:",T),n===T.userAddress&&(i(H=>H.some(I=>I.id===T.message.id)?(console.log(" AdminChat: Message already exists, skipping duplicate"),H):[...H,T.message]),x()),e(H=>{const K=H.map(j=>j.user_address===T.userAddress?{...j,unread_from_user:(j.unread_from_user||0)+1,last_message:T.message.message,last_message_at:T.message.created_at}:j),I=K.reduce((j,F)=>j+(F.unread_from_user||0),0);return g(I),K});const $=t.find(H=>H.user_address===T.userAddress),U=($==null?void 0:$.user_name)||T.userAddress.slice(0,6)+"..."+T.userAddress.slice(-4);if(n!==T.userAddress){D(H=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-semibold text-white",children:" New Message"}),c.jsxs("p",{className:"text-sm text-gray-200",children:["From: ",c.jsx("span",{className:"font-medium",children:U})]}),c.jsx("p",{className:"text-xs text-gray-300 mt-1 truncate max-w-xs",children:T.message.message.length>50?T.message.message.substring(0,50)+"...":T.message.message})]}),c.jsx("button",{onClick:()=>{r(T.userAddress),D.dismiss(H.id)},className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition-colors",children:"View"})]}),{duration:5e3,icon:"",position:"top-right",style:{background:"#1e293b",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.1)",minWidth:"300px"}});try{const H=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2LwUZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2LwUZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2LwU=");H.volume=.3,H.play().catch(()=>{})}catch{}}}),N.on("admin-chat-message-sent",T=>{console.log(" AdminChat: Admin message sent confirmation:",T),n===T.message.user_address.toLowerCase()&&(i($=>$.some(H=>H.id===T.message.id)?(console.log(" AdminChat: Message already exists, skipping duplicate"),$):[...$,T.message]),x(),e($=>{const U=$.map(K=>K.user_address===n?{...K,last_message:T.message.message,last_message_at:T.message.created_at}:K),H=U.reduce((K,I)=>K+(I.unread_from_user||0),0);return g(H),U}))}),N.on("chat-error",T=>{console.error(" AdminChat error:",T),D.error(T.error||"Chat error occurred")}),b.current=N,()=>{N.disconnect()}},[n]),A.useEffect(()=>{v()},[]),A.useEffect(()=>{n&&b.current&&(E(n),b.current.emit("admin-join-chat",n),console.log(" AdminChat: Joined chat room for user:",n))},[n]);const R=async()=>{if(!o.trim()||!n||u)return;if(!y.current){D.error("Admin ID not found. Please refresh the page.");return}h(!0);const N=o.trim();a("");try{if(b.current&&b.current.connected)b.current.emit("admin-chat-message",{message:N,userAddress:n,adminId:y.current});else{const T=localStorage.getItem("adminToken")||"",$=await fetch("/api/admin/chat/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${T}`},body:JSON.stringify({user_address:n,message:N})});if(!$.ok){const U=await $.json();D.error(U.error||"Failed to send message"),a(N)}}}catch(T){console.error("Error sending message:",T),D.error("Failed to send message"),a(N)}finally{h(!1)}};A.useEffect(()=>{if(n){const N=localStorage.getItem("adminToken")||"";fetch(`/api/admin/chat/mark-read/${n}`,{method:"POST",headers:{Authorization:`Bearer ${N}`}}).catch(T=>console.error("Error marking as read:",T)),e(T=>T.map($=>$.user_address===n?{...$,unread_from_user:0}:$))}},[n,s]);const S=t.filter(N=>{var T;return((T=N.user_name)==null?void 0:T.toLowerCase().includes(f.toLowerCase()))||N.user_address.toLowerCase().includes(f.toLowerCase())}),C=t.find(N=>N.user_address===n);return c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-2xl font-bold text-white mb-2 flex items-center space-x-2",children:[c.jsx(Qd,{className:"w-6 h-6"}),c.jsx("span",{children:"Chat Support"}),m>0&&c.jsxs("span",{className:"bg-red-500 text-white text-xs font-bold px-2.5 py-1 rounded-full animate-pulse",children:[m," new"]})]}),c.jsx("p",{className:"text-gray-300 text-sm",children:"Manage user support chats in real-time"})]}),m>0&&c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-3xl font-bold text-red-400",children:m}),c.jsx("p",{className:"text-xs text-gray-400",children:"Unread Messages"})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-[calc(100vh-250px)]",children:[c.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 flex flex-col",children:[c.jsx("div",{className:"p-4 border-b border-white/20",children:c.jsxs("div",{className:"relative",children:[c.jsx(Tf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),c.jsx("input",{type:"text",placeholder:"Search users...",value:f,onChange:N=>p(N.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:l?c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsx(sr,{className:"w-6 h-6 animate-spin text-white"})}):S.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-400",children:[c.jsx(Qd,{size:32,className:"mx-auto mb-2"}),c.jsx("p",{children:"No users found"})]}):S.map(N=>c.jsxs(ee.button,{onClick:()=>r(N.user_address),className:`w-full p-4 text-left border-b border-white/10 hover:bg-white/10 transition-colors ${n===N.user_address?"bg-white/20":""}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[c.jsx("div",{className:"flex items-center justify-between mb-1",children:c.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx(ug,{size:18,className:"text-white"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("p",{className:"text-white font-medium text-sm truncate",children:N.user_name||"Anonymous User"}),N.unread_from_user>0&&c.jsxs("span",{className:"bg-green-500 text-white text-xs font-bold px-2 py-0.5 rounded-full whitespace-nowrap flex-shrink-0",children:[N.unread_from_user," ",N.unread_from_user===1?"new message":"new messages"]})]}),c.jsxs("p",{className:"text-gray-400 text-xs font-mono truncate",children:[N.user_address.slice(0,6),"...",N.user_address.slice(-4)]})]})]})}),N.last_message&&c.jsx("p",{className:"text-gray-400 text-xs truncate mt-1",children:N.last_message})]},N.user_address))})]}),c.jsx("div",{className:"lg:col-span-2 bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 flex flex-col",children:n?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-4 rounded-t-xl",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:c.jsx(ug,{size:20})}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:(C==null?void 0:C.user_name)||"Anonymous User"}),c.jsxs("p",{className:"text-xs text-blue-100 font-mono",children:[n.slice(0,6),"...",n.slice(-4)]})]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 max-h-[300px]",children:[s.map(N=>{const T=N.sender_type==="admin";return c.jsx(ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${T?"justify-end":"justify-start"}`,children:c.jsxs("div",{className:`max-w-[75%] rounded-lg p-3 ${T?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"}`,children:[!T&&c.jsx("p",{className:"text-xs font-semibold mb-1 text-gray-600",children:N.user_name||"User"}),c.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:N.message}),c.jsx("p",{className:`text-xs mt-1 ${T?"text-blue-100":"text-gray-500"}`,children:new Date(N.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})},N.id)}),c.jsx("div",{ref:w})]}),c.jsx("div",{className:"p-4 border-t border-white/20 bg-white/5",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:o,onChange:N=>a(N.target.value),onKeyPress:N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),R())},placeholder:"Type your message...",className:"flex-1 px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:u}),c.jsx("button",{onClick:R,disabled:!o.trim()||u,className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?c.jsx(sr,{className:"w-5 h-5 animate-spin"}):c.jsx(EB,{size:20})})]})})]}):c.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Qd,{size:48,className:"mx-auto mb-4"}),c.jsx("p",{children:"Select a user to start chatting"})]})})})]})]})},RIe=()=>{const[t,e]=A.useState([]),[n,r]=A.useState(""),[s,i]=A.useState(!0),[o,a]=A.useState(!1),[l,d]=A.useState(0),u=A.useRef(null),h=A.useRef(null),{address:f,isConnected:p}=Xt(),{user:m}=ss(),g=Os(),w=()=>{var v;(v=u.current)==null||v.scrollIntoView({behavior:"smooth"})};A.useEffect(()=>{w()},[t]);const b=async()=>{if(!(!p||!f))try{const v=localStorage.getItem("authToken")||"",E=await fetch("/api/chat/messages",{headers:{Authorization:`Bearer ${v}`}});if(E.ok){const R=await E.json();e(R.data||[])}}catch(v){console.error("Error fetching messages:",v)}finally{i(!1)}},y=async()=>{if(!(!p||!f))try{const v=localStorage.getItem("authToken")||"",E=await fetch("/api/chat/unread-count",{headers:{Authorization:`Bearer ${v}`}});if(E.ok){const R=await E.json();d(R.data.unread_count||0)}}catch(v){console.error("Error fetching unread count:",v)}};A.useEffect(()=>{if(!p||!f){g("/");return}b(),y();const v=jo(Ca,{transports:["websocket","polling"],reconnection:!0});return v.on("connect",()=>{console.log(" Chat: Connected to socket"),v.emit("join-chat",f.toLowerCase())}),v.on("new-chat-message",E=>{console.log(" Chat: New message received:",E),e(R=>R.some(C=>C.id===E.message.id)?(console.log(" Chat: Message already exists, skipping duplicate"),R):[...R,E.message]),E.message.sender_type==="admin"&&d(R=>R+1),w()}),v.on("chat-message-sent",E=>{console.log(" Chat: Message sent confirmation:",E),e(R=>R.some(C=>C.id===E.message.id)?(console.log(" Chat: Message already exists, skipping duplicate"),R):[...R,E.message]),w()}),v.on("chat-error",E=>{console.error(" Chat error:",E),D.error(E.error||"Chat error occurred")}),h.current=v,()=>{v.disconnect()}},[p,f,g]);const x=async()=>{if(!n.trim()||!p||!f||o)return;a(!0);const v=n.trim();r("");try{if(h.current&&h.current.connected)h.current.emit("chat-message",{message:v,userAddress:f.toLowerCase()});else{const E=localStorage.getItem("authToken")||"",R=await fetch("/api/chat/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`},body:JSON.stringify({message:v})});if(!R.ok){const S=await R.json();D.error(S.error||"Failed to send message"),r(v)}}}catch(E){console.error("Error sending message:",E),D.error("Failed to send message"),r(v)}finally{a(!1)}};return A.useEffect(()=>{if(t.length>0&&p&&f){const v=localStorage.getItem("authToken")||"";fetch("/api/chat/mark-read",{method:"POST",headers:{Authorization:`Bearer ${v}`}}).catch(E=>console.error("Error marking as read:",E)),d(0)}},[t,p,f]),!p||!f?c.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-white text-lg mb-4",children:"Please connect your wallet to use chat support"}),c.jsx("button",{onClick:()=>g("/"),className:"bg-violet-600 hover:bg-violet-700 text-white px-6 py-2 rounded-lg",children:"Go to Dashboard"})]})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-4",children:c.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-xl shadow-2xl flex flex-col h-[calc(100vh-2rem)]",children:[c.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-4 rounded-t-xl flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("button",{onClick:()=>g("/"),className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:c.jsx(BY,{size:20})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-lg font-bold",children:"Chat Support"}),c.jsxs("p",{className:"text-xs text-blue-100",children:[(m==null?void 0:m.name)||"User","  ",f.slice(0,6),"...",f.slice(-4)]})]})]}),l>0&&c.jsxs("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:[l," new"]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:[s?c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsx(sr,{className:"w-6 h-6 animate-spin text-blue-600"})}):t.length===0?c.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[c.jsx(Qd,{size:48,className:"mb-4"}),c.jsx("p",{className:"text-center",children:"No messages yet. Start a conversation!"})]}):t.map(v=>{const E=v.sender_type==="user";return c.jsx(ee.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${E?"justify-end":"justify-start"}`,children:c.jsxs("div",{className:`max-w-[75%] rounded-lg p-3 ${E?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"}`,children:[!E&&c.jsx("p",{className:"text-xs font-semibold mb-1 text-gray-600",children:v.admin_username||"Admin"}),c.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:v.message}),c.jsx("p",{className:`text-xs mt-1 ${E?"text-blue-100":"text-gray-500"}`,children:new Date(v.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})},v.id)}),c.jsx("div",{ref:u})]}),c.jsx("div",{className:"p-4 border-t border-gray-200 bg-white rounded-b-xl",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:n,onChange:v=>r(v.target.value),onKeyPress:v=>{v.key==="Enter"&&!v.shiftKey&&(v.preventDefault(),x())},placeholder:"Type your message...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:o}),c.jsx("button",{onClick:x,disabled:!n.trim()||o,className:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?c.jsx(sr,{className:"w-5 h-5 animate-spin"}):c.jsx(EB,{size:20})})]})})]})})},jIe=async()=>{console.log(" ===== SMART CONTRACT DEBUGGER ====="),console.log(` Starting comprehensive contract check...
`);try{if(!window.ethereum)return console.error(" Wallet not detected"),console.log(" Please install MetaMask or connect a wallet"),!1;console.log(" Wallet detected");const t=new Dr(window.ethereum),e=await t.getNetwork();console.log(` Network connected: ${e.name} (ChainID: ${e.chainId})`),e.chainId!==56n?(console.warn("  Not on BSC Mainnet! Current chain:",e.chainId),console.log(" Please switch to BSC Mainnet (ChainID: 56)")):console.log(" Connected to BSC Mainnet"),console.log(` Contract Address: ${On}`),On==="0x02ADD84281025BeeB807f5b94Ea947599146ca00"&&console.log(" Using provided contract address"),console.log(` ABI Functions: ${vi.length} functions/events`),console.log(" Available functions:"),vi.forEach((s,i)=>{var o;s.type==="function"&&console.log(`   ${i+1}. ${s.name}(${((o=s.inputs)==null?void 0:o.map(a=>a.type).join(", "))||""})`)}),console.log(`
 Testing contract connection...`);const n=new Eg(Cw),r=new rr(On,vi,n);try{console.log(" Testing contract calls...");try{const s=await r.admin();console.log(` Admin address: ${s}`)}catch(s){console.warn("  Could not fetch admin address:",s)}try{const s=await r.tradeCounter();console.log(` Trade counter: ${s.toString()}`)}catch(s){console.warn("  Could not fetch trade counter:",s)}try{const s=await r.allowedTokens(hh.USDT.address);console.log(` USDT allowed: ${s}`)}catch(s){console.warn("  Could not check USDT allowance:",s)}}catch(s){return console.error(" Contract connection failed:",s),console.log(" Check if contract is deployed and address is correct"),!1}console.log(`
 Checking token addresses...`),Object.entries(hh).forEach(([s,i])=>{console.log(` ${s}: ${i.address}`),i.isNative?console.log(`    ${s} is native token`):console.log(`    ${s} is ERC20 token`)}),console.log(`
 Testing wallet connection...`);try{const i=await(await t.getSigner()).getAddress();console.log(` Wallet address: ${i}`);const o=await t.getBalance(i),a=gc(o);console.log(` BNB balance: ${a} BNB`),parseFloat(a)<.01&&console.warn("  Low BNB balance! Please add more BNB to your wallet")}catch(s){return console.error(" Wallet connection failed:",s),!1}console.log(`
  Testing contract write functions...`);try{const s=await t.getSigner(),i=new rr(On,vi,s);console.log(" Testing createTrade function..."),console.log("    createTrade function available"),console.log("    lockFunds function available"),console.log("    releaseFunds function available"),console.log("    cancelTrade function available")}catch(s){console.error(" Contract write functions test failed:",s)}return console.log(`
 ===== DEBUG SUMMARY =====`),console.log(" Wallet: Connected"),console.log(" Network: BSC Mainnet"),console.log(" Contract: Address configured"),console.log(" ABI: Functions loaded"),console.log(" Tokens: Addresses configured"),console.log(" Connection: Ready for production"),console.log(`
 Ready to use your Zotrust P2P platform!`),console.log(" Next steps:"),console.log("   1. Create an ad"),console.log("   2. Place an order"),console.log("   3. Complete the trade flow"),!0}catch(t){return console.error(" Debug failed:",t),console.log(" Check your wallet connection and network settings"),!1}},PIe=async()=>{console.log(" Quick Contract Check...");try{if(!window.ethereum)return console.error(" No wallet detected"),!1;const e=await new Dr(window.ethereum).getNetwork();return console.log(` Network: ${e.name} (${e.chainId})`),console.log(` Contract: ${On}`),console.log(` ABI Functions: ${vi.length}`),e.chainId===56n?(console.log(" Ready for BSC Mainnet"),!0):(console.log("  Switch to BSC Mainnet (ChainID: 56)"),!1)}catch(t){return console.error(" Quick check failed:",t),!1}},qS=async(t,...e)=>{console.log(` Testing function: ${t}`);try{const r=await new Dr(window.ethereum).getSigner(),i=await new rr(On,vi,r)[t](...e);return console.log(` ${t} result:`,i),i}catch(n){throw console.error(` ${t} failed:`,n),n}},OIe=async()=>{console.log(" ===== CONTRACT VERIFICATION ====="),console.log(` Contract Address: ${On}`);try{if(!window.ethereum)throw new Error("Wallet not connected");const t=new Dr(window.ethereum);console.log(" Checking contract code...");const e=await t.getCode(On);if(e==="0x")return console.error(" No contract code found at this address!"),console.log(" The contract may not be deployed or the address is wrong"),!1;console.log(" Contract code found"),console.log(` Code length: ${e.length} characters`),console.log(" Testing basic contract interaction...");const n=["function admin() view returns (address)","function tradeCounter() view returns (uint256)"],r=new rr(On,n,t);try{const s=await r.admin();console.log(` Admin address: ${s}`)}catch(s){console.warn(" Admin function failed:",s)}try{const s=await r.tradeCounter();console.log(` Trade counter: ${s.toString()}`)}catch(s){console.warn(" Trade counter function failed:",s),console.log(" This suggests the contract ABI may not match the deployed contract")}console.log(" Checking for proxy patterns...");try{const s=await t.getStorage(On,"0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc");s!=="0x0000000000000000000000000000000000000000000000000000000000000000"&&(console.log(" Possible proxy contract detected"),console.log(` Implementation: ${s}`))}catch{}return console.log(" Contract verification complete"),!0}catch(t){return console.error(" Contract verification failed:",t),!1}};typeof window<"u"&&(window.debugContract=jIe,window.quickCheck=PIe,window.testAdmin=()=>qS("admin"),window.testTradeCounter=()=>qS("tradeCounter"),window.testAllowedTokens=t=>qS("allowedTokens",t),window.verifyContract=OIe,window.switchToMainnet=async()=>{const{useZotrustContract:t}=await $n(async()=>{const{useZotrustContract:n}=await import("./useZotrustContract-FzVr7EBY.js");return{useZotrustContract:n}},[]),{switchToMainnet:e}=t();return e()},console.log(" Contract Debugger loaded!"),console.log(" Available commands:"),console.log("   window.debugContract() - Full contract debug"),console.log("   window.quickCheck() - Quick status check"),console.log("   window.verifyContract() - Verify contract deployment"),console.log("   window.testAdmin() - Test admin function"),console.log("   window.testTradeCounter() - Test trade counter"),console.log('   window.testAllowedTokens("0x...") - Test token allowance'),console.log("   window.switchToMainnet() - Switch wallet to BSC Mainnet"));const DIe=()=>c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:c.jsx(eIe,{children:c.jsx(mI,{})})}),MIe=()=>c.jsx(rIe,{children:c.jsx(mI,{})}),UIe=()=>c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:c.jsx(mI,{})}),LIe=SG([{path:"/",element:c.jsx(DIe,{}),children:[{index:!0,element:c.jsx(oIe,{})},{path:"p2p",element:c.jsx(lIe,{})},{path:"orders",element:c.jsx(hIe,{})},{path:"transactions",element:c.jsx(pIe,{})},{path:"profile",element:c.jsx(fIe,{})},{path:"guide",element:c.jsx(kM,{})},{path:"how-to-use",element:c.jsx(kM,{})},{path:"benefits",element:c.jsx(mIe,{})},{path:"chat",element:c.jsx(RIe,{})}]},{path:"/",element:c.jsx(UIe,{}),children:[{path:"orders/appeal/:walletAddress/:orderId",element:c.jsx(Iv,{})},{path:"orders/:orderId/appeal",element:c.jsx(Iv,{})},{path:"appeal/:walletAddress/:orderId",element:c.jsx(Iv,{})},{path:"orders/orders/appeal/:walletAddress/:orderId",element:c.jsx(Iv,{})}]},{path:"support-call/:walletAddress",element:c.jsx(IM,{})},{path:"support-call",element:c.jsx(IM,{})},{path:"call/:orderId/:walletAddress",element:c.jsx(wIe,{})},{path:"/admin",children:[{path:"login",element:c.jsx(xIe,{})},{element:c.jsx(MIe,{}),children:[{index:!0,element:c.jsx(bIe,{})},{path:"orders",element:c.jsx(vIe,{})},{path:"transactions",element:c.jsx(EIe,{})},{path:"disputes",element:c.jsx(CIe,{})},{path:"support-calls",element:c.jsx(kIe,{})},{path:"agents",element:c.jsx(NIe,{})},{path:"locations",element:c.jsx(AIe,{})},{path:"reviews",element:c.jsx(TIe,{})},{path:"videos",element:c.jsx(_Ie,{})},{path:"settings",element:c.jsx(SIe,{})},{path:"chat",element:c.jsx(IIe,{})}]}]},{path:"*",element:c.jsx(wG,{to:"/",replace:!0})}]);function BIe(){return c.jsxs(Zke,{children:[c.jsx(DG,{router:LIe}),c.jsx(_Y,{position:"top-center",toastOptions:{duration:3e3,style:{background:"#1e293b",color:"#fff",border:"1px solid rgba(255, 255, 255, 0.1)"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})}const $Ie="/assets/logo-BZD251q-.jpeg",FIe=({className:t=""})=>c.jsx("img",{src:$Ie,alt:"Zotrust Logo",className:`mx-auto w-32 h-32 object-contain ${t}`}),zIe=({onComplete:t})=>{const[e,n]=A.useState(!0);return A.useEffect(()=>{const r=setTimeout(()=>{n(!1),setTimeout(()=>{t()},300)},2e3);return()=>clearTimeout(r)},[t]),e?c.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 transition-opacity duration-300 ${e?"opacity-100":"opacity-0"}`,children:c.jsx("div",{className:"flex flex-col items-center space-y-6 animate-pulse",children:c.jsx(FIe,{})})}):null};window.addEventListener("error",t=>{if(t.error&&t.error.message&&(t.error.message.includes("IndexedDB")||t.error.message.includes("backing store"))){console.warn("IndexedDB error ignored:",t.error.message),t.preventDefault();return}if(t.error&&t.error.message&&t.error.message.includes("Unexpected end of attribute")){console.warn("SVG attribute error ignored:",t.error.message),t.preventDefault();return}});window.addEventListener("unhandledrejection",t=>{if(t.reason&&t.reason.message&&(t.reason.message.includes("IndexedDB")||t.reason.message.includes("backing store"))){console.warn("IndexedDB promise rejection ignored:",t.reason.message),t.preventDefault();return}if(t.reason&&t.reason.message&&t.reason.message.includes("Unexpected end of attribute")){console.warn("SVG attribute promise rejection ignored:",t.reason.message),t.preventDefault();return}});"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(e=>{e.unregister(),console.log("Service worker unregistered")})});function HIe(){const[t,e]=A.useState(!0),n=()=>{e(!1)};return t?c.jsx(zIe,{onComplete:n}):c.jsx(BIe,{})}KL(document.getElementById("root")).render(c.jsx(HIe,{}));export{vAe as $,Aje as A,Di as B,rr as C,Sje as D,Lt as E,x1 as F,bje as G,GAe as H,wd as I,Eg as J,Bo as K,Oe as L,ne as M,Bre as N,fe as O,Ws as P,iie as Q,ut as R,cc as S,hh as T,Ts as U,GI as V,fr as W,ke as X,Dt as Y,On as Z,Eje as _,gre as a,yE as a$,oF as a0,fi as a1,Cg as a2,ye as a3,vje as a4,Ki as a5,rt as a6,lt as a7,OM as a8,$o as a9,Sw as aA,Ny as aB,$T as aC,Co as aD,Pt as aE,pf as aF,pl as aG,Ug as aH,ec as aI,o1 as aJ,qi as aK,dt as aL,Nje as aM,DO as aN,JIe as aO,Kre as aP,ese as aQ,Yre as aR,eF as aS,X8 as aT,Kh as aU,Dz as aV,z_ as aW,$n as aX,jg as aY,sRe as aZ,y1 as a_,Wt as aa,bAe as ab,_s as ac,qre as ad,tse as ae,QC as af,VI as ag,Un as ah,MO as ai,rse as aj,Iue as ak,eje as al,UD as am,u9 as an,Jw as ao,Nue as ap,d9 as aq,Rue as ar,tje as as,XRe as at,CE as au,rje as av,nje as aw,Rr as ax,Jt as ay,Hre as az,Cw as b,fh as b$,nr as b0,F_ as b1,vp as b2,aie as b3,kA as b4,tRe as b5,Zre as b6,WI as b7,oRe as b8,gE as b9,qI as bA,Ey as bB,mRe as bC,gRe as bD,rRe as bE,yse as bF,xse as bG,sF as bH,BO as bI,_se as bJ,tv as bK,Jb as bL,sse as bM,Z8 as bN,Qre as bO,Jre as bP,UO as bQ,qw as bR,Ww as bS,Vw as bT,Lw as bU,zw as bV,Iw as bW,_w as bX,Ow as bY,Sg as bZ,kw as b_,aRe as ba,Ng as bb,tF as bc,KI as bd,ase as be,cse as bf,lse as bg,dse as bh,use as bi,hse as bj,fse as bk,pse as bl,mse as bm,gse as bn,cRe as bo,XIe as bp,wse as bq,lRe as br,rF as bs,Rw as bt,bse as bu,dRe as bv,pRe as bw,uRe as bx,fRe as by,hRe as bz,vi as c,Tw as c0,Uw as c1,no as c2,jw as c3,Pw as c4,Ii as c5,Bw as c6,Ag as c7,Dw as c8,Hw as c9,ose as ca,Fw as cb,$w as cc,Mw as cd,Gh as ce,Ise as cf,Nse as cg,Gre as ch,Ase as ci,W8 as cj,oy as ck,jIe as d,Dr as e,ha as f,Mn as g,xRe as h,M as i,Le as j,wRe as k,bRe as l,yRe as m,Vt as n,cF as o,im as p,PIe as q,gt as r,vRe as s,qS as t,Xt as u,ls as v,cs as w,zr as x,Cje as y,D as z};
